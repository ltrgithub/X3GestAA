"r0":{"sap":{"acts":[{"id":"2128","st":false},{"id":"2823","st":false},{"id":"1116","st":false},{"id":"1115","st":false},{"id":"2865","st":false},{"id":"1118","st":false},{"id":"1172","st":true},{"id":"1116","st":false},{"id":"1123","st":false},{"id":"1121","st":false},{"id":"2134","st":false},{"id":"2132","st":false},{"id":"2819","st":false},{"id":"2125","st":true},{"id":"2820","st":false},{"id":"2127","st":true},{"id":"2818","st":false},{"id":"2848","st":false},{"id":"2844","st":false},{"id":"1166","st":false},{"id":"2849","st":false},{"id":"1165","st":true},{"id":"1187","st":true},{"id":"1115","st":false},{"id":"1174","st":true},{"id":"2855","st":false},{"id":"2851","st":false},{"id":"1117","st":false},{"id":"2866","st":false},{"id":"2864","st":false},{"id":"2136","st":false},{"id":"2129","st":false},{"id":"2818","st":false},{"id":"2847","st":false},{"id":"2845","st":true},{"id":"2817","st":false},{"id":"1121","st":false},{"id":"2133","st":false},{"id":"2131","st":false},{"id":"2135","st":false},{"id":"1119","st":false},{"id":"1122","st":false},{"id":"2130","st":false},{"id":"1122","st":false},{"id":"1184","st":false},{"id":"1120","st":false},{"id":"1185","st":true},{"id":"2819","st":false},{"id":"2053","st":true},{"id":"1118","st":false},{"id":"1120","st":false},{"id":"2821","st":false},{"id":"2126","st":true},{"id":"2853","st":false},{"id":"1167","st":true},{"id":"1040","st":true},{"id":"1173","st":true},{"id":"2820","st":false},{"id":"1117","st":false},{"id":"1183","st":true},{"id":"2822","st":false},{"id":"2816","st":false},{"id":"1169","st":true},{"id":"1123","st":false}],"target":{"ist":{"fmt":"edit","edit":true,"xid":"AA2","win":"B","nl":1},"type":"ist"},"func":{"open":{"B":{"stamp":"20120529141412","extend":"","name":"ZCCNOM1","func":"ZCCNOM1","type":"1","scrnNum":1,"mnu":[{"fid":322,"id":21127479,"acl":0,"typ":2,"rnk":55,"act":3071,"txt":""}]}}},"wins":{"B":{"tit":"Vertical title","entities":{"AA":{"$mvt":[[1,1,23]],"$rcd":[{"AA6":1,"$uuid":0,"AA7":"Sunday","AA4":"Table de cuisine","AA5":"xml.gif","AA2":"","AA3":"00001","AA8":"Monday","AA9":"Tuesday"},{"AA6":2,"$uuid":1,"AA7":"Monday","AA4":"Plateau TABLE 150 x 80","AA5":"ico.gif","AA2":"00001","AA3":"00011","AA8":"Tuesday","AA9":"Wednesday"},{"AA6":2,"$uuid":2,"AA7":"Tuesday","AA4":"tiroir","AA5":"doc.gif","AA2":"00011","AA3":"00101","AA8":"Wednesday","AA9":"Thursday"},{"AA6":1,"$uuid":3,"AA7":"Wednesday","AA4":"Joue tiroir","AA5":"Folder.gif","AA2":"00101","AA3":"COTE","AA8":"Thursday","AA9":"Friday"},{"AA6":1,"$uuid":4,"AA7":"Thursday","AA4":"Paneau de joue","AA5":"chm.gif","AA2":"COTE","AA3":"PAN03","AA8":"Friday","AA9":"Saturday"},{"AA6":1,"$uuid":5,"AA7":"Friday","AA4":"Glissière","AA5":"xml.gif","AA2":"COTE","AA3":"GLIS01","AA8":"Saturday","AA9":"Sunday"},{"AA6":1,"$uuid":6,"AA7":"Saturday","AA4":"Panneau arrière","AA5":"ico.gif","AA2":"00101","AA3":"ARRIERE","AA8":"Sunday","AA9":"Monday"},{"AA6":1,"$uuid":7,"AA7":"Sunday","AA4":"Panneau avant","AA5":"doc.gif","AA2":"00101","AA3":"AVANT","AA8":"Monday","AA9":"Tuesday"},{"AA6":1,"$uuid":8,"AA7":"Monday","AA4":"Bouchon diamètre 20","AA5":"Folder.gif","AA2":"PIED","AA3":"BOUCHON","AA8":"Tuesday","AA9":"Wednesday"},{"AA6":1,"$uuid":9,"AA7":"Tuesday","AA4":"Panneau plateau 50 x 80","AA5":"chm.gif","AA2":"AVANT","AA3":"PANNEAU01","AA8":"Wednesday","AA9":"Thursday"},{"AA6":1,"$uuid":10,"AA7":"Wednesday","AA4":"Bouton tiroir type T0230","AA5":"xml.gif","AA2":"AVANT","AA3":"BOUTON","AA8":"Thursday","AA9":"Friday"},{"AA6":1,"$uuid":11,"AA7":"Thursday","AA4":"Fond tiroir","AA5":"ico.gif","AA2":"00101","AA3":"FOND","AA8":"Friday","AA9":"Saturday"},{"AA6":0,"$uuid":12,"AA7":"Friday","AA4":"Pied acier D22","AA5":"doc.gif","AA2":"00001","AA3":"PIED","AA8":"Saturday","AA9":"Sunday"},{"AA6":1,"$uuid":13,"AA7":"Saturday","AA4":"Tube acier D22","AA5":"Folder.gif","AA2":"PIED","AA3":"TUBE","AA8":"Sunday","AA9":"Monday"},{"AA6":1,"$uuid":14,"AA7":"Sunday","AA4":"Panneau assemblé","AA5":"chm.gif","AA2":"00011","AA3":"PAN01","AA8":"Monday","AA9":"Tuesday"},{"AA6":1,"$uuid":15,"AA7":"Monday","AA4":"Panneau table 150 x 80","AA5":"xml.gif","AA2":"PAN01","AA3":"PAN02","AA8":"Tuesday","AA9":"Wednesday"},{"AA6":1,"$uuid":16,"AA7":"Tuesday","AA4":"Revetement","AA5":"ico.gif","AA2":"PAN01","AA3":"RVT01","AA8":"Wednesday","AA9":"Thursday"},{"AA6":1,"$uuid":17,"AA7":"Wednesday","AA4":"Revetement champ","AA5":"doc.gif","AA2":"PAN01","AA3":"RVT02","AA8":"Thursday","AA9":"Friday"},{"AA6":1,"$uuid":18,"AA7":"Thursday","AA4":"Visserie divers","AA5":"Folder.gif","AA2":"00001","AA3":"VISSERIE","AA8":"Friday","AA9":"Saturday"},{"AA6":1,"$uuid":19,"AA7":"Friday","AA4":"Boulons 6 x 10","AA5":"chm.gif","AA2":"VISSERIE","AA3":"TYPE1","AA8":"Saturday","AA9":"Sunday"},{"AA6":1,"$uuid":20,"AA7":"Saturday","AA4":"Vis 6 x 8","AA5":"xml.gif","AA2":"VISSERIE","AA3":"TYPE2","AA8":"Sunday","AA9":"Monday"},{"AA6":1,"$uuid":21,"AA7":"Sunday","AA4":"vis 6 x 6","AA5":"ico.gif","AA2":"VISSERIE","AA3":"TYPE3","AA8":"Monday","AA9":"Tuesday"},{"AA6":-1,"$uuid":22}]},"AB1":{"v":"<!-- Declarations XSL  Nomenclature verticale version  : 049_18-->\n<xsl:stylesheet version=\"1.1\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n\t\t\t\t\t\t\t\t\t\txmlns:msxsl=\"urn:schemas-microsoft-com:xslt\">\t \n\t <xsl:output method=\"html\" version=\"1.0\" encoding=\"UTF-8\" indent=\"no\"/>\n\t\n<xsl:param name=\"KLOCRESSOURCES\"></xsl:param>\n<xsl:param name=\"KRESSTD\"></xsl:param>\n<xsl:param name=\"KRESVER\"></xsl:param>\n<xsl:param name=\"KRESPER\"></xsl:param>\n<xsl:param name=\"KRESFOLDER\"></xsl:param>\n<xsl:param name=\"KIDPROC\"></xsl:param>\n<xsl:param name=\"KNEXT\">0</xsl:param>\n\n\n<xsl:variable name=\"BLOCKID\"><xsl:value-of select=\"substring(/Data/MAIN/CPH[1]/@XD1,1,1)\"/></xsl:variable>\n<xsl:variable name=\"hLine\">20</xsl:variable>\n<xsl:variable name=\"sufImag\"><xsl:choose><xsl:when test=\"$hLine='22'\"></xsl:when><xsl:otherwise><xsl:value-of select=\"$hLine\"/></xsl:otherwise></xsl:choose></xsl:variable>\n\t<xsl:template name=\"builColonneDataSource\">\n\t\t<xsl:param name=\"NoColTable\"/>\n\t\t<xsl:variable name=\"colName\"><xsl:value-of select=\"$BLOCKID\"/><xsl:value-of select=\"$NoColTable\"/></xsl:variable>\n\t\t<xsl:variable name=\"ColNum\">\n\t\t\t<xsl:for-each select=\"//r[1]/*\">\n\t\t\t\t<xsl:if test=\"name()=$colName\"><xsl:value-of select=\"position()\"/></xsl:if>\n\t\t\t</xsl:for-each>\n\t\t</xsl:variable>\n\t\t<xsl:value-of select=\"$ColNum\"/>\n\t</xsl:template>\n\n<xsl:template name=\"getColonneDataSource\">\n\t<xsl:param name=\"NoColTable\"/>\n\t<xsl:variable name=\"colName\"><xsl:value-of select=\"$BLOCKID\"/><xsl:value-of select=\"$NoColTable\"/></xsl:variable>\n\t<xsl:variable name=\"ColNum\">\n\t\t<xsl:for-each select=\"//r[1]/*\">\n\t\t\t<xsl:if test=\"name()=$colName\"><xsl:value-of select=\"position()\"/></xsl:if>\n\t\t</xsl:for-each>\n\t</xsl:variable>\n\t<xsl:value-of select=\"$ColNum\"/>\n</xsl:template>\n\n<xsl:template name=\"getColonneDataSourceFromName\">\n\t<xsl:param name=\"P1\"/>\n\t<xsl:variable name=\"NoColTableX3\"><xsl:call-template name=\"getColonneX3\"><xsl:with-param name=\"P1\" select=\"$P1\"/></xsl:call-template></xsl:variable>\n\t<xsl:variable name=\"NoColDataSrc\"><xsl:call-template name=\"getColonneDataSource\"><xsl:with-param name=\"NoColTable\" select=\"$NoColTableX3\"/></xsl:call-template></xsl:variable>\n\t<xsl:value-of select=\"$NoColDataSrc\"/>\n</xsl:template>\n\n\t<xsl:variable name=\"colNl\">'<xsl:value-of select=\"$BLOCKID\"/>1'</xsl:variable>\n\t<xsl:variable name=\"colParent\">'<xsl:call-template name=\"getColonneX3\"><xsl:with-param name=\"P1\">PARENT</xsl:with-param></xsl:call-template>'</xsl:variable>\n\t<xsl:variable name=\"colKey\">'<xsl:call-template name=\"getColonneX3\"><xsl:with-param name=\"P1\">KEY</xsl:with-param></xsl:call-template>'</xsl:variable>\n\t<xsl:variable name=\"colImg\">'<xsl:call-template name=\"getColonneX3\"><xsl:with-param name=\"P1\">IMG</xsl:with-param></xsl:call-template>'</xsl:variable>\n\t<xsl:variable name=\"colIco\"><xsl:call-template name=\"getColonneX3\"><xsl:with-param name=\"P1\">ICO</xsl:with-param></xsl:call-template></xsl:variable>\n\t<xsl:variable name=\"colLib\">'<xsl:call-template name=\"getColonneX3\"><xsl:with-param name=\"P1\">LIB</xsl:with-param></xsl:call-template>'</xsl:variable>\n\t<xsl:variable name=\"colLibSh\">'<xsl:call-template name=\"getColonneX3\"><xsl:with-param name=\"P1\">LIBSH</xsl:with-param></xsl:call-template>'</xsl:variable>\n\t<xsl:variable name=\"colExp\">'<xsl:call-template name=\"getColonneX3\"><xsl:with-param name=\"P1\">EXP</xsl:with-param></xsl:call-template>'</xsl:variable>\n\t<xsl:variable name=\"colsInfo\"><xsl:call-template name=\"getColonnesInfoX3\"></xsl:call-template></xsl:variable>\n\n\n<xsl:template name=\"getColonneX3\">\n\t<xsl:param name=\"P1\"/>\n\t<xsl:variable name=\"XID\" select=\"/Data/MAIN/CPH[@TFL=$P1]/@XD1\"/>\n\t<xsl:if test=\"$XID!=''\"><xsl:value-of select=\"$BLOCKID\"/><xsl:value-of select=\"number(substring($XID,2,(string-length($XID)-1)))\"/></xsl:if>\n</xsl:template>\n\n<xsl:template name=\"getColonnesInfoX3\">\n \t\t<xsl:for-each select=\"/Data/MAIN/CPH\">\n\t\t\t<xsl:if test=\"@TFL='INF'\"><text>ID_Infos['</text><xsl:value-of select=\"$BLOCKID\"/><xsl:value-of select=\"number(substring(@XD1,2,(string-length(@XD1)-1)))\"/><text>']={format:'<xsl:value-of select=\"@FMT\"/>',type:<xsl:value-of select=\"@TDO\"/>};</text></xsl:if>\n\t\t</xsl:for-each>\n\t\tID_Infos.length=<xsl:value-of select=\"count(/Data/MAIN/CPH[@TFL='INF'])\"/>;\n</xsl:template>\n\n<xsl:variable name=\"isEdit\"><xsl:call-template name=\"getParamValue\"><xsl:with-param name=\"PNAME\">MODHIE</xsl:with-param></xsl:call-template></xsl:variable>\n<xsl:variable name=\"isExecNode\"><xsl:call-template name=\"getParamValue\"><xsl:with-param name=\"PNAME\">EXECFL</xsl:with-param></xsl:call-template></xsl:variable>\n<xsl:variable name=\"type\"><xsl:call-template name=\"getParamValue\"><xsl:with-param name=\"PNAME\">TYPPRE</xsl:with-param></xsl:call-template></xsl:variable>\n\n<xsl:template name=\"getParamValue\">\n\t<xsl:param name=\"PNAME\"/>\n\t<xsl:variable name=\"NBMPAR\">\n \t\t<xsl:for-each select=\"/Data/MAIN/TEC/@*\">\n\t\t\t<xsl:if test=\".=$PNAME\"><xsl:value-of select=\"position()\"/></xsl:if>\n\t\t</xsl:for-each>\n\t</xsl:variable>\n\t<xsl:value-of select=\"/Data/MAIN/TEC/@*[number($NBMPAR)+1]\"/>\n</xsl:template>\n\n  <xsl:variable name=\"nbXsl\"><xsl:value-of select=\"count(/Data/MAIN/XSLS/XSL)\"/></xsl:variable>\n<xsl:template match=\"/\">\n<html>\n\t<xsl:call-template name=\"BUILDHEADER\"/>\n\t<body onload=\"doLoad()\" unselectable=\"on\" onmouseup=\"removeSelection();endDrag()\" style=\"margin:0px;overflow:auto\" onkeydown=\"return doKeyDown(event)\" onkeyup=\"return doKeyUp(event)\">\t\t  \n\t\t<xsl:call-template name=\"BUILDINNERBODY\"/>\n\t</body>\n</html>\n</xsl:template>\n<xsl:template name=\"BUILDINNERBODY\">\n\t<xsl:variable name=\"ptop\">\n\t\t<xsl:choose>\n\t\t\t<xsl:when test=\"$nbXsl = 1\">1</xsl:when>\n\t\t\t<xsl:when test=\"$nbXsl = 2\">26</xsl:when>\n\t\t\t<xsl:otherwise>30</xsl:otherwise>\n\t\t</xsl:choose>\n\t</xsl:variable>\n   \t<div unselectable=\"on\"  style=\"width:100%;height:100%;text-align:left;\">\n    \t<span unselectable=\"on\"  onscroll=\"scrollMain()\" id=\"MainSpan\" style=\"position:absolute;z-index:10;top:{$ptop};left:1px;height:expression(parentElement.offsetHeight - {$ptop});width:expression(parentElement.offsetWidth - 1);background-color:white;border:1px solid black;overflow:auto;padding-left:10px;padding-top:10px;\">\n\t\t\t<div id=\"zoomElement\" style=\"position:absolute;top:1px;left:10px\">\t\n\n\t\t\t</div>\n\t\t  </span>  \t\n\t\t</div>\n\t\t<xsl:if test=\"$nbXsl = 2\">\n\t\t\t<div  id=\"Palette\" style=\"position:absolute;top:0%;left:0;width:100px;height:24px;margin-top:2px;margin-left:2px;background-repeat:no-repeat;background-image:url({$KLOCRESSOURCES}FondPal.gif)\"><img  src=\"{$KLOCRESSOURCES}BnomH.gif\" style=\"margin-left:6px;margin-top:1px;cursor:hand\"  onclick=\"doChange()\"/><img  style=\"margin-left:4px;cursor:hand\" src=\"{$KLOCRESSOURCES}BnomV.gif\"/></div>\n   \t\t</xsl:if>\n</xsl:template>\n   \n<xsl:template name=\"BUILDHEADER\">\n   <head>\n      <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n      <title>Exemple</title>\n      <style>\n      \tdiv,table{background-Color:transparent;position:relative;}\n      \tbody,table{font-size:8pt;font-family:Arial;}\n      \t.c1,.c1l{left:0;top:0;margin-left:3px;margin-top:2px;margin-bottom:2px}\n      \t.c2{cursor:hand;margin-right:2px;}\n\t\t.c3{margin-right:2px;margin-left:2px;vertical-align:middle;cursor:hand;}\n\t\t.c4{cursor:hand;display:inline;background-repeat:no-repeat;margin-left:0px;<xsl:if test=\"not($colIco='')\">padding-left:20px;</xsl:if>background-position:0;height:15px;padding-top:4px}\n\t\t.c5,.c5l{margin-left:16px;margin-top:2px;margin-bottom:2px;}\n\t\t.c6{margin-right:2px;vertical-align:middle;cursor:hand;}\n\t\t.c7{display:inline;margin-left:0px;cursor:hand;background-repeat:no-repeat;<xsl:if test=\"not($colIco='')\">padding-left:20px;</xsl:if>background-position:0 0;height:17px;padding-top:2px}\n\n      \t.cc1,.cc1l{left:0;top:0;margin-left:3px;margin-top:0px;margin-bottom:0px;}\n      \t\n      \t.cc1{background-image:url(<xsl:value-of select=\"$KLOCRESSOURCES\"/>trVertLine<xsl:value-of select=\"$sufImag\"/>.gif);background-repeat:repeat-y}\n      \t.cc2{cursor:hand;margin-right:2px;vertical-align:top}\n      \t\n\t\t.cc3{margin-right:2px;margin-left:2px;cursor:hand;vertical-align:middle}\n\t\t.cc4{cursor:hand;display:inline;margin-left:2px;background-repeat:no-repeat;<xsl:if test=\"not($colIco='')\">padding-left:18px;</xsl:if>background-position:0 center;height:<xsl:value-of select=\"$hLine\"/>px;padding-top:4px}\n\t\t.cc5,.cc5l{padding-left:21px;margin-top:0px;margin-bottom:0px;}\n\t\t.cc5{background-image:url(<xsl:value-of select=\"$KLOCRESSOURCES\"/>trFct<xsl:value-of select=\"$sufImag\"/>.gif);background-repeat:repeat-y;background-position:3px}\n\t\t.cc5l{background-image:url(<xsl:value-of select=\"$KLOCRESSOURCES\"/>trFctLast<xsl:value-of select=\"$sufImag\"/>.gif);background-repeat:repeat-y;background-position:3px}\n\t\t.cc6{margin-right:2px;vertical-align:middle;cursor:hand;}\n\t\t.cc7{display:inline;margin-left:2px;cursor:hand;background-repeat:no-repeat;<xsl:if test=\"not($colIco='')\">padding-left:18px;</xsl:if>background-position:0 center;height:<xsl:value-of select=\"$hLine\"/>px;padding-top:4px}\n     \t.line{height:<xsl:value-of select=\"$hLine\"/>px;padding-top:4px;white-space: nowrap;}\n      </style>\n\t<script>\n\t\tvar Nl=0;\n\t\tvar Parent=0;\n\t\tvar Key=0;\n\t\tvar LibSh=0;\n\t\tvar Lib=0;\n\t\tvar Img=0;\n\t\tvar Ico=0;\n\t\tvar Exp=0;\n\t\tvar ID_Nl \t\t=<xsl:value-of select=\"$colNl\"/>;\n\t\tvar ID_Parent \t=<xsl:value-of select=\"$colParent\"/>;\n\t\tvar ID_Key \t\t=<xsl:value-of select=\"$colKey\"/>;\n\t\tvar ID_LibSh\t=<xsl:value-of select=\"$colLibSh\"/>;\n\t\tvar ID_Lib\t\t=<xsl:value-of select=\"$colLib\"/>;\n\t\tvar ID_Img\t\t=<xsl:value-of select=\"$colImg\"/>;\n\t\tvar ID_Ico\t\t='<xsl:value-of select=\"$colIco\"/>';\n\t\tvar ID_Exp\t\t=<xsl:value-of select=\"$colExp\"/>;\n\t\tvar ID_Infos\t={};<xsl:value-of select=\"$colsInfo\"/>\n\t\tvar KLOCRESSOURCES='<xsl:value-of select=\"$KLOCRESSOURCES\"/>';\n\t\tvar KRESSTD='<xsl:value-of select=\"$KRESSTD\"/>';\n\t\tvar KRESVER='<xsl:value-of select=\"$KRESVER\"/>';\n\t\tvar KRESPER='<xsl:value-of select=\"$KRESPER\"/>';\n\t\tvar KRESFOLDER='<xsl:value-of select=\"$KRESFOLDER\"/>';\n\t\tvar KIDPROC='<xsl:value-of select=\"$KIDPROC\"/>';\n\t\tvar KNEXT='<xsl:value-of select=\"$KNEXT\"/>';\n\t\tvar KNomV=\"005_025\"\n\t\tvar TypeNom     =parseInt('<xsl:value-of select=\"$type\"/>',10);\n\t\tvar pStyle=\"<xsl:value-of select=\"/Data/MAIN/TEC/@STYLE\"/>\";\n\tvar gXmlDomRes=null\n\tfunction setColonnesFromName(aDataSrc){\n\t\tif (aDataSrc==null || aDataSrc.documentElement==null || aDataSrc.documentElement.firstChild==null)\n\t\t\treturn \n\t\tvar wNode=aDataSrc.documentElement.firstChild.firstChild\n\t\tvar wI=1;\n\t\tvar wNodeName=\"\"\n\t\twhile (wNode!=null){\n\t\t\twNodeName=wNode.nodeName\n\t\t\tswitch (wNodeName){\n\t\t\t\tcase ID_Nl\t\t:{Nl=wI;break}\n\t\t\t\tcase ID_Parent\t:{Parent=wI;break}\t\n\t\t\t\tcase ID_Key\t\t:{Key=wI;break}\n\t\t\t\tcase ID_LibSh\t:{LibSh=wI;break}\n\t\t\t\tcase ID_Exp\t\t:{Exp=wI;break}\n\t\t\t\tcase ID_Lib\t\t:{Lib=wI;break}\n\t\t\t\tcase ID_Img\t\t:{Img=wI;break}\n\t\t\t\tcase ID_Ico\t\t:{Ico=wI;break}\n\t\t\t}\n\t\t\tif(wNodeName.indexOf(\"_\")!=-1){\n\t\t\t\twNodeName=wNodeName.split(\"_\")[1]\n\t\t\t}\n\t\t\tif(typeof(ID_Infos[wNodeName])!=\"undefined\") {\n\t\t\t\tID_Infos[wNodeName].pos=wI; \n\t\t\t}\n\t\t\t\n\t\t\twNode=wNode.nextSibling\n\t\t\twI++;\n\t\t}\n\t}\nfunction removeSelection(){\n    try{\n       document.body.createTextRange().execCommand('Unselect')\n    }catch(e){};\n}\n\tfunction execBuildInnerBody(){\n\t\t\tvar wtrace=\"\"\n\t\t\tvar wDom=document.body.myInterface.getXmlData()\n\t\t\tsetColonnesFromName(wDom)\n\t\t\tdocument.all(\"zoomElement\").innerHTML=\"\"\n\t\t\tgXmlDomRes=null;\n\t\t\tif (typeof(top.To_openPerf)!=\"undefined\") top.To_openPerf(\"Build hierarchie\")\n\t\t\tvar wH=new CBuildH()\n\t\t\tgXmlDomRes=wH.transform(wDom)\n\t\t\tdelete(wH)\n                        setTimeout(execBuildInnerBodySuite,100)\t\t\t\n\n\t}\n\tfunction execBuildInnerBodySuite(){\n\t\t\tvar wtrace=\"\"\n\t\t\tif (typeof(top.To_openPerf)!=\"undefined\") top.To_closePerf(\"\") //\" \" + Math.round(gXmlDomRes.xml.length/1024) + \" Ko \"\n\n\t\t\tif (typeof(top.To_openPerf)!=\"undefined\") top.To_openPerf(\"Build html\")\n\t\t\tvar wH=null\n\t\t\twH=new CBuildNomV1()\n\t\t\tvar wDomResHTML=wH.buildHTML(gXmlDomRes)\n\t\t\tdelete(wH)\n\t\t\tif (typeof(top.To_openPerf)!=\"undefined\") top.To_closePerf(\"\") //\" \" + Math.round(wDomResHTML.xml.length/1024) + \" Ko \"\n\t\t\tif (typeof(top.To_openPerf)!=\"undefined\") top.To_openPerf(\"innerHTML\")\n\t\t\tdocument.all(\"zoomElement\").innerHTML=wDomResHTML.documentElement.xml\n\t\t\tif (typeof(top.To_openPerf)!=\"undefined\") top.To_closePerf(\"\") //\" \" + Math.round(wDomResHTML.documentElement.xml.length/1024) + \" Ko \"\n\t\t\t\n\t\t\t\n\t\t\tif (typeof(top.Fu_trace)!=\"undefined\"){top.Fu_trace(arguments,wtrace)}\n\t\t\tdelete(wDomResHTML)\n                     setActionMemo()\n                  doScrollMain()\n\t\t\treturn wtrace\n\t}\n\tfunction buildInnerSub(aNl){\n\t\t\tvar wH=null\n\t\t\twH=new CBuildNomV1()\n\t\t\tvar wDomResHTML=wH.buildHTMLSub(gXmlDomRes,aNl)\n\t\t\tdelete(wH)\n\t\t\treturn wDomResHTML.documentElement.xml\n\t}\n\tfunction doLoad(){\n\t\t\tvar wTrace=\"\"\n\t\t\tvar wDat1=new Date()\n\t\t\tvar wTim1=wDat1.getTime()\n\t\t\twTrace=execBuildInnerBody()\n\t\t\t\n\t\t\tvar wDat2=new Date()\n\t\t\tvar wTim2=wDat2.getTime()\n\t\t\twTrace+=\"Total \" + (wTim2-wTim1) + \"\\n\"\n\t}\t\n\tfunction doKeyUp(ev){;\n\t\tif(pLock) return false\n\t\tif(pAckCallBusy) return false\n\t\tif(ev.shiftKey) \t return true\n\t\tif(ev.shiftLeft) \treturn true\n\t\tif(ev.ctrlKey) \t\treturn true\n\t\tif(ev.ctrlLeft) \treturn true\n\t\tif(typeof(top.gLock)!=\"undefined\" &amp;&amp; top.gLock) return false\n\t\tswitch (ev.keyCode){\n\t\t\tcase 33\t\t:{return true;break;}\n\t\t\tcase 34\t\t:{return true;break;}\n\t\t\tcase 35\t\t:{return true;break;}\n\t\t\tcase 36\t\t:{return true;break;}\n\t\t\tcase 37\t\t:{return setPreviousVisibleUp();break;}\n\t\t\tcase 38\t\t:{return setPreviousVisibleUp();break;}\n\t\t\tcase 39\t\t:{return setNextVisibleUp();break;}\n\t\t\tcase 40\t\t:{return setNextVisibleUp();break;}\n\t\t\tcase 107\t:{return true;break;}\n\t\t\tcase 109\t:{return true;break;}\n\t\t}\n\t\treturn true\n\t\t\n\t}\n\tfunction doKeyDown(ev){;\n\t\tif(pLock) return false\n\t\tif(pAckCallBusy) return false\n\t\tif(ev.shiftKey) \treturn true\n\t\tif(ev.shiftLeft) \treturn true\n\t\tif(ev.ctrlKey) \t\treturn true\n\t\tif(ev.ctrlLeft) \treturn true\n\t\tif(typeof(top.gLock)!=\"undefined\" &amp;&amp; top.gLock) return false\n\t\tswitch (ev.keyCode){\n\t\t\tcase 33\t\t:{return setFirstVisible();break;}\n\t\t\tcase 34\t\t:{return setLastVisible();break;}\n\t\t\tcase 35\t\t:{return setLastVisible();break;}\n\t\t\tcase 36\t\t:{return setFirstVisible();break;}\n\t\t\tcase 37\t\t:{return setLeftArrow(pCurrentFocus);break;}\n\t\t\tcase 38\t\t:{return setPreviousVisible(pCurrentFocus);break;}\n\t\t\tcase 39\t\t:{return setRightArrow(pCurrentFocus);break;}\n\t\t\tcase 40\t\t:{return setNextVisible(pCurrentFocus);break;}\n\t\t\tcase 107\t:{return setExpend(pCurrentFocus);break;}\n\t\t\tcase 109\t:{return setCollapse(pCurrentFocus);break;}\n\t\t}\n\t\treturn true\n\t\t\n\t}\n\tfunction getFirstElement(){\n\t\ttry{\n\t\t\tvar wEl=zoomElement\n\t\t\twhile (wEl!=null &amp;&amp; wEl.main!=\"true\"){\n\t\t\t\twEl=wEl.firstChild\n\t\t\t}\n\t\t\tif(wEl!=null) return wEl.firstChild.nextSibling\n\t\t\treturn null\n\t\t}catch(e){return null}\n\t}\n\tfunction getLastElementVisible(aElt){\n\t\tif(aElt.nextSibling==null) return aElt\n\t\tif(aElt.nextSibling.style.display==\"none\") return aElt\n\t\tif(aElt.nextSibling.lastChild.firstChild.nextSibling==null) return aElt.nextSibling.lastChild.firstChild\n\t\treturn getLastElementVisible(aElt.nextSibling.lastChild.firstChild.nextSibling)\n\t}\n\tfunction setLastVisible(){\n\t\tvar wFirst=getFirstElement()\n\t\tif(wFirst==null) return true\n\t\tvar wEl=getLastElementVisible(wFirst)\n\n\t\tif (wEl==null) return true\n\t\tvar wNl=wEl.getAttribute(\"nl\")\n\t\tif(wNl==null || wNl==\"\") return true\n\t\tdoClick(wNl)\n\t\treturn false\n\t\n\t}\n\tfunction setFirstVisible(){\n\t\tvar wFirst=getFirstElement()\n\t\tif(wFirst==null) return true\n\t\tvar wNl=wFirst.getAttribute(\"nl\")\n\t\tif(wNl==null || wNl==\"\") return true\n\t\tdoClick(wNl)\n\t\treturn false\n\t}\n\tfunction setPreviousVisibleUp(){\n\t\tif(pCurrentFocus==null) return true\n\t\tvar wNl=pCurrentFocus.getAttribute(\"nl\")\n\t\tif(wNl==null || wNl==\"\") return true\n\t\tdoClick(wNl)\n\t\treturn false\t\t\n\t}\n\tfunction setNextVisibleUp(){\n\t\tif(pCurrentFocus==null) return\n\t\tvar wNl=pCurrentFocus.getAttribute(\"nl\")\n\t\tif(wNl==null || wNl==\"\") return true\n\t\tdoClick(wNl)\n\t\treturn false\n\t}\n\tfunction setPreviousVisible(aElt){\n\t\tif(aElt==null) return true\n\t\tvar wElt=null\n\t\tif(aElt.parentElement.getAttribute(\"main\")==\"true\") setFirstVisible(aElt)\n\t\tif(aElt.getAttribute(\"nl\")==null) setFirstVisible(aElt)\n\t\tif(aElt.parentElement.previousSibling !=null) {\n\t\t\tif(aElt.parentElement.previousSibling.firstChild.tagName!=\"IMG\"){\n\t\t\t\twElt=aElt.parentElement.previousSibling\n\t\t\t}else{\n\t\t\t\twElt=getLastElementVisible(aElt.parentElement.previousSibling.firstChild.nextSibling)\n\t\t\t}\n\t\t}else{\n\t\t\tif(aElt.parentElement.parentElement.firstChild.tagName!=\"IMG\"){\n\t\t\t\twElt=aElt.parentElement.parentElement.previousSibling\n\t\t\t}else{\n\t\t\t\twElt=getLastElementVisible(aElt.parentElement.parentElement.previousSibling.firstChild.nextSibling)\n\t\t\t}\t\t\n\t\t}\n\t\tif(wElt==null) return true\n\t\tvar wNl=wElt.getAttribute(\"nl\")\n\t\tif(wNl==null || wNl==\"\") return true\n\t\t//doClick(wNl)\n\t\tsetFocus(wNl)\n\t\treturn false\t\t\n\t}\n\tfunction setRightArrow(aElt){\n\t\tif(aElt==null) return true\n\t\tif(aElt.nextSibling==null) return setNextVisible(aElt)\n\t\tif(aElt.nextSibling.style.display!=\"none\") return setNextVisible(aElt)\n\t\tsetExpendLine(aElt.parentElement,true)\n\t\tmemoExpendCollapseMen(aElt.parentElement.firstChild,true)\n\t\treturn false\n\t}\n\tfunction setLeftArrow(aElt){\n\t\tif(aElt==null) return true\n\t\tif(aElt.nextSibling==null) return setPreviousVisible(aElt)\n\t\tif(aElt.nextSibling.style.display==\"none\") return setPreviousVisible(aElt)\n\t\tsetCollapseLine(aElt.parentElement)\n\t\tmemoExpendCollapseMen(aElt.parentElement.firstChild,false)\n\t\treturn false\n\t}\n\tfunction getFirstElementVisible(aElt){\n\t\tif(aElt.parentElement.nextSibling!=null) return aElt.parentElement.nextSibling.firstChild\n\t\tif(aElt.parentElement.parentElement.parentElement.nextSibling!=null) return aElt.parentElement.parentElement.parentElement.nextSibling.firstChild\n\t\treturn getFirstElementVisible(aElt.parentElement.parentElement)\n\t}\n\tfunction setNextVisible(aElt){\n\t\tif(aElt==null) return\n\t\tvar wElt=null\n\t\tif(aElt.previousSibling!=null) {\n\t\t\tif(aElt.nextSibling.style.display!=\"none\")\t{\n\t\t\t\twElt=aElt.nextSibling.firstChild.firstChild\n\t\t\t}else{\n\t\t\t\twElt=getFirstElementVisible(aElt)\n\t\t\t}\n\t\t}else{\n\t\t\twElt=getFirstElementVisible(aElt)\n\t\t}\n\t\tif(wElt==null) return true\n\t\tif(wElt.tagName==\"IMG\") wElt=wElt.nextSibling\n\n\t\tvar wNl=wElt.getAttribute(\"nl\")\n\t\tif(wNl==null || wNl==\"\") return true\n\t\t//doClick(wNl)\n\t\tsetFocus(wNl)\n\t\treturn false\n\t}\n\tfunction setExpend(aElt){\n\t\tif(aElt==null) return\n\t\tif(aElt.nextSibling==null) return true\n\t\tif(aElt.nextSibling.style.display!=\"none\") return true\n\t\tsetExpendLine(aElt.parentElement,true)\n\t\tmemoExpendCollapseMen(aElt.parentElement.firstChild,true)\n\t\treturn false\n\t}\n\tfunction setCollapse(aElt){\n\t\tif(aElt==null) return\n\t\tif(aElt.nextSibling==null) return true\n\t\tif(aElt.nextSibling.style.display==\"none\") return true\n\t\tsetCollapseLine(aElt.parentElement)\n\t\tmemoExpendCollapseMen(aElt.parentElement.firstChild,false)\n\t\treturn false\n\t}\n\t//----------------------------------\n\tfunction getImageMoins(aLast){\n\t\tif (TypeNom > 1) {\n\t\t\tif(aLast){return \"trMnLastExpended<xsl:value-of select=\"$sufImag\"/>.gif\"}\n\t\t\telse{return \"trMnExpended<xsl:value-of select=\"$sufImag\"/>.gif\"}\n\t\t}\n\t\treturn \"moins.gif\";\t\n\t}\n\t//----------------------------------\n\tfunction getImagePlus(aLast){\n\t\tif (TypeNom > 1) {\n\t\t\tif(aLast){return \"trMnLastCollapse<xsl:value-of select=\"$sufImag\"/>.gif\"}\n\t\t\telse{return \"trMnCollapsed<xsl:value-of select=\"$sufImag\"/>.gif\"}\n\t\t}\n\t\treturn \"plus.gif\";\n\t}\t\t\n\tpClass=TypeNom > 1 ? 'c': '';\n\n\t//-----------------------------------------------\n\tfunction CBuildNomV1(){\n\t\tthis.domres=null\n\t\ttrace=\"\"\n\t}\n\t//----------------------------------------------\n\tCBuildNomV1.prototype.buildHTML=function(aDomXml){\n\t\tthis.domres = new ActiveXObject(\"Msxml2.DOMDocument.3.0\");\n\t\tvar wMain=\"\";\n\t\tswitch (TypeNom){\n\t\t\tcase 3 : {\twMain=\"&lt;div&gt;&lt;table&gt;&lt;tr&gt;&lt;td  valign='top' noWrap='true'&gt;&lt;/td&gt;&lt;td valign='top' noWrap='true' id='COL_'&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;\"\n\t\t\t\t\t\tthis.domres.loadXML(wMain)\n\t\t\t\t\t\tvar wFirstNodeResult=this.domres.documentElement.firstChild.firstChild.firstChild\n\t\t\t\t\t\tbreak;}\n\t\t\tcase 4 : {\twMain=\"&lt;div&gt;&lt;table&gt;&lt;tr&gt;&lt;td  valign='top' noWrap='true'&gt;&lt;/td&gt;\"\n\t\t\t\t\t\tvar wInfo=gInfoLines.line[1];\n\t\t\t\t\t\tvar wAlign=\"\";\n\t\t\t\t\t\tif(typeof(wInfo)!=\"undefined\"){\n\t\t\t\t\t\t\tfor (var k in wInfo.infos){\n\t\t\t\t\t\t\t\twAlign=\"\";\n\t\t\t\t\t\t\t\tif(wInfo.infos[k].type &gt;=2 &amp;&amp; wInfo.infos[k].type &lt;=6){wAlign=\" align='right'\"}\n\t\t\t\t\t\t\t\twMain+=\"&lt;td\"+wAlign+\"  valign='top' noWrap='true' id='COL_\"+k+\"'&gt;&lt;/td&gt;\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\twMain+=\"&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;\"\n\t\t\t\t\t\tthis.domres.loadXML(wMain)\n\t\t\t\t\t\tvar wFirstNodeResult=this.domres.documentElement.firstChild.firstChild.firstChild\n\t\t\t\t\t\tbreak;}\n\t\t\tdefault : { wMain=\"&lt;div/&gt;\";\n\t\t\t\t\t\tthis.domres.loadXML(wMain)\n\t\t\t\t\t\tvar wFirstNodeResult=this.domres.documentElement\n\t\t\t\t\t\tbreak}\n\t\t}\n\t\tif(aDomXml.documentElement==null) return this.domres\n\t\tvar wFirstChild=aDomXml.documentElement.firstChild\n\t\tif (wFirstChild==null) return this.domres\n\t\tvar wNewDest=this.creatElementsHTML(wFirstChild,wFirstNodeResult,(wFirstChild.firstChild==null),true)\n\t\t\n\t\tthis.buildOneLevel(wFirstChild.firstChild,wNewDest)\n\t\treturn this.domres\n\t}\n\t//----------------------------------------------\n\tCBuildNomV1.prototype.buildHTMLSub=function(aDomXml,aNl){\n\t\tthis.domres = new ActiveXObject(\"Msxml2.DOMDocument.3.0\");\n\t\tthis.domres.loadXML(\"&lt;div id='SUB_LI\"+ aNl +\"' style='margin-left:2px;padding-left:12px;'/&gt;\")\n\t\tif(aDomXml==null) return this.domres\n\t\tif(aDomXml.documentElement==null) return this.domres\n\t\tvar wNode=aDomXml.documentElement.selectSingleNode(\"//*[@NL='\"+aNl+\"']\")\n\t\tif(wNode==null) return this.domres\n\t\tthis.buildOneLevel(wNode.firstChild,this.domres.documentElement,true)\n\t\treturn this.domres\n\t}\n\t//----------------------------------------------\n\tCBuildNomV1.prototype.buildHTMLBranche=function(aNodes){\n\t\tthis.domres = new ActiveXObject(\"Msxml2.DOMDocument.3.0\");\n\t\tvar wLength=aNodes.length\n\t\tvar wNode=aNodes[wLength-1]\n\t\tvar wNl=wNode.getAttribute(\"NL\")\n\t\tthis.domres.loadXML(\"&lt;div id='SUB_LI\"+ wNl +\"' style='margin-left:2px;padding-left:12px;'/&gt;\")\n\t\tvar wContener=null\n\t\tvar wDomElt=this.domres.documentElement\n\t\tfor(var i=wLength-1;i&gt;=0;i--){\n\t\t\twNl=aNodes[i].getAttribute(\"NL\")\n\t\t\twContener=wDomElt.selectSingleNode(\"//div[@id='SUB_LI\"+wNl+\"']\")\n\t\t\tthis.buildOneLevel(aNodes[i].firstChild,wContener,true)\n\t\t}\n\t\treturn this.domres\n\t}\n\t//----------------------------------------------\n\tCBuildNomV1.prototype.buildOneLevel=function(aFirstNodeLevel,aContener,aSubLevel){\t\n\t\tif(aFirstNodeLevel==null) return \n\t\tvar wNode=aFirstNodeLevel\n\t\tvar wFirstChild=null\n\t\twhile (wNode!=null){\n\t\t\tthis.creatElementsHTML(wNode,aContener,(wNode.firstChild==null),false,aSubLevel)\t\n\t\t\twNode=wNode.nextSibling\n\t\t}\n\t}\t\n\t//----------------------------------------------\n\tCBuildNomV1.prototype.creatElementsInfoByCol=function(aFatherDest,aLeaf,aInit,aNl,aSubLevel){\n\t\tif(typeof(gInfoLines.line[aNl])==\"undefined\") return\n\t\tif(ID_Infos.length==0) return \n\t\tvar wOwner=aFatherDest.ownerDocument\n\t\tvar wFathers=null\n\t\tvar wNode=null\n\t\tvar wNodeTxt=null\n\t\tvar wContener=null\n\t\tif(aInit){\n\t\t\twFathers=wOwner.selectNodes(\"//td\")\n\t\t}else{\n\t\t    if(!aSubLevel){\n\t\t\t\twFathers=wOwner.documentElement.selectNodes(\"//div[@id='\"+aFatherDest.getAttribute(\"id\")+\"']\")\n\t\t\t}else{\n\t\t\t\twFathers=document.all(aFatherDest.getAttribute(\"id\"))\n\t\t\t}\n\t\t}\n\t\tif(wFathers.length&lt;2) {\n\t\t\treturn\n\t\t}\n\t\tvar i=1\n\t\tif(aSubLevel &amp;&amp; wFathers.length&lt;=ID_Infos.length) {\n\t\t\ti=0\n\t\t}\n\t\tvar infosline=gInfoLines.line[aNl].infos\n\t\tfor (var k in infosline){\n\t\t\tif(k==\"length\") break;\n\t\t\tif(!aSubLevel){\n\t\t\t\tvar wSubDom=top.Gr_setStringToDom(\"<div>\"+formatColInfo(infosline[k].content)+\"</div>\")\n\t\t\t\twNode=wSubDom.documentElement\n\t\t\t\twNode.setAttribute(\"class\",\"line\")\n\t\t\t\twNode.setAttribute(\"style\",pStyle)\t\n\t\t\t\twContener=wOwner.createNode(1,\"div\",\"\")\t\n\t\t\t\twContener.setAttribute(\"class\",\"ctner\")\t\n\t\t\t\tif(aSubLevel) wContener.setAttribute(\"style\",\"display:none\")\n\t\t\t\twContener.setAttribute(\"id\",\"SUB_LI\"+aNl)\n\t\t\t\twNodeTxt=wOwner.createTextNode(\"\")\n\t\t\t\twContener.appendChild(wNodeTxt)\n\t\t\t}else{\n\t\t\t\tvar wArray1=new Array()\n\t\t\t\tvar wArray2=new Array()\n\t\t\t\twArray1.push(\"&lt;div class='line' style='\"+pStyle+\"'&gt;\"+formatColInfo(infosline[k].content)+\"&lt;/div&gt;\")\n\t\t\t\tif(!aLeaf){\n\t\t\t\t\twArray2.push(\"&lt;div class='ctnr'\")\n\t\t\t\t\tif(aSubLevel) wArray2.push(\" style='display:none'\" )\n\t\t\t\t\twArray2.push(\" id='SUB_LI\"+aNl+\"'\")\n\t\t\t\t\twArray2.push(\"&gt; \")\n\t\t\t\t\twArray2.push(\"&lt;/div&gt;\")\n\t\t\t\t}\t\t\t\t\n\t\t\t}\n\t\t\tif(!aSubLevel){\n\t\t\t\twFathers[i].appendChild(wNode)\n\t\t\t\twFathers[i].appendChild(wContener)\n\t\t\t}else{\n\t\t\t\twFathers[i].insertAdjacentHTML(\"beforeEnd\", wArray1.join(\"\"))\n\t\t\t\tif(!aLeaf) wFathers[i].insertAdjacentHTML(\"beforeEnd\", wArray2.join(\"\"))\n\t\t\t}\n\t\t\ti++\n\t\t\n\t\t}\n\t}\n\t//----------------------------------------------\n\tCBuildNomV1.prototype.creatElementsInfoOneCol=function(aFatherDest,aLeaf,aInit,aNl,aSubLevel){\n\t\tif(ID_Infos.length==0) return \n\t\tif(typeof(gInfoLines.line[aNl])==\"undefined\") return\n\t\tvar wOwner=aFatherDest.ownerDocument\n\t\tvar wFathers=null\n\t\tvar wNode=null\n\t\tvar wNodeTxt=null\n\t\tvar wContener=null\n\t\tif(aInit){\n\t\t\twFathers=wOwner.selectNodes(\"//td\")\n\t\t}else{\n\t\t    if(!aSubLevel){\n\t\t\t\twFathers=wOwner.documentElement.selectNodes(\"//div[@id='\"+aFatherDest.getAttribute(\"id\")+\"']\")\n\t\t\t}else{\n\t\t\t\twFathers=document.all(aFatherDest.getAttribute(\"id\"))\n\t\t\t}\n\t\t}\n\t\tif(typeof(wFathers.length)==\"undefined\") {\n\t\t\tvar wSaveSav=wFathers\n\t\t\twFathers= new Array(1)\n\t\t\twFathers.push(wSaveSav)\n\t\t}\n\n\t\t\n\t\twNode=wOwner.createNode(1,\"div\",\"\")\n\t\twNode.setAttribute(\"class\",\"line\")\t\t\n\t\tvar wTxt=new Array()\n\t\tfor (var k in gInfoLines.line[aNl].infos){\n\t\t\tif(k==\"length\") break;\n\t\t\twTxt.push(gInfoLines.line[aNl].infos[k].content)\n\t\t}\n\t\twNodeTxt=wOwner.createTextNode(wTxt.join(\" \"))\n\t\twNode.appendChild(wNodeTxt)\n\t\tif(!aLeaf){ \n\t\t\twContener=wOwner.createNode(1,\"div\",\"\")\n\t\t\twContener.setAttribute(\"id\",\"SUB_LI\"+aNl)\n\t\t\twContener.setAttribute(\"class\",\"ctner\")\n\t\t\tif(aSubLevel) wContener.setAttribute(\"style\",\"display:none\")\n\t\t\twNodeTxt=wOwner.createTextNode(\"\")\n\t\t\twContener.appendChild(wNodeTxt)\n\t\t}\n\t\tif(!aSubLevel){\n\t\t\twFathers[1].appendChild(wNode)\n\t\t\tif(!aLeaf) wFathers[1].appendChild(wContener)\n\t\t}else{\n\t\t\twFathers[1].insertAdjacentHTML(\"beforeEnd\", wNode.xml)\n\t\t\tif(!aLeaf) wFathers[1].insertAdjacentHTML(\"beforeEnd\", wContener.xml)\n\t\t}\n\t}\n\t//----------------------------------\n\tCBuildNomV1.prototype.creatElementsHTML=function(aRecOrigine,aFatherDest,aLeaf,aInit,aSubLevel){\n\t\tvar wLast=(aRecOrigine.nextSibling==null)\n\t\tvar wBuildNextLevel=false\n\t\tvar wOwner=aFatherDest.ownerDocument\n\t\tif(wOwner==null) wOwner=aFatherDest\n\t\tvar wNl=aRecOrigine.getAttribute(\"NL\") \n\n\t\tvar wNode=wOwner.createNode(1,\"div\",\"\")\n\t\t\n\t\tif(aRecOrigine.parentNode==aRecOrigine.ownerDocument.documentElement)\n\t\t\twNode.setAttribute(\"main\",\"true\")\n\n\t\twNode.setAttribute(\"leaf\",aLeaf.toString())\n\t\twNode.setAttribute(\"id\",\"cadre\"+wNl)\n\t\twNode.setAttribute(\"key\",aRecOrigine.getAttribute(\"ID\"))\n\t\twNode.setAttribute(\"nl\",wNl)\n\n\t\twNode.setAttribute(\"onmousedown\",\"startDrag(this)\")\n\t\tvar wT=aRecOrigine.getAttribute(\"DSC\")\n\t\tif(wT==null){\n\t\t\twT=aRecOrigine.getAttribute(\"CAP\")\n\t\t}\n\t\twNode.setAttribute(\"title\",wT)\n\t\t\n\t\twT=aRecOrigine.getAttribute(\"EXP\")\n\t\tif(wT!=null){\n\t\t\twNode.setAttribute(\"exp\",wT)\n\t\t\tif(wT==\"2\") wBuildNextLevel=true\n\t\t}\n\t\t\n\t\t\n\t\tif(!aLeaf){\n\t\t\tif(wLast) {\n\t\t\t\twNode.setAttribute(\"last\",\"1\")\n\t\t\t\twNode.setAttribute(\"class\",pClass+\"c1l\")\n\t\t\t}else{\n\t\t\t\twNode.setAttribute(\"class\",pClass+\"c1\")\n\t\t\t}\n\t\t}else{\n\t\t\tif(wLast) \t{wNode.setAttribute(\"class\",pClass+\"c5l\")}\n\t\t   \telse\t\t{wNode.setAttribute(\"class\",pClass+\"c5\")}\t\n\t\t   \tif(wNl!=1) wNode.setAttribute(\"onclick\",\"event.cancelBubble=true\")\n\t\t}\n\t\t\n\t\tvar wImg=null \n\t\tif(!aLeaf){ \n\t\t\twImg=wOwner.createNode(1,\"img\",\"\")\n\t\t\tif(wLast) wImg.setAttribute(\"last\",\"1\")\n\t\t\twImg.setAttribute(\"typ\",\"INDIC\")\n\t\t\twImg.setAttribute(\"onmouseup\",\"doClickBtn(this,\"+wNl+\");\")\n\t\t\tif(wBuildNextLevel){\n\t\t\t\twImg.setAttribute(\"onload\",\"doClickBtn(this,\"+wNl+\",true);\")\n\t\t\t}\n\t\t\t//wImg.setAttribute(\"onmousedown\",\"doMouseDownBtn(this,\"+wNl+\");\")\n\t\t\twImg.setAttribute(\"class\",pClass+\"c2\")\n\t\t\tif (aInit) \twImg.setAttribute(\"src\",KLOCRESSOURCES + getImageMoins(wLast))\n\t\t\telse \t\twImg.setAttribute(\"src\",KLOCRESSOURCES + getImagePlus(wLast))\n\t\t\twNode.appendChild(wImg)\n\t\t}\n\t\t\t\t\n\t\tvar wIco=aRecOrigine.getAttribute(\"ICO\")\n\n\t\tvar wNodeLib=wOwner.createNode(1,\"div\",\"\")\n\t\tif(aRecOrigine.parentNode==aRecOrigine.ownerDocument.documentElement)\n\t\t\twNodeLib.setAttribute(\"main\",\"true\")\n\t\twNodeLib.setAttribute(\"nl\",wNl)\n\t\twNodeLib.setAttribute(\"onmouseover\",\"domouseover(this)\") \n\t\twNodeLib.setAttribute(\"onmouseout\",\"domouseout(this)\")\n\t\twNodeLib.setAttribute(\"oncontextmenu\",\"doContextMenu(\"+wNl+\");return false;\")\n\t\t\n\t\tif(wIco!=null &amp;&amp; wIco!=\"\"){\n\t\t\t\twNodeLib.setAttribute(\"style\",\"background-image:url(\"+KRESSTD+\"IMG/\"+wIco+\");\")\n\t\t}\n\t\t\n\t\tif (!aLeaf){\n\t\t\twNodeLib.setAttribute(\"onmousedown\",\"doMouseDownBtn(this.parentElement.firstChild,\"+wNl+\");\") \n\t\t\twNodeLib.setAttribute(\"class\",pClass+\"c4\")\n\t\t\t//wNodeLib.setAttribute(\"onmouseup\",\"doClickBtn(this.parentElement.firstChild,\"+wNl+\");\")\t\t\n\t\t\twNodeLib.setAttribute(\"ondblclick\",\"doDblclick(\"+wNl+\");\")\t\t\n\t\t}else{\n\t\t\twNodeLib.setAttribute(\"onmousedown\",\"doClick(\"+wNl+\");\") \n\t\t\twNodeLib.setAttribute(\"class\",pClass+\"c7\")\n\t\t\twNodeLib.setAttribute(\"ondblclick\",\"doDblclick(\"+wNl+\");\")\t\t\n\t\t}\n\t\t\n\t\tvar wTxt=aRecOrigine.getAttribute(\"CAP\")\n\t\tif(TypeNom &lt;= 2){\n\t\t\t//ajout infos complementaires\n\t\t\tif(typeof(gInfoLines.line[wNl])!=\"undefined\"){\n\t\t\t\tfor (var k in gInfoLines.line[wNl].infos){\n\t\t\t\t\t//gInfoLines.line[wNl].infos[k].format\n\t\t\t\t\twTxt+=\" \"+gInfoLines.line[wNl].infos[k].content\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvar wNodeTxt=wOwner.createTextNode(wTxt)\n\t\twNodeLib.appendChild(wNodeTxt)\n\t\twNode.appendChild(wNodeLib)\n\t\n\t\tvar wNodContener=null\n\t\tif(!aLeaf){\n\t\t\twNodContener=wOwner.createNode(1,\"div\",\"\")\n\t\t\twNodContener.setAttribute(\"id\",\"SUB_LI\"+wNl)\n\t\t\tvar wStyle=\"margin-left:2px;padding-left:12px;\"\n\t\t\tif (aInit) wStyle+=\"display:\";\n\t\t\telse\t   wStyle+=\"display:none\";\n\t\t\twNodContener.setAttribute(\"style\",wStyle)\n\t\t\twNodeTxt=wOwner.createTextNode(\"\")\n\t\t\twNodContener.appendChild(wNodeTxt)\n\t\t\twNode.appendChild(wNodContener)\n\t\t}\n\t\taFatherDest.appendChild(wNode)\n\t\tswitch (TypeNom){\n\t\t\tcase 3 : { this.creatElementsInfoOneCol(aFatherDest,aLeaf,aInit,wNl,aSubLevel);break;}\n\t\t\tcase 4 : { this.creatElementsInfoByCol(aFatherDest,aLeaf,aInit,wNl,aSubLevel);break;}\n\t\t}\t\t\t\n\t\treturn wNodContener\n\t}\t\n\tfunction formatColInfo(content){\n\t\tif(content==null || content==\"\") return content\n\t\tvar wArr=new Array()\n\t\tvar contents=content.split(\"^\")\n\t\tvar wLength=contents.length\n\t\tif(wLength==1) return content\n\t\tvar styles=contents[wLength-1].split(\"|\")\n\t\tfor (var i=0;i&lt;(wLength-1);i++){\n\t\t\twArr.push(\"&lt;div style='display:inline;\"+styles[i]+\"'>\")\n\t\t\twArr.push(contents[i])\n\t\t\twArr.push(\"&lt;/div>\")\n\t\t}\n\t\treturn wArr.join(\"\")\n\t}\n\tfunction CInfo(){\n\t\tthis.id;\n\t\tthis.format=null;\n\t\tthis.content=null;\n\t}\n\tfunction CInfoLine(){\n\t\tthis.infos={};\n\t}\n\tfunction CInfoLines(){\n\t\tthis.line={};\n\t}\n\tgInfoLines=new CInfoLines();\n\t\n\t//-----------------------------------------------\n\tfunction CBuildH(){\n\t\tthis.dom=null\n\t\tthis.domres=null\n\t}\n\t//----------------------------------\n\tCBuildH.prototype.transform=function(aDom){\n\t\tthis.dom=aDom\n\t\tthis.domres = new ActiveXObject(\"Msxml2.DOMDocument.3.0\");\n\t\tthis.domres.loadXML(\"&lt;Data/&gt;\")\n\t\tvar wRec=this.dom.documentElement.firstChild\n\t\tif(wRec!=null){\n\t\t\tvar wDest=CBuildH.creatElementXml(wRec,this.domres.documentElement)\n\t\t\tthis.parcoursTable(this.dom.documentElement.firstChild,wDest)\n\t\t}\n\t\treturn this.domres\n\t}\t\n\t//---------------------------------\n\tCBuildH.prototype.parcoursTable=function(aRec,aDest){\n\t\tvar wRec=null\n\t\tvar wDest=aDest\n\t\twRec=aRec.nextSibling\n\t\tvar wDomElt=this.domres.documentElement\n\t\twhile(wRec!=null &amp;&amp; wRec.childNodes.item(Parent-1)!=null){\n\t\t\tif(wRec.childNodes.item(Key-1)!=null &amp;&amp; wRec.childNodes.item(Key-1).text!=\"\"){\n\t\t\t\tif(wRec.childNodes.item(Parent-1).text==wDest.getAttribute(\"ID\")){\n\t\t\t\t\twDest=CBuildH.creatElementXml(wRec,wDest)\n\t\t\t\t}else{\n\t\t\t\t\twDest=CBuildH.creatElementXml(wRec,wDomElt)\n\t\t\t\t}\n\t\t\t}\n\t\t\twRec=wRec.nextSibling\n\t\t}\n\t\tif(!this.buildHierarchie()){\n\t\t\tthis.domres.loadXML(\"&lt;Data/&gt;\")\n\t\t}\n\t}\n\t//----------------------------------\n\tCBuildH.prototype.buildHierarchie=function(){\n\t\tvar wEl=null\n\t\tvar wIDEl=\"\"\n\t\tvar wIdF=\"\"\n\t\tvar wF=null\n\t\tvar wNodeList=\"\"\n\t\tvar wO=true\n\t\tvar wNode=null\n\t\tvar wDomElt=this.domres.documentElement\n\t\tvar wChild=this.domres.documentElement.childNodes\n\t\twhile(wChild.length!=1 &amp;&amp; wO){\n\t\t\twO=false\n\t\t\twNode=wDomElt.firstChild\n\t\t\twhile (wNode!=null){\n\t\t\t\twEl=wNode\n\t\t\t\twNode=wNode.nextSibling\n\t\t\t\twIdF=wEl.getAttribute(\"FATHER\")\n\t\t\t\tif(wIdF!=null &amp;&amp; wIdF!=\"\"){\n\t\t\t\t\twO=true\n\t\t\t\t\twEl.removeAttribute(\"FATHER\")\n\t\t\t\t\t//wF=wDomElt.selectSingleNode(\"//ID_\"+wIdF)\n\t\t\t\t\twF=wDomElt.selectSingleNode(\"//node[@ID='\"+wIdF+\"']\")\n\t\t\t\t\tif(wF!=null) {\n\t\t\t\t\t\twF.appendChild(wEl)\n\t\t\t\t\t}else{\n\t\t\t\t\t\twEl.parentNode.removeChild(wEl)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\t\n\t\treturn wO\t \n\t}\n\t//---------------------------------\n\tCBuildH.creatElementXml=function(aRecOrigine,aFatherDest){\n\t\t\tvar wId=aRecOrigine.childNodes.item(Key-1).text\n\t\t\t\n\t\t\t//var wNode=aFatherDest.ownerDocument.createNode(1, \"ID_\"+wId, \"\") \n\t\t\tvar wNode=aFatherDest.ownerDocument.createNode(1, \"node\", \"\")\n\t\t\twNode.setAttribute(\"ID\",wId)\n\t\t\t\n\t\t\tvar wA=aRecOrigine.childNodes.item(Parent-1)\n\t\t\tif(wA!=null) wNode.setAttribute(\"FATHER\",wA.text)\n\t\t\t\n\t\t\tvar wNl=null\n\t\t\twA=aRecOrigine.childNodes.item(Nl-1)\n\t\t\tif(wA!=null) {wNode.setAttribute(\"NL\",wA.text);wNl=wA.text}\n\t\t\t\n\t\t\twA=aRecOrigine.childNodes.item(Lib-1)\n\t\t\tif(wA!=null) wNode.setAttribute(\"CAP\",wA.text)\n\t\t\t\n\t\t\twA=aRecOrigine.childNodes.item(LibSh-1)\n\t\t\tif(wA!=null) wNode.setAttribute(\"DSC\",wA.text)\n\n\t\t\twA=aRecOrigine.childNodes.item(Exp-1)\n\t\t\tif(wA!=null) wNode.setAttribute(\"EXP\",wA.text)\n\t\t\t\n\t\t\twA=aRecOrigine.childNodes.item(Ico-1)\n\t\t\tif(wA!=null) wNode.setAttribute(\"ICO\",wA.text)\n\t\t\t\n\t\t\twA=aRecOrigine.childNodes.item(Img-1)\n\t\t\tif(wA!=null) wNode.setAttribute(\"IMG\",wA.text)\n\t\t\t\n\t\t\tfor(var k in ID_Infos){\n\t\t\t\tif(k!=\"length\"){\n\t\t\t\t\tif(typeof(gInfoLines.line[wNl])==\"undefined\"){\n\t\t\t\t\t\tgInfoLines.line[wNl]=new CInfoLine()\n\t\t\t\t\t}\n\t\t\t\t\twA=aRecOrigine.childNodes.item(ID_Infos[k].pos-1)\n\t\t\t\t\tif(wA!=null){ \n\t\t\t\t\t\tgInfoLines.line[wNl].infos[k]=new CInfo();\n\t\t\t\t\t\tgInfoLines.line[wNl].infos[k].format=ID_Infos[k].format\n\t\t\t\t\t\tgInfoLines.line[wNl].infos[k].content=wA.text.replace(/&amp;/g,'&amp;amp;').replace(/&lt;/g,'&amp;lt;')\n\n\t\t\t\t\t\tgInfoLines.line[wNl].infos[k].type=ID_Infos[k].type;\n\t\t\t\t\t}\t\n\t\t\t\t}\t\t\t\t\n\t\t\t};\n\t\t\t\n\t\t\treturn aFatherDest.appendChild(wNode)\n\t}\n\n\t\t<xsl:if test=\"$nbXsl = 2\">\n\t\tfunction doChange(){\n\t\t\tvar wId='<xsl:value-of select=\"$KIDPROC\"/>'\n\t\t\tvar wId1='<xsl:value-of select=\"/Data/MAIN/XSLS/XSL[1]/@XD1\"/>'\n\t\t\tvar wId2='<xsl:value-of select=\"/Data/MAIN/XSLS/XSL[2]/@XD1\"/>'\n\t\t\tvar wNewId=wId2\n\t\t\tif(wId2==wId) wNewId=wId1\n\t\t\tdocument.body.myInterface.changeProcessor(wNewId)\n\t\t}\n\t\t</xsl:if>\n\t\tfunction doImgError()\n\t\t{\n\t\t\tevent.srcElement.setAttribute(\"onerror\",\"\")\n\t\t\tevent.srcElement.src='<xsl:value-of select=\"$KRESSTD\"/>IMG/' + \"unknown.gif\"\n\t\t\tsetTimeout(clearStatus,200)\n\t\t}\n\t\tfunction clearStatus()\n\t\t{\n\t\t\twindow.status=\" \"\n\t\t}\n    \t\tvar objCadre=null //cadre en cours de deplacement\n    \t\tvar pDest=null //rect destination\n    \t//localisation des image client win32\n    \tfunction setImgLocation(aImgOgj,aImg)\n    \t{\n    \t\taImgOgj.setAttribute(\"onerror\",\"\")\n    \t\taImgOgj.src=\"./IMAG/\" + aImg\n    \t}\n    \tfunction getImgLocation(aImg)\n    \t{\n    \t\tif (top.KHTTPCLIENT)\n    \t\t{\n    \t\t\t//return top.Fu_getDataLocation(top.KTYPE_IMGSERV, aImg)\n    \t\t\treturn KLOCRESSOURCES+aImg\n    \t\t}else{\n    \t\t\treturn \"./IMAG/\" + aImg\n    \t\t}\n    \t}\n    \tvar pImgPlus=new Image\n    \tpImgPlus.src=getImgLocation(getImagePlus())\n    \tvar pImgPlusLast=new Image\n    \tpImgPlusLast.src=getImgLocation(getImagePlus(true))  \n    \t  \t\n    \tvar pImgMoins=new Image\n    \tpImgMoins.src=getImgLocation(getImageMoins())\n     \tvar pImgMoinsLast=new Image\n    \tpImgMoinsLast.src=getImgLocation(getImageMoins(true)) \n    \t  \t\n      \tfunction domouseover(aRect)\n      \t{\n\t\tif(pAckCallBusy) return false\n\t\tif(pLock) return false\n     \t\tevent.cancelBubble=true\n     \t\t\tif (objCadre!=null)\n     \t\t\t{\n     \t\t\t\tif(objCadre!=aRect.parentElement)\n     \t\t\t\t{\n     \t\t\t\t\tvar wRec=aRect\n     \t\t\t \t\t//try{\n     \t\t\t \t\t\twRec.style.textDecoration=\"underline\"\n     \t\t\t \t\t/*}catch(e){\n     \t\t\t \t\t\twRec=wRec.nextSibling\n     \t\t\t \t\t\twRec.style.textDecoration=\"underline\"\n     \t\t\t \t\t}*/\n     \t\t\t \t\twRec.style.color=\"red\"\n     \t\t\t \t\tpDest=wRec\n     \t\t\t \t\tXSCROLLER.setScroll()\n     \t\t\t \t}\n     \t\t\t}else{\n\t\t\t\t\tsetOver(aRect)\n     \t\t\t}\n      \t}\n      \tXSCROLLER={\n      \t\tdeltaBorder:50,deltaTop:5,deltaBottom:5,delai:10,deltaMax:20,deltaCount:20,\n      \t\tsetScroll:function(){\n      \t\t\twindow.status=pDest.scrollHeight\n\t      \t    var wPos=getAbsolutePos(pDest)\n\t    \t\tvar wCtn=zoomElement.parentElement\n\t    \t\tif(wPos.top &lt; this.deltaBorder){\n\t    \t\t\tsetTimeout(XSCROLLER.setScrollTop,this.delai);\n\t    \t\t}else if (wPos.top&gt;(wCtn.offsetHeight-this.deltaBorder)){\n\t    \t\t\tsetTimeout(XSCROLLER.setScrollBottom,this.delai);\n\t      \t\t}\n      \t\t},\n      \t\tsetScrollTop:function(){\n      \t\t\tvar wCtn=zoomElement.parentElement\n      \t\t\tvar wPos=getAbsolutePos(pDest)\n      \t\t\tvar wt=Math.max(0,wCtn.scrollTop-XSCROLLER.deltaTop)\n    \t\t\tif(wt>XSCROLLER.deltaTop) cursorPosYStart=cursorPosYStart+XSCROLLER.deltaTop\n    \t\t\twCtn.scrollTop=wt\n    \t\t\t if(XSCROLLER.deltaCount==0 || wPos.top > XSCROLLER.deltaBorder){\n    \t\t\t\tXSCROLLER.deltaCount=XSCROLLER.deltaMax\n    \t\t\t}else{\n    \t\t\t\tXSCROLLER.deltaCount--\n    \t\t\t\tsetTimeout(XSCROLLER.setScrollTop,XSCROLLER.delai);\n    \t\t\t}\n      \t\t},\t\n      \t\tsetScrollBottom:function(){\n      \t\t\tvar wCtn=zoomElement.parentElement\n      \t\t\tvar wPos=getAbsolutePos(pDest)\n      \t\t\tvar wt=Math.min(wCtn.scrollHeight,wCtn.scrollTop+XSCROLLER.deltaBottom)\n    \t\t\tif(wt&lt;(wCtn.scrollHeight-wCtn.offsetHeight)) cursorPosYStart=cursorPosYStart-XSCROLLER.deltaBottom\n    \t\t\twCtn.scrollTop=wt\n    \t\t\tif(XSCROLLER.deltaCount==0 || wPos.top&lt;(wCtn.offsetHeight-XSCROLLER.deltaBorder)){\n    \t\t\t\tXSCROLLER.deltaCount=XSCROLLER.deltaMax\n    \t\t\t}else{\n    \t\t\t\tXSCROLLER.deltaCount--\n    \t\t\t\tsetTimeout(XSCROLLER.setScrollBottom,XSCROLLER.delai);\n    \t\t\t}\n      \t\t}\n      \t}\n      \t//------------------------------------------------------------\n\t\tfunction getAbsolutePos(aEl){\n\t\t\tvar wtrace=\"XTOOLS.getAbsolutePos\"\n\t\t\ttry{\n\t\t\t   var coords = {left: 0, top: 0};\n      \t\n\t\t\t    while (aEl) {\n\t\t\t        coords.left += aEl.offsetLeft-aEl.scrollLeft;\n\t\t\t        coords.top  += aEl.offsetTop-aEl.scrollTop;\n\t\t\t        aEl      = aEl.offsetParent;\n\t\t\t    }\n\t\t\t    return coords;\n\t\t\t}catch(e){return coords}\n\t\t}\n      \tfunction setOver(aElement)\n      \t{\n      \t    if ('<xsl:value-of select=\"$isExecNode\"/>'=='1')\n     \t\t{\n     \t\t\tif(aElement.parentElement.getAttribute(\"leaf\")==\"true\") return\n     \t\t}\n     \t\taElement.style.textDecoration=\"underline\"\n     \t\tif (pCurrentFocus!=aElement) aElement.style.color=\"#316AC5\"\n      \t}\n       \tfunction setOut(aElement)\n      \t{\n     \t\tvar wElement=aElement\n    \t\t//try{\n    \t\t\twElement.style.textDecoration=\"\"\n    \t\t/*}catch(e){\n    \t\t\twElement=wElement.nextSibling\n    \t\t\twElement.style.textDecoration=\"\"\n    \t\t}*/\n     \t\tif(pCurrentFocus!=wElement) wElement.style.color=\"\"\n      \t}     \t\n      \tfunction moveOnRect(aRect)\n      \t{\n\t\tif(pAckCallBusy) return false\n\t\tif(pLock) return false\n      \t\tif(pDest==null) return \n      \t\taRect.style.cursor=\"move\"\n      \t}\n      \tfunction domouseout(aRect)\n      \t{ \t\t\n\t\t\tif(pAckCallBusy) return false\n\t\t\tif(pLock) return false\n  \t\t\tsetOut(aRect)\n  \t\t\tpDest=null\n  \t\t\tevent.cancelBubble=true\n      \t}\n      \t//Poubelle\n      \tfunction domouseoverP(aPoub)\n      \t{\n     \t\t\tif (objCadre!=null)\n     \t\t\t{\n     \t\t\t \t\taPoub.style.border=\"1px solid blue\"\n     \t\t\t \t\tpDest=aPoub\n     \t\t\t}\n      \t}\n      \tfunction domouseoutP(aPoub)\n      \t{ \t\t\n      \t\tif (pDest!=null) \n  \t\t\t\t{\n  \t\t\t\t\tpDest.style.border=\"\"\n  \t\t\t\t\tpDest=null\n  \t\t\t\t}\n      \t}\n\t\t\tfunction startDrag(aCadre) \n\t\t\t{ \n\t\t\t\tif(pAckCallBusy) return false\n\t\t\t\tif(pLock) return false\n\t\t\t\tevent.cancelBubble=true\n\t\t\t\tif ('<xsl:value-of select=\"$isEdit\"/>'=='1') return\n\t\t\t\tif (event.button != 1) return\n\t\t\t   \t objCadre= aCadre\n\t\t\t     \n\t\t\t    if(objCadre!=null) \n\t\t\t    { \n\t\t\t     \tcursorPosXStart=event.clientX; \n\t\t\t      \tcursorPosYStart=event.clientY; \n\t\t\t      \n\t\t\t      \tvar wLeft=0\n\t\t\t      \tif (objCadre.style.left) wLeft=objCadre.style.left\n\t\t\t      \tvar wTop=0\n\t\t\t      \tif (objCadre.style.top) wTop=objCadre.style.top\t\t\t      \n\t\t\t      \tobjPosLeftStart=parseInt(wLeft,10); \n\t\t\t      \tobjPosTopStart=parseInt(wTop,10); \n\t\t\t\t  \tpDepVert=(getcursorPosYStart() - (objCadre.getAttribute(\"gtop\") * pZoom))\n\t\t\t      \tdocument.onmousemove=moveIt; \n\t\t\t    } \n\t\t\t    return false;\n\t\t\t}\n\t\t\tfunction getcursorPosXStart(){return cursorPosXStart + window.MainSpan.scrollLeft}\n\t\t\tfunction getcursorPosYStart(){return cursorPosYStart + window.MainSpan.scrollTop}\n\t\t\tfunction getobjPosLeftStart(){return objPosLeftStart + window.MainSpan.scrollLeft}\n\t\t\tfunction getobjPosTopStart() {return objPosTopStart + window.MainSpan.scrollTop}\n\n\t\t\tfunction moveIt() \n\t\t\t{\n\n\t\t\t\tif(event.button!=1) \n\t\t\t\t{\n\t\t\t\t\tpDest=null\n\t\t\t\t\tendDrag()\n\t\t\t\t\treturn\n\t\t\t\t}\n                          \t\t\tif(document.selection!=null &amp;&amp; document.selection.type!=\"None\")\n\t\t\t\t\t\tdocument.selection.empty()\n\t\t\n\t\t\t    objCadre.style.zIndex=100\n\t\t\t    var cursorPosX = event.clientX; \n\t\t\t    var cursorPosY = event.clientY; \t\t    \t\n\t\t\t\tif(Math.abs(cursorPosX-cursorPosXStart) &gt; 0 ||\n\t\t\t\t   Math.abs(cursorPosY-cursorPosYStart) &gt; 0) \n\t\t\t\t{\n\t\t\t    \tobjCadre.style.top=(getobjPosTopStart()+cursorPosY-getcursorPosYStart() + 30) / pZoom; \n\t\t\t\t\tdocument.body.style.cursor=\"move\"\n\t\t\t\t}else{\n\t\t\t\t\tobjCadre.style.top=(getobjPosTopStart() + cursorPosY-getcursorPosYStart()) / pZoom\n\t\t\t\t}\n\t\t\t    objCadre.style.left=(getobjPosLeftStart()+ cursorPosX-getcursorPosXStart()) / pZoom; \n\t\t \t\treturn true\n\t\t\t} \n\t\t\tfunction endDrag(){ \n\t\t\t   document.body.style.cursor=\"auto\"\n\t\t\t   if (pDest==null){\n\t\t\t        restaurInterface()\n\t\t\t   }else{\n\t\t\t    \tvar wNlFils=objCadre.getAttribute('nl')\n\t\t\t    \tif(pDest.id !=null){\n\t\t\t\t\t\tvar wNlNewPere=0\n\t\t\t\t\t\tvar wNordre=0\n\t\t\t\t\t\tif(event.altKey){\n\t\t\t\t\t\t\tif(pDest.getAttribute(\"main\")!=\"true\") {\n\t\t\t\t\t\t\t\twNordre=1\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(event.shiftKey){\n\t\t\t\t\t\t\tif(pDest.getAttribute(\"main\")!=\"true\") {\n\t\t\t\t\t\t\t\twNordre=-1\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\twNlNewPere=pDest.getAttribute('nl')\n\t\t\t\t\t\tif(wNlFils!=wNlNewPere){\n\t\t\t\t\t\t\tchangePere(wNlNewPere,wNlFils,wNordre)\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\trestaurInterface()\n\t\t\t\t\t\t}\n\t\t\t    \t}else{\n\t\t\t    \t\trestaurInterface()\n\t\t\t\t    }\n\t\t\t    }\n\t\t\t    document.onmousemove=\"\";\n\t\t\t}\nfunction doClickBtn(aBtn,aNl,aLoad){\n\tif(pAckCallBusy) return false\n\tif(pLock) return false\n\tif (aBtn.getAttribute(\"typ\")!=\"INDIC\") return false\n\tif(event.button==2) return\n \taBtn.onload=''\n\tvar wContener=aBtn.parentElement.lastChild\n\tvar wExpend=false\n\tif(wContener.style.display==\"\")\t{\n\t\tif(aLoad) return\n\t\t\n\t\tif(typeof(aBtn.last)==\"undefined\"){\n\t\t\taBtn.src=pImgPlus.src\n\t\t}else{\n\t\t\taBtn.src=pImgPlusLast.src\n\t\t}\n\t\tvar wId=wContener.id\n\t\tvar wElts=document.all(wId)\n\t\tvar wL=wElts.length\n\t\tif(typeof(wL)!=\"undefined\"){\n\t\t\tfor (var i=0; i&lt;wL;i++){\n\t\t\t\twElts[i].style.display=\"none\"\n\t\t\t}\n\t\t}else{\n\t\t\twElts.style.display=\"none\"\n\t\t}\n\t\t\n\t}else{\n\t\tif(!wContener.hasChildNodes()){\n\t\t\twContener.outerHTML=buildInnerSub(wContener.parentElement.nl)\n\t\t}\n\t\tif(typeof(aBtn.last)==\"undefined\"){\n\t\t\taBtn.src=pImgMoins.src\n\t\t}else{\n\t\t\taBtn.src=pImgMoinsLast.src\n\t\t}\n\t\tvar wId=wContener.id\n\t\tvar wElts=document.all(wId)\n\t\tvar wL=wElts.length\n\t\tif(typeof(wL)!=\"undefined\"){\n\t\t\tfor (var i=0; i&lt;wL;i++){\n\t\t\t\twElts[i].style.display=\"\"\n\t\t\t}\t\n\t\t}else{\n\t\t\twElts.style.display=\"\"\n\t\t}\t\t\t\t\t\n\t\twExpend=true\t\t\t\t\t\t\t\n\t}\n\tif(!aLoad) memoExpendCollapseMen(aBtn,wExpend)\n}\n\n//var pCurrentNl=-1\nfunction doMouseDownBtn(aBtn,aNl){\n\tif (aBtn.getAttribute(\"typ\")!=\"INDIC\") return false\n\treturn doClick(aNl)\n}\nfunction memoExpendCollapseMen(aBtn,aExpend)\n{\n\tvar wDocumentElement=document.body.myInterface.getXmlData().documentElement\n\tvar wNlMen=parseInt(aBtn.parentElement.getAttribute(\"nl\"),10)\n\tvar wNodMen=wDocumentElement.selectSingleNode(\"//r[\" + (wNlMen-1) + \"]\")\n\tvar wId=wNodMen.selectSingleNode(\"*[\" + (Key-1) + \"]\").text\n\tvar wIdParent=wNodMen.selectSingleNode(\"*[\" + (Parent-1) + \"]\").text\n\tif(aExpend) memo(wIdParent+\"^\"+wId,\"expend\")\n\telse\t\tremoveMemo(wIdParent+\"^\"+wId)\n}\nfunction memo(aKey,aValue)\n{\n\tremoveMemo(aKey)\n\tdocument.body.myInterface.memo.Add(aKey,aValue)\n}\nfunction removeMemo(aKey)\n{\n\tif(document.body.myInterface.memo.Exists(aKey))\n\t\tdocument.body.myInterface.memo.Remove(aKey)\n}\nfunction setActionMemo(){\nif (typeof(top.To_openPerf)!=\"undefined\") top.To_openPerf(\"setActionMemo\")\n\tvar wResult=\"\"  \n\tvar wArrayKey = (new VBArray(document.body.myInterface.memo.Keys())).toArray(); \n\tvar wMyI=document.body.myInterface\n\tvar wL=wArrayKey.length\n\tfor(var i=0;i&lt;wL;i++)\n\t{\n\t\t//if(wMyI.memo(wArrayKey[i])==\"expend\")\n\t\t// pas d exploitation memo si exp =2 ou exp = 1\n\t\t\tsetExpendFromKey(wArrayKey[i])\n\t}\nif (typeof(top.To_openPerf)!=\"undefined\") top.To_closePerf(\"\")\n}\nfunction setExpendFromKey(aKey){\n\tvar wLine=0\n\tvar wExp=0\n\tvar wKeys=aKey.split(\"^\")\n\tvar wN=getDataFromKey(wKeys[0],wKeys[1])\n\twLine=getNlOfNode(wN) //getNlOfKey(wKeys[0],wKeys[1])\n\tif(wLine&gt;0){\n\t\twExp=getExpOfNode(wN)\n\t\tif(wExp!=0) document.body.myInterface.memo.Remove(aKey)\n\t\telse        setExpendLineByNl(wLine,true)\n\t}else{\n\t\tdocument.body.myInterface.memo.Remove(aKey)\n\t}\n}\nfunction getNlOfKey(aParent,aKey)\n{\n\tvar wColKey=Key-1\n\tvar wColParent=Parent-1\n\tvar wDocumentElement=document.body.myInterface.getXmlData().documentElement\n\t//var wDocumentElement=window.allTable.documentElement\n\tvar wSearch=\"//r[*[\" + wColParent + \" ]='\" + aParent + \"' and *[\" + wColKey + \"]='\" + aKey + \"']\"\n\tvar wNode=wDocumentElement.selectSingleNode(wSearch)\n\tif(wNode==null) return 0\n\treturn parseInt(wNode.firstChild.text,10)\n}\nfunction getNlOfNode(aNode)\n{\n\tif(aNode==null) return 0\n\treturn parseInt(aNode.firstChild.text,10)\n}\nfunction getExpOfNode(aNode)\n{\n\tif(aNode==null) return 0\n\tvar wColExp=Exp-1\n\tif (wColExp==-1) return 0\n\treturn parseInt(aNode.childNodes[wColExp].text,10)\n}\nfunction getDataFromKey(aParent,aKey){\n\tvar wColKey=Key-1\n\tvar wColParent=Parent-1\n\tvar wDocumentElement=document.body.myInterface.getXmlData().documentElement\n\tvar wSearch=\"//r[*[\" + wColParent + \" ]='\" + aParent + \"' and *[\" + wColKey + \"]='\" + aKey + \"']\"\n\treturn wDocumentElement.selectSingleNode(wSearch)\n}\nfunction changePere(aNlPere,aNlFils,aNordre){\n\tvar wDocumentElement=document.body.myInterface.getXmlData().documentElement\n\tvar wPere=wDocumentElement.selectSingleNode(\"//r[\" + (aNlPere-1) + \"]\")\n\tvar wNamePere=wPere.selectSingleNode(\"*[\" + Parent + \"]\").text\n\tvar wCodeRetour=-1\n\tvar wMessage=\"\"\n\tsend1(false,\"M\",aNlFils,aNlPere,aNordre)\n}\n//Double click sur noeud dernier niveau\nfunction execNode(aNl){\n\tvar wCodeRetour=-1\n\tvar wMessage=\"\"\n\tsend1(false,\"E\",aNl,\"\",0)\n}\nvar pAckCallBusy=false\nfunction send1(aSimul,aCodeAct,aNlFils,aNamePere,aNordre)\n{\n\ttry{\n\tif (aSimul) \n\t{\n\t\tvar wtrace=\"Simulation envoi serveur\\n\"\n\t\twtrace+=\"CODACT[\"+aCodeAct+\"]\\n\"\n\t\twtrace+=\"NLI[\"+aNlFils+\"]\\n\"\n\t\twtrace+=\"FATHVAL[\"+aNamePere+\"]\\n\"\n\t\twtrace+=\"RANGNIV[\"+aNordre+\"]\\n\"\n\t\twtrace+=\"MESSAGE[\"+\"\"+\"]\\n\"\n\t\twtrace+=\"CODRET[\"+-1+\"]\\n\"\n\t\talert(wtrace)\n\t\tsimulonAckCallReplydone(false)\n\t}else{\n\t\tinit(1)\n\t\tsetParam(\"CODACT\",aCodeAct)\n\t\tsetParam(\"NLI\",aNlFils)\n\t\tsetParam(\"FATHVAL\",aNamePere)\n\t\tsetParam(\"RANGNIV\",aNordre)\n\t\tsetParam(\"MESSAGE\",\"\")\n\t\tsetParam(\"CODRET\",-1)\n\t\tif(!send())\n\t\t{\n\t\t\trestaurInterface()\n\t\t}else{\n\t\t\tpAckCallBusy=true\n\t\t}\n\t}\n\t}catch(e){restaurInterface()}\n}\n//----------------------------------------------\nfunction simulonAckCallReplydone(aOk)\n{\ntop.setData(top.setTestDataNew())\n//top.frames[0].setFocus(60)\nreturn\n\t\tif(aOk)\n\t\t{\n\t\t\t//Ok\n\t\t}else{ \n\t\t\t//not ok\n\t\t}\n\t\trestaurInterface()\n}\n//------------------------------------------\nfunction doContextMenu(aNl)\n{\t\n\tvar wParam='<MNR L=\"' + aNl + '\"/>'\n\tvar wDom=top.Gr_setStringToDom(wParam)\n\tdocument.body.myInterface.getStringMenu(wDom)\n}\npCurrentFocus=null\nfunction setInterfaceFocus(aElement){\n\tvar wtrace=\"\"\n\ttry{\n\t\tif(pCurrentFocus!=null)\n\t\t{\n\t\t\tpCurrentFocus.style.backgroundColor=\"\"\n\t\t\tpCurrentFocus.style.color=\"\"\n\t\t}\n\t\tvar wNew=null\n\t\tif(aElement!=null){\n\t\t\tif(aElement.getAttribute('leaf')==\"false\")\n\t\t\t{\n\t\t\t\twNew=aElement.lastChild.previousSibling\n\t\t\t}else{\n\t\t\t\twNew=aElement.lastChild\n\t\t\t}\n\t\t\twNew.style.backgroundColor=\"#316AC5\"\n\t\t\twNew.style.color=\"white\"\n\t\t\ttry{wNew.focus()}catch(e){\n\t\t\t\tsetTimeout(\"currentFocusAsynch()\",500)\n\t\t\t}\n\t\t}\n\t\tpCurrentFocus=wNew\n\t\t//fnew\n\t}catch(e){top.Gr_traceErr(arguments,e,wtrace);throw top.Gr_functionError(arguments);}\t\n}\nfunction currentFocusAsynch(){\n\ttry{\n\t\tpCurrentFocus.focus()\n\t}catch(e){}\n}\n//------------------------------------------\nfunction doClick(aNl){\t\n\tvar wtrace=\"\"\n\ttry{\n\t\tif(pAckCallBusy) return false\n\t\tif(pLock) return false\n\t\tvar wParam='<MNR L=\"' + aNl + '\"/>'\n\t\tvar wDom=top.Gr_setStringToDom(wParam)\n\t\tdocument.body.myInterface.clickItem(wDom)\n\t}catch(e){top.Gr_traceErr(arguments,e,wtrace);throw top.Gr_functionError(arguments);}\n}\n//---------------------------------------------\nfunction doDblclick(aNl){\n\tvar wtrace=\"\"\n\ttry{\n\t\tif(pAckCallBusy) return false\n\t\tif(pLock) return false\n\t\tif ('<xsl:value-of select=\"$isExecNode\"/>'!='2') return\n\t\texecNode(aNl)\n\t}catch(e){top.Gr_traceErr(arguments,e,wtrace);throw top.Gr_functionError(arguments);}\n}\n//----------------------------------------------\nfunction onAckCallReplydone(aNodeRep){\n\tpAckCallBusy=false\n\trestaurInterface() //on restaure dans tous les cas au cas ou le serveur de redonne pas les data\n\tif (ackCallTechError(aNodeRep)) return\n\t\n\tvar wCodeRetValue=getParam(\"CODRET\")\n\tif(wCodeRetValue!=null) //le parametre n 'est pas redescendu\n\t{\n\t\tif(wCodeRetValue==1)\n\t\t{\n\t\t\t//Ok\n\t\t}else{ \n\t\t\t//not ok\n\t\t}\n\t}\n\tvar wCodeMessValue=getParam(\"MESSAGE\")\n\tif (wCodeMessValue!=null)\n\t{\n\t\tif(wCodeMessValue!=\"\")\n\t\t{\n\t\t\tsendMess(wCodeMessValue)\n\t\t}\n\t}\n} \nfunction restaurInterface()\n{\n\tif (objCadre!=null)\n\t{\n\t\tobjCadre.style.top=objPosTopStart\n\t\tobjCadre.style.left=objPosTopStart\n\t}\n\tif (pDest!=null)\n\t{\n\t\tpDest.style.textDecoration=\"\"\n\t\tpDest.style.color=\"\"\n\t\tpDest.style.cursor=\"auto\"\n\t}\n\tobjCadre=null; \n\tpDest=null\n}\nfunction ackCallTechError(aNodeRep)\n{\n\tvar wErrn=aNodeRep.getAttribute(\"errn\")\n\tif(wErrn==\"0\") return false\n\tvar wErrl=aNodeRep.getAttribute(\"errl\")\n\tvar wErrm=aNodeRep.getAttribute(\"errm\")\n\tvar wErrp=aNodeRep.getAttribute(\"errp\")\n\tvar wErrt=aNodeRep.getAttribute(\"errt\")\n\tvar wStringMess=\"\"\n\t\n\twStringMess+=\"errn\\t\" + wErrn\n\tif(wErrl!=\"\") wStringMess+=\"\\n\" + \"errl\\t\" + wErrl\n\tif(wErrm!=\"\") wStringMess+=\"\\n\" + \"errm\\t\" + wErrm\n\tif(wErrp!=\"\") wStringMess+=\"\\n\" + \"errp\\t\" + wErrp\n\tif(wErrt!=\"\") wStringMess+=\"\\n\" + \"errl\\t\" + wErrt\n\tdocument.body.myInterface.sendMess(wStringMess)\n\treturn true\n}\nvar pLock=false\nfunction setFocus(aLine){\n\tif(pLock) {return false}\n\tif(pAckCallBusy) {return false}\n\tpLock=true\n\tvar wtrace=\"Xsl\"\n\ttry{\n\t\tvar wName=\"cadre\" + aLine\n\t\tvar wElement=document.all(wName)\n\t\tif(wElement==null){ \n\t\t\tbuildBranche(aLine)\n\t\t\twElement=document.all(wName)\t\t\t\n\t\t}\n\t\tsetExpendLine(wElement)\t\n\t\tsetInterfaceFocus(wElement)\n\t\tvar wIds=getIdsByNl(aLine)\n\t\tmemo(wIds.IdParent+\"^\"+wIds.Id,\"expend\")\n\t\tpLock=false\n\t}catch(e){pLock=false;}\n}\nfunction getIdsByNl(aNl){\n\tvar wIds={}\n\tvar wDocumentElement=document.body.myInterface.getXmlData().documentElement\n\tvar wNodMen=wDocumentElement.selectSingleNode(\"//r[\" + (aNl-1) + \"]\")\n\twIds.Id=wNodMen.selectSingleNode(\"*[\" + (Key-1) + \"]\").text\n\twIds.IdParent=wNodMen.selectSingleNode(\"*[\" + (Parent-1) + \"]\").text\n      return wIds\n}\nfunction buildBranche(aLine){\n\tif(gXmlDomRes==null || gXmlDomRes.documentElement==null) return null\n\tvar wNode=gXmlDomRes.documentElement.selectSingleNode(\"//*[@NL='\"+ aLine +\"']\")\n\tif(wNode==null) return null\n\tvar wHtml=null\n\tvar wNl=0\n\tvar wNodeBuild=null\n\tvar wArrayOfParent=new Array()\n\twhile(wHtml==null || wHtml.lastChild.hasChildNodes()){\n\t\twNode=wNode.parentNode\n\t\twArrayOfParent.push(wNode)\n\t\twNl=wNode.getAttribute(\"NL\")\n\t\twHtml=document.all(\"cadre\" + wNl)\n\t}\n\t\n\tvar wH=null\n\twH=new CBuildNomV1()\n\t\n\tvar wXmlDoc=wH.buildHTMLBranche(wArrayOfParent).documentElement\n\n\tdelete(wH)\n\t\n\twHtml.lastChild.outerHTML=wXmlDoc.xml\n}\nfunction setCollapseAllLines()\n{\n\tvar wList=document.body.getElementsByTagName(\"div\")\n\tvar wLength=wList.length\n\tvar wDomNode=null\n\tfor(var i=0;i&lt;wLength;i++){\n\t\twDomNode=wList[i]\n\t\tif(wDomNode.getAttribute(\"leaf\")==\"false\") setCollapseLineByNl(wDomNode.getAttribute(\"nl\"))\n\t}\n}\nfunction setCollapseLineByNl(aLine)\n{\n\tvar wName=\"cadre\" + aLine\n\tvar wElement=document.all(wName)\n\tsetCollapseLine(wElement)\t\n}\nfunction setCollapseLine(aElement)\n{\n\tvar wtrace=\"Xsl\"\n\ttry{\t\t\n\t\tif(aElement==null) return false\n\t\twtrace+=\"\\n\" + aElement.length\n\t\tif (aElement.getAttribute('leaf')==\"false\")\n\t\t{\n\t\t\tvar wId=aElement.lastChild.id\n\t\t\tvar wElts=document.all(wId)\n\t\t\tvar wL=wElts.length\n\t\t\tif(typeof(wL)!=\"undefined\"){\n\t\t\t\tfor (var i=0; i&lt;wL;i++){\n\t\t\t\t\twElts[i].style.display=\"none\"\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\twElts.style.display=\"none\"\n\t\t\t}\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tif(typeof(aElement.firstChild.last)==\"undefined\"){\n\t\t\t\taElement.firstChild.src=pImgPlus.src\n\t\t\t}else{\n\t\t\t\taElement.firstChild.src=pImgPlusLast.src\n\t\t\t}\n\t\t}\n\t}catch(e){top.Gr_traceErr(arguments,e,wtrace);throw top.Gr_functionError(arguments);}\n}\n\nfunction setExpendAllLines()\n{\n\tvar wList=document.body.getElementsByTagName(\"div\")\n\tvar wLength=wList.length\n\tvar wDomNode=null\n\tfor(var i=0;i&lt;wLength;i++){\n\t\twDomNode=wList[i]\n\t\tif(wDomNode.getAttribute(\"leaf\")==\"true\") setExpendLineByNl(wDomNode.getAttribute(\"nl\"))\n\t}\n}\nfunction setExpendLineByNl(aLine,aWithoutParent)\n{\n\tvar wName=\"cadre\" + aLine\n\tvar wElement=document.all(wName)\n\tsetExpendLine(wElement,aWithoutParent)\t\n}\nfunction setExpendLine(aElement,aWithoutParent){\n\n\tvar wtrace=\"Xsl\"\n\ttry{\t\t\n\t\tif(aElement==null) return false\n\t\tif (aElement.getAttribute('leaf')==\"false\")\n\t\t{\n\t\t\tif(!aElement.lastChild.hasChildNodes()){ \n\t\t\t\taElement.lastChild.outerHTML=buildInnerSub(aElement.lastChild.parentElement.nl)\n\t\t\t}\n\t\t\tvar wId=aElement.lastChild.id\n\t\t\tvar wElts=document.all(wId)\n\t\t\tvar wL=wElts.length\n\t\t\tif(typeof(wL)!=\"undefined\"){\n\t\t\t\tfor (var i=0; i&lt;wL;i++){\n\t\t\t\t\twElts[i].style.display=\"\"\n\t\t\t\t}\t\n\t\t\t}else{\n\t\t\t\twElts.style.display=\"\"\n\t\t\t}\t\t\t\n\t\t\tif(typeof(aElement.firstChild.last)==\"undefined\"){\n\t\t\t\taElement.firstChild.src=pImgMoins.src\n\t\t\t}else{\n\t\t\t\taElement.firstChild.src=pImgMoinsLast.src\n\t\t\t}\n\t\t}\n\t\tif(!aWithoutParent) setExpendParent(aElement)\n\t}catch(e){top.Gr_traceErr(arguments,e,wtrace);throw top.Gr_functionError(arguments);}\n}\nfunction setExpendParent(aCadre)\n{\n\tvar wtrace=\"Xsl\"\n\ttry{\n\t\tif(aCadre==null) return\n\t\tif(aCadre.parentElement==null) return false\n\t\tif(aCadre.parentElement.firstChild==null) return false\n\t\tif(!aCadre.parentElement.hasChildNodes()){\n\t\t\taCadre.parentElement.outerHTML=buildInnerSub(aCadre.parentElement.parentElement.nl)\n\t\t}\n\t\tvar wId=aCadre.parentElement.id\n\t\tvar wElts=document.all(wId)\n\t\tvar wL=null\n\t\tif(wElts!=null){\n\t\t\twL=wElts.length\n\t\t\tif(typeof(wL)!=\"undefined\"){\n\t\t\t\tfor (var i=0; i&lt;wL;i++){\n\t\t\t\t\twElts[i].style.display=\"\"\n\t\t\t\t}\t\n\t\t\t}else{\n\t\t\t\twElts.style.display=\"\"\n\t\t\t}\n\t\t}\t\n\t\tif (aCadre.parentElement.firstChild.getAttribute(\"typ\")==\"INDIC\") \n\t\t{\n\t\t\tif(typeof(aCadre.parentElement.firstChild.last)==\"undefined\"){\n\t\t\t\taCadre.parentElement.firstChild.src=pImgMoins.src\n\t\t\t}else{\n\t\t\t\taCadre.parentElement.firstChild.src=pImgMoinsLast.src\n\t\t\t}\n\t\t}\n\t\tsetExpendParent(aCadre.parentElement)\n\t}catch(e){top.Gr_traceErr(arguments,e,wtrace);throw top.Gr_functionError(arguments);}\n}\nvar main={}\nmain.scrollTop=0\nmain.scrollLeft=0\nfunction scrollMain(){\n\tmain.scrollTop=event.srcElement.scrollTop\n\tmain.scrollLeft=event.srcElement.scrollLeft\n}\nfunction doScrollMain(){\n   try{MainSpan.scrollTop=main.scrollTop}catch(e){}\n}\n</script>\n\n</head>\n</xsl:template>\n</xsl:stylesheet>","stt":327675}}}}},"session":{"settings":{"adonix.os.password":"1234"}},"srvop":{"request":{"id":0,"v":0,"session":"e273f5a4-19f5-45b8-bbf0-042dd92ae4d1_1717449684","status":0,"server":"ecvmdevrhx64"}}},
"r1":{
  "sap": {
    "target": {
      "ist": {
        "fmt": "edit",
        "edit": true,
        "xid": "AA3",
        "win": "B",
        "nl": 1
      },
      "type": "ist"
    },
    "wins": {"B": {
      "tit": "Vertical title",
      "entities": {}
    }}
  },
  "session": {},
  "srvop": {"request": {
    "id": 0,
    "v": 0,
    "status": 0
  }}
},
"r2":{
  "sap": {
    "target": {
      "ist": {
        "fmt": "edit",
        "edit": true,
        "xid": "AA4",
        "win": "B",
        "nl": 1
      },
      "type": "ist"
    },
    "wins": {"B": {
      "tit": "Vertical title",
      "entities": {}
    }}
  },
  "session": {},
  "srvop": {"request": {
    "id": 0,
    "v": 0,
    "status": 0
  }}
},
"r3":{
  "sap": {
    "target": {
      "ist": {
        "fmt": "edit",
        "edit": true,
        "xid": "AA5",
        "win": "B",
        "nl": 1
      },
      "type": "ist"
    },
    "wins": {"B": {
      "tit": "Vertical title",
      "entities": {}
    }}
  },
  "session": {},
  "srvop": {"request": {
    "id": 0,
    "v": 0,
    "status": 0
  }}
},
"r4":{
  "sap": {
    "target": {
      "ist": {
        "fmt": "edit",
        "edit": true,
        "xid": "AA6",
        "win": "B",
        "nl": 1
      },
      "type": "ist"
    },
    "wins": {"B": {
      "tit": "Vertical title",
      "entities": {}
    }}
  },
  "session": {},
  "srvop": {"request": {
    "id": 0,
    "v": 0,
    "status": 0
  }}
},
"r5":{
  "sap": {
    "target": {
      "ist": {
        "fmt": "edit",
        "edit": true,
        "xid": "AA7",
        "win": "B",
        "nl": 1
      },
      "type": "ist"
    },
    "wins": {"B": {
      "tit": "Vertical title",
      "entities": {}
    }}
  },
  "session": {},
  "srvop": {"request": {
    "id": 0,
    "v": 0,
    "status": 0
  }}
},
"r6":{
  "sap": {
    "target": {
      "ist": {
        "fmt": "edit",
        "edit": true,
        "xid": "AA8",
        "win": "B",
        "nl": 1
      },
      "type": "ist"
    },
    "wins": {"B": {
      "tit": "Vertical title",
      "entities": {}
    }}
  },
  "session": {},
  "srvop": {"request": {
    "id": 0,
    "v": 0,
    "status": 0
  }}
},
"r7":{
  "sap": {
    "target": {
      "ist": {
        "fmt": "edit",
        "edit": false,
        "xid": "AA9",
        "win": "B",
        "nl": 1
      },
      "type": "ist"
    },
    "wins": {"B": {
      "tit": "Vertical title",
      "entities": {}
    }}
  },
  "session": {},
  "srvop": {"request": {
    "id": 0,
    "v": 0,
    "status": 0
  }}
},
"r8":{
  "sap": {"target": {
    "ist": {
      "fmt": "edit",
      "edit": false,
      "xid": "AA2",
      "win": "B",
      "nl": 2
    },
    "type": "ist"
  }},
  "session": {},
  "srvop": {"request": {
    "id": 0,
    "v": 0,
    "status": 0
  }}
},
"r9":{
  "sap": {"target": {
    "ist": {
      "fmt": "edit",
      "edit": false,
      "xid": "AA3",
      "win": "B",
      "nl": 2
    },
    "type": "ist"
  }},
  "session": {},
  "srvop": {"request": {
    "id": 0,
    "v": 0,
    "status": 0
  }}
 },
"r10":{  "sap": {"target": {
    "ist": {
      "fmt": "edit",
      "edit": false,
      "xid": "AA4",
      "win": "B",
      "nl": 2
    },
    "type": "ist"
  }},
  "session": {},
  "srvop": {"request": {
    "id": 0,
    "v": 0,
    "status": 0
  }}
 },
"r11":{  "sap": {"target": {
    "ist": {
      "fmt": "edit",
      "edit": false,
      "xid": "AA5",
      "win": "B",
      "nl": 2
    },
    "type": "ist"
  }},
  "session": {},
  "srvop": {"request": {
    "id": 0,
    "v": 0,
    "status": 0
  }}
  }
}