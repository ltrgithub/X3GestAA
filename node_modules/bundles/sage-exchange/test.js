require('streamline').register();
var assert = require('assert');
var sgex = require('bundles/sage-exchange');
var jsxml = require('jsxml');


// Account Query
var dotValues = 'Application.ApplicationID=SAGEERPX5X00000ERPLAAA5USEN' +
	',Application.LanguageID=EN' +
	',AccountQuery.Merchant.MerchantID=941457786836' +
	',AccountQuery.Merchant.MerchantKey=F6K7Y7E7C7T7';

sgex.genericCall(function(err, result) {
	if (err) throw err;
	console.log('\n\n Account Query Response = ' + result.Response.ResponseIndicator + ' -> ' + result.Response.ResponseMessage);
}, dotValues, 'AccountQueryResponse');



// Vault Query
var dotValues = 'Application.ApplicationID=SAGEERPX5X00000ERPLAAA5USEN' +
	',Application.LanguageID=EN' +
	',VaultStatusQuery.Merchant.MerchantID=941457786836' +
	',VaultStatusQuery.Merchant.MerchantKey=F6K7Y7E7C7T7' +
	',VaultStatusQuery.VaultID=cb3ce1cf-fa85-5b49-90f8-96766027f94f1';

sgex.genericCall(function(err, result) {
	if (err) throw err;
	console.log('\n\n Vault Query Response = ' + result.Response.ResponseIndicator + ' -> ' + result.Response.ResponseMessage);
}, dotValues, 'VaultStatusQueryResponse');



// Authorization Request
var dotValues = 'Application.ApplicationID='                 + 'SAGEERPX5X00000ERPLAAA5USEN' +
	',Application.LanguageID='                               + 'EN' +
	',Payments.PaymentType.Merchant.MerchantID='             + '941457786836' +
	',Payments.PaymentType.Merchant.MerchantKey='            + 'F6K7Y7E7C7T7' +
	',Payments.PaymentType.TransactionBase.TransactionID='   + '954db4cc-6cbb-784a-be1a-b1dd64' +
	',Payments.PaymentType.TransactionBase.TransactionType=' + '02' +
	',Payments.PaymentType.TransactionBase.Reference1='      + 'SONNA0120053' +
	',Payments.PaymentType.TransactionBase.Amount='          + '178633.50' +
	',Payments.PaymentType.Customer.Name.FirstName='         + "'It's everywhere you want to be" +
	',Payments.PaymentType.Customer.Address.AddressLine1='   + '848 S Robertson Blvd' +
	',Payments.PaymentType.Customer.Address.AddressLine2='   + '' +
	',Payments.PaymentType.Customer.Address.City='           + 'CHICAGO' +
	',Payments.PaymentType.Customer.Address.State='          + 'IL' +
	',Payments.PaymentType.Customer.Address.ZipCode='        + '60602' +
	',Payments.PaymentType.Customer.Address.Country='        + 'US' +
	',Payments.PaymentType.Customer.Address.EmailAddress='   + '' +
	',Payments.PaymentType.VaultStorage.GUID='               + '75592b4aae4d43fdba6ab1d6490cca0b' +
	',Payments.PaymentType.VaultStorage.Service='            + 'RETRIEVE';

sgex.genericCall(function(err, result) {
	if (err) throw err;
	console.log('\n\n Authorization Response = ' + result.PaymentResponseType.Response.ResponseIndicator + ' -> ' + result.PaymentResponseType.Response.ResponseMessage);
}, dotValues, 'PaymentResponses');


// Vault Create
var tokens = 'ApplicationID=' + 'SAGEERPX5X00000ERPLAAA5USEN' +
	',LanguageID='            + 'EN' +
	',MerchantID='            + '941457786836' +
	',MerchantKey='           + 'F6K7Y7E7C7T7' +
	',VaultID='               + '954db4cc-6cbc-784a-be1a-b1dd64' +
	',GUID='                  + '75592b4aae4d43fdba6ab1d6490cca0b' +
	',Service='               + 'CREATE' +
	',Enabled='               + 'true' +
	',Visible='               + 'true';


sgex.getRedirectUrl(function(err, result) {
	if (err) throw err;
	console.log('\n\n Vault Create Response = ' + result);
}, tokens, '10');