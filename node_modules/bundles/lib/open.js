var exec = require('child_process').exec;

var platform = {
	'darwin': 'open',
	'win32': 'start ""',
	'linux': 'xdg-open'
};
var opencmd = platform[process.platform] || platform.linux;
if (process.env.SUDO_USER) opencmd = 'sudo -u ' + process.env.SUDO_USER + ' ' + opencmd;

/**
 * open a file or uri using the default application for the file type.
 *
 * @return {ChildProcess} - the child process object.
 * @param {string} target - the file/uri to open.
 * @param {function(Error)} callback - called with null on success, or
 *      an error object that contains a property 'code' with the exit
 *      code of the process.
 */
exports.open = function(target, callback) {
	if (!target) return callback("No target");
	return exec(opencmd + ' "' + target.replace(/"/g, '\\\"') + '"', callback);
};
