require('streamline').register();
var sgex = require('bundles/sage-exchange'),
	jsxml = require('jsxml');

var values, defVals = {
		ApplicationID: 'SAGEERPX5X00000ERPLAAA5USEN',
		LanguageID: 'en-US',
		MerchantID: '941457786836',
		MerchantKey: 'F6K7Y7E7C7T7'
	};

// Account Query
values = 'Application.ApplicationID=' + defVals.ApplicationID +
	',Application.LanguageID=' + defVals.LanguageID +
	',AccountQuery.Merchant.MerchantID=' + defVals.MerchantID +
	',AccountQuery.Merchant.MerchantKey=' + defVals.MerchantKey;

sgex.seRequest(function(err, result) {
	if (err) throw err;
	console.log('\n\n Account Query Response = ' + result.Response.ResponseIndicator + ' -> ' + result.Response.ResponseMessage);
}, values, 'AccountQueryResponse');


// Vault Query
values = 'Application.ApplicationID=' + defVals.ApplicationID +
	',Application.LanguageID=' + defVals.LanguageID +
	',VaultStatusQuery.Merchant.MerchantID=' + defVals.MerchantID +
	',VaultStatusQuery.Merchant.MerchantKey=' + defVals.MerchantKey +
	',VaultStatusQuery.VaultID=cb3ce1cf-fa85-5b49-90f8-96766027f94f1';

sgex.seRequest(function(err, result) {
	if (err) throw err;
	console.log('\n\n Vault Query Response = ' + result.Response.ResponseIndicator + ' -> ' + result.Response.ResponseMessage);
}, values, 'VaultStatusQueryResponse');


// Authorization Request
values = 'Application.ApplicationID=' + defVals.ApplicationID +
	',Application.LanguageID=' + defVals.LanguageID +
	',Payments.PaymentType.Merchant.MerchantID=' + defVals.MerchantID +
	',Payments.PaymentType.Merchant.MerchantKey=' + defVals.MerchantKey +
	',Payments.PaymentType.TransactionBase.TransactionID=' + '954db4cc-6cbb-784a-be1a-b1dd64' +
	',Payments.PaymentType.TransactionBase.TransactionType=' + '02' +
	',Payments.PaymentType.TransactionBase.Reference1=' + 'SONNA0120053' +
	',Payments.PaymentType.TransactionBase.Amount=' + '178633.50' +
	',Payments.PaymentType.Customer.Name.FirstName=' + "'It's everywhere you want to be" +
	',Payments.PaymentType.Customer.Address.AddressLine1=' + '848 S Robertson Blvd' +
	',Payments.PaymentType.Customer.Address.AddressLine2=' +
	',Payments.PaymentType.Customer.Address.City=' + 'CHICAGO' +
	',Payments.PaymentType.Customer.Address.State=' + 'IL' +
	',Payments.PaymentType.Customer.Address.ZipCode=' + '60602' +
	',Payments.PaymentType.Customer.Address.Country=' + 'US' +
	',Payments.PaymentType.Customer.Address.EmailAddress=' +
	',Payments.PaymentType.VaultStorage.GUID=' + '75592b4aae4d43fdba6ab1d6490cca0b' +
	',Payments.PaymentType.VaultStorage.Service=' + 'RETRIEVE';

sgex.seRequest(function(err, result) {
	if (err) throw err;
	console.log('\n\n Authorization Response = ' + result.PaymentResponseType.Response.ResponseIndicator + ' -> ' + result.PaymentResponseType.Response.ResponseMessage);
}, values, 'PaymentResponses');


// Vault Create
values = 'Application.ApplicationID=' + defVals.ApplicationID +
	',Application.LanguageID=' + defVals.LanguageID +
	',VaultOperation.Merchant.MerchantID=' + defVals.MerchantID +
	',VaultOperation.Merchant.MerchantKey=' + defVals.MerchantKey +
	',VaultOperation.VaultID=cb3ce1cf-fa85-5b49-90f8-96766027f94f1' +
	',VaultOperation.VaultStorage.GUID=75592b4aae4d43fdba6ab1d6490cca0b' +
	',VaultOperation.VaultStorage.Service=CREATE' +
	',UI.VaultOperation.AccountNumber.Enabled=true' +
	',UI.VaultOperation.AccountNumber.Visible=false';

sgex.getRedirectUrl(function(err, result) {
	if (err) throw err;
	console.log('\n\n Vault Create Response = ' + result);
}, values, '10');
