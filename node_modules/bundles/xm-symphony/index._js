"use strict";
/// !doc
///
/// # Integration bundle for XM Symphony
///
var config = require('config');
exports.$exported = true;

var httpClient = require('syracuse-httpclient/lib/httpClient'),
	url = require('url')


// Send request to Symphony and receive response.
exports.requestCreate = function(_, values) {
	// console.log('\n\n ' + ' request = ' + values);
	var req = "request=" + encodeURIComponent(values);
	var request = httpClient.httpRequest(_, {
		url: 'https://signup.us.xmsymphony.com/api/create',
		method: 'POST',
		headers: {
			'content-type': 'application/json',
			'content-length': req.length,
		}
	});
	request.write(_, req, 'utf8');
	var resp = request.end().response(_);
	if (resp.statusCode != 200) {
		console.log(resp.statusCode + ': ' + resp.readAll(_));
		console.log(resp.headers);
		return null;
	} else {
		var json = resp.readAll(_);
		// console.log('\n\n JSON response = ' + JSON.stringify(json,undefined,2));
		return json;
	}
};

// Get Web API URL from config
exports.getWebApiUrl = function (_) {
	return config.symphony.webApiUrl;
};

// Get AWS region from config
exports.getAwsRegion = function(_) {
	return config.aws.region;
};
