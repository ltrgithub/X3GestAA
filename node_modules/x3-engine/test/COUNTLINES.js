var z = require('x3-engine/lib/basic'),r=require,e=exports,p=[],B=z.B,NL=z.NL,A=z.A,DECL=z.DECL,C=z.C,SET=z.SET,V=z.V,F=z.F,FILE=z.FILE,WHILE=z.WHILE,GO=z.GO,FORF=z.FORF,REQ=z.REQ,GOSUB=z.GOSUB,PLUSEQ=z.PLUSEQ,ERRBOX=z.ERRBOX,SUB=z.SUB,END=z.END,CLOSE=z.CLOSE,OPEN=z.OPEN,CV=z.CV,NIY=z.NIY,EQ=z.EQ,IF=z.IF,AND=z.AND,NE=z.NE,ADD=z.ADD,LT=z.LT,CASE=z.CASE,WHEN=z.WHEN,RET=z.RET;z.BEGIN(module);NL(0);z.MAIN(e);e.MAIN=B(DECL('LS','CHAINE',A([C(250)]))
,NL(1),DECL('LI','NB_INST'),DECL('LI','MINCH')
,NL(1),DECL('LI','I'),DECL('LI','J'),DECL('LI','K'),DECL('LI','L'),DECL('LI','M'),DECL('LI','MINCH')
,NL(1),SET(V('SAVIFS'),V('ADXIFS'))
,NL(1),SET(V('SAVIRS'),V('ADXIRS'))
,NL(1),SET(V('SAVIUM'),V('ADXIUM'))

,NL(2),SET(V('ADXIFS'),C(''))
,NL(1),SET(V('ADXIRS'),F('CHR$',[C(10)]))
,NL(1),SET(V('ADXIUM'),V('GUTF8'))



,NL(4),DECL('LI','NB_PROG'),DECL('LI','NB_INST')
,NL(1),GO(p,1));p[1]=FORF('PRG','null',p,2,B(
NL(1),GOSUB(C(e),'ANALYZE_PROG')
,NL(1),PLUSEQ(V('NB_PROG'),C(1))
));p[2]=B(
NL(2),ERRBOX((SUB(F('NUM$',[V('NB_PROG')]),F('NUM$',[V('NB_INST')]))))

,NL(2),SET(V('ADXIFS'),V('SAVIFS'))
,NL(1),SET(V('ADXIRS'),V('SAVIRS'))
,NL(1),SET(V('ADXIUM'),V('SAVIUM'))

,NL(2),END()); 

e.ANALYZE_PROG=B(
NL(3),OPEN(F('FILPATH',[C('TRT'),CV('PRG','','PROGRAMS'),C('src')]),'r')
,NL(1),SET(V('CHAINE'),C(''))
,NL(1),NIY({tag:'RDSEQ',exps:A([V('CHAINE')]),using:CV('RRR','','null')})
,NL(1),GO(p,3));p[3]=WHILE((EQ(V('FSTAT'),C(0))),p,4,B(
NL(1),IF((AND((NE(F('ASCII',[V('CHAINE')]),C(38))),(NE(F('VIREBLC',[V('CHAINE'),C(2)]),C(''))))),p,5,B(
NL(1),SET(V('M'),C(0))
,NL(1),PLUSEQ(V('NB_INST'),(EQ(F('FIND',[F('ASCII',[F('VIREBLC',[F('RIGHT$',[V('CHAINE'),V('M')]),C(0)])]),C(35),C(0)]),C(0))))
,NL(1),GO(p,6),GO(p,5)))));p[6]=WHILE((EQ(V('M'),C(0))),p,7,B(
NL(1),SET(V('I'),F('INSTR',[V('M'),(ADD(V('CHAINE'),C("'"))),C("'")])),SET(V('J'),F('INSTR',[V('M'),(ADD(V('CHAINE'),C('"'))),C('"')])),SET(V('K'),F('INSTR',[V('M'),(ADD(V('CHAINE'),C(':'))),C(':')])),SET(V('L'),F('INSTR',[V('M'),(ADD(V('CHAINE'),C('#'))),C('#')]))
,NL(1),SET(V('MINCH'),F('MIN',[V('I'),V('J'),V('K'),V('L')]))
,NL(1),IF((LT(V('MINCH'),F('LEN',[V('CHAINE')]))),p,8,B(
NL(1),CASE(V('MINCH'),p,10,11)
,GO(p,9)))),true);p[10]=WHEN([V('L')],p,12,B(NL(1),SET(V('M'),C(0))
,GO(p,11)));p[12]=WHEN([V('I')],p,13,B(NL(1),SET(V('M'),F('INSTR',[(ADD(V('I'),C(1))),V('CHAINE'),C("'")])),PLUSEQ(V('M'),(NE(V('M'),C(0))))
,GO(p,11)));p[13]=WHEN([V('J')],p,14,B(NL(1),SET(V('M'),F('INSTR',[(ADD(V('J'),C(1))),V('CHAINE'),C('"')])),PLUSEQ(V('M'),(NE(V('M'),C(0))))
,GO(p,11)));p[14]=WHEN([V('K')],p,15,B(NL(1),SET(V('M'),(ADD(V('K'),C(1)))),PLUSEQ(V('NB_INST'),(EQ(F('FIND',[F('ASCII',[F('VIREBLC',[F('RIGHT$',[V('CHAINE'),V('M')]),C(0)])]),C(35),C(0)]),C(0))))
,GO(p,11)));p[15]=WHEN([NIY({tag:'DEFAULT'})],p,11,B(NL(1),SET(V('M'),C(0))
,GO(p,11)));p[11]=B(
);p[8]=B(
NL(3),SET(V('M'),C(0))
,GO(p,9));p[9]=B(
);p[7]=B(
);p[5]=B(
NL(4),SET(V('CHAINE'),C(''))
,NL(1),NIY({tag:'RDSEQ',exps:A([V('CHAINE')]),using:CV('RRR','','null')})
);p[4]=B(
NL(2),CLOSE()
,NL(1),RET()); 
