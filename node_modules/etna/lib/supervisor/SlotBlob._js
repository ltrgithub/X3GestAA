"use strict";

var util = require('util');
var SlotLob = require("etna/lib/supervisor/slotlob").SlotLob;
var Blbfile = require('etna/lib/engine/runtime/tblbfile').Blbfile;

class SlotBlob extends SlotLob {
	constructor(parent, property) {
		super(parent, property);
	}

	_get(_,raw) {
		if(raw) return null;// For resource.toJson  
		
		if(!this._value) {
			var data = this.read(_);
			if(data !== undefined) this._value = new Blbfile(data);
		}
		return super._get(_,raw);
	}
}

exports.SlotBlob = SlotBlob;

exports.newSlotBlob = function(property) {
	return function(_, parent) {
		return new SlotBlob(parent, property);
	};
};
