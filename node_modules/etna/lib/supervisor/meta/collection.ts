"use strict";

import * as util from '../util';
const tracerJs = require('syracuse-core').getTracer("etna.supervisor");

export class Collection {
	constructor(superv, clas, data) {
		this.supervisor = superv;
		this.class = clas;
		this.data = data;
	}
	init(_) {
		return this;
	}
	get name() {
		return this.data.CODCOL;
	}
	get jsName() {
		return this.data._proxyName;
	}
	get isInstance() {
		return this.mappingData && this.mappingData.TYPLNK === 3;
	}
	get nbrPro() {
		return this.class.data.PROPERTIES.length;
	}
	getSql(_, colNames, tableNames, wheres, params, descs, cache, raw, sqlOpts) {
		const properties = this.class.properties;

		tracerJs.debug && tracerJs.debug("collection.getSql:" + Object.keys(properties));
		this.class.cache = cache;
		Object.keys(properties).forEach_(_, (_, name) => {
			properties[name].getSql && properties[name].getSql(_, colNames, tableNames, wheres, params, descs, cache, raw, sqlOpts);
		}, this);
	}
};

export const Constructor = Collection;