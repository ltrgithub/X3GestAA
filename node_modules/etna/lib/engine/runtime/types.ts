import { _ } from "streamline-runtime";
import * as core from 'syracuse-core';
import { Slots } from './slots';
//import { DBTable } from './dbtable';
//import { DBTableSQL } from './dbtablesql';
//import * as superv from '../../supervisor/supervisor';

export interface FrameTable {
	sisters: string[];
	slot: number;
	local: number;
	inFrontOf: FrameTable;
}

export interface FrameGClass {
	inFrontOf: FrameGClass;
}

export interface FrameWhereContext {
	revert: boolean;
}
export interface FrameContext {
	tables: { [abbrev: string]: FrameTable };
	gclass: { [abbrev: string]: FrameGClass };
	tableSlots: Slots;
	superv: any; // see later
}

export interface Frame {
	context: FrameContext;
	abbrev: string;
	whereContext: FrameWhereContext;
	tryingSql: boolean;
}

export interface VariableType {

}
export interface VariableDict {
	types: VariableType[];
	values: any[];
}

export type VariableOp = {
	fn: (frame: Frame, dict: VariableDict, field: string, val?: any, silent?: boolean, strict?: boolean) => any;
	error: (_: _, frame: Frame, field: string, val?: any, silent?: boolean, strict?: boolean) => void;
}

export interface Expression<T> {
	(_: _, op?: VariableOp): T;
	value?: T;
}

export interface ParseNode {
	tag: string;
}

export interface Driver {
	nullDate(): core.types.date.DateValue;
}

export type Row = { [name: string]: any };

export interface RowDescType {
	fromSql(_: _, val: any): any;
}
export interface RowDesc {
	name: string;
	type: RowDescType;
}