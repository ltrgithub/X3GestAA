"use strict";

const glob = require('streamline/lib/globals');
import * as util from './util';

export const functions = {
	MAXTAB: {
		count: 1,
		fn(arr) {
			return 1;
		}
	}
};

function _insDela(isDel) {
	return function (ints, vars) {
		const aints = util.instructions.A(ints);
		const avars = util.instructions.A(vars);

		return function insa$do(_) {
			aints(_);
			avars(_);
		};
	};
}

export const instructions = {
	RANGE(lo, hi) {
		hi = hi || util.instructions.C(null);
		return function range$do(_) {
			lo(_);
			hi(_);
		};
	},
	INDEX(target, args) {
		const aargs = util.instructions.A(args);

		return function index$do(_, assign, val) {
			target && target(_);
			aargs && aargs(_);
		};
	},
	SORTA(rep, vars, orders, direction) {
		const avars = util.instructions.A(vars);

		return function sorta$do(_) {
			rep && rep(_);
			direction && direction(_);
			avars && avars(_);
		};
	},
	INSA: _insDela(false),
	DELA: _insDela(true)
};