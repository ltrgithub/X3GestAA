"use strict";
/// !doc
/// [x3js dev guide](x3js-development-guide) > [x3js APIs](x3js-apis) > x3js unit test
/// 
/// # x3js unit test
/// 
/// TBD
const globals = require('streamline-runtime').globals;
const flows = require('streamline-runtime').flows;

exports.define = def => {
	if (!def.module) throw new Error(`unit test module missing`);
	if (!def.name) throw new Error(`unit test name missing`);
	if (!def.cases) throw new Error(`${def.name}: unit test cases missing`);
	const cx = globals.context;
	describe(def.name, function() {
		def.cases.filter(cas => cas.execute).forEach(cas => {
			it(cas.name, function(done) {
				return flows.withContext(() => {
					cas.execute.call(this, done);
				}, cx)();
			});
		});
	});
}
