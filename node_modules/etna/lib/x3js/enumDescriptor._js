"use strict";
const x3jsUtil = require('./util');

function isReadOnly(_, instance) {
	if (instance._parent) return isReadOnly(_, instance._parent);
	return /^(4gl|incomplete)$/.test(instance.status(_));
}

module.exports = {
	type: 'object',
	defineMethod: 'defineEnum',
	properties: {
		module: {
			type: 'string',
		},
		name: {
			type: 'string',
		},
		dictId: {
			type: 'integer',
			dictId: 'LANCHP',
		},
		title: {
			type: 'string',
			localization: 'system',
			dictCode: 'LANMES',
		},
	},
	collections: {
		entries: {
			type: 'object',
			key: 'name',
			metaCode: '',
			orderCode: 'LANNUM',
			properties: {
				dictId: {
					type: 'integer',
					dictCode: 'LANNUM',
				},
				title: {
					type: 'string',
					dictCode: 'LANMES',
				},
			},
			rules: {
				readOnlyProperty: isReadOnly,
			},
		},
	},
	rules: {
		readOnlyProperty: isReadOnly,
	}
};
