"use strict";
console.log("runScript");

var fs = require('streamline-fs');
var syracuse = require('syracuse-main/lib/syracuse');
var helpers = require('syracuse-core').helpers;
var util = require("etna/lib/supervisor/util");
var globals = require('streamline/lib/globals');
var adminHelper = require("syracuse-collaboration/lib/helpers").AdminHelper;
var flows = require("streamline/lib/util/flows");

module.exports = function(_, name) {
	console.log("runScript " + name);
	var config = {
		"endpointName": "etnaOracle",
		"solutionName": "SOLSUPV6",
		"folderName": "SUPERV",
		"solutionPath": "C:/_syracuse/syracuse/",
		"mongo": {
			"host": "localhost",
			"port": 27017,
			"database": "SOLSUPV6-SUPERV"
		},
		"sql": {
			"driver": "oracle",
			"user": "SUPERV",
			"password": "tiger",
			"database": "X3DVLP",
			"port": 1521,
			"hostname": "sodaix02"
		}
	};

	/*
    var epEtna;
    var eps = adminHelper.getEndpoints(_, {});
    flows.some(_, eps, function(_, ep) {
        if ("x3" === ep.protocol(_) && "etnaOracle" === ep.dataset(_)) {
            epEtna = ep;
            return true
        }
        return false;
    });

    config =  (epEtna && epEtna.getEtnaConfig(_)) || config;
    var supervisor = require('etna/lib/supervisor/supervisor');
    var superv = supervisor.create(_,config);
    */
	try {
		var supervisor = require('etna/lib/supervisor/supervisor');
		var superv = supervisor.create(_, config);
		var script = superv.loadScript(_, name, 'C:/_syracuse/syracuse/Syracuse/node_modules/etna/test/engine/server');
		require("etna/lib/engine/runtime/variables").initStack(superv);
		script.MAIN(_);
	} catch (e) {
		console.log("e:" + JSON.stringify(e));
	}
};