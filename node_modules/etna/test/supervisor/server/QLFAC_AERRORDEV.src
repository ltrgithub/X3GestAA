#<AdxTL>@(#)8.0.0.0 $Revision$
TOTO = func TESTSUITE()
Infbox TOTO

End

# ---------- TEST_SUITE uni function       -------------------------
# ------------------------------------------------------------------

Funprog TESTSUITE()

    Call ADD_TESTCASE("TEST_ERROR0", "Test instance/Collection", 178) From AXUNIT


End func AXUNIT.RUN_TESTSUITE("Types", "Common")

# -----------------------TEST_WR_READ -------------------------------------
# #########################################################################

Subprog TEST_ERROR0( )

Local Integer I
Local Char TC(255),EVENT(50)
Local Integer MY_STATUS,ASTATUS,LINE_NUM,SUBLINE_NUM

Local Char RPROP(255)
Local Integer RSTATUS
Local Char RPROP_LAB(255)
Local Char RERR_MESS(255)
Local Integer RCATEGORY
Local Char RENVIRONMENT(255)
Local Integer ST
Local Integer MAXSEVERITYALL


Local Instance INSTANCE1 Using C_AQCCOL01
Local Instance INSTANCE3 Using C_AQCCOL01

Local Instance INSTANCE2_1 Using C_AQCCOL02
Local Instance INSTANCE2_2 Using C_AQCCOL02

INSTANCE1 = NewInstance C_AQCCOL01 AllocGroup Null

TC="Initialize Instance"
Call CHECK_EQUAL(TC,TC) From AXUNIT
[L]MY_STATUS = fmet INSTANCE1.AINIT()
Call CHECK_NOTEQUAL([L]MY_STATUS,[V]CST_AERROR) From AXUNIT

TC="Assign properties"
Call CHECK_EQUAL(TC,TC) From AXUNIT
INSTANCE1.KEY1="TEST1"
INSTANCE1.FIELD1="Header"

TC="Add First line to instance"
Call CHECK_EQUAL(TC,TC) From AXUNIT
[L]LINE_NUM = fmet INSTANCE1.ADDLINE("LINCOL",[V]CST_ALASTPOS)

TC="Assign properties in line colletion"
Call CHECK_EQUAL(TC,TC) From AXUNIT
INSTANCE2_1 = INSTANCE1.LINCOL(LINE_NUM)
INSTANCE2_1.KEY1 = "TEST1"
INSTANCE2_1.LINNO = 1
INSTANCE2_1.LINFLD = "Line1"

TC="Add First line to instance"
Call CHECK_EQUAL(TC,TC) From AXUNIT
[L]LINE_NUM = fmet INSTANCE1.ADDLINE("LINCOL",[V]CST_ALASTPOS)

TC="Assign properties in line colletion"
Call CHECK_EQUAL(TC,TC) From AXUNIT
INSTANCE2_2 = INSTANCE1.LINCOL(LINE_NUM)
INSTANCE2_2.KEY1 = "TEST2"
INSTANCE2_2.LINNO = 2
INSTANCE2_2.LINFLD = "Line2"

Callmet INSTANCE1.ASETERRORCAT("FIELD1", "Celine DION sings AC/DC", [V]CST_AERROR,5)
Callmet INSTANCE1.ASETERRORCAT("", "Elvis Alive", [V]CST_AFATAL, 6)
Callmet INSTANCE2_1.ASETERRORCAT("KEY1", "The Cure remix", [V]CST_AERROR, 7)
Callmet INSTANCE2_2.ASETERROR("LINNO", "Neil Young new EP", [V]CST_AOK)
Callmet INSTANCE2_1.ASETERROR("", "Liam Gallagher drunk", [V]CST_AOK)
Callmet INSTANCE2_1.ASETERROR("KEY1", "BB King dead", [V]CST_AFATAL)
Callmet INSTANCE2_2.ASETERROR("LINNO", "Pixies new bass player", [V]CST_AOK)

# INSTANCE1 TEST
# ################################################################################################

# I want all errors
ST = fmet INSTANCE1.ASEARCHINFOS( [V]CST_ALL, "", [V]CST_AFATAL, 0)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT

While (1 = 1)
	ST = fmet INSTANCE1.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
	if ((ST <> [V]CST_AOK ) Or (RSTATUS <> [V]CST_AINFO ))
		Break
	EndIf
Wend

Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AERROR) From AXUNIT
Call CHECK_EQUAL(RPROP, "FIELD1") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Zone") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Celine DION sings AC/DC") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 5) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "") From AXUNIT

ST = fmet INSTANCE1.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AFATAL) From AXUNIT
Call CHECK_EQUAL(RPROP, "") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Elvis Alive") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 6) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "") From AXUNIT

ST = fmet INSTANCE1.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AERROR) From AXUNIT
Call CHECK_EQUAL(RPROP, "LINCOL(1).KEY1") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Clé") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "The Cure remix") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 7) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "") From AXUNIT

ST = fmet INSTANCE1.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RPROP, "LINCOL(2).LINNO") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Ligne") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Neil Young new EP") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 0) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "") From AXUNIT

ST = fmet INSTANCE1.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RPROP, "LINCOL(1)") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Liam Gallagher drunk") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 0) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "") From AXUNIT

ST = fmet INSTANCE1.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AFATAL) From AXUNIT
Call CHECK_EQUAL(RPROP, "LINCOL(1).KEY1") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Clé") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "BB King dead") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 0) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "") From AXUNIT

ST = fmet INSTANCE1.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RPROP, "LINCOL(2).LINNO") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Ligne") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Pixies new bass player") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 0) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "") From AXUNIT

ST = fmet INSTANCE1.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_NOTEQUAL(ST, [V]CST_AOK) From AXUNIT


MAXSEVERITYALL = fmet INSTANCE1.AGETMAXERRORALL( )
Call CHECK_EQUAL(MAXSEVERITYALL, [V]CST_AFATAL) From AXUNIT

MAXSEVERITY = fmet INSTANCE1.AGETMAXERROR( )
Call CHECK_EQUAL(MAXSEVERITY, [V]CST_AFATAL) From AXUNIT

ST = fmet INSTANCE1.AGETMAXERRORTXT( [V]CST_ACURRENT, RPROP, RSTATUS, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RPROP,"") From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AFATAL) From AXUNIT
Call CHECK_EQUAL(RPROP_LAB,"") From AXUNIT
Call CHECK_EQUAL(RERR_MESS,"Elvis Alive") From AXUNIT
Call CHECK_EQUAL(RCATEGORY,6) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT,"") From AXUNIT


# INSTANCE3 init
# ##################################################################################

TC="Initialize Instance3"
INSTANCE3 = NewInstance C_AQCCOL01 AllocGroup INSTANCE1
Call CHECK_EQUAL(TC,TC) From AXUNIT
[L]MY_STATUS = fmet INSTANCE3.AINIT()
Call CHECK_NOTEQUAL([L]MY_STATUS,[V]CST_AERROR) From AXUNIT

TC="Assign properties"
Call CHECK_EQUAL(TC,TC) From AXUNIT
INSTANCE3.KEY1="TEST3"
INSTANCE3.FIELD1="Header3"

Callmet INSTANCE3.ASETERRORCAT("FIELD1", "Lemmy Kilmister heart attack", [V]CST_AERROR, 5)
Callmet INSTANCE3.ASETERRORCAT("", "Telephone come back", [V]CST_AFATAL, 6)

ST = fmet INSTANCE3.AGETERRORSFROM( INSTANCE1, "Instance1 Env" )

# I want all errors

# INSTANCE3 check errors
# ####################################################################################
ST = fmet INSTANCE3.ASEARCHINFOS( [V]CST_ALL, "", [V]CST_AFATAL, 0)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT

While( 1=1)
	ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
	if ((ST <> [V]CST_AOK ) Or (RSTATUS <> [V]CST_AINFO))
		Break
	EndIf
Wend

Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AERROR) From AXUNIT
Call CHECK_EQUAL(RPROP, "FIELD1") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Zone") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Celine DION sings AC/DC") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 5) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "Instance1 Env") From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AFATAL) From AXUNIT
Call CHECK_EQUAL(RPROP, "") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Elvis Alive") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 6) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "Instance1 Env") From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AERROR) From AXUNIT
Call CHECK_EQUAL(RPROP, "LINCOL(1).KEY1") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Clé") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "The Cure remix") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 7) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "Instance1 Env") From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RPROP, "LINCOL(2).LINNO") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Ligne") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Neil Young new EP") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 0) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "Instance1 Env") From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RPROP, "LINCOL(1)") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Liam Gallagher drunk") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 0) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "Instance1 Env") From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AFATAL) From AXUNIT
Call CHECK_EQUAL(RPROP, "LINCOL(1).KEY1") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Clé") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "BB King dead") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 0) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "Instance1 Env") From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RPROP, "LINCOL(2).LINNO") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Ligne") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Pixies new bass player") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 0) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "Instance1 Env") From AXUNIT

While (1 = 1)
	ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
	if ((ST <> [V]CST_AOK ) Or (RSTATUS <> [V]CST_AINFO))
		Break
	EndIf
Wend

Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AERROR) From AXUNIT
Call CHECK_EQUAL(RPROP, "FIELD1") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Zone") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Lemmy Kilmister heart attack") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 5) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "") From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AFATAL) From AXUNIT
Call CHECK_EQUAL(RPROP, "") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Telephone come back") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 6) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "") From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_NOTEQUAL(ST, [V]CST_AOK) From AXUNIT


# filter on STATUS
# ########################
ST = fmet INSTANCE3.ASEARCHINFOS( [V]CST_ALL, "", [V]CST_AFATAL, 1)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AFATAL) From AXUNIT
Call CHECK_EQUAL(RPROP, "") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Elvis Alive") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 6) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "Instance1 Env") From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AFATAL) From AXUNIT
Call CHECK_EQUAL(RPROP, "LINCOL(1).KEY1") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Clé") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "BB King dead") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 0) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "Instance1 Env") From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AFATAL) From AXUNIT
Call CHECK_EQUAL(RPROP, "") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Telephone come back") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 6) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "") From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_NOTEQUAL(ST, [V]CST_AOK) From AXUNIT

# filter on PROPERTY
# ########################
ST = fmet INSTANCE3.ASEARCHINFOS( [V]CST_ACURRENT, "FIELD1", [V]CST_AFATAL, 0)

Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AERROR) From AXUNIT
Call CHECK_EQUAL(RPROP, "FIELD1") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Zone") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Celine DION sings AC/DC") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 5) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "Instance1 Env") From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
Call CHECK_EQUAL(RSTATUS, [V]CST_AERROR) From AXUNIT
Call CHECK_EQUAL(RPROP, "FIELD1") From AXUNIT
Call CHECK_EQUAL(RPROP_LAB, "Zone") From AXUNIT
Call CHECK_EQUAL(RERR_MESS, "Lemmy Kilmister heart attack") From AXUNIT
Call CHECK_EQUAL(RCATEGORY, 5) From AXUNIT
Call CHECK_EQUAL(RENVIRONMENT, "") From AXUNIT

ST = fmet INSTANCE3.AGETNEXTINFOS( RSTATUS, RPROP, RPROP_LAB, RERR_MESS, RCATEGORY, RENVIRONMENT)
Call CHECK_NOTEQUAL(ST, [V]CST_AOK) From AXUNIT


# Delete ERRORS
# #############################################################################################################
ST = fmet INSTANCE2_1.ADELETEERROR("KEY1")
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
ST = fmet INSTANCE1.ADELETEERRORALL( )
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT
ST = fmet INSTANCE3.ADELETEERRORALL( )
Call CHECK_EQUAL(ST, [V]CST_AOK) From AXUNIT

freeGroup INSTANCE1

Call CHECK_EQUAL( I, 0 ) From AXUNIT
End

