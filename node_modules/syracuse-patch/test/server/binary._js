"use strict";
var patch = require("syracuse-patch/lib/integrate");
var unit = require("syracuse-patch/test/fixtures/unit");
var fs = require('streamline-fs');
QUnit.module(module.id);

asyncTest("start", 0, function(_) {
	unit.rmdirRec("patchunittest", _);
	fs.mkdir("patchunittest", _);
	start();
});
asyncTest("Z", 1, function(_) {
	strictEqual(true, true);
	start();
});

asyncTest("create", 1, function(_) {
	try {
		patch.normalPatch("patchunittest", __dirname + "/../fixtures/binary_create.patch", {}, _);

	} catch (e) {
		console.log(e);
	}
	var errors = unit.testhash("patchunittest", {
		'/test.bin': '3d727f4695d5a6a647b418ecd232ba9a75e768ab'
	}, _);
	strictEqual(errors, "");
	start();
});

asyncTest("bytechanges", 1, function(_) {
	patch.normalPatch("patchunittest", __dirname + "/../fixtures/binary_bytechanges.patch", {}, _);
	var errors = unit.testhash("patchunittest", {
		'/test.bin': '3622f30d2a3579c0006dc1be0c6b765cd4c2eabd'
	}, _);
	strictEqual(errors, "");
	start();
});

asyncTest("byteremove", 1, function(_) {
	patch.normalPatch("patchunittest", __dirname + "/../fixtures/binary_byteremove.patch", {}, _);
	var errors = unit.testhash("patchunittest", {
		'/test.bin': '8f1f147ffe8a59dc019f4ef5a4554ae035cb0f60'
	}, _);
	strictEqual(errors, "");
	start();
});

asyncTest("byteadd", 1, function(_) {
	patch.normalPatch("patchunittest", __dirname + "/../fixtures/binary_byteadd.patch", {}, _);
	var errors = unit.testhash("patchunittest", {
		'/test.bin': '7b582eced238f722405a13210394f7b149234367'
	}, _);
	strictEqual(errors, "");
	start();
});

asyncTest("removemuch", 1, function(_) {
	patch.normalPatch("patchunittest", __dirname + "/../fixtures/binary_removemuch.patch", {}, _);
	var errors = unit.testhash("patchunittest", {
		'/test.bin': '180257efdddd452e3fba7f12718da6bc4d2a7688'
	}, _);
	strictEqual(errors, "");
	start();
});

asyncTest("addmuch", 1, function(_) {
	patch.normalPatch("patchunittest", __dirname + "/../fixtures/binary_addmuch.patch", {}, _);
	var errors = unit.testhash("patchunittest", {
		'/test.bin': '7b582eced238f722405a13210394f7b149234367'
	}, _);
	strictEqual(errors, "");
	start();
});

asyncTest("empty", 1, function(_) {
	patch.normalPatch("patchunittest", __dirname + "/../fixtures/binary_empty.patch", {}, _);
	var errors = unit.testhash("patchunittest", {
		'/test.bin': 'da39a3ee5e6b4b0d3255bfef95601890afd80709'
	}, _);
	strictEqual(errors, "");
	start();
});

asyncTest("nonempty", 1, function(_) {
	patch.normalPatch("patchunittest", __dirname + "/../fixtures/binary_nonempty.patch", {}, _);
	var errors = unit.testhash("patchunittest", {
		'/test.bin': 'e380711b3ad6de4fed8afe67dcb59745d973ec1d'
	}, _);
	strictEqual(errors, "");
	start();
});

asyncTest("remove", 1, function(_) {
	patch.normalPatch("patchunittest", __dirname + "/../fixtures/binary_remove.patch", {}, _);
	var errors = unit.testhash("patchunittest", {}, _);
	strictEqual(errors, "");
	start();
});

asyncTest("end", 0, function(_) {
	unit.rmdirRec("patchunittest", _);
	start();
});