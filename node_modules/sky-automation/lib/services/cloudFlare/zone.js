var client = require('./client.js')
var config = require('../../../../config');
var options = config.cloudflare.options;

function getZones (callback){
    reqOptions=options;
    reqOptions.path = config.cloudflare.paths.listZones;
    reqOptions.method = 'GET';
    
    client.sendRequest(reqOptions, function(err,data){

      	var ret = JSON.parse(data).result;
		callback(null,ret);
  });
}

function getZoneByName (zoneName,callback){
    reqOptions=options;
    reqOptions.path = config.cloudflare.paths.getZone.replace(":zoneName",zoneName);
    reqOptions.method = 'GET';
    
    client.sendRequest(reqOptions, function(err,data){
    if (!err) {
        var ret = JSON.parse(data).result[0];
        if (!ret){
            err = new Error("Zone Name: " + zoneName + " not found please check your configuration file")
			err.name = "ZoneIDError";
            return callback(err);            
        }
    }
    callback(err,ret);
  });
}



function getZoneIdByName (zoneName,callback){
    getZoneByName(zoneName,function(err,data){
        if (!err){
            data = data.id;
        }
        callback(err,data);
    });
}

exports.getZones = getZones;
exports.getZoneByName = getZoneByName;
exports.getZoneIdByName = getZoneIdByName;
