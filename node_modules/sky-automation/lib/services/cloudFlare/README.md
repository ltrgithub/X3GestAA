Cloud Flare Usage for SageX3.com
=================
For SageX3.com, Cloud Flare provides the following functions:

* DDOS Protection
* CDN
* Reverse Proxy
* Domain Name Service

For SageX3.com the Domain Name Service function is of the greatest concern.  This is because the tenants are identified by the target url of the HTTP request.  Syracuse will parse the target URL of the request and determine the tenant name as anything between the protocol name and the first dot.  For example, if the target url of a request is https://tenant1.domain.com the tenant name will be tenant1.

With this requirement, every SageX3.com tenant will have it's own URL and will need to be created during the provisioning process of any new tenant.  This library was built to facilitate CRUD operations with Cloud Flare.


Usage
-----
In order to use the Cloud Flare API, all request must contain in the HTTPS request header the following fields:

* "X-Auth-Email" 
* "X-Auth-Key"

For the Cloud Flare API library, these fields are stored in config.js.  Below are the relevant fields in config.js:


    cloudflare: {
        options : {
            hostname: 'api.cloudflare.com',
            port: 443,
            headers: {
                "X-Auth-Email": "email@mail.com",
                "X-Auth-Key": "api key goes here"
            }


Other records of note in config.js are below:


    cloudflare: {
		...
        zoneName: "<is used to specify the dns zone that will be administered.>",
        content: "<Content of DNS Record>"


Retrieving a Record
------------------

Records can be retrieved by issuing a call to the getRecordByName or getRecordByID.  The below code snippet will return the the same record information for a record twice:

	var aws_cloudflare = require('./cloudflare/records');
	
	aws_cloudFlare.getRecordByName ("recordName", function(err,data){console.log(data);});
	aws_cloudFlare.getRecordByID ("123456789", function(err,data){console.log(data);}););


Adding a Record
-----------
Records can be added by issuing a call to the addRecordByName.  The below code snippet will add a record:

	var aws_cloudflare = require('./cloudflare/records');

	aws_cloudFlare.addRecordByName("recordToAdd", function(err,data){console.log(data);});


Updating a Record
-----------
Records can be updatedby issuing a call to the updateRecordByName.  The fields argument is a JSON object with only the fields to update.  The below code snippet update and existing record:

	var aws_cloudflare = require('./cloudflare/records');

	aws_cloudflare.updateRecordByName("recordToUpdate", {"type" : "CNAME"}, function(err,data){console.log(data);});

Deleting a Record
-----------
Records can be deleted by issuing a call to the deleteRecordByName or deleteRecordById.  The below code snippet illustrates how to delete a record using both methods:

	var aws_cloudflare = require('./cloudflare/records');
	
	aws_cloudFlare.deleteRecordByName("recordName", function(err,data){console.log(data);});
	aws_cloudFlare.deleteRecordById("123456789", function(err,data){console.log(data);});