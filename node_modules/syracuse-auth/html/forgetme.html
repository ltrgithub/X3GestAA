<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=10">
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=10">
	<title>Sage ERP X3</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="/syracuse-auth/html/login.css">
	<script type="text/javascript">

		if( !{{js$hasCookie}} ){
			redirect("/auth/login/page");
		}

		function authToken(type, username, password) {
			// !!! btoa not supported on IE??
			switch (type) {
				case 'basic':
					return 'Basic ' + window.btoa(username + ":" + password);
				case 'sageerpx3':
					return 'sageerpx3 ' + window.btoa(username + ":" + password);
				default:
					return null;
			}
		}

		function forgetme() {


			var request = new XMLHttpRequest();
			request.open("POST", "/auth/forgetMe/submit", true);
			request.setRequestHeader("accept", "application/json");
			request.setRequestHeader("content-type", "application/json");
			request.onreadystatechange = function(aEvt) {
				if (request.readyState == 4) {
					try {
						json = JSON.parse(request.responseText);
						window.location.href = json.$diagnoses[0].$links.$redirect.$url;
					} catch (ex) {
						document.getElementById('error-msg').textContent = ex.message || request.statusText;

					}
				}
			};
			request.send(JSON.stringify({forgetme : true}));
		}

		function redirect(url) {
			window.location = url;
		}
	</script>
</head>

<body>
	<div class="container">
		<div class="s-text-containt">
			<div class="s-text">
				<div class="s-product">
				<span class="s-m-brand">Sage</span>
				<span class="s-m-product">ERP X3</span>
                </div>
				<div class="z-error">
					<div id="error-msg">{{errorMessage}}</div>
				</div>
				<form id="loginForm">
				<div class="s-visibility-{{passwordVisibility}}">
					<div class="z-field">
						{{loggedAtLabel}} {{js$login}}
					</div>
					<div class="z-action s-visibility-{{basicVisibility}}">
						<a id="go-basic" href="javascript:redirect('/')">{{enterLabel}}</a>
					</div>
					<div class="z-action s-visibility-{{digestVisibility}}">
						<a id="go-digest"href="javascript:forgetme()">{{changeUserLabel}}</a>
					</div>
					<div class="z-action s-visibility-{{ldapVisibility}}">
						<a id="go-ldap" href="javascript:forgetme()">{{forgetMeLabel}}</a>
					</div>

					<input style=" display:none;" onclick="javascript:redirect('/'); return false;" type="submit"><!-- enter key - reenter -->

				</div>
				</form>
			</div>

		</div>
	</div>
</body>
</html>