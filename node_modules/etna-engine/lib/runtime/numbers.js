"use strict";
var util = require('./util');
var errors = require('./errors');
var X3Error = errors.X3Error;

function anp(n, p) {
	return n > (p || 1) ? n * anp(n - 1, p) : 1;
}

exports.functions = {
	ABS: {
		count: 1,
		fn: function(x) {
			util.checkNumber(x);
			return Math.abs(x);
		}
	},
	MOD: {
		count: 2,
		fn: function mod(x, y) {
			util.checkNumber(x);
			util.checkNumber(y);
			util.checkNotZero(y);
			return x >= 0 ? x % y : ((x % y) + y) % y;
		}
	},
	RND: {
		count: 1,
		fn: function(x) {
			return x * Math.random();
		}
	},
	SGN: {
		count: 1,
		fn: function(x) {
			return x == 0 ? 0 : x > 0 ? 1 : -1;
		}
	},
	SQR: {
		count: 1,
		fn: Math.sqrt
	},
	AR2: {
		count: 1,
		fn: function(v) {
			return Math.floor(v * 100 + 0.5) / 100;
		}
	},
	ARR: {
		count: 2,
		fn: function(x, y) {
			return y ? Math.floor(x / y + 0.5) * y : x;
		}
	},
	FIX: {
		count: 1,
		fn: function(v) {
			return v >= 0 ? Math.floor(v) : -Math.floor(-v);
		}
	},
	INT: {
		count: 1,
		fn: Math.floor

	},
	ANP: {
		count: 2,
		fn: anp
	},
	CNP: {
		count: 2,
		fn: function(n, p) {
			return anp(n, p) / anp(p);
		}
	},
	FAC: {
		count: 1,
		fn: anp
	},
	COS: {
		count: 1,
		fn: Math.cos
	},
	SIN: {
		count: 1,
		fn: Math.sin
	},
	TAN: {
		count: 1,
		fn: Math.tan
	},
	ACOS: {
		count: 1,
		fn: Math.acos
	},
	ASIN: {
		count: 1,
		fn: Math.asin
	},
	ATAN: {
		count: 1,
		fn: Math.atan
	},
	ACH: {
		count: 1,
		fn: function(x) {
			return Math.log(x + Math.sqrt(x * x - 1));
		}
	},
	ASH: {
		count: 1,
		fn: function(x) {
			return Math.log(x + Math.sqrt(x * x + 1));
		}
	},
	ATH: {
		count: 1,
		fn: function(x) {
			return Math.log((1 + x) / (1 - x)) / 2;
		}
	},
	CH: {
		count: 1,
		fn: function(x) {
			return (Math.exp(x) + Math.exp(-x)) / 2;
		}
	},
	SH: {
		count: 1,
		fn: function(x) {
			return (Math.exp(x) - Math.exp(-x)) / 2;
		}
	},
	TH: {
		count: 1,
		fn: function(x) {
			return (Math.exp(2 * x) - 1) / (Math.exp(2 * x) + 1);
		}
	},
	EXP: {
		count: 1,
		fn: Math.exp
	},
	LN: {
		count: 1,
		fn: Math.log
	},
	LOG: {
		count: 1,
		fn: function(val) {
			return Math.log(val) / Math.log(10);
		}
	},
	PI: {
		count: 0,
		fn: function() {
			return Math.PI;
		}
	}
};