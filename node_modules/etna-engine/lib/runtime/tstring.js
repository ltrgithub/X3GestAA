"use strict";
var X3Error = require('./errors').X3Error;
var util = require('./util');
var bcd = require('./bcd');
var tinteger = require('./tinteger');
var tdate = require('./tdate');

exports.isString = function(val) {
	return val instanceof TString ;
}

var TString = (function() {
	function TString( v ) {
		this.value=v;
	} ;

	TString.prototype.valueOf = function() {
		return this.value ;
	} ;

	TString.prototype.toString = function() {
		return this.value ;
	} ;
	
	TString.prototype.toDouble = function() {
		return new Double( this ) ;
	} ;
	
	TString.prototype.toBCD = function() {
		return new BCD( this ) ;
	} ;
	
	TString.prototype.toInteger = function() { 
		return new tinteger.Integer(parseInt(this.value) ) ;
	} ;    
	
	TString.prototype.toDate = function() {
		try {
			var y = this.substring(0,4);
			var m = this.substring(5,6);
			var d = this.substring(7,8);
			return new tdate.date(d,m,y) ;	
		} catch (e) {new tdate.date( ) ; } ;
	
	} ; 	
	
	TString.prototype.toDatetime = function() {
	        
	} ;   
	
	TString.prototype.isNumeric = function() {
	return false ;
	} ;
	
	TString.prototype.isZero = function() {
		if (this.value="") {
			return true;
		}else {
			return false;
		}
	} ;	
	
	TString.prototype.compare = function( b ) {
		if (!exports.isString(b)) throw util.badOperand(b);
		
		if (this.value === b.valueOf()) return 0 ;
		else if (this.value < b.valueOf()) return -1 ;
		else return 1 ;
	}	
	
	TString.prototype.add = function( b ) {
		if (!exports.isString(b)){
			//if (tdate.isDate(b)) return this.value +b.valueof.toString("yyyyMMdd") ;
			//else throw util.badOperand(b);	
		}
		return this.value + b.valueOf( ) ;
	} ;
	
	TString.prototype.sub = function( v ) {
		if (!exports.isString(b)){
			//if (tdate.isDate(b)) return this.value +b.valueof.toString("yyyyMMdd") ;
			//else throw util.badOperand(b);	
		}
		return this.value + " " + b.valueOf( ) ;
	} ;
	
	TString.prototype.mul = function( v ) {
	} ;
	
	TString.prototype.div = function( v ) {
	} ;
	
	TString.prototype.mod = function( v ) {
	} ;
	
	TString.prototype.pow = function( v ) {
	} ;
	
	TString.prototype.xor = function( v ) {
	} ;
	
	TString.prototype.abs = function( ) {
	} ;
	
	TString.prototype.truncate = function( v ) {
	} ;

	return TString ;
})( ) ;


exports.TString = TString ;

exports.instructions = {
  TSTRING: function( v ) {
	return util.instructions.C(new TString( v )) ;
  }
} ;