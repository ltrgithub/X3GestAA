"use strict";
var helpers = require('syracuse-core/lib/helpers');
var fs = require('streamline-fs');

var File = helpers.defineClass(function() {
	var self = this;
	this.fd = null;
	this.mode = "";
	this.offset = 0;
	return self;
}, null, {

	x3open: function(_, xfil, offset, mode) {
		var self = this;
		try {
			if (mode === "w") mode = "a";
			else if (mode === "r+") mode = "a+";

			var fd = fs.open(xfil.toString(_), mode, _);

		} catch (ex) {
			throw new X3Error(20, ex.message);
		}
		self.fd = fd;
		self.mode = mode;
		self.offset = offset;
	},

	x3seek: function(pos) {
		this.offset = pos;
	},

	x3write: function(_, str) {
		var self = this;
		var len = fs.write(self.fd, str, self.offset, 'utf8', _);

		self.offset += len;
		return len;
	},

	x3read: function(_) {

	},

	x3get: function(_) {

	},

	x3put: function(_) {

	},

	x3close: function(_) {
		var self = this;
		try {
			fs.close(self.fd, _);
		} catch (ex) {
			throw new X3Error(20, ex.message);
		}
	}
});

exports.File = File;