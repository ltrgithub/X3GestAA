$TC_SNAPSHOT_SETUP
Local Instance INS Using C_AQCPROC03
INS = NewInstance C_AQCPROC03

INS.C03P01  = "5"
INS.C03P01.$isHidden  = CST_ATRUE
Call CHECK_EQUAL( INS.C03P01, "5" )  From AXUNIT
Call CHECK_EQUAL( INS.C03P01.$isHidden,CST_ATRUE )  From AXUNIT
Return 


$TC_SNAPSHOT_00
Local Integer OK
OK = 0
If (INS.snapshot =  null)
  OK = 1
Endif
Call CHECK_EQUAL(OK,1)  From AXUNIT
Return

$TC_SNAPSHOT_01
Local Integer OK
OK = 0
If (INS.snapshot <>  null)
  OK = 1
Endif
Call CHECK_EQUAL(OK,1)  From AXUNIT
Return


$TC_SNAPSHOT_02
INS.C03P01 = "6"
INS.C03P01.$isHidden  = CST_AFALSE
Call CHECK_EQUAL( INS.C03P01, "6" )  From AXUNIT
Call CHECK_EQUAL( INS.C03P01.$isHidden,CST_AFALSE)  From AXUNIT

Call CHECK_EQUAL( INS.snapshot.C03P01, "5" )  From AXUNIT
Call CHECK_EQUAL( INS.snapshot.C03P01.$isHidden,CST_ATRUE)  From AXUNIT
Return

$TC_SNAPSHOT_ERR
OK = 1
Resume

$TC_SNAPSHOT_03
Local Integer OK
#Let's try to change snapshotEnabled:
Onerrgo TC_SNAPSHOT_ERR
INS.snapshotEnabled = CST_ATRUE
Onerrgo
Call CHECK_EQUAL( OK,1)  From AXUNIT
Return

$TC_SNAPSHOT_TEARDOWN
FreeInstance INS
Return