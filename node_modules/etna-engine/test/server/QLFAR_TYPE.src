Local Clbfile RESULT
RESULT=func TESTSUITE()
Call FERME_TRACE From LECFIC
GTRACE = "QLFAR_TYPE_"+GACTX.USER
Call LEC_TRACE From LECFIC
End


#**
#* The main entry point of the unit test suite for Requirement 69072
#*
Funprog TESTSUITE()
Call ADD_TESTCASE("TC_LOCAL_TYPE", "'TYPE' - Local type of variable", 16) From AXUNIT
Call ADD_TESTCASE("TC_SHARED_TYPE", "'TYPE' - Shared type of variable", 4) From AXUNIT
Call ADD_TESTCASE("TC_GLOBAL_TYPE", "'TYPE' - Global type of variable", 16) From AXUNIT
End func AXUNIT.RUN_TESTSUITE("REQ-69072", "TYPE")

$ERROR
Call CHECK_EQUAL(errn, EX) From AXUNIT
EX = 0
Resume

Subprog TC_LOCAL_TYPE
Integer EX
Onerrgo ERROR
Local Libelle  ALIBELLE
Local Shortint ASHORTINT
Local Date     ADATE
Local Integer  AINT
Local Float    AFLOAT
Local Decimal  ADECIMAL
Local Char     ACHAR
Local Char     ACHAR0(0)
Local Char     ACHAR10(10)
Local Schar    ASCHAR
Local Blbfile  ABLOB(2)
Local Clbfile  ACLOB(2)
Local Uuident  AUUID
Local Datetime ADATETIME
Local Tinyint  ATINYINT

Call CHECK_EQUAL(type(AINT),4) From AXUNIT
Call CHECK_EQUAL(type([L]AINT),4) From AXUNIT
Call CHECK_EQUAL(type(ALIBELLE),1) From AXUNIT              # Deprecated
Call CHECK_EQUAL(type(ATINYINT),1) From AXUNIT
Call CHECK_EQUAL(type(ASHORTINT),2) From AXUNIT
Call CHECK_EQUAL(type(ADATE),3) From AXUNIT
Call CHECK_EQUAL(type(ADECIMAL),7) From AXUNIT
Call CHECK_EQUAL(type(ACHAR),40) From AXUNIT                # by default char of 30
Call CHECK_EQUAL(type(ACHAR10),20) From AXUNIT

Call CHECK_EQUAL(type(ASCHAR),40) From AXUNIT
Call CHECK_EQUAL(type(ABLOB),522) From AXUNIT
Call CHECK_EQUAL(type(ACLOB),523) From AXUNIT

Call CHECK_EQUAL(type(AUUID),525) From AXUNIT
Call CHECK_EQUAL(type(ADATETIME),526) From AXUNIT

Call CHECK_EQUAL(type(A_NOVAR),-1) From AXUNIT

Call CHECK_EQUAL(type(ACHAR0),40) From AXUNIT               # by default char of 30

#TODO Local Instance MY_FACILITY Using C_FACILITY
#TODO MY_FACILITY = NewInstance C_FACILITY AllocGroup null
#TODO Call CHECK_EQUAL(type(MY_FACILITY),524) From AXUNIT

End


Subprog TC_SHARED_TYPE
Integer EX
Onerrgo ERROR

Call CHECK_EQUAL(type(adxdcs),4) From AXUNIT
Call CHECK_EQUAL(type(datesyst),3) From AXUNIT
Call CHECK_EQUAL(type(fstat),4) From AXUNIT
Call CHECK_EQUAL(type(adxifs),10) From AXUNIT

End


Subprog TC_GLOBAL_TYPE
Integer EX
Onerrgo ERROR
Global Libelle  ALIBELLE
Global Shortint ASHORTINT
Global Date     ADATE
Global Integer  AINT
Global Decimal  ADECIMAL
Global Char     ACHAR
Global Char     ACHAR0(0)
Global Char     ACHAR10(10)
Global Schar    ASCHAR
Global Blbfile  ABLOB(2)
Global Clbfile  ACLOB(2)

Call CHECK_EQUAL(type(A_NOVAR),-1) From AXUNIT
Call CHECK_EQUAL(type(ALIBELLE),1) From AXUNIT
Call CHECK_EQUAL(type(ASHORTINT),2) From AXUNIT
Call CHECK_EQUAL(type(ADATE),3) From AXUNIT
Call CHECK_EQUAL(type(AINT),4) From AXUNIT
Call CHECK_EQUAL(type([V]AINT),4) From AXUNIT
Call CHECK_EQUAL(type(ADECIMAL),7) From AXUNIT
Call CHECK_EQUAL(type(ACHAR),40) From AXUNIT                # by default char of 30
Call CHECK_EQUAL(type(ACHAR0),40) From AXUNIT               # by default char of 30
Call CHECK_EQUAL(type(ACHAR10),20) From AXUNIT

Call CHECK_EQUAL(type(ASCHAR),40) From AXUNIT
Call CHECK_EQUAL(type(ABLOB),522) From AXUNIT
Call CHECK_EQUAL(type(ACLOB),523) From AXUNIT

Local Integer B
Global Date B
Call CHECK_EQUAL(type([L]B),4) From AXUNIT
Call CHECK_EQUAL(type(B),4) From AXUNIT
Call CHECK_EQUAL(type([V]B),3) From AXUNIT

Kill [V]ALIBELLE
Kill [V]ASHORTINT
Kill [V]ADATE
Kill [V]AINT
Kill [V]ADECIMAL
Kill [V]ACHAR
Kill [V]ACHAR0
Kill [V]ACHAR10
Kill [V]ASCHAR
Kill [V]ABLOB
Kill [V]ACLOB

End
