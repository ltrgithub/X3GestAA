Local Clbfile RESULT
RESULT = func TESTSUITE()

Call FERME_TRACE From LECFIC
GTRACE = "QLFAR_ERR_"+GUSER
Call LEC_TRACE From LECFIC
End

Funprog TESTSUITE()
Callmet GACTX.ACTX_SET_LANISO("fr-FR")

Call TESTSUITE_START("ERR", "Runtime Errors") From AXUNIT

Call ADD_TESTCASE("TC_ERR_0_10","TC_ERR_0_10"-"Errors 0 through 10", 7) From AXUNIT
Call ADD_TESTCASE("TC_ERR_11_20","TC_ERR_11_20"-"Errors 11 through 20", 3) From AXUNIT
Call ADD_TESTCASE("TC_ERR_21_30","TC_ERR_21_30"-"Errors 21 through 30", 1) From AXUNIT
Call ADD_TESTCASE("TC_ERR_31_40","TC_ERR_31_40"-"Errors 31 through 40", 2) From AXUNIT
Call ADD_TESTCASE("TC_ERR_41_50","TC_ERR_41_50"-"Errors 41 through 50", 2) From AXUNIT
Call ADD_TESTCASE("TC_ERR_51_60","TC_ERR_51_60"-"Errors 51 through 60", 2) From AXUNIT
Call ADD_TESTCASE("TC_ERR_61_70","TC_ERR_61_70"-"Errors 61 through 70", 3) From AXUNIT
Call ADD_TESTCASE("TC_ERR_71_80","TC_ERR_71_80"-"Errors 71 through 80", 0) From AXUNIT
Call ADD_TESTCASE("TC_ERR_81_90","TC_ERR_81_90"-"Errors 81 through 90", 0) From AXUNIT

Local Clbfile  SUITE_RESULT
SUITE_RESULT = func AXUNIT.RUN_TESTSUITE("FUNCTIONS", "FUNCTIONS")
End SUITE_RESULT


$ERROR
Local Char TT(255),TT1(255)
TT=num$(errn)-errmes$(errn)
TT1=num$(ERR)-errmes$(ERR)
Call CHECK_EQUAL(TT, TT1) From AXUNIT
ERR = 0
Resume

Subprog TC_ERR_0_10
Local Integer A,B,C,D,ERR
Local Char STR(10)
Onerrgo ERROR

# Errn 0 Sage X3 errors
ERR=0
Local Integer A(10)

# Errn  1 A closing bracket is missing  ERPAFPA
# Errn  2 An opening bracket is missing ERPAOPA
# Errn  3 A comma is missing  ERPAVIR
# Errn  4 Function unknown  ERPAFON
# Errn  5 Illegal character ERCARIN
ERR=5
A=evalue("4*(3/2")

# Errn  6 Non existent variable ERVARI
ERR=6
Call TMP_VAR_ERRORS(E,2,C,D)
ERR=6
Kill [V]BBBB

# Errn  7 Non existent class  ERCLAS
ERR=7
Read [F:ABC]First
ERR=7
Write [F:ABC]

# Errn  8 Index incorrect ERINDI
ERR=8
Local Integer A
A(5)=3

# Errn  9 No current field  ERPAZC
#    Mask error on field ZC

# Errn  10  Incompatible type ERMODE
ERR=10
[L]STR=1234

End

Subprog TC_ERR_11_20
Local Integer A,B,C,D,ERR
Global Char Z1
Onerrgo ERROR


# Errn  11  Negative root for a number  ERSQNG
ERR=11
A=sqr(-12)

# Errn  12  Error in trigonometric calculation  ERTRIG
# Errn  13  Calculation capacity exceeded ERHUGE
ERR=0 :#it works
A=ach(1E64)


#The calculation works but A is not in the proper type
#ERR=0
#A=fac(100)

# Errn  14  Logarithm for a negative number ERLOGN
ERR=14
A=log(-1)

# Errn  15  Hyperbolic trigonometric error  ERTRIH
ERR=15
A=ach(0.5)

# Errn  16  Error in the factorial calculation  ERFACT  (Not used ??)
# Errn  17  Negative index  ERINEG  (Not used ??)
# Errn  18  Incorrect label number  ERNULI  (Not used ??)
# Errn  19  File type incorrect INCFIC
# Errn  20  Non-existent file PAFIC
#TODO ERR=20
#TODO Local File AAAA [ABC]

ERR=20
Call TMP From NOSRC

End

Subprog TMP_VAR_ERRORS(A,B,C,D)
Variable Integer A
Value Integer B
Const Integer D
Local Integer ERR
Onerrgo ERROR

ERR=62
D=12


End


Subprog TC_ERR_21_30
Local Integer A,B,C,D,ERR
Local Tinyint E
Local Date F_DATE
Onerrgo ERROR

# Errn  20  Non-existent file PAFIC
#TODO ERR=20
#TODO Local File ATAB [A1]

# Errn  21  Key does not exist in this table  PACLE
#TODO ERR=21
#TODO Local File ATABLE [A1]
#TODO Read [A1]CLE1="ABC"

# Errn  22  Incorrect read mode MODIN  (Not used ??)
# Errn  23  Error in C-ISAM file management ERISAM
# Errn  24  Error in sequential file management ERGFIC
#TODO ERR=24
#TODO Seek First Using [XXX]

# Errn  25  System error  ERSYST
# Errn  26  Internal error  ERINT
ERR=26
Local Decimal A,B
B=evalue("A=10E128")
# Errn  27  Problem with access to a file ERACCE
# Errn  28  Opening of a single table 2 times ERREOP
ERR=28
#TODO Local File ATABLE [AT1]
#TODO Local File ATABLE [AT1]
#TODO Close File [AT1]

# Errn  29  Too many tables open  TROFIC
#TODO ERR=29
#TODO Close File [A1]
#TODO [S]adxmto=5
#TODO Local File ATABLE [A1]
#TODO Local File ATABLE [A2]
#TODO Local File ATABLE [A3]
#TODO Local File ATABLE [A4]
#TODO Local File ATABLE [A5]
#TODO Local File ATABLE [A6]

End

Subprog TC_ERR_31_40
Local Integer A,B,C,D,ERR
Local Tinyint E
Local Date F_DATE
Onerrgo ERROR
# Errn  30  Incorrect table associated with mask  PAFIAS  (Mask)
# Errn  31  No more memory available  PLUMEM
#TODO ? ERR=31
#TODO ? Local Char TEST(255)(10000,10000,10000)

# Errn  32  Return does not correspond to a Gosub ERRET
Call TMP_ERRET

# Errn  33  Function not implemented !  EREX    (Not used ??)
# Errn  34  Error in variable creation  ERVARC
# Errn  35  The rank is not a grid  ERPATB  (Mask)
# Errn  36  Non-existent window NOFEN       (Window)
# Errn  37  2 masks with same abbreviation  ERMABR  (Mask)
# Errn  38  Too many processes or procedures in process TROPRO
# Errn  39  Non existent label  ERLAB
ERR=39
Call TMP From AXUNIT
ERR=39
A=func INSTR1

# Errn  40  Error in write to file  ERECR     (Not used ??)

End

Subprog TC_ERR_41_50
Local Integer A,B,C,D,ERR
Local Tinyint E
Local Date F_DATE
Local Char A_STR(120)
Onerrgo ERROR

# Errn  41  Step value null ERLOOP
ERR=41
B=0
For A=1 To 10 Step B
Next

# Errn  42  Too many masks open ERTROM  (Mask)
# Errn  43  Table locked  FISLOCK
# Errn  44  No more space on the disk ERMDISK
# Errn  45  Error in APL file management  ERAPL
# Errn  46  Non existent printer file ERIMP
# Errn  47  Non existent mask ERPAMK  (Mask)
# Errn  48  No transaction underway PADTRAN
#TODO ERR=48
#TODO Commit

# Errn  49  There is already a transaction in process DEJTRAN
#TODO ERR=49
#TODO Local File ATABLE
#TODO Trbegin [ATB]
#TODO Trbegin [ATB]
#TODO Rollback

# Errn  50  Function not defined for the given value  ERDOM
ERR=50
A_STR=ver$(10)


End

Subprog TC_ERR_51_60
Local Integer A,B,C,D,ERR
Local Tinyint E
Local Date F_DATE
Onerrgo ERROR
# Errn  51  Error in DCB management ERDCB
# errn  52  ERROR log(0)  ERLOGZ
ERR=52
A=log(0)

# Errn  53  Division by 0 error ERDIVZ
ERR=53
C=0
A=B/C

# Errn  54  Incorrect application license!  ERSRAP    (V6)
# Errn  55  Too many dimensions ERDIM
# Errn  56  Error - date incorrect  ERDATE
#TODO ? ERR=56
#TODO ? F_DATE="15990101"

# Errn  57  No seek possible in stdio ERSEEK
# Errn  58  Error in message file ERMESS
# Errn  59  Too many grids open ETRETA   (Mask)
# Errn  60  No more channels available  ERCHAN

End

Subprog TC_ERR_61_70
Local Integer A,B,C,D,ERR
Local Tinyint E
Local Date F_DATE
Onerrgo ERROR
# Errn  61  Variable exists already ERVEX
# Errn  62  Non modifiable variable EREADONLY
Call TMP_VAR_ERRORS(A,B,C,D)

# Errn  63  Exclusive opening access impossible ACEXIMP
# Errn  64  Non existent processes  NOPROC
# Errn  65  File size limit exceeded  ERULIM
# Errn  66  Incorrect file name ERFNAM
# Errn  67  Too much Adonix in process  ERTRAD
# Errn  68  Too many users using this application ERTRAP
# Errn  69  Incorrect number of parameters  ERARGNO
ERR=69
Call TMP_VAR_ERRORS(A,B,C)

# Errn  70  Incompatible parameter type ERARGTY
ERR=70
Call TMP_VAR_ERRORS(2,B,C,D)
End

Subprog TC_ERR_71_80
Local Integer A,B,C,D,ERR
Local Tinyint E
Local Date F_DATE
Onerrgo ERROR
# Errn  71  Closure impossible during a transaction CLOTRAN
# Errn  72  Adonix has not been licensed  ERADNS
# Errn  73  Non existent application  ERAPIN
# Errn  74  ADONIX license/Application incompatible ERAPAD
# Errn  75  Oracle error  ERORA
# Errn  76  SQL Server error  ERING
# Errn  77  Too many Options in this menu ERRTOM
# Errn  78  Error on transaction file ERTRAN
# Errn  79  Too many open windows ERTRWD   (MASK)
# Errn  80  Error in the initialization of the terminal ETERIN

End

Subprog TC_ERR_81_90
Local Integer A,B,C,D,ERR
Local Tinyint E
Local Date F_DATE
Onerrgo ERROR
# Errn  81  Non-existent field  ENAREA
# Errn  82  Too many reports open ERTROFORM
# Errn  83  Opening of the same report twice  EROUVFORM
# Errn  84  Object already existing EROBEX
End

Subprog TMP_ERRET
Local Integer A : A=0
Onerrgo ERROR
ERR=32
If !A
  Return
Endif

End
