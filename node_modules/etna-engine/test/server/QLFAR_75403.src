#<AdxTL>@(#)6.0.0.0 $Revision$
Infbox func TESTSUITE()
End

# ---------- TEST_SUITE field synchronisation -----------------
# -------------------------------------------------------------

Funprog TESTSUITE()

  Call ADD_TESTCASE("TEST_SDA0", "Classic test", 14) From AXUNIT
  Call ADD_TESTCASE("TEST_SDA1", "date test", 14) From AXUNIT



End func AXUNIT.RUN_TESTSUITE("Evaluesdata", "Common")

# -----------------------TEST_VARIABLE --------------------------------
# ###################################################################
Subprog TEST_SDA0( )
Local Char TBPRO(20)(1..10)
Local Char TBFIL(20)(1..10)
Local File AABREV [ABV]
Local Integer I

# ---------------- Cas 1, all provided ------------------------
# -------------------------------------------------------------
TBPRO(1) = "TOTO"
TBFIL(1) = "[F:ABV]ABREV"

Filter [ABV] Where evalueSData("TOTO eq '%'",TBPRO,TBFIL)
I = 0
For [ABV]
    Call CHECK_EQUAL( [ABV]ABREV, "%" ) From AXUNIT
    I += 1
Next
Call CHECK_EQUAL( I, 1 ) From AXUNIT


# ---------------- Cas 2, no class F ------------------------
# -----------------------------------------------------------
TBPRO(1) = "TOTO"
TBFIL(1) = "[ABV]ABREV"
Filter [ABV] Where evalueSData("TOTO eq '%'",TBPRO,TBFIL)
I = 0
For [ABV]
    Call CHECK_EQUAL( [ABV]ABREV, "%" ) From AXUNIT
    I += 1
Next
Call CHECK_EQUAL( I, 1 ) From AXUNIT

# ---------------- Cas 3, no class ----------------------------
# -------------------------------------------------------------
TBPRO(1) = "TOTO"
TBFIL(1) = "ABREV"
Filter [ABV] Where evalueSData("TOTO eq '%'",TBPRO,TBFIL)
I = 0
For [ABV]
    Call CHECK_EQUAL( [ABV]ABREV, "%" ) From AXUNIT
    I += 1
Next
Call CHECK_EQUAL( I, 1 ) From AXUNIT

# ---------------- Cas 4 no class at all ------------------------
# ---------------------------------------------------------------
TBPRO(1) = ""
TBFIL(1) = ""
Filter [ABV] Where evalueSData("ABREV eq '%'",TBPRO,TBFIL)
I = 0
For [ABV]
    Call CHECK_EQUAL( [ABV]ABREV, "%" ) From AXUNIT
    I += 1
Next
Call CHECK_EQUAL( I, 1 ) From AXUNIT


# ---------------- Cas 5 class not well formed : ignored --------
# ---------------------------------------------------------------
TBPRO(1) = "TOTO"
TBFIL(1) = "AB]ABREV"
Filter [ABV] Where evalueSData("TOTO eq '%'",TBPRO,TBFIL)
I = 0
For [ABV]
    Call CHECK_EQUAL( [ABV]ABREV, "%" ) From AXUNIT
    I += 1
Next
Call CHECK_EQUAL( I, 1 ) From AXUNIT


# ---------------- Cas 6 class no field provided ----------------
# ---------------------------------------------------------------
TBPRO(1) = "ABREV"
TBFIL(1) = "[ABV]"
Filter [ABV] Where evalueSData("ABREV eq '%'",TBPRO,TBFIL)
I = 0
For [ABV]
    Call CHECK_EQUAL( [ABV]ABREV, "%" ) From AXUNIT
    I += 1
Next
Call CHECK_EQUAL( I, 1 ) From AXUNIT


# ---------------- Cas 7 class nothing provided -----------------
# ---------------------------------------------------------------
TBPRO(1) = "ABREV"
TBFIL(1) = ""
Filter [ABV] Where evalueSData("ABREV eq '%'",TBPRO,TBFIL)
I = 0
For [ABV]
    Call CHECK_EQUAL( [ABV]ABREV, "%" ) From AXUNIT
    I += 1
Next
Call CHECK_EQUAL( I, 1 ) From AXUNIT

Close Local File [ABV]

End


Subprog TEST_SDA1( )
Local Char TBPRO(20)(1..10)
Local Char TBFIL(20)(1..10)
Local File AABREV [ABV]
Local Integer I


TBPRO(1) = "CREDATTIM"
TBFIL(1) = "[ABV]"
Filter [ABV] Where evalueSData("CREDATTIM eq @@",TBPRO,TBFIL)
I = 0
For [ABV]
    I += 1
Next
Call CHECK_NOTEQUAL( I, 0 ) From AXUNIT

Filter [ABV] Where evalueSData("CREDATTIM eq null",TBPRO,TBFIL)
I = 0
For [ABV]
    I += 1
Next
Call CHECK_NOTEQUAL( I, 0 ) From AXUNIT



End
