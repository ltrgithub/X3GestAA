#<AdxTL>@(#)0.0.0.0 $Revision$
Call OUVRE_TRACE("QLFAR_ARRAY3") From LECFIC
Call TESTSUITE()

Call FERME_TRACE From LECFIC
GTRACE = "QLFAR_ARRAY3_"+GUSER
Call LEC_TRACE From LECFIC
End

Funprog TESTSUITE_()
Call SET_LOCALE("fr-FR") From ASYRQLF

Call TESTSUITE_START("ARRAY3", "ARRAY3") From AXUNIT

Local Clbfile  SUITE_RESULT
SUITE_RESULT = func AXUNIT.RUN_TESTSUITE("ARRAY3", "ARRAY3")
End SUITE_RESULT


Funprog TESTSUITE()
Call SET_LOCALE("fr-FR") From ASYRQLF

Call TESTSUITE_START("ARRAY3", "ARRAY3") From AXUNIT
Local Integer NBTEST

NBTEST = 34
Call ADD_TESTCASE("TC_INSA0","TC_INSA0"-"Function Insa 0..",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_INSA1","TC_INSA1"-"Function Insa 1..",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_INSA0_9","TC_INSA0_9"-"Function Insa 0..9",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_INSA1_10","TC_INSA1_10"-"Function Insa 1..10",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_INSA10","TC_INSA10"-"Function Insa 10",NBTEST) From AXUNIT

NBTEST = 30
Call ADD_TESTCASE("TC_DELA0","TC_DELA0"-"Function Dela 0..",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_DELA1","TC_DELA1"-"Function Dela 1..",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_DELA0_9","TC_DELA0_9"-"Function Dela 0..9",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_DELA1_10","TC_DELA1_10"-"Function Dela 1..10",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_DELA10","TC_DELA10"-"Function Dela 10",NBTEST) From AXUNIT

NBTEST = 38
Call ADD_TESTCASE("TC_FIND0","TC_FIND0"-"Function Find 0..",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_FIND1","TC_FIND1"-"Function Find 1..",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_FIND0_9","TC_FIND0_9"-"Function Find 0..9",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_FIND1_10","TC_FIND1_10"-"Function Find 1..10",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_FIND10","TC_FIND10"-"Function Find 10",NBTEST) From AXUNIT

NBTEST = 26
Call ADD_TESTCASE("TC_DIM0","TC_DIM0"-"Function TC_DIM0",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_DIM1","TC_DIM1"-"Function TC_DIM1",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_DIM5","TC_DIM5"-"Function TC_DIM5",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_DIM1_12","TC_DIM1_12"-"Function TC_DIM1_12",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_DIM0_11","TC_DIM1_11"-"Function TC_DIM0_11",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_DIM534","TC_DIM534"-"Function TC_DIM534",NBTEST) From AXUNIT

Local Clbfile  SUITE_RESULT
SUITE_RESULT = func AXUNIT.RUN_TESTSUITE("ARRAY3", "ARRAY3")
End SUITE_RESULT

$ERROR
Call CHECK_EQUAL(errn, EX)
EX = 0
Resume

Subprog CHECK_EVAL(STR, RESULT)
Call CHECK_EQUAL(evalue(STR), RESULT) From AXUNIT
End

Subprog CHECK_EQUAL(GOT, EXPECT)
Call CHECK_EQUAL(GOT, EXPECT) From AXUNIT
End

#--------------------------------------------------#
$DEF_TAB
Call CHECK_EQUAL("DEF_TAB","DEF_TAB")
Local Integer STR,MAXI
If WCAS="0.."
 Local Char CAR1(10)(0..)
 Local Char CAR2(10)(0..)
 Local Char CAR3(10)(0..)
 STR = 0
 MAXI = 9
 Call CHECK_EQUAL(maxtab (CAR1),0)
 Call CHECK_EQUAL(dim(CAR1),32767)
 Call CHECK_EQUAL(dim(CAR1,0),1)
 Call CHECK_EQUAL(dim(CAR1,1),32767)
 Call CHECK_EQUAL(dim(CAR1,-1),0)
Elsif WCAS="1.."
 Local Char CAR1(10)(1..)
 Local Char CAR2(10)(1..)
 Local Char CAR3(10)(1..)
 STR = 1
 MAXI = 10
 Call CHECK_EQUAL(maxtab (CAR1),0)
 Call CHECK_EQUAL(dim(CAR1),32767)
 Call CHECK_EQUAL(dim(CAR1,0),1)
 Call CHECK_EQUAL(dim(CAR1,1),32767)
 Call CHECK_EQUAL(dim(CAR1,-1),1)
Elsif WCAS="1..10"
 Local Char CAR1(10)(1..10)
 Local Char CAR2(10)(1..10)
 Local Char CAR3(10)(1..10)
 STR = 1
 MAXI = 10
 Call CHECK_EQUAL(maxtab (CAR1),10)
 Call CHECK_EQUAL(dim(CAR1),10)
 Call CHECK_EQUAL(dim(CAR1,0),1)
 Call CHECK_EQUAL(dim(CAR1,1),10)
 Call CHECK_EQUAL(dim(CAR1,-1),1)
Elsif WCAS="0..9"
 Local Char CAR1(10)(0..9)
 Local Char CAR2(10)(0..9)
 Local Char CAR3(10)(0..9)
 STR = 0
 MAXI = 9
 Call CHECK_EQUAL(maxtab (CAR1),10)
 Call CHECK_EQUAL(dim(CAR1),10)
 Call CHECK_EQUAL(dim(CAR1,0),1)
 Call CHECK_EQUAL(dim(CAR1,1),10)
 Call CHECK_EQUAL(dim(CAR1,-1),0)
Elsif WCAS="10"
 Local Char CAR1(10)(10)
 Local Char CAR2(10)(10)
 Local Char CAR3(10)(10)
 STR = 0
 MAXI = 9
 Call CHECK_EQUAL(maxtab (CAR1),10)
 Call CHECK_EQUAL(dim(CAR1),10)
 Call CHECK_EQUAL(dim(CAR1,0),1)
 Call CHECK_EQUAL(dim(CAR1,1),10)
 Call CHECK_EQUAL(dim(CAR1,-1),0)
Endif

#Error(50) - Fonction indéfinie pour la valeur donnée
Local Integer EX : EX=50
Onerrgo ERROR
Call CHECK_EQUAL(dim(CAR1,2),0)
Return

#--------------------------------------------------#
$INSERT_TAB
Call CHECK_EQUAL("INSERT_TAB","INSERT_TAB")
For I=STR To MAXI
 Insa I, 1 CAR1,CAR2,CAR3
 If WCAS="0.."
 Call CHECK_EQUAL(maxtab (CAR1),I+1)
 Elsif WCAS="1.."
 Call CHECK_EQUAL(maxtab (CAR1),I)
 Else
 Call CHECK_EQUAL(maxtab (CAR1),10)
 Endif
 CAR1(I) = "A"+num$(I)
 CAR2(I) = "B"+num$(I)
 CAR3(I) = "C"+num$(I)
Next
Call CHECK_EQUAL(maxtab (CAR1),10)
Call CHECK_EQUAL(dim(CAR1,0),1)
If WCAS="0.."
 Call CHECK_EQUAL(dim(CAR1),32767)
 Call CHECK_EQUAL(dim(CAR1,1),32767)
 Call CHECK_EQUAL(dim(CAR1,-1),0)
Elsif WCAS="1.."
 Call CHECK_EQUAL(dim(CAR1),32767)
 Call CHECK_EQUAL(dim(CAR1,1),32767)
 Call CHECK_EQUAL(dim(CAR1,-1),1)
Elsif WCAS="1..10"
 Call CHECK_EQUAL(dim(CAR1),10)
 Call CHECK_EQUAL(dim(CAR1,1),10)
 Call CHECK_EQUAL(dim(CAR1,-1),1)
Elsif WCAS="0..9"
 Call CHECK_EQUAL(dim(CAR1),10)
 Call CHECK_EQUAL(dim(CAR1,1),10)
 Call CHECK_EQUAL(dim(CAR1,-1),0)
Elsif WCAS="10"
 Call CHECK_EQUAL(dim(CAR1),10)
 Call CHECK_EQUAL(dim(CAR1,1),10)
 Call CHECK_EQUAL(dim(CAR1,-1),0)
Endif
Return

#--------------------------------------------------#
$VERIF_TAB_INSA
Call CHECK_EQUAL("VERIF_TAB_INSA","VERIF_TAB_INSA")
Call CHECK_EQUAL(CAR1(5),"A5")
Insa  5, 1 CAR1,CAR2,CAR3
CAR1(5) = "555"
Call CHECK_EQUAL(CAR1(5),"555")
Case WCAS
 When "0.."
  Call CHECK_EQUAL(maxtab (CAR1),11)
 When "1.."
  Call CHECK_EQUAL(maxtab (CAR1),11)
 When "0..9"
  Call CHECK_EQUAL(maxtab (CAR1),10)
 When "1..10"
  Call CHECK_EQUAL(maxtab (CAR1),10)
 When "10"
  Call CHECK_EQUAL(maxtab (CAR1),10)
Endcase
Insa  5, 2 CAR1,CAR2,CAR3
Case WCAS
 When "0.."
  Call CHECK_EQUAL(maxtab (CAR1),13)
 When "1.."
  Call CHECK_EQUAL(maxtab (CAR1),13)
 When "0..9"
  Call CHECK_EQUAL(maxtab (CAR1),10)
 When "1..10"
  Call CHECK_EQUAL(maxtab (CAR1),10)
 When "10"
  Call CHECK_EQUAL(maxtab (CAR1),10)
Endcase
Call CHECK_EQUAL(CAR1(5),"")
Case WCAS
 When "0.."
  Call CHECK_EQUAL(CAR1(maxtab (CAR1)-1),"A9")
 When "1.."
  Call CHECK_EQUAL(CAR1(maxtab (CAR1)),"A10")
 When "0..9"
  Call CHECK_EQUAL(CAR1(maxtab (CAR1)-1),"A6")
 When "10"
  Call CHECK_EQUAL(CAR1(maxtab (CAR1)-1),"A6")
 When "1..10"
  Call CHECK_EQUAL(CAR1(maxtab (CAR1)),"A7")
Endcase
Call CHECK_EQUAL(dim(CAR1,0),1)
If WCAS="0.."
 Call CHECK_EQUAL(dim(CAR1),32767)
 Call CHECK_EQUAL(dim(CAR1,1),32767)
 Call CHECK_EQUAL(dim(CAR1,-1),0)
Elsif WCAS="1.."
 Call CHECK_EQUAL(dim(CAR1),32767)
 Call CHECK_EQUAL(dim(CAR1,1),32767)
 Call CHECK_EQUAL(dim(CAR1,-1),1)
Elsif WCAS="1..10"
 Call CHECK_EQUAL(dim(CAR1),10)
 Call CHECK_EQUAL(dim(CAR1,1),10)
 Call CHECK_EQUAL(dim(CAR1,-1),1)
Elsif WCAS="0..9"
 Call CHECK_EQUAL(dim(CAR1),10)
 Call CHECK_EQUAL(dim(CAR1,1),10)
 Call CHECK_EQUAL(dim(CAR1,-1),0)
Elsif WCAS="10"
 Call CHECK_EQUAL(dim(CAR1),10)
 Call CHECK_EQUAL(dim(CAR1,1),10)
 Call CHECK_EQUAL(dim(CAR1,-1),0)
Endif
Return

#--------------------------------------------------#
$VERIF_TAB_DELA
Call CHECK_EQUAL("VERIF_TAB_DELA","VERIF_TAB_DELA")
Dela 5,1 CAR1,CAR2,CAR3
Call CHECK_EQUAL(CAR1(5),"A6")
Dela 5,2 CAR1,CAR2,CAR3
Call CHECK_EQUAL(CAR2(5),"B8")
Call CHECK_EQUAL(dim(CAR1,0),1)
If WCAS="0.."
 Call CHECK_EQUAL(dim(CAR1),32767)
 Call CHECK_EQUAL(dim(CAR1,1),32767)
 Call CHECK_EQUAL(dim(CAR1,-1),0)
Elsif WCAS="1.."
 Call CHECK_EQUAL(dim(CAR1),32767)
 Call CHECK_EQUAL(dim(CAR1,1),32767)
 Call CHECK_EQUAL(dim(CAR1,-1),1)
Elsif WCAS="1..10"
 Call CHECK_EQUAL(dim(CAR1),10)
 Call CHECK_EQUAL(dim(CAR1,1),10)
 Call CHECK_EQUAL(dim(CAR1,-1),1)
Elsif WCAS="0..9"
 Call CHECK_EQUAL(dim(CAR1),10)
 Call CHECK_EQUAL(dim(CAR1,1),10)
 Call CHECK_EQUAL(dim(CAR1,-1),0)
Elsif WCAS="10"
 Call CHECK_EQUAL(dim(CAR1),10)
 Call CHECK_EQUAL(dim(CAR1,1),10)
 Call CHECK_EQUAL(dim(CAR1,-1),0)
Endif
Return

#--------------------------------------------------#
Subprog TC_INSA0
Local Char WCAS(10) : WCAS = '0..'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_INSA
End

#--------------------------------------------------#
Subprog TC_INSA1
Local Char WCAS(10) : WCAS = '1..'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_INSA
End

#--------------------------------------------------#
Subprog TC_INSA0_9
Local Char WCAS(10) : WCAS = '0..9'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_INSA
End

#--------------------------------------------------#
Subprog TC_INSA10
Local Char WCAS(10) : WCAS = '10'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_INSA
End

#--------------------------------------------------#
Subprog TC_INSA1_10
Local Char WCAS(10) : WCAS = '1..10'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_INSA
End

#--------------------------------------------------#

#--------------------------------------------------#
Subprog TC_DELA0
Local Char WCAS(10) : WCAS = '0..'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_DELA
End

#--------------------------------------------------#
Subprog TC_DELA1
Local Char WCAS(10) : WCAS = '1..'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_DELA
End

#--------------------------------------------------#
Subprog TC_DELA0_9
Local Char WCAS(10) : WCAS = '0..9'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_DELA
End

#--------------------------------------------------#
Subprog TC_DELA10
Local Char WCAS(10) : WCAS = '10'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_DELA
End

#--------------------------------------------------#
Subprog TC_DELA1_10
Local Char WCAS(10) : WCAS = '1..10'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_DELA
End
#--------------------------------------------------#

#--------------------------------------------------#
$VERIF_TAB_FIND
Call CHECK_EQUAL("VERIF_TAB_FIND","VERIF_TAB_FIND")
Dela 5,1 CAR1,CAR2,CAR3
Call CHECK_EQUAL(CAR1(5),"A6")
If pat(WCAS,"0*") | WCAS="10"
Call CHECK_EQUAL(find("A6",CAR1),6)
Call CHECK_EQUAL(sum(CAR1),'A0A1A2A3A4A6A7A8A9')
Else
Call CHECK_EQUAL(find("A6",CAR1),5)
Call CHECK_EQUAL(sum(CAR1),'A1A2A3A4A6A7A8A9A10')
Endif
Call CHECK_EQUAL(find("A6",CAR1(3..5)),3)

Call CHECK_EQUAL(sum(CAR1(3..5)),'A3A4A6')
Call CHECK_EQUAL(min(CAR1(3..5)),'A3')
Call CHECK_EQUAL(max(CAR1(3..5)),'A6')

Dela 5,2 CAR1,CAR2,CAR3
Call CHECK_EQUAL(CAR2(5),"B8")
If pat(WCAS,"0*") | WCAS="10"
Call CHECK_EQUAL(find("B8",CAR2),6)
Call CHECK_EQUAL(sum(CAR2),'B0B1B2B3B4B8B9')
Else
Call CHECK_EQUAL(find("B8",CAR2),5)
Call CHECK_EQUAL(sum(CAR2),'B1B2B3B4B8B9B10')
Endif
Call CHECK_EQUAL(find("B8",CAR2(3..5)),3)
Call CHECK_EQUAL(sum(CAR2(3..5)),'B3B4B8')
Call CHECK_EQUAL(min(CAR2(3..5)),'B3')
Call CHECK_EQUAL(max(CAR2(3..5)),'B8')
Return

#--------------------------------------------------#
Subprog TC_FIND0
Local Char WCAS(10) : WCAS = '0..'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_FIND
End

#--------------------------------------------------#
Subprog TC_FIND1
Local Char WCAS(10) : WCAS = '1..'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_FIND
End

#--------------------------------------------------#
Subprog TC_FIND0_9
Local Char WCAS(10) : WCAS = '0..9'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_FIND
End

#--------------------------------------------------#
Subprog TC_FIND10
Local Char WCAS(10) : WCAS = '10'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_FIND
End

#--------------------------------------------------#
Subprog TC_FIND1_10
Local Char WCAS(10) : WCAS = '1..10'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_FIND
End

#--------------------------------------------------#
Subprog TC_DIM534
#Déclaration d'un tableau 12*3*4 de chaînes de longueur maximale 8
    Char TOTO(8) (5..16,2..4,4..7)
    Integer RES1,RES2
    Call CHECK_EQUAL(num$(type(TOTO))-num$(dim(TOTO)),'18 12')
    Call CHECK_EQUAL(maxtab (TOTO),12)
    Call CHECK_EQUAL(dim (TOTO, 0),3)
    Call CHECK_EQUAL(dim (TOTO, 1),12)
    Call CHECK_EQUAL(dim (TOTO, -1),5)
    Call CHECK_EQUAL("TC_DIM534 Before For-1","TC_DIM534 Before For-1")
    For I=1 To dim (TOTO, 0)
     Raz RES1,RES2
     Case I
     When 1 : RES1=12 : RES2=5
     When 2 : RES1=3 : RES2=2
     When 3 : RES1=4 : RES2=4
     Endcase
     Call CHECK_EQUAL(dim (TOTO, I),RES1)
     Call CHECK_EQUAL(dim (TOTO, -I),RES2)
    Next I
    For I=1 To dim (TOTO, 0)
     TOTO(I+dim(TOTO,-1),I+dim(TOTO,-2)-1,I+dim(TOTO,-3))=num$(I)
    Next I
    Call CHECK_EQUAL(maxtab (TOTO),12)
    Call CHECK_EQUAL("TC_DIM534 Before For-2","TC_DIM534 Before For-2")
    For I=1 To dim (TOTO, 0)
     Raz RES1,RES2
     Case I
     When 1 : RES1=12 : RES2=5
     When 2 : RES1=3 : RES2=2
     When 3 : RES1=4 : RES2=4
     Endcase
     Call CHECK_EQUAL(dim (TOTO, I),RES1)
     Call CHECK_EQUAL(dim (TOTO, -I),RES2)
    Next I
    TOTO(6,3,4)="1"
    TOTO(9,2,4)="2"
    TOTO(6,2,6)="3"
    Call CHECK_EQUAL(TOTO(6,3,4),"1")
    Call CHECK_EQUAL(TOTO(9,2,4),"2")
    Call CHECK_EQUAL(TOTO(6,2,6),"3")
    Call CHECK_EQUAL(maxtab (TOTO),12)
    TOTO(16,2,4)="16"
    Call CHECK_EQUAL(maxtab (TOTO),12)
    TOTO(16,4,7)="16-16"
    Call CHECK_EQUAL(maxtab (TOTO),12)
End

#--------------------------------------------------#
Subprog TC_DIM5
#Déclaration d'un tableau 12*3*4 de chaînes de longueur maximale 8
    Char TOTO(8) (5..16,3,4)
    Integer RES1,RES2
    Call CHECK_EQUAL(num$(type(TOTO))-num$(dim(TOTO)),'18 12')
    Call CHECK_EQUAL(maxtab (TOTO),12)
    Call CHECK_EQUAL(dim (TOTO, 0),3)
    Call CHECK_EQUAL(dim (TOTO, 1),12)
    Call CHECK_EQUAL(dim (TOTO, -1),5)
    Call CHECK_EQUAL("TC_DIM5 Before For-1","TC_DIM5 Before For-1")
    For I=1 To dim (TOTO, 0)
     Raz RES1,RES2
     Case I
     When 1 : RES1=12 : RES2=5
     When 2 : RES1=3 : RES2=0
     When 3 : RES1=4 : RES2=0
     Endcase
     Call CHECK_EQUAL(dim (TOTO, I),RES1)
     Call CHECK_EQUAL(dim (TOTO, -I),RES2)
    Next I
    For I=1 To dim (TOTO, 0)
     TOTO(I+dim(TOTO,-1),I-1,I)=num$(I)
    Next I
    Call CHECK_EQUAL(maxtab (TOTO),12)
    Call CHECK_EQUAL("TC_DIM5 Before For-2","TC_DIM5 Before For-2")
    For I=1 To dim (TOTO, 0)
     Raz RES1,RES2
     Case I
     When 1 : RES1=12 : RES2=5
     When 2 : RES1=3 : RES2=0
     When 3 : RES1=4 : RES2=0
     Endcase
     Call CHECK_EQUAL(dim (TOTO, I),RES1)
     Call CHECK_EQUAL(dim (TOTO, -I),RES2)
    Next I
    TOTO(7,0,3)="1"
    TOTO(9,2,3)="2"
    TOTO(16,2,3)="3"
    Call CHECK_EQUAL(TOTO(7,0,3),"1")
    Call CHECK_EQUAL(TOTO(9,2,3),"2")
    Call CHECK_EQUAL(TOTO(16,2,3),"3")
    Call CHECK_EQUAL(maxtab (TOTO),12)
    TOTO(16,0,0)="16"
    Call CHECK_EQUAL(maxtab (TOTO),12)
    TOTO(16,2,3)="16-16"
    Call CHECK_EQUAL(maxtab (TOTO),12)
End

#--------------------------------------------------#
Subprog TC_DIM1_12
#Déclaration d'un tableau 12*3*4 de chaînes de longueur maximale 10
    Char TOTO(10) (1..12,1..3,1..4)
    Integer RES1,RES2
    Call CHECK_EQUAL(num$(type(TOTO))-num$(dim(TOTO)),'20 12')
    Call CHECK_EQUAL(maxtab (TOTO),12)
    Call CHECK_EQUAL(dim (TOTO, 0),3)
    Call CHECK_EQUAL(dim (TOTO, 1),12)
    Call CHECK_EQUAL(dim (TOTO, -1),1)
    Call CHECK_EQUAL("TC_DIM1_12 Before For-1","TC_DIM1_12 Before For-1")
    For I=1 To dim (TOTO, 0)
     Raz RES1,RES2
     Case I
     When 1 : RES1=12 : RES2=1
     When 2 : RES1=3 : RES2=1
     When 3 : RES1=4 : RES2=1
     Endcase
     Call CHECK_EQUAL(dim (TOTO, I),RES1)
     Call CHECK_EQUAL(dim (TOTO, -I),RES2)
    Next I
    For I=1 To dim (TOTO, 0)
     TOTO(I+dim(TOTO,-1),I,I)=num$(I)
    Next I
    Call CHECK_EQUAL(maxtab (TOTO),12)
    Call CHECK_EQUAL("TC_DIM1_12 Before For-2","TC_DIM1_12 Before For-2")
    For I=1 To dim (TOTO, 0)
     Raz RES1,RES2
     Case I
     When 1 : RES1=12 : RES2=1
     When 2 : RES1=3 : RES2=1
     When 3 : RES1=4 : RES2=1
     Endcase
     Call CHECK_EQUAL(dim (TOTO, I),RES1)
     Call CHECK_EQUAL(dim (TOTO, -I),RES2)
    Next I
    TOTO(3,2,2)="1"
    TOTO(2,3,2)="2"
    TOTO(2,2,3)="3"
    Call CHECK_EQUAL(TOTO(3,2,2),"1")
    Call CHECK_EQUAL(TOTO(2,3,2),"2")
    Call CHECK_EQUAL(TOTO(2,2,3),"3")
    Call CHECK_EQUAL(maxtab (TOTO),12)
    TOTO(12,1,1)="12"
    Call CHECK_EQUAL(maxtab (TOTO),12)
    TOTO(12,3,4)="16-16"
    Call CHECK_EQUAL(maxtab (TOTO),12)
End

#--------------------------------------------------#
Subprog TC_DIM1
#Déclaration d'un tableau 12*3*4 de chaînes de longueur maximale 10
    Char TOTO(10) (1..,1..3,1..4)
    Integer RES1,RES2
    Call CHECK_EQUAL(num$(type(TOTO))-num$(dim(TOTO)),'20 32767')
    Call CHECK_EQUAL(maxtab (TOTO),0)
    Call CHECK_EQUAL(dim (TOTO, 0),3)
    Call CHECK_EQUAL(dim (TOTO, 1),32767)
    Call CHECK_EQUAL(dim (TOTO, -1),1)
    Call CHECK_EQUAL("TC_DIM1 Before For-1","TC_DIM1 Before For-1")
    For I=1 To dim (TOTO, 0)
     Raz RES1,RES2
     Case I
     When 1 : RES1=32767 : RES2=1
     When 2 : RES1=3 : RES2=1
     When 3 : RES1=4 : RES2=1
     Endcase
     Call CHECK_EQUAL(dim (TOTO, I),RES1)
     Call CHECK_EQUAL(dim (TOTO, -I),RES2)
    Next I
    For I=1 To dim (TOTO, 0)
     TOTO(I+dim(TOTO,-1),I,I)=num$(I)
    Next I
    Call CHECK_EQUAL(maxtab (TOTO),4)
    Call CHECK_EQUAL("TC_DIM1 Before For-2","TC_DIM1 Before For-2")
    For I=1 To dim (TOTO, 0)
     Raz RES1,RES2
     Case I
     When 1 : RES1=32767 : RES2=1
     When 2 : RES1=3 : RES2=1
     When 3 : RES1=4 : RES2=1
     Endcase
     Call CHECK_EQUAL(dim (TOTO, I),RES1)
     Call CHECK_EQUAL(dim (TOTO, -I),RES2)
    Next I
    TOTO(3,2,2)="1"
    TOTO(2,3,2)="2"
    TOTO(2,2,3)="3"
    Call CHECK_EQUAL(TOTO(3,2,2),"1")
    Call CHECK_EQUAL(TOTO(2,3,2),"2")
    Call CHECK_EQUAL(TOTO(2,2,3),"3")
    Call CHECK_EQUAL(maxtab (TOTO),4)
    TOTO(16,1,1)="16"
    Call CHECK_EQUAL(maxtab (TOTO),16)
    TOTO(16,3,4)="16-16"
    Call CHECK_EQUAL(maxtab (TOTO),16)
End

#--------------------------------------------------#
Subprog TC_DIM0
#Déclaration d'un tableau x*3*4 de chaînes de longueur maximale 10
    Char TOTO(10) (0..,3,4)
    Integer RES1,RES2
    Call CHECK_EQUAL(num$(type(TOTO))-num$(dim(TOTO)),'20 32767')
    Call CHECK_EQUAL(maxtab (TOTO),0)
    Call CHECK_EQUAL(dim (TOTO, 0),3)
    Call CHECK_EQUAL(dim (TOTO, 1),32767)
    Call CHECK_EQUAL(dim (TOTO, -1),0)
    Call CHECK_EQUAL("TC_DIM0 Before For-1","TC_DIM0 Before For-1")
    For I=1 To dim (TOTO, 0)
     Raz RES1,RES2
     Case I
     When 1 : RES1=32767 : RES2=0
     When 2 : RES1=3 : RES2=0
     When 3 : RES1=4 : RES2=0
     Endcase
     Call CHECK_EQUAL(dim (TOTO, I),RES1)
     Call CHECK_EQUAL(dim (TOTO, -I),RES2)
    Next I
    For I=1 To dim (TOTO, 0)
     TOTO(I+dim(TOTO,-1),I-1,I)=num$(I)
    Next I
    Call CHECK_EQUAL(maxtab (TOTO),3)
    Call CHECK_EQUAL("TC_DIM0 Before For-2","TC_DIM0 Before For-2")
    For I=1 To dim (TOTO, 0)
     Raz RES1,RES2
     Case I
     When 1 : RES1=32767 : RES2=0
     When 2 : RES1=3 : RES2=0
     When 3 : RES1=4 : RES2=0
     Endcase
     Call CHECK_EQUAL(dim (TOTO, I),RES1)
     Call CHECK_EQUAL(dim (TOTO, -I),RES2)
    Next I
    TOTO(1,2,2)="1"
    TOTO(2,1,2)="2"
    TOTO(2,2,1)="3"
    Call CHECK_EQUAL(TOTO(1,2,2),"1")
    Call CHECK_EQUAL(TOTO(2,1,2),"2")
    Call CHECK_EQUAL(TOTO(2,2,1),"3")
    Call CHECK_EQUAL(maxtab (TOTO),3)
    TOTO(16,0,0)="16"
    Call CHECK_EQUAL(maxtab (TOTO),16)
    TOTO(16,2,3)="16-16"
    Call CHECK_EQUAL(maxtab (TOTO),16)
End

#--------------------------------------------------#
Subprog TC_DIM0_11
#Déclaration d'un tableau 12*3*4 de chaînes de longueur maximale 10
    Char TOTO(10) (0..11,3,4)
    Integer RES1,RES2
    Call CHECK_EQUAL(num$(type(TOTO))-num$(dim(TOTO)),'20 12')
    Call CHECK_EQUAL(maxtab (TOTO),12)
    Call CHECK_EQUAL(dim (TOTO, 0),3)
    Call CHECK_EQUAL(dim (TOTO, 1),12)
    Call CHECK_EQUAL(dim (TOTO, -1),0)
    Call CHECK_EQUAL("TC_DIM0_11 Before For-1","TC_DIM0_11 Before For-1")
    For I=1 To dim (TOTO, 0)
     Raz RES1,RES2
     Case I
     When 1 : RES1=12 : RES2=0
     When 2 : RES1=3 : RES2=0
     When 3 : RES1=4 : RES2=0
     Endcase
     Call CHECK_EQUAL(dim (TOTO, I),RES1)
     Call CHECK_EQUAL(dim (TOTO, -I),RES2)
    Next I
    For I=1 To dim (TOTO, 0)
     TOTO(I+dim(TOTO,-1),I-1,I)=num$(I)
    Next I
    Call CHECK_EQUAL(maxtab (TOTO),12)
    Call CHECK_EQUAL("TC_DIM0_11 Before For-2","TC_DIM0_11 Before For-2")
    For I=1 To dim (TOTO, 0)
     Raz RES1,RES2
     Case I
     When 1 : RES1=12 : RES2=0
     When 2 : RES1=3 : RES2=0
     When 3 : RES1=4 : RES2=0
     Endcase
     Call CHECK_EQUAL(dim (TOTO, I),RES1)
     Call CHECK_EQUAL(dim (TOTO, -I),RES2)
    Next I
    TOTO(3,2,2)="1"
    TOTO(6,2,0)="2"
    TOTO(4,0,3)="3"
    Call CHECK_EQUAL(TOTO(3,2,2),"1")
    Call CHECK_EQUAL(TOTO(6,2,0),"2")
    Call CHECK_EQUAL(TOTO(4,0,3),"3")
    Call CHECK_EQUAL(maxtab (TOTO),12)
    TOTO(11,0,0)="11"
    Call CHECK_EQUAL(maxtab (TOTO),12)
    TOTO(11,2,3)="11-11"
    Call CHECK_EQUAL(maxtab (TOTO),12)
End
