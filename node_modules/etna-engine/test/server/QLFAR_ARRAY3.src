#<AdxTL>@(#)0.0.0.0 $Revision$
Call OUVRE_TRACE("QLFAR_ARRAY3") From LECFIC
Call TESTSUITE()

Call FERME_TRACE From LECFIC
GTRACE = "QLFAR_ARRAY3_"+GUSER
Call LEC_TRACE From LECFIC
End

Funprog TESTSUITE_()
Call SET_LOCALE("fr-FR") From ASYRQLF

Call TESTSUITE_START("ARRAY3", "ARRAY3") From AXUNIT

Local Clbfile  SUITE_RESULT
SUITE_RESULT = func AXUNIT.RUN_TESTSUITE("ARRAY3", "ARRAY3")
End SUITE_RESULT


Funprog TESTSUITE()
Call SET_LOCALE("fr-FR") From ASYRQLF

Call TESTSUITE_START("ARRAY3", "ARRAY3") From AXUNIT
Local Integer NBTEST

NBTEST = 18
Call ADD_TESTCASE("TC_INSA0","TC_INSA0"-"Function Insa 0..",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_INSA1","TC_INSA1"-"Function Insa 1..",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_INSA0_9","TC_INSA0_9"-"Function Insa 0..9",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_INSA1_10","TC_INSA1_10"-"Function Insa 1..10",NBTEST) From AXUNIT

NBTEST = 14
Call ADD_TESTCASE("TC_DELA0","TC_DELA0"-"Function Dela 0..",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_DELA1","TC_DELA1"-"Function Dela 1..",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_DELA0_9","TC_DELA0_9"-"Function Dela 0..9",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_DELA1_10","TC_DELA1_10"-"Function Dela 1..10",NBTEST) From AXUNIT

NBTEST = 26
Call ADD_TESTCASE("TC_FIND0","TC_FIND0"-"Function Find 0..",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_FIND1","TC_FIND1"-"Function Find 1..",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_FIND0_9","TC_FIND0_9"-"Function Find 0..9",NBTEST) From AXUNIT
Call ADD_TESTCASE("TC_FIND1_10","TC_FIND1_10"-"Function Find 1..10",NBTEST) From AXUNIT

Local Clbfile  SUITE_RESULT
SUITE_RESULT = func AXUNIT.RUN_TESTSUITE("ARRAY3", "ARRAY3")
End SUITE_RESULT

$ERROR
Call CHECK_EQUAL(errn, EX)
EX = 0
Resume

Subprog CHECK_EVAL(STR, RESULT)
Call CHECK_EQUAL(evalue(STR), RESULT) From AXUNIT
End

Subprog CHECK_EQUAL(GOT, EXPECT)
Call CHECK_EQUAL(GOT, EXPECT) From AXUNIT
End

#--------------------------------------------------#
$DEF_TAB
Local Integer STR,MAXI
If WCAS="0.."
 Local Char CAR1(10)(0..)
 Local Char CAR2(10)(0..)
 Local Char CAR3(10)(0..)
 STR = 0
 MAXI = 9
 Call CHECK_EQUAL(maxtab (CAR1),0)
Elsif WCAS="1.."
 Local Char CAR1(10)(1..)
 Local Char CAR2(10)(1..)
 Local Char CAR3(10)(1..)
 STR = 1
 MAXI = 10
 Call CHECK_EQUAL(maxtab (CAR1),0)
Elsif WCAS="1..10"
 Local Char CAR1(10)(1..10)
 Local Char CAR2(10)(1..10)
 Local Char CAR3(10)(1..10)
 STR = 1
 MAXI = 10
 Call CHECK_EQUAL(maxtab (CAR1),10)
Elsif WCAS="0..9"
 Local Char CAR1(10)(0..9)
 Local Char CAR2(10)(0..9)
 Local Char CAR3(10)(0..9)
 STR = 0
 MAXI = 9
 Call CHECK_EQUAL(maxtab (CAR1),10)
Endif
Return

#--------------------------------------------------#
$INSERT_TAB
For I=STR To MAXI
 Insa I, 1 CAR1,CAR2,CAR3
 If WCAS="0.."
 Call CHECK_EQUAL(maxtab (CAR1),I+1)
 Elsif WCAS="1.."
 Call CHECK_EQUAL(maxtab (CAR1),I)
 Else
 Call CHECK_EQUAL(maxtab (CAR1),10)
 Endif
 CAR1(I) = "A"+num$(I)
 CAR2(I) = "B"+num$(I)
 CAR3(I) = "C"+num$(I)
Next
Call CHECK_EQUAL(maxtab (CAR1),10)
Return

#--------------------------------------------------#
$VERIF_TAB_INSA
Call CHECK_EQUAL(CAR1(5),"A5")
Insa  5, 1 CAR1,CAR2,CAR3
CAR1(5) = "555"
Call CHECK_EQUAL(CAR1(5),"555")
Case WCAS
 When "0.."
  Call CHECK_EQUAL(maxtab (CAR1),11)
 When "1.."
  Call CHECK_EQUAL(maxtab (CAR1),11)
 When "0..9"
  Call CHECK_EQUAL(maxtab (CAR1),10)
 When "1..10"
  Call CHECK_EQUAL(maxtab (CAR1),10)
Endcase
Insa  5, 2 CAR1,CAR2,CAR3
Case WCAS
 When "0.."
  Call CHECK_EQUAL(maxtab (CAR1),13)
 When "1.."
  Call CHECK_EQUAL(maxtab (CAR1),13)
 When "0..9"
  Call CHECK_EQUAL(maxtab (CAR1),10)
 When "1..10"
  Call CHECK_EQUAL(maxtab (CAR1),10)
Endcase
Call CHECK_EQUAL(CAR1(5),"")
Case WCAS
 When "0.."
  Call CHECK_EQUAL(CAR1(maxtab (CAR1)-1),"A9")
 When "1.."
  Call CHECK_EQUAL(CAR1(maxtab (CAR1)),"A10")
 When "0..9"
  Call CHECK_EQUAL(CAR1(maxtab (CAR1)-1),"A6")
 When "1..10"
  Call CHECK_EQUAL(CAR1(maxtab (CAR1)),"A7")
Endcase
Return

#--------------------------------------------------#
$VERIF_TAB_DELA
Dela 5,1 CAR1,CAR2,CAR3
Call CHECK_EQUAL(CAR1(5),"A6")
Dela 5,2 CAR1,CAR2,CAR3
Call CHECK_EQUAL(CAR2(5),"B8")
Return

#--------------------------------------------------#
Subprog TC_INSA0
Local Char WCAS(10) : WCAS = '0..'
Gosub DEF_TAB
#dbgetna
Gosub INSERT_TAB
Gosub VERIF_TAB_INSA
End

#--------------------------------------------------#
Subprog TC_INSA1
Local Char WCAS(10) : WCAS = '1..'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_INSA
End

#--------------------------------------------------#
Subprog TC_INSA0_9
Local Char WCAS(10) : WCAS = '0..9'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_INSA
End

#--------------------------------------------------#
Subprog TC_INSA1_10
Local Char WCAS(10) : WCAS = '1..10'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_INSA
End

#--------------------------------------------------#

#--------------------------------------------------#
Subprog TC_DELA0
Local Char WCAS(10) : WCAS = '0..'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_DELA
End

#--------------------------------------------------#
Subprog TC_DELA1
Local Char WCAS(10) : WCAS = '1..'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_DELA
End

#--------------------------------------------------#
Subprog TC_DELA0_9
Local Char WCAS(10) : WCAS = '0..9'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_DELA
End

#--------------------------------------------------#
Subprog TC_DELA1_10
Local Char WCAS(10) : WCAS = '1..10'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_DELA
End
#--------------------------------------------------#

#--------------------------------------------------#
$VERIF_TAB_FIND
Dela 5,1 CAR1,CAR2,CAR3
Call CHECK_EQUAL(CAR1(5),"A6")
If pat(WCAS,"0*")
Call CHECK_EQUAL(find("A6",CAR1),6)
Call CHECK_EQUAL(sum(CAR1),'A0A1A2A3A4A6A7A8A9')
Else
Call CHECK_EQUAL(find("A6",CAR1),5)
Call CHECK_EQUAL(sum(CAR1),'A1A2A3A4A6A7A8A9A10')
Endif
Call CHECK_EQUAL(find("A6",CAR1(3..5)),3)

Call CHECK_EQUAL(sum(CAR1(3..5)),'A3A4A6')
Call CHECK_EQUAL(min(CAR1(3..5)),'A3')
Call CHECK_EQUAL(max(CAR1(3..5)),'A6')

Dela 5,2 CAR1,CAR2,CAR3
Call CHECK_EQUAL(CAR2(5),"B8")
If pat(WCAS,"0*")
Call CHECK_EQUAL(find("B8",CAR2),6)
Call CHECK_EQUAL(sum(CAR2),'B0B1B2B3B4B8B9')
Else
Call CHECK_EQUAL(find("B8",CAR2),5)
Call CHECK_EQUAL(sum(CAR2),'B1B2B3B4B8B9B10')
Endif
Call CHECK_EQUAL(find("B8",CAR2(3..5)),3)
Call CHECK_EQUAL(sum(CAR2(3..5)),'B3B4B8')
Call CHECK_EQUAL(min(CAR2(3..5)),'B3')
Call CHECK_EQUAL(max(CAR2(3..5)),'B8')
Return

#--------------------------------------------------#
Subprog TC_FIND0
Local Char WCAS(10) : WCAS = '0..'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_FIND
End

#--------------------------------------------------#
Subprog TC_FIND1
Local Char WCAS(10) : WCAS = '1..'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_FIND
End

#--------------------------------------------------#
Subprog TC_FIND0_9
Local Char WCAS(10) : WCAS = '0..9'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_FIND
End

#--------------------------------------------------#
Subprog TC_FIND1_10
Local Char WCAS(10) : WCAS = '1..10'
Gosub DEF_TAB
Gosub INSERT_TAB
Gosub VERIF_TAB_FIND
End
