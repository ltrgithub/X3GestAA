#<AdxTL>@(#)8.0.0.0 $Revision$
TOTO = func TESTSUITE()
GTRACE = "QLFAR_93148_"+GUSER
Call LEC_TRACE From LECFIC




End

# ---------- TEST_SUITE check security -------------------------
# ------------------------------------------------------------------

Funprog TESTSUITE()

  Call ADD_TESTCASE("CHK_PATH", "", 2) From AXUNIT

  RES = func AXUNIT.RUN_TESTSUITE("security check", "Common")
  RES = func AXUNIT.RUN_TESTSUITE("Normalyse path", "Common")


End RES

# -----------------------checkpath --------------------------------
# ###################################################################
Subprog CHK_PATH( )

Local Integer ST
Local Integer I
Local Char PATH(50)(1..20)
Integer OPT(1..20)
Integer RST(1..20)


For I=6 To 13
    OPT(I) = 1
Next

GTRACE = "CHECK_"+GUSER

PATH(1) = adxdir                              : RST(1) = 0
PATH(2) = adxdir+"/"+"bin"                    : RST(2) = 0
PATH(3) = adxdir+"/"+"tmp"                    : RST(3) = 1
PATH(4) = adxdir+"/"+"sem"                    : RST(4) = 1
PATH(5) = adxdir+"/"+"cfg"                    : RST(5) = 1
PATH(6) = adxdir                              : RST(6) = 0
PATH(7) = adxdir+"/"+"bin"                    : RST(7) = 0
PATH(8) = adxdir+"/"+"tmp"                    : RST(8) = 1
PATH(9) = adxdir+"/"+"sem"                    : RST(9) = 1
PATH(10) = adxdir+"/"+"cfg"                   : RST(10) = 0

PATH(11) = adxdir+"/"+"sem"+"/"+"test.map"    : RST(11) = 1
PATH(12) = adxdir+"/"+"sem"+"/"+"test.dat"    : RST(12) = 1
PATH(13) = adxdir+"/"+"sem"+"/"+"test.txt"    : RST(13) = 0

I = 1
While (PATH(I) <> "")
    ST = CHECKPATH( PATH(I), OPT(I) )
    Call CHECK_EQUAL( ST, RST(I)) From AXUNIT

    I += 1
Wend

End
