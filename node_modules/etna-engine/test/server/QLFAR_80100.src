#<AdxTL>@(#)2.0.0.0 $Revision$

TOTO = func TESTSUITE()
Infbox TOTO

End

# ---------- TEST_SUITE hint key new sauce -------------------------
# ------------------------------------------------------------------

Funprog TESTSUITE()

    Call ADD_TESTCASE("TEST_FOR", "For tests", 21) From AXUNIT
    Call ADD_TESTCASE("TEST_READ", "Read tests", 21) From AXUNIT

End func AXUNIT.RUN_TESTSUITE("HINTKEY", "Common")

# -----------------------TEST_FOR -------------------------------------
# #####################################################################
Subprog TEST_FOR( )
    Local File ATABLE[ATB]
    Local File ATEXTE[ATX]


    # table simple    #####################################################
    #######################################################################
    # basic case
    Raz [ATB]
    For [ATB]CODFIC
        Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT
        Break
    Next

    # simple table 1
    Raz [ATB]
    For [ATB]CODFIC Hint Key [ATB]CODFIC
        Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT
        Break
    Next

    # simple table 2
    Raz [ATB]
    For [ATB]CODFIC Hint Key ABRFIC
        Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT
        Break
    Next

    # simple table 3
    Raz [ATB]
    For [ATB]CODFIC Hint Key ="[ATB]ABRFIC"
        Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT
        Break
    Next

    # simple table 4
    Raz [ATB]
    For [ATB]CODFIC Hint Key ="ABRFIC"
        Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT
        Break
    Next

    # simple table 5
    Onerrgo $ERROR_FOR
    Raz [ATB]
    For [ATB]CODFIC Hint Key TRALALA
        Break
    Next
    Onerrgo
    Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT

    # simple table 6
    Onerrgo $ERROR_FOR
    Raz [ATB]
    For [ATB]CODFIC Hint Key ="TRALALA"
        Break
    Next
    Onerrgo
    Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT

    # simple table 7
    Onerrgo $ERROR_FOR
    Raz [ATB]
    For [ATB]CODFIC Hint Key ="[ATX]NUMERO"
        Break
    Next
    Onerrgo
    Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT


    # link table   ########################################################
    #######################################################################
    Link [ATB] With [ATX]NUMERO="FRA";[ATB]INTITFIC As [LNK]

    # basic case
    Raz [LNK]
    For [LNK]CODFIC
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT
        Break
    Next

    # base table 1
    Raz [LNK]
    For [LNK]CODFIC Hint Key [ATB]CODFIC
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT
        Break
    Next

    # base table 2
    Raz [LNK]
    For [LNK]CODFIC Hint Key ABRFIC
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT
        Break
    Next

    # base table 3
    Raz [LNK]
    For [LNK]CODFIC Hint Key ="[ATB]ABRFIC"
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT
        Break
    Next

    # base table 4
    Raz [LNK]
    For [LNK]CODFIC Hint Key ="ABRFIC"
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT
        Break
    Next

    # linked table 1
    Raz [LNK]
    For [LNK]CODFIC Hint Key [ATX]NUMERO
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT
        Break
    Next


    # linked table 2
    Raz [LNK]
    For [LNK]CODFIC Hint Key ="[ATX]NUMERO"
        Break
    Next


    # error table 1
    Onerrgo ERROR_FOR
    Raz [LNK]
    For [LNK]CODFIC Hint Key TRALALA
        Break
    Next
    Onerrgo
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT

    # error table 2
    Onerrgo ERROR_FOR
    Raz [LNK]
    For [LNK]CODFIC Hint Key ="TRALALA"
        Break
    Next
    Onerrgo
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT


    Close File [LNK]
    Close File [ATB]
    Close File [ATX]
End

$ERROR_FOR
Call CHECK_EQUAL( errn, 21 ) From AXUNIT
Resume

# -----------------------TEST_READ ------------------------------------
# #####################################################################
Subprog TEST_READ( )

    Local File ATABLE[ATB]
    Local File ATEXTE[ATX]


    # table simple    #####################################################
    #######################################################################
    # basic case
    Raz [ATB]
    Read [ATB]CODFIC First
    Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT

    # simple table 1
    Raz [ATB]
    Read [ATB]CODFIC First Hint Key [ATB]CODFIC
    Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT

    # simple table 2
    Raz [ATB]
    Read [ATB]CODFIC First Hint Key ABRFIC
    Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT

    # simple table 3
    Raz [ATB]
    Read [ATB]CODFIC First Hint Key ="[ATB]ABRFIC"

    # simple table 4
    Raz [ATB]
    Read [ATB]CODFIC First Hint Key ="ABRFIC"
    Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT

    # simple table 5
    Onerrgo $ERROR_READ
    Raz [ATB]
    Read [ATB]CODFIC First Hint Key TRALALA
    Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT
    Onerrgo

    # simple table 6
    Onerrgo $ERROR_READ
    Raz [ATB]
    Read [ATB]CODFIC First Hint Key ="TRALALA"
    Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT

    Onerrgo

    # simple table 7
    Onerrgo $ERROR_READ
    Raz [ATB]
    Read [ATB]CODFIC First Hint Key ="[ATX]NUMERO"
    Call CHECK_NOTEQUAL( [ATB]CODFIC, "" ) From AXUNIT

    Onerrgo


    # link table   ########################################################
    #######################################################################
    Link [ATB] With [ATX]NUMERO="FRA";[ATB]INTITFIC As [LNK]

    # basic case
    Raz [LNK]
    Read [LNK]CODFIC First
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT

    # base table 1
    Raz [LNK]
    Read [LNK]CODFIC First  Hint Key [ATB]CODFIC
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT

    # base table 2
    Raz [LNK]
    Read [LNK]CODFIC First Hint Key ABRFIC
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT

    # base table 3
    Raz [LNK]
    Read [LNK]CODFIC First Hint Key ="[ATB]ABRFIC"
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT

    # base table 4
    Raz [LNK]
    Read [LNK]CODFIC First Hint Key ="ABRFIC"
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT

    # linked table 1
    Raz [LNK]
    Read [LNK]CODFIC First Hint Key [ATX]NUMERO
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT

    # linked table 2
    Raz [LNK]
    Read [LNK]CODFIC First Hint Key ="[ATX]NUMERO"
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT

    #cas filter
    Filter [LNK] Order By Key CODFIC Desc
    Read [LNK] First Hint Key [ATX]NUMERO
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT

    # error table 1
    Onerrgo $ERROR_READ
    Raz [LNK]
    Read [LNK]CODFIC First Hint Key TRALALA
    Onerrgo
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT

    # error table 2
    Onerrgo $ERROR_READ
    Raz [LNK]
    Read [LNK]CODFIC First Hint Key ="TRALALA"
    Onerrgo
    Call CHECK_NOTEQUAL( [LNK]CODFIC, "" ) From AXUNIT


    Close File [LNK]
    Close File [ATB]
    Close File [ATX]

End

$ERROR_READ
Call CHECK_EQUAL( errn, 21 ) From AXUNIT
Resume
