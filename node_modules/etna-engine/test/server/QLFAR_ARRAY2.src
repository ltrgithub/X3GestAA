#<AdxTL>@(#)2.0.0.0 $Revision$
Call OUVRE_TRACE("QLFAR_ARRAY2") From LECFIC
Call TESTSUITE()

Call FERME_TRACE From LECFIC
GTRACE = "QLFAR_ARRAY2_"+GUSER
Call LEC_TRACE From LECFIC
End

Funprog TESTSUITE_()
Call SET_LOCALE("fr-FR") From ASYRQLF

Call TESTSUITE_START("ARRAY2", "ARRAY2") From AXUNIT
EX=0
Onerrgo ERROR

Local Clbfile  SUITE_RESULT
SUITE_RESULT = func AXUNIT.RUN_TESTSUITE("ARRAY2", "ARRAY2")
End SUITE_RESULT


Funprog TESTSUITE()
Call SET_LOCALE("fr-FR") From ASYRQLF

Call TESTSUITE_START("ARRAY2", "ARRAY2") From AXUNIT
EX=0
Onerrgo ERROR

Call ADD_TESTCASE("TC_SORTA0_5","Function Sorta 0..5",6) From AXUNIT
Call ADD_TESTCASE("TC_SORTA0","Function Sorta 0..",6) From AXUNIT
Call ADD_TESTCASE("TC_SORTA1_6","Function Sorta 1..6",6) From AXUNIT
Call ADD_TESTCASE("TC_SORTA1","Function Sorta 1..",6) From AXUNIT
Call ADD_TESTCASE("TC_SORTA6","Function Sorta 6",6) From AXUNIT

Call ADD_TESTCASE("TC_ORD_SORTA6","Function Sorta array(6) Order By CAR(indice),NUM(indice)",6) From AXUNIT
Call ADD_TESTCASE("TC_ORD_SORTA0_5","Function Sorta array(0..5) Order By CAR(indice),NUM(indice)",6) From AXUNIT
Call ADD_TESTCASE("TC_ORD_SORTA0","Function Sorta array(0..) Order By CAR(indice),NUM(indice)",6) From AXUNIT
Call ADD_TESTCASE("TC_ORD_SORTA1_6","Function Sorta array(1..6) Order By CAR(indice+1),NUM(indice+1)",6) From AXUNIT
Call ADD_TESTCASE("TC_ORD_SORTA1","Function Sorta array(1..) Order By CAR(indice+1),NUM(indice+1)",6) From AXUNIT

Call ADD_TESTCASE("TC_ORDD_SORTA6","Function Sorta array(6) Order By -NUM(indice)",6) From AXUNIT
Call ADD_TESTCASE("TC_ORDD_SORTA0_5","Function Sorta array(0..5) Order By -NUM(indice)",6) From AXUNIT
Call ADD_TESTCASE("TC_ORDD_SORTA0","Function Sorta array(0..) Order By -NUM(indice)",6) From AXUNIT
Call ADD_TESTCASE("TC_ORDD_SORTA1_6","Function Sorta array(1..6) Order By -NUM(indice+1)",6) From AXUNIT
Call ADD_TESTCASE("TC_ORDD_SORTA1","Function Sorta array(1..) Order By -NUM(indice+1)",6) From AXUNIT

Call ADD_TESTCASE("TC_ORDDESC_SORTA6","Function Sorta array(6) Order By NUM(indice) Desc",6) From AXUNIT
Call ADD_TESTCASE("TC_ORDDESC_SORTA0_5","Function Sorta array(0..5) Order By NUM(indice) Desc",6) From AXUNIT
Call ADD_TESTCASE("TC_ORDDESC_SORTA0","Function Sorta array(0..) Order By NUM(indice) Desc",6) From AXUNIT
Call ADD_TESTCASE("TC_ORDDESC_SORTA1_6","Function Sorta array(1..6) Order By NUM(indice+1) Desc",6) From AXUNIT
Call ADD_TESTCASE("TC_ORDDESC_SORTA1","Function Sorta array(1..) Order By NUM(indice+1) Desc",6) From AXUNIT

Call ADD_TESTCASE("TC_ORDDESC1_SORTA6","Function Sorta array(6) Order By CAR(indice) Desc",6) From AXUNIT
Call ADD_TESTCASE("TC_ORDDESC1_SORTA0_5","Function Sorta array(0..5) Order By CAR(indice) Desc",6) From AXUNIT
Call ADD_TESTCASE("TC_ORDDESC1_SORTA0","Function Sorta array(0..) Order By CAR(indice) Desc",6) From AXUNIT
Call ADD_TESTCASE("TC_ORDDESC1_SORTA1_6","Function Sorta array(1..6) Order By CAR(indice+1) Desc",6) From AXUNIT
Call ADD_TESTCASE("TC_ORDDESC1_SORTA1","Function Sorta array(1..) Order By CAR(indice+1) Desc",6) From AXUNIT

Call ADD_TESTCASE("TC_FCTX6","Array(6) passed to Function",9) From AXUNIT
Call ADD_TESTCASE("TC_FCTX0_5","Array(0..5) passed to Function",9) From AXUNIT

If pat(ver$(0),"etna*")>0
Call ADD_TESTCASE("TC_FCTX0","Array(0..) passed to Function",9) From AXUNIT
Else
Call ADD_TESTCASE("TC_FCTX0","Array(0..) passed to Function",8) From AXUNIT
Endif

Call ADD_TESTCASE("TC_FCTX1_6","Array(1..6) passed to Function",9) From AXUNIT
Call ADD_TESTCASE("TC_FCTX1","Array(1..) passed to Function",9) From AXUNIT

Call ADD_TESTCASE("TC_FCT0_6","Array(6) passed to Function(0..)",9) From AXUNIT
Call ADD_TESTCASE("TC_FCT0_0_5","Array(0..5) passed to Function(0..)",9) From AXUNIT
Call ADD_TESTCASE("TC_FCT0_0","Array(0..) passed to Function(0..)",8) From AXUNIT
Call ADD_TESTCASE("TC_FCT0_1_6","Array(1..6) passed to Function(0..)",9) From AXUNIT
Call ADD_TESTCASE("TC_FCT0_1","Array(1..) passed to Function(0..)",9) From AXUNIT

Call ADD_TESTCASE("TC_FCT1_6","Array(6) passed to Function(1..)",9) From AXUNIT
Call ADD_TESTCASE("TC_FCT1_0_5","Array(0..5) passed to Function(1..)",9) From AXUNIT
Call ADD_TESTCASE("TC_FCT1_0","Array(0..) passed to Function(1..)",8) From AXUNIT
Call ADD_TESTCASE("TC_FCT1_1_6","Array(1..6) passed to Function(1..)",9) From AXUNIT
Call ADD_TESTCASE("TC_FCT1_1","Array(1..) passed to Function(1..)",9) From AXUNIT

Call ADD_TESTCASE("TC_MAX_ARRAY","Try to use big arrays",8) From AXUNIT

Local Clbfile  SUITE_RESULT
SUITE_RESULT = func AXUNIT.RUN_TESTSUITE("ARRAY2", "ARRAY2")
End SUITE_RESULT

$ERROR
Call CHECK_EQUAL(errn, EX)
EX = 0
Resume

Subprog CHECK_EVAL(STR, RESULT)
Call CHECK_EQUAL(evalue(STR), RESULT)
End

Subprog CHECK_EQUAL(GOT, EXPECT)
Call CHECK_EQUAL(GOT, EXPECT) From AXUNIT
End

#####################################################################
$DEF_SORTA
Case WCAS
When "0"
 Local Integer I : I=-2
When "0_5","6"
 Local Integer I : I=0
When "1"
 Local Integer I : I=-1
When "1_6"
 Local Integer I : I=1
Endcase
Gosub _DEF_SORTA
Return

$_DEF_SORTA
indice=0
If WCAS="6"
 Local Integer NUM(6)
 Local Char CAR(1)(6)
 Local Char NOM(10)(6)
Elsif I<0
 Local Integer NUM(I+2..)
 Local Char CAR(1)(I+2..)
 Local Char NOM(10)(I+2..)
 I=I+2
Else
 Local Integer NUM(I..I+5)
 Local Char CAR(1)(I..I+5)
 Local Char NOM(10)(I..I+5)
Endif
        NUM(I) =  1 : CAR(I) =  'A' : NOM(I) =  'at386'
I+= 1 : NUM(I) =  2 : CAR(I) =  'H' : NOM(I) =  'hp'
I+= 1 : NUM(I) =  3 : CAR(I) =  'I' : NOM(I) =  'ibm3151'
I+= 1 : NUM(I) =  4 : CAR(I) =  'V' : NOM(I) =  'vt220'
I+= 1 : NUM(I) =  5 : CAR(I) =  'V' : NOM(I) =  'vt200'
I+= 1 : NUM(I) =  6 : CAR(I) =  'A' : NOM(I) =  'ansi'
Return

$VERIF_LIST
Local Integer INIT : If I=0 : INIT=1 : Endif
Call CHECK_EQUAL(NUM(I)=1 & CAR(I)='A' & NOM(I)='at386', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=2 & CAR(I)='H' & NOM(I)='hp', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=3 & CAR(I)='I' & NOM(I)='ibm3151', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=4 & CAR(I)='V' & NOM(I)='vt220', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=5 & CAR(I)='V' & NOM(I)='vt200', 1)
If I+INIT<NB | dim(NUM)>I+INIT
 I+= 1 : Call CHECK_EQUAL(NUM(I)=6 & CAR(I)='A' & NOM(I)='ansi', 1)
Endif
Return

$VERIF_SORTA
Case WCAS
When "0","0_5","6"
 I=0
When "1","1_6"
 I=1
Endcase
Call CHECK_EQUAL(NUM(I)=6 & CAR(I)='A' & NOM(I)='ansi', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=1 & CAR(I)='A' & NOM(I)='at386', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=2 & CAR(I)='H' & NOM(I)='hp', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=3 & CAR(I)='I' & NOM(I)='ibm3151', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=5 & CAR(I)='V' & NOM(I)='vt200', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=4 & CAR(I)='V' & NOM(I)='vt220', 1)
Return

$VERIF_SORTA_ORD
Case WCAS
When "0","0_5","6"
 I=0
When "1","1_6"
 I=1
Endcase
Call CHECK_EQUAL(NUM(I)=1 & CAR(I)='A' & NOM(I)='at386', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=6 & CAR(I)='A' & NOM(I)='ansi', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=2 & CAR(I)='H' & NOM(I)='hp', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=3 & CAR(I)='I' & NOM(I)='ibm3151', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=4 & CAR(I)='V' & NOM(I)='vt220', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=5 & CAR(I)='V' & NOM(I)='vt200', 1)
Return

$VERIF_SORTA_ORDD
Case WCAS
When "0","0_5","6"
 I=0
When "1","1_6"
 I=1
Endcase
Call CHECK_EQUAL(NUM(I)=6 & CAR(I)='A' & NOM(I)='ansi', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=5 & CAR(I)='V' & NOM(I)='vt200', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=4 & CAR(I)='V' & NOM(I)='vt220', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=3 & CAR(I)='I' & NOM(I)='ibm3151', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=2 & CAR(I)='H' & NOM(I)='hp', 1)
I+= 1 : Call CHECK_EQUAL(NUM(I)=1 & CAR(I)='A' & NOM(I)='at386', 1)
Return

$VERIF_SORTA_ORDD1
Case WCAS
When "0","0_5","6"
 I=0
When "1","1_6"
 I=1
Endcase
#Call CHECK_EQUAL(NUM(I)=5 & CAR(I)='V' & NOM(I)='vt200', 1)
#I+= 1 : Call CHECK_EQUAL(NUM(I)=4 & CAR(I)='V' & NOM(I)='vt220', 1)
#I+= 1 : Call CHECK_EQUAL(NUM(I)=3 & CAR(I)='I' & NOM(I)='ibm3151', 1)
#I+= 1 : Call CHECK_EQUAL(NUM(I)=2 & CAR(I)='H' & NOM(I)='hp', 1)
#I+= 1 : Call CHECK_EQUAL(NUM(I)=1 & CAR(I)='A' & NOM(I)='at386', 1)
#I+= 1 : Call CHECK_EQUAL(NUM(I)=6 & CAR(I)='A' & NOM(I)='ansi', 1)
Call CHECK_EQUAL(CAR(I)='V', 1)
I+= 1 : Call CHECK_EQUAL(CAR(I)='V', 1)
I+= 1 : Call CHECK_EQUAL(CAR(I)='I', 1)
I+= 1 : Call CHECK_EQUAL(CAR(I)='H', 1)
I+= 1 : Call CHECK_EQUAL(CAR(I)='A', 1)
I+= 1 : Call CHECK_EQUAL(CAR(I)='A', 1)
Return

#########################
Subprog TC_SORTA6
WCAS="6"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM
Gosub VERIF_SORTA
End

Subprog TC_SORTA0
WCAS="0"
Gosub DEF_SORTA
Sorta I+1 CAR, NOM, NUM
Gosub VERIF_SORTA
End

Subprog TC_SORTA0_5
WCAS="0_5"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM
Gosub VERIF_SORTA
End

Subprog TC_SORTA1
WCAS="1"
Gosub DEF_SORTA
Sorta I CAR, NOM, NUM
Gosub VERIF_SORTA
End

Subprog TC_SORTA1_6
WCAS="1_6"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM
Gosub VERIF_SORTA
End

#########################
Subprog TC_ORD_SORTA0
WCAS="0"
Gosub DEF_SORTA
Sorta I+1 CAR, NOM, NUM Order By CAR(indice),NUM(indice)
Gosub VERIF_SORTA_ORD
End

Subprog TC_ORD_SORTA0_5
WCAS="0_5"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM Order By CAR(indice),NUM(indice)
Gosub VERIF_SORTA_ORD
End

Subprog TC_ORD_SORTA6
WCAS="6"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM Order By CAR(indice),NUM(indice)
Gosub VERIF_SORTA_ORD
End

Subprog TC_ORD_SORTA1
WCAS="1"
Gosub DEF_SORTA
Sorta I CAR, NOM, NUM Order By CAR(indice+1),NUM(indice+1)
Gosub VERIF_SORTA_ORD
End

Subprog TC_ORD_SORTA1_6
WCAS="1_6"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM Order By CAR(indice+1),NUM(indice+1)
Gosub VERIF_SORTA_ORD
End

#########################
Subprog TC_ORDD_SORTA0
WCAS="0"
Gosub DEF_SORTA
Sorta I+1 CAR, NOM, NUM Order By -NUM(indice)
Gosub VERIF_SORTA_ORDD
End

Subprog TC_ORDD_SORTA0_5
WCAS="0_5"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM Order By -NUM(indice)
Gosub VERIF_SORTA_ORDD
End

Subprog TC_ORDD_SORTA6
WCAS="6"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM Order By -NUM(indice)
Gosub VERIF_SORTA_ORDD
End

Subprog TC_ORDD_SORTA1
WCAS="1"
Gosub DEF_SORTA
Sorta I CAR, NOM, NUM Order By -NUM(indice+1)
Gosub VERIF_SORTA_ORDD
End

Subprog TC_ORDD_SORTA1_6
WCAS="1_6"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM Order By -NUM(indice+1)
Gosub VERIF_SORTA_ORDD
End

#########################
Subprog TC_ORDDESC_SORTA0
WCAS="0"
Gosub DEF_SORTA
Sorta I+1 CAR, NOM, NUM Order By NUM(indice) Desc
Gosub VERIF_SORTA_ORDD
End

Subprog TC_ORDDESC_SORTA0_5
WCAS="0_5"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM Order By NUM(indice) Desc
Gosub VERIF_SORTA_ORDD
End

Subprog TC_ORDDESC_SORTA6
WCAS="6"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM Order By NUM(indice) Desc
Gosub VERIF_SORTA_ORDD
End

Subprog TC_ORDDESC_SORTA1
WCAS="1"
Gosub DEF_SORTA
Sorta I CAR, NOM, NUM Order By NUM(indice+1) Desc
Gosub VERIF_SORTA_ORDD
End

Subprog TC_ORDDESC_SORTA1_6
WCAS="1_6"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM Order By NUM(indice+1) Desc
Gosub VERIF_SORTA_ORDD
End

#########################
Subprog TC_ORDDESC1_SORTA0
WCAS="0"
Gosub DEF_SORTA
Sorta I+1 CAR, NOM, NUM Order By CAR(indice) Desc
Gosub VERIF_SORTA_ORDD1
End

Subprog TC_ORDDESC1_SORTA0_5
WCAS="0_5"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM Order By CAR(indice) Desc
Gosub VERIF_SORTA_ORDD1
End

Subprog TC_ORDDESC1_SORTA6
WCAS="6"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM Order By CAR(indice) Desc
Gosub VERIF_SORTA_ORDD1
End

Subprog TC_ORDDESC1_SORTA1
WCAS="1"
Gosub DEF_SORTA
Sorta I CAR, NOM, NUM Order By CAR(indice+1) Desc
Gosub VERIF_SORTA_ORDD1
End

Subprog TC_ORDDESC1_SORTA1_6
WCAS="1_6"
Gosub DEF_SORTA
Sorta CAR, NOM, NUM Order By CAR(indice+1) Desc
Gosub VERIF_SORTA_ORDD1
End

#####################################################

############################################
Subprog FCTX(NB,CAR,NOM,NUM)
Value    Integer NB : # Number of elements
Value    Char    CAR() : # text array
Value    Char    NOM() : # text array
Value    Integer NUM() : # number array
Local Integer X : X=0
Call CHECK_EQUAL(NUM=X+1,1)
Call CHECK_EQUAL(NUM, X+1)
Call CHECK_EQUAL(NUM(X), X+1)
I=0
Gosub VERIF_LIST
End

#########################
Subprog TC_FCTX0
WCAS="0"
Gosub DEF_SORTA
Call FCTX(5,CAR,NOM,NUM)
End

Subprog TC_FCTX0_5
WCAS="0_5"
Gosub DEF_SORTA
Call FCTX(6,CAR,NOM,NUM)
End

Subprog TC_FCTX6
WCAS="6"
Gosub DEF_SORTA
Call FCTX(6,CAR,NOM,NUM)
End

Subprog TC_FCTX1
WCAS="1"
Gosub DEF_SORTA
Call FCTX(6,CAR,NOM,NUM)
End

Subprog TC_FCTX1_6
WCAS="1_6"
Gosub DEF_SORTA
Call FCTX(6,CAR,NOM,NUM)
End

############################################
Subprog FCT0_(NB,CAR,NOM,NUM)
Value    Integer NB : # Number of elements
Value    Char    CAR()(0..) : # text array
Value    Char    NOM()(0..) : # text array
Value    Integer NUM(0..) : # number array
Local Integer X : X=0
Call CHECK_EQUAL(NUM=X+1,1)
Call CHECK_EQUAL(NUM, X+1)
Call CHECK_EQUAL(NUM(X), X+1)
I=0
Gosub VERIF_LIST
End

#########################
Subprog TC_FCT0_0
WCAS="0"
Gosub DEF_SORTA
Call FCT0_(5,CAR,NOM,NUM)
End

Subprog TC_FCT0_0_5
WCAS="0_5"
Gosub DEF_SORTA
Call FCT0_(6,CAR,NOM,NUM)
End

Subprog TC_FCT0_6
WCAS="6"
Gosub DEF_SORTA
Call FCT0_(6,CAR,NOM,NUM)
End

Subprog TC_FCT0_1
WCAS="1"
Gosub DEF_SORTA
Call FCT0_(6,CAR,NOM,NUM)
End

Subprog TC_FCT0_1_6
WCAS="1_6"
Gosub DEF_SORTA
Call FCT0_(6,CAR,NOM,NUM)
End


############################################
Subprog FCT1_(NB,CAR,NOM,NUM)
Value    Integer NB : # Number of elements
Value    Char    CAR()(1..) : # text array
Value    Char    NOM()(1..) : # text array
Value    Integer NUM(1..) : # number array
Local Integer X : X=1
Call CHECK_EQUAL(NUM=X,1)
Call CHECK_EQUAL(NUM, X)
Call CHECK_EQUAL(NUM(X), X)
I=1
Gosub VERIF_LIST
End

#########################
Subprog TC_FCT1_0
WCAS="0"
Gosub DEF_SORTA
Call FCT1_(5,CAR,NOM,NUM)
End

Subprog TC_FCT1_0_5
WCAS="0_5"
Gosub DEF_SORTA
Call FCT1_(6,CAR,NOM,NUM)
End

Subprog TC_FCT1_6
WCAS="6"
Gosub DEF_SORTA
Call FCT1_(6,CAR,NOM,NUM)
End

Subprog TC_FCT1_1
WCAS="1"
Gosub DEF_SORTA
Call FCT1_(6,CAR,NOM,NUM)
End

Subprog TC_FCT1_1_6
WCAS="1_6"
Gosub DEF_SORTA
Call FCT1_(6,CAR,NOM,NUM)
End

#####################################################################
Subprog TC_MAX_ARRAY
Local Date WDAT
End
