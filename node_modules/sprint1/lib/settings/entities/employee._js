"use strict";
/*
 $pattern :  "^([a-zA-Z0-9_.\-+])+@(([a-zA-Z0-9\-])+\.)+[a-zA-Z0-9]{2,4}$"
 */
exports.entity = {
	$properties: {
		firstName: {
			$title: "First Name",
			$type: "string",

			$maxLength: 30
		},
		lastName: {
			$title: "Last Name",
			$type: "string",

			$maxLength: 30,
			$isMandatory: true,
			$linksToDetails: true
		},
		title: {
			$title: "Title",
			$type: "integer",
			$enum: [{
				$value: 1,
				$title: "Monsieur"
			}, {
				$value: 2,
				$title: "Mademoiselle"
			}, {
				$value: 3,
				$title: "Madame"
			}],
			$default: 1,
			$links: {
				google: {
					$url: "http://www.google.fr",
					$method: "GET"
				}
			}
		},
		maritalStatus: {
			$title: "Marital Status",
			$type: "integer",
			$enum: [{
				$value: 1,
				$title: "Célibataire"
			}, {
				$value: 2,
				$title: "Marié"
			}, {
				$value: 3,
				$title: "Divorcé"
			}, {
				$value: 4,
				$title: "Séparé"
			}, {
				$value: 5,
				$title: "Veuf"
			}, {
				$value: 6,
				$title: "Vie maritale"
			}, {
				$value: 7,
				$title: "PACS"
			}, {
				$value: 8,
				$title: "Non connu"
			}, {
				$value: 9,
				$title: "Non applicable"
			}],
			$default: 1
		},
		birthDate: {
			$title: "Birth Date",
			$type: "date",
			$isMandatory: false
		},
		testTime: {
			$title: "Test Time",
			$type: "time",
			$isMandatory: false,

			$isNullable: true
		},
		foreignerWorker: {
			$title: "Foreigner worker",
			$type: "boolean",
			$default: false
		},
		email: {
			$title: "Email",
			$type: "string",
			$format: "$email"
		},
		phoneNumber: {
			$title: "Phone Number",
			$type: "string",
			$format: "$phone"
		},
		photo: {
			$title: "Photo",
			$type: "image",
			$storage: "db_file",
			$capabilities: ""
		},
		addressStreet: {
			$title: "Street",
			$type: "string"
		},
		addressZipCode: {
			$title: "Zip code",
			$type: "string"
		},
		addressCity: {
			$title: "City",
			$type: "string"
		},
		comment: {
			$title: "Comment",
			$type: "text/rtf",
			$capabilities: "raw",
			$maxLength: 500
		},
		testInteger: {
			$title: "Test Integer",
			$type: "integer",

			$isNullable: true
		},
		testDecimal: {
			$title: "Test Decimal",
			$type: "decimal",

			$isNullable: true
		}
	},
	$relations: {
		country: {
			$title: "Country",
			$isMandatory: false
		},
		company: {
			$title: "Company",
			before: "title",
			$isMandatory: true
		},
		children: {
			$title: "Children",
			inv: "parent",
			isChild: true
		}
	},
	$titleTemplate: "{firstName} {lastName}",
	$valueTemplate: "{firstName} {lastName}",
	$historyTitleTemplate: "List of employees",
	$rules: {
		oncreate: {
			$event: "created",
			$action: function(_, context, employee) {
				employee.foreignerWorker = false;
				//context.setVisible(employee, "country", false);
				context.setMandatory(employee, "country", false);
			}
		},
		onLastName: {
			$event: "changed",
			$triggers: ["lastName"],
			$action: function(_, context, employee) {
				//context.setVisible(employee, "firstName", false);
				context.setMandatory(employee, "firstName", true);
			}
		},
		onForeignerWorker: {
			$event: "changed",
			$triggers: ["foreignerWorker"],
			$action: function(_, context, employee) {
				//context.setVisible(employee, "country", employee.foreignerWorker);
				context.setMandatory(employee, "country", employee.foreignerWorker);
			}
		}
	},
	$links: {
		google: {
			$url: "http://www.google.fr",
			$method: "GET"
		}
	}
};