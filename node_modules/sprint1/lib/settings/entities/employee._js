"use strict";
/*
 $pattern :  "^([a-zA-Z0-9_.\-+])+@(([a-zA-Z0-9\-])+\.)+[a-zA-Z0-9]{2,4}$"
 */
exports.entity = {
	$properties: {
		firstName: {
			$title: "First Name",
			$type: "string",
			$constraints: {
				$maxLength: 30
			}
		},
		lastName: {
			$title: "Last Name",
			$type: "string",
			$constraints: {
				$maxLength: 30
			},
			$isMandatory: true,
			$linksToDetails: true
		},
		title: {
			$title: "Title",
			$type: "integer",
			$enum: [1, 2, 3],
			$enumCaptions: ["Monsieur", "Mademoiselle", "Madame"],
			$default: 1,
			$links: {
		google: {
			$url: "http://www.google.fr",
			$method: "GET"
		}
	}
		},
		maritalStatus: {
			$title: "Marital Status",
			$type: "integer",
			$enum: [0, 1, 2, 3, 4, 5, 6, 7, 8],
			$enumCaptions: ["Célibataire", "Marié", "Divorcé", "Séparé", "Veuf", "Vie maritale", "PACS", "Non connu", "Non applicable"],
			$default: 0
		},
		birthDate: {
			$title: "Birth Date",
			$type: "date",
			$isMandatory: false
		},
		testTime: {
			$title : "Test Time",
			$type : "time",
			$isMandatory: false,
			$constraints: {
				$isNullable: true
			}
		},
		foreignerWorker: {
			$title: "Foreigner worker",
			$type: "boolean",
			$default: false
		},
		email: {
			$title: "Email",
			$type: "string",
			$format: "$email"
		},
		phoneNumber: {
			$title: "Phone Number",
			$type: "string",
			$format: "$phone"
		},
		photo: {
			$title: "Photo",
			$type: "image",
			$storage: "db_file",
			$capabilities: ""
		},
		addressStreet: {
			$title: "Street",
			$type: "string"
		},
		addressZipCode: {
			$title: "Zip code",
			$type: "string"
		},
		addressCity: {
			$title: "City",
			$type: "string"
		},
		comment: {
			$title: "Comment",
			$type: "text/rtf",
			$capabilities: ""
		},
		testInteger: {
			$title: "Test Integer",
			$type: "integer",
			$constraints: {
				$isNullable: true
			}
		},
		testDecimal: {
			$title: "Test Decimal",
			$type: "decimal",
			$constraints: {
				$isNullable: true
			}
		}
	},
	$relations: {
		country: {
			$title: "Country",
			$isMandatory: false
		},
		company: {
			$title: "Company",
			before: "title",
			$isMandatory: true
		},
		children: {
			$title: "Children",
			inv: "parent",
			isChild: true
		}
	},
	$titleTemplate: "{firstName} {lastName}",
	$valueTemplate: "{firstName} {lastName}",
	$historyTitleTemplate: "List of employees",
	$rules: {
		oncreate: {
			$event: "created",
			$action: function(_, context, employee) {
				employee.foreignerWorker = false;
				//context.setVisible(employee, "country", false);
				context.setMandatory(employee, "country", false);
			}
		},
		onLastName: {
			$event: "changed",
			$triggers: ["lastName"],
			$action: function(_, context, employee) {
				//context.setVisible(employee, "firstName", false);
				context.setMandatory(employee, "firstName", true);
			}
		},
		onForeignerWorker: {
			$event: "changed",
			$triggers: ["foreignerWorker"],
			$action: function(_, context, employee) {
				//context.setVisible(employee, "country", employee.foreignerWorker);
				context.setMandatory(employee, "country", employee.foreignerWorker);
			}
		}
	},
	$links: {
		google: {
			$url: "http://www.google.fr",
			$method: "GET"
		}
	}
};