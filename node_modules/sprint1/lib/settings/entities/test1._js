"use strict";

var helpers = require('syracuse-core/lib/helpers');

exports.entity = {
	$properties: {
		code: {
			
				$minLength: 2,
				$maxLength: 2
			,
			$linksToDetails: true
		},
		description: {},
		even: {
			$type: "integer",
			$control: function(_, instance, val) {
				if (val % 2 != 0) return instance.$addError("not even: " + val);
			},
			$propagate: function(_, instance, val) {
				instance.half(_, val / 2);
			}
		},
		half: {
			$type: "integer"
		},
		factorial: {
			$type: "integer",
			$compute: function(_, instance) {
				function fact(n) {
					return n > 0 ? n * fact(n - 1) : 1;
				}
				return fact(instance.even(_));
			}
		}
	},
	$valueTemplate: "{code}",
	$titleTemplate: "{description}"
}