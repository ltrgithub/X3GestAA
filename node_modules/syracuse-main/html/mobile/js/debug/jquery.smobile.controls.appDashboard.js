"use strict"; 
(function($) {
	var _testItms =[
		    {
		      "data": {
		        "title": "Actions",
		        "description": "Actions",
		        "icon": "dash.actions"
		      }
		    },{
		      "data": {
		        "title": "Expenses",
		        "description": "Expenses",
		        "icon": "dash.expenses"
		      }
		    }, {
		      "data": {
		        "title": "Customers",
		        "description": "Customers",
		        "icon": "dash.customers"
		      }
		    }
		  ]
	
	var _consts = {
			"menu_dash_size": "s-m-menu-dash-size",
			"default_menu_name": "dash.default",
			"default_menu_class": "dash",
			
	}
	var that = $.smobile;
	that.controls = that.controls || {};
	that.controls.AppDashboard={
		sync: true,
		handler: function(c, after) {
			var controller = this, html = [], items = c.data.items || [];
			html.push('<center>');
			html.push('<div id="' + c.id + '" class="s-m-dash-table">');
			//items = _testItms.concat(items || [])
			items.forEach(function(v,i) {
				// Rows				
				if (i!=0 && i % 2 == 0){
					html.push('<div class="s-m-dash-');
					html.push(i % 4 == 0 ? 4 : 2);
					html.push('cols"></div>');
				}
				// Cell				
				html.push('<div class="s-m-dash-cell">');
				var itmHtml=[];
				itmHtml.push('<center>');
				// Image	
				var icon  =  v.data.icon || _consts.default_menu_name, css = icon.split(".");
				if (css.length == 1) css.splice(0, 0, _consts.default_menu_class);
				itmHtml.push('<div class="' + _consts.menu_dash_size + ' ' +  css.join(" ") + '"></div>');
				// Title
				itmHtml.push('<div class="s-m-dash-ttl">');
				itmHtml.push(v.data.title);
				itmHtml.push('</div>');
				itmHtml.push('</center>');
				v.data.url = that.ui.sdata_link(null, v.data);
				that._addLink(html, v.data, controller, function() {
					html.push(itmHtml.join(''));
				});	
				html.push('</div>');
			});
			html.push('</div></center>');	
			after({ 
				html: html.join(''),
				bind: true
			});
		}
	};
})(jQuery);    
