(function($) {
	var that = $.smobile || {};
	$.smobile = that;
	that.controls.ErrorView = {
		handler: function(c, after) {
			var controller = this, html = [], options= c.data || {};
			var layout = { icon: true};
			var data = $.helpers.lastErrors();
			if (data) {
				html.push('<ul id="'+c.id + '" data-role="listview"');
				html.push(' data-inset="true"');
				
				html.push('>');
				data.forEach(function(cd){
					html.push('<li');
					var css = [];
					if (layout.icon) css.push("ui-li-has-icon");
					if (layout.icon_size) css.push(layout.icon_size);
					if (css.length) html.push(' class="' + css.join(" ")+'"');
					html.push('>');
					html.push($.helpers.FUNCS.TITLE_LW(cd.title)+ $.helpers.FUNCS.ERROR(cd.data.message) + $.helpers.FUNCS.INFO(cd.data.solution));
					html.push('</li>');
				});
				html.push('</ul>');
			}
			controller.hasErrorView = true;
			after({ 
				html: html.join('')
			});
		}
	}
})(jQuery);    


