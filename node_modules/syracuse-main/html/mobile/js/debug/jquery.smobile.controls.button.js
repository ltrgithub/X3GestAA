
(function($) {
	'use strict';
	var that = $.smobile;
	that.controls = that.controls || {};
	that.controls.Button={
		handler: function(c, after) {
			var controller = this;
			var  html = [], options= c.data || {};
			var jmdata = {};
			options.controlId = c.id;
			if (options.jmdata) $.extend(jmdata, options.jmdata);
			$.extend(jmdata, {"data-role": "button"});
			options.jmdata = jmdata;
			that._addLink(html, options, controller);
			return after({html: html.join(''), action: options.action, options: options});
			
		},
		events: function($c, c) {
			var controller = this;
			$c.click(function(e) {
				if (c && c.action) 	{
					if (c.options.disabled) return;
					c.options.disabled = true;
					var hnd = controller.pageActions?controller.pageActions[c.action]:null;
					if (hnd) return hnd.call(controller, function(doCont){
						if (doCont) c.options.disabled = false;
						
					});					
				}
				e.preventDefault();
			});
		}
	};
})(jQuery);    
