(function(f){function m(a,c){if(null!=a.numberGroupSeparator)b.number.thousandSep=a.numberGroupSeparator;if(null!=a.numberDecimalSeparator)b.number.decimalSep=a.numberDecimalSeparator;b.lang2DateSettings(a.shortDate,a.shortTime);f.scroller&&f.scroller.setDefaults(b.dateSettings);k=!0;return c()}function i(a,c){var j=b.extractLang(a);if(!j)return j=b.extractLang(b.browserLanguage()),g.downloadLocale(j,function(a){a&&(b.setLanguage(a+"-"+a.toUpperCase()),b.lang2DateSettings(),f.scroller&&f.scroller.setDefaults(b.dateSettings));
return c()});var d=b.currentLocale();if(j!=d)return g.downloadLocale(j,function(d){d&&(b.setLanguage(a),b.lang2DateSettings(),f.scroller&&f.scroller.setDefaults(b.dateSettings));return c()});b.setLanguage(a);return c()}var b=f.helpers,g=f.sdata,l=f.smobile||{};l.staticui=l.staticui||{};var n=l.staticui,k=!1,h=g.capabilities;h.installUrl="/sdata/syracuse/collaboration/syracuse/dashboardDefs/$service/mobilePortlets";h.authUrl="/sdata/syracuse/collaboration/syracuse/userProfiles/$service/current";h.loadLocale=
!0;h.localeLoader=function(a,c){if(k&&!c)return a();if(!k&&b.online()&&(!h.authRequired||!h.auth))return g.GET(g.sdataHost+e.authurl,function(c){if(c){var d=c.selectedLocale;return m(d,function(){return i(d.code,a)})}i(b.language(),a)});i(b.language(),a)};n.settings=function(){var a=b.locale();return{$title:a.administration.title,content:{cp:{layout:"BlockBodyLayout",data:{}},e0:{uiClass:"Edit",data:{label:a.ui.sdatahost,bind:"host"},parent:"cp"},e1:{uiClass:"Edit",data:{label:a.ui.user,bind:"user"},
parent:"cp"},pass:{uiClass:"Edit",data:{type:"password",label:a.ui.password,bind:"password"},parent:"cp"},ok:{uiClass:"Button",data:{value:a.ui.save_item,action:"savesettings",jmdata:{"data-icon":"check","data-iconpos":"left"}},parent:"cp"},errors:{uiClass:"ErrorView",parent:"cp"}},actions:{savesettings:function(a){var e=this.data,d=b.settings(),d=b.settings();d.sdata=d.sdata||{};d.sdata.sdataHost=e.host;g.sdataHost=l.sdataHost;d.connect=d.connect||{};d.connect.user=e.user;d.connect.password=e.password;
b.settings("",d);f.smobile.goHome(this);a(!1)}}}};n.settings_data=function(){var a={},c=b.settings();c.sdata=c.sdata||{};a.host=c.sdata.sdataHost||"";c.connect=c.connect||{};a.user=c.connect.user||"";a.password=c.connect.password||"";return a};var e={lastCheck:null,checkInterval:0,authurl:h.authUrl,detect:function(a){var b="unknown";(a=a||"")&&(a=a.toUpperCase());0===a.indexOf("BASIC")?b="basic":0===a.indexOf("DIGEST")&&(b="digest");return b},connect:function(a){var c=b.settings();c.connect=c.connect||
{};b.clearErrors();if(h.resetInterval)e.lastCheck=null,h.resetInterval=!1;e.lastCheck&&new Date-e.lastCheck<e.checkInterval||g.GET(g.sdataHost+e.authurl,function(f,d){if(d&&401===d.status){if("basic"===e.detect(d["WWW-Authenticate"])){c.connect=c.connect||{};var h={Authorization:"Basic "+window.btoa((c.connect.user||"")+":"+(c.connect.password||""))};b.clearErrors();return g.GET(g.sdataHost+e.authurl,function(c){e.lastCheck=b.hasErrors()?null:new Date;if(c&&!k){var d=c.selectedLocale;m(d,function(){return i(d.code,
function(){return a(c,b.hasErrors())})})}i(b.language(),function(){return a(c,b.hasErrors())})},h,{Authenticate:!0})}e.lastCheck=null;return a(null,!0)}e.lastCheck=b.hasErrors()?null:new Date;return a(null,b.hasErrors())},{},{Authenticate:!0})}};g.capabilities.auth=function(a){return e.connect(a)}})(jQuery);
