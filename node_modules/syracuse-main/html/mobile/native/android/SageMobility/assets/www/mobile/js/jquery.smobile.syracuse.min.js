(function(j){function l(a,b){if(null!=a.numberGroupSeparator)c.number.thousandSep=a.numberGroupSeparator;if(null!=a.numberDecimalSeparator)c.number.decimalSep=a.numberDecimalSeparator;return b()}function i(a,b){var e=c.extractLang(a);if(!e)return e=c.extractLang(c.browserLanguage()),g.downloadLocale(e,function(a){a&&c.setLanguage(a+"-"+a.toUpperCase());return b()});var d=c.currentLocale();if(e!=d)return g.downloadLocale(e,function(d){d&&c.setLanguage(a);return b()});c.setLanguage(a);return b()}var c=
j.helpers,g=j.sdata,k=j.smobile||{};k.staticui=k.staticui||{};var m=k.staticui,h=g.capabilities;h.installUrl="/sdata/syracuse/collaboration/syracuse/dashboardDefs/$service/mobilePortlets";h.authUrl="/sdata/syracuse/collaboration/syracuse/userProfiles/$service/current";h.loadLocale=!0;h.localeLoader=function(a){if(c.online()&&(!h.authRequired||!h.auth))return g.GET(g.sdataHost+f.authurl,function(b){if(b){var e=b.selectedLocale;return l(e,function(){return i(e.code,a)})}i(c.language(),a)});i(c.language(),
a)};m.settings=function(){var a=c.locale();return{$title:a.administration.title,content:{cp:{layout:"BlockBodyLayout",data:{}},e0:{uiClass:"Edit",data:{label:a.ui.sdatahost,bind:"host"},parent:"cp"},e1:{uiClass:"Edit",data:{label:a.ui.user,bind:"user"},parent:"cp"},pass:{uiClass:"Edit",data:{type:"password",label:a.ui.password,bind:"password"},parent:"cp"},ok:{uiClass:"Button",data:{value:a.ui.save_item,action:"savesettings",jmdata:{"data-icon":"check","data-iconpos":"left"}},parent:"cp"},errors:{uiClass:"ErrorView",
parent:"cp"}},actions:{savesettings:function(a){var e=this.data,d=c.settings(),d=c.settings();d.sdata=d.sdata||{};d.sdata.sdataHost=e.host;g.sdataHost=k.sdataHost;d.connect=d.connect||{};d.connect.user=e.user;d.connect.password=e.password;c.settings("",d);j.smobile.goHome(this);a(!1)}}}};m.settings_data=function(){var a={},b=c.settings();b.sdata=b.sdata||{};a.host=b.sdata.sdataHost||"";b.connect=b.connect||{};a.user=b.connect.user||"";a.password=b.connect.password||"";return a};var f={lastCheck:null,
checkInterval:0,authurl:h.authUrl,detect:function(a){var b="unknown";(a=a||"")&&(a=a.toUpperCase());0===a.indexOf("BASIC")?b="basic":0===a.indexOf("DIGEST")&&(b="digest");return b},connect:function(a){var b=c.settings();b.connect=b.connect||{};c.clearErrors();if(h.resetInterval)f.lastCheck=null,h.resetInterval=!1;f.lastCheck&&new Date-f.lastCheck<f.checkInterval||g.GET(g.sdataHost+f.authurl,function(e,d){if(d&&401===d.status){if("basic"===f.detect(d["WWW-Authenticate"])){b.connect=b.connect||{};var h=
{Authorization:"Basic "+window.btoa((b.connect.user||"")+":"+(b.connect.password||""))};c.clearErrors();return g.GET(g.sdataHost+f.authurl,function(b){f.lastCheck=c.hasErrors()?null:new Date;if(b){var d=b.selectedLocale;l(d,function(){return i(d.code,function(){return a(b,c.hasErrors())})})}i(c.language(),function(){return a(b,c.hasErrors())})},h,{Authenticate:!0})}f.lastCheck=null;return a(null,!0)}f.lastCheck=c.hasErrors()?null:new Date;return a(null,c.hasErrors())},{},{Authenticate:!0})}};g.capabilities.auth=
function(a){return f.connect(a)}})(jQuery);
