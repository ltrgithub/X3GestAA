"use strict";
var _site = require('syracuse-ui/lib/site/site');
var _reactField = require('syracuse-ui/lib/field/reactField');
exports.main = function() {
	try {
		var site = _site.create();
		var root = document.createElement("div");
		root.id = "s_app_slot";
		site.layoutSlot = site.siteApp = document.body.appendChild(root);
		site.load();
		site.addReactField = function(slot, $prototype, $dataset, $bind) {
			_reactField.add(slot, $prototype, $dataset, $bind);
		}
		loadReactSite();
		loadPendo();
	} catch (error) {
		console.log(error);
	}
};

function loadReactSite() {
	var wf = document.createElement('script');
	wf.src = "/syracuse-react/dist/js/" + (document.location.href.indexOf("/main_debug.html") >= 0 ? "app_debug.js" : "app.js");
	wf.type = 'text/javascript';
	wf.async = 'true';
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(wf, s);
}

function loadPendo() {
	(function(p, e, n, d, o) {
		var v, w, x, y, z;
		o = p[d] = p[d] || {};
		o._q = [];
		v = ['initialize', 'identify', 'updateOptions', 'pageLoad'];
		for (w = 0, x = v.length; w < x; ++w)(function(m) {
			o[m] = o[m] || function() {
				o._q[m === v[0] ? 'unshift' : 'push']([m].concat([].slice.call(arguments, 0)));
			};
		})(v[w]);
		y = e.createElement(n);
		y.async = !0;
		y.src = 'https://cdn.pendo.io/agent/static/xxxx-xxxx-xxxxx/pendo.js';
		z = e.getElementsByTagName(n)[0];
		z.parentNode.insertBefore(y, z);
	})(window, document, 'script', 'pendo');
}

if (require.main == module)
	exports.main();