"use strict";
const assert = require('chai').assert;
Object.keys(assert).forEach(key => { if (key !== 'isNaN') global[key] = assert[key]; });

describe(module.id, () => {

var ez = require('ez-streams');
var transform = require("html-escape/lib/transforms");

function t(_, from, to) {
	var r = ez.devices.string.reader(from) //
	.transform(ez.transforms.cut(2)) //
	.transform(transform.escaper({
		preserve: true,
	})).toArray(_).join('');
	equals(r, to);
	r = ez.devices.string.reader(to) //
	.transform(ez.transforms.cut(2)) //
	.transform(transform.unescaper()).toArray(_).join('');
	equals(r, from);
}
// no need to test sophisticated stuff, just that streaming works
it('escaper', function(_) {
	t(_, 'abc<div foo><w>x<y>z</div>def', 'abc<div disabled-foo><!--<w>-->x<!--<y>-->z</div>def');
});
});