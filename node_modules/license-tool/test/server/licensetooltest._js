"use strict";
var helper = require("license-tool/lib/helper");
// Test for passphrase encryption

QUnit.module(module.id);

asyncTest("encryption", 3, function(_) {
	var passphrase = "abcdef";
	var salt = "A1B2C3D4E5";
	var password = "secret"
	var encrypted = helper.encryptPassphrase(passphrase, salt, password);
	console.log(encrypted)
	var decrypted = helper.decryptPassphrase(encrypted, salt, password);
	strictEqual(passphrase, decrypted, "Test short")
	var passphrase = "123456789012345678901234567890123456789012345678901234567890";
	var encrypted = helper.encryptPassphrase(passphrase, salt, password);
	console.log(encrypted)
	var decrypted = helper.decryptPassphrase(encrypted, salt, password);
	strictEqual(passphrase, decrypted, "Test long")
	var passphrase = "";
	var encrypted = helper.encryptPassphrase(passphrase, salt, password);
	console.log(encrypted)
	var decrypted = helper.decryptPassphrase(encrypted, salt, password);
	strictEqual(passphrase, decrypted, "Test very short")

	start();
});

