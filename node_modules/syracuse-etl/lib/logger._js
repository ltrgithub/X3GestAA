"use strict";
// TEMPORARY MODULE FOR TESTING
var ez = require('ez-streams');
var flows = require('streamline/lib/util/flows');

function callback(err) {
	// if logger fails best we can do is write to console
	if (err) console.error(err.stack);
}

var writeFunnel = flows.funnel(1);

var logger = {
	writer: ez.devices.console.log,
	write: function(_, obj) {
		writeFunnel(_, function(_) {
			logger.writer.write(_, obj);
		});
	},
	info: function(message) {
		logger.write(_ >> callback, {
			severity: "info",
			message: message,
		});
	},
	error: function(message) {
		logger.write(_ >> callback, {
			severity: "error",
			message: message,
		});
	},
};

module.exports = logger;