"use strict";

var helpers = require('@sage/syracuse-core').helpers;
var globals = require('streamline-runtime').globals;
var config = require('config'); // must be first syracuse require
var testAdmin = require('@sage/syracuse-core').apis.get('test-admin');
var sys = require('util');

var adminHelper = require("syracuse-collaboration/lib/helpers").AdminHelper;
var adminTestFixtures = require("syracuse-collaboration/test/fixtures/adminTestFixtures");

QUnit.module(module.id);

var db;
//------------------------
// Init environnement test
//------------------------
asyncTest("Init environnement", 1, function(_) {
	db = testAdmin.initializeTestEnvironnement(_);
	require('syracuse-license').register(_);
	ok(db != null, "Environnement initialized");
	start();
});


//------------------------
// Init history log setting
//------------------------
asyncTest("Init history log setting", 2, function(_) {
	var setting = db.fetchInstance(_, db.model.getEntity(_, "setting"), {});
	ok(setting, "No general setting");
	setting.loadHistorySettingFromFile(_);
	ok(setting.historyLogSettings(_).getLength() != 0, "Import history setting");
	start();
});