"use strict";

var helpers = require('syracuse-core/lib/helpers');
var config = require('syracuse-main/lib/nodeconfig').config; // must be first syracuse require
var adminHelper = require("syracuse-collaboration/lib/helpers").AdminHelper;
var dataModel = require("syracuse-orm/lib/dataModel");
var registry = require("syracuse-sdata/lib/sdataRegistry");
var mongodb = require('streamline-mongodb');
var jsonImport = require("syracuse-import/lib/jsonImport");
var adminTestFixtures = require("syracuse-collaboration/test/fixtures/adminTestFixtures");

//force basic auth
config.session = config.session || {};
config.session.auth = "basic";
//no integration server
config.integrationServer = null;

helpers.pageFileStorage = false;

var tracer; // = console.log;

var endPoint = adminTestFixtures.modifyCollaborationEndpoint("syracuse");

var baseUrl = "http://localhost:3004";
var port = 3004;

var done;
QUnit.module(module.id, {
	setup: function() {}
});




//start syracuse server
asyncTest("initialize syracuse test server", 1, function(_) {
	require('syracuse-main/lib/syracuse').startServers(_, port);
	ok(true, "server initialized");
	start();
});

asyncTest("Test breadcrumb generation ", function(_) {
	var date = new Date();
	var id = "syracuse.collaboration.user.$details";
	var facet = "$details";
	var breadCrumb = adminHelper.getBreadcrumb(_, date, id, facet);

	console.log("test");

	console.log(JSON.stringify(breadCrumb));

	strictEqual(breadCrumb, [{}, {}, {}], "bread crumb for user ok (syracuse collaboration)");

	start();
});




asyncTest("stop  tests", 0, function(_) {
	done = true;
	start();
});