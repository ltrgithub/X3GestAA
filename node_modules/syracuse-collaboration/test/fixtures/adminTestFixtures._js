"use strict";

var nodeconfig = require('syracuse-main/lib/nodeconfig'); // must be first syracuse require
var config = nodeconfig.config; // must be first syracuse require

exports.modifyCollaborationEndpoint = function(datasetName) {
//	nodeconfig.initEndpointsConfiguration();
	var endPoint = null;
	config.sdata.endpoints.forEach(function(endp) {
		if ((endp.contract.application == "syracuse") && (endp.contract.contract == "collaboration")) {
			endPoint = endp;
		}
	});
	if (!endPoint) {
		//add model
		endPoint = {
			contract: require("syracuse-collaboration/lib/contract").contract,
		};
		config.sdata.endpoints.push(endPoint);
	}
	endPoint.datasets[datasetName] = {
		driver: "mongodb",
		hostname: "localhost",
		database: datasetName,
		port: 27017
	}
	config.collaboration.dataset = datasetName;
	//
	return endPoint;
}