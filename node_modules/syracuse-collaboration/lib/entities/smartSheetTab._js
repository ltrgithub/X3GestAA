"use strict";

var util = require("util");
var smartSheet = require('./smartSheet');
var datetime = require('syracuse-core/lib/types/datetime');
var https = require("https");
//var mock = require ("syracuse-load/lib/mock");



exports.entity = {
	$properties: {
		title: {
			$title: "Sheet title",
		},
		key: {
			$title: "Key",
		},
		date: {
			$title: "Last update",
			$type: "datetime",
			$isReadOnly: true,
			$default: datetime.parse("1900-01-01T00:00")
		},
	},
	$titleTemplate: "SmartSheet",
	$valueTemplate: "{name} {sheetName}",
	$descriptionTemplate: "SmartSheet",
	$functions: {},
	$services: {
		syncOneSheet1: {
			$method: "POST",
			$isMethod: true,
			$title: "Fetch sheet",
			$execute: function(_, context, instance) {
				try {
					instance._parent.getData(_, instance);
					// console.log("Called Fetch data function22442.");
				} catch (e) {
					console.error("xxxx " + e.stack);
				}
			}
		},
	},
};