"use strict";

exports.entity = {
	$titleTemplate: "Vignettes",
	$valueTemplate: "{vignette.title - endpoint.description}",
	$properties: {
		useCurrentEndpoint: {
			$title: "Use current endpoint",
			$type: "boolean",
			$isNullable: true
		}
	},
	$relations: {
		vignette: {
			$title: "Vignette",
			$type: "portlet",
			$isMandatory: true
		},
		endpoint: {
			$title: "Endpoint",
			$type: "endPoint",
			$isMandatory: function(_, instance) {
				return !instance.useCurrentEndpoint(_);
			},
			$isDefined: function(_, instance) {
				return !instance.useCurrentEndpoint(_);
			}
		}
	},
	$links: function(_, instance) {
		var res = {};
		var item = instance.vignette(_) && instance.vignette(_).pageItem(_);
		var ep = null;
		if (!instance.useCurrentEndpoint(_)) ep = instance.endpoint(_);
		var locLink = res["$location"] = item && item.getLink(_, ep, "{$selectedEPBaseUrl}");
		if (locLink) locLink.$isHidden = true;
		return res;
	}
};