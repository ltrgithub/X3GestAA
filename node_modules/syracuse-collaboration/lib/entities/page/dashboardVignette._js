"use strict";

exports.entity = {
	$properties: {
		allEndpoints: {
			$title: "Applies to current endpoint",
			$type: "boolean",
			$constraints: {
				$isNullable: true
			},
			$propagate: function(_, instance, val) {
				if(val) instance.endpoint(_, null);
			},
			$default: true
		}
	},
	$relations: {
		portlet: {
			$title: "Vignette",
			$type: "portlet",
			$isMandatory: true,
			$lookupFilter: {
				application: "{$parent}.{application}"
			}
		},
		endpoint: {
			$title: "Endpoint",
			$type: "endPoint",
			$isMandatory: function(_, instance) {
				return !instance.allEndpoints(_);
			},
			$isDefined: function(_, instance) {
				return !instance.allEndpoints(_);
			},
			$lookupFilter: {
				applicationRef: "{$parent}.{application}"
			}
		}
	}
}
