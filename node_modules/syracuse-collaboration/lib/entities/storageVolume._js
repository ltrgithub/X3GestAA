"use strict"

exports.entity = {
	$titleTemplate: "Storage volume",
	$valueTemplate: "{description}",
	$properties: {
		code: {
			$title: "Code"
		},
		description: {
			$title: "Description",
			$isMandatory: true,
			$isLocalized: true,
			$constraints: {
				$isUnique: true
			}
		},
		storageType: {
			$title: "Storage",
			$enum: ["db_file", "rest", "file"],
			$enumCaptions: ["Syracuse Standard", "Web Server", "File"],
			$default: "db_file",
			$control: function(_, instance, val) {
				// check if there is a document
//				if(instance.content(_) && instance.content(_).fileExists(_))
//					throw new Error(locale.format(module, "storageTypeChange"));
			},
			$propagate: function(_, instance, val) {
				// reset property store to allow creating the appropriate type
//				instance._propertyStores["content"] = null;
			},
			$isDisabled: function(_, instance) {
//				return (instance.content(_) && instance.content(_).fileExists(_));
				return false;
			}
		},
		path: {
			$title: "Path",
			$isDefined: function(_, instance) {
				return (instance.storageType(_) === "file");
			}
		},
		dynamic: {
			$title: "Dynamic",
			$type: "boolean",
			$description: "Automatic content update",
			$isDefined: function(_, instance) {
				return (instance.storageType(_) === "file");
			}
		}
	},
	$links: {
		$browse: {
			$title: "List of files",
			$url: "{$baseUrl}/storageVolumeItems?representation=storageVolumeItem.$query&volume={$uuid}",
			$target: "blank"
		}
	}
}