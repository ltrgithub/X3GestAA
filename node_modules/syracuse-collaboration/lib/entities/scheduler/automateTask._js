"use strict"

var _taskFactory = {
	searchIndex: function(_, endpoint, params) {
		console.log("reindexing endpoint: " + endpoint.dataset(_));
	}
}

exports.entity = {
	$titleTemplate: "Task",
	$valueTemplate: "{description}",
	$properties: {
		description: {
			$title: "Description",
			$isMandatory: true
		},
		suspended: {
			$title: "Suspended",
			$type: "boolean",
			$default: false
		},
		taskClassName: {
			$title: "Task",
			// TODO: define more taks and hook a lookup
			$default: "searchIndex"
		},
		taskTitle: {
			$title: "Task title",
			// TODO: same as taskClassName
			$default: "Search Index update"
		}
	},
	$relations: {
		endpoint: {
			$title: "Endpoint",
			$type: "endPoint",
			$isMandatory: true
		}
	},
	$functions: {
		run: function(_) {
			_taskFactory[this.taskClassName(_)] && _taskFactory[this.taskClassName(_)](_, this.endpoint(_));
		}
	}
}