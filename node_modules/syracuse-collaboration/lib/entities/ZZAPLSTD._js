"use strict"
var sys = require("util");

exports.entity = {
	$properties: {
		lanchp: {
			$title: "Chapter",
			$type: "integer",
			$isMandatory: true
		},
		lan: {
			$title: "Language",
			$isMandatory: true
		},
		lanmes: {
			$title: "Message",
			$isMandatory: true
		},
		lannum: {
			$title: "Number",
			$type: "integer",
			
			//$isMandatory: true,
			
		},
		/*update: {
			$title: "update",
			$type: "integer",
			$isHidden: true,
			defaultvalue: 0
		}*/
		
	},
	$events: {
			$beforeSave: [function(_, instance) { 
				//if (instance.update(_))
				//	return ;
				var entity = instance.getEntity("ZZAPLSTD");
				var db=instance._db;
				var nb=entity.count(_,db,null) ;
				var num=Math.floor(nb / 2 ) ;
				instance.lannum(_,num);

			}],
		},
	$defaultOrder: [["lanchp", true]]
}