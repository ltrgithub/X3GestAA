"use strict";
var helpers = require('@sage/syracuse-core').helpers;
var DocumentField = require('syracuse-ui/lib/field/documentField').DocumentField;

function ExportXlsField() {}

exports.ExportXlsField = helpers.defineClass(ExportXlsField, DocumentField, {
	setDataTableExtractToOffice: function(mimeType, error) {
		if (error) throw new Error(error);
		this._setDocumentFile({
			$contentType: mimeType
		});
	},
	setDataTableExtractToExcel: function(url, error) {
		this.setDataTableExtractToOffice("application/excel", error);
	},
	setDataTableExtractToCsv: function(url, error) {
		this.setDataTableExtractToOffice("application/csv", error);
	},
	getValue: function() {
		if (this.page.isFusionPage && this.articleParent.$fusionPageMeta) {
			return this.articleParent.$fusionPageMeta.winId + this.$item.$bind;
		}
		return null;
	},
	_renderEditMode: function() {
		DocumentField.prototype._renderDetailMode.call(this);
	}
});