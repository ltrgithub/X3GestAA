"use strict";
var path = require('path');
const webpackMerge = require('webpack-merge');
var webpack = require('webpack');
const commonConfig = require('./base');
var ExtractTextPlugin = require("extract-text-webpack-plugin");

module.exports = function(env) {
	return webpackMerge(commonConfig, {
		/*
		Combination of path and filename tells webpack where and what 
		to name bundled output file
		*/
		output: {
			filename: "js/app.js"
		},

		plugins: [
			new webpack.LoaderOptionsPlugin({
				minimize: true,
				debug: false
			}),
			new webpack.DefinePlugin({
				'process.env': {
					'NODE_ENV': JSON.stringify('production')
				}
			}),
			new webpack.optimize.UglifyJsPlugin({
				beautify: false,
				mangle: {
					screw_ie8: true,
					keep_fnames: true
				},
				compress: {
					screw_ie8: true
				},
				// Default is: /^\**!|@preserve|@license/
				comments: / Buildtime: /
			}),
			new ExtractTextPlugin('./styles/app.css')
		]
	});
};