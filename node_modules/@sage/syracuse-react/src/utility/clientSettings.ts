var hashJS = require('hash.js')

export function traverseClientSettings(obj: any, valueObj: any) {
	if (!valueObj) return;
	for (let i in obj) {
		if (!!obj[i] && typeof (obj[i]) == "object") {
			traverseClientSettings(obj[i], valueObj);
		} else {
			let value = obj[i];
			value = value && value.replace(/\{([^}]*)\}/g, (match: any, placeHolder: string) => {
				let propertyValue = valueObj;
				let hash = false;
				if (placeHolder.charAt(0) === "#") {
					placeHolder = placeHolder.substring(1);
					hash = true;
				}
				placeHolder.split("\.").forEach((prop: string) => {
					propertyValue = propertyValue && propertyValue[prop];
				})
				if (hash) {
					propertyValue = hashJS.sha1().update(propertyValue).digest('hex');
				}
				return propertyValue;
			});
			obj[i] = value;
		}
	}
}
