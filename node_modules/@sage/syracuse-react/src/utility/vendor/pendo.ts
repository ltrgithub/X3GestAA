export function loadPendo(settings: any) {
    (function (p: any, e: any, n: any, d: any) {
        let v: any, w: any, x: any, y: any, z: any, o: any;
        o = p[d] = p[d] || {};
        o._q = [];
        v = ['initialize', 'identify', 'updateOptions', 'pageLoad'];
        for (w = 0, x = v.length; w < x; ++w)(function (m) {
            o[m] = o[m] || function () {
                o._q[m === v[0] ? 'unshift' : 'push']([m].concat([].slice.call(arguments, 0)));
            };
        })(v[w]);
        y = <HTMLScriptElement>e.createElement(n);
        y.async = !0;
        y.src = 'https://cdn.pendo.io/agent/static/' + settings.apiKey + '/pendo.js';
        z = e.getElementsByTagName(n)[0];
        z.parentNode.insertBefore(y, z);
    })(window, document, 'script', 'pendo');

    let retries = 10;
    let pendoLoader = setInterval(() => {
        retries--;
        if (pendo) {
            clearInterval(pendoLoader);
            pendo.initialize(settings);
        } else if (retries <= 0) {
            // Timeout
            clearInterval(pendoLoader);
        }
    }, 1000);
}
