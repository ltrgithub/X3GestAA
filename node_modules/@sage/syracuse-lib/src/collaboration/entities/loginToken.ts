"use strict";

import * as os from 'os';
import { globals } from 'streamline-runtime';
import { sessionManager } from '../../../src/session/sessionManager';
import * as util from 'util';
import * as config from 'config';
const locale = require('streamline-locale');

export const entity = {
	$canDelete: false,
	$canCreate: false,
	$canEdit: false,
	$titleTemplate: "Login token",
	$descriptionTemplate: "Keep connected login tokens",
	$valueTemplate: "{login}",
	$helpPage: "Administration-reference-Login-Tokens",
	$properties: {
		login: {
			$title: "User name"
		},
		token: {
			$title: "Token"
		}
	},
	$relations: {},
	$functions: {
		formatCookieValue(_) {
			var self = this;
			return [self.login(_), self.$uuid, self.token(_)].join("/");
		}
	},
	$expire(_, instance) {
		// 4 weeks by default see nodeconfig
		return config.security.signIn.rememberMe.lifetime * 24 * 3600 * 1000;
	}

};