"use strict";
var x3pool = require("syracuse-x3/lib/pool");
var locales = require("syracuse-collaboration/lib/entities/lookupLocale");
var adminHelper = require("syracuse-collaboration/lib/helpers").AdminHelper;
var locale = require("syracuse-core/lib/locale");
var transMod = require.cache[require.resolve("syracuse-translation/lib/translation")];
var localize = locale.format.bind(undefined, transMod || module);

function World(context) {
	this.context = context;
}

World.prototype = {
	submit: function(_, ep, params) {
		params = params || {};
		var session = this.context.request.session;
		params.raw = true;
		return x3pool.jsonSend(_, session, ep, params);
	},
	getLocales: function(_) {
		return locales.readLocales(_); //adminDb.model.getEntity(_, "lookupLocale").$fetchInstances(_, context),
	},
	fetchInstances: function(_, ep, entityName, facet, opt) {
		var orm = ep.getOrm(_);
		var entity = orm.getEntity(_, entityName, facet);
		return orm.fetchInstances(_, entity, opt);
	},

	localizedText: function() {
		localize.apply(null, arguments);
	},

	getCollaborationOrm: function(_) {
		return adminHelper.getCollaborationOrm(_);
	}

};

module.exports = World;