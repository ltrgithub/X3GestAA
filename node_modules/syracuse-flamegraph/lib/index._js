"use strict";
var datetime = require('syracuse-core/lib/types/datetime');

exports.autoStart = function(_) {
	var adminHelpers = require('syracuse-collaboration/lib/helpers');
	var db = adminHelpers.AdminHelper.getCollaborationOrm(_);
	var settings = require('syracuse-flamegraph/lib/entities/setting').getInstance(_, db);
	if (!settings.autoStart(_)) return;
	var entity = db.getEntity(_, "flamegraphRecording");
	var recording = entity.createInstance(_, db);
	recording.stamp(_, datetime.now());
	recording.name(_, "Flamegraph " + recording.stamp(_));
	recording.status(_, "created");
	recording.save(_);
	recording.startRecording(_);
};