"use strict";
var datetime = require('syracuse-core/lib/types/datetime');
var config = require('config');

exports.autoStart = function(_) {
	if (!(config.streamline && config.streamline.flamegraph && config.streamline.flamegraph.autoStart)) return;

	var adminHelpers = require('syracuse-collaboration/lib/helpers');
	var db = adminHelpers.AdminHelper.getCollaborationOrm(_);
	var entity = db.getEntity(_, "flamegraphRecording");
	var recording = entity.createInstance(_, db);
	recording.stamp(_, datetime.now());
	recording.name(_, "Flamegraph " + recording.stamp(_));
	recording.status(_, "created");
	recording.save(_);
	recording.startRecording(_);
};