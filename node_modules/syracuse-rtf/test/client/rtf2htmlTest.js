"use strict";
var module = QUnit.module;
var convert = require("syracuse-rtf");

module("RTF to HTML converter");

function escape(html) {

    return html;//.replace(/\&/g, '&amp;').replace(/\</g, '&lt;').replace(/\>/g, '&gt;');
}

function testConvert(result,rtf, name) {
   strictEqual(escape(convert(rtf)), escape(result), name);
}

test('basic', 21, function() {
    var prefix ="{\\rtf1\\ansi"
    var suffix="}" ;

    


 testConvert("<b>bold</b>", prefix+"{\\b bold}"+suffix, "simple tag ");

    testConvert("<font face=\"Arial\">fontarial</font>", prefix+"{\\fonttbl{\\f0 Arial;}}{\\f0 fontarial}"+suffix, "font face ");
    testConvert("<font face=\"Arial\">fontarial</font>"  //
        +"<font face=\"Bitstream Charter\">fontbitstreamcharter</font>", // 
        prefix+"{\\fonttbl{\\f0 Arial;}{\\f1 Bitstream Charter;}}"  //
        + "{\\f0 fontarial}{\\f1 fontbitstreamcharter}"+ //
        suffix, "font face x2");
    testConvert("<span style=\"font-size:7.5pt\">fontsize7.5pt</span>", //
        prefix+"{\\fs15 fontsize7.5pt}"+suffix, "font-size ");
    testConvert("<font color=\"#ff0000\">red</font>", //
        prefix+"{\\colortbl;\\red255\\green0\\blue0;}{\\cf1 red}"+suffix, "font color ");
    testConvert("<font bgcolor=\"#ff0000\">redbackground</font>", //
     prefix+"{\\colortbl;\\red255\\green0\\blue0;}{\\highlight1 redbackground}"+suffix, //
     "background color ");

    testConvert("<p>some nested styles: <b><span style=\"font-size:7.5pt\">bold</span></b>, "+// 
"<i><span style=\"font-size:7.5pt\">italic</span></i></p><p></p>", //
        prefix+"\\par some nested styles: {\\b\\fs15 bold}, {\\i\\fs15 italic}\\par"+suffix, "nested character formatting ");

 testConvert("<p>some combined styles: <b>bold+ <i>italic+<u>underlined</u></i></b> vs. normal</p>", //
    prefix+"\\par some combined styles: {\\b bold+ \\i italic+\\ul underlined} vs. normal"+suffix,  // 
    "character formatting, combined styles");

testConvert("<p>some combined and nested styles: <b>bold, <i>bold+italic</i></b><b>, <u>bold+underlined</u></b></p>", //
    prefix+"\\par some combined and nested styles: {\\b bold, {\\i bold+italic}, \\ul bold+underlined}"+suffix,  // 
    "character formatting, combined and nested styles");


   /* testConvert("<div align='center'>centered text</div>", //
        prefix+"\\pard \\qc centered text\\par "+suffix, "alignement  ");
    testConvert("<ul><li>item1</li><li>item2</li></ul>", //
        prefix+"\\pard {\\pntext }{\\*\\pn \\pnlvlblt {\\pntxtb \\'b7 }}item1\\par {\\pntext }item2\\par \\pard "+suffix, "unordered bulleted list  ");
    testConvert("<ul><li><font face='Arial'><span style='font-size:12pt'>item1</span></font></li><li>item2</li></ul>", //
        prefix+"{\\fonttbl{\\f0 Arial;}}\\pard {\\pntext }{\\*\\pn \\pnlvlblt {\\pntxtb \\'b7 }}{\\f0 {\\fs24 item1}}\\par {\\pntext }item2\\par \\pard "+suffix, "unordered bulleted list with text formatting ");
    */

   testConvert("<div class=\"parformat\" align=\"center\"><p>centered text</p><p>another centered paragraph</p></div>", //
        prefix+"\\par \\qc centered text\\par another centered paragraph"+suffix, "2 paragraphs, same formatting");
    testConvert("<div class=\"parformat\" align=\"center\"><p>centered text</p></div><p>second paragraph</p>", //
        prefix+"\\par \\qc centered text\\par \\pard second paragraph"+suffix, "2 paragraphs, different formatting");
    
    testConvert("<div class=\"parformat\" align=\"center\"><p><b>centered bold text</b></p></div><p><b>second paragraph</b></p>", //
        prefix+"\\par \\qc \\b centered bold text\\par \\pard second paragraph"+suffix, "2 paragraphs, different formatting");



   testConvert("<div style=\"left-margin:40px\" class=\"parformat\" align=\"center\"><p>centered text + left margin</p></div>", //
        prefix+"\\par \\qc \\li600 centered text + left margin"+suffix, " paragraph with 2 formattings");
    testConvert("<div class=\"parformat\" align=\"center\"><p>centered text</p><p>second paragraph</p></div>", //
        prefix+"{\\par \\qc centered text\\par second paragraph}"+suffix, "2 formatted paragraphs in rtf group ");

    testConvert("<span style=\"font-size:7.5pt\"></span><div class=\"parformat\" align=\"center\"><p><span style=\"font-size: 7.5pt;\">centered sized text</span></p></div>", //
        prefix+" \\fs15 \\par \\qc centered sized text"+suffix, " Paragraph formatting + Character formatting ");
    testConvert("<div class=\"parformat\" align=\"center\"><p><span style=\"font-size:7.5pt\">centered sized text</span></p></div>", //
        prefix+"\\par \\fs15 \\qc centered sized text"+suffix, " Paragraph formatting + Character formatting II");
 
    testConvert("ﻼ",prefix+"\\u65276"+suffix, "unicode character ");
    testConvert("ﻼ",prefix+"\\u65276?"+suffix, "unicode character and substituting ansi character ");
    testConvert("ﻼ",prefix+"\\u65276?"+suffix, "unicode character and substituting ansi character ");


    testConvert("<li>item1</li><li>item2</li>",prefix+"\\bullet item1\\bullet item2"+suffix, "bullets ");
    testConvert("<li>item1</li><p><li>item2</li></p>",prefix+"\\bullet item1\\par\\bullet item2"+suffix, "bullets with paragraphs ");

 /*
testConvert("<span style=\"font-size:7.5pt\">some <b>bold</b>text</span>", //
        prefix+"\\fs15 some \\b bold\\b0 text"+suffix, "character formatting ,limited by tags with arg 0 b0 ");
*/

});

/*test('maps', 1, function() {
    var rtf = "{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1036{" + //
    "\\fonttbl\n" + //
    "{\\f0\\fnil\\fcharset0\\fprq0\\fttruetype Helvetica;}" + //
    "{\\f1\\fswiss\\fcharset0\\fprq2 Arial;}" + //
    "{\\f2\\fswiss\\fcharset0\\fprq2 Verdana;}" + //
    "{\\f3\\froman\\fcharset2\\fprq2 Symbol;}}" + //
    "{\\colortbl;\\red255\\green0\\blue0;\\red0\\green255\\blue0;\\red0\\green0\\blue255;}\n" + //
    "{{\\f1\\fs24 Ceci est un texte accentu}\n" + //
    "\\par\n\\par\n{\\f1 des {\\fs18 petits} et des {\\fs32 gros}.}" + //
    "\\par Hellou RTF Wörld\\par " + //
    "\\f0 some \\b bold\\b0, \\i italic\\i0, \\ul underlined\\ulnone  " + //
    "and \\strike strikethrough\\strike0 text " + //
    "}}";

    
    var html = "<div class=\"group\"><div class=\"group\"><font face=\"Arial\">" + //
    "<span style=\"font-size:12pt\">Ceci est un texte accentu</span></font></div>" + //
    "<p></p><p><div class=\"group\"><font face=\"Arial\">des "+ //
    "<div class=\"group\"><span style=\"font-size:9pt\">petits</span></div> et des "+ //
    "<div class=\"group\"><span style=\"font-size:16pt\">gros</span></div>.</font></div></p>" + //
    "<p>Hellou RTF Wörld</p>" + //
    "<p><font face=\"Helvetica\">some <b>bold</b>, <i>italic</i>, "+ //
    "<u>underlined</u> and <s>strikethrough</s>text </font></p>" + //
    "</div>" ;
    console.log(convert(rtf));
    //strictEqual(escape(convert(rtf)), escape(html));
});*/