"use strict";
(function($) {
	var that = $.smobile;
	that.controls = that.controls || {};
	that.controls.Button = {
		handler: function(c, after) {
			var controller = this;
			var html = [],
				options = c.data || {};
			var jmdata = {};
			options.controlId = c.id;
			if (options.jmdata) $.extend(jmdata, options.jmdata);
			if (options.link) {} else {
				$.extend(jmdata, {
					"data-role": "button"
				});
			}
			options.jmdata = jmdata;
			that._addLink(html, options, controller);
			return after({
				html: html.join(''),
				action: options.action,
				options: options
			});

		},
		sync: true,
		events: function($c, c) {
			var controller = this;
			$c.click(function(e) {
				if (c && c.action) {
					if (c.options.disabled) return;
					if (controller.disabled) return;
					var hnd = controller.pageActions ? controller.pageActions[c.action] : null;
					if (hnd) {
						controller.disabled = true;
						return hnd.call(controller, function(doCont) {
							if (doCont) controller.disabled = false;

						});
					}
				}
				e.preventDefault();
			});
		}
	};
})(jQuery);