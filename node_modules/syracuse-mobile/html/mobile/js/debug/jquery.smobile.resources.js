"use strict";
(function($) {
	var that = $.helpers || {};
	$.helpers = that;
	that.language = function() {
		var value = that.settings("language");
		if (value && value.lang) return value.lang;
		return "";
	};
	that.setLanguage = function(lang) {
		that.settings("language", {
			lang: lang
		});
	};
	that.settings = function(key, value) {
		key = key || "mobile";
		var ssettings = window.localStorage["settings"];
		try {
			ssettings = JSON.parse(ssettings || "{}");
		} catch (ex) {
			ssettings = {};
		}
		if (value) {
			ssettings[key] = value;
			window.localStorage["settings"] = JSON.stringify(ssettings);
		} else {
			ssettings = ssettings[key] || {};
			if ((key === "mobile") && !ssettings.preferences) {
				ssettings.preferences = {
					linkDescTheme: "A"
				};
			}
			return ssettings;
		}
	};
	that.extractLang = function(value) {
		if (value) {
			var values = value.split("-");
			return values[0];
		}
		return value;
	};
	that.browserLanguage = function() {
		return (window.navigator.language || window.navigator.browserLanguage || "en");
	};
	that.translate = function(lang, value) {
		that.locale();
		if (value) {
			Object.keys(value).forEach(function(prop) {
				var cv = value[prop];
				var dst = that._locale[prop];
				if (typeof cv === "object") {
					if (dst && cv) {
						Object.keys(cv).forEach(function(item) {
							dst[item] = cv[item];
						});
					}
				} else that._locale[prop] = cv;
			});
			that._locale_lang = lang;
			var $scroller = $.scroller;
			if ($scroller) {
				$scroller.setDefaults(that.dateSettings);
			}
		}
	};
	that.currentLocale = function() {
		that.locale();
		return that._locale_lang;

	};
	that.buildDate = function() {
		var cd =
		// do not delete #BUILDDATE_XXXX  is used in translate.js
		//#BUILDDATE_START
		Date.parseISO8601("2013-12-03T08:58:13.331Z");
		//#BUILDDATE_END
		return cd;
	};
	that.locale = function() {
		if (that._locale) return that._locale;
		that._locale_lang = "en";
		that._locale =
		// do not delete next line  is used in translate.js
		//#START
		{
			"administration": {
				"title": "Sage <span class=\"s-m-title-color\">ERP X3</span>",
				"welcome": "Welcome"

			},
			"maintoolbar": {
				"home": "Home",
				"back": "Back",
				"setup": "Setup",
				"help": "About",
				"settings": "Settings",
				"previous": "Prev",
				"next": "Next",
				"apps": "Applications",
				"logout": "Logout"

			},
			"applicationmanager": {
				"installed_apps": "Installed applications",
				"available_apps": "Available applications",
				"title": "Application Manager",
				"description": "Add Remove Applications",
				"install": "Add",
				"uninstall": "Remove"
			},
			"about": "<h3>About Us</h3> About Us Employee PictureSage provides business software, services and support to small and medium sized businesses. Whilst our heritage is in the small business market we also have the experience and expertise to meet the needs of specific industries and larger organisations.<br/><br/><br/>The Sage Group plc 2013. All Rights Reserved.",
			"errorpagetitle": "Errors",
			"sendpagetitle": "My drafts",
			"errorjs": "Javascript error\nPlease contact the administrator",
			"errorauth": "Authentication error\nPlease relogin or contact the administrator to check your configuration",
			"errorauth_title": "Authentication error!",
			"errmailsubject": "Sage X3 Mobile client error",
			"logoutmsg": "You have been disconnected from application",
			"dlog1": "Save it as a draft ?",
			"dlog2": "Keep data localy to retreive them later",
			"cancel": "Cancel",
			"no": "No",
			"yes": "Yes",
			"draftmode": "Draft",
			"unmodified": "Record unmodified",
			"confirmact": "Please confirm action {0}",
			"nomessage": "No message returned by server",
			"ui": {
				"loading": "Loading ...",
				"installing": "Installing ...",
				"incorrect_format": "Incorrect format",
				"offline": "Off-line mode",
				"input_required": "Value is required",
				"invalid_number": "Invalid number \"{0}\"",
				"range_overflow_number": "Value should be >= {0} and <= {1}",
				"number_precision_error": "Maximum number of decimals is {0}",
				"tobig_number": "Value greater than {0} is expected",
				"sending": "Sending ...",
				"unknownError": "Unknown error",
				"root_menu_tip": "Applications List",
				"edit_item": "Edit",
				"cancel_sort": "Cancel sort",
				"save_item": "Save",
				"validate_item": "Validate",
				"validate_reset": "Reset",
				"ok_item": "Ok",
				"actions_item": "Plus...",
				"cancel_item": "Cancel",
				"delete_draft": "Delete draft",
				"edit_draft": "Edit draft",
				"remove_item": "Remove",
				"sync_item": "My Drafts",
				"install_item": "Reinstall ...",
				"misc": "Miscellaneous",
				"delete_all_drafts": "Delete all drafts",
				"sync_resync_data": "Download",
				"send_all_drafts": "Send all drafts",
				"sync_sync_data": "Reinstall current application",
				"no_db_support": "Your browser don't support HTML5 database.",
				"no_db_support_sol": "Use a modern browser",
				"open_db_error": "Can't open/create local database",
				"password_mismatch": "\"{0}\" password does not match.",
				"minlength_field": "Please enter at least {0} characters.",
				"picture_file": "Photo",
				"add_item": "Add ...",
				"search": "Search",
				"sort": "Sort",
				"filter": "Filter",
				"user": "User Name",
				"password": "Password",
				"saved_logon": "Fixed login",
				"saved_logon_txt": "This login will be used each time you log on",
				"auth_type": "Authentication Type",
				"app_exception": "Application Exception",
				"app_fatal": "Fatal error",
				"app_warning": "Warning",
				"app_success": "Success",
				"dev_mode": "Development mode",
				"db_exception": "Database Exception",
				"exception_offline": "The site could be temporarily unavailable or too busy",
				"exception_timeout": "Connection timeout",
				"check_net": "Check your internet connexion",
				"filter_field": "Field",
				"filter_op": "Operator",
				"filter_val": "Value",
				"array_detail": "More",
				"array_nodetail": "Less",
				"msg_detail": "Detail",
				"links": "Links",
				"Actions": "Actions",
				"mail": "E-mail",
				"multilines": "Select line(s)",
				"multiswitch": "Toggle multilines selection",
				"multinbsel": "{0} selected",
				"multinacts": "Actions",
				"multiselprocess": "Processing lines {0}/{1}",
				"filtersort": "Advanced",
				"nextDiagnose": "Next",
				"notitle": "No title",
				"selendpoint": "Select at least one endpoint",
				"sort_order": "Sort order",
				"nodrafts": "No drafts to send/edit",
				"rmvdrafts": "Edit or remove your drafts before install.",
				"buildDate": "Build date: ",
				"fpwReplFieldNotFound": "Field {0} not found for salting",
				"fpwIllegal": "Password contains illegal character: {0}",
				"messages": "Message(s)",
				"no_fav_online": "No favorites picked in online mode",
				"selall": "Select all",
				"unselall": "Unselect all"
			},
			"datetime": {
				"day": "Day",
				"month": "Month",
				"year": "Year",
				"hour": "Hour",
				"minutes": "Minutes",
				"sec": "Seconds",
				"amDesignator": "AM",
				"pmDesignator": "PM",
				"dateElementOrder": "mdy",
				"dayNames": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
				"abbreviatedDayNames": ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
				"monthNames": ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
				"abbreviatedMonthNames": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]
			},
			"actions": {
				"syncronize": "Synchronize your application data."
			},
			"sdata": {
				"S404": "\"[{0}\" - Resource not found.",
				"unexpected_status": "Unexpected http status {0}",
				"post_ni": "Asynchronous POST - not implemented.",
				"modify_before": "Modify the request before resubmitting",
				"S412": "Update canceled",
				"SD412": "Delete canceled",
				"S410": "Record deleted",
				"SU500": "Update canceled",
				"S503": "Retry after ...",
				"SC_canceled": "create canceled",
				"SD_canceled": "delete canceled"

			},
			"filters": {
				"none": "All",
				"gt": "Greater than",
				"ge": "Greater than or equal",
				"lt": "Less than",
				"le": "Less than or equal",
				"eq": "Equal",
				"ne": "Not equal",
				"like_s": "Starts with",
				"like": "Contains",
				"between": "Between"
			}

		}
		//#END	// do not delete this line  is used in translate.js
		;
		return that._locale;

	};
})(jQuery);