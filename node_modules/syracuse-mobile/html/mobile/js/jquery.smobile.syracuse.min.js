(function(e){function o(a,b){if(null!=a.numberGroupSeparator)c.number.thousandSep=a.numberGroupSeparator;if(null!=a.numberDecimalSeparator)c.number.decimalSep=a.numberDecimalSeparator;c.lang2DateSettings(a.shortDate,a.shortTime,a.longTime);e.scroller&&e.scroller.setDefaults(c.dateSettings);k=!0;return b()}function l(a,b){var d=c.extractLang(a);if(!d)return d=c.extractLang(c.browserLanguage()),g.downloadLocale(d,function(d){d&&(c.setLanguage(d+"-"+d.toUpperCase()),c.lang2DateSettings(),e.scroller&&
e.scroller.setDefaults(c.dateSettings));j.userProfile.setLocale(a,b)});var f=c.currentLocale();if(d!==f)return g.downloadLocale(d,function(d){d&&(c.setLanguage(a),c.lang2DateSettings(),e.scroller&&e.scroller.setDefaults(c.dateSettings));j.userProfile.setLocale(a,b)});c.setLanguage(a);return b()}var c=e.helpers,g=e.sdata,j=e.smobile||{};j.staticui=j.staticui||{};var m=j.staticui,k=!1,i=g.capabilities;i.showSettings=!0;i.installUrl="/sdata/syracuse/collaboration/syracuse/dashboardDefs/$service/mobilePortlets";
i.authUrl="/sdata/syracuse/collaboration/syracuse/userProfiles/$service/current";i.loadLocale=!0;i.localeLoader=function(a,b){if(k&&!b)return a();if(!k&&c.online()&&(!i.authRequired||!i.auth))return g.GET(g.sdataHost+h.authurl,function(b){if(b){b.versionInfo&&b.versionInfo.versionMobile&&g.checkVersionInCache(b.versionInfo.versionMobile);var f=b.selectedLocale;return o(f,function(){return l(f.code,a)})}l(c.language(),a)},null,{timeout:0});l(c.language(),a)};m.settings=function(){var a=c.locale();
return{$title:a.administration.title,content:{cp:{layout:"BlockBodyLayout",data:{}},offline:{uiClass:"CheckBox",data:{label:a.ui.offline,bind:"offline",action:"Offline"},parent:"cp"},c1:{uiClass:"CheckBox",data:{label:a.ui.saved_logon,bind:"autoLogon",action:"fixedLogin"},parent:"cp"},c11:{uiClass:"Html",data:{html:'<div class="s-m-fieldinfo">'+c.htmlEncode(a.ui.saved_logon_txt)+"</div>"},parent:"cp"},logonblock:{layout:"Block",data:{$isHidden:!1},parent:"cp"},c2:{uiClass:"Combo",data:{label:a.ui.auth_type,
bind:"authType",value:"basic",items:[{value:"basic",title:"Basic"}]},parent:"logonblock"},e1:{uiClass:"Edit",data:{label:a.ui.user,bind:"user"},parent:"logonblock"},pass:{uiClass:"Edit",data:{type:"password",label:a.ui.password,bind:"password"},parent:"logonblock"}},hbuttons:[{title:a.ui.save_item,action:"savesettings",jmdata:{"data-icon":"s-ok","data-transition":"back"}}],actions:{fixedLogin:function(){var a=e("#"+this.prefix+"logonblock");a&&a.toggleClass("s-m-hidden")},savesettings:function(a){var d=
this.getValue(),f=c.settings();f.sdata=f.sdata||{};f.connect=f.connect||{};f.connect.authType=d.authType;f.connect.autoLogon=d.autoLogon;f.connect.user=d.user;f.connect.password=d.password;f.offline=d.offline;c.settings("",f);c.setOfflineMode(f.offline);e.smobile.removeAllPages([this.pageInfo.pageId]);e.smobile.goHome(this);a(!1)}}}};m.settings_data=function(){var a={},b=c.settings();b.sdata=b.sdata||{};b.connect=b.connect||{};a.autoLogon=b.connect.autoLogon;a.authType=b.connect.authType||"basic";
a.user=b.connect.user||"";a.password=b.connect.password||"";a.offline=b.offline||!1;return a};m.language=function(){var a=c.locale();return{$title:a.administration.title,content:{cp:{layout:"BlockBodyLayout",data:{}},c11:{uiClass:"Html",data:{html:a.change_language_warning},parent:"cp"},locale:{uiClass:"Combo",data:{label:a.ui.locale,bind:"locale",items:[]},parent:"cp"}},hbuttons:[{title:a.ui.save_item,action:"savelanguage",jmdata:{"data-icon":"s-ok","data-transition":"back"}}],actions:{savelanguage:function(){function a(){n&&
n.doRefresh(!0);e.smobile.changePage("#langchanged",{allowSamePageTransition:!0,reverse:!0})}function d(a,c){j.push(e.extend(!0,{},a));e.sdata.removeFromDB(a.id,c)}function f(){e.smobile.doinstall(j,{},function(a,b){0===a&&b?e.mobile.loading("show",{theme:"a",text:c.locale().ui.installing}):a===b&&e.mobile.loading("hide")},a)}function h(){g.getInstalledApps(!0,function(a){function c(b){b++;b===a.length?f():d(a[b],function(){c(b)})}c(-1)})}function i(){var a=n.getValue().locale,b=c.settings();b.locale=
a;c.settings("",b);l(a,function(){h()})}var n=this,j=[],k=n.getValue(),m=c.settings();k.locale===m.locale?(c.pushInfoMessage(c.locale().langnotchanged),e.smobile.changePage("#home",{allowSamePageTransition:!0,reverse:!0})):g.getSyncCount(function(a){a?(c.pushInfoMessage(c.locale().ui.rmvdrafts_lang),n.doRefresh()):i()})}}}};m.language_data=function(){var a={},b=c.settings();a.locale=b.locale||"en-US";return a};var h={lastCheck:null,checkInterval:0,authurl:i.authUrl,detect:function(a){var b="unknown";
(a=a||"")&&(a=a.toUpperCase());0===a.indexOf("BASIC")?b="basic":0===a.indexOf("DIGEST")&&(b="digest");return b},connect:function(a){var b=c.settings();b.connect=b.connect||{};c.clearErrors();if(i.resetInterval)h.lastCheck=null,i.resetInterval=!1;h.lastCheck&&new Date-h.lastCheck<h.checkInterval||g.GET(g.sdataHost+h.authurl,function(d,f){if(f&&401===f.status){if("basic"===h.detect(f["WWW-Authenticate"])){b.connect=b.connect||{};var e={Authorization:"Basic "+window.btoa((b.connect.user||"")+":"+(b.connect.password||
""))};c.clearErrors();return g.GET(g.sdataHost+h.authurl,function(b){h.lastCheck=c.hasErrors()?null:new Date;if(b&&!k){var d=b.selectedLocale;o(d,function(){return l(d.code,function(){return a(b,c.hasErrors())})})}l(c.language(),function(){return a(b,c.hasErrors())})},e,{Authenticate:!0})}h.lastCheck=null;return a(null,!0)}h.lastCheck=c.hasErrors()?null:new Date;return a(null,c.hasErrors())},{},{Authenticate:!0})}};g.capabilities.auth=function(a){return h.connect(a)};g.checkVersionInCache=function(a){var b=
e.helpers.buildDateString(),a=a.buildDateString;window.console.log(b);window.console.log(a)};c.authHeaders=function(a,b){var d=c.settings();d.connect=d.connect||{};return d.connect.autoLogon&&"basic"===d.connect.authType&&(a.Authorization="Basic "+window.btoa((d.connect.user||"")+":"+(d.connect.password||"")),b)?!0:!1}})(jQuery);
