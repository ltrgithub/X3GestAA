(function(f){function m(a,b){if(null!=a.numberGroupSeparator)c.number.thousandSep=a.numberGroupSeparator;if(null!=a.numberDecimalSeparator)c.number.decimalSep=a.numberDecimalSeparator;c.lang2DateSettings(a.shortDate,a.shortTime,a.longTime);f.scroller&&f.scroller.setDefaults(c.dateSettings);l=!0;return b()}function k(a,b){var d=c.extractLang(a);if(!d)return d=c.extractLang(c.browserLanguage()),h.downloadLocale(d,function(a){a&&(c.setLanguage(a+"-"+a.toUpperCase()),c.lang2DateSettings(),f.scroller&&
f.scroller.setDefaults(c.dateSettings));return b()});var e=c.currentLocale();if(d!=e)return h.downloadLocale(d,function(d){d&&(c.setLanguage(a),c.lang2DateSettings(),f.scroller&&f.scroller.setDefaults(c.dateSettings));return b()});c.setLanguage(a);return b()}var c=f.helpers,h=f.sdata,j=f.smobile||{};j.staticui=j.staticui||{};var j=j.staticui,l=!1,i=h.capabilities;i.showSettings=!0;i.installUrl="/sdata/syracuse/collaboration/syracuse/dashboardDefs/$service/mobilePortlets";i.authUrl="/sdata/syracuse/collaboration/syracuse/userProfiles/$service/current";
i.loadLocale=!0;i.localeLoader=function(a,b){if(l&&!b)return a();if(!l&&c.online()&&(!i.authRequired||!i.auth))return h.GET(h.sdataHost+g.authurl,function(b){if(b){var e=b.selectedLocale;return m(e,function(){return k(e.code,a)})}k(c.language(),a)},null,{timeout:0});k(c.language(),a)};j.settings=function(){var a=c.locale();return{$title:a.administration.title,content:{cp:{layout:"BlockBodyLayout",data:{}},errors:{uiClass:"ErrorView",parent:"cp"},c1:{uiClass:"CheckBox",data:{label:a.ui.transparent_logon,
bind:"autoLogon"},parent:"cp"},c2:{uiClass:"Combo",data:{label:a.ui.auth_type,bind:"authType",value:"basic",items:[{value:"basic",title:"Basic"}]},parent:"cp"},e1:{uiClass:"Edit",data:{label:a.ui.user,bind:"user"},parent:"cp"},pass:{uiClass:"Edit",data:{type:"password",label:a.ui.password,bind:"password"},parent:"cp"},avanced:{layout:"CollapsibleLayout",parent:"cp",data:{text:a.ui.avanced_options,collapsed:!0}},d1:{uiClass:"CheckBox",data:{label:a.ui.dev_mode,bind:"devmode"},parent:"avanced"},d2:{uiClass:"Edit",
data:{label:"Device Name",bind:"deviceName"},parent:"avanced"},d3:{uiClass:"CheckBox",data:{label:"Ignore errors on install",bind:"installWithErrors"},parent:"avanced"}},hbuttons:[{title:a.ui.save_item,action:"savesettings",jmdata:{"data-icon":"s-ok","data-transition":"back"}}],actions:{savesettings:function(a){var d=this.getValue(),e=c.settings();e.sdata=e.sdata||{};e.connect=e.connect||{};e.connect.authType=d.authType;e.connect.autoLogon=d.autoLogon;e.connect.devmode=d.devmode;e.connect.user=d.user;
e.connect.password=d.password;e.debug=e.debug||{};e.debug.deviceName=d.deviceName;e.debug.installWithErrors=d.installWithErrors;c.settings("",e);f.smobile.goHome(this);a(!1)}}}};j.settings_data=function(){var a={},b=c.settings();b.sdata=b.sdata||{};b.connect=b.connect||{};a.autoLogon=b.connect.autoLogon;a.authType=b.connect.authType||"basic";a.devmode=b.connect.devmode;a.user=b.connect.user||"";a.password=b.connect.password||"";b.debug=b.debug||{};a.deviceName=b.debug.deviceName||"phone";a.installWithErrors=
b.debug.installWithErrors?!0:!1;return a};var g={lastCheck:null,checkInterval:0,authurl:i.authUrl,detect:function(a){var b="unknown";(a=a||"")&&(a=a.toUpperCase());0===a.indexOf("BASIC")?b="basic":0===a.indexOf("DIGEST")&&(b="digest");return b},connect:function(a){var b=c.settings();b.connect=b.connect||{};c.clearErrors();if(i.resetInterval)g.lastCheck=null,i.resetInterval=!1;g.lastCheck&&new Date-g.lastCheck<g.checkInterval||h.GET(h.sdataHost+g.authurl,function(d,e){if(e&&401===e.status){if("basic"===
g.detect(e["WWW-Authenticate"])){b.connect=b.connect||{};var f={Authorization:"Basic "+window.btoa((b.connect.user||"")+":"+(b.connect.password||""))};c.clearErrors();return h.GET(h.sdataHost+g.authurl,function(b){g.lastCheck=c.hasErrors()?null:new Date;if(b&&!l){var d=b.selectedLocale;m(d,function(){return k(d.code,function(){return a(b,c.hasErrors())})})}k(c.language(),function(){return a(b,c.hasErrors())})},f,{Authenticate:!0})}g.lastCheck=null;return a(null,!0)}g.lastCheck=c.hasErrors()?null:
new Date;return a(null,c.hasErrors())},{},{Authenticate:!0})}};h.capabilities.auth=function(a){return g.connect(a)};c.authHeaders=function(a,b){var d=c.settings();d.connect=d.connect||{};return d.connect.autoLogon&&"basic"===d.connect.authType&&(a.Authorization="Basic "+window.btoa((d.connect.user||"")+":"+(d.connect.password||"")),b)?!0:!1}})(jQuery);
