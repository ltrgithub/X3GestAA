(function(e){function o(a,c){if(null!=a.numberGroupSeparator)b.number.thousandSep=a.numberGroupSeparator;if(null!=a.numberDecimalSeparator)b.number.decimalSep=a.numberDecimalSeparator;b.lang2DateSettings(a.shortDate,a.shortTime,a.longTime);e.scroller&&e.scroller.setDefaults(b.dateSettings);k=!0;return c()}function l(a,c){var d=b.extractLang(a);if(!d)return d=b.extractLang(b.browserLanguage()),g.downloadLocale(d,function(d){d&&(b.setLanguage(d+"-"+d.toUpperCase()),b.lang2DateSettings(),e.scroller&&
e.scroller.setDefaults(b.dateSettings));j.userProfile.setLocale(a,c)});var f=b.currentLocale();if(d!==f)return g.downloadLocale(d,function(d){d&&(b.setLanguage(a),b.lang2DateSettings(),e.scroller&&e.scroller.setDefaults(b.dateSettings));j.userProfile.setLocale(a,c)});b.setLanguage(a);return c()}var b=e.helpers,g=e.sdata,j=e.smobile||{};j.staticui=j.staticui||{};var m=j.staticui,k=!1,i=g.capabilities;i.showSettings=!0;i.installUrl="/sdata/syracuse/collaboration/syracuse/dashboardDefs/$service/mobilePortlets";
i.authUrl="/sdata/syracuse/collaboration/syracuse/userProfiles/$service/current";i.loadLocale=!0;i.localeLoader=function(a,c){if(k&&!c)return a();if(!k&&b.online()&&(!i.authRequired||!i.auth))return g.GET(g.sdataHost+h.authurl,function(c){if(c){c.versionInfo&&c.versionInfo.versionMobile&&g.checkVersionInCache(c.versionInfo.versionMobile);var f=c.selectedLocale;return o(f,function(){return l(f.code,a)})}l(b.language(),a)},null,{timeout:0});l(b.language(),a)};m.settings=function(){var a=b.locale(),
a={$title:a.administration.title,content:{cp:{layout:"BlockBodyLayout",data:{}},offline:{uiClass:"CheckBox",data:{label:a.ui.offline,bind:"offline",action:"Offline"},parent:"cp"},c1:{uiClass:"CheckBox",data:{label:a.ui.saved_logon,bind:"autoLogon",action:"fixedLogin"},parent:"cp"},c11:{uiClass:"Html",data:{html:'<div class="s-m-fieldinfo">'+b.htmlEncode(a.ui.saved_logon_txt)+"</div>"},parent:"cp"},logonblock:{layout:"Block",data:{$isHidden:!1},parent:"cp"},c2:{uiClass:"Combo",data:{label:a.ui.auth_type,
bind:"authType",value:"basic",items:[{value:"basic",title:"Basic"}]},parent:"logonblock"},e1:{uiClass:"Edit",data:{label:a.ui.user,bind:"user"},parent:"logonblock"},pass:{uiClass:"Edit",data:{type:"password",label:a.ui.password,bind:"password"},parent:"logonblock"}},hbuttons:[{title:a.ui.save_item,action:"savesettings",jmdata:{"data-icon":"s-ok","data-transition":"back"}}],actions:{fixedLogin:function(){var a=e("#"+this.prefix+"logonblock");a&&a.toggleClass("s-m-hidden")},savesettings:function(a){var d=
this.getValue(),f=b.settings();f.sdata=f.sdata||{};f.connect=f.connect||{};f.connect.authType=d.authType;f.connect.autoLogon=d.autoLogon;f.connect.user=d.user;f.connect.password=d.password;f.offline=d.offline;b.settings("",f);b.setOfflineMode(f.offline);e.smobile.removeAllPages([this.pageInfo.pageId]);e.smobile.goHome(this);a(!1)}}};e.helpers.isOfflineAvail()||delete a.content.offline;return a};m.settings_data=function(){var a={},c=b.settings();c.sdata=c.sdata||{};c.connect=c.connect||{};a.autoLogon=
c.connect.autoLogon;a.authType=c.connect.authType||"basic";a.user=c.connect.user||"";a.password=c.connect.password||"";a.offline=c.offline||!1;return a};m.language=function(){var a=b.locale();return{$title:a.administration.title,content:{cp:{layout:"BlockBodyLayout",data:{}},c11:{uiClass:"Html",data:{html:a.change_language_warning},parent:"cp"},locale:{uiClass:"Combo",data:{label:a.ui.locale,bind:"locale",items:[]},parent:"cp"}},hbuttons:[{title:a.ui.save_item,action:"savelanguage",jmdata:{"data-icon":"s-ok",
"data-transition":"back"}}],actions:{savelanguage:function(){function a(){n&&n.doRefresh(!0);e.smobile.changePage("#langchanged",{allowSamePageTransition:!0,reverse:!0})}function d(a,b){j.push(e.extend(!0,{},a));e.sdata.removeFromDB(a.id,b)}function f(){e.smobile.doinstall(j,{},function(a,c){0===a&&c?e.mobile.loading("show",{theme:"a",text:b.locale().ui.installing}):a===c&&e.mobile.loading("hide")},a)}function h(){g.getInstalledApps(!0,function(a){function b(c){c++;c===a.length?f():d(a[c],function(){b(c)})}
b(-1)})}function i(){var a=n.getValue().locale,c=b.settings();c.locale=a;b.settings("",c);l(a,function(){h()})}var n=this,j=[],k=n.getValue(),m=b.settings();k.locale===m.locale?(b.pushInfoMessage(b.locale().langnotchanged),e.smobile.changePage("#home",{allowSamePageTransition:!0,reverse:!0})):g.getSyncCount(function(a){a?(b.pushInfoMessage(b.locale().ui.rmvdrafts_lang),n.doRefresh()):i()})}}}};m.language_data=function(){var a={},c=b.settings();a.locale=c.locale||"en-US";return a};var h={lastCheck:null,
checkInterval:0,authurl:i.authUrl,detect:function(a){var b="unknown";(a=a||"")&&(a=a.toUpperCase());0===a.indexOf("BASIC")?b="basic":0===a.indexOf("DIGEST")&&(b="digest");return b},connect:function(a){var c=b.settings();c.connect=c.connect||{};b.clearErrors();if(i.resetInterval)h.lastCheck=null,i.resetInterval=!1;h.lastCheck&&new Date-h.lastCheck<h.checkInterval||g.GET(g.sdataHost+h.authurl,function(d,f){if(f&&401===f.status){if("basic"===h.detect(f["WWW-Authenticate"])){c.connect=c.connect||{};var e=
{Authorization:"Basic "+window.btoa((c.connect.user||"")+":"+(c.connect.password||""))};b.clearErrors();return g.GET(g.sdataHost+h.authurl,function(c){h.lastCheck=b.hasErrors()?null:new Date;if(c&&!k){var d=c.selectedLocale;o(d,function(){return l(d.code,function(){return a(c,b.hasErrors())})})}l(b.language(),function(){return a(c,b.hasErrors())})},e,{Authenticate:!0})}h.lastCheck=null;return a(null,!0)}h.lastCheck=b.hasErrors()?null:new Date;return a(null,b.hasErrors())},{},{Authenticate:!0})}};
g.capabilities.auth=function(a){return h.connect(a)};g.checkVersionInCache=function(){e.helpers.buildDateString()};b.authHeaders=function(a,c){var d=b.settings();d.connect=d.connect||{};return d.connect.autoLogon&&"basic"===d.connect.authType&&(a.Authorization="Basic "+window.btoa((d.connect.user||"")+":"+(d.connect.password||"")),c)?!0:!1}})(jQuery);
