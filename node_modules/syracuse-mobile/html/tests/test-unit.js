"use strict";
(function($) {

	var _tests = {
		x3formats:function(){
			return $.x3formats ? $.x3formats.test() : ["x3formats unit test not found"];
		}			
	}
	
	function _displayResult($elmt, res){
		$elmt.closest("div.container").find(".smobile-highlight").html("<pre><code>" + (res && res.length>0 ? res.join('\n') : "Empty result") + "</code></pre>");	
		$elmt.closest("div.container").find("button[data-action=clear]").show();
	}
	function _clearResult($elmt){
		$elmt.closest("div.container").find(".smobile-highlight").html("");	
		$elmt.closest("div.container").find("button[data-action=clear]").hide();	
	}
	function _bindEvents(){
		$("button[data-action]").click(function(evt){
			var target = $(evt.target);
			try{
				var action = target.attr("data-action");
				_clearResult(target);
				if (action === "clear"){
					// Nothing
				}else if (_tests[action]){
					_displayResult(target, _tests[action].call([target]));
					
				}else {
					throw new Error("No test function found - action=[" + action+ "]");
				}
			}catch(e){				
				_displayResult(target,["Error executing test function - action=[" + action+ "]", e.message,"\n", e.stack])
			}
		});
		// hide all but
		$(document.body).find("button[data-action=clear]").hide();	
	}

    $(document).ready(function() {
		_bindEvents ();
	});

})(jQuery);