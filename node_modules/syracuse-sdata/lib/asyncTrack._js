"use strict";
/* @flow */
/*:: 

import { SDataSeverity, SDataLink } from "./types";

type SDataTracking = {
	phase: string;
	phaseDetail: string;
	progress: number;
}

*/
var globals = require("streamline/lib/globals");

exports.$exported = true;

exports.asyncTrack = function(_: _, phase: string, detail: string, progress: number) {
	if (globals.context.sdataContext && globals.context.sdataContext.tracker) {
		var tt = globals.context.sdataContext.tracker;
		tt.phase = phase;
		tt.phaseDetail = detail;
		tt.progress = progress;
	}
};

exports.addDiagnose = function(_: _, severity: SDataSeverity, message: string) {
	if (globals.context.sdataContext && globals.context.sdataContext.tracker) {
		var tt = globals.context.sdataContext.tracker;
		tt.addDiagnose(severity, message);
	}
};

exports.abortRequested = function(_: _): boolean {
	if (globals.context.sdataContext && globals.context.sdataContext.tracker) {
		return globals.context.sdataContext.tracker.abortRequested;
	} else {
		return false;
	}
};

exports.addLink = function(_: _, name: string, link: SDataLink) {
	if (globals.context.sdataContext && globals.context.sdataContext.tracker) {
		var t = globals.context.sdataContext.tracker;
		t.$links = t.$links || {};
		t.$links[name] = link;
	}
};