"use strict";
var fs = require('fs');
var path = require('path');
var cssParser = require('./cssParser');
var helpers = require('syracuse-core/lib/helpers');

exports.create = function(_, css) {
	var defStyles = loadStyles(_, css || './default.css');
	//console.log(defStyles);
	var curStyles = {};
	var defBorder = {
		width: 0,
		style: 'solid',
		color: 'black'
	};

	function loadStyles(_, p) {
		return cssParser.parse(fs.readFile(path.join(__dirname, p), 'utf8', _));
	}

	function css1(styles, clas, atb) {
		var style = styles[clas];
		return style && style[atb];
	}

	function cssValue(clas, atb, def) {
		return css1(curStyles, clas, atb) || css1(defStyles, clas, atb) //
		|| css1(curStyles, 'default', atb) || css1(defStyles, 'default', atb) || def;
	}

	function boxStyle(clas) {
		return cssParser.fixBoxStyle(defStyles[clas]);
	}

	function getStyle(clas) {
		return defStyles[clas] || {};
	}

	return {
		cssValue: cssValue,
		boxStyle: boxStyle,
		getStyle: getStyle,
	};
}