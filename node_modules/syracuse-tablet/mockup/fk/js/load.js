"use strict";
// same as $( document ).ready( handler )
$(function($){
	var jqm_DocEvts = {
			"pagebeforechange": function(e, data) {
				$.smobile.pagebeforechange(e, data);
			},
			"pagehide": function(fromPage, data) {
				$.smobile.pagehide(fromPage, data);
			},
			"pageshow": function(event, ui) {
				$.smobile.pageshow(event, ui);
			}
		};
	
	function jqm_SetEvts() {
		$(document).bind("pagebeforechange", jqm_DocEvts.pagebeforechange);
		$(document).bind("pagehide", jqm_DocEvts.pagehide);
		$(document).bind("pageshow", jqm_DocEvts.pageshow);
	};

	function jqm_Start() {
		jqm_SetEvts();
		$.mobile.$start = true;
		/*if (!window.location.hash) {
			window.location.hash = "#start";
		}
		$.mobile.initializePage();*/
	}
	
	function initGlobals(cb){
		$.scroller = $.scroller || $.mobiscroll;
		$.isMetroUi = $.Metro != null && typeof $.Metro == "function";
		$.isWinJs = window.WinJS != null && typeof window.WinJS == "object";
		if (cb) cb();
		
	}
	$(document).ready(function(){
		initGlobals(function (){
			$.stemplates.init();
			if ($.isWinJs){
				$.smobile.hackWinJsinit();
			}
		});
		jqm_Start();
		$.smobile.loadListener();
		/*if ($.sdata.capabilities.loadLocale && $.sdata.capabilities.localeLoader) {
			$.helpers.clearErrors();
			$.sdata.capabilities.localeLoader(function() {
				jqm_Start();
			}, true);
		} else {
			jqm_Start();
		}*/
	});

});
