"use strict";

var driver = require("./driver");
var UT = require("../ut");

/**
 * Set input field to desired text
 * Field is selected by it's DOM id attribute
 * Timeout is usually zero since we assume the page is loaded and checked before invoking this
 */
exports.setInputById = function(id, text, timeout) {
	return _findElementById(id, timeout).sendKeys(text);
};

/**
 * Set input field to desired text
 * Field is selected by it's x3 property name
 * Timeout is usually zero since we assume the page is loaded and checked before invoking this
 */
exports.setInputByX3Name = function(x3name, text, timeout) {
	return _findElementByX3Name(x3name, timeout).sendKeys(text);
};

/**
 * Click an element identified by it's DOM id attribute
 */
exports.clickById = function(id, timeout) {
	return _findElementById(id, timeout).click();
};

/**
 * Click an element identified by it's DOM id attribute
 */
exports.clickByAction = function(action, params, parent, timeout) {
	timeout = timeout != null ? timeout : 1;
	var xAction = '[@data-action="' + action + '"]';
	var xParams = params ? '[@data-params="' + params + '"]' : "";
	return driver.Browser().wait(
		driver.Until.elementLocated(
			driver.By.xpath('//*' + xAction + xParams)
		), timeout
	).click();
};

/*
 *
 */
function _findElementById(id, timeout) {
	timeout = timeout != null ? timeout : 1;
	return driver.Browser().wait(
		driver.Until.elementLocated(
			driver.By.id(id)
		), timeout
	);
}

/*
 *
 */
function _findElementByX3Name(x3name, timeout) {
	timeout = timeout != null ? timeout : 1;
	return driver.Browser().wait(
		driver.Until.elementLocated(
			driver.By.xpath('//*[@data-s-ut-field-x3name="' + x3name + '"]')
		), timeout
	);
}