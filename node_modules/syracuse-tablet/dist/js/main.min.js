/*!
  * Bowser - a browser detector
  * https://github.com/ded/bowser
  * MIT License | (c) Dustin Diaz 2015
  */

/*!
 * Platform.js v1.3.1 <http://mths.be/platform>
 * Copyright 2014-2016 Benjamin Tan <https://d10.github.io/>
 * Copyright 2011-2013 John-David Dalton <http://allyoucanleet.com/>
 * Available under MIT license <http://mths.be/mit>
 */

/*! Hammer.JS - v2.0.4 - 2014-09-28
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2014 Jorik Tangelder;
 * Licensed under the MIT license */

/*!

 handlebars v2.0.0

Copyright (C) 2011-2014 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/

/*
* jQuery Mobile v1.4.5
* http://jquerymobile.com
*
* Copyright 2010, 2014 jQuery Foundation, Inc. and other contributors
* Released under the MIT license.
* http://jquery.org/license
*
*/

/*!
 * jQuery Cookie Plugin v1.4.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2006, 2014 Klaus Hartl
 * Released under the MIT license
 */

define("syracuse-tablet/html/js/ui/uiUtils",["require","exports","module"],function(require,exports,module){var _empty=function(domNode){if(domNode)while(domNode.firstChild)domNode.removeChild(domNode.firstChild)},_toggleClass=function(item,css,show){if(item){var className=item.className;show?className.indexOf(css)<0&&(item.className=className+(" "+css)):item.className=className.replace(css,"")}},_waitDefOpts={className:"waiting-circles",elements:8,radius:30,auto:!0},_waitGlobal=null,_wait=function(waitObject,start){waitObject==null&&(_waitGlobal==null&&(_waitGlobal=_waitWheelCreate($(document.body))),waitObject=_waitGlobal),start?(waitObject.$$bckg.show(),_waitPluginStatus(waitObject.$$wheel,"enable")):(waitObject.$$bckg.hide(),_waitPluginStatus(waitObject.$$wheel,"disable"))},_waitWheelCreate=function($$parent,opts){var waitObject={$$bckg:$('<div class="waiting-background" style="display:none;z-index:2000"></div>'),$$wheel:$('<div class="waiting-wheel"  style="display:none;z-index:2000"></div>')};return waitObject.$$bckg.appendTo($$parent),waitObject.$$wheel.appendTo($$parent),_waitPluginCreate(waitObject.$$wheel,_waitDefOpts),waitObject},_waitPluginDestroy=function($$elmt){$$elmt&&$$elmt.data("waiting")&&($$elmt.waiting("destroy"),$$elmt.remove())},_waitPluginStatus=function($$elmt,status){$$elmt&&$$elmt.data("waiting")&&($$elmt.waiting(status),$$elmt[status==="disable"?"hide":"show"]())},_waitPluginCreate=function($$elmt,opts){if(!opts)throw new Error("opts is mandatory");return $$elmt&&$$elmt.waiting(opts),$$elmt},_waitWheelDestroy=function(waitObject){waitObject&&(_waitPluginDestroy(waitObject.$$wheel),waitObject.$$bckg&&waitObject.$$bckg.remove())},_createDomElement=function(tag,classList,content,attrList,parent){if(!tag)throw new Error("tag parameter is necessary !");var dom=document.createElement(tag);if(classList)if($.isArray(classList))$.each(classList,function(index,className){dom.className+=className+(index==classList.length-1?"":" ")});else{if(typeof classList!="string")throw new Error("classList parameter must be an array or a string");dom.className+=classList}dom.textContent=content?content:"";if(tag==="a"||tag==="img")attrList=attrList||{},attrList.draggable="false";return attrList&&$.each(attrList,function(key,value){dom.setAttribute(key,value)}),parent&&(parent.jquery?parent=parent.append(dom):parent.appendChild(dom)),dom},_appendTextNode=function(e,text){if(!e)return;var t=document.createTextNode(text||"");return e.jquery?e=e.append(t):e.appendChild(t),e},_buildDom=function(domDesc,parent){$.each(domDesc,function(nodeName,value){var dom=_createDomElement(nodeName,value.classList,value.textContent,value.attr,parent);value.children&&$.each(value.children,function(index,childElement){_buildDom(childElement,dom)})})};exports.empty=_empty,exports.toggleClass=_toggleClass,exports.waitWheelStart=function(waitObject){_wait(waitObject,!0)},exports.waitWheelStop=function(waitObject){_wait(waitObject,!1)},exports.waitWheelCreate=_waitWheelCreate,exports.waitWheelDestroy=_waitWheelDestroy,exports.waitPluginDestroy=_waitPluginDestroy,exports.waitPluginCreate=_waitPluginCreate,exports.waitPluginDisable=function($$elmt){_waitPluginStatus($$elmt,"disable")},exports.waitPluginEnable=function($$elmt){_waitPluginStatus($$elmt,"enable")},exports.createDomElement=_createDomElement,exports.buildDom=_buildDom,exports.appendTextNode=_appendTextNode,exports.triggerResizeInternal=function(opts){$(window).triggerHandler("resizeInternal",[opts])},exports.imgHeight2px=function(val){val=val||"small";switch(val){case"xsmall":return 25;case"small":return 50;case"medium":return 100;case"large":return 200;case"xlarge":return 300;default:return 100}}}),define("syracuse-tablet/html/js/helpers/jsutils",["require","exports","module"],function(require,exports,module){function bindFn(fn,context){var args=arguments.length>2?Array.prototype.splice.call(arguments,2):null;return function boundFn(){var callBackArgs=arguments;return args&&args.length>0&&args.forEach(function(a){Array.prototype.push.call(callBackArgs,a)}),fn.apply(context?context:this,callBackArgs)}}var _APP_RELEASE_REP="/dist/",_APP_DVLP_REP="/html/",_APP_RELEASE_INDEX="index.html",_APP_DVLP_INDEX="index_debug.html",_OPEN_LINK_IDEX="open_link.html",_stringToHtml=function(str){return(str||"").replace(/\n/g,"<br>")},_strStartsWith=function(str,s){return!str||str.length==0||s==null||s.length===0||str.length<s.length?!1:s.length===1?str.charAt(0)===s.toString():str.indexOf(s.toString())===0},_strEndsWith=function(str,s){return!str||str.length==0||s==null||str.length<s.length?!1:(s=s.toString(),s.length===1?str.charAt(str.length-1)===s:str.lastIndexOf(s)===str.length-s.length)},_strCapitalize=function(str){return!str||str.length===0?str:str.charAt(0).toUpperCase()+str.slice(1)};window.exports||(window.exports=window);var _purlOptions={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","querystring","anchor"],q:{name:"query",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},_parseURL=function(str){str=str&&str.replace(/\?.*(\@)/g,function(m){return m.replace(/\@/g,"%40")});var o=_purlOptions,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--)uri[o.key[i]]=m[i]||"";return uri[o.q.name]={},uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){$1&&(uri[o.q.name][$1]=decodeURIComponent($2))}),uri},_urlToString=function(u){if(!u)return"";var url="";u.protocol&&u.host&&(url+=u.protocol+"://"+u.host,u.port.length!=0&&(url+=":"+u.port)),url+=u.directory?u.directory.trim():"",u.file&&(_strEndsWith(u.directory,"/")||(url+="/"),url+=u.file);var query="";for(var p in u.query)query.length!=0&&(query+="&"),query+=p+"="+encodeURIComponent(u.query[p]);return query.length!=0&&(url+="?"+query),u.anchor&&(url+="#"+u.anchor),url},_curUrl,_getCurrentUrl=function(){return _curUrl?_curUrl:(_curUrl=_parseURL(window.location.href),_curUrl)},_getOpenLinkUrl=function(ctxUuid){var url=$.extend({},exports.getCurrentUrl());return url.file=_OPEN_LINK_IDEX,ctxUuid&&(url.query||(url.query={}),url.query.context=ctxUuid),exports.urlToString(url)},_getUrlContextId=function(){var contextId,sessStorage=typeof window.sessionStorage!="undefined"?window.sessionStorage:null;sessStorage&&(contextId=sessStorage.getItem("__urlContext__"),sessStorage.removeItem("__urlContext__"));if(!contextId){var url=exports.getCurrentUrl();contextId=url.quey?url.query.context:null}return contextId},_setUrlContextId=function(){var sessStorage=typeof window.sessionStorage!="undefined"?window.sessionStorage:null;sessStorage&&sessStorage.removeItem("__urlContext__");var url=_parseURL(window.location.href);try{var contextId=url.query&&url.query.context;console.log("_setUrlContextId",contextId),sessStorage&&contextId&&contextId.trim().length>0&&(sessStorage.setItem("__urlContext__",contextId),delete url.query.context)}catch(e){}var file=url.file;url.file=url.path.indexOf(_APP_RELEASE_REP)>0?_APP_RELEASE_INDEX:_APP_DVLP_INDEX,url.path=url.path.replace(file,url.file),window.location.replace(_urlToString(url))},_isInstanceOf=function(o,name){if(o==null)return!1;var ctor=o.constructor;return ctor&&ctor.$smClasses?ctor.$smClasses.indexOf(name)>-1:!1},_addInheritanceInfo=function(ctor,parent){var classes=[],name=ctor.name;if(!name){var ctorName=ctor&&ctor.toString();ctorName=ctorName.match(/^function\s*([^\s(]+)/),name=ctorName&&(ctorName.length>1?ctorName[1]:null)}name&&classes.push(name);if(parent&&parent.$smClasses){var i;for(i=0;i<parent.$smClasses.length;i++)classes.push(parent.$smClasses[i])}ctor.$smClasses=classes},_isError=function(o){return o&&Error.prototype.toString===o.toString},_isException=function(o){return o&&o.constructor&&o.constructor.name==="DOMException"},_stackRegexp,_cleanStack=function(stack,max,html){if(Array.isArray(stack))return stack;var globals=window.$sm;if(!globals)return stack;!_stackRegexp&&globals&&globals.baseLocation()&&(_stackRegexp={r1:new RegExp(globals.baseLocation().withPath,"g"),r2:new RegExp(globals.baseLocation().requirePath,"g")}),max=max==null?5:max;if(stack){var array=stack.split&&stack.split("\n")||stack,res;array.length>0&&array.forEach(function(l){var pos1=l.lastIndexOf(".js");if(pos1>0){var pos2=l.lastIndexOf("/",pos1);pos1>0&&(res||(res=[]),res.push(l.substring(pos2)))}else res||(res=[]),res.push(l)}),!res&&_stackRegexp?stack=_stackRegexp?stack.replace(_stackRegexp.r1,"").replace(_stackRegexp.r2,""):stack:stack=res.join("\n")}else stack="";return stack=stack.split("\n"),max&&(res=[],stack.forEach(function(l){l.indexOf(".js")>-1?max>0&&(res.push(l),max--):res.push(l)}),stack=res.join(html?"<br>&nbsp&nbsp&nbsp&nbsp&nbsp":"\n")),stack},_convertToDiagnoses=function(e,html){e==null&&(e="No error message");if(typeof e=="string")return{$diagnoses:[{$severity:"error",$message:html?_stringToHtml(e):e}]};if(_isError(e)||_isException(e))return{$diagnoses:[{$message:html?_stringToHtml(e.message):e.message,$stackTrace:_cleanStack(e.stack,null,html),$severity:"error"}]};if(e.$diagnoses&&Array.isArray(e.$diagnoses))return e;var res={$diagnoses:[]},diag={$severity:"error",$message:e.message||e.$message||e.$title||"No error message"};html&&(diag.$message=_stringToHtml(diag.$message)),res.$diagnoses.push(diag);var detail=e.detail;detail&&(_isError(detail)?(detail.message&&(diag.$stackTrace=(diag.$stackTrace?diag.$stackTrace+"\n":"")+detail.message),detail.stack&&(diag.$stackTrace=(diag.$stackTrace?diag.$stackTrace+"\n":"")+_cleanStack(detail.stack,null,html))):diag.$stackTrace=(diag.$stackTrace?diag.$stackTrace+"\n":"")+JSON.stringify(detail));var xe=e;while(xe.$exception!=null)_$exceptionAdd(res,xe.$exception,html),xe=xe.$exception;return res},_$exceptionAdd=function(res,$exception,html){if(!$exception)return;var msg=typeof $exception=="string"?$exception:$exception.message||$exception.$message,stk=$exception.stack;(msg||stk)&&res.$diagnoses.push({$message:html?_stringToHtml(msg):msg,$stackTrace:stk?_cleanStack(stk,null,html):"",$severity:"error"})},_getPropByPath=function(object,path,cache){if(path==null||object==null)return null;var pathStr,pathArray;if(Array.isArray(path)){if(path.length===0)return null;pathArray=path,pathStr=pathArray.join(".")}else pathArray=path.split("."),pathStr=path;if(cache&&cache[pathStr]!=null)return cache[pathStr];var data=object[pathArray[0]];for(var i=1;i<pathArray.length;i++){if(data==null)return null;if(!$.isPlainObject(data)==null)throw new Error("_getPropByPath - Unexpected non-plainobject");data=data[pathArray[i]]}return cache&&(cache[pathStr]=data),data};exports.concatArrays=function(){var args=[];for(var i=0;i<arguments.length;i++)arguments[i]!=null&&args.push(arguments[i]);return[].concat.apply([],args)},exports.getPropByPath=_getPropByPath,exports.addInheritanceInfo=_addInheritanceInfo,exports.isInstanceOf=_isInstanceOf,exports.isError=_isError,exports.cleanStack=_cleanStack,exports.convertToDiagnoses=_convertToDiagnoses,exports.bindFn=bindFn,exports.getCurrentUrl=_getCurrentUrl,exports.getOpenLinkUrl=_getOpenLinkUrl,exports.getUrlContextId=_getUrlContextId,exports.setUrlContextId=_setUrlContextId,exports.parseURL=_parseURL,exports.urlToString=_urlToString,exports.strStartsWith=_strStartsWith,exports.strEndsWith=_strEndsWith,exports.strCapitalize=_strCapitalize,exports.isReleaseVersion=function(){return document.location.href.indexOf("/index_debug.html")<0&&document.location.href.indexOf("/index_release.html")<0},exports.isDvlpVersion=function(){return window.location.href.indexOf("/index_debug.html")>-1||window.location.href.indexOf("/index_joined.html")>-1},exports.isTestEnvironment=function(){return window.location.href.indexOf("/syracuse-tablet/test/index.html")>-1},exports.getResourcesBasePath=function(){return exports.isReleaseVersion()?"/syracuse-tablet"+_APP_RELEASE_REP:"/syracuse-tablet"+_APP_DVLP_REP}}),define("syracuse-tablet/html/js/helpers/serverLog",["require","exports","module"],function(require,exports,module){function line(text){if(!text)return null;var now=new Date,trace=null;if(lastlog==null||now.getTime()-lastlog.getTime()>1e3)text="********Mobile********\n"+ ++num+": "+text,lastlog=now;return text}var sdataHost=window.location.protocol.toLowerCase()==="file:"?"":window.location.protocol+"//"+window.location.host,_logWriteUrl="/requireJS/log/write?text=",lastlog=new Date,num=0,lastlog,_maxLevel=0,_stdTypeToString=function(a,type){if(a==null)return null;type=type||typeof a;switch(type){case"number":case"string":case"boolean":return new String(a)}return null},_objectToString=function(a,level,flat){level=level==null?0:level;if(a==null)return null;if(typeof a!="object")return null;var res,v;if(Array.isArray(a)){res=[],a.forEach(function(b){v=_stdTypeToString(b),v?res.push(v):flat!==!0&&level<=_maxLevel&&(v=_objectToString(b,level+1),v&&res.push(v))});if(res.length==0)return null}else{res={};for(var p in a){var v=_stdTypeToString(a[p]);v?res[p]=v:flat!==!0&&level<=_maxLevel&&(v=_objectToString(a[p],level+1),v&&(res[p]=v))}$.isEmptyObject(res)&&(res=null)}return level==0?JSON.stringify(res,null,2):res},_argsToString=function(args,flat){var msg=[];for(var i=0;i<args.length;i++){var a=args[i];if(a==null)continue;var text=_stdTypeToString(a);text?msg.push(text):(text=_objectToString(a,0,flat),text&&msg.push(text))}return msg.length==0?null:msg.join(" ")},_log=function(msg){msg=line(msg);if(msg==null)return null;$.ajax({type:"GET",async:!1,url:sdataHost+_logWriteUrl+encodeURIComponent(msg),success:function(xhr){}})};exports.log=function(){_log(_argsToString(arguments,!1))},exports.logFlat=function(){_log(_argsToString(arguments,!0))}}),define("syracuse-tablet/html/js/helpers/logger",["require","exports","module","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/serverLog"],function(require,exports,module){function _getLogger(module,force){if(force!==!0)return null;var logger=function(){var text,errs;for(var i=0;i<arguments.length;i++)jsutils.isError(arguments[i])?(errs||(errs=[]),errs.push(arguments[i])):(text||(text=["["+module+"]: "]),text.push(arguments[i]));text&&text.length>1&&_log(text.join(" ")),errs&&errs.forEach(function(e){_log("["+module+"]: "+e.message),e.stack&&_log(jsutils.cleanStack(e.stack))})};return logger}var jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),serverLog=require("syracuse-tablet/html/js/helpers/serverLog"),_logOnServer=!1,_log;if(window.smNativeLogger&&window.smNativeLogger.log)_log=function(){var args=[];for(var i=0;i<arguments.length;i++)args.push(arguments[i]);window.smNativeLogger.log(args.join(""))};else{var _console=_logOnServer===!0?serverLog:window.console;_log=function(){if(!_console)return;var text=[];for(var i=0;i<arguments.length;i++){var a=arguments[i];a!=null&&(jsutils.isError(a)?_console&&_console.log&&_console.log(a.message,"\n",jsutils.cleanStack(a.stack)):text.push(a))}_console&&_console.log&&_console.log(text.join(text," "))}}window&&(window.logger=_log),exports.log=_log,exports.getLogger=_getLogger}),define("syracuse-tablet/html/js/helpers/uiSettings",["require","exports","module","syracuse-tablet/html/js/helpers/jsutils"],function(require,exports,module){var jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),_cache={},_getProp=function(path,device,orientation){if(path==null||arguments.length===0)return null;var res=jsutils.getPropByPath(_settings.gen,path,_cache);return res==null?null:(device&&res[device]&&(res=res[device]),orientation&&res[orientation]&&(res=res[orientation]),typeof res=="function"&&(res=res.call(null,device,orientation),_cache[Array.isArray(path)?path.join("."):path]=res),res)},_settings={ios:null,android:null,windows:null,def:{hubLayout:{groupSpacing:55,landscapeMinHeigth:function(){return _getProp("hubGroup.landscapeBaseSize")*4+_getProp("hubGroup.landscapePadY")*5+40}},hubGroup:{landscapeBaseSize:66,landscapePadX:8,landscapePadY:8,portraitPadX:8,portraitPadY:8,portraitWideMinWidth:570},footer:{height:{tablet:50,smartphone:62}},header:{height:50},breadcrumbs:{height:25},chartDetailToolbar:{height:40}}};exports.getProp=_getProp,exports.init=function(os){_cache={},_settings.gen=$.extend(!0,{},_settings.def,_settings[os])}}),!function(name,definition){typeof module!="undefined"&&module.exports?module.exports=definition():typeof define=="function"&&define.amd?define("syracuse-tablet/html/deps/bowser/bowser",definition):this[name]=definition()}("bowser",function(){function detect(ua){function getFirstMatch(regex){var match=ua.match(regex);return match&&match.length>1&&match[1]||""}function getSecondMatch(regex){var match=ua.match(regex);return match&&match.length>1&&match[2]||""}var iosdevice=getFirstMatch(/(ipod|iphone|ipad)/i).toLowerCase(),likeAndroid=/like android/i.test(ua),android=!likeAndroid&&/android/i.test(ua),chromeBook=/CrOS/.test(ua),edgeVersion=getFirstMatch(/edge\/(\d+(\.\d+)?)/i),versionIdentifier=getFirstMatch(/version\/(\d+(\.\d+)?)/i),tablet=/tablet/i.test(ua),mobile=!tablet&&/[^-]mobi/i.test(ua),result;/opera|opr/i.test(ua)?result={name:"Opera",opera:t,version:versionIdentifier||getFirstMatch(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(ua)?result={name:"Yandex Browser",yandexbrowser:t,version:versionIdentifier||getFirstMatch(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/windows phone/i.test(ua)?(result={name:"Windows Phone",windowsphone:t},edgeVersion?(result.msedge=t,result.version=edgeVersion):(result.msie=t,result.version=getFirstMatch(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(ua)?result={name:"Internet Explorer",msie:t,version:getFirstMatch(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:chromeBook?result={name:"Chrome",chromeBook:t,chrome:t,version:getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/chrome.+? edge/i.test(ua)?result={name:"Microsoft Edge",msedge:t,version:edgeVersion}:/chrome|crios|crmo/i.test(ua)?result={name:"Chrome",chrome:t,version:getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:iosdevice?(result={name:iosdevice=="iphone"?"iPhone":iosdevice=="ipad"?"iPad":"iPod"},versionIdentifier&&(result.version=versionIdentifier)):/sailfish/i.test(ua)?result={name:"Sailfish",sailfish:t,version:getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(ua)?result={name:"SeaMonkey",seamonkey:t,version:getFirstMatch(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel/i.test(ua)?(result={name:"Firefox",firefox:t,version:getFirstMatch(/(?:firefox|iceweasel)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(ua)&&(result.firefoxos=t)):/silk/i.test(ua)?result={name:"Amazon Silk",silk:t,version:getFirstMatch(/silk\/(\d+(\.\d+)?)/i)}:android?result={name:"Android",version:versionIdentifier}:/phantom/i.test(ua)?result={name:"PhantomJS",phantom:t,version:getFirstMatch(/phantomjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(ua)||/rim\stablet/i.test(ua)?result={name:"BlackBerry",blackberry:t,version:versionIdentifier||getFirstMatch(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:/(web|hpw)os/i.test(ua)?(result={name:"WebOS",webos:t,version:versionIdentifier||getFirstMatch(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(ua)&&(result.touchpad=t)):/bada/i.test(ua)?result={name:"Bada",bada:t,version:getFirstMatch(/dolfin\/(\d+(\.\d+)?)/i)}:/tizen/i.test(ua)?result={name:"Tizen",tizen:t,version:getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||versionIdentifier}:/safari/i.test(ua)?result={name:"Safari",safari:t,version:versionIdentifier}:result={name:getFirstMatch(/^(.*)\/(.*) /),version:getSecondMatch(/^(.*)\/(.*) /)},!result.msedge&&/(apple)?webkit/i.test(ua)?(result.name=result.name||"Webkit",result.webkit=t,!result.version&&versionIdentifier&&(result.version=versionIdentifier)):!result.opera&&/gecko\//i.test(ua)&&(result.name=result.name||"Gecko",result.gecko=t,result.version=result.version||getFirstMatch(/gecko\/(\d+(\.\d+)?)/i)),!result.msedge&&(android||result.silk)?result.android=t:iosdevice&&(result[iosdevice]=t,result.ios=t);var osVersion="";result.windowsphone?osVersion=getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):iosdevice?(osVersion=getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i),osVersion=osVersion.replace(/[_\s]/g,".")):android?osVersion=getFirstMatch(/android[ \/-](\d+(\.\d+)*)/i):result.webos?osVersion=getFirstMatch(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):result.blackberry?osVersion=getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i):result.bada?osVersion=getFirstMatch(/bada\/(\d+(\.\d+)*)/i):result.tizen&&(osVersion=getFirstMatch(/tizen[\/\s](\d+(\.\d+)*)/i)),osVersion&&(result.osversion=osVersion);var osMajorVersion=osVersion.split(".")[0];if(tablet||iosdevice=="ipad"||android&&(osMajorVersion==3||osMajorVersion==4&&!mobile)||result.silk)result.tablet=t;else if(mobile||iosdevice=="iphone"||iosdevice=="ipod"||android||result.blackberry||result.webos||result.bada)result.mobile=t;return result.msedge||result.msie&&result.version>=10||result.yandexbrowser&&result.version>=15||result.chrome&&result.version>=20||result.firefox&&result.version>=20||result.safari&&result.version>=6||result.opera&&result.version>=10||result.ios&&result.osversion&&result.osversion.split(".")[0]>=6||result.blackberry&&result.version>=10.1?result.a=t:result.msie&&result.version<10||result.chrome&&result.version<20||result.firefox&&result.version<20||result.safari&&result.version<6||result.opera&&result.version<10||result.ios&&result.osversion&&result.osversion.split(".")[0]<6?result.c=t:result.x=t,result}var t=!0,bowser=detect(typeof navigator!="undefined"?navigator.userAgent:"");return bowser.test=function(browserList){for(var i=0;i<browserList.length;++i){var browserItem=browserList[i];if(typeof browserItem=="string"&&browserItem in bowser)return!0}return!1},bowser._detect=detect,bowser}),function(){function capitalize(string){return string=String(string),string.charAt(0).toUpperCase()+string.slice(1)}function cleanupOS(os,pattern,label){var data={6.4:"10",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return pattern&&label&&/^Win/i.test(os)&&(data=data[0,/[\d.]+$/.exec(os)])&&(os="Windows "+data),os=String(os),pattern&&label&&(os=os.replace(RegExp(pattern,"i"),label)),os=format(os.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").split(" on ")[0]),os}function each(object,callback){var index=-1,length=object?object.length:0;if(typeof length=="number"&&length>-1&&length<=maxSafeInteger)while(++index<length)callback(object[index],index,object);else forOwn(object,callback)}function format(string){return string=trim(string),/^(?:webOS|i(?:OS|P))/.test(string)?string:capitalize(string)}function forOwn(object,callback){for(var key in object)hasOwnProperty.call(object,key)&&callback(object[key],key,object)}function getClassOf(value){return value==null?capitalize(value):toString.call(value).slice(8,-1)}function isHostType(object,property){var type=object!=null?typeof object[property]:"number";return!/^(?:boolean|number|string|undefined)$/.test(type)&&(type=="object"?!!object[property]:!0)}function qualify(string){return String(string).replace(/([ -])(?!$)/g,"$1?")}function reduce(array,callback){var accumulator=null;return each(array,function(value,index){accumulator=callback(accumulator,value,index,array)}),accumulator}function trim(string){return String(string).replace(/^ +| +$/g,"")}function parse(ua){function getLayout(guesses){return reduce(guesses,function(result,guess){return result||RegExp("\\b"+(guess.pattern||qualify(guess))+"\\b","i").exec(ua)&&(guess.label||guess)})}function getManufacturer(guesses){return reduce(guesses,function(result,value,key){return result||(value[product]||value[0,/^[a-z]+(?: +[a-z]+\b)*/i.exec(product)]||RegExp("\\b"+qualify(key)+"(?:\\b|\\w*\\d)","i").exec(ua))&&key})}function getName(guesses){return reduce(guesses,function(result,guess){return result||RegExp("\\b"+(guess.pattern||qualify(guess))+"\\b","i").exec(ua)&&(guess.label||guess)})}function getOS(guesses){return reduce(guesses,function(result,guess){var pattern=guess.pattern||qualify(guess);return!result&&(result=RegExp("\\b"+pattern+"(?:/[\\d.]+|[ \\w.]*)","i").exec(ua))&&(result=cleanupOS(result,pattern,guess.label||guess)),result})}function getProduct(guesses){return reduce(guesses,function(result,guess){var pattern=guess.pattern||qualify(guess);return!result&&(result=RegExp("\\b"+pattern+" *\\d+[.\\w_]*","i").exec(ua)||RegExp("\\b"+pattern+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(ua))&&((result=String(guess.label&&!RegExp(pattern,"i").test(guess.label)?guess.label:result).split("/"))[1]&&!/[\d.]+/.test(result[0])&&(result[0]+=" "+result[1]),guess=guess.label||guess,result=format(result[0].replace(RegExp(pattern,"i"),guess).replace(RegExp("; *(?:"+guess+"[_-])?","i")," ").replace(RegExp("("+guess+")[-_.]?(\\w)","i"),"$1 $2"))),result})}function getVersion(patterns){return reduce(patterns,function(result,pattern){return result||(RegExp(pattern+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(ua)||0)[1]||null})}function toStringPlatform(){return this.description||""}var context=root,isCustomContext=ua&&typeof ua=="object"&&getClassOf(ua)!="String";isCustomContext&&(context=ua,ua=null);var nav=context.navigator||{},userAgent=nav.userAgent||"";ua||(ua=userAgent);var isModuleScope=isCustomContext||thisBinding==oldRoot,likeChrome=isCustomContext?!!nav.likeChrome:/\bChrome\b/.test(ua)&&!/internal|\n/i.test(toString.toString()),objectClass="Object",airRuntimeClass=isCustomContext?objectClass:"ScriptBridgingProxyObject",enviroClass=isCustomContext?objectClass:"Environment",javaClass=isCustomContext&&context.java?"JavaPackage":getClassOf(context.java),phantomClass=isCustomContext?objectClass:"RuntimeObject",java=/\bJava/.test(javaClass)&&context.java,rhino=java&&getClassOf(context.environment)==enviroClass,alpha=java?"a":"α",beta=java?"b":"β",doc=context.document||{},opera=context.operamini||context.opera,operaClass=reOpera.test(operaClass=isCustomContext&&opera?opera["[[Class]]"]:getClassOf(opera))?operaClass:opera=null,data,arch=ua,description=[],prerelease=null,useFeatures=ua==userAgent,version=useFeatures&&opera&&typeof opera.version=="function"&&opera.version(),isSpecialCasedOS,layout=getLayout(["Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),name=getName(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel",{label:"SRWare Iron",pattern:"Iron"},"K-Meleon","Konqueror","Lunascape","Maxthon","Midori","Nook Browser","PhantomJS","Raven","Rekonq","RockMelt","SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser","Sunrise","Swiftfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),product=getProduct([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nook","PlayBook","PlayStation 4","PlayStation 3","PlayStation Vita","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),manufacturer=getManufacturer({Apple:{iPad:1,iPhone:1,iPod:1},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{"PlayStation 4":1,"PlayStation 3":1,"PlayStation Vita":1}}),os=getOS(["Windows Phone ","Android","CentOS","Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);layout&&(layout=[layout]),manufacturer&&!product&&(product=getProduct([manufacturer]));if(data=/\bGoogle TV\b/.exec(product))product=data[0];/\bSimulator\b/i.test(ua)&&(product=(product?product+" ":"")+"Simulator"),name=="Opera Mini"&&/\bOPiOS\b/.test(ua)&&description.push("running in Turbo/Uncompressed mode");if(/^iP/.test(product))name||(name="Safari"),os="iOS"+((data=/ OS ([\d_]+)/i.exec(ua))?" "+data[1].replace(/_/g,"."):"");else if(name=="Konqueror"&&!/buntu/i.test(os))os="Kubuntu";else if(manufacturer&&manufacturer!="Google"&&(/Chrome/.test(name)&&!/\bMobile Safari\b/i.test(ua)||/\bVita\b/.test(product)))name="Android Browser",os=/\bAndroid\b/.test(os)?os:"Android";else if(!name||(data=!/\bMinefield\b|\(Android;/i.test(ua)&&/\b(?:Firefox|Safari)\b/.exec(name)))name&&!product&&/[\/,]|^[^(]+?\)/.test(ua.slice(ua.indexOf(data+"/")+8))&&(name=null),(data=product||manufacturer||os)&&(product||manufacturer||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(os))&&(name=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(os)?os:data)+" Browser");(data=/\((Mobile|Tablet).*?Firefox\b/i.exec(ua))&&data[1]&&(os="Firefox OS",product||(product=data[1])),version||(version=getVersion(["(?:Cloud9|CriOS|CrMo|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|Silk(?!/[\\d.]+$))","Version",qualify(name),"(?:Firefox|Minefield|NetFront)"])),layout=="iCab"&&parseFloat(version)>3?layout=["WebKit"]:layout!="Trident"&&(data=/\bOpera\b/.test(name)&&(/\bOPR\b/.test(ua)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(ua)&&"WebKit"||!layout&&/\bMSIE\b/i.test(ua)&&(os=="Mac OS"?"Tasman":"Trident"))?layout=[data]:/\bPlayStation\b(?! Vita\b)/i.test(name)&&layout=="WebKit"&&(layout=["NetFront"]),name=="IE"&&(data=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(ua)||0)[1])?(name+=" Mobile",os="Windows Phone "+(/\+$/.test(data)?data:data+".x"),description.unshift("desktop mode")):/\bWPDesktop\b/i.test(ua)?(name="IE Mobile",os="Windows Phone 8+",description.unshift("desktop mode"),version||(version=(/\brv:([\d.]+)/.exec(ua)||0)[1])):name!="IE"&&layout=="Trident"&&(data=/\brv:([\d.]+)/.exec(ua))?(/\bWPDesktop\b/i.test(ua)||(name&&description.push("identifying as "+name+(version?" "+version:"")),name="IE"),version=data[1]):(name=="Chrome"||name!="IE")&&(data=/\bEdge\/([\d.]+)/.exec(ua))&&(name="Microsoft Edge",version=data[1],layout=["Trident"]);if(useFeatures){if(isHostType(context,"global")){java&&(data=java.lang.System,arch=data.getProperty("os.arch"),os=os||data.getProperty("os.name")+" "+data.getProperty("os.version"));if(isModuleScope&&isHostType(context,"system")&&(data=[context.system])[0]){os||(os=data[0].os||null);try{data[1]=context.require("ringo/engine").version,version=data[1].join("."),name="RingoJS"}catch(e){data[0].global.system==context.system&&(name="Narwhal")}}else typeof context.process=="object"&&(data=context.process)?(name="Node.js",arch=data.arch,os=data.platform,version=/[\d.]+/.exec(data.version)[0]):rhino&&(name="Rhino")}else getClassOf(data=context.runtime)==airRuntimeClass?(name="Adobe AIR",os=data.flash.system.Capabilities.os):getClassOf(data=context.phantom)==phantomClass?(name="PhantomJS",version=(data=data.version||null)&&data.major+"."+data.minor+"."+data.patch):typeof doc.documentMode=="number"&&(data=/\bTrident\/(\d+)/i.exec(ua))&&(version=[version,doc.documentMode],(data=+data[1]+4)!=version[1]&&(description.push("IE "+version[1]+" mode"),layout&&(layout[1]=""),version[1]=data),version=name=="IE"?String(version[1].toFixed(1)):version[0]);os=os&&format(os)}version&&(data=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(version)||/(?:alpha|beta)(?: ?\d)?/i.exec(ua+";"+(useFeatures&&nav.appMinorVersion))||/\bMinefield\b/i.test(ua)&&"a")&&(prerelease=/b/i.test(data)?"beta":"alpha",version=version.replace(RegExp(data+"\\+?$"),"")+(prerelease=="beta"?beta:alpha)+(/\d+\+?/.exec(data)||"")),name=="Fennec"||name=="Firefox"&&/\b(?:Android|Firefox OS)\b/.test(os)?name="Firefox Mobile":name=="Maxthon"&&version?version=version.replace(/\.[\d.]+/,".x"):name=="Silk"?(/\bMobi/i.test(ua)||(os="Android",description.unshift("desktop mode")),/Accelerated *= *true/i.test(ua)&&description.unshift("accelerated")):/\bXbox\b/i.test(product)?(os=null,product=="Xbox 360"&&/\bIEMobile\b/.test(ua)&&description.unshift("mobile mode")):(/^(?:Chrome|IE|Opera)$/.test(name)||name&&!product&&!/Browser|Mobi/.test(name))&&(os=="Windows CE"||/Mobi/i.test(ua))?name+=" Mobile":name=="IE"&&useFeatures&&context.external===null?description.unshift("platform preview"):(/\bBlackBerry\b/.test(product)||/\bBB10\b/.test(ua))&&(data=(RegExp(product.replace(/ +/g," *")+"/([.\\d]+)","i").exec(ua)||0)[1]||version)?(data=[data,/BB10/.test(ua)],os=(data[1]?(product=null,manufacturer="BlackBerry"):"Device Software")+" "+data[0],version=null):this!=forOwn&&product!="Wii"&&(useFeatures&&opera||/Opera/.test(name)&&/\b(?:MSIE|Firefox)\b/i.test(ua)||name=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(os)||name=="IE"&&(os&&!/^Win/.test(os)&&version>5.5||/\bWindows XP\b/.test(os)&&version>8||version==8&&!/\bTrident\b/.test(ua)))&&!reOpera.test(data=parse.call(forOwn,ua.replace(reOpera,"")+";"))&&data.name&&(data="ing as "+data.name+((data=data.version)?" "+data:""),reOpera.test(name)?(/\bIE\b/.test(data)&&os=="Mac OS"&&(os=null),data="identify"+data):(data="mask"+data,operaClass?name=format(operaClass.replace(/([a-z])([A-Z])/g,"$1 $2")):name="Opera",/\bIE\b/.test(data)&&(os=null),useFeatures||(version=null)),layout=["Presto"],description.push(data));if(data=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(ua)||0)[1]){data=[parseFloat(data.replace(/\.(\d)$/,".0$1")),data];if(name=="Safari"&&data[1].slice(-1)=="+")name="WebKit Nightly",prerelease="alpha",version=data[1].slice(0,-1);else if(version==data[1]||version==(data[2]=(/\bSafari\/([\d.]+\+?)/i.exec(ua)||0)[1]))version=null;data[1]=(/\bChrome\/([\d.]+)/i.exec(ua)||0)[1],data[0]==537.36&&data[2]==537.36&&parseFloat(data[1])>=28&&name!="IE"&&name!="Microsoft Edge"&&(layout=["Blink"]),!useFeatures||!likeChrome&&!data[1]?(layout&&(layout[1]="like Safari"),data=(data=data[0],data<400?1:data<500?2:data<526?3:data<533?4:data<534?"4+":data<535?5:data<537?6:data<538?7:data<601?8:"8")):(layout&&(layout[1]="like Chrome"),data=data[1]||(data=data[0],data<530?1:data<532?2:data<532.05?3:data<533?4:data<534.03?5:data<534.07?6:data<534.1?7:data<534.13?8:data<534.16?9:data<534.24?10:data<534.3?11:data<535.01?12:data<535.02?"13+":data<535.07?15:data<535.11?16:data<535.19?17:data<536.05?18:data<536.1?19:data<537.01?20:data<537.11?"21+":data<537.13?23:data<537.18?24:data<537.24?25:data<537.36?26:layout!="Blink"?"27":"28")),layout&&(layout[1]+=" "+(data+=typeof data=="number"?".x":/[.+]/.test(data)?"":"+")),name=="Safari"&&(!version||parseInt(version)>45)&&(version=data)}name=="Opera"&&(data=/\bzbov|zvav$/.exec(os))?(name+=" ",description.unshift("desktop mode"),data=="zvav"?(name+="Mini",version=null):name+="Mobile",os=os.replace(RegExp(" *"+data+"$"),"")):name=="Safari"&&/\bChrome\b/.exec(layout&&layout[1])&&(description.unshift("desktop mode"),name="Chrome Mobile",version=null,/\bOS X\b/.test(os)?(manufacturer="Apple",os="iOS 4.3+"):os=null),version&&version.indexOf(data=/[\d.]+$/.exec(os))==0&&ua.indexOf("/"+data+"-")>-1&&(os=trim(os.replace(data,""))),layout&&!/\b(?:Avant|Nook)\b/.test(name)&&(/Browser|Lunascape|Maxthon/.test(name)||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Sleipnir|Web)/.test(name)&&layout[1])&&(data=layout[layout.length-1])&&description.push(data),description.length&&(description=["("+description.join("; ")+")"]),manufacturer&&product&&product.indexOf(manufacturer)<0&&description.push("on "+manufacturer),product&&description.push((/^on /.test(description[description.length-1])?"":"on ")+product),os&&(data=/ ([\d.+]+)$/.exec(os),isSpecialCasedOS=data&&os.charAt(os.length-data[0].length-1)=="/",os={architecture:32,family:data&&!isSpecialCasedOS?os.replace(data[0],""):os,version:data?data[1]:null,toString:function(){var version=this.version;return this.family+(version&&!isSpecialCasedOS?" "+version:"")+(this.architecture==64?" 64-bit":"")}}),(data=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(arch))&&!/\bi686\b/i.test(arch)&&(os&&(os.architecture=64,os.family=os.family.replace(RegExp(" *"+data),"")),name&&(/\bWOW64\b/i.test(ua)||useFeatures&&/\w(?:86|32)$/.test(nav.cpuClass||nav.platform)&&!/\bWin64; x64\b/i.test(ua))&&description.unshift("32-bit")),ua||(ua=null);var platform={};return platform.description=ua,platform.layout=layout&&layout[0],platform.manufacturer=manufacturer,platform.name=name,platform.prerelease=prerelease,platform.product=product,platform.ua=ua,platform.version=name&&version,platform.os=os||{architecture:null,family:null,version:null,toString:function(){return"null"}},platform.parse=parse,platform.toString=toStringPlatform,platform.version&&description.unshift(version),platform.name&&description.unshift(name),os&&name&&(os!=String(os).split(" ")[0]||os!=name.split(" ")[0]&&!product)&&description.push(product?"("+os+")":"on "+os),description.length&&(platform.description=description.join(" ")),platform}var objectTypes={"function":!0,object:!0},root=objectTypes[typeof window]&&window||this,oldRoot=root,freeExports=objectTypes[typeof exports]&&exports,freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module,freeGlobal=freeExports&&freeModule&&typeof global=="object"&&global;freeGlobal&&(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal)&&(root=freeGlobal);var maxSafeInteger=Math.pow(2,53)-1,reOpera=/\bOpera/,thisBinding=this,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,toString=objectProto.toString;typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("syracuse-tablet/html/deps/platform/platform",[],function(){return parse()}):freeExports&&freeModule?forOwn(parse(),function(value,key){freeExports[key]=value}):root.platform=parse()}.call(this),define("syracuse-tablet/html/js/helpers/mobileDetect",["require","exports","module","syracuse-tablet/html/deps/bowser/bowser","syracuse-tablet/html/deps/platform/platform"],function(require,exports,module){var _bowser=require("syracuse-tablet/html/deps/bowser/bowser"),_platform=require("syracuse-tablet/html/deps/platform/platform"),_MobileDetect=function(){return window.MobileDetect?new window.MobileDetect(window.navigator.userAgent):null}(),_getDesktopOs=function(){if(_MobileDetect&&_MobileDetect.mobile()!=null)return null;if(!_platform||!_platform.os)return null;var family=_platform.os.family.toLowerCase();switch(family){case family.indexOf("windows"):return"windows";case"os x":return"osx";case"ubuntu":case"debian":case"fedora":case"red Hat":case"suse":return"linux";default:return null}},_defaultOSStyle="windows",_currentDesktopOS=_getDesktopOs();exports.init=function(log){_bowser&&_bowser._detect&&(_bowser=_bowser._detect(window.navigator.userAgent)),_MobileDetect=window.MobileDetect?new window.MobileDetect(window.navigator.userAgent):null,_currentDesktopOS=_getDesktopOs(),log&&(log("User agent Name",window.navigator.userAgent),log("Browser Name: ",exports.getBrowserName()),log("Browser OS: ",exports.isMobile()?_MobileDetect.os():_currentDesktopOS),log&&log("Browser OS Style: ",exports.getStyleOS()))},exports.getStyleOS=function(){var os=_MobileDetect==null?_defaultOSStyle:_MobileDetect.os();switch(os){case"AndroidOS":return"android";case"WindowsMobileOS":case"WindowsPhoneOS":return"windows";case"iOS":return"ios";case"PalmOS":case"BlackBerryOS":case"MeeGoOS":case"MaemoOS":case"JavaOS":case"webOS":case"badaOS":case"BREWOS":case"SymbianOS":default:return _defaultOSStyle}},exports.isOs=function(os){if(_MobileDetect==null)return os===_currentDesktopOS;switch(_MobileDetect.os()){case"AndroidOS":return os==="android";case"WindowsMobileOS":case"WindowsPhoneOS":return os==="windows";case"iOS":return os==="ios";case"PalmOS":case"BlackBerryOS":case"MeeGoOS":case"MaemoOS":case"JavaOS":case"webOS":case"badaOS":case"BREWOS":case"SymbianOS":default:return os===_currentDesktopOS}},exports.isMobile=function(){return _MobileDetect&&_MobileDetect.mobile()!=null};var _mobileDetectCheckBrowser=function(name,log){if(_MobileDetect==null)return null;var res=_MobileDetect.userAgent();return res?(res=res.toLowerCase(),res=res==="ie"&&name==="msie"||res===name,res===!0&&log&&log(name,"detect by mobile-detect"),res):null},_bowserCheckBrowser=function(name,log){if(_bowser==null)return null;var res=_bowser[name]===!0;return res===!0&&log&&log(name,"detect by bowser"),res},_checkBrowserName=function(name,log){var res=(exports.isMobile()?_mobileDetectCheckBrowser:_bowserCheckBrowser)(name,log);return res==null&&(res=(exports.isMobile()?_bowserCheckBrowser:_mobileDetectCheckBrowser)(name,log)),res};exports.checkBrowserName=function(){var result=!1,name,bn;for(var i=0;i<arguments.length;i++)result=result||_checkBrowserName(arguments[i].toLowerCase());return result},exports.getBrowserName=function(){var res=exports.isMobile()?_MobileDetect.userAgent():_bowser.name;return res==null&&(res=exports.isMobile()?_bowser.name:_MobileDetect.userAgent()),res?res.toLowerCase():"Not detected"},exports.getOsName=function(){var os=_MobileDetect.os();return os||(os=_getDesktopOs()),(os||"Not detected").toLowerCase()},exports.testBrowserName=function(log){var result={};return["chrome","firefox","msie","msedge","opera","phantom","safari","seamonkey"].forEach(function(b){result[b]=_checkBrowserName(b,log)}),log&&log(JSON.stringify(result,null,2)),result},exports.getDesktopOs=function(){return _currentDesktopOS}}),define("syracuse-tablet/html/js/helpers/native/nativeExtCall",["require","exports","module","syracuse-tablet/html/js/helpers/logger"],function(require,exports,module){function _isSupportedTest(domain,method){var obj=window[domain],caller=obj&&obj[method];if(!caller)return log&&log("_isSupportedTest: No such method: window."+domain+"."+method),!1;var sup=caller.call(obj);return sup}function _callMethodTest(domain,method,param){var obj=window[domain],caller=obj&&obj[method];if(!caller)return log&&log("_callMethodTest: No such method: window."+domain+"."+method),null;var ret=caller.call(obj,param);return ret}function _fireMethodTest(domain,method,param){var obj=window[domain],caller=obj&&obj[method];if(!caller)return log&&log("_fireMethodTest: No such method: window."+domain+"."+method),null;caller.call(obj,param)}var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("nativeExtCall",!1),_isPromise=function(o){return o!=null&&typeof o=="object"&&typeof o.then=="function"&&typeof o.fail=="function"},_testMode=!1;exports.isNativeModeEnabled=function(){return window&&window.smNativeInterface||_testMode===!0},exports.getSupportedDB=function(){return window&&window.smNativeInterface&&window.smNativeInterface.getSupportedDB?window.smNativeInterface.getSupportedDB():$.smResolve(null)},exports.appStartsRunning=function(){window&&window.smNativeInterface&&window.smNativeInterface.appStartsRunning&&window.smNativeInterface.appStartsRunning()},exports.isSupported=function(domain,method){var sup=!1;domain=domain||"",method=method||"";var caller=window&&window.smNativeInterface&&window.smNativeInterface.isSupported;return caller&&!_testMode?sup=window.smNativeInterface.isSupported(domain,method):_testMode?sup=_isSupportedTest(domain,method):log&&log("Native: isSupported no such interface - "+domain+", "+method+")"),_isPromise(sup)?sup:$.smResolve(sup)};var _checkReturnedValue=function(ret){log&&log("--> Result callMethod ="+(ret||"").substr(0,100));if(ret==null||typeof ret!="string")return null;var trimed=ret.trim();if(trimed.length>2){var charFirst=trimed.charAt(0),charLast=trimed.charAt(trimed.length-1);if(charFirst=="{"&&charLast=="}"||charFirst=="["&&charLast=="]")try{ret=JSON.parse(trimed)}catch(e){}}return ret};exports.callMethod=function(domain,method,data){var ret=null,param=data;param!=null&&typeof param!="string"&&(param=JSON.stringify(param)),domain=domain||"",method=method||"",param=param||"",log&&log("Native: callMethod ("+domain+", "+method+"): "+param);var caller=window&&window.smNativeInterface&&window.smNativeInterface.callMethod;return caller&&!_testMode?ret=window.smNativeInterface.callMethod(domain,method,param):_testMode?ret=_callMethodTest(domain,method,param):log&&log("Native: callMethod no such interface"),_isPromise(ret)?ret.then(function(result){return _checkReturnedValue(result)}):$.smResolve(_checkReturnedValue(ret))},exports.fireMethod=function(domain,method,data){var param=data;param!=null&&typeof param!="string"&&(param=JSON.stringify(param)),domain=domain||"",method=method||"",param=param||"",log&&log("Native: fireMethod ("+domain+", "+method+"): "+param);var caller=window&&window.smNativeInterface&&window.smNativeInterface.fireMethod;caller&&!_testMode?window.smNativeInterface.fireMethod(domain,method,param):_testMode?_fireMethodTest(domain,method,param):log&&log("Native: fireMethod no such interface")},exports.init=function(testMode){_testMode=testMode===!0}}),define("syracuse-tablet/html/js/helpers/native/nativeJSCall",["require","exports","module","syracuse-tablet/html/js/helpers/logger"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("nativeJSCall",!0);exports.init=function(){window.smJSCall||(window.smJSCall=function(objectName,methodName,jsonParam){try{log&&log("smJSCall (objectName): "+objectName),log&&log("smJSCall (methodName): "+methodName);var traceParam;if(jsonParam==null||$.isPlainObject(jsonParam))traceParam=JSON.stringify(jsonParam,null,2);else if(typeof jsonParam=="string")try{jsonParam=JSON.parse(jsonParam),traceParam=JSON.stringify(jsonParam,null,2)}catch(e){traceParam=jsonParam}else traceParam=jsonParam=new String(jsonParam);log&&log("smJSCall (jsonParam): "+(traceParam||"").substr(0,100));var obj=window[objectName];if(obj==null){log&&log("JS Object not found["+objectName+"] - Can't call method "+methodName);return}var method=obj&&obj[methodName],ret=method&&method.call(obj,jsonParam);return typeof ret!="string"&&(ret=""+ret),log&&log("smJSCall (return): "+ret),ret}catch(ex){throw log&&log(JSON.stringify(ex)),ex}})}}),define("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestHelpers",["require","exports","module","syracuse-tablet/html/js/helpers/globals"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),_handlebars={mailTo:' <a id ="testNativeMailto" href="mailto:?subject={{subject}}&body={{body}}" class="s-m-link">		<i class="fa fa-envelope">		</i>		<span>{{title}}</span>		</a>',handleLink:' <a id ="testNativeHandleLink" href="{{href}}" class="s-m-link">		<i class="fa fa-hand-pointer-o">		</i>		<span>{{title}}</span>		</a>'},_getHtml=function(tmpl,ctx){return Handlebars.compile(_handlebars[tmpl])(ctx)};exports.callAppNativeInterface=function(moduleName,actionName){var app=globals.getApplication();return app?app.nativeWrapperJSInterface.apply(app,arguments):null},exports.addTestEmail=function($$parent,options){if(!options)return;$(_getHtml("mailTo",{title:"Send email",subject:encodeURIComponent(options.subject||"No subject"),body:encodeURIComponent(options.url)})).appendTo($$parent),setTimeout(function(){$("#testNativeMailto").off().remove()},options.timeout||5e3)},exports.addHandleLink=function($$parent,options){if(!options)return null;var $$elmt=$(_getHtml("handleLink",{title:options.title||"HandleLink",href:options.url||"#"})).appendTo($$parent);return options.css&&$$elmt.css(options.css),options.clickHandler&&$$elmt.click(function(){options.clickHandler()}),setTimeout(function(){$("#testNativeHandleLink").off().remove()},options.timeout||5e3),$$elmt},exports.notify=function(title,text){globals.getModal().notify({severityClass:"success",title:title,body:text,onlyWebapp:!0})}}),define("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestShare",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestHelpers"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),testHelpers=require("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestHelpers"),_TestNativeWrapper=function(){this.sharePageLinkSupported=function(){return!0},this.sharePageLink=function(data){var parsedData=data?JSON.parse(data):null;if(!parsedData)return;testHelpers.addTestEmail($(".s-m-footer-left"),{subject:parsedData.DeepLink.Title,url:parsedData.DeepLink.Url}),testHelpers.addHandleLink($(".s-m-footer-left"),{clickHandler:function(){setTimeout(function(){globals.getApplication().gotoWelcomeApplication().then(function(){setTimeout(function(){window.smShareJS.handleLink(parsedData.DeepLink)})})})}});if(!window.smShareJS)return;setTimeout(function(){window.smShareJS.shareFinished({action:"ok"})})}};exports.create=function(){return new _TestNativeWrapper}}),define("syracuse-tablet/html/js/helpers/native/nativeHelpers",["require","exports","module","syracuse-tablet/html/js/helpers/globals"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals");exports.callAppNativeInterface=function(moduleName,actionName){var app=globals.getApplication();return app?app.nativeWrapperJSInterface.apply(app,arguments):null}}),define("syracuse-tablet/html/js/helpers/notifications",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/jsutils"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("notifs"),globals=require("syracuse-tablet/html/js/helpers/globals"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),_nameSpace="sm",_subscriptions={},_callCheck=function(object){return jsutils.isInstanceOf(object,"Page")&&!object.isActive()?!1:jsutils.isInstanceOf(object,"StructElmt")&&(object.controller==null||!object.controller.isActive())?!1:!0},_callHandler=function(callBack,object,args){if(!_callCheck(object))return;return setTimeout(function(){callBack.apply(object,args)},0)},_callHandlerSynch=function(callBack,object,args){if(!_callCheck(object))return;callBack.apply(object,args)},_publish=function(events){if(!events)throw new Error("No topic to publish");var events=typeof events=="string"?[events]:events;log&&log("Publish "+events.join(" - "));var args,subscription,subscription,res,count=0,array,objArgs,args=arguments,synch,callHandler;events.forEach(function(evt){synch=evt.smStartsWith("synch."),synch?(evt=evt.split("synch.")[1],callHandler=_callHandlerSynch):callHandler=_callHandler,array=_subscriptions[evt];if(array){array=array.slice();for(var i=0,l=array.length;i<l;i++)subscription=array[i],subscription.object?(objArgs||(objArgs=Array.prototype.slice.call(args,1)),res=callHandler(subscription.callBack,subscription.object,objArgs)):(args[0]=evt,res=callHandler(subscription.callBack,null,args)),count++}})},_publishEx=function(events,opts){if(!events)throw new Error("No topic to publish");var events=typeof events=="string"?[events]:events;log&&log("Publish "+events.join(" - "));var args,subscription,subscription,res,count=0,array,exclude=opts&&opts.exclude||[],objArgs,args=arguments,synch,callHandler;events.forEach(function(evt){synch=evt.smStartsWith("synch."),synch?(evt=evt.split("synch.")[1],callHandler=_callHandlerSynch):callHandler=_callHandler,array=_subscriptions[evt];if(array){array=array.slice();for(var i=0,l=array.length;i<l;i++)subscription=array[i],subscription.object?(!exclude||exclude.indexOf(subscription.object))<0&&(objArgs||(objArgs=Array.prototype.slice.call(args,2)),res=callHandler(subscription.callBack,subscription.object,objArgs)):(args[0]=evt,res=callHandler(subscription.callBack,null,args)),count++}})},_subscribe=function(object,events,priority){if(!events)throw new Error("Notification - No topic to publish");if(!object)throw new Error("Notification - Null object");priority=priority||10;var events=typeof events=="string"?[events]:events;log&&log("Subscribe "+events.join(" - ")+" - priority="+priority);var objectArray,removeIdx;events.forEach(function(evt){var callBackFct,callBackObj;if(typeof object=="function")callBackFct=object,callBackObj=null;else{callBackObj=object;var methodName=evt.split(".");if(methodName[0]!=_nameSpace)throw new Error("Notification - Bad event domain name");methodName=$.camelCase("notif-"+methodName.splice(1).join("-")),callBackFct=object[methodName];if(!callBackFct)throw new Error("Notification - Object must implement "+methodName)}var added=!1;objectArray=_subscriptions[evt];if(!objectArray)objectArray=_subscriptions[evt]=[];else{var removeIdx=-1;objectArray.some(function(o,idx){if(o&&(o.object===object||o.callBack===object))return removeIdx=idx,!0}),removeIdx>=0&&objectArray.splice(removeIdx,1)}var subscriptionInfo={callBack:callBackFct,object:callBackObj,priority:priority};for(var i=objectArray.length-1;i>=0;i--)if(objectArray[i].priority<=priority){objectArray.splice(i+1,0,subscriptionInfo),added=!0;break}added||objectArray.unshift(subscriptionInfo)})},_unsubscribe=function(object,events){events?typeof events=="string"&&(events=[events]):events=Object.keys(_subscriptions);var propToCheck=typeof object=="function"?"callBack":"object";events.forEach(function(evt){var array=_subscriptions[evt];if(array){var lg=array.length;for(var i=0,l=lg;i<l;i++)if(object==null||array[i][propToCheck]===object)array.splice(i,1),i--,l--}})},_reset=function(object,events){log&&log("Reset"),_unsubscribe(null,null)},_check=function(object){var res={};res.total=0;var propToCheck=typeof object=="function"?"callBack":"object";return Object.keys(_subscriptions).forEach(function(key){res.total+=_subscriptions[key].length;if(object==null)res[key]=_subscriptions[key].length;else{res[key]=0;var arr=_subscriptions[key];for(var i=0,l=arr.length;i<l;i++)arr[i][propToCheck]===object&&(res[key]=res[key]+1)}}),res},_notifyController=function(event,page){if(!event)throw new Error("_notifyController - Unexpected empty event");if(typeof event!="string")throw new Error("_notifyController - string event expected");log&&log("notifyController "+event);var args;page!==null?args=Array.prototype.slice.call(arguments,2):(page=globals.getCurrentPage(),args=Array.prototype.slice.call(arguments,1));if(!page)throw new Error("_notifyController - Unexpected null page");var synch=event.smStartsWith("synch."),callHandler;synch?(event=event.split("synch.")[1],callHandler=_callHandlerSynch):callHandler=_callHandler;var array=_subscriptions[event];if(array){for(var i=0,l=array.length;i<l;i++)if(array[i].object===page)return callHandler(array[i].callBack,page,args)}else console.log("_notifyController - No sunsciption for event "+event)};exports.check=_check,exports.reset=_reset,exports.subscribe=_subscribe,exports.unsubscribe=_unsubscribe,exports.publish=_publish,exports.publishEx=_publishEx,exports.notifyController=_notifyController}),define("syracuse-tablet/html/js/helpers/native/nativeShare",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestShare","syracuse-tablet/html/js/helpers/native/nativeHelpers","syracuse-tablet/html/js/helpers/native/nativeExtCall","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("nativeShare"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),nativeTestShare=require("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestShare"),nativeHelpers=require("syracuse-tablet/html/js/helpers/native/nativeHelpers"),nativeExtCall=require("syracuse-tablet/html/js/helpers/native/nativeExtCall"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_ShareManager=function(){this.enabled=!1,this.pendingLinks=null,this._currentDeferred=null,this.shareFinished=function(data){if(this._currentDeferred){var def=this._currentDeferred;this._currentDeferred=null,log&&log("Got share: "+JSON.stringify(data||{})),def.resolve(data)}},this.handleLink=function(data){log&&log("handleLink: "+JSON.stringify(data,null,2)),this.enabled===!0?this.triggerLink(data):(log&&log("handleLink: add pending link"),this.pendingLinks=this.pendingLinks||[],this.pendingLinks.push(data))},this.notifApplicationReady=function(ok){this.enabled=!0,this.pendingLinks&&(log&&log("handleLink: trigger pending link"),this.triggerLink(this.pendingLinks.pop()),this.pendingLinks=null)},this.triggerLink=function(data){log&&log("handleLink: triggerLink "+JSON.stringify(data,null,2));if(!data||!data.Url)return;try{var url=jsutils.parseURL(data.Url);log&&log("url: "+JSON.stringify(url,null,2));if(!url||!url.query||!url.query.context)return;var contextId=url.query.context;log&&log("context: "+contextId),nativeHelpers.callAppNativeInterface("share","handleLink",contextId)}catch(e){log&&log("handleLink: failed",e);return}},notifications.subscribe(this,["sm.application.ready"])};window.smShareJS||(window.smShareJS=new _ShareManager),exports.supports=function(capability){return capability==="share"?nativeExtCall.isSupported("smShare","sharePageLinkSupported"):$.smResolve(!1)},exports.sharePageLink=function(options){var param={Title:options.pageData.Title,Description:options.pageData.Description,DeepLink:options.pageData.DeepLink},data=JSON.stringify(param);return _ShareManager._currentDeferred=$.Deferred(),nativeExtCall.fireMethod("smShare","sharePageLink",data),_ShareManager._currentDeferred.promise()},exports.init=function(testMode){if(window&&window.smShare)return;if(!testMode)return;return log&&log("Creating native share test wrapper"),window.smShare=nativeTestShare.create(),window.smShare}}),define("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestLiveTile",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestHelpers"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("nativeLiveTile"),testHelpers=require("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestHelpers"),_TestNativeWrapper=function(){this.addLiveTileSupported=function(){return!0},this.addLiveTile=function(options){if(!options)return;try{options=JSON.parse(options)}catch(e){return}console.log(JSON.stringify(options,null,2));var id=options.Id,title=[];options.Title&&title.push(options.Title),options.Description&&title.push(options.Description),title=title.join(" - "),setTimeout(function(){log&&log("LIVE TILE ADD - Succeeded - "+title),testHelpers.addHandleLink($(".s-m-footer-left"),{url:options.DeepLink.Url,timeout:1e4,title:title}).find("i").css({color:options.ForegroundColor||"white","background-color":options.BackgroundColor}),window.smLiveTileJS.addLiveTileFinished(null)},100)}};exports.create=function(){return new _TestNativeWrapper}}),define("syracuse-tablet/html/js/helpers/native/nativeLiveTile",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestLiveTile","syracuse-tablet/html/js/helpers/native/nativeExtCall"],function(require,exports,module){function _getTileDataStruct(options){var param={Id:options.id,Title:options.title,Description:options.description,BackgroundColor:options.backgroundColor,ForegroundColor:options.color,SdataUrl:options.sDataUrl,DeepLink:options.DeepLink,UserLogin:globals.getUserLogin(),BindArray:options.bind||"$resources",BindDetail:""};return param}var globals=require("syracuse-tablet/html/js/helpers/globals"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("nativeLiveTile"),nativeTestLiveTile=require("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestLiveTile"),nativeExtCall=require("syracuse-tablet/html/js/helpers/native/nativeExtCall"),_currentDeferred;window.smLiveTileJS||(window.smLiveTileJS={addLiveTileFinished:function(data){if(_currentDeferred){var def=_currentDeferred;_currentDeferred=null,log&&log("Command live tile add finished: "+JSON.stringify(data||{})),def.resolve(data)}}}),exports.supports=function(capability){return capability==="liveTile"?nativeExtCall.isSupported("smLiveTile","addLiveTileSupported"):$.smResolve(!1)},exports.addLiveTile=function(options){_currentDeferred=$.Deferred();var data=JSON.stringify(_getTileDataStruct(options));return nativeExtCall.fireMethod("smLiveTile","addLiveTile",data),_currentDeferred.promise()},exports.init=function(testMode){if(window&&window.smLiveTile)return;if(!testMode)return;return log&&log("Creating native Live Tile test wrapper"),window.smLiveTile=nativeTestLiveTile.create(),window.smLiveTile}}),define("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestMessages",["require","exports","module","syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestHelpers","syracuse-tablet/html/js/helpers/globals"],function(require,exports,module){var testHelpers=require("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestHelpers"),globals=require("syracuse-tablet/html/js/helpers/globals"),_TestNativeWrapper=function(){this.toastMsgSupported=function(){return!0},this.toastMsg=function(options){options=JSON.parse(options);var notify={onlyWebapp:!0,title:options.Text2,message:options.Text2,severityClass:options.Severity};globals.getModal().forceNotifyWebApp(notify)},this.scheduledMsgSupported=function(){return!0},this.scheduledMsg=function(data){data?(data=JSON.parse(data),testHelpers.notify(data.Text1&&data.Text2?data.Text1+" - "+data.Text2:data.Text1||data.Text2,data.ScheduleTime)):testHelpers.notify("Empty toast message")}};exports.create=function(){return new _TestNativeWrapper}}),define("syracuse-tablet/html/js/helpers/native/nativeMessages",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestMessages","syracuse-tablet/html/js/helpers/native/nativeExtCall"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("nativeMsg"),nativeTestMessages=require("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestMessages"),nativeExtCall=require("syracuse-tablet/html/js/helpers/native/nativeExtCall"),_currentDeferred;window.smMsgJS||(window.smMsgJS={}),exports.supports=function(capability){return capability==="toastMessages"?nativeExtCall.isSupported("smMsg","toastMsgSupported"):capability==="scheduleMessage"?nativeExtCall.isSupported("smMsg","scheduledMsgSupported"):$.smResolve(!1)},exports.showToastMessage=function(options){var data=JSON.stringify(options);nativeExtCall.fireMethod("smMsg","toastMsg",data)},exports.scheduledMsg=function(options){var data=JSON.stringify(options);nativeExtCall.fireMethod("smMsg","scheduledMsg",data)},exports.init=function(testMode){if(window&&window.smMsg)return;if(!testMode)return;return log&&log("Creating native msg test wrapper"),window.smMsg=nativeTestMessages.create(),window.smMsg}}),define("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestPenInput",["require","exports","module","syracuse-tablet/html/js/helpers/logger"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("nativePenInput"),_TestNativeWrapper=function(){this.getPenTextInputSupported=function(){return!0},this.getAnnotatedImageSupported=function(){return!0},this.getSignatureImageSupported=function(options){return!0},this.getPenTextInput=function(context){context=context?JSON.parse(context):{};var text=window.prompt(context.Title||"Enter the text",context.Value||""),data={Action:text==null||text.trim().length===0?"cancelled":"ok",Matches:text?text.split(" "):null};setTimeout(function(){window.smPenInputJS.penInputTextFinished(data)},50)},this.getAnnotatedImage=function(options){var img="";setTimeout(function(){var data={Action:"ok",ImageData:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAAAGklEQVR42mOYacxANmIY1TyqeVTzqOaB1QwApdw+0KHEWp0AAAAASUVORK5CYII="};log&&log("Annotated Image GET "),window.smPenInputJS.penAnnotateImageFinished(data)},100)},this.getSignatureImage=function(options){var img="";setTimeout(function(){var data={Action:"ok",ImageData:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAAAGklEQVR42mOYacxANmIY1TyqeVTzqOaB1QwApdw+0KHEWp0AAAAASUVORK5CYII="};log&&log("Signature Image GET "),window.smPenInputJS.penSignatureImageFinished(data)},100)}};exports.create=function(){return new _TestNativeWrapper}}),define("syracuse-tablet/html/js/helpers/native/nativePenInput",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestPenInput","syracuse-tablet/html/js/helpers/native/nativeExtCall","syracuse-tablet/html/js/ui/uiUtils"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("nativePenInput",!0),nativeTestPenInput=require("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestPenInput"),nativeExtCall=require("syracuse-tablet/html/js/helpers/native/nativeExtCall"),uiutils=require("syracuse-tablet/html/js/ui/uiUtils"),_currentInputDeferred;window.smPenInputJS||(window.smPenInputJS={penInputTextFinished:function(data){if(_currentInputDeferred){var def=_currentInputDeferred;_currentInputDeferred=null,log&&log("Got pen input: "+JSON.stringify(data||{})),def.resolve({action:data.Action,matches:data.Matches})}},penAnnotateImageFinished:function(data){uiutils.waitWheelStop();if(_currentInputDeferred){var def=_currentInputDeferred;_currentInputDeferred=null,def.resolve({action:data.Action,imageData:data.ImageData})}},penSignatureImageFinished:function(data){if(_currentInputDeferred){var def=_currentInputDeferred;_currentInputDeferred=null,def.resolve({action:data.Action,imageData:data.ImageData})}}}),exports.supports=function(capability){return log&&log("Pen check support: "+capability),capability==="penTextInput"?nativeExtCall.isSupported("smPenInput","getPenTextInputSupported"):capability==="penAnnotatedImage"?nativeExtCall.isSupported("smPenInput","getAnnotatedImageSupported"):capability==="penSignatureImage"?nativeExtCall.isSupported("smPenInput","getSignatureImageSupported"):$.smResolve(!1)},exports.getPenTextInput=function(options){options&&options.value!=null&&(options.value=""+options.value);var data=JSON.stringify({Title:options.title,Value:options.value});return _currentInputDeferred=$.Deferred(),nativeExtCall.fireMethod("smPenInput","getPenTextInput",data),_currentInputDeferred.promise()},exports.getAnnotatedImage=function(options){var data=JSON.stringify({Title:options.title,ImageData:options.imageData});return _currentInputDeferred=$.Deferred(),uiutils.waitWheelStart(),nativeExtCall.fireMethod("smPenInput","getAnnotatedImage",data),_currentInputDeferred.promise()},exports.getSignatureImage=function(options){var data=JSON.stringify({Title:options.title,Watermark:options.watermark!=null?""+options.watermark:"",MaxWidth:options.maxWidth!=null?+options.maxWidth:640,MaxHeight:options.maxHeight!=null?+options.maxHeight:480,WatermarkSize:options.watermarkSize!=null?+options.watermarkSize:16});return _currentInputDeferred=$.Deferred(),nativeExtCall.fireMethod("smPenInput","getSignatureImage",data),_currentInputDeferred.promise()},exports.init=function(testMode){if(window&&window.smPenInput)return;if(!testMode)return;return log&&log("Creating native Pen Input test wrapper"),window.smPenInput=nativeTestPenInput.create(),window.smPenInput}}),define("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestImage",["require","exports","module"],function(require,exports,module){var _TestNativeWrapper=function(){this.getPictureFromCameraSupported=function(){return!0},this.getScaledImageSupported=function(){return!0},this.getPictureFromCamera=function(options){setTimeout(function(){var data={Action:"ok",ImageData:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAAAGklEQVR42mOYacxANmIY1TyqeVTzqOaB1QwApdw+0KHEWp0AAAAASUVORK5CYII="};window.smImageJS.getPictureFromCameraFinished(data)},100)},this.getScaledImage=function(options){setTimeout(function(){var data={Action:"ok",ImageData:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAAAGklEQVR42mOYacxANmIY1TyqeVTzqOaB1QwApdw+0KHEWp0AAAAASUVORK5CYII="};window.smImageJS.getScaledImageFinished(data)},100)}};exports.create=function(){return new _TestNativeWrapper}}),define("syracuse-tablet/html/js/helpers/native/nativeImage",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestImage","syracuse-tablet/html/js/helpers/native/nativeExtCall"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("nativeCamera"),nativeTestImage=require("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestImage"),nativeExtCall=require("syracuse-tablet/html/js/helpers/native/nativeExtCall"),_currentDeferred;window.smImageJS||(window.smImageJS={getPictureFromCameraFinished:function(data){log&&log("Got image!");if(_currentDeferred){var def=_currentDeferred;_currentDeferred=null,log&&log("Got image: "+JSON.stringify(data||{})),def.resolve({action:data.Action,imageData:data.ImageData})}},getScaledImageFinished:function(data){log&&log("Got scaled image!");if(_currentDeferred){var def=_currentDeferred;_currentDeferred=null,log&&log("Got scaled image: "+JSON.stringify(data||{})),def.resolve({action:data.Action,imageData:data.ImageData,width:data.Width,height:data.Height})}}}),exports.supports=function(capability){return capability==="camera"?nativeExtCall.isSupported("smImage","getPictureFromCameraSupported"):capability==="imageScale"?nativeExtCall.isSupported("smImage","getScaledImageSupported"):$.smResolve(!1)},exports.getPictureFromCamera=function(options){var param={};return options&&options.resizeOptions!=null&&(param.resizeOptions={Width:options.resizeOptions.width,Height:options.resizeOptions.height,Mode:options.resizeOptions.mode}),_currentDeferred=$.Deferred(),nativeExtCall.fireMethod("smImage","getPictureFromCamera",param),_currentDeferred.promise()},exports.getScaledImage=function(options){var data={ImageData:options.imageData,Width:options.width,Height:options.height,Mode:options.mode};return _currentDeferred=$.Deferred(),nativeExtCall.fireMethod("smImage","getScaledImage",data),_currentDeferred.promise()},exports.init=function(testMode){if(window&&window.smImage)return;if(!testMode)return;return log&&log("Creating native image test wrapper"),window.smImage=nativeTestImage.create(),window.smImage}}),define("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestVoiceCommands",["require","exports","module","syracuse-tablet/html/js/helpers/jsutils"],function(require,exports,module){var jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),_phraseListHtml='	<div id="phraseListId" class="s-m-test-wrapper" title="Test voice commands">		<div class="dropdown" style="padding-right:0px">	  		<span class="dropdown-toggle fa fa-microphone" data-toggle="dropdown" aria-expanded="true">	  		</span>	  		<ul class="dropdown-menu dropdown-menu-left" role="menu">				{{#each list}}					<li><a style="" draggable="false" href="#">{{title}}</a></li>				{{/each}}			</ul>		</div>	</div>',_getPhraseListMenu=function(ctx){return Handlebars.compile(_phraseListHtml)(ctx)},_TestNativeWrapper=function(){this.onClickPhrase=function(event){var $$t=$(event.target),text=$$t.text();if(!text||text.trim().length===0)return;setTimeout(function(){window.smVoiceJS.executeVoiceCommand({Command:"openBookmark",Text:text})})},this.phraseList=null,this.setPhraseListSupported=function(){return!0},this.setPhraseList=function(data){data=data?JSON.parse(data):null,this.phraseList=null;if(data&&data.PhraseList&&data.PhraseList.length>0){var self=this;this.phraseList=[],data.PhraseList.forEach(function(item){self.phraseList.push({title:item})})}},this.appendHeaderTestCmds=function($$root){if(!$$root||!this.setPhraseListSupported())return;$$root.find("#phraseListId").off().remove();var $$html=this.phraseList?$(_getPhraseListMenu({list:this.phraseList})):null;if($$html==null)return;$$html.appendTo($$root).click(jsutils.bindFn(this.onClickPhrase,this))}};exports.create=function(){var url=jsutils.getCurrentUrl();if(window.smVoiceJS&&url.query&&url.query.voiceCommand)try{window.smVoiceJS.executeVoiceCommand({command:"openBookmark",text:url.query.voiceCommand})}catch(e){}return new _TestNativeWrapper}}),define("syracuse-tablet/html/js/helpers/native/nativeVoiceCommands",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestVoiceCommands","syracuse-tablet/html/js/helpers/native/nativeHelpers","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/native/nativeExtCall"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("nativeVoice"),locale=require("syracuse-tablet/html/js/helpers/locale"),nativeTestVoiceCommands=require("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestVoiceCommands"),nativeHelpers=require("syracuse-tablet/html/js/helpers/native/nativeHelpers"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),nativeExtCall=require("syracuse-tablet/html/js/helpers/native/nativeExtCall"),_VoiceCommandsMgr=function(bookmarks){this.isReady=!1,this.init=function(mobileCommands){notifications.subscribe(this,["sm.application.ready"]),this.availableCommands=[];if(!mobileCommands||mobileCommands.length===0)return!1;var self=this,ok=!1;return mobileCommands.forEach(function(b){ok=self.add(b)||ok}),ok},this.add=function(mobileCommand){return!mobileCommand||!mobileCommand.title?!1:this.getAvailableCommand(mobileCommand.title)?(log&&log("add voice command - Command already exists '"+mobileCommand.title+"'"),!1):(log&&log("add voice command - '"+mobileCommand.title+"'"),this.availableCommands.unshift(mobileCommand),!0)},this.remove=function(title){if(!title)return!1;var idx;return this.availableCommands.some(function(b,i){if(b.title===title)return idx=i,!0})?(this.availableCommands.splice(idx,1),log&&log("remove voice command - '"+title+"'"),!0):!1},this.getAvailableCommand=function(keyWord){var mobileCommand=null,self=this;return this.availableCommands.some(function(b,i){if(b.title===keyWord)return mobileCommand=self.availableCommands[i],!0}),mobileCommand},this.executeOperation=function(operation){if(!operation)return;var refresh=!1;switch(operation){case"set":refresh=this.init(arguments[1]);break;case"add":refresh=this.add(arguments[1]);break;case"remove":refresh=this.remove(arguments[1]);break;default:return}if(refresh){var phraseList=[];this.availableCommands.forEach(function(b){phraseList.push(b.title)});var data=JSON.stringify({Phrase:"bookmark",PhraseList:phraseList,Language:locale.getCurrentLocale().toLowerCase()})}data&&(log&&log("Update voiceCommands: "+JSON.stringify(data,null,2)),nativeExtCall.fireMethod("smVoice","setPhraseList",data))},this.notifApplicationReady=function(){this.isReady=!0;var cmd=this.getPendingCommand("openBookmark");cmd&&(log&&log("Execute pending command - '"+cmd.title+"'"),this.executeVoiceCommand(cmd)),this.pendingCommands=null},this.executeVoiceCommand=function(data){if(this.isReady){if(!data||!data.command||!data.text)return;var cmd=this.getAvailableCommand(data.text);if(!cmd||data.command!==cmd.type)return;log&&log("Execute voice command - '"+cmd.title+"'"),nativeHelpers.callAppNativeInterface("voiceCommands","executeVoiceCommand",cmd);return}this.pendingCommands||(this.pendingCommands=[]),log&&log("Stores pending voice command - '"+data.text+"'"),this.pendingCommands.push(data)},this.getPendingCommand=function(type){if(!this.pendingCommands)return null;var bmk=null;return this.pendingCommands.some(function(cmd){if(!cmd||cmd.command!==type)return;return bmk=cmd,!0}),bmk},this.hasPendingCommand=function(type){return this.getPendingCommand(type)!=null},this.init()},_voiceCommandsManager=new _VoiceCommandsMgr;window.smVoiceJS||(window.smVoiceJS={executeVoiceCommand:function(data){if(!_voiceCommandsManager||!data)return;_voiceCommandsManager.executeVoiceCommand({command:data.Command,text:data.Text})}}),exports.supports=function(capability){return capability==="voiceCommands"?nativeExtCall.isSupported("smVoice","setPhraseListSupported"):$.smResolve(!1)},exports.setVoiceCommands=function(commands){_voiceCommandsManager.executeOperation.call(_voiceCommandsManager,"set",commands)},exports.addVoiceCommand=function(command){_voiceCommandsManager.executeOperation.call(_voiceCommandsManager,"add",command)},exports.removeVoiceCommand=function(title){_voiceCommandsManager.executeOperation.call(_voiceCommandsManager,"remove",title)},exports.hasPendingCommand=function(type){return _voiceCommandsManager.hasPendingCommand(type)},exports.createCommandFromPage=function(pinnedPage,alternativeTitle){return pinnedPage?pinnedPage.voiceCommandContext?!alternativeTitle&&!pinnedPage.title?null:{type:"openBookmark",title:alternativeTitle||pinnedPage.title,context:$.extend(!0,{},pinnedPage.voiceCommandContext)}:null:null},exports.createCommandFromAppli=function(title,appInfo){return!title||!appInfo||!appInfo.applicationName?null:{type:"openBookmark",title:title,context:{applicationName:appInfo.applicationName,endpoints:appInfo.endpoints}}},exports.init=function(testMode){if(window&&window.smVoice)return;if(!testMode)return;return log&&log("Creating native voice commands test wrapper"),window.smVoice=nativeTestVoiceCommands.create(),window.smVoice}}),define("syracuse-tablet/html/js/helpers/utils",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/jsutils"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),_localeModule,_forceUseCache=function(){var url=jsutils.getCurrentUrl();return url.query&&url.query.forceUseCache==="true"},_forceDvlpMode=function(){var url=jsutils.getCurrentUrl();return url.query&&url.query.forceDvlpMode==="true"},_addClassMembers=function(klass,members){if(!klass||!members||!klass.prototype)return;var proto=klass.prototype;for(var name in members||{}){var member=members[name];typeof member.get=="function"||typeof member.set=="function"?Object.defineProperty(proto,name,member):proto[name]=member}};exports.init=function(locale){_localeModule=locale};var _defineClass=function(constructor,parent,members){return parent&&(constructor.prototype=Object.create(parent.prototype)),constructor.prototype.constructor=constructor,_addClassMembers(constructor,members),jsutils.addInheritanceInfo(constructor,parent),constructor},_UUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)})},_getCurISODateTime=function(date){var currentdate=date||new Date,values=[currentdate.getFullYear(),4,currentdate.getMonth()+1,2,currentdate.getDate(),2,currentdate.getHours(),2,currentdate.getMinutes(),2,currentdate.getSeconds(),2],datetime;for(var i=0;i<values.length;i+=2){var val=""+values[i];while(val.length<values[i+1])val="0"+val;datetime?datetime+="-"+val:datetime=val}return datetime},_isoDateTimeToDate=function(stringDate){if(stringDate==null||typeof stringDate!="string")return new Date;var val=stringDate.split("-");return val.length!==6?new Date:new Date(val[0],parseInt(val[1],10)-1,val[2],val[3],val[4],val[5])},_getTimeFromString=function(stringDate){if(stringDate){var val=stringDate.split("-");return(new Date(val[0],parseInt(val[1],10)-1,val[2],val[3],val[4],val[5])).getTime()}return(new Date).getTime()},_domIdCpt=0,_domId=function(id){return id.replace(/([^\w-_])/g,"_")},_uidCpt=0,_readableuid=function(){return _domId($.camelCase((arguments.length>0?Array.prototype.join.call(arguments,"-")+"-":"")+_uidCpt++))},_unitTestId=function(){return arguments.length===0?null:Array.prototype.join.call(arguments,"-")},_qsParser=/([^&=;]*)=?([^&;]*)/g,_parseQueryString=function(qs){qs=qs||window.location.search;var res={},qs=decodeURIComponent(qs),ii=qs.indexOf("?");return ii>=0&&(qs=qs.substring(ii+1)),qs.replace(_qsParser,function($0,$1,$2){$1&&$1.length>0&&(res[$1]=decodeURIComponent($2))}),res},_exprRegExp=/\{(.*?)\}/g,_execExpression=function(expression,dataset,prototype,searchInParent,level,keepPlaceholder){level=level||0,expression=(expression||"")+"";var prevProp=null,res=expression.replace(_exprRegExp,function(match,prop){var empty=keepPlaceholder?match:"",val=dataset==null?null:dataset.getValue?dataset.getValue(prop,undefined,searchInParent):dataset[prop];return val!=null?val:prototype?prop.smStartsWith("@")?prototype.localization(prop)||"":(val=prototype.data(prop,dataset,null,!0),val!=null&&val.indexOf("{")>=0&&level<4?_execExpression(val,dataset,prototype,searchInParent,level+1,keepPlaceholder):val==null?empty:val):empty});return res||""},_extractCode=function($expression){return $expression+="",$expression.indexOf("{")>=0?$expression.slice(1,$expression.length-1):$expression},_isExpression=function(value){return $.type(value)!=="string"?!1:/^{@.*}$/.test(value)},_sanitizeArticle=function(article){function _walk(value){if(value==null||typeof value!="object")return;Object.keys(value).forEach(function(key){var v=value[key];key!=="$title"&&key!=="$titleOrig"||v==""||!!_isExpression(v)?_walk(v):delete value[key]})}if(!article)return article;var value=$.extend(!0,{},article);return _walk(value),value},_findParentVignette=function($$target,fail){var app=globals.getApplication();if(app.currentPage&&app.currentPage.isDashboard()){var $$v=$$target.closest(".s-m-control.s-m-vignette"),vignetteId=$$v.attr("id");if(!fail||vignetteId!=null&&vignetteId.length!==0){var vignette=app.currentPage.getControl(vignetteId);if(fail&&!vignette)throw new Error("Vignette not found - id["+vignetteId+"]");return vignette}throw new Error("Vignette DOM elmt not found")}if(fail)throw new Error("Current page is not a dashboard");return null},_findController=function($$elmt){var $$parent=$$elmt.closest("[data-controller-id]");if($$parent&&$$parent.length>0){var id=$$parent.attr("data-controller-id");return globals.getController(id)}return null},_findControl=function($$ctrl){var controller=_findController($$ctrl);return controller?controller.getStructElmt($$ctrl.attr("id")):null},_stopClickEvent=function(e){return e.shiftKey!==!0&&e.altKey!==!0},refTime=(new Date).getTime(),_timeLineCfg={ajax:!1,page:!1,pageLoader:!1,cacheUpdate:!1},_TimeLine=_defineClass(function(type,id){this.type=type,this.id=id},null,{log:function(step){var time=(new Date).getTime(),delta=this._prevTime==null?0:time-this._prevTime;this._prevTime=time,console.log(time-refTime,this.type,this.id,step,"elasped="+(time-this._start),"delta="+delta)},start:function(step){this._start=(new Date).getTime(),this.log(step?"start "+step:"start")},step:function(step){this.log(step)},stop:function(step){this.log(step?"stop "+step:"stop")},reset:function(){return this._prevTime=null,this._start=null,this}}),_getTimeLine=function(type,id,forceEnable){try{if(forceEnable===!1)return;if(forceEnable!==!0&&_timeLineCfg[type]!==!0)return null;if(type.indexOf("page")===-1&&id!=null){id+="";var p=id.indexOf("representation=");if(p>=0)id=id.substr(p+15);else{var p=id.indexOf("x3/erp/");if(p>=0)id=id.substr(p+7);else{var p=id.indexOf("collaboration/syracuse/");id=id.substr(p+23)}}id=decodeURIComponent(id)}return new _TimeLine(type,id)}catch(e){console.log(e)}},_hasProp=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)},_areEqual=function(obj1,obj2,strict){if(strict?obj1===obj2:obj1==obj2)return!0;if(obj1==null||obj2==null)return!1;if(Array.isArray(obj1)&&Array.isArray(obj2)){if(obj1.length!=obj2.length)return!1;for(var i=0;i<obj1.length;i++)if(!_areEqual(obj1[i],obj2[i]))return!1;return!0}if(typeof obj1!="object"||typeof obj2!="object")return!1;var combined=$.extend({},obj1);$.extend(combined,obj2);for(var i in combined)if(_hasProp(combined,i)){var val1=obj1[i],val2=obj2[i];if(!_areEqual(val1,val2))return!1}return!0},_typeNamesByMime={},_regExpMimeToType=/-|\//g;exports.getTypeName=function(mime){var type=_typeNamesByMime[mime];if(!type){var a=mime.split(_regExpMimeToType);type=_typeNamesByMime[mime]=a[a.length-1]}return type};var _authPageProps=["$pageActionSettings","$allowDownload"],_authCopyPageProperties=function(src,dst){if(!src||!dst)return;_authPageProps.forEach(function(p){if(src[p]!=null||dst[p]!=null&&src[p]==null)dst[p]=src[p]})};exports._checksum=function(text){var a=1,b=0;for(var index=0;index<text.length;++index)a=(a+text.charCodeAt(index))%65521,b=(b+a)%65521;return b<<16|a},exports.arrayInt=function(min,max){return Array(max-min+2).join().split(",").map(function(e,i){return min+i})},exports.isPromise=function(o){return o==null?!1:typeof o=="object"&&typeof o.then=="function"&&typeof o.fail=="function"},exports.toPromise=function(o){return exports.isPromise(o)?o:$.smResolve(o)},exports.authCopyPageProperties=_authCopyPageProperties,exports.areEqual=_areEqual,exports.stopClickEvent=_stopClickEvent,exports.extractCode=_extractCode,exports.isExpression=_isExpression,exports.sanitizeArticle=_sanitizeArticle,exports.UUID=_UUID,exports.defineClass=_defineClass,exports.addClassMembers=_addClassMembers,exports.readableuid=_readableuid,exports.domId=_domId,exports.unitTestId=_unitTestId,exports.parseQueryString=_parseQueryString,exports.getCurISODateTime=_getCurISODateTime,exports.isoDateTimeToDate=_isoDateTimeToDate,exports.getTimeFromString=_getTimeFromString,exports.parseExpression=function(expression,dataset,prototype,searchInParent,keepPlaceholder){return _execExpression(expression,dataset,prototype,searchInParent,0,keepPlaceholder)},exports.getArticleLocalization=function(article){if(!article||!article.$localization)return null;var localization=$.extend(!0,{},article.$localization),loc=localization&&localization[_localeModule.getCurrentLocale()];return loc&&localization[globals.fallbackLocaleCode]?loc.$fallback=$.extend(!0,{},localization&&localization[globals.fallbackLocaleCode]):loc||localization&&localization[globals.fallbackLocaleCode]&&(loc=localization&&localization[globals.fallbackLocaleCode]),loc},exports.isLocalizationExits=function($localization,uiId){if(!$localization||!uiId)return!1;var uuid=uiId.match(/\{\@(\S+)\}/),count=0;return uuid=uuid&&uuid[1]||uiId,Object.keys($localization).forEach(function(key){$localization[key][uuid]&&$localization[key][uuid]!==""&&count++}),count>1},exports.removeLocalization=function($localization,uuid){return!$localization||!uuid?!1:(Object.keys($localization).forEach(function(key){$localization[key][uuid]&&delete $localization[key][uuid]}),$localization)},exports.setLocalization=function($localization,uuid,text){return $localization[_localeModule.getCurrentLocale()]=$localization[_localeModule.getCurrentLocale()]||{},$localization[_localeModule.getCurrentLocale()][uuid]=text,$localization},exports.getCurrentPage=function(){return globals.getCurrentPage()},exports.getNavigatorLanguage=function(def){return navigator.language||navigator.userLanguage||def},exports.sameLanguage=function(l1,l2){return!l1||!l2?!1:(l1=l1.toLowerCase(),l2=l2.toLowerCase(),l2===l1?!0:(l1=l1.split("-"),l2=l2.split("-"),l1[0]===l2[0]))},exports.splitSdataKey=function(key){return key&&key.split("~")};var _splitExp=/({)|(})/g;exports.sdataExtractKeyFields=function(key){if(key==null||key.length===0||!key.replace)return;return exports.splitSdataKey(key.replace(_splitExp,""))},exports.getPropByPath=jsutils.getPropByPath,exports.findParentVignette=_findParentVignette,exports.findController=_findController,exports.findControl=_findControl,exports.getTimeLine=_getTimeLine,exports.forceUseCache=_forceUseCache,exports.forceDvlpMode=_forceDvlpMode,exports.checkUrlHostAndPort=function(url){if(!url)return url;var URL=jsutils.parseURL(url);return!URL.protocol||!URL.host?(URL.protocol=jsutils.getCurrentUrl().protocol,URL.host=jsutils.getCurrentUrl().host,URL.port=jsutils.getCurrentUrl().port,jsutils.urlToString(URL)):url}}),define("syracuse-tablet/html/js/ajax/ajaxInterface",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals"],function(require,exports,module){function _AjaxInterface(){}function _handleHttp401(deferred,result){if(globals.isTestEnvironment()){deferred.reject("Please login before running this testcase");return}var responseJSON=result.responseJSON;if(!responseJSON)try{responseJSON=JSON.parse(result.responseText)}catch(e){}var diag=responseJSON&&responseJSON.$diagnoses&&responseJSON.$diagnoses[0],link=diag&&diag.$links&&diag.$links.$redirect;if(!link){deferred.resolve(result);return}var diag={$message:_locale?_locale.text("error.session.timeout"):_httpStatus[401],$severity:"error",$links:{$redirect:link}};responseJSON=responseJSON||{},responseJSON.$diagnoses=[diag],responseJSON.$redirectPage="login",result.responseJSON=responseJSON,deferred.resolve(result)}function _handleHttp0(deferred,result){result.responseJSON={$noConnectionError:!0,$diagnoses:[{$message:(_locale?_locale.text("no.connection"):"No network connection")+" - HttpStatus=0",$severity:"error"}]},deferred.resolve(result)}var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("ajax"),utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),_locale,_httpStatus={200:"Ok",201:"Created",400:"Bad Request",401:"Unauthenticated",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request URI Too Long",415:"Unsupported Media Type",422:"Unprocessable Entity",429:"Too Many Requests",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout"},_rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,_ajaxInterfaceClass=utils.defineClass(_AjaxInterface,null,{ajax:function(method,url,send,headers,options){var deferred=$.Deferred();try{method=method?method.toUpperCase():"GET",options=options||{};var doAjax=function(){try{var lang=_locale&&_locale.getCurrentLocale(),allHeaders={Accept:"application/json;vnd.sage=syracuse"};lang&&(allHeaders["Accept-Language"]=lang),headers&&$.extend(allHeaders,headers);var ajaxData={headers:allHeaders,type:method,url:url,timeout:options.timeout==null?0:options.timeout};if(["PUT","POST"].indexOf(method)>=0&&send!=null){ajaxData.contentType=options.contentType||"application/json;charset=utf-8";if(ajaxData.contentType.indexOf("application/json")>=0&&typeof send=="object")try{send=JSON.stringify(send)}catch(e){throw new Error("Error parsing send data\nurl: "+url)}ajaxData.data=send}var timeLine=utils.getTimeLine("ajax",url);timeLine&&timeLine.start("send");var parseJson=allHeaders.Accept.indexOf("application/json")>=0&&options.noJsonParsing!==!0;parseJson&&(ajaxData.dataType="json"),log&&log("'"+method+"':"+url);var ajax=$.ajax_original||$.ajax,promise=ajax(ajaxData);promise.complete(function(jqXHR,textStatus){try{timeLine&&timeLine.step("completed");var status=jqXHR.status!=null?jqXHR.status:textStatus=="success"?200:500,result={textStatus:textStatus,status:status,descrHttpStatus:_httpStatus[status]||"unknown: "+status,isSuccess:status>=200&&status<300||status===304,headers:{}};parseJson?result.responseJSON=jqXHR.responseJSON:result.responseText=jqXHR.responseText;var match,headerStr=jqXHR.getAllResponseHeaders();if(headerStr)while(match=_rheaders.exec(headerStr))result.headers[match[1].toLowerCase()]=match[2];if(status===0&&options.dontCatchHttp0!==!0){_handleHttp0(deferred,result);return}if(status===401&&options.dontCatchHttp401!==!0){_handleHttp401(deferred,result);return}deferred.resolve(result)}catch(e){deferred.reject(e)}})}catch(e){deferred.reject(e)}};doAjax()}catch(e){deferred.reject(e)}return deferred.promise()}});exports.AjaxInterfaceClass=_ajaxInterfaceClass,exports.init=function(config,locale){_locale=locale,config=config||{},$.ajaxSetup({timeout:config.timeout==null?2e4:config.timeout,async:!0})}}),define("syracuse-tablet/html/js/ajax/ajax",["require","exports","module","syracuse-tablet/html/js/ajax/ajaxInterface"],function(require,exports,module){var ajaxInterface=require("syracuse-tablet/html/js/ajax/ajaxInterface"),_ajax;exports.getAjax=function(){return _ajax||(_ajax=new ajaxInterface.AjaxInterfaceClass),_ajax},exports.init=function(config,locale){ajaxInterface.init(config,locale)},exports.rejectHttpResult=function(title,result,url){return result&&result.responseJSON&&result.responseJSON.$diagnoses?(result.responseJSON.$diagnoses.length===0&&(result.responseJSON.$diagnoses=[{$message:title,$severity:"error"}]),$.smReject({$noConnectionError:result.responseJSON.$noConnectionError,$redirectPage:result.responseJSON.$redirectPage,$title:title,$diagnoses:result.responseJSON.$diagnoses})):result&&result.status?$.smReject({$title:title,$diagnoses:[{$message:(result.descrHttpStatus||"Http request error")+" - Status="+result.status,$stackTrace:result.responseText?result.responseText.replace(/<\/?([^>]*)>/g,"&lt;$1&gt;"):null}]}):$.smReject({$title:title,$diagnoses:[{$message:"Unexpected empty data"}]})}}),define("syracuse-tablet/html/js/storage/localStorage",["require","exports","module","syracuse-tablet/html/js/helpers/logger"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("sessstorage"),_available=null,_isAvailable=function(){if(_available!==null)return _available;_available=!1;try{window.localStorage.setItem("__test_availability__","__test_availability__"),_available=!0}catch(e){}return _available},_getItem=function(key,removeAfter){if(!_isAvailable()){log&&log("local.unsupported.getItem("+key+"):"+val);return}var val=window.localStorage.getItem(key);return log&&log("local.getItem("+key+"):"+val),!0===removeAfter&&_removeItem(key),val},_setItem=function(key,value){if(!_isAvailable()){log&&log("local.unsupported.setItem("+key+"):"+value);return}return log&&log("local.setItem("+key+"):"+value),window.localStorage.setItem(key,value)},_removeItem=function(key){if(!_isAvailable()){log&&log("local.unspported.removeItem("+key+")");return}return log&&log("local.removeItem("+key+")"),window.localStorage.removeItem(key)};exports.removeItem=_removeItem,exports.setItem=_setItem,exports.getItem=_getItem}),define("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestApp",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/storage/localStorage","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestHelpers"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("X3WUPApp",!1),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),localStorage=require("syracuse-tablet/html/js/storage/localStorage"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),nativeHelpers=require("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestHelpers"),_closeAppliBtn='	<div id="x3wupappclosebtn" class="s-m-test-wrapper" title="Close application">		<a href="#" draggable="false" style= "color:#41a940";>		<i class="fa fa-power-off"></i>		</a>	</div>',_addCloseAppliBtn=function($$root){return $$root.find("#x3wupappclosebtn").off().remove(),$(Handlebars.compile(_closeAppliBtn)()).appendTo($$root)},_TestNativeWrapper=function(){this.nativeWrapperSupported=function(){return!0},this.openExternalLinkSupported=function(){return!0},this.hardwareBackButtonSupported=function(){return!0},this.notifApplicationReady=function(ok){localStorage.removeItem("$reconnectContext")},this.onClickCloseAppli=function(){this.onWebappUnloaded()},this.onWebappLoaded=function(){},this.onWebappUnloaded=function(){if(!window.smWrapperJS)return;try{this.setReconnectContext(nativeHelpers.callAppNativeInterface("nativeApp","applicationClosing")),setTimeout(function(){window.location.reload()},100)}catch(e){return console.log(e.stack),e.message}},this.webappConfigServer=function(){},this.webappSelectServer=function(){},this.setReconnectContext=function(context){try{log&&log("setReconnectContext",context),localStorage.setItem("$reconnectContext",context)}catch(e){log&&log("setReconnectContext",JSON.stringify(e))}},this.getReconnectContext=function(){try{var context=localStorage.getItem("$reconnectContext");return log&&log("getReconnectContext",context),context}catch(e){return log&&log("getReconnectContext",JSON.stringify(e)),null}},this.getReconnectToken=function(){try{var loginCookie=localStorage.getItem("$reconnectToken"),sidCookie=localStorage.getItem("$reconnectSid");return log&&log("getReconnectToken",loginCookie,sidCookie),{loginCookie:loginCookie,sidCookie:sidCookie}}catch(e){return log&&log("getReconnectToken",JSON.stringify(e)),null}},this.setReconnectToken=function(token){try{log&&log("setReconnectToken",token),token=token?JSON.parse(token):null;if(!token)return;localStorage.setItem("$reconnectToken",token.SyracuseSidLogin),localStorage.setItem("$reconnectSid",token.SyracuseSid)}catch(e){log&&log("setReconnectToken",JSON.stringify(e))}},this.appendHeaderTestCmds=function($$root){if(!$$root||!this.nativeWrapperSupported())return;_addCloseAppliBtn($$root).click(jsutils.bindFn(this.onClickCloseAppli,this))},notifications.subscribe(this,["sm.application.ready"])};exports.create=function(){return new _TestNativeWrapper}}),define("syracuse-tablet/html/js/helpers/native/nativeApp",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/ajax/ajax","syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestApp","syracuse-tablet/html/js/helpers/native/nativeHelpers","syracuse-tablet/html/js/helpers/native/nativeExtCall"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("nativeWUPApp",!1),ajax=require("syracuse-tablet/html/js/ajax/ajax").getAjax().ajax,nativeTestApp=require("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestApp"),nativeHelpers=require("syracuse-tablet/html/js/helpers/native/nativeHelpers"),nativeExtCall=require("syracuse-tablet/html/js/helpers/native/nativeExtCall");window.smWrapperJS||(window.smWrapperJS={backButtonPressed:function(){return nativeHelpers.callAppNativeInterface("nativeApp","backButtonPressed")?"true":"false"},applicationClosing:function(){var currentHistoryStack=nativeHelpers.callAppNativeInterface("nativeApp","applicationClosing");return currentHistoryStack},applicationActivated:function(){nativeHelpers.callAppNativeInterface("nativeApp","applicationActivated")},connectivityChanged:function(connected){log&&log("connectivityChanged: "+connected),globals.setOffline(connected!=1,!1,!0)}}),exports.supports=function(capability){return capability==="nativeApp"?nativeExtCall.isSupported("smApp","nativeWrapperSupported"):capability==="hardwareBackButton"?nativeExtCall.isSupported("smApp","hardwareBackButtonSupported"):capability==="dispatcherListener"?nativeExtCall.isSupported("smApp","dispatcherListenerSupported"):capability==="extLink"?nativeExtCall.isSupported("smApp","openExternalLinkSupported"):capability==="nativeScrolling"?nativeExtCall.isSupported("smApp","nativeScrollingSupported"):$.smResolve(!1)},exports.openExternalLink=function(url){nativeExtCall.fireMethod("smApp","openExternalLink",url)},exports.getReconnectToken=function(){var deferred=$.Deferred();return nativeExtCall.callMethod("smApp","getReconnectToken").then(function(result){var loginCookie=null,sidCookie=null;result==null||typeof result=="string"?loginCookie=result:(loginCookie=result.loginCookie,sidCookie=result.sidCookie),deferred.resolve(loginCookie,sidCookie)}),deferred.promise()},exports.setReconnectToken=function(token,userLogin,sid){var data={};typeof token=="string"&&(data.SyracuseSidLogin=token,data.UserLogin=userLogin),typeof sid=="string"&&(data.SyracuseSid=sid),nativeExtCall.fireMethod("smApp","setReconnectToken",data)},exports.getReconnectContext=function(){return nativeExtCall.callMethod("smApp","getReconnectContext")},exports.configServer=function(){nativeExtCall.fireMethod("smApp","configServer")},exports.selectServer=function(){nativeExtCall.fireMethod("smApp","selectServer")},exports.dispatcherNotifyAfter=function(link){nativeExtCall.fireMethod("smApp","dispatcherNotifyAfter",link)},exports.notifLoaded=function(){log&&log("notifLoaded"),nativeExtCall.fireMethod("smApp","webappLoaded")},exports.notifUnloaded=function(historyContext){log&&log("OnWebappUnloaded");if(window&&window.smApp&&window.smApp.onWebappUnloaded)return window.smApp.onWebappUnloaded(historyContext?JSON.stringify(historyContext,null,2):null)},exports.notifStartFail=function(msg){nativeExtCall.fireMethod("smApp","webappLoadFail",msg)},exports.init=function(testMode){if(window&&window.smApp)return;if(!testMode)return;return log&&log("Creating native nativeApp test wrapper"),window.smApp=nativeTestApp.create(),window.smApp}}),define("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestSensors",["require","exports","module"],function(require,exports,module){var _TestNativeWrapper=function(){this.getGPSCoordinatesSupported=function(){return!0},this.getGPSCoordinates=function(options){setTimeout(function(){var data={Latitude:Math.random()*100,Longitude:Math.random()*100,Succeeded:!0};window.smSensorsJS.getGPSCoordinatesFinished(data)},1e3)}};exports.create=function(){return new _TestNativeWrapper}}),define("syracuse-tablet/html/js/helpers/native/nativeSensors",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestSensors","syracuse-tablet/html/js/helpers/native/nativeExtCall"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("nativeSensors",!0),nativeTestSensors=require("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestSensors"),nativeExtCall=require("syracuse-tablet/html/js/helpers/native/nativeExtCall"),_currentDeferred;window.smSensorsJS||(window.smSensorsJS={getGPSCoordinatesFinished:function(data){log&&log("Got GPS");if(_currentDeferred){var def=_currentDeferred;_currentDeferred=null,log&&log("Got GPS: "+JSON.stringify(data||{})),def.resolve({latitude:data.Latitude,longitude:data.Longitude,succeeded:data.Succeeded,error:data.Error})}}}),exports.supports=function(capability){return capability==="GPS"?nativeExtCall.isSupported("smSensors","getGPSCoordinatesSupported"):$.smResolve(!1)},exports.getGPSCoordinates=function(){return _currentDeferred=$.Deferred(),nativeExtCall.fireMethod("smSensors","getGPSCoordinates"),_currentDeferred.promise()},exports.init=function(testMode){if(window&&window.smSensors)return;if(!testMode)return;return log&&log("Creating native gps test wrapper"),window.smSensors=nativeTestSensors.create(),window.smSensors}}),define("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestBarcode",["require","exports","module"],function(require,exports,module){var _TestNativeWrapper=function(){this.scanBarcodeSupported=function(){return!0},this.scanBarcode=function(options){var bc=window.prompt("Enter the barcode",""),data={Action:bc==null||bc.trim().length===0?"cancelled":"ok",Content:bc,Format:"QR_CODE"};setTimeout(function(){window.smBarcodeJS.scanBarcodeFinished(data)},100)}};exports.create=function(){return new _TestNativeWrapper}}),define("syracuse-tablet/html/js/helpers/native/nativeBarcode",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestBarcode","syracuse-tablet/html/js/helpers/native/nativeExtCall"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("nativeCamera",!0),nativeTestBarcode=require("syracuse-tablet/html/js/helpers/native/wrapperTest/nativeTestBarcode"),nativeExtCall=require("syracuse-tablet/html/js/helpers/native/nativeExtCall"),_currentDeferred;window.smBarcodeJS||(window.smBarcodeJS={scanBarcodeFinished:function(data){log&&log("Got barcode: "+JSON.stringify(data||{}));if(_currentDeferred){var def=_currentDeferred;_currentDeferred=null,def.resolve({action:data.Action,content:data.Content,format:data.Format})}}}),exports.supports=function(capability){return capability==="scanBarcode"?nativeExtCall.isSupported("smBarcode","scanBarcodeSupported"):$.smResolve(!1)},exports.scanBarcode=function(options){var param={};return _currentDeferred=$.Deferred(),nativeExtCall.fireMethod("smBarcode","scanBarcode",param),_currentDeferred.promise()},exports.init=function(testMode){if(window&&window.smBarcode)return;if(!testMode)return;log&&log("Creating native barcode test wrapper"),window.smBarcode=nativeTestBarcode.create()}}),define("syracuse-tablet/html/js/helpers/native/native",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/native/nativeExtCall","syracuse-tablet/html/js/helpers/native/nativeJSCall","syracuse-tablet/html/js/helpers/native/nativeShare","syracuse-tablet/html/js/helpers/native/nativeLiveTile","syracuse-tablet/html/js/helpers/native/nativeMessages","syracuse-tablet/html/js/helpers/native/nativePenInput","syracuse-tablet/html/js/helpers/native/nativeImage","syracuse-tablet/html/js/helpers/native/nativeVoiceCommands","syracuse-tablet/html/js/helpers/native/nativeApp","syracuse-tablet/html/js/helpers/native/nativeSensors","syracuse-tablet/html/js/helpers/native/nativeBarcode"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("native",!1),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),nativeExtCall=require("syracuse-tablet/html/js/helpers/native/nativeExtCall"),nativeJSCall=require("syracuse-tablet/html/js/helpers/native/nativeJSCall"),_modules={nativeShare:require("syracuse-tablet/html/js/helpers/native/nativeShare"),nativeLiveTile:require("syracuse-tablet/html/js/helpers/native/nativeLiveTile"),nativeMessages:require("syracuse-tablet/html/js/helpers/native/nativeMessages"),nativePenInput:require("syracuse-tablet/html/js/helpers/native/nativePenInput"),nativeImage:require("syracuse-tablet/html/js/helpers/native/nativeImage"),nativeVoiceCommands:require("syracuse-tablet/html/js/helpers/native/nativeVoiceCommands"),nativeApp:require("syracuse-tablet/html/js/helpers/native/nativeApp"),nativeSensors:require("syracuse-tablet/html/js/helpers/native/nativeSensors"),nativeBarcode:require("syracuse-tablet/html/js/helpers/native/nativeBarcode")},_capabilities={nativeApp:"nativeApp",dispatcherListener:"nativeApp",hardwareBackButton:"nativeApp",nativeScrolling:"nativeApp",extLink:"nativeShare",share:"nativeShare",liveTile:"nativeLiveTile",scheduleMessage:"nativeMessages",toastMessages:"nativeMessages",penTextInput:"nativePenInput",penAnnotatedImage:"nativePenInput",penSignatureImage:"nativePenInput",camera:"nativeImage",imageScale:"nativeImage",voiceCommands:"nativeVoiceCommands",scanBarcode:"nativeBarcode",GPS:"nativeSensors"},_capabilitiesModules={},_testMode=!1,_testWrappers={};exports.isTestMode=function(){return _testMode},exports.hasCapability=function(capability){return exports.getModule(capability)!=null},exports.getModule=function(capability){return _capabilitiesModules[capability]},exports.callModule=function(capability,functionName){var module=exports.getModule(capability);if(!module||!module[functionName])return null;var args=Array.prototype.slice.call(arguments,2);return module[functionName].apply(null,args)},exports.appendHeaderTestCmds=function($$root){if(!exports.isTestMode())return;Object.keys(_testWrappers).forEach(function(name){var testWrapper=_testWrappers[name];if(testWrapper==null||!testWrapper.appendHeaderTestCmds)return;testWrapper.appendHeaderTestCmds($$root)})},exports.init=function(){return nativeJSCall.init(),nativeExtCall.appStartsRunning(),$.smResolve().then(function(){var _url=jsutils.getCurrentUrl();_testMode=_url.query&&_url.query.testNativeWrapper==="true",nativeExtCall.init(_testMode);for(var m in _modules)_modules[m].init&&(_testWrappers[m]=_modules[m].init(_testMode))}).then(function(){return $.smForEachPromise(Object.keys(_capabilities),function(capability){_capabilitiesModules[capability]=null;var moduleName=_capabilities[capability];if(moduleName==null)return log&&log("Native initialization","No module has been found for capability ["+capability+"]"),$.smResolve(!1);var module=_modules[moduleName];return module==null?(log&&log("Native initialization","Unknown native module ["+module+"]"),$.smResolve(!1)):module.supports==null?(log&&log("Native initialization","Module ["+moduleName+"] must implement 'supports' method"),$.smResolve(!1)):module.supports(capability)},function(capability,supported){supported===!0&&(_capabilitiesModules[capability]=_modules[_capabilities[capability]])})},!0)},exports.getSupportedDB=function(){return nativeExtCall.getSupportedDB()}}),define("syracuse-tablet/html/js/helpers/globals",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/uiSettings","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/mobileDetect","syracuse-tablet/html/js/helpers/native/nativeExtCall","syracuse-tablet/html/js/helpers/native/native"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("globals",!1),uiSettings=require("syracuse-tablet/html/js/helpers/uiSettings"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),mobileDetect=require("syracuse-tablet/html/js/helpers/mobileDetect"),nativeExtCall=require("syracuse-tablet/html/js/helpers/native/nativeExtCall"),native=require("syracuse-tablet/html/js/helpers/native/native"),_notifUserAgentChanged=function(){mobileDetect.init(log),_globals.isMobile=mobileDetect.isMobile(),_globals.isTestNativeWrapper=!1;try{var _url=jsutils.getCurrentUrl();_globals.isTestNativeWrapper=_url.query!=null&&(_url.query.testNativeWrapper==="true"||_url.query.isDesktop==="true")}catch(e){}$(document.body).toggleClass("s-m-mobile-device",_globals.isMobile===!0).attr({"data-style":mobileDetect.getStyleOS(),"data-browser":mobileDetect.getBrowserName(),"data-os":mobileDetect.getOsName()}),log&&log("Is mobile",_globals.isMobile,"is TestNativeWrapper",_globals.isTestNativeWrapper)},_metaData,_authoringActive,_emptyCacheCtx={$user:"none",$role:"none",$lang:"none"},_devOpts={showUnfoundFields:!1},_controllersMap={},_globals={tabletApplication:null,userCtx:null,isTestEnvironment:!1,baseLocation:null,isDvlpMode:!1,storage:null,cache:null,modal:null,cacheCtx:$.extend({},_emptyCacheCtx),lookAndFeel:"windows",userProfile:{},userProfileLocales:{}};(function(){_notifUserAgentChanged()})();var _clearUserCtx=function(userCtx){return _setUserCtx(null)},_setUserCtx=function(userCtx){log&&log("Set user context");var ctx=userCtx==null?$.extend({},_emptyCacheCtx):userCtx;return _globals.cache.setContext(ctx),_globals.cacheCtx=ctx,exports.isAutoUITestMode()&&exports.getUnitTestMgr().notifUserCtxChanged(ctx,exports.getEndpoint()),_globals.userCtx=ctx},_setTabletApplication=function(appObj){if(!appObj)throw new Error("Null tabletApplication object");return log&&log("Set tablet Application object"),_globals.tabletApplication=appObj,appObj},_isNativeScrollingStatus=null,_init=function(dvlpMode,storage,cache,utilsModule){_globals.isDvlpMode=dvlpMode;var bl=_globals.baseLocation={};bl.host=window.location.protocol+"//"+window.location.host;var path=window.location.pathname.split("/").splice(0,2).join("/");bl.withPath=bl.host+path,bl.requirePath=bl.host+"/requireJS"+path,bl.htmlRoot=bl.withPath+"/html",bl.url=bl.host+window.location.pathname,utilsModule&&(bl.query=utilsModule.parseQueryString()),_globals.isTestEnvironment=jsutils.isTestEnvironment(),_globals.storage=storage,_globals.cache=cache,_globals.unitTestMode=bl.query&&bl.query.unitTestMode==="true"};exports.fallbackLocaleCode="en-US",exports.isLoggedIn=function(){return _globals.userCtx!=null&&_globals.userCtx.$user!=="none"},exports.getUserCtx=function(){return _globals.userCtx},exports.getGlobalCtx=function(){return _globals},exports.getStorage=function(){return _globals.storage},exports.getCache=function(){return _globals.cache},exports.getCacheCtx=function(){return _globals.cacheCtx},exports.getEmptyCacheCtx=function(){return _emptyCacheCtx},exports.getEndpoint=function(){return _globals.endpoint},exports.getEndpointDescr=function(){return _globals.endpointDescr},exports.setEndpoint=function(ep,epDescr){_globals.endpoint=ep,_globals.endpointDescr=epDescr||ep,exports.isAutoUITestMode()&&exports.getUnitTestMgr().notifUserCtxChanged(exports.getUserCtx(),ep)},exports.notifUserAgentChanged=_notifUserAgentChanged,exports.isDesktop=function(){return _globals.isMobile!==!0},exports.isNativeModeEnabled=function(){return nativeExtCall.isNativeModeEnabled()},exports.isMobile=function(){return _globals.isMobile===!0},exports.isNativeScrolling=function(){return _isNativeScrollingStatus==null&&(exports.isNativeWrapper()?_isNativeScrollingStatus=native.hasCapability("nativeScrolling"):_isNativeScrollingStatus=exports.isMobile()),_isNativeScrollingStatus},exports.isNativeWrapper=function(){return native.hasCapability("nativeApp")},exports.isTestNativeWrapper=function(){return exports.isDesktop()&&_globals.isTestNativeWrapper},exports.isDebugDeviceSimlator=function(){return exports.isMobile()&&window.smNativeInterface==null},exports.isDevelopmentModeAllowed=function(){return exports.isDesktop()&&!exports.isNativeModeEnabled()&&exports.isDvlpMode()},exports.isAuthoringModeAllowed=function(){return exports.isDesktop()&&!exports.isNativeModeEnabled()&&exports.getAuthoringLevel()!=="none"},exports.$config=function(prop){return _globals.tabletApplication.$config(prop)},exports.setUserProfile=function(up){if(!up||!up.user||!up.selectedRole||!up.selectedLocale)throw new Error("Unexpected "+(up?"bad":"null")+" user profile");up.selectedEndpoint&&exports.setEndpoint(up.selectedEndpoint.application+"."+up.selectedEndpoint.contract+"."+up.selectedEndpoint.dataset,up.selectedEndpoint.description),exports.setUserCtx({$user:up.user.$value,$role:up.selectedRole.code,$lang:up.selectedLocale.code}),_globals.userProfileLocales={},up.user.locales&&up.user.locales.forEach(function(locale){_globals.userProfileLocales[locale.code]={shortDate:locale.shortDate,shortTime:locale.shortTime,longTime:locale.longTime,numberDecimalSeparator:locale.numberDecimalSeparator,numberGroupSeparator:locale.numberGroupSeparator}}),_globals.userProfile=up},exports.getUserProfileLocale=function(locale){return _globals.userProfileLocales[locale]},exports.getUserProfile=function(){return _globals.userProfile},exports.getUserName=function(){var up=_globals.userProfile;return up&&up.user&&(up.user.firstName?up.user.firstName+" ":"")+up.user.lastName||"unknown"},exports.getUserUuid=function(){var up=_globals.userProfile;return up&&up.user&&up.user.$uuid},exports.getUserLogin=function(){var up=_globals.userProfile;return up&&up.user&&up.user.login},exports.getUserRole=function(){var up=_globals.userProfile;return up&&up.selectedRole&&up.selectedRole.description||""},exports.getSeletedRoleUuid=function(){var up=_globals.userProfile;return up&&up.selectedRole&&up.selectedRole.$uuid||""},exports.getSecurityProfile=function(){var up=_globals.userProfile;return up&&up.securityProfile||{}},exports.getAuthoringLevel=function(){var al=_globals.userProfile;return(al?al.authoringLevel:null)||"none"},exports.getCurrentPage=function(){return _globals.tabletApplication.currentPage},exports.getScrollingDirection=function(){var p=exports.getCurrentPage();return p.rootLayout&&p.rootLayout.$type==="hub"?p.rootLayout.scrollDirection:"v"},exports.getMainPageGestureMgr=function(){var p=exports.getCurrentPage();return p?p.getGestureMgr():null},exports.setTabletApplication=_setTabletApplication,exports.getApplication=function(){return _globals.tabletApplication},exports.setUserCtx=_setUserCtx,exports.clearUserCtx=_clearUserCtx,exports.setModal=function(m){_globals.modal=m},exports.getModal=function(){return _globals.modal},exports.baseLocation=function(){return _globals.baseLocation},exports.isDvlpMode=function(){return _globals.isDvlpMode},exports.isAutoUITestMode=function(){return _globals.unitTestMode===!0},exports.getUnitTestMgr=function(){return _globals.unitTestMgr},exports.setUnitTestMgr=function(mgr){_globals.unitTestMgr=mgr},exports.getDvlpOpt=function(name){return _globals.isDvlpMode&&_devOpts[name]},exports.isTestEnvironment=function(){return _globals.isTestEnvironment},exports.setLookAndFeel=function(lookAndFeel){uiSettings.init(lookAndFeel),_globals.lookAndFeel=lookAndFeel},exports.getLookAndFeel=function(){return _globals.lookAndFeel},exports.getSiteLayout=function(){return _globals.siteLayout},exports.setSiteLayout=function(sl){_globals.siteLayout=sl},exports.isSmartphone=function(){return _globals.siteLayout.getDeviceType()==="smartphone"},exports.isTablet=function(){return _globals.siteLayout.getDeviceType()==="tablet"},exports.setMetaData=function(metaData){_metaData=metaData},exports.getMetaData=function(){return _metaData},exports.setOfflineManager=function(olm){_globals.offlineManager=olm},exports.setOffline=function(offline,notif,byGlobalEvent){if(!_globals.offlineManager)return;_globals.offlineManager.setOffline(offline,notif,byGlobalEvent)},exports.setOfflineQuiet=function(offline){if(!_globals.offlineManager)return;_globals.offlineManager.setOfflineQuiet(offline)},exports.isOnline=function(){return _globals.offlineManager?_globals.offlineManager.isOnline():navigator.onLine},exports.addController=function(c){if(!c)return;_controllersMap||(_controllersMap={});if(_controllersMap[c.id])throw new Error("Controller already exists ["+c.id+"]");return _controllersMap[c.id]=c,c},exports.removeController=function(c){if(!c||!_controllersMap)return;return delete _controllersMap[c.id],c},exports.getController=function(id){return!id||!_controllersMap?null:_controllersMap[id]},exports.setAuthoringActive=function(status){_authoringActive=status},exports.isAuthoringActive=function(){return _authoringActive},exports.ROWIDXPROP="~ROWIDX~",exports.SINGLEARRAYPROP="~data~",exports.ACTROWDETAIL="rowDetail",exports.ACTCHARTDETAIL="chartDetail",exports.ACTCARDDESIGN="cardDesign",exports.ACTROWDEL="rowDelete",exports.ACTROWSEL="rowSelect",exports.RECORDCLASS="s-m-record",exports.ACTMULTISEL="multiSelection",exports.PANELACTIONSREGULAR="panelactionregular",exports.PANELPAGESHARE="panelpagesetting",exports.PANELUSERSMARTPHONE="panelusersmartphone",exports.PANELFILTERSORT="panelfiltersort",exports.PANELEDITTEMPLATES="paneledittemplates",exports.PANELDASHBOARDTEMPLATES="panelpagedashboardtemplates",exports.EXCLUDEFIELDS=["CREUSR","CREUSR_REF","UPDUSR","UPDUSR_REF"],exports.CELLDEFCOLOR="darkgrey",exports.TILEDEFCOLOR="darkgrey",exports.CARDARRAYDEFCOLOR="darkgrey",exports.CELLENABLEDCOLOR="green",exports.OFFLINEQUERYCOUNT=30,exports.XREF_DESCRPOS_TABLE="bottom",exports.init=_init,window&&(window.$sm=exports),exports.X3_SEVERITY_TO_BS={info:"success",warning:"warning",error:"error"},exports.getBuildTimeStamp=function(){return window.__sageBuildTimestamp?window.__sageBuildTimestamp():"dev mode"};var _globalSettings={"device-type":"auto"};exports.setGlobalSettings=function(settings){_globalSettings=settings},exports.getGlobalSettings=function(){return _globalSettings};var _needToCheckAppsList=!0;exports.needToCheckAppsList=function(){return _needToCheckAppsList},exports.setNeedToCheckAppsList=function(state){_needToCheckAppsList=state}}),define("syracuse-tablet/html/js/helpers/locale",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/ajax/ajax"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),ajax=require("syracuse-tablet/html/js/ajax/ajax").getAjax().ajax,_currentLocale=null,_resources={},_datetimeInformationKey="$datetimeInformation",_decimalInformationKey="$decimalInformation",_upLocalePreferences,_txtRegexp=/\{([\w-]+)\}/g,_localeHashUser="*",_userProfileSettings={},_text=function(key,args){var resources=_resources&&_resources[_currentLocale];if(!resources)return;var text=resources[key]||"Resource key not found["+key+"]";return args&&(Array.isArray(args)||(args=Array.prototype.slice.call(arguments,1)),text=text.replace(_txtRegexp,function(match,p1){var idx=+p1;return idx>=0&&idx<args.length?args[idx]:"?"})),text},_textNoFail=function(key,args){var resources=_resources&&_resources[_currentLocale];if(!resources||!resources[key])return null;var text=resources[key];return args&&(Array.isArray(args)||(args=Array.prototype.slice.call(arguments,1)),text=text.replace(_txtRegexp,function(match,p1){var idx=+p1;return idx>=0&&idx<args.length?args[idx]:"?"})),text},_textOpt=function(key){var resources=_resources&&_resources[_currentLocale];if(!resources)return;return resources[key]},_getDatetimeInfo=function(){var resources=_resources&&_resources[_currentLocale];if(!resources)return;return resources[_datetimeInformationKey]},_getDecimalInfo=function(){var resources=_resources&&_resources[_currentLocale];if(!resources)return;return resources[_decimalInformationKey]},_setLocale=function(locale,upLocalePreferences){var deferred=new $.Deferred;_upLocalePreferences=upLocalePreferences;var ctx=globals.getUserCtx();_localeHashUser=ctx&&ctx.$user||"*",_userProfileSettings=globals.getUserProfileLocale(locale)||{};var resources=_resources&&_resources[locale];if(resources)_currentLocale=locale,deferred.resolve();else if(locale===_currentLocale)deferred.resolve();else{var rsrcPath=jsutils.getResourcesBasePath();_loadFile(rsrcPath+"js/resources","strings",locale,"en").then(function(data){_currentLocale=locale,_resources[locale]=data}).then(function(){return _loadFile(rsrcPath+"js/resources/locales","date",locale,"en-GB")}).then(function(data){_resources[locale][_datetimeInformationKey]=data}).then(function(){return _loadFile(rsrcPath+"js/resources/locales","decimal",locale,"en-GB")}).then(function(data){_resources[locale][_decimalInformationKey]=data}).then(function(){deferred.resolve()}).fail(function(e){deferred.resolve()})}return deferred.promise()},_loadFile=function(path,file,locale,defLocale){function _load(){if(segs.length===0){var url=path+"/"+file+"-"+defLocale+".json";ajax("GET",url,null,null).then(function(data){data&&data.responseJSON&&deferred.resolve(data.responseJSON),deferred.resolve({})}).fail(function(e){deferred.reject(e)})}else{var code=segs.join("-"),url=path+"/"+file+"-"+code+".json";ajax("GET",url,null,null).then(function(data){if(data&&data.responseJSON){if(code!==defLocale){url=path+"/"+file+"-"+defLocale+".json",ajax("GET",url,null,null).then(function(dataEn){if(dataEn&&dataEn.responseJSON){var mergedStrings=$.extend(!0,{},dataEn.responseJSON,data.responseJSON);deferred.resolve(mergedStrings)}else deferred.resolve(data.responseJSON)}).fail(function(e){deferred.resolve(data.responseJSON)});return}deferred.resolve(data.responseJSON)}else segs.pop(),_load()}).fail(function(e){segs.pop(),_load()})}}var deferred=new $.Deferred,segs=locale.split("-"),loadedLocale;return _load(),deferred.promise()},_isCurrent=function(locale,strict){return!locale||!_currentLocale?!1:_currentLocale===locale?!0:strict?!1:locale.split("-")[0]===_currentLocale};exports.getDateFormat=function(){var di=_getDatetimeInfo();return _userProfileSettings.shortDate||di&&di.formatPatterns&&di.formatPatterns.shortDate||"dd/MM/yyyy"},exports.getDateTimeFormat=function(){var di=_getDatetimeInfo(),date=_userProfileSettings.shortDate||di&&di.formatPatterns&&di.formatPatterns.shortDate||"dd/MM/yyyy",time=_userProfileSettings.shortTime||di&&di.formatPatterns&&di.formatPatterns.shortTime||"HH:mm:ss";return date+" "+time},exports.getTimeFormat=function(){var di=_getDatetimeInfo();return _userProfileSettings.longTime||di&&di.formatPatterns&&di.formatPatterns.longTime||"HH:mm:ss"},exports.getTimeFormatShort=function(){var di=_getDatetimeInfo();return _userProfileSettings.shortTime||di&&di.formatPatterns&&di.formatPatterns.shortTime||"HH:mm"},exports.getNumberFormat=function(type){return type==="application/x-integer"?"#,##0":"#,##0.##"},exports.getNumberGroupSeparator=function(){var di=_getDecimalInfo(),gs=_userProfileSettings.numberGroupSeparator||di&&di.numberGroupSeparator||",";return gs},exports.getNumberDecimalSeparator=function(){var di=_getDecimalInfo(),ds=_userProfileSettings.numberDecimalSeparator||di&&di.numberDecimalSeparator||".";return ds},exports.setLocale=_setLocale,exports.text=_text,exports.textNoFail=_textNoFail,exports.textOpt=_textOpt,exports.isCurrent=_isCurrent,exports.getDatetimeInfo=_getDatetimeInfo,exports.getCurrentLocale=function(){return _currentLocale},exports.getCurrentLocaleHash=function(){return _currentLocale+"#"+_localeHashUser},exports.getProductLabels=function(){var data={};return data.brand=exports.text("global.label.brand"),data.product=exports.text("global.label.product"),data}}),define("syracuse-tablet/html/js/ui/rect",["require","exports","module","syracuse-tablet/html/js/helpers/utils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),_Klass=utils.defineClass(function rect(top,left,height,width){this.top=top,this.left=left,this.setHeight(height),this.setWidth(width)},null,{isPointInside:function(x,y){return(x==null||x>=this.left&&x<=this.right)&&(y==null||y>=this.top&&y<=this.bottom)},isEvtInside:function(evt,rectOffset){if(evt.type.smStartsWith("touch"))if(evt.changedTouches&&evt.changedTouches.length===1)evt=evt.changedTouches[0];else{if(!evt.touches||evt.touches.length!==1)return!0;evt=evt.touches[0]}var y=rectOffset!=null&&rectOffset.top!=null?evt.pageY-rectOffset.top:evt.pageY,x=rectOffset!=null&&rectOffset.left!=null?evt.pageX-rectOffset.left:evt.pageX;return this.isPointInside(x,y)},intersectsWith:function(rect){return this.left<=rect.right&&rect.left<this.right&&this.top<rect.bottom&&rect.top<this.bottom},contains:function(rect){return rect==null?!0:this.isPointInside(rect.left,rect.top)&&this.isPointInside(rect.right,rect.bottom)},equals:function(rect,justSize){return rect.width===this.width&&rect.height===this.height?justSize===!0||rect.top===this.top&&rect.left===this.left:!1},intersectRect:function(rect,relative){if(!this.intersectsWith(rect))return null;var top=Math.max(this.top,rect.top),left=Math.max(this.left,rect.left),right=Math.min(this.right,rect.right),bottom=Math.min(this.bottom,rect.bottom);return new _Klass(relative?0:top,relative?0:left,bottom-top,right-left)},setHeight:function(h){this.height=Math.max(h,0),this.bottom=this.top+this.height},setWidth:function(w){this.width=Math.max(w,0),this.right=this.left+this.width},moveLeft:function(l){this.left=this.left+l,this.right=this.width+this.left},toString:function(){return"t:"+this.top+" l:"+this.left+" r:"+this.right+" b:"+this.bottom+" h:"+this.height+" w:"+this.width},toRelative:function(offet){return offet==null&&(offet={}),offet.top==null&&(offet.top=0),offet.left==null&&(offet.left=0),new _Klass(offet.top,offet.left,this.height,this.width)},showInDocument:function(options){options=options||{};var pos="fixed",$$parent=$(document.body),$$elmt=$('<div class = "s-m-rect">').appendTo($$parent).css({position:pos,top:this.top+"px",left:this.left+"px",height:this.height+"px",width:this.width+"px",backgroundColor:options.color,zIndex:options.zIndex!=null?options.zIndex:undefined});return options.timeout!=null&&setTimeout(function(){$$elmt.remove()},options.timeout),$$elmt},clone:function(){return new _Klass(this.top,this.left,this.height,this.width)},applyTransformScale:function(scale,clone){if(scale==null||scale<=0||typeof scale!="number")return;var res=clone===!0?this.clone():this;return res.width=res.width*scale,res.height=res.height*scale,res}}),_meths={outer:["outerWidth","outerHeight"],inner:["innerWidth","innerHeight"],computed:["width","height"],fixed:"position",relative:"offset"};exports.elmtRect=function($$elmt,typeRect,position){var o=$$elmt[_meths[position||"relative"]](),m=_meths[typeRect||"outer"];return new _Klass(o.top,o.left,$$elmt[m[1]](),$$elmt[m[0]]())},exports.newRect=function(top,left,height,width){return new _Klass(top,left,height,width)}}),function(window,document,exportName,undefined){function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout)}function invokeArrayArg(arg,fn,context){return Array.isArray(arg)?(each(arg,context[fn],context),!0):!1}function each(obj,iterator,context){var i;if(!obj)return;if(obj.forEach)obj.forEach(iterator,context);else if(obj.length!==undefined){i=0;while(i<obj.length)iterator.call(context,obj[i],i,obj),i++}else for(i in obj)obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}function extend(dest,src,merge){var keys=Object.keys(src),i=0;while(i<keys.length){if(!merge||merge&&dest[keys[i]]===undefined)dest[keys[i]]=src[keys[i]];i++}return dest}function merge(dest,src){return extend(dest,src,!0)}function inherit(child,base,properties){var baseP=base.prototype,childP;childP=child.prototype=Object.create(baseP),childP.constructor=child,childP._super=baseP,properties&&extend(childP,properties)}function bindFn(fn,context){return function boundFn(){return fn.apply(context,arguments)}}function boolOrFn(val,args){return typeof val==TYPE_FUNCTION?val.apply(args?args[0]||undefined:undefined,args):val}function ifUndefined(val1,val2){return val1===undefined?val2:val1}function addEventListeners(target,types,handler){each(splitStr(types),function(type){target.addEventListener(type,handler,!1)})}function removeEventListeners(target,types,handler){each(splitStr(types),function(type){target.removeEventListener(type,handler,!1)})}function hasParent(node,parent){while(node){if(node==parent)return!0;node=node.parentNode}return!1}function inStr(str,find){return str.indexOf(find)>-1}function splitStr(str){return str.trim().split(/\s+/g)}function inArray(src,find,findByKey){if(src.indexOf&&!findByKey)return src.indexOf(find);var i=0;while(i<src.length){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find)return i;i++}return-1}function toArray(obj){return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){var results=[],values=[],i=0;while(i<src.length){var val=key?src[i][key]:src[i];inArray(values,val)<0&&results.push(src[i]),values[i]=val,i++}return sort&&(key?results=results.sort(function sortUniqueArray(a,b){return a[key]>b[key]}):results=results.sort()),results}function prefixed(obj,property){var prefix,prop,camelProp=property[0].toUpperCase()+property.slice(1),i=0;while(i<VENDOR_PREFIXES.length){prefix=VENDOR_PREFIXES[i],prop=prefix?prefix+camelProp:property;if(prop in obj)return prop;i++}return undefined}function uniqueId(){return _uniqueId++}function getWindowForElement(element){var doc=element.ownerDocument;return doc.defaultView||doc.parentWindow}function Input(manager,callback){var self=this;this.manager=manager,this.callback=callback,this.element=manager.element,this.target=manager.options.inputTarget,this.domHandler=function(ev){boolOrFn(manager.options.enable,[manager])&&self.handler(ev)},this.init()}function createInputInstance(manager){var Type,inputClass=manager.options.inputClass;return inputClass?Type=inputClass:SUPPORT_POINTER_EVENTS?Type=PointerEventInput:SUPPORT_ONLY_TOUCH?Type=TouchInput:SUPPORT_TOUCH?Type=TouchMouseInput:Type=MouseInput,new Type(manager,inputHandler)}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length,changedPointersLen=input.changedPointers.length,isFirst=eventType&INPUT_START&&pointersLen-changedPointersLen===0,isFinal=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen===0;input.isFirst=!!isFirst,input.isFinal=!!isFinal,isFirst&&(manager.session={}),input.eventType=eventType,computeInputData(manager,input),manager.emit("hammer.input",input),manager.recognize(input),manager.session.prevInput=input}function computeInputData(manager,input){var session=manager.session,pointers=input.pointers,pointersLength=pointers.length;session.firstInput||(session.firstInput=simpleCloneInputData(input)),pointersLength>1&&!session.firstMultiple?session.firstMultiple=simpleCloneInputData(input):pointersLength===1&&(session.firstMultiple=!1);var firstInput=session.firstInput,firstMultiple=session.firstMultiple,offsetCenter=firstMultiple?firstMultiple.center:firstInput.center,center=input.center=getCenter(pointers);input.timeStamp=now(),input.deltaTime=input.timeStamp-firstInput.timeStamp,input.angle=getAngle(offsetCenter,center),input.distance=getDistance(offsetCenter,center),computeDeltaXY(session,input),input.offsetDirection=getDirection(input.deltaX,input.deltaY),input.scale=firstMultiple?getScale(firstMultiple.pointers,pointers):1,input.rotation=firstMultiple?getRotation(firstMultiple.pointers,pointers):0,computeIntervalInputData(session,input);var target=manager.element;hasParent(input.srcEvent.target,target)&&(target=input.srcEvent.target),input.target=target}function computeDeltaXY(session,input){var center=input.center,offset=session.offsetDelta||{},prevDelta=session.prevDelta||{},prevInput=session.prevInput||{};if(input.eventType===INPUT_START||prevInput.eventType===INPUT_END)prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0},offset=session.offsetDelta={x:center.x,y:center.y};input.deltaX=prevDelta.x+(center.x-offset.x),input.deltaY=prevDelta.y+(center.y-offset.y)}function computeIntervalInputData(session,input){var last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp,velocity,velocityX,velocityY,direction;if(input.eventType!=INPUT_CANCEL&&(deltaTime>COMPUTE_INTERVAL||last.velocity===undefined)){var deltaX=last.deltaX-input.deltaX,deltaY=last.deltaY-input.deltaY,v=getVelocity(deltaTime,deltaX,deltaY);velocityX=v.x,velocityY=v.y,velocity=abs(v.x)>abs(v.y)?v.x:v.y,direction=getDirection(deltaX,deltaY),session.lastInterval=input}else velocity=last.velocity,velocityX=last.velocityX,velocityY=last.velocityY,direction=last.direction;input.velocity=velocity,input.velocityX=velocityX,input.velocityY=velocityY,input.direction=direction}function simpleCloneInputData(input){var pointers=[],i=0;while(i<input.pointers.length)pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)},i++;return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getCenter(pointers){var pointersLength=pointers.length;if(pointersLength===1)return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)};var x=0,y=0,i=0;while(i<pointersLength)x+=pointers[i].clientX,y+=pointers[i].clientY,i++;return{x:round(x/pointersLength),y:round(y/pointersLength)}}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function getDirection(x,y){return x===y?DIRECTION_NONE:abs(x)>=abs(y)?x>0?DIRECTION_LEFT:DIRECTION_RIGHT:y>0?DIRECTION_UP:DIRECTION_DOWN}function getDistance(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y)}function getAngle(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.atan2(y,x)*180/Math.PI}function getRotation(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)-getAngle(start[1],start[0],PROPS_CLIENT_XY)}function getScale(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY)}function MouseInput(){this.evEl=MOUSE_ELEMENT_EVENTS,this.evWin=MOUSE_WINDOW_EVENTS,this.allow=!0,this.pressed=!1,Input.apply(this,arguments)}function PointerEventInput(){this.evEl=POINTER_ELEMENT_EVENTS,this.evWin=POINTER_WINDOW_EVENTS,Input.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function SingleTouchInput(){this.evTarget=SINGLE_TOUCH_TARGET_EVENTS,this.evWin=SINGLE_TOUCH_WINDOW_EVENTS,this.started=!1,Input.apply(this,arguments)}function normalizeSingleTouches(ev,type){var all=toArray(ev.touches),changed=toArray(ev.changedTouches);return type&(INPUT_END|INPUT_CANCEL)&&(all=uniqueArray(all.concat(changed),"identifier",!0)),[all,changed]}function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS,this.targetIds={},Input.apply(this,arguments)}function getTouches(ev,type){var allTouches=toArray(ev.touches),targetIds=this.targetIds;if(type&(INPUT_START|INPUT_MOVE)&&allTouches.length===1)return targetIds[allTouches[0].identifier]=!0,[allTouches,allTouches];var i,targetTouches,changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;targetTouches=allTouches.filter(function(touch){return hasParent(touch.target,target)});if(type===INPUT_START){i=0;while(i<targetTouches.length)targetIds[targetTouches[i].identifier]=!0,i++}i=0;while(i<changedTouches.length)targetIds[changedTouches[i].identifier]&&changedTargetTouches.push(changedTouches[i]),type&(INPUT_END|INPUT_CANCEL)&&delete targetIds[changedTouches[i].identifier],i++;if(!changedTargetTouches.length)return;return[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",!0),changedTargetTouches]}function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler),this.mouse=new MouseInput(this.manager,handler)}function TouchAction(manager,value){this.manager=manager,this.set(value)}function cleanTouchActions(actions){if(inStr(actions,TOUCH_ACTION_NONE))return TOUCH_ACTION_NONE;var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X),hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);return hasPanX&&hasPanY?TOUCH_ACTION_PAN_X+" "+TOUCH_ACTION_PAN_Y:hasPanX||hasPanY?hasPanX?TOUCH_ACTION_PAN_X:TOUCH_ACTION_PAN_Y:inStr(actions,TOUCH_ACTION_MANIPULATION)?TOUCH_ACTION_MANIPULATION:TOUCH_ACTION_AUTO}function Recognizer(options){this.id=uniqueId(),this.manager=null,this.options=merge(options||{},this.defaults),this.options.enable=ifUndefined(this.options.enable,!0),this.state=STATE_POSSIBLE,this.simultaneous={},this.requireFail=[]}function stateStr(state){return state&STATE_CANCELLED?"cancel":state&STATE_ENDED?"end":state&STATE_CHANGED?"move":state&STATE_BEGAN?"start":""}function directionStr(direction){return direction==DIRECTION_DOWN?"down":direction==DIRECTION_UP?"up":direction==DIRECTION_LEFT?"left":direction==DIRECTION_RIGHT?"right":""}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;return manager?manager.get(otherRecognizer):otherRecognizer}function AttrRecognizer(){Recognizer.apply(this,arguments)}function PanRecognizer(){AttrRecognizer.apply(this,arguments),this.pX=null,this.pY=null}function PinchRecognizer(){AttrRecognizer.apply(this,arguments)}function PressRecognizer(){Recognizer.apply(this,arguments),this._timer=null,this._input=null}function RotateRecognizer(){AttrRecognizer.apply(this,arguments)}function SwipeRecognizer(){AttrRecognizer.apply(this,arguments)}function TapRecognizer(){Recognizer.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Hammer(element,options){return options=options||{},options.recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset),new Manager(element,options)}function Manager(element,options){options=options||{},this.options=merge(options,Hammer.defaults),this.options.inputTarget=this.options.inputTarget||element,this.handlers={},this.session={},this.recognizers=[],this.element=element,this.input=createInputInstance(this),this.touchAction=new TouchAction(this,this.options.touchAction),toggleCssProps(this,!0),each(options.recognizers,function(item){var recognizer=this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]),item[3]&&recognizer.requireFailure(item[3])},this)}function toggleCssProps(manager,add){var element=manager.element;each(manager.options.cssProps,function(value,name){element.style[prefixed(element.style,name)]=add?value:""})}function triggerDomEvent(event,data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,!0,!0),gestureEvent.gesture=data,data.target.dispatchEvent(gestureEvent)}var VENDOR_PREFIXES=["","webkit","moz","MS","ms","o"],TEST_ELEMENT=document.createElement("div"),TYPE_FUNCTION="function",round=Math.round,abs=Math.abs,now=Date.now,_uniqueId=1,MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i,SUPPORT_TOUCH="ontouchstart"in window,SUPPORT_POINTER_EVENTS=prefixed(window,"PointerEvent")!==undefined,SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&MOBILE_REGEX.test(navigator.userAgent),INPUT_TYPE_TOUCH="touch",INPUT_TYPE_PEN="pen",INPUT_TYPE_MOUSE="mouse",INPUT_TYPE_KINECT="kinect",COMPUTE_INTERVAL=25,INPUT_START=1,INPUT_MOVE=2,INPUT_END=4,INPUT_CANCEL=8,DIRECTION_NONE=1,DIRECTION_LEFT=2,DIRECTION_RIGHT=4,DIRECTION_UP=8,DIRECTION_DOWN=16,DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT,DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN,DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,PROPS_XY=["x","y"],PROPS_CLIENT_XY=["clientX","clientY"];Input.prototype={handler:function(){},init:function(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)}};var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:INPUT_MOVE,mouseup:INPUT_END},MOUSE_ELEMENT_EVENTS="mousedown",MOUSE_WINDOW_EVENTS="mousemove mouseup";inherit(MouseInput,Input,{handler:function MEhandler(ev){var eventType=MOUSE_INPUT_MAP[ev.type];eventType&INPUT_START&&ev.button===0&&(this.pressed=!0),eventType&INPUT_MOVE&&ev.which!==1&&(eventType=INPUT_END);if(!this.pressed||!this.allow)return;eventType&INPUT_END&&(this.pressed=!1),this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:INPUT_TYPE_MOUSE,srcEvent:ev})}});var POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:INPUT_MOVE,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL},IE10_POINTER_TYPE_ENUM={2:INPUT_TYPE_TOUCH,3:INPUT_TYPE_PEN,4:INPUT_TYPE_MOUSE,5:INPUT_TYPE_KINECT},POINTER_ELEMENT_EVENTS="pointerdown",POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";window.MSPointerEvent&&(POINTER_ELEMENT_EVENTS="MSPointerDown",POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel"),inherit(PointerEventInput,Input,{handler:function PEhandler(ev){var store=this.store,removePointer=!1,eventTypeNormalized=ev.type.toLowerCase().replace("ms",""),eventType=POINTER_INPUT_MAP[eventTypeNormalized],pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType,isTouch=pointerType==INPUT_TYPE_TOUCH,storeIndex=inArray(store,ev.pointerId,"pointerId");eventType&INPUT_START&&(ev.button===0||isTouch)?storeIndex<0&&(store.push(ev),storeIndex=store.length-1):eventType&(INPUT_END|INPUT_CANCEL)&&(removePointer=!0);if(storeIndex<0)return;store[storeIndex]=ev,this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev}),removePointer&&store.splice(storeIndex,1)}});var SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL},SINGLE_TOUCH_TARGET_EVENTS="touchstart",SINGLE_TOUCH_WINDOW_EVENTS="touchstart touchmove touchend touchcancel";inherit(SingleTouchInput,Input,{handler:function TEhandler(ev){var type=SINGLE_TOUCH_INPUT_MAP[ev.type];type===INPUT_START&&(this.started=!0);if(!this.started)return;var touches=normalizeSingleTouches.call(this,ev,type);type&(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length===0&&(this.started=!1),this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}});var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL},TOUCH_TARGET_EVENTS="touchstart touchmove touchend touchcancel";inherit(TouchInput,Input,{handler:function MTEhandler(ev){var type=TOUCH_INPUT_MAP[ev.type],touches=getTouches.call(this,ev,type);if(!touches)return;this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}}),inherit(TouchMouseInput,Input,{handler:function TMEhandler(manager,inputEvent,inputData){var isTouch=inputData.pointerType==INPUT_TYPE_TOUCH,isMouse=inputData.pointerType==INPUT_TYPE_MOUSE;if(isTouch)this.mouse.allow=!1;else if(isMouse&&!this.mouse.allow)return;inputEvent&(INPUT_END|INPUT_CANCEL)&&(this.mouse.allow=!0),this.callback(manager,inputEvent,inputData)},destroy:function destroy(){this.touch.destroy(),this.mouse.destroy()}});var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction"),NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined,TOUCH_ACTION_COMPUTE="compute",TOUCH_ACTION_AUTO="auto",TOUCH_ACTION_MANIPULATION="manipulation",TOUCH_ACTION_NONE="none",TOUCH_ACTION_PAN_X="pan-x",TOUCH_ACTION_PAN_Y="pan-y";TouchAction.prototype={set:function(value){value==TOUCH_ACTION_COMPUTE&&(value=this.compute()),NATIVE_TOUCH_ACTION&&(this.manager.element.style[PREFIXED_TOUCH_ACTION]=value),this.actions=value.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var actions=[];return each(this.manager.recognizers,function(recognizer){boolOrFn(recognizer.options.enable,[recognizer])&&(actions=actions.concat(recognizer.getTouchAction()))}),cleanTouchActions(actions.join(" "))},preventDefaults:function(input){if(NATIVE_TOUCH_ACTION)return;var srcEvent=input.srcEvent,direction=input.offsetDirection;if(this.manager.session.prevented){srcEvent.preventDefault();return}var actions=this.actions,hasNone=inStr(actions,TOUCH_ACTION_NONE),hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y),hasPanX=inStr(actions,TOUCH_ACTION_PAN_X);if(hasNone||hasPanY&&direction&DIRECTION_HORIZONTAL||hasPanX&&direction&DIRECTION_VERTICAL)return this.preventSrc(srcEvent)},preventSrc:function(srcEvent){this.manager.session.prevented=!0,srcEvent.preventDefault()}};var STATE_POSSIBLE=1,STATE_BEGAN=2,STATE_CHANGED=4,STATE_ENDED=8,STATE_RECOGNIZED=STATE_ENDED,STATE_CANCELLED=16,STATE_FAILED=32;Recognizer.prototype={defaults:{},set:function(options){return extend(this.options,options),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"recognizeWith",this))return this;var simultaneous=this.simultaneous;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),simultaneous[otherRecognizer.id]||(simultaneous[otherRecognizer.id]=otherRecognizer,otherRecognizer.recognizeWith(this)),this},dropRecognizeWith:function(otherRecognizer){return invokeArrayArg(otherRecognizer,"dropRecognizeWith",this)?this:(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),delete this.simultaneous[otherRecognizer.id],this)},requireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this))return this;var requireFail=this.requireFail;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),inArray(requireFail,otherRecognizer)===-1&&(requireFail.push(otherRecognizer),otherRecognizer.requireFailure(this)),this},dropRequireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this))return this;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);return index>-1&&this.requireFail.splice(index,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]},emit:function(input){function emit(withState){self.manager.emit(self.options.event+(withState?stateStr(state):""),input)}var self=this,state=this.state;state<STATE_ENDED&&emit(!0),emit(),state>=STATE_ENDED&&emit(!0)},tryEmit:function(input){if(this.canEmit())return this.emit(input);this.state=STATE_FAILED},canEmit:function(){var i=0;while(i<this.requireFail.length){if(!(this.requireFail[i].state&(STATE_FAILED|STATE_POSSIBLE)))return!1;i++}return!0},recognize:function(inputData){var inputDataClone=extend({},inputData);if(!boolOrFn(this.options.enable,[this,inputDataClone])){this.reset(),this.state=STATE_FAILED;return}this.state&(STATE_RECOGNIZED|STATE_CANCELLED|STATE_FAILED)&&(this.state=STATE_POSSIBLE),this.state=this.process(inputDataClone),this.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED|STATE_CANCELLED)&&this.tryEmit(inputDataClone)},process:function(inputData){},getTouchAction:function(){},reset:function(){}},inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function(input){var optionPointers=this.options.pointers;return optionPointers===0||input.pointers.length===optionPointers},process:function(input){var state=this.state,eventType=input.eventType,isRecognized=state&(STATE_BEGAN|STATE_CHANGED),isValid=this.attrTest(input);if(isRecognized&&(eventType&INPUT_CANCEL||!isValid))return state|STATE_CANCELLED;if(isRecognized||isValid)return eventType&INPUT_END?state|STATE_ENDED:state&STATE_BEGAN?state|STATE_CHANGED:STATE_BEGAN;return STATE_FAILED}}),inherit(PanRecognizer,AttrRecognizer,{defaults:{event:"pan",threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function(){var direction=this.options.direction,actions=[];return direction&DIRECTION_HORIZONTAL&&actions.push(TOUCH_ACTION_PAN_Y),direction&DIRECTION_VERTICAL&&actions.push(TOUCH_ACTION_PAN_X),actions},directionTest:function(input){var options=this.options,hasMoved=!0,distance=input.distance,direction=input.direction,x=input.deltaX,y=input.deltaY;return direction&options.direction||(options.direction&DIRECTION_HORIZONTAL?(direction=x===0?DIRECTION_NONE:x<0?DIRECTION_LEFT:DIRECTION_RIGHT,hasMoved=x!=this.pX,distance=Math.abs(input.deltaX)):(direction=y===0?DIRECTION_NONE:y<0?DIRECTION_UP:DIRECTION_DOWN,hasMoved=y!=this.pY,distance=Math.abs(input.deltaY))),input.direction=direction,hasMoved&&distance>options.threshold&&direction&options.direction},attrTest:function(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(this.state&STATE_BEGAN||!(this.state&STATE_BEGAN)&&this.directionTest(input))},emit:function(input){this.pX=input.deltaX,this.pY=input.deltaY;var direction=directionStr(input.direction);direction&&this.manager.emit(this.options.event+direction,input),this._super.emit.call(this,input)}}),inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||this.state&STATE_BEGAN)},emit:function(input){this._super.emit.call(this,input);if(input.scale!==1){var inOut=input.scale<1?"in":"out";this.manager.emit(this.options.event+inOut,input)}}}),inherit(PressRecognizer,Recognizer,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[TOUCH_ACTION_AUTO]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTime=input.deltaTime>options.time;this._input=input;if(!validMovement||!validPointers||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime)this.reset();else if(input.eventType&INPUT_START)this.reset(),this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit()},options.time,this);else if(input.eventType&INPUT_END)return STATE_RECOGNIZED;return STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(input){if(this.state!==STATE_RECOGNIZED)return;input&&input.eventType&INPUT_END?this.manager.emit(this.options.event+"up",input):(this._input.timeStamp=now(),this.manager.emit(this.options.event,this._input))}}),inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||this.state&STATE_BEGAN)}}),inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function(){return PanRecognizer.prototype.getTouchAction.call(this)},attrTest:function(input){var direction=this.options.direction,velocity;return direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL)?velocity=input.velocity:direction&DIRECTION_HORIZONTAL?velocity=input.velocityX:direction&DIRECTION_VERTICAL&&(velocity=input.velocityY),this._super.attrTest.call(this,input)&&direction&input.direction&&input.distance>this.options.threshold&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END},emit:function(input){var direction=directionStr(input.direction);direction&&this.manager.emit(this.options.event+direction,input),this.manager.emit(this.options.event,input)}}),inherit(TapRecognizer,Recognizer,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[TOUCH_ACTION_MANIPULATION]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTouchTime=input.deltaTime<options.time;this.reset();if(input.eventType&INPUT_START&&this.count===0)return this.failTimeout();if(validMovement&&validTouchTime&&validPointers){if(input.eventType!=INPUT_END)return this.failTimeout();var validInterval=this.pTime?input.timeStamp-this.pTime<options.interval:!0,validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;this.pTime=input.timeStamp,this.pCenter=input.center,!validMultiTap||!validInterval?this.count=1:this.count+=1,this._input=input;var tapCount=this.count%options.taps;if(tapCount===0)return this.hasRequireFailures()?(this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit()},options.interval,this),STATE_BEGAN):STATE_RECOGNIZED}return STATE_FAILED},failTimeout:function(){return this._timer=setTimeoutContext(function(){this.state=STATE_FAILED},this.options.interval,this),STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==STATE_RECOGNIZED&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Hammer.VERSION="2.0.4",Hammer.defaults={domEvents:!1,touchAction:TOUCH_ACTION_COMPUTE,enable:!0,inputTarget:null,inputClass:null,preset:[[RotateRecognizer,{enable:!1}],[PinchRecognizer,{enable:!1},["rotate"]],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var STOP=1,FORCED_STOP=2;Manager.prototype={set:function(options){return extend(this.options,options),options.touchAction&&this.touchAction.update(),options.inputTarget&&(this.input.destroy(),this.input.target=options.inputTarget,this.input.init()),this},stop:function(force){this.session.stopped=force?FORCED_STOP:STOP},recognize:function(inputData){var session=this.session;if(session.stopped)return;this.touchAction.preventDefaults(inputData);var recognizer,recognizers=this.recognizers,curRecognizer=session.curRecognizer;if(!curRecognizer||curRecognizer&&curRecognizer.state&STATE_RECOGNIZED)curRecognizer=session.curRecognizer=null;var i=0;while(i<recognizers.length)recognizer=recognizers[i],session.stopped!==FORCED_STOP&&(!curRecognizer||recognizer==curRecognizer||recognizer.canRecognizeWith(curRecognizer))?recognizer.recognize(inputData):recognizer.reset(),!curRecognizer&&recognizer.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED)&&(curRecognizer=session.curRecognizer=recognizer),i++},get:function(recognizer){if(recognizer instanceof Recognizer)return recognizer;var recognizers=this.recognizers;for(var i=0;i<recognizers.length;i++)if(recognizers[i].options.event==recognizer)return recognizers[i];return null},add:function(recognizer){if(invokeArrayArg(recognizer,"add",this))return this;var existing=this.get(recognizer.options.event);return existing&&this.remove(existing),this.recognizers.push(recognizer),recognizer.manager=this,this.touchAction.update(),recognizer},remove:function(recognizer){if(invokeArrayArg(recognizer,"remove",this))return this;var recognizers=this.recognizers;return recognizer=this.get(recognizer),recognizers.splice(inArray(recognizers,recognizer),1),this.touchAction.update(),this},on:function(events,handler){var handlers=this.handlers;return each(splitStr(events),function(event){handlers[event]=handlers[event]||[],handlers[event].push(handler)}),this},off:function(events,handler){var handlers=this.handlers;return each(splitStr(events),function(event){handler?handlers[event].splice(inArray(handlers[event],handler),1):delete handlers[event]}),this},emit:function(event,data){this.options.domEvents&&triggerDomEvent(event,data);var handlers=this.handlers[event]&&this.handlers[event].slice();if(!handlers||!handlers.length)return;data.type=event,data.preventDefault=function(){data.srcEvent.preventDefault()};var i=0;while(i<handlers.length)handlers[i](data),i++},destroy:function(){this.element&&toggleCssProps(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},extend(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:INPUT_MOVE,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:STATE_BEGAN,STATE_CHANGED:STATE_CHANGED,STATE_ENDED:STATE_ENDED,STATE_RECOGNIZED:STATE_RECOGNIZED,STATE_CANCELLED:STATE_CANCELLED,STATE_FAILED:STATE_FAILED,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,inherit:inherit,bindFn:bindFn,prefixed:prefixed}),typeof define==TYPE_FUNCTION&&define.amd?define("syracuse-tablet/html/deps/hammerjs-2.0.4/hammer",[],function(){return Hammer}):typeof module!="undefined"&&module.exports?module.exports=Hammer:window[exportName]=Hammer}(window,document,"Hammer"),define("syracuse-tablet/html/js/helpers/scroller/scrollerBase",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/rect"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),uiRect=require("syracuse-tablet/html/js/ui/rect"),_scrolId=0,_Klass=utils.defineClass(function scroller($$elmt,options){this.options=options=$.extend(!0,{},options),this.name=options.name||"scroller-"+_scrolId++,this.$$elmt=$$elmt,this.isPageScroller=options.isPageScroller===!0,this._initDir(options.direction),this.scrollMax=options.valMax!=null?options.valMax:options.scrollMax!=null?options.scrollMax:0,this.restoredScroll=null},null,{destroy:function(){this.reset(),this.$$elmt=null},isNative:function(){return!1},_initDir:function(dir){if(dir==null){if(this.dir!=null)return;this.dir="v";return}this.dir=dir},init:function(viewRect,dir,scrollMax,preserveScroll){if(viewRect==null)throw new Error("Unexpected null viewRect");var scroll=this.getScroll();preserveScroll===!0&&this.restoredScroll==null&&scroll!=null&&scroll!==this.scrollMax&&(this.restoredScroll=scroll),this.reset(!0),this._initDir(dir),scrollMax!=null&&(this.scrollMax=scrollMax),this.viewRect=viewRect,this._doInit(viewRect,dir,scrollMax,preserveScroll);var refreshed=!1;preserveScroll===!0&&this.restoredScroll!=null&&(refreshed=this.adjust(this.restoredScroll)),refreshed||this._refresh(this.restoredScroll,!0),this.restoredScroll=null,this.$$elmt.removeClass("scrollDisabled").addClass("scrollEnabled")},_doInit:function(viewRect,dir,scrollMax,preserveScroll){throw new Error("Not implemented")},isInitialized:function(){return this.$$elmt!=null&&this.viewRect!=null},reset:function(dontResetValue){dontResetValue!==!0&&this._refresh(this.scrollMax),this.viewRect=null,this.$$elmt&&this.$$elmt.removeClass("scrollEnabled").addClass("scrollDisabled")},_refresh:function(scroll,force){throw new Error("Not implemented")},savedCtxCreate:function(){return{scroll:this.getScroll()}},savedCtxRestore:function(ctx,refresh){if(ctx==null||ctx.scroll==null)return;refresh&&this.isInitialized()?this._refresh(ctx.scroll):this.restoredScroll=ctx.scroll},getOffset:function(){return{top:this.dir=="v"?this.getScroll():0,left:this.dir=="h"?this.getScroll():0}},makeVisible:function($$e){throw new Error("Not implemented")},autoScroll:function(value){throw new Error("Not implemented")},getScroll:function(value){throw new Error("Not implemented")},getScrollMin:function(){throw new Error("Not implemented")},checkViewRect:function(viewRect,preserveScroll){var reset=!0;if(viewRect&&this.$$elmt){var val=this.getScroll();this._scrollToBeginning();var myRect=uiRect.elmtRect(this.$$elmt,"computed"),intersectRect=viewRect.intersectRect(myRect,!1);intersectRect!=null&&(preserveScroll&&(this.resoredVal=val),this.init(intersectRect,null,null),reset=!1,preserveScroll&&this.adjust())}reset&&this.reset()},_scrollToBeginning:function(){this._refresh(this.scrollMax)},adjust:function(restoredScroll){throw new Error("Not implemented")}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/helpers/scroller/hammerScroller",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/ui/rect","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/deps/hammerjs-2.0.4/hammer","syracuse-tablet/html/js/helpers/scroller/scrollerBase"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("scroll",!1),utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),uiRect=require("syracuse-tablet/html/js/ui/rect"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),Hammer=require("syracuse-tablet/html/deps/hammerjs-2.0.4/hammer"),Base=require("syracuse-tablet/html/js/helpers/scroller/scrollerBase").Klass,_isEvtDirection=function(evt,dir,forceTrueIfNull){if(evt==null)return forceTrueIfNull===!0;if(evt.angle==null)throw new Error("this is not a hammer.js event");return evt.angle>45&&evt.angle<135||evt.angle<-45&&evt.angle>-135?dir=="v":dir=="h"},_stopClickEvent=function(mgr,evt,reason){log&&log("Clicked canceled",reason,mgr.id),evt.stopPropagation(),evt.preventDefault(),evt.$stop=!0},_lastClickTO=400,_slowDown=!0,_slowDownTO=10,_velocityToDist=function(velocity){var v=Math.abs(Math.round(velocity*4));return Math.max(1,v*v/2)},_consts={pan:{v:"panup pandown panstart panend",h:"panleft panright panstart panend"},dir:{v:Hammer.DIRECTION_VERTICAL,h:Hammer.DIRECTION_HORIZONTAL},upEvt:{v:"panup",h:"panleft"}},_Klass=utils.defineClass(function HammerScroller($$elmt,options,parentMgr){options=options||{},Base.call(this,$$elmt,options),this.id=$$elmt.closest("[id]").attr("id"),this.parentMgr=parentMgr,this.hammer=new Hammer(this.$$elmt.get(0)),this._evtsEnabled=!1},Base,{init:function(viewRect,dir,scrollMax,preserveScroll){viewRect&&globals.getSiteLayout().getTransformScale()!=1&&(viewRect=viewRect.applyTransformScale(globals.getSiteLayout().getTransformScale(),!0)),Base.prototype.init.call(this,viewRect,dir,scrollMax,preserveScroll)},_initDir:function(dir){Base.prototype._initDir.call(this,dir),this.upEvtType=_consts.upEvt[this.dir]},_doInit:function(viewRect,dir,scrollMax,preserveScroll){this.hammer.get("pan").set({threshold:0,direction:_consts.dir[this.dir]}),this.hammer.get("press").set({time:1}),this._panHandler=Hammer.bindFn(this._onPan,this),this._pressHandler=Hammer.bindFn(this._onPress,this),this._clickHandler=Hammer.bindFn(this._onClick,this),this.$$elmt.on("click",this._clickHandler),this._originalRect=uiRect.elmtRect(this.$$elmt),this._originalScrollOffset=this.isPageScroller||!globals.getCurrentPage()?null:globals.getCurrentPage().getScrollOffset(),this._enableEvents(!0)},_enableEvents:function(yes){if(!this.hammer)return;var wasDisabled=this._evtsEnabled===!1;yes===!0&&this._evtsEnabled!==!0&&(this._evtsEnabled=!0,this.hammer.on(_consts.pan[this.dir],this._panHandler),this.hammer.on("press",this._pressHandler),this.$$elmt.addClass("s-m-scroll"+this.dir)),yes===!1&&this._evtsEnabled!==!1&&(this._evtsEnabled=!1,this.hammer&&(this.hammer.off(_consts.pan[this.dir],this._panHandler),this.hammer.off("press",this._pressHandler)),this.$$elmt.removeClass("s-m-scroll"+this.dir)),wasDisabled||(this.panStart=!1,this._stopSlowingDown(),this.cancelClick=!1,this.lastClickAllowed=null)},reset:function(dontResetValue){Base.prototype.reset.call(this,dontResetValue),this._enableEvents(!1),this.$$elmt&&this.$$elmt.off("click",this._clickHandler),this.panStart=!1,this._stopSlowingDown(),this.cancelClick=!1,this.lastClickAllowed=null,this.val=null,this.isLocked=!1},destroy:function(){Base.prototype.destroy.call(this),this.hammer&&(this.hammer.destroy(),this.hammer=null),this._panHandler=null,this._pressHandler=null,this._toggleRect(!1),this._clickHandler=null,notifications.unsubscribe(this)},_refresh:function(scroll,force){if(!this.$$elmt)return;this._setScroll(scroll),this.dir=="v"?this.$$elmt.css({top:this.getScroll()+"px"}):this.$$elmt.css({left:this.getScroll()+"px"})},_getScrollOffset:function(){if(this.isPageScroller||this._originalScrollOffset==null)return null;var o=globals.getCurrentPage().getScrollOffset();return o==null?null:{top:o.top-this._originalScrollOffset.top,left:o.left-this._originalScrollOffset.left}},_toggleRect:function(remove){if(this._$$viewRect)this._$$viewRect.remove(),this._$$viewRect.off("click",this._clickHandler),this._$$viewRect=null;else if(remove!==!1){this._$$viewRect=this.viewRect.showInDocument();var o=this._getScrollOffset();o&&this._$$viewRect.css({marginTop:"+="+o.top,marginLeft:"+="+o.left}),this._$$viewRect.on("click",this._clickHandler)}},_onClick:function(evt){log&&log("onClick Status","slowingDown:",this.slowingDown,"panStart:",this.panStart,"cancelClick:",this.cancelClick,"lastClickAllowed:",this.lastClickAllowed?(new Date).getTime()-this.lastClickAllowed:null),evt.$stop=!1;if(evt.shiftKey)return this._toggleRect(),_stopClickEvent(this,evt,"Show rectangle");if(this._evtsEnabled===!1)return;if(this.slowingDown)return _stopClickEvent(this,evt,"slowing down");if(this.cancelClick)return this.cancelClick=!1,_stopClickEvent(this,evt,"Click canceled");if(this.lastClickAllowed!=null&&(new Date).getTime()-this.lastClickAllowed<0)return this.lastClickAllowed=null,_stopClickEvent(this,evt,"Last click timeout");if(this.parentMgr&&this.parentMgr.dir!=this.dir){this.parentMgr._onClick(evt);if(evt.$stop===!0)return _stopClickEvent(this,evt,"Parent stopped click")}log&&log("onClick not stopped")},_onPress:function(evt){this.lastPress=(new Date).getTime(),this.slowingDown&&(this._stopSlowingDown(),this.cancelClick=!0),this.parentMgr&&(this.parentMgr.isLocked=!1),log&&log(this.id,"onPress","slowingDown="+this.slowingDown,"panStart="+this.panStart,"cancelClick ="+this.cancelClick,"lastClickAllowed ="+this.lastClickAllowed)},_onPan:function(evt){log&&log(this.id,evt.type,this.dir,_isEvtDirection(evt,this.dir),"isLocked",this.isLocked);if(!_isEvtDirection(evt,this.dir))return;if(this.isLocked===!0)return;try{if(evt.type==="panstart")log&&log(evt.type),this.panStart=!0,this.cancelClick=!0,this._stopSlowingDown(),this.parentMgr&&this.parentMgr.dir===this.dir&&(this.parentMgr.isLocked=!0);else if(evt.type==="panend"){log&&log(evt.type),this.panStart=!1,_slowDown&&this.lastVelocity!=null?(this.lastVelocity=Math.abs(this.lastVelocity),this.lastVelocity>.3&&this.lastVelocity<1?this.lastVelocity=1:this.lastVelocity=Math.min(this.lastVelocity,2),this.lastVelocity>=1?(this.slowingDown=!0,this._slowDown(this.lastVelocity,this.lastUp),this.lastVelocity=this.lastUp=null):this.parentMgr&&(this.parentMgr.isLocked=!1)):(this.lastClickAllowed=(new Date).getTime()+_lastClickTO,this.parentMgr&&(this.parentMgr.isLocked=!1));return}var up=evt.type===this.upEvtType||evt.type==="panstart"&&evt.deltaY<0;this._move(_velocityToDist(evt.velocity),up)?(this.lastVelocity=Math.abs(evt.velocity),this.lastUp=up):this.lastVelocity=this.lastUp=null}catch(e){return console.log(JSON.stringify(jsutils.convertToDiagnoses(e),null,2)),!1}},_stopSlowingDown:function(){this.slowingDown=!1,this.parentMgr&&(this.parentMgr.isLocked=!1)},_slowDown:function(v,up){var self=this;if(self.panStart||!self.slowingDown){this._stopSlowingDown();return}if(v<1){this._stopSlowingDown();return}self._move(_velocityToDist(v),up)?setTimeout(function(){self._slowDown(v,up)},_slowDownTO):this._stopSlowingDown()},_move:function(dist,up){if(!this.isInitialized()||dist==0)return;try{var scroll=this.getScroll(),val=up?scroll-dist:scroll+dist,valMin=this.getScrollMin();val=Math.max(Math.min(this.scrollMax,val),valMin);if(val===this.scrollMax||val===valMin){log&&log(this.id,"end scrolling"),this.lastClickAllowed=(new Date).getTime()+_lastClickTO,this.cancelClick=!1;if(scroll===val)return!1}return this._refresh(val),!0}catch(e){return console.log(JSON.stringify(jsutils.convertToDiagnoses(e),null,2)),!1}},makeVisible:function($$e){if(!$$e||!this.isInitialized()||$$e.is(":visible"))return;this.slowingDown&&(this._stopSlowingDown(),this.cancelClick=!0);if(!$$e||!$$e.jquery||$$e.length==0)return;$$e.is(":visible")||$$e.parents(".s-m-stack").map(function(stack){var stackLayout=globals.getCurrentPage().getLayout($(this).attr("id"));stackLayout&&stackLayout.setAuthState({collapsed:!1})});if($$e.closest(this.$$elmt).length===0)return;if(!this._evtsEnabled)return;var prop=this.dir==="v"?"top":"left",size=this.dir==="v"?"height":"width",o=$$e.offset(),offset=globals.getSiteLayout().getTransformScale()*$$e[size]()/2;o[prop]=o[prop]+offset;if(o[prop]>this.viewRect[prop]&&o[prop]<this.viewRect[prop]+this.viewRect[size]-10)return;this.$$elmt.css("visibility","hidden");var f=o[prop]>this.viewRect[prop]?-1:1,stopPos=this.viewRect[prop]+this.viewRect[size]/2,stop=!$$e.is(":visible");while(!stop){var pos=$$e.offset()[prop]+offset;stop=f>0?pos>stopPos:pos<stopPos,stop||this._refresh(this.getScroll()+50*f)}var valMin=this.getScrollMin();this.getScroll()<valMin&&this._refresh(valMin),this.getScroll()>this.scrollMax&&this._refresh(this.scrollMax),this.$$elmt.css("visibility","visible")},autoScroll:function(value){this._move(Math.abs(value),value<0)},getScrollMin:function(){var prop=this.dir=="v"?"height":"width",x=this.$$elmt[prop]();return Math.min(this.scrollMax-x+this.viewRect[prop]-30,this.scrollMax)},_setScroll:function(v){if(v==null||isNaN(v))v=this.scrollMax;this.val=v},getScroll:function(){return this.val},adjust:function(restoredScroll){if(!this.isInitialized())return!1;var elmtRect=uiRect.elmtRect(this.$$elmt);if(this.viewRect.contains(elmtRect))this._refresh(this.scrollMax);else{restoredScroll=restoredScroll==null?this.getScroll():restoredScroll,restoredScroll>this.scrollMax&&(restoredScroll=this.scrollMax);var prop=this.dir=="v"?"height":"width",valmin=this.scrollMax-elmtRect[prop]+this.viewRect[prop];restoredScroll<valmin&&(restoredScroll=this.getScrollMin()),this._refresh(restoredScroll)}return!0}});exports.Klass=_Klass,exports.Hammer=Hammer,exports.isEvtDirection=_isEvtDirection}),define("syracuse-tablet/html/js/helpers/scroller/nativeScroller",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/scroller/scrollerBase","syracuse-tablet/html/js/ui/rect"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/helpers/scroller/scrollerBase").Klass,uiRect=require("syracuse-tablet/html/js/ui/rect"),_consts={dirToAxis:{v:"y",h:"x"},dirToOtherAxis:{v:"x",h:"y"}},_Klass=utils.defineClass(function NativeScroller($$elmt,options){Base.call(this,$$elmt,options)},Base,{isNative:function(){return!0},_doInit:function(viewRect,dir,scrollMax,preserveScroll){var css={};css["overflow-"+_consts.dirToAxis[this.dir]]="auto",css["overflow-"+_consts.dirToOtherAxis[this.dir]]="hidden",this.$$elmt.addClass("isScrollElmt").parent().css(css).addClass("isScrollWrapper");var css={};if(this.scrollMax===0&&this.options.nopadding!==!0){var prop=this.dir==="h"?"right":"bottom";css["padding-"+prop]="10px"}var prop=this.dir==="h"?"width":"height",valProp=this.viewRect[prop];this.$$elmt.parent()[prop](valProp).css(css)},reset:function(dontResetValue){var wasInitialized=this.isInitialized();Base.prototype.reset.call(this,dontResetValue);if(!this.$$elmt||!wasInitialized)return;var prop=this.dir==="h"?"width":"height";this.$$elmt.parent().css(prop,"100%")},getScroll:function(){return this.$$elmt?this.$$elmt.parent()[this.dir==="h"?"scrollLeft":"scrollTop"]():this.scrollMax},_refresh:function(scroll,force){if(!this.$$elmt)return;if(scroll==null&&force!==!0)return;scroll=Math.max(scroll==null?this.scrollMax:scroll,this.scrollMax);var cur=this.getScroll();if(cur===scroll&&force!==!0)return;this.$$elmt.parent()[this.dir==="h"?"scrollLeft":"scrollTop"](scroll)},makeVisible:function($$e){if(!$$e||$$e.length===0||$$e.is(":visible")||!$$e.get(0).scrollIntoView)return;$$e.get(0).scrollIntoView(!1)},autoScroll:function(value){this.isInitialized()?this._refresh(value,!0):this.restoredScroll=value},getScrollMin:function(){return this.$$elmt?this.$$elmt.height():0},adjust:function(restoredScroll){return this.isInitialized()?(this.viewRect.contains(uiRect.elmtRect(this.$$elmt))?this._refresh(this.scrollMax):this._refresh(restoredScroll==null?this.getScroll():restoredScroll),!0):!1}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/helpers/scroller/scrollerHelpers",["require","exports","module","syracuse-tablet/html/js/ui/rect","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/scroller/hammerScroller","syracuse-tablet/html/js/helpers/scroller/nativeScroller","syracuse-tablet/html/js/helpers/scroller/hammerScroller","syracuse-tablet/html/js/helpers/scroller/nativeScroller"],function(require,exports,module){var uiRect=require("syracuse-tablet/html/js/ui/rect"),globals=require("syracuse-tablet/html/js/helpers/globals"),_scrollerId=1,_ctor={desktop:require("syracuse-tablet/html/js/helpers/scroller/hammerScroller"),"native":require("syracuse-tablet/html/js/helpers/scroller/nativeScroller")},_createSimpleScroller=function($$elmt){var $$scrolls=$$elmt.find(".s-m-scroll-element"),i,scrollers={};for(i=0;i<$$scrolls.length;i++){_scrollerId++;var $$se=$($$scrolls[i]),$$wrapper=$$se.parent(),dir=$$wrapper.hasClass("s-m-scroll-wrapper-h")?"h":"v";$$wrapper.attr("data-scroller-id",_scrollerId);var parentScroller=null,$$parentScroller=$$wrapper.parent().closest(".s-m-scroll-wrapper");$$parentScroller.length>0&&(parentScroller=scrollers[$$parentScroller.attr("data-scroller-id")]);var css={};css["overflow-"+dir]="auto",$$wrapper.css(css);var gestureMgr=_newScroller($$se,{direction:dir,valMax:0,name:"_scroller_"+_scrollerId,isPageScroller:!1},parentScroller);scrollers[_scrollerId]=gestureMgr,gestureMgr.reset();var scrollRect=uiRect.elmtRect($$se,"outer"),wrapperRect=uiRect.elmtRect($$wrapper,"outer"),viewRect=wrapperRect.intersectRect(scrollRect);viewRect&&!viewRect.contains(scrollRect)&&gestureMgr.init(viewRect)}return scrollers},_newScroller=function($$elmt,options,parentMgr,forceNative){var name;globals.isNativeScrolling()||forceNative?name="native":name="desktop";var Klass=_ctor[name];if(!Klass)throw new Error("Scroller not initialized");return $$elmt.addClass(name+"Scroll"),new Klass($$elmt,options,parentMgr)};exports.newScroller=_newScroller,exports.createSimpleScroller=_createSimpleScroller,exports.init=function(){_ctor.desktop=require("syracuse-tablet/html/js/helpers/scroller/hammerScroller").Klass,_ctor.native=require("syracuse-tablet/html/js/helpers/scroller/nativeScroller").Klass}}),define("syracuse-tablet/html/js/ui/modals/modalDialog",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/scroller/scrollerHelpers","syracuse-tablet/html/js/ui/rect","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),scroller=require("syracuse-tablet/html/js/helpers/scroller/scrollerHelpers"),uiRect=require("syracuse-tablet/html/js/ui/rect"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_dialogTpl='	<div class="modal {{displayFlags.modalClass}}" tabindex="-1" role="dialog">	<div class="modal-dialog">	<div class="modal-content"> 		{{{header}}} 		<div class="modal-body">{{{content}}}</div> 		{{{footer}}} 	</div> 	</div>	</div>',_openModalsPromises=[],_Klass=utils.defineClass(function BaseModal(){var self=this,site=globals.getSiteLayout();self.deviceType=site.getDeviceType(),self.displayFlags={modalClass:""}},null,{destroy:function(){this.$$elmt&&(this.$$elmt.unbind(),this.$$elmt.remove()),this._checkShowNextModal(),notifications.unsubscribe(this)},_checkShowNextModal:function(){_openModalsPromises.shift(),_openModalsPromises.length>0&&_openModalsPromises[0].resolve()},_getTemplates:function(){return{std:{},tablet:{},smartphone:{}}},_getDataContext:function(){return{}},_onValidate:function(){},_onCancel:function(){},_getResult:function(){},_onAction:function(action,param){},_compileTpl:function(){var self=this,htmlTpls=self._getTemplates(),htmlTpl=htmlTpls[self.deviceType]||htmlTpls.std,tpl={header:Handlebars.compile(htmlTpl.header),content:Handlebars.compile(htmlTpl.content),footer:Handlebars.compile(htmlTpl.footer)};return tpl},_getWrapperTemplate:function(){return Handlebars.compile(_dialogTpl)},_ensureParent:function(){var self=this,parentName=globals.isAuthoringActive()?"s-m-modal-parent-auth":"s-m-modal-parent",$$parent=$("#"+parentName);$$parent.length<1&&($$parent=$("<div>"),$$parent.attr("id",parentName),globals.isAuthoringActive()?$("body").append($$parent):($("#s-m-app-container-id").css({width:"100%",height:"100%"}),$("#s-m-app-id").show().addClass("s-m-modal-parent").append($$parent))),self.$$parent=$$parent},_createDOM:function(){var self=this;self.$$elmt=$(self.html)},getDisplayFlags:function(){var self=this;return self.displayFlags},_hookEvents:function(){var self=this;self.$$elmt.on("shown.bs.modal",self._onShow.bind(self)),self.$$elmt.on("hide.bs.modal",self._onHide.bind(self)),self.$$elmt.delegate("[data-action]","click",self._onButton.bind(self))},_attachDOM:function(){var self=this;self.$$parent.toggle(!0),self.$$parent.append(self.$$elmt),self.$$elmt.modal({keyboard:!1,backdrop:"static"})},_onShow:function(evt){var self=this;self.$$elmt.css("padding-left",""),self._calcSize();var app=globals.getApplication();app&&(app.notifModalOpen(),self._initScrollers(),notifications.subscribe(self,"sm.main.layout.changed"))},notifMainLayoutChanged:function(info,orientation,deviceType){},_onHide:function(evt){var self=this;self.$$parent.toggle(!1);var app=globals.getApplication();app&&app.notifModalClose(),self.deferred.resolve(self._getResult()),self.destroy()},_onButton:function(evt){var self=this,$$t=$(evt.currentTarget),param=$$t.attr("data-params"),act=$$t.attr("data-action");if(act){evt.preventDefault(),evt.stopPropagation();var res;act==="$validate"?res=self._onValidate():act==="$cancel"?res=self._onCancel():res=self._onAction(act,param),utils.toPromise(res).then(function(res){res!==!1&&self.$$elmt.modal("hide")})}else self.$$elmt.modal("hide")},show:function(forceDisplay){var self=this,startShow=new $.Deferred;return forceDisplay===!0&&(_openModalsPromises=[]),_openModalsPromises.push(startShow),(_openModalsPromises.length===1||forceDisplay===!0)&&startShow.resolve(),self.deferred=new $.Deferred,startShow.then(function(){return self._getDataContext()}).then(function(data){self.data=data}).then(function(){self.template=self._compileTpl();var outerTpl=self._getWrapperTemplate(),header=self.template.header(self.data),footer=self.template.footer(self.data);header.length>0&&(header='<div class="modal-header">'+header+"</div>"),footer.length>0&&(footer='<div class="modal-footer">'+footer+"</div>"),self.html=outerTpl({header:header,content:self.template.content(self.data),footer:footer,displayFlags:self.getDisplayFlags()}),self._ensureParent(),self._createDOM(),self._hookEvents(),self._attachDOM()}).fail(function(e){_openModalsPromises=[],self.deferred.reject(e)}),self.deferred.promise()},_initScrollers:function(){scroller.createSimpleScroller(this.$$elmt)},_calcSize:function(){var self=this,df=self.getDisplayFlags();if(df.modalClass.indexOf("half_center")>-1||df.modalClass.indexOf("half_right")>-1||df.modalClass.indexOf("full")>-1){var $$content=self.$$elmt.find(".modal-content"),$$header=self.$$elmt.find(".modal-header"),$$body=self.$$elmt.find(".modal-body"),$$footer=self.$$elmt.find(".modal-footer"),header=$$header.length>0?uiRect.elmtRect($$header,"outer").height:0,footer=$$footer.length>0?uiRect.elmtRect($$footer,"outer").height:0;$$body.css({top:header,height:$$content.height()-header-footer})}}}),_checkMsg=function(msg){return msg?msg.replace(/\n/g,"<br>"):""};exports.checkMsg=_checkMsg,exports.ModalBase=_Klass}),define("syracuse-tablet/html/js/ui/modals/modalDiagnoses",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalDialog","syracuse-tablet/html/js/helpers/scroller/scrollerHelpers","syracuse-tablet/html/js/ui/rect","syracuse-tablet/html/js/helpers/scroller/hammerScroller"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),scroller=require("syracuse-tablet/html/js/helpers/scroller/scrollerHelpers"),uiRect=require("syracuse-tablet/html/js/ui/rect"),hammerScroller=require("syracuse-tablet/html/js/helpers/scroller/hammerScroller"),_templateAll={header:'		<div class="modal-title {{severity}}">{{title}}</div>',content:'		<div class="s-m-modal-diag-content">			{{#each diags}} 				<message id="s-m-msg-block-{{id}}" role="alert" style="display:{{this.display}}"> 					<div style="white-space: pre-line;">{{this.message}}</div> 					{{#if stack}} 						<a id="s-m-msg-stack-{{id}}" draggable="false" name="more" href="#" data-action="more">{{../../stackShow}}</a> 						<section>							<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">								<stack name="s-m-scroll-element stack" class="s-m-msg-stack-content"> 									{{{this.stack}}} 								</stack> 							</div> 						</section>					{{/if}} 				</message> 			{{/each}}		</div>		<div class="s-m-modal-diag-goto">			{{#each diags}}				<a id="s-m-msg-goto-{{id}}" data-action="goto" data-params="{{id}}">					<i class="fa fa-circle-o" data-action="goto" data-params="{{id}}"></i>				</a>			{{/each}}		</div>',footer:'<div style="width:100%; display: inline-block;"></div><button type="button" class="btn btn-default" data-action="$cancel">{{close}}</button>'},_Klass=utils.defineClass(function ModalDiagnoses(title,diag){var self=this;modalDialog.ModalBase.call(self),self.title=title,self.diag=diag,self.diagId=0,self.curMsg=0},modalDialog.ModalBase,{destroy:function(){var self=this;this._destroySwiper(),this._gestureMgrMap&&!$.isEmptyObject(this._gestureMgrMap)&&($.each(this._gestureMgrMap,function(key,gestureMgr){gestureMgr.destroy()}),this._gestureMgrMap=null),modalDialog.ModalBase.prototype.destroy.call(self)},_getTemplates:function(){var self=this;return{std:_templateAll}},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="diagnoses tablet":displayFlags.modalClass="diagnoses mobile",displayFlags},_getDataContext:function(){var self=this,ctx={close:locale.text("modal.btn.close")||"Close",stackShow:locale.text("modal.diagnoses.btnstack_show"),severity:"info",diags:[]};return self.diag.$diagnoses.forEach(function(d){var sev;d.$severity==="success"||d.$severity==="info"||d.$severity==="warning"?sev=d.$severity:(sev="danger",ctx.severity="error");var ctxDiag={id:self.diagId,display:self.diagId===0?"block":"none",message:d.$message,severity:sev,severityLabel:locale.text("severity."+sev)};if(d.$stackTrace){var a=d.$stackTrace.split("\n");a.length>10&&(a.length=10,a.push("...")),ctxDiag.stack=a.join("<br>")}ctx.diags.push(ctxDiag),self.diagId++}),self.title=self.title||(ctx.severity==="error"?locale.text("modal.error.ttl"):locale.text("modal.info.ttl")),ctx.title=self.title,ctx},_onAction:function(action,param){var self=this;switch(action){case"next":self._next();break;case"prev":self._prev();break;case"more":self._more();break;case"goto":self._goTo(param)}return!1},_goTo:function(id){var self=this;for(var ii=0,jj=self.diagId;ii<jj;ii++)$("#s-m-msg-block-"+ii,self.$$elmt).css("display",ii==id?"block":"none");self.curMsg=parseInt(id,10),self._updateButtons()},_next:function(){var self=this;self.curMsg<self.diagId-1&&($("#s-m-msg-block-"+self.curMsg,self.$$elmt).css("display","none"),self.curMsg++,$("#s-m-msg-block-"+self.curMsg,self.$$elmt).css("display","block"),self._updateButtons())},_prev:function(){var self=this;self.curMsg>0&&($("#s-m-msg-block-"+self.curMsg,self.$$elmt).css("display","none"),self.curMsg--,$("#s-m-msg-block-"+self.curMsg,self.$$elmt).css("display","block"),self._updateButtons())},_more:function(){var self=this,$$btn=$("#s-m-msg-stack-"+self.curMsg,self.$$elmt),$$stackSection=$("section",$$btn.parent());$$stackSection.css("display")==="none"?($$stackSection.css("display","block"),$$btn.text(locale.text("modal.diagnoses.btnstack_hide")),self._handleGesture()):($$stackSection.css("display","none"),$$btn.text(locale.text("modal.diagnoses.btnstack_show")))},_updateButtons:function(){var self=this;for(var ii=0,jj=self.diagId;ii<jj;ii++){var $$navDot=$("a#s-m-msg-goto-"+ii+" i",self.$$elmt);$$navDot.toggleClass("fa-circle",ii==self.curMsg),$$navDot.toggleClass("fa-circle-o",ii!==self.curMsg)}self.diagId>1?$(".modal-title",self.$$elmt).text(self.title+" ("+(self.curMsg+1)+"/"+self.diagId+")"):$(".s-m-modal-diag-goto",self.$$elmt).css("display","none")},_onShow:function(evt){var self=this;modalDialog.ModalBase.prototype._onShow.call(self,evt),self._updateButtons(),self._checkSize(),self.diagId>1&&self._initSwiper()},_handleGesture:function(){var self=this;self._gestureMgrMap=self._gestureMgrMap||{};if(!self._gestureMgrMap["gestureMgr"+self.curMsg]){var $$scrollElmt=$(".s-m-msg-stack-content",$("#s-m-msg-block-"+self.curMsg,self.$$elmt)),$$wrapper=$(".s-m-scroll-wrapper",$("#s-m-msg-block-"+self.curMsg,self.$$elmt));self._gestureMgrMap["gestureMgr"+self.curMsg]=scroller.newScroller($$scrollElmt,{direction:"v"});var scrollRect=uiRect.elmtRect($$wrapper,"outer");self._gestureMgrMap["gestureMgr"+self.curMsg].init(scrollRect)}},_onSwipe:function(evt){if(hammerScroller.isEvtDirection(evt,"v"))return;var self=this;setTimeout(function(){var next=evt?evt.type==="swipeleft":null;next?self._next():self._prev()})},_destroySwiper:function(){var self=this;self.hammer&&(self.hammer.destroy(),self.hammer=null)},_initSwiper:function(){var self=this;self._destroySwiper(),self.hammer=new hammerScroller.Hammer($(".s-m-modal-diag-content",self.$$elmt).get(0)),self.hammer.get("swipe").set({direction:hammerScroller.Hammer.DIRECTION_HORIZONTAL}),this.hammer.on("swipeleft swiperight",hammerScroller.Hammer.bindFn(self._onSwipe,self))},_checkSize:function(){var self=this,$$app=$("#s-m-app-id"),$$stacks=$("message > section",self.$$elmt);$$stacks.css({"max-height":$$app.height()-200+"px"})}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/ui/modals/modalConfirm",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/modals/modalDialog","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),locale=require("syracuse-tablet/html/js/helpers/locale"),_templateAll={header:'		<div class="modal-title">{{title}}</div>',content:'			<div class="s-m-modal-content">				{{message}}			</div>',footer:'		<button type="button" class="btn btn-default" data-action="yes">{{yes}}</button> 		<button type="button" class="btn btn-default" data-action="no">{{no}}</button>'},_Klass=utils.defineClass(function ModalConfirm(message,action,isSimpleConfirm){var self=this;modalDialog.ModalBase.call(self),self.message=message,self.action=action,self.isSimpleConfirm=isSimpleConfirm},modalDialog.ModalBase,{_getTemplates:function(){var self=this;return{std:_templateAll}},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="confirm tablet":displayFlags.modalClass="confirm mobile",displayFlags},_getDataContext:function(){var self=this,ctx={};return ctx.title=self.isSimpleConfirm?null:locale.text("modal.confirm.ttl"),ctx.message=self.action?modalDialog.checkMsg(locale.text("modal.confirm.msg",[self.action])):modalDialog.checkMsg(self.message),ctx.yes=locale.text("yes"),ctx.no=locale.text("no"),ctx},_onAction:function(action,param){var self=this;return self.selectedAction=action,!0},_getResult:function(){var self=this;return self.selectedAction}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/ui/modals/modalField",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/modals/modalDialog","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),locale=require("syracuse-tablet/html/js/helpers/locale"),_templateAll={header:'		<buttons class="pull-right"> 			<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 		</buttons> 		<div class="modal-title">{{title}}</div>',content:"{{{domBody}}}",footer:""},_Klass=utils.defineClass(function ModalField(title,domBody,cb){var self=this;modalDialog.ModalBase.call(self),self.title=title||"Warning",self.domBody=domBody,self.cb=cb},modalDialog.ModalBase,{destroy:function(){modalDialog.ModalBase.prototype.destroy.call(this),this.domBody=null,this.cb=null},_getTemplates:function(){var self=this;return{std:_templateAll}},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="field tablet":displayFlags.modalClass="field mobile",displayFlags},_getDataContext:function(){var self=this;return{title:self.title,domBody:self.domBody,close:locale.text("modal.btn.close")}},_onShow:function(evt){var self=this;modalDialog.ModalBase.prototype._onShow.call(self,evt),self._execCb(self.cb,"shown.bs.modal",self.$$elmt)},_onCancel:function(){return!0},_onHide:function(evt){var self=this;modalDialog.ModalBase.prototype._onHide.call(self,evt),self._execCb(self.cb,"hide.bs.modal",self.$$elmt)},_execCb:function(cb,msg,data){if(!cb||arguments.length==0)return;var cb=arguments[0],args=Array.prototype.slice.call(arguments,1);cb.apply(null,args)}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/ui/modals/modal",["require","exports","module","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/native/native","syracuse-tablet/html/js/ui/modals/modalDiagnoses","syracuse-tablet/html/js/ui/modals/modalConfirm","syracuse-tablet/html/js/ui/modals/modalField","syracuse-tablet/html/js/helpers/mobileDetect"],function(require,exports,module){var uiutils=require("syracuse-tablet/html/js/ui/uiUtils"),locale=require("syracuse-tablet/html/js/helpers/locale"),globals=require("syracuse-tablet/html/js/helpers/globals"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),native=require("syracuse-tablet/html/js/helpers/native/native"),ModalDiagnoses=require("syracuse-tablet/html/js/ui/modals/modalDiagnoses").Modal,ModalConfirm=require("syracuse-tablet/html/js/ui/modals/modalConfirm").Modal,ModalField=require("syracuse-tablet/html/js/ui/modals/modalField").Modal,mobileDetect=require("syracuse-tablet/html/js/helpers/mobileDetect"),_templates={actionMessage:'		<div class="s-m-act-msg {{severityClass}}">			<a draggable="false" href="#"><span class="glyphicon glyphicon-remove"></span></a>			<header>				<div>{{title}}</div>			</header>			<section>				<article>{{message}}</article>			</section>			<footer></footer>		</div>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl(ctx)},_execCb=function(cb,msg,data){if(!cb||arguments.length==0)return;var cb=arguments[0],args=Array.prototype.slice.call(arguments,1);cb.apply(null,args)},_error=function(title,e,cb){var error=e,callBack=cb;title!=null&&typeof title!="string"&&(error=title,title=null),typeof e=="function"&&(callBack=e);var diag;return diag=jsutils.convertToDiagnoses(error),title==null&&error&&error.$title&&(title=error.$title),_diagnoses(title,diag,callBack,!0)},_diagnoses=function(title,diag,cb,forceDisplay){var modal=new ModalDiagnoses(title,diag);modal.show(forceDisplay===!0).then(function(result){cb&&cb(result)})},_info=function(title,text,cb){var infoDiag={$diagnoses:[{$severity:"info",$message:text}]};_diagnoses(title,infoDiag,cb)},_warning=function(title,text,cb){_diagnoses(title,{$diagnoses:[{$severity:"warning",$message:text}]},cb)},_confirm=function(action,cb){var modal=new ModalConfirm(null,action);modal.show().then(function(result){cb&&(result==="yes"||result==="no")&&cb(result,"yes"===result)})},_simpleConfirm=function(message,cb){var modal=new ModalConfirm(message,null,!0);modal.show().then(function(result){cb&&(result==="yes"||result==="no")&&cb(result,"yes"===result)})};exports.simpleConfirmPromise=function(options){var deferred=$.Deferred(),modal=new ModalConfirm(options.message,null,!0);return modal.show().then(function(result){(result==="yes"||result==="no")&&deferred.resolve({action:result})}),deferred.promise()};var _field=function(title,domBody,cb){var modal=new ModalField(title,domBody,cb);modal.show()},_actionResult=function(title,obj,forceToast){if(obj&&obj.$noConnectionError==1){_notificationHandler({title:locale.text("action.title.offline"),body:locale.text("action.needs.net"),severityClass:"warning",$$parentSlot:globals.getApplication().getMessageSlot()});return}obj=jsutils.convertToDiagnoses(obj);if(!obj||!obj.$diagnoses||obj.$diagnoses.length==0)return;var hasStack=!1,hasError=!1,text=[];obj.$diagnoses.forEach(function(diag){text.push(diag.$message),diag.$severity=="error"&&(hasError=!0,hasStack=hasStack||diag.$stackTrace!=null)});if(!hasStack||forceToast===!0){var options={title:title,body:text.join("\n"),severityClass:hasError?"error":"success",$$parentSlot:globals.getApplication().getMessageSlot()};options.onlyWebapp===!1&&native.hasCapability("toastMessages")?native.getModule("toastMessages").showToastMessage({Text1:options.title,Text2:options.body,Severity:hasError?"error":"success"}):_notificationHandler(options)}else _diagnoses(title,obj)},_notificationHandler=function(options){function toggle(){$$actionModal.toggleClass("show")}function clear(){toggle(),setTimeout(function(){$$actionModal.remove(),options.$$parentSlot.children().length==0&&options.$$parentSlot.hide()},500)}var stop=!1;$(document.body).find(".s-m-act-msg."+options.severityClass).each(function(index){var $e=$(this);if($e.find("div:contains('"+options.title+"')").length>0&&$e.find("div:contains('"+options.body+"')").length>0)return stop=!0,!1});if(stop)return;var h=_getHtml("actionMessage",{title:options.title,message:options.body,severityClass:options.severityClass}),isClosing,$$actionModal=$(h);options.$$parentSlot.prepend($$actionModal),options.$$parentSlot.show();var $$closer=$$actionModal.find("a"),delay=options.delay||"medium";delay=delay==="short"?1500:delay==="long"?7e3:5e3,$$closer.bind("click",function(){clear(),isClosing=!0}),setTimeout(function(){toggle()},50);var toggleTimeout=setTimeout(function(){isClosing||clear()},delay)},_modal=function(html,cb){uiutils.waitWheelStop();var app=globals.getApplication();app&&app.currentPage&&app.currentPage.waitWheelStop();var h=$(html).modal({keyboard:!1,backdrop:"static"}),viewportHeight=$(window).height();$(".modal-body",h).css("max-height",viewportHeight*.7);var $$md=$(h),$$parent=$("#s-m-modal-parent")&&$("#s-m-modal-parent").length>0?$("#s-m-modal-parent"):$("<div>").attr("id","s-m-modal-parent");$$parent.append($$md),$("#s-m-app-id").append($$parent),$$parent.toggle(!0);var done=!1;return h.on("shown.bs.modal",function(evt){try{_execCb(cb,"shown.bs.modal",h)}catch(e){alert("Modal open - call back error"+e.stack)}app.notifModalOpen()}),app.notifModalClose(),h.on("hide.bs.modal",function(){$("#s-m-modal-parent").toggle(!1),app.notifModalClose();if(!done&&cb)try{_execCb(cb,"hide.bs.modal",h)}catch(e){alert("Modal close - call back error"+e.stack)}h.unbind(),h.remove()}),h.delegate("button[data-action]","click",function(evt){var t=$(evt.target),act=t.attr("data-action");act&&(done=!0,evt.preventDefault(),evt.stopPropagation(),_execCb(cb,act,h,t.attr("data-params"))),h.modal("hide")}),h};exports.notify=function(options){var nativeToastMsg=native.hasCapability("toastMessages")===!0;(!mobileDetect.isOs("ios")||!nativeToastMsg)&&options!=null&&options.onlyWebapp===!0&&(nativeToastMsg=!1),nativeToastMsg===!0?native.getModule("toastMessages").showToastMessage({Text1:options.title,Text2:options.body,Severity:options.severityClass}):exports.forceNotifyWebApp(options)},exports.forceNotifyWebApp=function(options){if(!options)return;options.$$parentSlot=options.$$parentSlot||globals.getApplication()&&globals.getApplication().getMessageSlot(),_notificationHandler(options)};var _displayActionMsg=function(success,name,proto,data){var obj;data&&data.$diagnoses&&data.$diagnoses.length>0?obj=data:obj={$diagnoses:[{$message:locale.text("modal.action."+(success?"success":"fail")),$severity:success?"success":"error",$stackTrace:JSON.stringify(data)}]};var title=name;if(proto){var links=proto.data("$links"),link=links&&links[name];link||(links=proto.getPrototype("$properties.$resources.$item"),links=links&&links.data("$links"),link=links&&links[name]),link&&link.$title&&(title=proto.resolveExpression(link.$title))}_actionResult(title,obj)};exports.noConnectionModal=function(){return _error(locale.text("action.title.offline"),locale.text("action.needs.net"))},exports.createGeneralErrorDiag=function(source){return{$diagnoses:[{$message:locale.text("technical.error.message"),$severity:"error",$stackTrace:JSON.stringify(source)}]}},exports.error=_error,exports.info=_info,exports.warning=_warning,exports.diagnoses=_diagnoses,exports.field=_field,exports.confirm=_confirm,exports.simpleConfirm=_simpleConfirm,exports.modal=_modal,exports.actionResult=_actionResult,exports.displayActionMsg=_displayActionMsg}),define("syracuse-tablet/html/js/init/initStyles",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/mobileDetect"],function(require,exports,module){function _loadCss(file){var ref=document.createElement("link");ref.setAttribute("rel","stylesheet"),ref.setAttribute("type","text/css"),ref.setAttribute("href",file),document.getElementsByTagName("head")[0].appendChild(ref)}function _isSurfaceTablet(){navigator.userAgent.toLowerCase().indexOf("tablet pc")>-1&&navigator.userAgent.toLowerCase().indexOf("windows")>-1}var globals=require("syracuse-tablet/html/js/helpers/globals"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),mobileDetect=require("syracuse-tablet/html/js/helpers/mobileDetect");exports.init=function(){var deferred=new $.Deferred,os=mobileDetect.getStyleOS(),styles;styles=os;var cssPlatform="./css/gen/"+styles+(jsutils.isReleaseVersion()?".min":"")+".css";_loadCss(cssPlatform);var cssGeneral="./css/default"+(jsutils.isReleaseVersion()?".min":"")+".css";return _loadCss(cssGeneral),deferred.resolve(),globals.setLookAndFeel(styles),deferred.promise()}}),define("syracuse-tablet/html/js/init/initLocale",["require","exports","module","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var locale=require("syracuse-tablet/html/js/helpers/locale");exports.init=function(){var lang="en-GB";return locale.setLocale(lang)}}),define("syracuse-tablet/html/js/controls/ctrlFactory",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/globals"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("factory"),globals=require("syracuse-tablet/html/js/helpers/globals"),_ctor={},_types={string:"application/x-string",password:"application/x-password",text:"text/plain",integer:"application/x-integer",real:"application/x-real",decimal:"application/x-decimal",quantity:"application/x-quantity",choice:"application/x-choice","boolean":"application/x-boolean",date:"application/x-date",time:"application/x-time",datetime:"application/x-datetime",reference:"application/x-reference",array:"application/x-array",image:"image",doc:"application/x-document",binary:"application/x-binary",soapObject:"application/x-object",textRtf:"text/rtf",textHtml:"text/html",textPlain:"text/plain",vignette:"tablet/x-vignette",layout:"tablet/x-layout",filter:"application/x-filter",breadcrumbs:"tablet/x-page-breadcrumbs",pageheader:"tablet/x-page-header",pagefooter:"tablet/x-page-footer",vignettefooter:"tablet/x-page-vignette-footer",vignetteheader:"tablet/x-page-vignette-header",panelactionregular:"tablet/x-page-panel-actionregular",panelusersmartphone:"tablet/x-page-panel-usersmartphone",panelfiltersort:"tablet/x-page-panel-filtersort",panelpageshare:"tablet/x-page-panel-pageshare",panelpageedittemplate:"tablet/x-page-panel-edittemplates",panelpagedashboardtemplates:"tablet/x-page-panel-dashboardtemplates",dashboardConfigheader:"tablet/x-page-dashboard-config-header",dashboardConfigfooter:"tablet/x-page-dashboard-config-footer",icon:"tablet/x-icon",button:"tablet/x-button",unfound:"tablet/x-unfound",rowStatus:"tablet/x-row-status",rowIndex:"tablet/x-row-index",chartDetailToolbar:"tablet/x-chartdetail-toolbar"},_createCellFieldCtrl=function($$parentCell,controller,ctrlArticle,ctrlProto,options){return options=$.extend(!0,{},options),options.displayCtx="table",_createControl(controller,null,ctrlArticle,ctrlProto,options)},_createControl=function(controller,parentStructElmt,article,prototype,options){if(!controller)throw new Error("createControl - null parent or controller");options=$.extend(!0,{},options);var c,type=prototype.data("$type");switch(type){case _types.string:case _types.password:switch(prototype.data("$format")){case"$phone":c=new _ctor.PhoneField(controller,article,prototype,options);break;case"$email":c=new _ctor.EmailField(controller,article,prototype,options);break;case"$url":c=new _ctor.UrlField(controller,article,prototype,options);break;default:c=new _ctor.Alphanum(controller,article,prototype,options)}break;case _types.integer:case _types.real:case _types.decimal:case _types.quantity:article.$numDisplay?(!article.$gauge&&article.$numDisplay==="gauge"&&(article.$gauge={}),article.$numDisplay==="normal"?type===_types.quantity?c=new _ctor.Quantity(controller,article,prototype,options):c=new _ctor.Numeric(controller,article,prototype,options):c=new _ctor.Gauge(controller,article,prototype,options)):article.$gauge?c=new _ctor.Gauge(controller,article,prototype,options):type===_types.quantity?c=new _ctor.Quantity(controller,article,prototype,options):c=new _ctor.Numeric(controller,article,prototype,options);break;case _types.choice:c=new _ctor.Combo(controller,article,prototype,options);break;case _types.boolean:switch(prototype.data("$format")){case"$switch":c=new _ctor.Switch(controller,article,prototype,options);break;default:c=new _ctor.CheckBox(controller,article,prototype,options)}break;case _types.date:case _types.time:case _types.datetime:c=new _ctor.Date(controller,article,prototype,options);break;case _types.reference:c=new _ctor.Reference(controller,article,prototype,options);break;case _types.array:prototype.data("$cube")?c=new _ctor.ArrayChart(controller,article,prototype,options):c=new _ctor.Array(controller,article,prototype,options);break;case _types.vignette:c=new _ctor.Vignette(controller,article,prototype,options);break;case _types.image:c=new _ctor.Image(controller,article,prototype,options);break;case _types.doc:c=new _ctor.Document(controller,article,prototype,options);break;case _types.binary:c=new _ctor.Binary(controller,article,prototype,options);break;case _types.icon:c=new _ctor.Icon(controller,article,prototype,options);break;case _types.button:c=new _ctor.Button(controller,article,prototype,options);break;case _types.textRtf:case _types.textHtml:case _types.textPlain:c=new _ctor.Text(controller,article,prototype,options);break;case _types.soapObject:throw new Error("not implemented");case _types.unfound:c=new _ctor.FieldUnfound(controller,article,prototype,options);break;case _types.rowStatus:c=new _ctor.FieldRowStatus(controller,article,prototype,options);break;case _types.rowIndex:c=new _ctor.FieldRowIndex(controller,article,prototype,options);break;case _types.filter:c=new _ctor.Filter(controller,article,prototype,options);break;default:if(!globals.isDvlpMode())return;c=new _ctor.TypeUnknown(controller,article,prototype,options)}if(options.displayCtx==="table")return c;if(!parentStructElmt)throw new Error("createControl - Parent's control is mandatory");return parentStructElmt.appendStructElmt(c),options.displayCtx!=="card"&&controller.addControl(c),c},_createLayout=function(controller,parentStructElmt,article,opts){opts=$.extend(!0,{},opts);var type=article.$layoutType||"stack",klass;if(type=="stack")klass=_ctor.LayoutStack;else if(type=="row")klass=_ctor.LayoutRow;else if(type=="tab")klass=_ctor.LayoutTab;else if(type=="hub")klass=_ctor.LayoutHub;else if(type=="hubGroup")klass=_ctor.LayoutHubGroup;else if(type=="tile")klass=_ctor.LayoutTile;else{if(type!="cell")return log&&log("layout type="+type+" is not implemented"),null;klass=_ctor.LayoutCell}var l=new klass(controller,type,article,opts);return parentStructElmt?parentStructElmt.appendStructElmt(l):l.parent=controller,controller.addLayout(l),l},_createPageControl=function(type,controller,options){options=$.extend(!0,{},options);var c;switch(type){case"breadcrumbs":c=new _ctor.BreadCrumbs(_types.breadcrumbs,controller,options);break;case"header":c=new _ctor.PageHeader(_types.pageheader,controller,options);break;case"footer":c=new _ctor.PageFooter(_types.pagefooter,controller,options);break;case"topToolbarChartDetail":c=new _ctor.ChartDetailToolbar(_types.chartDetailToolbar,controller,options);break;default:throw new Error("Unknown page control["+type+"]")}return controller.addControl(c),c},_createActionControl=function(type,vignette,options){options=$.extend(!0,{},options);if(type==="footer")return new _ctor.VignetteFooter(_types.vignettefooter,vignette,options);if(type==="header")return new _ctor.VignetteHeader(_types.vignetteheader,vignette,options);throw new Error("Unknown vignette action control["+type+"]")},_createDashboardConfigHeader=function(controller,options){return new _ctor.DashboardConfigHeader(_types.dashboardConfigheader,controller,$.extend(!0,{},options))},_createDashboardConfigFooter=function(controller,options){return new _ctor.DashboardConfigFooter(_types.dashboardConfigfooter,controller,$.extend(!0,{},options))},_createPanel=function(controller,panelId,options){options=$.extend(!0,{},options);var deviceType=globals.getSiteLayout().getDeviceType();options=options||{deviceType:deviceType};switch(panelId){case globals.PANELACTIONSREGULAR:return new _ctor.PageActionPanelRegular(controller,_types.panelactionregular,panelId,options);case globals.PANELUSERSMARTPHONE:return new _ctor.UserPanelSmartphone(controller,_types.panelusersmartphone,panelId,options);case globals.PANELFILTERSORT:return new _ctor.FilterSortPanel(controller,_types.panelfiltersort,panelId,options);case globals.PANELPAGESHARE:return new _ctor.PageSharePanel(controller,_types.panelpageshare,panelId,options);case globals.PANELEDITTEMPLATES:return new _ctor.PageTemplatePanel(controller,_types.panelpageedittemplate,panelId,options);case globals.PANELDASHBOARDTEMPLATES:return new _ctor.PageDashboardTemplatePanel(controller,_types.panelpagedashboardtemplates,panelId,options);default:throw new Error("Unknown page control["+panelId+"]")}},_createBindControl=function(controller,parentStructElmt,article){if(!controller)throw new Error("Control - null parent or controller");var c=new _ctor.StructElmt(controller,"$dummyBind",article,{},{});if(!parentStructElmt)throw new Error("Parent's control is mandatory");return parentStructElmt.appendStructElmt(c),c};exports.createPanel=_createPanel,exports.createControl=_createControl,exports.createLayout=_createLayout,exports.createPageControl=_createPageControl,exports.createActionControl=_createActionControl,exports.createCellFieldCtrl=_createCellFieldCtrl,exports.createBindControl=_createBindControl,exports.createDashboardConfigHeader=_createDashboardConfigHeader,exports.createDashboardConfigFooter=_createDashboardConfigFooter,exports.type=function(name){return _types[name]},exports.setImpl=function(name,ctor){_ctor[name]=ctor}}),define("syracuse-tablet/html/js/helpers/articleParser",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/controls/ctrlFactory","syracuse-tablet/html/js/helpers/jsutils"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("articleParser"),utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),ctrlFactory=require("syracuse-tablet/html/js/controls/ctrlFactory"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),_isSingleArray=function(jsonArrayProto){return jsonArrayProto.$item.$properties==null||jsonArrayProto.$type=="application/x-reference"},_Parser=utils.defineClass(function(page){var self=this;self.page=page},null,{_doParse:function(article,prototype,parent,opts,unfounds){var self=this;if(article.$layoutType){opts.index==null?opts.index=0:opts.index++;var lyt=ctrlFactory.createLayout(self.page,parent,article,opts);return lyt&&article.$items&&article.$items.forEach(function($itm){self._doParse($itm,prototype,lyt,opts,unfounds)}),lyt}if(article.$bind){var fieldProto=prototype.getPrototype(article.$bind);fieldProto==null&&article.$isUnfound!==!0?unfounds.push(article):(article.$isUnfound&&(fieldProto=prototype.create({$type:"tablet/x-unfound"})),fieldProto.data("$isExcluded")||ctrlFactory.createControl(self.page,parent,article,fieldProto,opts))}else log&&log("$layoutType or $bind exspected")},parse:function(article,prototype,opts){var self=this;try{if(!article||!prototype)throw new Error("Not empty article and prototype are expected");article.$layoutType||(article.$layoutType="stack");var unfounds=[];opts.$localization=utils.getArticleLocalization(article);var root=self._doParse(article,prototype,null,opts,unfounds);if(unfounds.length>0&&globals.getDvlpOpt("showUnfoundFields")){var article={$layoutType:"stack",$items:[]};unfounds.forEach(function(f){article.$items.push($.extend(!0,f,{$isUnfound:!0}))}),self._doParse(article,prototype,root,opts,null)}return root}catch(e){throw log&&log("article parser error",e),new Error("Error parsing article ["+e.message+"]\n"+jsutils.cleanStack(e.stack))}}}),_article2Controls=function(page,article,prototype,opts){var p=new _Parser(page);return p.parse(article,prototype,opts)},_defOption={skipblock:!0,skipsection:!0,include:["$category","$layoutType","$title","$bind"],exclude:["$items","$widths"],protoExclude:["application/x-array","application/json"]},_convertWidth=function(widths){var r=[];widths=widths.split(",");if(widths.length===0)throw new Error("Number of cells/rows must be > 0");if(widths.length>12)throw new Error("Number of cells/rows must be <= 12");var sum=0;widths.forEach(function(w){w=parseInt(w,10),w=Math.ceil(w/12),sum+=w,r.push(w)});if(sum>12){var d=sum-12;r.sort();while(d>0)for(var i=r.length-1;i>=0;i--)d>0&&r[i]>1&&(r[i]=r[i]-1,d--)}else if(sum<12){var d=12-sum;r.sort();while(d>0)for(var i=0;i<r.length;i++)d>0&&(r[i]=r[i]+1,d--)}return r.join(",")},_scanDesktop=function(json,options){if(!json)return null;var res;json.$layout?res=_scanDesktop(json.$layout,options):res={};if(json.$layoutType){if(!json.$items)throw new Error("$items is missing");res.$items=[],json.$items.forEach(function(itm){res.$items.push(_scanDesktop(itm,options))})}for(var p in json)p==="$widths"?res[p]=_convertWidth(json[p]):options.exclude.indexOf(p)===-1&&options.include.indexOf(p)>=0&&(res[p]=json[p]);return res},_convertDesktop=function(article,prototype,options){return options=$.extend({},_defOption,options),_scanDesktop(article,options)},_coreLayout2DefaultLayout=function(coreLayout,article,props){var p=new _LayoutParser;p.parse(coreLayout,article,props)},_LayoutParser=utils.defineClass(function(){var self=this},null,{_doParse:function(coreLayout,article,props){var self=this;if(!coreLayout)return;var idx,idx1;coreLayout.$items.forEach(function($itm){switch($itm.$category){case"section":idx=article.$items.push({$title:$itm.$title,$layoutType:"stack",$items:[]}),self._doParse($itm.$layout,article.$items[idx-1],props);break;case"block":idx=article.$items.push({$title:$itm.$title,$layoutType:"stack",$items:[]}),idx1=article.$items[idx-1].$items.push({$layoutType:"row",$items:[]}),self._doParse($itm.$layout,article.$items[idx-1].$items[idx1-1],props);break;default:props[$itm.$bind]&&!props[$itm.$bind].$isExcluded&&(idx=article.$items.push({$layoutType:"cell",$bgColor:"",$items:[]}),article.$items[idx-1].$items.push({$bind:$itm.$bind}));return}})},parse:function(proto,article,props){this._doParse(proto.$article.$layout,article,props)}});exports.coreLayout2DefaultLayout=_coreLayout2DefaultLayout,exports.article2Controls=_article2Controls,exports.convertDesktop=_convertDesktop,exports.isSingleArray=_isSingleArray}),define("syracuse-tablet/html/js/helpers/prototype",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/articleParser"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),articleParser=require("syracuse-tablet/html/js/helpers/articleParser"),_getArrayJsonProto=function(proto){if(!proto)return null;var json;return $.isPlainObject(proto)?json=proto:proto.isArray()?json=proto.json:proto.parent&&(json=proto.parent.json),json==null||json.$type!=="application/x-array"?null:json},_testFacet=/representation=.*\.\$(\w+)[&]*/,_reg1=/{[^}]+}/g,_reg2=/[{}]/g,_Prototype=utils.defineClass(function Prototype(json,parent){var self=this;this.json=json||{},typeof this.json=="string"&&(this.json=JSON.parse(self.json)),parent&&(this.parent=parent),this.init()},null,{init:function(){var props=this.json.$properties;if(!props)return;for(var p in props)props[p].$type==="application/x-reference"&&this.initRefField(props[p],p)},destroy:function(){this.parent=null,this.json=null},data:function(prop,dataContext,ignoreParent,noResolve){if(!prop||prop.length==0)return null;var val=this.json[prop];if(val==null){ignoreParent==null&&["$title","$description"].indexOf(prop)>-1&&(ignoreParent=!0);var pVal=ignoreParent!==!0&&this.parent?this.parent.data(prop,dataContext,null,!0):val;return pVal!=null&&(this.json[prop]=pVal),pVal}return noResolve?val:this.resolveExpression(val,dataContext,!0)},property:function(name,prop,dataContext){if(!name||name.length===0)return null;var o=this.json.$properties?this.json.$properties[name]:this.parent?this.parent.property(name):null;return!o||!prop?o:this.resolveExpression(o[prop],dataContext)},isReference:function(propname){var res;if(this._cacheRef!=null){res=this._cacheRef[propname];if(res!=null)return res}var p=this.property(propname);return res=p!=null&&p.$type==="application/x-reference",this._cacheRef||(this._cacheRef={}),this._cacheRef[propname]=res,res},isArray:function(){return this.json.$type==="application/x-array"},isBlob:function(){var t=this.json.$type;return t==="image"||t==="application/x-document"||t==="application/x-array"},isHidden:function(){return this.json.$isHidden===!0||!1},resolveExpression:function(val,dataContext,searchInParent,keepPlaceholder){return val&&val.indexOf&&val.indexOf("{")>=0&&(val=utils.parseExpression(val,dataContext,this,searchInParent,keepPlaceholder)),val},localization:function(val){var self=this,loc=self.json.$localization||{};return loc[val]?loc[val]:self.parent?self.parent.localization(val):null},getPrototype:function(prop,override,facet){var json;if(prop.indexOf(".")>0)json=this.getDataByPath(prop);else if(prop==="$item"){json=this.data(prop);if(this.isSingleArray(!0)){var newJson={$properties:{},$type:"application/json"};newJson.$properties[globals.SINGLEARRAYPROP]=json,json=newJson}}else json=this.property(prop);if(!json)return null;override=$.extend(!0,{},json,override);var proto=exports.create(override,this);return proto.json.$links&&Object.keys(proto.json.$links).forEach(function(key){key.indexOf("$")!=0&&(proto.json.$links[key].$url&&proto.json.$links[key].$url.indexOf("http")==0||proto.json.$links[key].$url==="")&&(proto.json.$format=proto.json.$format||"$url",proto.json.$urlkey=key)}),facet&&(proto._facet=facet),proto},isCube:function(){return this.isFacet("cube")},isQuery:function(){return this.isFacet("query")},isLookup:function(){return this.isFacet("lookup")},isQueryLikeFacet:function(){return this.isQuery()||this.isLookup()||this.isCube()||this.isRequest()},isDetails:function(){return this.isFacet("details")},isRequest:function(){return this.json.codeRequest!=null&&this.json.codeRequest.length>0},isStatistics:function(){return this.json.codeStat!=null&&this.json.codeStat.length>0},acceptServerPagination:function(){return this.isQuery()||this.isLookup()||this.isRequest()},isFacet:function(){return Array.prototype.indexOf.call(arguments,this.getFacet())>=0},formatDisplay:function(prop,dataContext){var self=this,info=self.property(prop)},addProperty:function(name,descr){var self=this;descr&&self.json.$properties&&!self.json.$properties[name]&&(self.json.$properties[name]=descr)},getPropTitle:function(propName){var self=this,prop=self.property(propName);return prop&&prop.$title?self.resolveExpression(prop.$title):""},getUrlLink:function(propName){var prop=this.property(propName,"$links");return prop?prop[this.json.$urlkey]:null},getFacet:function(){if(this._facet==null){var p=this,t;while(p!=null&&t==null)p.json.$url!=null&&p.json.$url.trim().length!=0&&(t=_testFacet.exec(p.json.$url),t=t!=null&&t.length==2?t[1]:null),p=p.parent;this._facet=t||""}return this._facet},getFieldNameForValue:function(name){var prop=this.property(name);return!prop||!prop.$item?name:prop.$item.$refValue||name},getFieldTypeForValue:function(name){var prop=this.property(name),$type=prop&&prop.$type?prop.$type:"application/x-string";return $type==="application/x-quantity"?(prop.$value&&($type=prop.$value.$type),$type=$type||"application/x-integer"):$type==="application/x-reference"&&(prop.$item&&($type=prop.$item.$refValueType),$type=$type||"application/x-string"),$type},initRefField:function(protoField,name){var self=this;if(!protoField)throw new Error("Field proto expected["+name+"]");var item=protoField.$item;if(!item||item.$refValue)return;item.$refValue=item.$lookupValue=name;if(item.$value&&typeof item.$value=="string"){var vals=item.$value.match(_reg1);if(!vals||vals.length!=1)throw new Error("Prototype.initRefField - Only one value is expected");var f1=vals[0].replace(_reg2,"").trim();item.$lookupValue=f1;if(item[f1]){var f2=item[f1].replace(_reg2,"").trim();self.property(f2)&&(item.$refValue=f2)}else item.$refValue=f1}if(item.$refValue){var p=self.property(item.$refValue);p&&p.$type&&(item.$refValueType=p.$type)}item.$autoLookWhere==null&&this._setAutoLookupWhere(item)},_setAutoLookupWhere:function(item){var url=item.$links&&item.$links.$lookup?item.$links.$lookup.$url:"";if(url&&item.$key&&item.$value!=item.$key){var key=utils.splitSdataKey(item.$key),where=null;key.forEach(function(k){if(!k||k==item.$value)return;if(!k.smStartsWith("{")&&!k.smEndsWith("}"))return;var propName=k.replace(/[{}]/g,""),valName=propName;item[propName]&&(valName=item[propName],valName=valName&&valName.replace(/[{}]/g,"")),where=where||{},where[propName]=valName}),where&&(item.$autoLookWhere=where)}},getDataByPath:function(path){return this._cachePath||(this._cachePath={}),utils.getPropByPath(this.json,path,this._cachePath)},getVignetteGadget:function(){return this.data("$gadget")},getUnitFieldInfo:function(){var self=this,res={};res.$unit=self.data("$unit");if(typeof res.$unit=="object")res.unitBindName="$unit",res.unitFieldProto=exports.create($.extend({},self.$unit));else if(typeof res.$unit=="string"){res.unitBindName=res.$unit;var parent=self.parent;while(parent){var unitProto=parent.property(res.$unit);if(unitProto){res.unitFieldProto=exports.create($.extend({},unitProto));break}parent=parent.parent}}return res},isSingleArray:function(noFail,field){var jsonArray;if(field!=null)jsonArray=this.property(field);else{if(this.$singleArray)return this.$singleArray;jsonArray=_getArrayJsonProto(this)}if(jsonArray==null&&noFail)return!1;if(jsonArray==null)throw new Error("Unexpected parent array");var res=articleParser.isSingleArray(jsonArray);return field!=null&&(this.$singleArray=res),res},getPropertyNames:function(){var props=this.json.$properties;return props?Object.keys(props):[]},getProperties:function(select){var props=this.json.$properties,$properties=[];return Object.keys(props).forEach(function(v){select(props[v],v)&&($properties[v]=$.extend(!0,{},props[v],{}))}),$properties},create:function(json,notChild){return exports.create($.extend(!0,{},json),notChild===!0?null:this)},arrayTableGetColInfo:function(){var base={$title:"",$titleOrig:"",$type:"",$bind:"",$widthType:"auto",$imgHeight:"small",$widthVal:0,$capabilities:""},res=[];if(this.isSingleArray()){var prop=this.getDataByPath("$item"),p=$.extend({},base,prop);p.$title=this.resolveExpression(this.$title),p.$titleOrig=this.$title,p.$bind=globals.SINGLEARRAYPROP,res.push(p)}else{var props=this.getDataByPath("$item.$properties");if(!props)return null;var prop,self=this,itemProto=this.getPrototype("$item");Object.keys(props).forEach(function(key){prop=props[key];if(prop.$isHidden!==!0&&prop.$isExcluded!==!0&&globals.EXCLUDEFIELDS.indexOf(key)<0){var p=$.extend({},base,prop);p.$title=self.resolveExpression(prop.$title),p.$titleOrig=prop.$title,p.$bind=key,p.$bindValue=itemProto.getFieldNameForValue(key),p.$bindType=itemProto.getFieldTypeForValue(key),res.push(p)}})}return res},chartGetMeasureInfo:function(){var res={},prop,props=this.getDataByPath("$item.$properties"),measures=this.getDataByPath("$cube.$measures");return measures&&Object.keys(measures).forEach(function(key){prop=props[key],prop.$bind=key,res[key]=prop}),res},chartGetNbMeasures:function(){var res=0,measures=this.getDataByPath("$cube.$measures");return measures&&Object.keys(measures).forEach(function(key){res++}),res},getRepDotFacet:function(){var self=this;return self.data("$type").split(".").slice(-2).join(".")},isValid:function(){return this.json!=null},getLayoutCategoriesTitle:function(){function _walk($layout){if(!$layout)return;return $layout.$items.forEach(function(item){var tit={};item.$title&&!uniqTitle[item.$title]&&(uniqTitle[item.$title]={},tit.value=item.$title,tit.title=self.resolveExpression(item.$title),title.push(tit)),_walk(item.$layout)}),title}var title=[],uniqTitle={},self=this;return _walk(this.getDataByPath("$article.$layout")),title},getAllX3Title:function(){var title=[],self=this,localization=self.json.$localization||{};return Object.keys(localization).forEach(function(key){var tit={};tit.value="{"+key+"}",tit.title=localization[key],title.push(tit)}),title.sort(function(a,b){var aTit=a.title.toLowerCase(),bTit=b.title.toLowerCase();return aTit<bTit?-1:aTit>bTit?1:0})}});exports.getRowIdxProto=function(){return exports.create({$type:"tablet/x-row-index"})},exports.create=function(json,parent){return new _Prototype(json,parent)}}),define("syracuse-tablet/html/js/authoring/authoringArticleGen",["require","exports","module","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/articleParser"],function(require,exports,module){function _generateRegularArticle(proto,orientation,tpl,synch){proto=$.isPlainObject(proto)?proto:proto.json,proto.$type==="application/x-array"&&(proto=proto.$item);var props=proto.$properties,$items,prop,forceNoTitle=_getFacet(proto.$url)==="query";if(orientation==="horizontal"){article={$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"",$items:[]}]};if(tpl===!1)return $.smResolve(article);var groupItems=article.$items[0].$items,maxItemsPerGroup=4,itemsPerGroup=maxItemsPerGroup,tileItems,singlePropTypes=["application/x-array","application/x-document","image"];for(var p in props){prop=props[p];if(prop.$isExcluded!==!0){if(singlePropTypes.indexOf(prop.$type)>-1){var tile={$layoutType:"tile",$size:"large",$items:[]};groupItems.push(tile),tileItems=tile.$items,itemsPerGroup=maxItemsPerGroup}else if(itemsPerGroup>=maxItemsPerGroup){itemsPerGroup=0;var tile={$layoutType:"tile",$size:"large",$items:[]};groupItems.push(tile),tileItems=tile.$items}itemsPerGroup+=1;var a={$bind:p};forceNoTitle?a.$isTitleHidden=forceNoTitle:a.$labelPosition="top",tileItems.push(a)}}}else{var article={$layoutType:"stack",$items:[]};if(tpl===!1)return $.smResolve(article);if(!proto||!proto.$article||!proto.$article.$layout){$items=article.$items;for(var p in props){prop=props[p];if(prop.$isExcluded!==!0){var a={$bind:p};forceNoTitle&&(a.$isTitleHidden=forceNoTitle),$items.push(a)}}}else articleParser.coreLayout2DefaultLayout(proto,article,props)}return synch===!0?article:$.smResolve(article)}var jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),articleParser=require("syracuse-tablet/html/js/helpers/articleParser"),_testFacet=/representation=.*\.\$(\w+)[&]*/,_getFacet=function($url){var t=_testFacet.exec($url||"");return t!=null&&t.length==2?t[1]:null};exports.genNewArticle=function(opts,synch){var proto;return proto=opts.page.prototype,jsutils.isInstanceOf(opts.page,"DashboardPage")?exports.generateDashboardArticle(proto,opts.orientation,opts.template,synch):_generateRegularArticle(proto,opts.orientation,opts.template,synch)},exports.generateDashboardArticle=function(proto,orientation,tpl,synch){var article;proto=$.isPlainObject(proto)?proto:proto.json;var props=proto.$properties;if(orientation==="horizontal"){article={$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"",$items:[]}]};if(tpl===!1)return $.smResolve(article);Object.keys(props).forEach(function(key){var prop=props[key];article.$items[0].$items.push({$layoutType:"tile",$size:"medium",$items:[{$bind:key}]})})}else{article={$layoutType:"stack",$items:[]};if(tpl===!1)return $.smResolve(article);var cellCount=4,row;Object.keys(props).forEach(function(key){cellCount===4&&(cellCount=0,row={$layoutType:"row",$items:[]},article.$items.push(row));var prop=props[key];row.$items.push({$layoutType:"cell",$widthXs:12,$widthSm:6,$widthMd:4,$widthLg:3,$items:[{$bind:key}]})})}return synch===!0?article:$.smResolve(article)}}),define("syracuse-tablet/html/js/helpers/dashboardUtils",["require","exports","module","syracuse-tablet/html/js/helpers/prototype","syracuse-tablet/html/js/authoring/authoringArticleGen"],function(require,exports,module){function _getUnbindGadgets(article,prototype){var unbind=_getUnbindProperties(article,prototype.getPropertyNames()),gadgets=[],gadget={},$gadget;return unbind.forEach(function(value){value!=="$welcome_$welcomeApplication"&&($gadget=prototype.getDataByPath("$properties."+value).$gadget,gadget={title:$gadget.$title,type:$gadget.$type,description:$gadget.description,uuid:$gadget.$uuid,icon:$gadget.icon,applicationName:$gadget.applicationName},gadgets.push(gadget))}),gadgets}function _getUnbindProperties(article,propertyNames){var binded=_getListOfBinds(article),unbind=propertyNames.filter(function(value){return!binded[value]});return unbind}function _getListOfBinds($article){function _walk(items){if(!items)return;return items.forEach(function(item){item.$bind&&(binds[item.$bind]={}),_walk(item.$items)}),binds}var binds={};return _walk($article.$items),binds}function _getHubGroupList($article){function _walk(items){if(!items)return;return items.forEach(function(item){item.$layoutType==="hubGroup"&&hubGroup.push(item),_walk(item.$items)}),hubGroup}var hubGroup=[];return _walk($article.$items),hubGroup}var prototype=require("syracuse-tablet/html/js/helpers/prototype"),authArticleGen=require("syracuse-tablet/html/js/authoring/authoringArticleGen"),_getDashboardProto=function(dash){var proto={$title:dash.$title,$description:dash.$description,$properties:{},$dashboardName:dash.$dashboardName},vignetteIds=Object.keys(dash.$vignettes||[]);for(var i=0;i<vignetteIds.length;i++){var vignetteId=vignetteIds[i],property=$.extend({},dash.$vignettes[vignetteId]),gadgetId=property.$uuid;property.$gadget=dash.$gadgets[gadgetId],property.$gadget?(property.$gadget=$.extend({},property.$gadget),property.$gadget.$uuid=gadgetId,property.$uuid=vignetteId,property.$type="tablet/x-vignette",property.$title=property.$gadget.$title):(property.$gadget={$uuid:gadgetId,$type:"$gadgetMissing"},property.$uuid=vignetteId,property.$type="tablet/x-vignette"),proto.$properties[vignetteId]=property}return prototype.create(proto)},_getDashboardArticle=function(proto){return authArticleGen.generateDashboardArticle(proto,"orientation")},_getDashboardInfo=function(dashboardMetaData){return $.smResolve().then(function(){var article=dashboardMetaData.$article,proto=_getDashboardProto(dashboardMetaData),views=dashboardMetaData.$views,roles=dashboardMetaData.roles,appList=dashboardMetaData.appList,factoryOwner=dashboardMetaData.$factoryOwner;return article?{article:$.extend({},article),prototype:proto,views:views,appList:appList,factoryOwner:factoryOwner,roles:roles}:_getDashboardArticle(proto).then(function(article){return dashboardMetaData.$article=article,{article:$.extend({},article),prototype:proto,views:views,appList:appList,roles:roles}})})};exports.getDashboardInfo=_getDashboardInfo,exports.getDashboardArticle=_getDashboardArticle,exports.getDashboardProto=_getDashboardProto,exports.getUnbindProperties=_getUnbindProperties,exports.getUnbindGadgets=_getUnbindGadgets,exports.getHubGroupList=_getHubGroupList}),define("syracuse-tablet/html/js/application/appFactory",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/dashboardUtils","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),dashboardUtils=require("syracuse-tablet/html/js/helpers/dashboardUtils"),locale=require("syracuse-tablet/html/js/helpers/locale"),_ctor={Application:function(){throw new Error("Not implemented")},DashoardPage:function(){throw new Error("Not implemented")},RegularPage:function(){throw new Error("Not implemented")},RequestPage:function(){throw new Error("Not implemented")},RowDetailPage:function(){throw new Error("Not implemented")},ChartDetailPage:function(){throw new Error("Not implemented")},LookupPage:function(){throw new Error("Not implemented")},LoginPage:function(){throw new Error("Not implemented")},DaoApp:function(){throw new Error("Not implemented")},DaoSdata:function(){throw new Error("Not implemented")},DaoSdataWrkcpy:function(){throw new Error("Not implemented")},DraftsPage:function(){throw new Error("Not implemented")}},_createApplication=function($$elmt){var res=new _ctor.Application($$elmt,exports);return res.init(),res},_createPage=function($parent,state,parentPage,$forceLinkArticle){var type=state.type,options={};return $.smResolve().then(function(){switch(type){case"static":if(state.subtype==="html")switch(state.name){case"login":return new _ctor.LoginPage($parent,state,options);case"pageDrafts":return new _ctor.DraftsPage($parent,state,options)}break;case"dashboard":return globals.getMetaData().getDashboard(state.dashboardName).then(function(dashboardMetaData){return dashboardMetaData?dashboardUtils.getDashboardInfo(dashboardMetaData):$.smReject({message:locale.text("error.page.not.found",[state.dashboardName])})}).then(function(dashboardInfo){return options.views=$.extend([],dashboardInfo.views),state.isWelcomePage===!0?(options.roles=dashboardInfo.roles,options.factoryOwner=dashboardInfo.factoryOwner,options.css="s-m-",new _ctor.WelcomeDashoardPage($parent,state,dashboardInfo.prototype,dashboardInfo.article,options)):new _ctor.DashoardPage($parent,state,dashboardInfo.prototype,dashboardInfo.article,options)});case"regular":case"chartdetail":case"rowdetail":case"carddesign":return globals.getMetaData().getPageDetails(state).then(function(info){if(!info)return $.smReject({message:locale.text("error.page.not.found",[state.name])});if(info.prototype.isLookup())return new _ctor.LookupPage($parent,state,info.prototype,info.article,options);if(type==="rowdetail")return new _ctor.RowDetailPage($parent,state,info.prototype,info.article,parentPage,options);if(type==="regular")return $forceLinkArticle&&(state.forceLinkArticle=$forceLinkArticle),options.views=$.extend([],info.views),info.prototype&&(info.prototype.isRequest()||info.prototype.isStatistics())?new _ctor.RequestPage($parent,state,info.prototype,$forceLinkArticle?$forceLinkArticle:info.article,options):new _ctor.RegularPage($parent,state,info.prototype,$forceLinkArticle?$forceLinkArticle:info.article,options);if(type==="carddesign")return new _ctor.CardDesignPage($parent,state,info.prototype,info.article,parentPage,options);if(type==="chartdetail")return new _ctor.ChartDetailPage($parent,state,info.prototype,info.article,parentPage,options)})}}).then(function(pageInstance){if(!pageInstance)throw new Error("Error creating page. Type: "+type+" Name: "+state.name+" Subtype: "+state.subtype);return pageInstance.pageInitAsync?pageInstance.pageInitAsync().then(function(){return pageInstance}):pageInstance})},_createDaoApp=function(appli){return new _ctor.DaoApp(appli)},_createDaoSdata=function(data,prototype,options){return options=options||{},new _ctor[options.enableWorkingCopy===!0?"DaoSdataWrkcpy":"DaoSdata"](data,prototype,options)},_createDaoRowDetail=function(parentDao,controller,proto){return _createDaoSdata($.extend(!0,{},parentDao.data),proto,{isRowDetailDao:!0,enableWorkingCopy:!1,parent:parentDao.parent,$bind:parentDao.$bind})};exports.setImpl=function(name,ctor){_ctor[name]=ctor},exports.createApplication=_createApplication,exports.createPage=_createPage,exports.createDaoApp=_createDaoApp,exports.createDaoSdata=_createDaoSdata,exports.createDaoRowDetail=_createDaoRowDetail}),define("syracuse-tablet/html/js/sdata/sdataUtils",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),_rID=/^(.*)\(\'(.*)\'\)$/i,_parseSDataURL=function(url,noFail){var res=jsutils.parseURL(url);if(res.query&&res.query.representation){res.representation=res.query.representation,res.facet=null;var p=res.representation.indexOf(".");p!=-1&&(res.facet=res.representation.substr(p+1),res.facet.charAt(0)=="$"&&(res.facet=res.facet.substr(1)),res.representation=res.representation.substr(0,p))}var a;if(res.directory){var idx=res.directory.indexOf("/$services/");idx>-1&&(res.$services=res.directory.substring(idx+11)),a=res.directory.split("/")}if(a==null||a.length<=4){if(noFail===!0)return null;throw new Error("Bad sdata url:"+url)}res.dispatch=a[1];if(res.dispatch!=="mobile1"&&res.dispatch!=="sdata"){if(noFail===!0)return null;throw new Error("Bad sdata url:"+url)}res.application=a[2],res.contract=a[3],res.dataset=a[4];if(a.length===4)return res;var match=_rID.exec(a[5]);return match&&match.length==3?(res.entity=match[1],res.id=match[2],res.id&&res.id.trim().Length===0&&(res.id=null)):(res.entity=a[5],res.id=null),a.length===5?res:res},_getLinkInfo=function(sDataUrl,dao,nofail){sDataUrl=dao?dao.parseExpression(sDataUrl):sDataUrl;var url=_parseSDataURL(sDataUrl,nofail);if(url==null)return null;if(url.entity==="$mobileDashboards"){var res={page:url.query.dashboard+".$mobileDashboard"};return url.query.parameters&&(res.parameters=utils.parseExpression(url.query.parameters,dao)),res}if(url.query.representation){var ep=url.application+"."+url.contract+"."+url.dataset,res={page:ep+(url.query.representation?"."+url.query.representation:""),sDataUrl:sDataUrl};return url.$services&&(res.$services=url.$services),res}if(nofail===!0)return null;throw new Error("getLinkInfo - Unexpected empty representaion in ul "+sDataUrl)},_getLinkAttrs=function(linkInfo,dao){typeof linkInfo=="string"&&(linkInfo=_getLinkInfo(linkInfo,dao));if(linkInfo.type==="navig")return'data-nav="'+linkInfo.page+'" data-sdata-url="'+encodeURIComponent(linkInfo.sDataUrl)+'"';if(linkInfo.type==="act")return'data-action="'+linkInfo.action+'" data-params="'+encodeURIComponent(linkInfo.params||"")+'"';throw new Error("_getLinkAttrs - unknonwn type\n"+linkInfo.type)},_clearSyracuseStack=function(d){return d.$stackTrace&&d.$stackTrace.indexOf("node_modulessyracuse-x3")>=0&&(d.$message&&d.$stackTrace.indexOf(d.$message)>=0?delete d.$stackTrace:d.$stackTrace=d.$stackTrace.split("\n")[0]),d},_scanDiagnoses=function(data){var result=[],done=[],_scan=function(o,prop,path){path||(path=[]);if(done.indexOf(o)>=0)return;if(Array.isArray(o))done.push(o),prop&&path.push(prop),o.forEach(function(e,idx){_scan(e,idx+"",path)}),prop&&path.pop(prop);else if($.isPlainObject(o)){done.push(o);for(var p in o)p==="$diagnoses"?o[p].forEach(function(d){var $path=[].concat(path);prop&&$path.push(prop),p&&$path.push(p),d=_clearSyracuseStack($.extend({},d)),d.$path=$path.join("."),result.push(d)}):(prop&&path.push(prop),_scan(o[p],p,path),prop&&path.pop(prop))}};return data!=null&&_scan(data),result},_addWhereClause=function(url,where,params){params=params||{};var allParamsSet=!0;where=where.value;var res=where.replace(/\{(\w*?)\}/g,function(m,p1){var value=params[p1];return value==null&&(allParamsSet=!1),value!=null?value:""});return allParamsSet&&(url=url+"&where="+res),url};exports.parseSDataURL=_parseSDataURL,exports.getLinkInfo=_getLinkInfo,exports.getLinkAttrs=_getLinkAttrs,exports.scanDiagnoses=_scanDiagnoses,exports.addWhereClause=_addWhereClause}),define("syracuse-tablet/html/js/sdata/sdataHttp",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/ajax/ajax","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("sDataHttp"),ajax=require("syracuse-tablet/html/js/ajax/ajax").getAjax().ajax,locale=require("syracuse-tablet/html/js/helpers/locale"),_forceOptions={noJsonParsing:!0},_send=function(params){var deferred=$.Deferred(),params=params||{};params.options=$.extend(params.options||{},_forceOptions),params.headers=params.headers||{},params.headers["Accept-Language"]=locale.getCurrentLocale();try{log&&log("_httpSend - Begin - Method:"+params.method+"\n	"+params.url),ajax(params.method,params.url,params.send,params.headers,params.options).then(function(result){log&&log("_httpSend - End - status="+result.status+" - "+result.textStatus);if(!result.responseJSON){var responseText=result.responseText?result.responseText.trim():"";responseText.length>0&&["{","["].indexOf(responseText.charAt(0))>=0?result.responseJSON=JSON.parse(responseText):result.responseJSON=null}result.status===404&&(result.responseJSON||(result.responseJSON={}),result.responseJSON.$diagnoses||(result.responseJSON.$diagnoses=[]),result.responseJSON.$diagnoses.unshift({$message:locale.text("http404"),$stackTrace:params.url,$severity:"error"})),deferred.resolve(result)}).fail(function(e){deferred.reject(e)})}catch(e){deferred.reject(e)}return deferred.promise()};exports.send=_send}),define("syracuse-tablet/html/js/sdata/sdataCommonResources",["require","exports","module","syracuse-tablet/html/js/sdata/sdataUtils","syracuse-tablet/html/js/sdata/sdataHttp","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ajax/ajax"],function(require,exports,module){function _checkResult(result){return result&&result.isSuccess&&result.responseJSON&&!$.isEmptyObject(result.responseJSON)}function _fetchAll(urlQuery,noFailIfNoConnection){function _fetchPage(url){var params={method:"GET",url:url};params.parsedUrl=sdataUtils.parseSDataURL(params.url),sdataHttp.send(params).then(function(result){var data=result&&result.responseJSON;if(data&&data.$noConnectionError===!0&&noFailIfNoConnection===!0){deferred.resolve([],!0);return}if(result&&result.status!==200){var message;result.status===401?message=locale.text("error.session.timeout"):data&&data.$diagnoses&&data.$diagnoses.length>0?message=data.$diagnoses[0].$message:message=locale.text("fetchurl.error",[params.parsedUrl.contract+"/"+params.parsedUrl.entity,result.status]),deferred.reject({$message:message,$redirectPage:"login"})}data&&data.$resources&&data.$resources.forEach(function(i){list.push(i)}),data&&data.$links&&data.$links.$next&&data.$links.$next.$url?_fetchPage(data.$links.$next.$url):deferred.resolve(list,!1)}).fail(function(e){deferred.reject(e)})}var deferred=$.Deferred(),list=[];return _fetchPage(urlQuery),deferred.promise()}var sdataUtils=require("syracuse-tablet/html/js/sdata/sdataUtils"),sdataHttp=require("syracuse-tablet/html/js/sdata/sdataHttp"),globals=require("syracuse-tablet/html/js/helpers/globals"),locale=require("syracuse-tablet/html/js/helpers/locale"),ajax=require("syracuse-tablet/html/js/ajax/ajax"),_appListUrl="/sdata/syracuse/collaboration/syracuse/mobileApplications/$service/availableApplications",_localePreferencesUrl="/sdata/syracuse/collaboration/syracuse/localePreferences?representation=localePreference.$bulk",_userProfileUrl="/sdata/syracuse/collaboration/syracuse/userProfiles/$service/current",_userProfileUpdtUrl="/sdata/syracuse/collaboration/syracuse/userProfiles/$service/updateProfile",_userProfileSettingsUrl="/sdata/syracuse/collaboration/syracuse/userProfiles/$service/settings",_createSharedContextUrl="/requireJS/sharedContext/create",_readSharedContextUrl="/requireJS/sharedContext/read?uuid=",_connectionAliveUrl="/requireJS/misc/connectionAlive",_welcomeDashboardUpdtUrl="/sdata/syracuse/collaboration/syracuse/welcomeDashboards/$service/updateDashboard",_welcomeDashboardUrl="/sdata/syracuse/collaboration/syracuse/welcomeDashboards/$service/availableDashboard",_welcomeDashboardDeleteUrl="/sdata/syracuse/collaboration/syracuse/welcomeDashboards/$service/deleteDashboard",_roleListUrl="/sdata/syracuse/collaboration/syracuse/welcomeDashboards/$service/listOfRoles";exports.queryAllApplications=function(){try{var params={method:"GET",url:_appListUrl};return params.parsedUrl=sdataUtils.parseSDataURL(params.url),sdataHttp.send(params).then(function(result){return _checkResult(result)?result.responseJSON.$resources:ajax.rejectHttpResult(locale.text("err.load.applst"),result,params.url)})}catch(e){return $.smReject(e)}},exports.queryApplicationDetail=function(appHeader,endpoint){try{var params={method:"GET",url:appHeader.$metaDataUrl+"?endpoint="+endpoint};return params.parsedUrl=sdataUtils.parseSDataURL(params.url),sdataHttp.send(params).then(function(result){return _checkResult(result)?result.responseJSON:ajax.rejectHttpResult(locale.text("err.load.appdetail",[appHeader.applicationName]),result,params.url)})}catch(e){return $.smReject(e)}},exports.queryLocalePreferences=function(noFailIfNoConnection){return _fetchAll(_localePreferencesUrl,noFailIfNoConnection).then(function(result){var locales=[];return result.forEach(function(locale){locales.push({$uuid:locale.$uuid,code:locale.code,description:locale.description})}),locales})},exports.getUserProfile=function(){try{var params={method:"GET",url:_userProfileUrl};return params.parsedUrl=sdataUtils.parseSDataURL(params.url),sdataHttp.send(params).then(function(result){return _checkResult(result)?result.responseJSON:ajax.rejectHttpResult(locale.text("err.load.profile"),result,params.url)})}catch(e){return $.smReject(e)}},exports.updateUserProfile=function(changes){try{var params={method:"POST",url:_userProfileUpdtUrl,send:changes};return params.parsedUrl=sdataUtils.parseSDataURL(params.url),sdataHttp.send(params).then(function(result){return _checkResult(result)?result.responseJSON:ajax.rejectHttpResult("Error updating profile",result,params.url)})}catch(e){return $.smReject(e)}},exports.getUserProfileSettings=function(){try{var params={method:"GET",url:_userProfileSettingsUrl};return params.parsedUrl=sdataUtils.parseSDataURL(params.url),sdataHttp.send(params).then(function(result){if(_checkResult(result)){result=result.responseJSON;var err=[];return result.roles.length<1&&err.push("unexpected empty roles list"),result.locales.length<1&&err.push(locale.text("unexpected empty languages list")),err.length==0?result:(err.push(locale.text("contact.admin")),$.smReject({$redirectPage:"login",$title:"Bad user configuration",$diagnoses:[{$message:err.join("\n")}]}))}return ajax.rejectHttpResult("Error reading profile settings",result,params.url)})}catch(e){return $.smReject(e)}},exports.createSharedContext=function(linkCtx,lifespan){lifespan=(lifespan==undefined?3:lifespan)*24;var params={method:"POST",url:_createSharedContextUrl,send:{lifespan:lifespan,linkCtx:linkCtx}};return sdataHttp.send(params).then(function(result){return result.isSuccess&&result.responseJSON&&result.responseJSON.$uuid?result.responseJSON.$uuid:null})},exports.readSharedContext=function(uuid){uuid||$.smResolve(null);var params={method:"get",url:_readSharedContextUrl+uuid};return sdataHttp.send(params).then(function(result){var context=result.isSuccess?result.responseJSON:null;return!context||!context.endpoint||!context.currentState||!context.applicationName?(globals.getModal()&&globals.getModal().notify(locale.text("urlcontext.bad"),locale.text("urlcontext.cantopen")),console.log("Bad url context","Can't open the page",JSON.stringify(context,null,2)),null):context}).fail(function(e){return console.log("readSharedContext error",e.message),null})},exports.isConnectionAlive=function(){return sdataHttp.send({method:"get",url:_connectionAliveUrl}).then(function(result){return result&&result.isSuccess}).fail(function(e){return!1})},exports.queryWelcomeDashboard=function(uuid){var params;return $.smResolve().then(function(){return params={method:"GET",url:_welcomeDashboardUrl+"?user="+globals.getUserUuid()+"&role="+globals.getSeletedRoleUuid()+(uuid?"&uuid="+uuid:"")},params.parsedUrl=sdataUtils.parseSDataURL(params.url),sdataHttp.send(params)}).then(function(result){return _checkResult(result)?result.responseJSON.$resources:ajax.rejectHttpResult(locale.text("err.load.welcomeDashboards"),result,params.url)})},exports.queryRoles=function(){var params;return $.smResolve().then(function(){return params={method:"GET",url:_roleListUrl},params.parsedUrl=sdataUtils.parseSDataURL(params.url),sdataHttp.send(params)}).then(function(result){return _checkResult(result)?result.responseJSON.$resources:ajax.rejectHttpResult(locale.text("err.load.welcomeDashboards"),result,params.url)})},exports.updateWelcomeDashboard=function(data){try{var params;return $.smResolve().then(function(){return params={method:"POST",url:_welcomeDashboardUpdtUrl,send:data},params.parsedUrl=sdataUtils.parseSDataURL(params.url),sdataHttp.send(params)}).then(function(result){return _checkResult(result)?result.responseJSON:ajax.rejectHttpResult(locale.text("dashboard.welcome.updating.error"),result,params.url)})}catch(e){return $.smReject(e)}},exports.deleteWelcomeDashboard=function(uuid){try{var params;return $.smResolve().then(function(){return params={method:"GET",url:_welcomeDashboardDeleteUrl+"?uuid="+uuid+"&user="+globals.getUserUuid()+"&role="+globals.getSeletedRoleUuid()},params.parsedUrl=sdataUtils.parseSDataURL(params.url),sdataHttp.send(params)}).then(function(result){return _checkResult(result)?result.responseJSON:ajax.rejectHttpResult(locale.text("dashboard.welcome.deleting.error"),result,params.url)})}catch(e){return $.smReject(e)}}}),define("syracuse-tablet/html/js/helpers/base64",["require","exports","module"],function(require,exports,module){var Base64=exports.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(input){var output="",chr1,chr2,chr3,enc1,enc2,enc3,enc4,i=0;input=Base64._utf8_encode(input);while(i<input.length)chr1=input.charCodeAt(i++),chr2=input.charCodeAt(i++),chr3=input.charCodeAt(i++),enc1=chr1>>2,enc2=(chr1&3)<<4|chr2>>4,enc3=(chr2&15)<<2|chr3>>6,enc4=chr3&63,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+this._keyStr.charAt(enc1)+this._keyStr.charAt(enc2)+this._keyStr.charAt(enc3)+this._keyStr.charAt(enc4);return output},decode:function(input){var output="",chr1,chr2,chr3,enc1,enc2,enc3,enc4,i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length)enc1=this._keyStr.indexOf(input.charAt(i++)),enc2=this._keyStr.indexOf(input.charAt(i++)),enc3=this._keyStr.indexOf(input.charAt(i++)),enc4=this._keyStr.indexOf(input.charAt(i++)),chr1=enc1<<2|enc2>>4,chr2=(enc2&15)<<4|enc3>>2,chr3=(enc3&3)<<6|enc4,output+=String.fromCharCode(chr1),enc3!=64&&(output+=String.fromCharCode(chr2)),enc4!=64&&(output+=String.fromCharCode(chr3));return output=Base64._utf8_decode(output),output},_utf8_encode:function(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);c<128?utftext+=String.fromCharCode(c):c>127&&c<2048?(utftext+=String.fromCharCode(c>>6|192),utftext+=String.fromCharCode(c&63|128)):(utftext+=String.fromCharCode(c>>12|224),utftext+=String.fromCharCode(c>>6&63|128),utftext+=String.fromCharCode(c&63|128))}return utftext},_utf8_decode:function(utftext){var string="",i=0,c1,c2,c3,c=c1=c2=0;while(i<utftext.length)c=utftext.charCodeAt(i),c<128?(string+=String.fromCharCode(c),i++):c>191&&c<224?(c2=utftext.charCodeAt(i+1),string+=String.fromCharCode((c&31)<<6|c2&63),i+=2):(c2=utftext.charCodeAt(i+1),c3=utftext.charCodeAt(i+2),string+=String.fromCharCode((c&15)<<12|(c2&63)<<6|c3&63),i+=3);return string},raw_decode:function(input){var output="",chr1,chr2,chr3,enc1,enc2,enc3,enc4,i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length)enc1=this._keyStr.indexOf(input.charAt(i++)),enc2=this._keyStr.indexOf(input.charAt(i++)),enc3=this._keyStr.indexOf(input.charAt(i++)),enc4=this._keyStr.indexOf(input.charAt(i++)),chr1=enc1<<2|enc2>>4,chr2=(enc2&15)<<4|enc3>>2,chr3=(enc3&3)<<6|enc4,output+=String.fromCharCode(chr1),enc3!=64&&(output+=String.fromCharCode(chr2)),enc4!=64&&(output+=String.fromCharCode(chr3));return output}};exports.encode=function(text){return Base64.encode(text)}}),define("syracuse-tablet/html/js/application/authentication",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/ajax/ajax","syracuse-tablet/html/js/sdata/sdataCommonResources","syracuse-tablet/html/js/helpers/base64","syracuse-tablet/html/js/helpers/native/native","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("auth",!1),globals=require("syracuse-tablet/html/js/helpers/globals"),ajaxLib=require("syracuse-tablet/html/js/ajax/ajax"),ajax=ajaxLib.getAjax().ajax,sdataCommonRes=require("syracuse-tablet/html/js/sdata/sdataCommonResources"),base64=require("syracuse-tablet/html/js/helpers/base64"),native=require("syracuse-tablet/html/js/helpers/native/native"),locale=null,_getText=function(id){return locale||(locale=require("syracuse-tablet/html/js/helpers/locale")),locale.text(id)},_config={svcLogin:"/auth/login/submit",svcLogout:"/logout",svcForgetMe:"/auth/forgetMe/submit",checkAuth:"/sdata/syracuse/collaboration/syracuse/userProfiles/$service/current",svcReconnectGetToken:"/requireJS/reconnect/getToken",svcReconnectSetToken:"/requireJS/reconnect/setToken",svcAvailableAuth:"/requireJS/misc/availableAuth"},_check=function(){return ajax("GET",_config.checkAuth,null,null,{dontCatchHttp401:!0}).then(function(result){if(result&&result.status===200&&result.responseJSON){var profile=result.responseJSON,deferred=$.Deferred(),nativeApp=native.getModule("nativeApp");return nativeApp?_reconnectGetToken().then(function(token,userLogin,sid){token&&userLogin&&nativeApp.setReconnectToken(token,userLogin,sid),deferred.resolve(profile)}).fail(function(){deferred.resolve(profile)}):deferred.resolve(profile),deferred.promise()}return result&&result.status===401?null:ajaxLib.rejectHttpResult("Check authentication failed",result)})},_getLoginHeader=function(user,password){return{Authorization:"Basic "+base64.encode(user+":"+password),accept:"application/json"}},_getLoginData=function(rememberMe){var data={forgetme:!0};return rememberMe===!0&&(data.keepConnected=!0),data},_login=function(user,password,rememberMe){var deferred=$.Deferred();return ajax("POST",_config.svcLogin,_getLoginData(rememberMe),_getLoginHeader(user,password),{dontCatchHttp401:!0}).then(function(result){result.status===0&&deferred.reject(_getText("no.connection"),!0);if(result.status!==200){var e=result.responseJSON&&result.responseJSON.$diagnoses&&result.responseJSON.$diagnoses.length>0?result.responseJSON:"Httpstatus: "+result.status;deferred.reject(e)}sdataCommonRes.getUserProfile().then(function(profile){profile?deferred.resolve(profile):deferred.reject("Unexpected null user profile")}).fail(function(e){deferred.reject(e)})}).fail(function(e){deferred.reject(e)}),deferred.promise()},_forgetme=function(){var deferred=$.Deferred();return ajax("POST",globals.baseLocation().host+_config.svcForgetMe,{forgetme:!0}).then(function(result){log&&log("_forgetme succeeded"),deferred.resolve(!0)}),deferred.promise()},_logout=function(){var deferred=$.Deferred();return ajax("POST",globals.baseLocation().host+_config.svcLogout).then(function(result){var msg,isSuccess=result.isSuccess||result.status===401||result.status===0;if(!isSuccess){msg="Httpstatus: "+result.status;var diag=result.responseJSON?result.responseJSON.$diagnoses:null;diag&&diag.forEach(function(d){msg+="\n"+d.$message})}deferred.resolve(isSuccess,msg)}),deferred.promise()},_parseReconnectCookie=function(cookie){if(!cookie)return null;cookie=cookie.split("/");if(cookie.length<3)return null;var token=cookie.pop(),series=cookie.pop(),login=cookie.join("/");return login},_reconnectGetToken=function(){var deferred=new $.Deferred;return ajax("GET",_config.svcReconnectGetToken,null,{accept:"application/json"}).always(function(result){if(result&&result.status===200&&result.headers){var token=result.headers["x-reconnect-token"],sid=result.headers["x-reconnect-sid"];log&&log("_reconnectGetToken",token,"sid",sid);var login=_parseReconnectCookie(token);deferred.resolve(login?token:null,login,sid)}else deferred.resolve(null)}),deferred.promise()},_reconnectSetToken=function(loginCookie,sidCookie){var deferred=new $.Deferred;return loginCookie=loginCookie||"",sidCookie=sidCookie||"",log&&log("_reconnectSetToken - Login: ",loginCookie," - sid: ",sidCookie),ajax("GET",_config.svcReconnectSetToken,null,{accept:"application/json","x-reconnect-token":loginCookie,"x-reconnect-sid":sidCookie}).then(function(result){log&&log("_reconnectSetToken succeeded",loginCookie,sidCookie),deferred.resolve()}).fail(function(result){log&&log("_reconnectSetToken failed"),deferred.resolve()}),deferred.promise()},_availableAuthentications=null,_checkAvailableAuthentications=function(){var deferred=new $.Deferred;return ajax("GET",_config.svcAvailableAuth,null,{accept:"application/json"}).then(function(result){_availableAuthentications=result.isSuccess&&result.responseJSON?result.responseJSON:null,log&&log("_availableAuthentications succeeded",JSON.stringify(_availableAuthentications,null,2)),deferred.resolve(_availableAuthentications)}).fail(function(result){log&&log("_availableAuthentications failed"),deferred.resolve(null)}),deferred.promise()},_sageidsigin=function(){window.location.href="/auth/sage-id/signOnStart"};exports.check=_check,exports.login=_login,exports.forgetme=_forgetme,exports.logout=_logout,exports.reconnectGetToken=_reconnectGetToken,exports.reconnectSetToken=_reconnectSetToken,exports.sageidsignin=_sageidsigin,exports.checkAvailableAuthentications=_checkAvailableAuthentications,exports.isAuthenticationAvail=function(auth){return _availableAuthentications!=null&&_availableAuthentications[auth]===!0}}),define("syracuse-tablet/html/js/ui/feedback",["require","exports","module"],function(require,exports,module){function _armFindRelated($$elmt){if($$elmt.hasClass("s-m-link-page")){var $$parent=$$elmt.closest(".s-m-tile");if($$parent&&$$parent.length>0)return[$$parent]}return[$$elmt]}function _armMouseDown(evt){var $$target=$(evt.target),$$actionElmt=$$target.closest("[data-nav], [data-nav-refresh], [data-action] , [data-disable-navigation]");if($$actionElmt.length>0){var rels=_armFindRelated($$actionElmt);if(rels&&rels.length>0){var i;for(i=0;i<rels.length;i++)rels[i].addClass("s-m-armed");Array.prototype.push.apply(_armedItems,rels)}}}function _armMouseUp(evt){var i;for(i=0;i<_armedItems.length;i++)_armedItems[i].removeClass("s-m-armed s-m-draggable");_armedItems=[]}var _highlightTO=200;exports.bindActions=function($$elmt){$$elmt.on("mousedown",":not(select)[data-nav], :not(select)[data-nav-refresh], :not(select)[data-action], :not(select)[data-disable-navigation]",_armMouseDown),$$elmt.on("mouseup",_armMouseUp)},exports.highlight=function($$elmt,cb){if(_highlightTO<=0){cb();return}$$elmt.addClass("s-m-highlighted"),setTimeout(function(){$$elmt.removeClass("s-m-highlighted"),cb()},_highlightTO)};var _armedItems=[]}),define("syracuse-tablet/html/js/application/eventListener",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/ui/modals/modal","syracuse-tablet/html/js/ui/feedback","syracuse-tablet/html/js/helpers/mobileDetect"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("evts"),globals=require("syracuse-tablet/html/js/helpers/globals"),locale=require("syracuse-tablet/html/js/helpers/locale"),utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),feedback=require("syracuse-tablet/html/js/ui/feedback"),mobileDetect=require("syracuse-tablet/html/js/helpers/mobileDetect"),_lastClick=null,_executeLink=function(handler,$$actionElmt){if(_lastClick!=null&&(new Date).getTime()-_lastClick<500){arguments[6]&&(arguments[6].stopPropagation(),arguments[6].preventDefault());return}_lastClick=(new Date).getTime();if(arguments.length<2)return;var args=Array.prototype.splice.call(arguments,2);if(!$$actionElmt)return handler.apply(null,args);feedback.highlight($$actionElmt,function(){handler.apply(null,args)})},_findParentCtrlId=function($$target,selector){var p=$$target.closest(".s-m-control"+(selector||"")+"[id]");return p.length>0?_attr(p,"id"):null},_attr=function($$e,name,nullIfEmpty,decode){var a=$$e.attr(name);a==null?a="":typeof a!="string"&&(a=new String(a)),a=a.trim();if(decode===!0){a=decodeURIComponent(a);if(a.smStartsWith("{")&&a.smEndsWith("}"))try{var json=JSON.parse(a);return json}catch(e){log.console("Error reading JSON attribute "+name+"\n	"+a)}}return nullIfEmpty&&a.length===0?null:a},_parseParameters=function(params){var p=params.split("&"),res={};for(var i=0;i<p.length;i++){var v=p[i].split("=");res[v[0]]=v[1]}return res},_findControlById=function(app,ctrlId,$$target){if(!app.currentPage)throw new Error("No current page");var ctrl=app.currentPage.getControl(ctrlId);if(ctrl)return ctrl;var controller=$$target.closest("[data-controller-id]");controller.length===0&&(controller=$("#"+ctrlId).closest("[data-controller-id]"));if(controller.length>0){var id=controller.attr("data-controller-id");controller=globals.getController(id),controller&&(ctrl=controller.getStructElmt(ctrlId))}if(ctrl)return ctrl;throw new Error("Control not found - ctrlid["+ctrlId+"]")},_doAction=function($$target,act,params,controlId,evt){var app=globals.getApplication(),_fail=function(e){var title=locale.text("actions.error");e=e||{},e.stack=e.stack?e.stack+"\n---\n":"",e.stack=e.stack+"Action: "+act+"\nControl: "+(controlId||"?"),modal.error(title,e)};try{var method="_act"+$.camelCase("-"+act),object;if($$target){controlId||(controlId=_findParentCtrlId($$target,".s-m-array"));if(controlId){if(app.isLoadingPage()){evt.stopPropagation(),evt.preventDefault();return}object=_findControlById(app,controlId,$$target)}else{var vignette=utils.findParentVignette($$target,!1);if(vignette)if(vignette[method])object=vignette;else{var p=vignette.getPage();p&&p[method]&&(object=p)}}}object==null&&app.currentPage[method]&&(object=app.currentPage),object==null&&(object=app);if(!object[method])throw new Error("Method ["+method+"] not found in object/application/current page)");var args=[];params&&typeof params=="string"?(params=params.split(","),params.forEach(function(p,idx){args.push(p.trim())})):args.push(params),args.push($$target),args.push(evt),$.smResolve(function(){return object[method].apply(object,args)}).then(function(todo){if(!todo||!todo.page)return;globals.getApplication().changePage(todo.page)}).fail(function(e){_fail(e)})}catch(e){_fail(e)}},_doNavigation=function(clickedElmt,$$target){var app=globals.getApplication(),options={},attr;attr=_attr(clickedElmt,"data-external-link");if(attr.length>0){window.open(attr,"s-m-external-window");return}attr=_attr(clickedElmt,"data-sdata-url"),attr.length>0&&(options["sdata-url"]=attr),attr=_attr(clickedElmt,"data-sdata-method"),attr.length>0&&(options["sdata-method"]=attr),attr=_attr(clickedElmt,"data-nav-type"),attr.length>0&&(options.type=attr),attr=_attr(clickedElmt,"data-parent-id"),attr.length>0&&(options.parentId=attr),attr=_attr(clickedElmt,"data-control-id"),attr.length>0&&(options.controlId=attr),attr=_attr(clickedElmt,"data-origin-id"),attr.length>0&&(options.controlOriginId=attr),attr=_attr(clickedElmt,"data-params",!1,!0),options.dataParams=attr||"",attr=_attr(clickedElmt,"data-nav-target");var navTarget;$$target&&(attr==="vignette"?navTarget=utils.findParentVignette($$target,!0):attr!=="application"&&app.$config("openLinkInVignette")&&(navTarget=utils.findParentVignette($$target,!1))),navTarget||(navTarget=app);var refreshPage=_attr(clickedElmt,"data-nav-refresh");if(refreshPage==="true"){navTarget.refreshPage(options);return}attr=_attr(clickedElmt,"data-application-name");var applicatioName;attr.length>0&&(applicatioName=attr);var pageName;attr=_attr(clickedElmt,"data-nav"),attr.length>0&&(pageName=attr),applicatioName&&(options.applicationName=applicatioName),attr=_attr(clickedElmt,"data-gadget-id"),attr.length>0&&(options["gadget-id"]=attr),attr=_attr(clickedElmt,"data-link-article"),attr.length>0&&(options.linkArticle=attr),attr=_attr(clickedElmt,"data-sdata-parameters"),attr&&attr.length>0&&(options.sdataParameters=_parseParameters(attr)),attr=_attr(clickedElmt,"data-nav-noback"),options.noHistoryBack=attr==="true",navTarget.changePage(pageName,options)},_handleActionEvt=function(evt,app){var _fail=function(e){var title="_bindActions error";log&&log(title,e),modal.error(title,e)};try{if(app.hasModalOpen()){log&&log("!!! Tries to execute an action data-action with a MODAL open.\nAction is skipped");return}var $$target=$(evt.target),$$actionElmt=$$target.closest("[data-action], [data-nav], [data-nav-refresh], [data-application-name], [data-external-link]");if($$actionElmt.length===0||$$actionElmt.attr("data-disabled")!=null||$$actionElmt.is(".disabled"))return;if($$actionElmt.is("[data-action]")){var param,act=_attr($$actionElmt,"data-action");if(_isNavigationAction(act)&&$$actionElmt.closest("[data-disable-navigation]").length>0)return;if($$actionElmt.is("select")){if($$actionElmt.closest("[data-disable-navigation]").length>0)return;param=$(this).val()}else{if(act===globals.ACTROWDETAIL||act===globals.ACTROWDEL||act===globals.ACTROWSEL||act===globals.ACTCARDDESIGN){if($$actionElmt.closest("[data-disable-navigation]").length>0)return;$$actionElmt=$$actionElmt.closest("."+globals.RECORDCLASS)}param=_attr($$actionElmt,"data-params",!1,!0)}var controlId=_attr($$actionElmt,"data-control-id",!0);_executeLink(_doAction,$$actionElmt,$$target,act,param,controlId,evt)}else{if(_attr($$actionElmt,"data-disable-navigation"))return;_executeLink(_doNavigation,$$actionElmt,$$actionElmt,$$target)}}catch(e){_fail(e)}},_isNavigationAction=function(act){return act===globals.ACTCHARTDETAIL||act===globals.ACTROWDETAIL},_bindActions=function(app){if(!app.$$elmt)throw new Error("_bindActions - null $$elmt");var handler=jsutils.bindFn(_handleActionEvt,null,app);app.$$elmt.on("click",":not(select)[data-nav], :not(select)[data-nav-refresh], :not(select)[data-action], :not(select)[data-application-name], :not(select)[data-external-link]",handler),feedback.bindActions(app.$$elmt),app.$$elmt.on("change","select[data-nav], select[data-nav-refresh], select[data-action]",handler)},_bindControlEvents=function(app){var _fail=function(e){var title="_bindControlEvents error";log&&log(title,e),modal.error(title,e)},events=["click","blur","change","focus","input"];events.forEach(function(evtname){app.$$elmt.on(evtname,".ctrl-evt-"+evtname,function(event){event.preventDefault(),event.stopPropagation();try{var $$target=$(event.target),ctrlId;$$target.hasClass("s-m-control")?ctrlId=_attr($$target,"id"):(ctrlId=_attr($$target,"data-control-id",!0),ctrlId||(ctrlId=_findParentCtrlId($$target)));if(app.isLoadingPage()){event.stopPropagation(),event.preventDefault();return}var ctrl=_findControlById(app,ctrlId,$$target),method="on"+evtname.smCapitalize(),controllerListener=ctrl.controller?ctrl.controller.getEventListener(evtname):null;if(controllerListener&&controllerListener("before",ctrl,$$target,event)===!0)return;if(!ctrl[method]){log&&log("!!! Method["+method+"] not found - ctrlid["+ctrlId+"]");return}ctrl[method](event),controllerListener&&controllerListener("after",ctrl,$$target,event)}catch(e){_fail(e)}return})})},_bindEvents=function(app){$(window).bind("popstate",function(event){var state=event.originalEvent.state;state&&app.historyPop(event)}),_bindActions(app),_bindControlEvents(app),$(window).on("resize",globals.getSiteLayout().onWindowResize),globals.isMobile()&&($.event.special.orientationchange.setup(),$(window).on("orientationchange",globals.getSiteLayout().onWindowOrientation)),$(window).on("resizeInternal",globals.getSiteLayout().onWindowResizeInteral),$(window).on("unload",app.onUnload.bind(app)),$(window).on("beforeunload",app.onBeforeUnload.bind(app)),mobileDetect.isMobile()&&mobileDetect.isOs("android")&&_disablePullToRefresh()},_disablePullToRefresh=function(){var maybePreventPullToRefresh=!1,lastTouchY=0,touchstartHandler=function(e){if(e.touches.length!=1)return;lastTouchY=e.touches[0].clientY,maybePreventPullToRefresh=window.pageYOffset==0},touchmoveHandler=function(e){var touchY=e.touches[0].clientY,touchYDelta=touchY-lastTouchY;lastTouchY=touchY;if(maybePreventPullToRefresh){maybePreventPullToRefresh=!1;if(touchYDelta>0){e.preventDefault();return}}};window.document.addEventListener("touchstart",touchstartHandler,!1),window.document.addEventListener("touchmove",touchmoveHandler,!1)},_triggerAction=function($$elmt,act,params,controlId){window.setTimeout(function(){_doAction($$elmt,act,params,controlId)})},_triggerNavigation=function($$elmt,attributes){var attrs=function(jsonAttrs){var _jsonAttrs=jsonAttrs;Object.keys(_jsonAttrs).forEach(function(key){$.isPlainObject(_jsonAttrs[key])&&(_jsonAttrs[key]=JSON.stringify(_jsonAttrs[key]))}),this.attr=function(name){return _jsonAttrs[name]}};_doNavigation(new attrs(attributes),$$elmt)},_triggerRefreshPage=function($$elmt,attributes){setTimeout(function(){attributes=attributes||{},attributes["data-nav-refresh"]="true",_triggerNavigation($$elmt,attributes)})};exports.bindEvents=_bindEvents,exports.triggerAction=_triggerAction,exports.triggerNavigation=_triggerNavigation,exports.triggerRefreshPage=_triggerRefreshPage}),define("syracuse-tablet/html/js/application/pageLoader",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/ui/modals/modal","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("pageLoader"),globals=require("syracuse-tablet/html/js/helpers/globals"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),locale=require("syracuse-tablet/html/js/helpers/locale"),_PageLoader=utils.defineClass(function PageLoader(callerInterface){this.callerInterface=callerInterface,this.factory=globals.getApplication().factory,this._loadingContext=null},null,{destroy:function(){this.destroyed=!0,this.callerInterface=null,this.factory=null,this._loadingContext&&(this._loadingContext.pageToLoad&&this._loadingContext.pageToLoad.destroy(),this._loadingContext=null)},load:function(state,back,loadOptions){var self=this;if(self.destroyed)return $.smResolve();var deferred=$.Deferred();self.beforeLoading();var pageToOpen=null,pageToClose=null;state.options=state.options||{},loadOptions=loadOptions||{};var _fail=function(e){if(self.destroyed)return deferred.reject(e);self._loadingContext=null,!back&&(!e||!e.$redirectPage)&&(pageToOpen&&pageToOpen.destroy(),e.$redirectPage="current"),self.waitWheelStop(),self.callerInterface.loadingError?self.callerInterface.loadingError(deferred,state,e):loadOptions.dontDisplayLoadErr!==!0?e&&e.$noConnectionError===!0?(globals.setOffline(!0,{severityClass:"success",body:locale.text("no.local.data.available")}),deferred.reject(e)):modal.error(locale.text("error.page.loading"),e,function(){deferred.reject(e)}):deferred.reject(e)},timeLine=utils.getTimeLine("pageLoader",state.name);timeLine&&timeLine.start();var _success=function(pageToOpen,pageToClose,parentNotifInfo){if(self.destroyed)return deferred.resolve(null);self._loadingContext=null,self.waitWheelStop(),pageToOpen&&(back!==!0&&state.options.noHistoryBack!==!0&&(pageToOpen.prototype&&(pageToOpen.state.$title=pageToOpen.prototype.data("$title")),self.historyPush(pageToOpen.state)),self.succeeded(pageToOpen,pageToClose,parentNotifInfo,back,loadOptions),timeLine&&timeLine.stop(pageToOpen.isNew?"newPage":"existingPage"),pageToOpen.activated()),deferred.resolve(pageToOpen)};try{self.isLoading()&&_success(null),self._loadingContext={deferred:deferred};if(state===null||typeof state!="object")throw new Error("Bad state object");log&&log("_gotoPage","start","page: "+state.uuid),pageToClose=self.getCurrentPage();if(pageToClose&&pageToClose.getProp("uuid")===state.uuid){log&&log("	Page is current -> Skip");return}var parentNotifInfo=null,childNotifInfo=null;pageToClose&&pageToClose.isChild&&(parentNotifInfo=pageToClose.getParentNotif()),self.waitWheelStart(),pageToOpen=$("#"+state.uuid).smPageController();if(pageToOpen!=null){log&&log("	Page found in dom -> Activate");if(!pageToOpen)throw new Error("Unexpected null page data");return pageToOpen.isNew=!1,self._pageActivate(pageToOpen,function(){timeLine&&timeLine.step("activated"),pageToOpen.destroySiblings(),_success(pageToOpen,pageToClose,parentNotifInfo)},back),deferred.promise()}var parentPage=null;state.options.parentId&&(parentPage=globals.getController(state.options.parentId));var $forceLinkArticle;if(pageToClose){var ctrlId=state.options.linkArticle;$forceLinkArticle=back?state.forceLinkArticle:pageToClose.getLinkedPageArticle(ctrlId)}self.factory.createPage(self.getRootElmt(),state,parentPage,$forceLinkArticle).then(function(p){if(self.destroyed)return;timeLine&&timeLine.step("created"),self._loadingContext.pageToLoad=pageToOpen=p,pageToOpen.isNew=!0;if(!pageToOpen.gadget||pageToOpen.gadget.data("pinPageId")==null)!back&&pageToOpen.isVignette&&pageToClose==null?state.savedContext=self.getSavedCtxVignette():back||loadOptions.restoreSavedContext==1?state.savedContext=state.savedContext:state.savedContext=null;if(pageToOpen.isVignette&&pageToOpen.state.options.parentVignette&&pageToOpen.state.options.parentVignette.destroyed)return;return pageToOpen.load(loadOptions)}).then(function(){if(self.destroyed)return;timeLine&&timeLine.step("loaded"),self._pageActivate(pageToOpen,function(){timeLine&&timeLine.step("activated"),_success(pageToOpen,pageToClose,parentNotifInfo)},back)}).fail(function(e){_fail(e)})}catch(e){_fail(e)}return deferred.promise()},isLoading:function(){return this._loadingContext!=null},stopLoading:function(reason){if(reason!="back"||this.isLoading()!==!0)return;this.waitWheelStop(),this._loadingContext&&(this._loadingContext.pageToLoad&&this._loadingContext.pageToLoad.destroy(),this._loadingContext.deferred&&this._loadingContext.deferred.resolve(null),this._loadingContext=null)},_pageActivate:function(pageToOpen,cb,back){var self=this;if(self.destroyed)return;var pageToClose=self.getCurrentPage();pageToClose&&pageToClose.destroyed===!0&&(pageToClose=null);var destroy=pageToClose&&(back===!0||pageToClose.getProp("cached")!==!0&&pageToOpen.isChild!==!0);if(pageToClose){var clearCtx=!destroy||back;pageToClose.updateSavedContext(clearCtx)}pageToOpen.activate(pageToClose,function(){self.setCurrentPage(pageToClose,pageToOpen,destroy),cb&&cb()})},beforeLoading:function(){this.callerInterface.beforeLoading&&this.callerInterface.beforeLoading()},historyPush:function(state){this.callerInterface.historyPush(state)},waitWheelStop:function(){this.callerInterface.waitWheelStop()},waitWheelStart:function(){this.callerInterface.waitWheelStart()},getRootElmt:function(){return this.callerInterface.getRootElmt()},getCurrentPage:function(){return this.callerInterface.getCurrentPage()},getSavedCtxVignette:function(){var meth=this.callerInterface.getSavedCtxVignette;return meth?meth():null},setCurrentPage:function(pageToClose,pageToOpen,destroy){var self=this;pageToClose&&(destroy===!0?setTimeout(function(){pageToClose.destroy()}):pageToClose.deactivate()),self.callerInterface.setCurrentPage(pageToOpen)},succeeded:function(pageToOpen,pageToClose,parentNotifInfo,back,loadOptions){var self=this;notifications.publish("sm.page.loaded",self.getCurrentPage()),this.callerInterface.succeeded&&this.callerInterface.succeeded(pageToOpen,pageToClose,parentNotifInfo,back,loadOptions)}});exports.Klass=_PageLoader}),define("syracuse-tablet/html/js/ui/modals/modalSelectContext",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalDialog","syracuse-tablet/html/js/helpers/globals"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),globals=require("syracuse-tablet/html/js/helpers/globals"),_templateAll={header:'			<buttons class="pull-right"> 				{{#if allow_logout}} 					<button type="button" class="btn btn-default s-m-modal-btn-logout" data-action="logout"></button> 				{{/if}} 				{{#unless label_offline}} 				<button type="button" class="btn btn-default s-m-modal-btn-validate" data-action="$validate"></button> 				{{/unless}} 				<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 			</buttons> 			<div class="modal-title">{{title}}</div> 			',content:' 			<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">			<div class="s-m-scroll-element"> 				{{#if label_warning}}					<div class="alert alert-warning" role="alert">						{{label_warning}}					</div>				{{/if}}				{{#if label_offline}}					<div class="alert alert-warning" role="alert">						{{label_offline}}					</div>				{{/if}}				{{#if showRoles}} 				<div class="form-group"> 					<label>{{label_roles}}</label>					<select class="form-control" id="login-select-role"> 					{{#each roles}}						<option value="{{this.code}}" {{#if this.selected}}selected{{/if}}>						{{this.description}}						</option>					{{/each}}					</select>				</div> 				{{/if}} 				{{#if showEndpoints}} 				<div class="form-group"> 					<label>{{label_endpoints}}</label>					<select class="form-control" id="login-select-endpoint"> 					{{#each endpoints}}						<option value="{{this.code}}" {{#if this.selected}}selected{{/if}}>						{{this.description}}						</option>					{{/each}}					</select>				</div> 				{{/if}} 				{{#if showLanguages}} 				<div class="form-group"> 					<label>{{label_languages}}</label>					<select class="form-control" id="login-select-language"> 					{{#each languages}}						<option value="{{this.code}}" {{#if this.selected}}selected{{/if}}>						{{this.description}}						</option>					{{/each}}					</select>				</div> 				{{/if}} 			</div> 			</div>',footer:""},_myTemplates={endpoints:'		{{#each endpoints}}				<option value="{{ep.code}}" {{#if selected}}selected{{/if}}>{{description}}{{#unless description}}{{code}}{{/unless}}</option>		{{/each}}'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_myTemplates[key];return tmpl||(tmpl=_myTemplates[name],tmpl=_myTemplates[key]=Handlebars.compile(tmpl)),tmpl(ctx)},_Klass=utils.defineClass(function ModalSelectContext(context,settings,displayOpts,isOffline){if(!isOffline&&(settings==null||!settings.roles||settings.roles.length==0))throw new Error("Unexpected wrong user settings");var self=this;self.isOffline=isOffline,self.displayOpts=displayOpts||{},isOffline&&(self.displayOpts.hideEndpoints=!0,self.displayOpts.hideRoles=!0,self.displayOpts.hideLanguages=!0),modalDialog.ModalBase.call(self),self.initParam={context:$.extend(!0,{},context),setttings:$.extend(!0,{},settings),warn:!0},self.initParam.context.role||(self.initParam.context.role=self.initParam.setttings.roles[0].code),self.initParam.context.language||(self.initParam.context.language=utils.getNavigatorLanguage("en-US")),self.result=null},modalDialog.ModalBase,{destroy:function(){this._$$roles&&(this._$$roles.off(),this._$$roles=null),this._$$endPoints&&(this._$$endPoints.off(),this._$$endPoints=null),modalDialog.ModalBase.prototype.destroy.call(this),this.initParam=null,this.result=null},_getTemplates:function(){var self=this;return{std:_templateAll}},_getRoles:function(){var self=this,roles=self.initParam.setttings.roles||[],found=!1;return roles.forEach(function(r){r.selected=r.code===self.initParam.context.role}),roles},_getLanguages:function(){var self=this,languages=this.initParam.setttings.locales||[];return languages.forEach(function(lang){lang.selected=lang.code===self.initParam.context.language}),languages},_getEndPoints:function(roles){var self=this,endPoints;return(roles||self._getRoles()).some(function(r){if(r.selected===!0)return endPoints=r.endPoints,!0}),endPoints=endPoints||[],endPoints.forEach(function(ep){ep.selected=ep.code===self.initParam.context.endpoint}),endPoints},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="select-context half_right":displayFlags.modalClass="select-context full",displayFlags},_getDataContext:function(){var self=this,roles=self._getRoles(),languages=self._getLanguages(),endPoints=self._getEndPoints(roles),showEndpoints=self.displayOpts.hideEndpoints!==!0,showRoles=self.displayOpts.hideRoles!==!0,showLanguages=self.displayOpts.hideLanguages!==!0&&languages.length>0,label_warning=self.initParam.warn&&locale.text("modal.context.warning"),label_offline=locale.text("modal.context.offline");self.isOffline!==!0?label_offline=null:label_warning=null;var curApp=globals.getApplication(),curPage=curApp&&curApp.currentPage;curPage&&jsutils.isInstanceOf(curPage,"WelcomeDashboardPage")&&(label_warning=!1);var data={title:locale.text("modal.context.title"),label_endpoints:locale.text("modal.context.endpoints"),showEndpoints:showEndpoints,endpoints:endPoints,label_roles:locale.text("modal.context.roles"),showRoles:showRoles,roles:roles,label_languages:locale.text("modal.context.languages"),showLanguages:showLanguages,languages:languages,label_logout:locale.text("modal.context.logout"),label_ok:locale.text("modal.context.ok"),label_cancel:locale.text("modal.context.cancel"),label_warning:label_warning,label_offline:label_offline,allow_logout:self.initParam.context!=null};return data},_attachDOM:function(){modalDialog.ModalBase.prototype._attachDOM.call(this),this._$$roles=this.$$elmt.find("#login-select-role"),this._$$roles.length>0&&this._$$roles.on("change",jsutils.bindFn(this.onRoleChanged,this)),this._$$endPoints=this.$$elmt.find("#login-select-endpoint"),this._$$endPoints.length>0&&this._$$endPoints.on("change",jsutils.bindFn(this.onEnpointChanged,this))},onEnpointChanged:function(event){this.initParam.context.endpoint=this._$$endPoints.val()},onRoleChanged:function(event){this.initParam.context.role=this._$$roles.val(),this._$$endPoints.html(_getHtml("endpoints",{endpoints:this._getEndPoints()})).show()},_saveSettings:function(){return $.smResolve()},_onAction:function(action,param){var self=this;return self._saveSettings().then(function(){return action==="logout"?(self.result={action:"logout"},!0):!1})},_onValidate:function(){var self=this;return self._saveSettings().then(function(){var epCode=self._$$endPoints.val(),ept;self._getEndPoints().some(function(e){if(e.code===epCode)return ept=e,!0}),self.result={action:"ok",endpoint:epCode,endpointDescr:ept&&ept.description?ept.description:epCode,role:self._$$roles.val(),language:self.$$elmt.find("#login-select-language").val()}})},_onCancel:function(){var self=this;self.initParam.context?self.result={action:"cancel"}:self.result={action:"logout"}},_getResult:function(){return this.result}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/storage/storageInterface",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils"],function(require,exports,module){function resultToString(result){if(!result)return"";if(jsutils.isError(result))return JSON.stringify(jsutils.convertToDiagnoses(result),null,2);var res=[];return result.$status&&res.push("status: "+result.$status),result.$message&&res.push("Message: "+result.$message),result.$exception&&result.$exception.message&&res.push("Exception: "+result.$exception.message),result.$exception&&result.$exception.stack&&res.push("Stack: "+result.$exception.stack),res.join("\n")}function buildResult(status,data,message,exception,metaData){var res={$status:status};return data&&(res.$data=data),metaData&&(res.$metaData=metaData),message&&(res.$message=message),exception&&(res.$exception=exception),res}function buildErrResult(message,exception){return buildResult(_statusCodes.ERROR,null,message,exception)}var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),_statusCodes={OK:1,NOT_FOUND:2,ERROR:3},_Klass=utils.defineClass(function(infoString,databaseVersion){this.infoString=infoString,this.databaseName=exports.databaseName,this.databaseVersion=databaseVersion,this.useTestDatabase=!1,this.db=null},null,{getInfo:function(){return this.infoString},init:function(){throw new Error("Not implemented!")},query:function(opts){throw new Error("Not implemented!")},put:function(opts){throw new Error("Not implemented!")},read:function(opts){throw new Error("Not implemented!")},remove:function(opts){throw new Error("Not implemented!")},clearCollection:function(){throw new Error("Not implemented!")},computeCollectionSize:function(){throw new Error("Not implemented!")},clearDatabaseSupported:function(){return!1},draftOperation:function(op){},templateOperation:function(op){}});exports.Klass=_Klass,exports.StatusCodes=_statusCodes,exports.buildResult=buildResult,exports.buildErrResult=buildErrResult,exports.resultToString=resultToString,exports.databaseName="sage-tablet-db"}),define("syracuse-tablet/html/js/storage/storageWebSQLBase",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/storage/storageInterface","syracuse-tablet/html/js/helpers/logger"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),locale=require("syracuse-tablet/html/js/helpers/locale"),storageInterface=require("syracuse-tablet/html/js/storage/storageInterface"),Base=storageInterface.Klass,log=require("syracuse-tablet/html/js/helpers/logger").getLogger("webSQL",!1),_databaseVersion=21,_databaseSize=2097152,_Klass=utils.defineClass(function(){Base.call(this,"WebSQL storage interface",_databaseVersion),this.databaseSize=_databaseSize},Base,{init:function(){var deferred=$.Deferred(),self=this;return $.smResolve().then(function(){return self.useTestDatabase=globals.isTestEnvironment(),self.databaseName=storageInterface.databaseName+(self.useTestDatabase?"-test":""),self.useTestDatabase===!1&&self.db?$.smResolve(storageInterface.StatusCodes.OK):self._openDB()}).then(function(status){deferred.resolve(status)}).fail(function(e){log&&log("Open database exception",JSON.stringify(storageInterface.buildErrResult(e),null,2)),deferred.reject(storageInterface.buildErrResult(locale.text("db.err.init"),e))}),deferred.promise()},_openDB:function(){var self=this;return $.smResolve().then(function(){var request;return log&&log("Open database, request version: "+self.databaseVersion),self.db=openDatabase(self.databaseName,7,"Database",self.databaseSize),self._readCurrentVersion().then(function(version){return log&&log("Current version: "+version),version===self.databaseVersion&&self.useTestDatabase!==!0?storageInterface.StatusCodes.OK:self._createTables().then(function(status){return self._writeCurrentVersion()})})})},_writeCurrentVersion:function(){var self=this,deferred=$.Deferred();return self._executeSql("DELETE FROM version",null).then(function(result){return self._executeSql("INSERT INTO version (version) values (?)",[_databaseVersion]).then(function(status){deferred.resolve(status)})}).fail(function(e){log&&log("_writeCurrentVersion exception",JSON.stringify(storageInterface.buildErrResult(e),null,2)),deferred.reject(storageInterface.buildErrResult("writeCurrentVersion",e))}),deferred.promise()},getTables:function(){return{}},_executeSql:function(sql,params){var deferred=$.Deferred(),self=this;try{self.db.transaction(function(tx){try{log&&log("SQL: "+sql),log&&log(params),tx.executeSql(sql,params,function(tx,result){deferred.resolve(result)},function(tx,error){deferred.reject(storageInterface.buildErrResult("DB error initializing database: "+self.sqlErrorToMessage(error,sql,params)))})}catch(e){deferred.reject(storageInterface.buildErrResult("error running SQL statement",e))}},function(error){deferred.reject(storageInterface.buildErrResult("DB transaction error: "+self.sqlErrorToMessage(error,sql,params)+". Try to reload the page"))})}catch(e){deferred.reject(storageInterface.buildErrResult("error running SQL statement",e))}return deferred.promise()},_readCurrentVersion:function(){var deferred=$.Deferred(),self=this;return self._executeSql("SELECT version FROM version",null).then(function(result){try{var len=result.rows.length;if(len===1){var version=result.rows.item(0).version;log&&log("Read version: "+version),deferred.resolve(+version)}deferred.resolve(-1)}catch(e){deferred.reject(storageInterface.buildErrResult("error reading database version",e))}}).fail(function(e1){log&&log("Creating version table"),self._executeSql("CREATE TABLE version (version TEXT)").then(function(status){deferred.resolve(-1)}).fail(function(e2){log&&log("Error creating version table",JSON.stringify(storageInterface.buildErrResult(e2),null,2)),deferred.reject(storageInterface.buildErrResult("error reading database version",e1))})}),deferred.promise()},_createTables:function(){var deferred=$.Deferred(),self=this,p=[],errors=[],nbExec=0,tables=this.getTables();for(var name in tables)nbExec+=tables[name].length;for(var name in tables)tables[name].forEach(function(descr){self._executeSql(descr).then(function(){nbExec--,nbExec===0&&(errors.length>0?deferred.reject(storageInterface.buildErrResult("Error creating database tables",errors.join("\n"))):deferred.resolve(storageInterface.StatusCodes.OK))},function(status){nbExec--,errors.push(status.$message),nbExec===0&&deferred.reject(storageInterface.buildErrResult("Error creating database tables",errors.join("\n")))})});return deferred.promise()},sqlErrorToMessage:function(error,sql,params){if(log){var e={};for(var p in error){if(typeof error[p]=="function")continue;if(error[p]=="object"&&(!Array.isArray(error[p])||!$.isPlainObject(error[p])))continue;e[p]=error[p]}log&&log("ERROR REQUEST:",sql),log&&log("ERROR PARAMS:",params),log&&log(JSON.stringify(e,null,2))}return"CODE: "+error.code+" MESSAGE: "+error.message},clearDatabaseSupported:function(){return!1}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/storage/storageWebSQLSData",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/storage/storageInterface","syracuse-tablet/html/js/storage/storageWebSQLBase","syracuse-tablet/html/js/helpers/logger"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),storageInterface=require("syracuse-tablet/html/js/storage/storageInterface"),Base=require("syracuse-tablet/html/js/storage/storageWebSQLBase").Klass,log=require("syracuse-tablet/html/js/helpers/logger").getLogger("webSQL",!1),_tables={sdata_meta:["DROP TABLE IF EXISTS sdata_meta","CREATE TABLE sdata_meta ( key text, collection text, endpoint text, context text, id text, etag text, last_read text, last_updated text)","DROP INDEX IF EXISTS sdata_meta_pk","CREATE UNIQUE INDEX sdata_meta_pk ON sdata_meta (key, collection, endpoint, context)","DROP INDEX IF EXISTS sdata_meta_id","CREATE UNIQUE INDEX sdata_meta_id ON sdata_meta (id)"],sdata_objects:["DROP TABLE IF EXISTS sdata_objects","CREATE TABLE sdata_objects ( id text, data text )","DROP INDEX IF EXISTS sdata_objects_pk","CREATE UNIQUE INDEX sdata_objects_pk ON sdata_objects (id)"]},_Klass=utils.defineClass(function(){Base.call(this)},Base,{getTables:function(){var res=Base.prototype.getTables.call(this);return $.extend(res,_tables),res},put:function(opts){var deferred=$.Deferred(),self=this;try{var db=self.db;log&&log("PUT: ",JSON.stringify(opts));if(!opts.$key||!opts.$collection||!opts.$endpoint||!opts.$context)throw new Error("Insufficient parameters");var context=JSON.stringify(opts.$context),params=[opts.$key,opts.$collection,opts.$endpoint,context],insertData=function(metaData){self._executeSql("INSERT INTO sdata_objects (data, id) values (?, ?)",[JSON.stringify(opts.$data),metaData.$id]).then(function(){deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK,opts.$data))}).fail(function(status){deferred.reject(status)})},updateData=function(metaData){self._executeSql("UPDATE sdata_objects set data = ? where id = ?",[JSON.stringify(opts.$data),metaData.$id]).then(function(result){deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK,opts.$data))}).fail(function(status){deferred.reject(status)})};self._readMetaData(context,params).then(function(metaData){metaData&&metaData.$etag===opts.$data.$etag?deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK,opts.$data)):metaData?(metaData.$etag=opts.$data.$etag,metaData.$lastUpdated=utils.getCurISODateTime(),self._writeMetaData(metaData).then(function(){updateData(metaData)}).fail(function(status){deferred.reject(status)})):(metaData={$key:opts.$key,$collection:opts.$collection,$endpoint:opts.$endpoint,$context:opts.$context,$etag:opts.$data.$etag,$lastUpdated:utils.getCurISODateTime()},self._writeMetaData(metaData).then(function(metaData){insertData(metaData)}).fail(function(status){deferred.reject(status)}))}).fail(function(status){deferred.reject(status)})}catch(e){deferred.reject(storageInterface.buildErrResult("error writing to database",e))}finally{return deferred.promise()}},read:function(opts){var deferred=$.Deferred(),self=this;try{var db=self.db;log&&log("READ: ",JSON.stringify(opts));if(!opts.$key||!opts.$collection||!opts.$endpoint||!opts.$context)throw new Error("Insufficient parameters");var context=JSON.stringify(opts.$context),params=[opts.$key,opts.$collection,opts.$endpoint,context];self._readMetaData(context,params).then(function(metaData){metaData?self._executeSql("SELECT * FROM sdata_objects where id = ?",[metaData.$id]).then(function(result){try{result.rows.length<=0?deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.NOT_FOUND)):deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK,JSON.parse(result.rows.item(0).data),null,null,{$lastRead:metaData.$lastRead,$lastUpdated:metaData.$lastUpdated}))}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}}).fail(function(status){deferred.reject(status)}):deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.NOT_FOUND))}).fail(function(status){deferred.reject(status)})}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}finally{return deferred.promise()}},query:function(opts){var deferred=$.Deferred(),self=this;try{var db=self.db;log&&log("QUERY: ",JSON.stringify(opts));if(!opts.$collection||!opts.$endpoint||!opts.$context)throw new Error("Insufficient parameters");var context=JSON.stringify(opts.$context),params=[opts.$collection,opts.$endpoint,context];self._executeSql("SELECT o.*, m.last_read, m.last_updated FROM sdata_objects o INNER JOIN sdata_meta m ON (o.id = m.id and m.collection = ? and m.endpoint = ? and m.context = ?)",params).then(function(result){var ret=[],meta=[];try{for(var i=0;i<result.rows.length;i++){var item=result.rows.item(i);ret.push(JSON.parse(item.data)),meta.push({$lastRead:item.last_read,$lastUpdated:item.last_updated})}}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e));return}deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK,ret,null,null,meta))}).fail(function(status){deferred.reject(status)})}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}finally{return deferred.promise()}},remove:function(opts){var deferred=$.Deferred(),self=this;try{var db=self.db;log&&log("REMOVE: ",JSON.stringify(opts));if(!opts.$key||!opts.$collection||!opts.$endpoint||!opts.$context)throw new Error("Insufficient parameters");var context=JSON.stringify(opts.$context),params=[opts.$key,opts.$collection,opts.$endpoint,context];self._removeMetaData(context,params).then(function(metaData){metaData?self._executeSql("DELETE FROM sdata_objects where id = ?",[metaData.$id]).then(function(){deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK))}).fail(function(status){deferred.reject(status)}):deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.NOT_FOUND))}).fail(function(status){deferred.reject(status)})}catch(e){deferred.reject(storageInterface.buildErrResult("error writing to database",e))}finally{return deferred.promise()}},clearCollection:function(opts){var deferred=$.Deferred(),self=this;try{var db=self.db;log&&log("CLEAR: ",JSON.stringify(opts));if(!opts.$collection||!opts.$context)throw new Error("Insufficient parameters");var context=JSON.stringify(opts.$context),params=[context];self._executeSql("SELECT * FROM sdata_meta").then(function(result){var ret=[];try{for(var i=0;i<result.rows.length;i++){var item=result.rows.item(i);opts.$collection.test(item.collection)&&(!opts.$not_read_since||item.last_read<opts.$not_read_since)&&ret.push({$context:opts.$context,$collection:item.collection,$endpoint:item.endpoint,$key:item.key})}$.smForEachPromise(ret,function(item){return self.remove(item)}).then(function(){deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK))}).fail(function(e){deferred.reject(e)})}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}}).fail(function(status){deferred.reject(status)})}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}finally{return deferred.promise()}},computeCollectionSize:function(opts){var deferred=$.Deferred(),self=this;try{var db=self.db;log&&log("CHECK SIZE: ",JSON.stringify(opts));if(!opts.$collection||!opts.$context)throw new Error("Insufficient parameters");var context=JSON.stringify(opts.$context),params=[context];self._executeSql("SELECT m.collection, m.endpoint, m.key, m.last_read, d.data FROM sdata_meta m INNER JOIN sdata_objects d ON (d.id = m.id)").then(function(result){var returnData={numRecords:0,sizeRecords:0},ret=[];try{for(var i=0;i<result.rows.length;i++){var item=result.rows.item(i);opts.$collection.test(item.collection)&&(!opts.$not_read_since||item.last_read<opts.$not_read_since)&&(returnData.numRecords++,returnData.sizeRecords+=item.data.length)}deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK,returnData))}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}}).fail(function(status){deferred.reject(status)})}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}finally{return deferred.promise()}},_readMetaData:function(context,params,noUpdate){var deferred=$.Deferred(),self=this;try{var db=self.db;self._executeSql("SELECT * FROM sdata_meta where key = ? and collection = ? and endpoint = ? and context = ?",params).then(function(result){try{if(result.rows.length<=0)deferred.resolve(null);else{var item=result.rows.item(0),metaData={$key:item.key,$collection:item.collection,$endpoint:item.endpoint,$context:item.context,$id:item.id,$etag:item.etag,$lastRead:item.last_read,$lastUpdated:item.last_updated};log&&log("Read meta data: "+JSON.stringify(metaData)),noUpdate===!0?deferred.resolve(metaData):self._writeMetaData(metaData).then(function(){deferred.resolve(metaData)}).fail(function(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))})}}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}}).fail(function(status){deferred.reject(status)})}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}finally{return deferred.promise()}},_conflictMetaLock:function(metaId){var locked=!1;return this._lockedMeta?locked=this._lockedMeta.indexOf(metaId)>=0:this._lockedMeta=[],locked===!1&&this._lockedMeta.push(metaId),locked===!1},_conflictMetaWait:function(metaId,deferred,metaData){log&&log("!!CONFLICT WAIT",metaId),this._pendingMeta||(this._pendingMeta={});var stack=this._pendingMeta[metaId];stack||(stack=this._pendingMeta[metaId]=[]),stack.push({deferred:deferred,metaData:metaData})},_conflictMetaUnlock:function(metaId){var idx=this._lockedMeta.indexOf(metaId);idx>=0&&this._lockedMeta.splice(idx,1);var stack=this._pendingMeta?this._pendingMeta[metaId]:null;if(!stack)return;var data=stack.pop();stack.length===0&&delete this._pendingMeta[metaId];if(!data)return;log&&log("!!CONFLICT RETRY",metaId),this._writeMetaData(data.metaData).then(function(metaData){data.deferred.resolve(metaData)}).fail(function(status){data.deferred.reject(status)})},_writeMetaData:function(metaData){var deferred=$.Deferred(),self=this;try{var db=self.db;metaData.$lastRead=utils.getCurISODateTime();if(!metaData.$id){metaData.$id=utils.UUID();var metaId=[metaData.$key,metaData.$collection,metaData.$endpoint,JSON.stringify(metaData.$context)].join("-");self._conflictMetaLock(metaId)?self._executeSql("INSERT INTO sdata_meta (key, collection, endpoint, context, id, etag, last_read, last_updated) values (?, ?, ?, ?, ?, ?, ?, ?)",[metaData.$key,metaData.$collection,metaData.$endpoint,JSON.stringify(metaData.$context),metaData.$id,metaData.$etag,metaData.$lastRead,metaData.$lastUpdated]).then(function(){self._conflictMetaUnlock(metaId),deferred.resolve(metaData)}).fail(function(status){self._conflictMetaUnlock(metaId),deferred.reject(status)}):self._conflictMetaWait(metaId,deferred,metaData)}else self._executeSql("UPDATE sdata_meta set etag = ?, last_read = ?, last_updated = ? where id = ?",[metaData.$etag,metaData.$lastRead,metaData.$lastUpdated,metaData.$id]).then(function(result){deferred.resolve(metaData)}).fail(function(status){deferred.reject(status)})}catch(e){deferred.reject(storageInterface.buildErrResult("error writing meta data",e))}finally{return deferred.promise()}},_removeMetaData:function(context,params){var deferred=$.Deferred(),self=this;try{self._readMetaData(context,params,!0).then(function(metaData){metaData?self._executeSql("DELETE FROM sdata_meta where id = ?",[metaData.$id]).then(function(){deferred.resolve(metaData)}).fail(function(status){deferred.reject(status)}):deferred.resolve(null)}).fail(function(status){deferred.reject(status)})}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}finally{return deferred.promise()}}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/storage/storageWebSQLDrafts",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/storage/storageInterface","syracuse-tablet/html/js/storage/storageWebSQLSData","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),storageInterface=require("syracuse-tablet/html/js/storage/storageInterface"),Base=require("syracuse-tablet/html/js/storage/storageWebSQLSData").Klass,log=require("syracuse-tablet/html/js/helpers/logger").getLogger("drafts",!1),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_DRAFT_INSERT="INSERT INTO sdata_drafts (id, endpoint, representation, comment, status, errorMsg, dataSet, restoredContext, saveLink, title, creation_date) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",_DRAFT_DELETE_ALL="DELETE FROM sdata_drafts",_DRAFT_DELETE="DELETE FROM sdata_drafts where id = ?",_DRAFT_READ="SELECT * FROM sdata_drafts where id = ?",_DRAFT_READ_LIST="SELECT id, endpoint, representation, comment, status, errorMsg, title, creation_date FROM sdata_drafts",_DRAFT_COUNT="SELECT COUNT(*) AS counter FROM sdata_drafts",_tables={sdata_drafts:["DROP TABLE IF EXISTS sdata_drafts","CREATE TABLE sdata_drafts ( id text, endpoint text, representation text, comment text, status text, errorMsg, dataSet text, restoredContext text, saveLink text, title text, creation_date text)","DROP INDEX IF EXISTS sdata_drafts_id","CREATE UNIQUE INDEX sdata_drafts_id ON sdata_drafts (id)"],sdata_wrkcpy:["DROP TABLE IF EXISTS sdata_wrkcpy","CREATE TABLE sdata_wrkcpy ( id text, dataSet text, creation_date text)","DROP INDEX IF EXISTS sdata_wrkcpy_id","CREATE UNIQUE INDEX sdata_wrkcpy_id ON sdata_wrkcpy (id)"]},_logError=function(title,status){log&&log(title+" ERROR"),log&&log(storageInterface.resultToString(status))},_Klass=utils.defineClass(function(){Base.call(this),this._wrkcpyAllDeleted=!1},Base,{getTables:function(){var res=Base.prototype.getTables.call(this);return $.extend(res,_tables),res},_wrkcpyExists:function(id){var self=this;return self._executeSql("SELECT * FROM sdata_wrkcpy where id = ?",[id]).then(function(result){return result&&result.rows&&result.rows.length>0?!0:!1}).fail(function(status){return _logError("_wrkcpyExists",status),!1})},_wrkcpyRead:function(id){var self=this;return self._executeSql("SELECT * FROM sdata_wrkcpy where id = ?",[id]).then(function(result){if(!result||!result.rows||result.rows.length==0)return null;try{return result=JSON.parse(result.rows.item(0).dataSet),log&&log("_wrkcpyRead",id,"OK"),result}catch(e){return log&&log("_wrkcpyRead","KO",id),null}}).fail(function(status){return _logError("_wrkcpyRead",status),null})},_wrkcpyDelete:function(id){var self=this;return self._executeSql("DELETE FROM sdata_wrkcpy where id = ?",[id]).then(function(result){return log&&log("_wrkcpyDelete",id,result?"OK":"KO"),!0}).fail(function(status){return _logError("_wrkcpyDelete",status),!1})},_wrkcpyDeleteAll:function(){var self=this;return self._wrkcpyAllDeleted===!0?$.smResolve(null):self._executeSql("DELETE FROM sdata_wrkcpy").then(function(result){return log&&log("_wrkcpyDeleteAll OK"),self._wrkcpyAllDeleted=!0,!0}).fail(function(status){return _logError("_wrkcpyDeleteAll",status),!1})},_wrkcpyCreate:function(dataSet){var self=this;return!dataSet||!dataSet.$uuid?(log&&log("_wrkcpyCreate error","Invalid parameters"),$.smResolve(null)):self._wrkcpyDelete(dataSet.$uuid).then(function(){return self._wrkcpyDoInsert(dataSet)})},_wrkcpyDoInsert:function(dataSet){var self=this;return self._executeSql("INSERT INTO sdata_wrkcpy (dataSet, id) values (?, ?)",[JSON.stringify(dataSet),dataSet.$uuid]).then(function(){return log&&log("_wrkcpyDoInsert",dataSet.$uuid,"OK"),self._wrkcpyAllDeleted=!1,dataSet}).fail(function(status){return _logError("_wrkcpyDoInsert",status),null})},_wrkcpyDoUpdate:function(dataSet){var self=this;return self._executeSql("UPDATE sdata_wrkcpy set dataSet = ? where id = ?",[JSON.stringify(dataSet),dataSet.$uuid]).then(function(result){return log&&log("_wrkcpyDoUpdate","OK"),dataSet}).fail(function(status){return _logError("_wrkcpyDoUpdate",status),null})},_wrkcpyUpdate:function(dataSet){var self=this;return!dataSet||!dataSet.$uuid?(log&&log("_wrkcpyUpdate error","Invalid parameters"),$.smResolve(null)):self._wrkcpyExists(dataSet.$uuid).then(function(exists){return exists===!0?(log&&log("_wrkcpyUpdate UPDATE",dataSet.$uuid),self._wrkcpyDoUpdate(dataSet)):(log&&log("_wrkcpyUpdate CREATE",dataSet.$uuid),self._wrkcpyDoInsert(dataSet))})},_draftReadInfo:function(item){if(!item)return null;try{return{id:item.id,endpoint:item.endpoint||"",representation:item.representation||"",comment:item.comment||"",status:item.status||"none",errorMsg:item.errorMsg||"",dataSet:item.dataSet?JSON.parse(item.dataSet):null,restoredContext:item.restoredContext?JSON.parse(item.restoredContext):null,saveLink:item.saveLink?JSON.parse(item.saveLink):null,title:item.title||"",creation_date:item.creation_date}}catch(e){return log&&log("_draftReadInfo","KO",item.id),null}},_draftReadList:function(){var self=this;return self._executeSql(_DRAFT_READ_LIST).then(function(result){if(!result||!result.rows||result.rows.length==0)return[];var resources=[],rec;for(var i=0;i<result.rows.length;i++)rec=self._draftReadInfo(result.rows.item(i)),rec&&resources.push(rec);return log&&log("_draftReadList","OK"),resources}).fail(function(status){return _logError("_draftReadList",status),[]})},_draftRead:function(id){var self=this;return self._executeSql(_DRAFT_READ,[id]).then(function(result){return!result||!result.rows||result.rows.length==0?null:(log&&log("_draftRead",id,"OK"),self._draftReadInfo(result.rows.item(0)))}).fail(function(status){return _logError("_draftRead",status),null})},_draftDelete:function(id){var self=this;return self._executeSql(_DRAFT_DELETE,[id]).then(function(result){return log&&log("_draftDelete",id,result?"OK":"KO"),self._draftNotifyChanged(),!0}).fail(function(status){return _logError("_draftDelete",status),!1})},_draftDeleteAll:function(){var self=this;return self._executeSql(_DRAFT_DELETE_ALL).then(function(result){return log&&log("_draftDeleteAll OK"),self._draftNotifyChanged(),!0}).fail(function(status){return _logError("_draftDeleteAll",status),!1})},_draftSave:function(ctx){var self=this,deferred=$.Deferred();return!ctx||!ctx.id?(log&&log("_draftSave error","Invalid parameters"),deferred.reject(new Error("Invalid parameters"))):self._draftDelete(ctx.id).then(function(){return self._executeSql(_DRAFT_INSERT,[ctx.id,ctx.endpoint,ctx.representation,ctx.comment,ctx.status,ctx.errorMsg,JSON.stringify(ctx.dataSet),JSON.stringify(ctx.restoredContext),JSON.stringify(ctx.saveLink),ctx.title,ctx.creation_date])}).then(function(){log&&log("_draftSave",ctx.id,"OK"),self._draftNotifyChanged(),deferred.resolve(ctx)}).fail(function(status){_logError("_draftSave",status),deferred.reject(status.$exception||new Error(status.message))}),deferred.promise()},_draftCount:function(notify){return this._executeSql(_DRAFT_COUNT).then(function(result){var count=result&&result.rows.length>0?result.rows.item(0).counter:0;return notify&&notifications.publish("sm.drafts.changed",count),count}).fail(function(status){return _logError("_draftCount",status),0})},_draftNotifyChanged:function(){return this._draftCount(!0)},draftOperation:function(op){switch(op){case"wrkcpyUpdate":return this._wrkcpyUpdate(arguments[1]);case"wrkcpyRead":return this._wrkcpyRead(arguments[1]);case"wrkcpyDelete":return this._wrkcpyDelete(arguments[1]);case"wrkcpyCreate":return this._wrkcpyCreate(arguments[1],arguments[2]);case"wrkcpyDeleteAll":return this._wrkcpyDeleteAll(arguments[1]);case"draftSave":return this._draftSave(arguments[1]);case"draftDelete":return this._draftDelete(arguments[1]);case"draftDeleteAll":return this._draftDeleteAll();case"draftRead":return this._draftRead(arguments[1]);case"draftReadList":return this._draftReadList();case"draftCount":return this._draftCount(!1);case"draftNotifyChanged":var self=this;setTimeout(function(){self._draftNotifyChanged()});return;default:return $.smReject(storageInterface.buildErrResult("Unknown Draft operation["+op+"]"))}}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/storage/storageWebSQLTemplates",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/storage/storageInterface","syracuse-tablet/html/js/storage/storageWebSQLDrafts","syracuse-tablet/html/js/helpers/logger"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),storageInterface=require("syracuse-tablet/html/js/storage/storageInterface"),Base=require("syracuse-tablet/html/js/storage/storageWebSQLDrafts").Klass,log=require("syracuse-tablet/html/js/helpers/logger").getLogger("templates",!1),_TMPL_INSERT="INSERT INTO sdata_templates (id, endpoint, representation, title, dataSet, creation_date) values (?, ?, ?, ?, ?, ?)",_TMPL_DELETE_ALL="DELETE FROM sdata_templates",_TMPL_DELETE="DELETE FROM sdata_templates where id = ?",_TMPL_READ="SELECT * FROM sdata_templates where id = ?",_TMPL_QUERY="SELECT id, endpoint, representation, title, creation_date FROM sdata_templates",_TMPL_COUNT="SELECT COUNT(*) AS counter FROM sdata_templates",_tables={sdata_templates:["DROP TABLE IF EXISTS sdata_templates","CREATE TABLE sdata_templates ( id text, endpoint text, representation text, title text, dataSet text, creation_date text)","DROP INDEX IF EXISTS sdata_templates","CREATE UNIQUE INDEX sdata_templates_id ON sdata_templates (id)"]},_logError=function(title,status){log&&log(title+" ERROR"),log&&log(storageInterface.resultToString(status))},_Klass=utils.defineClass(function(){Base.call(this)},Base,{getTables:function(){var res=Base.prototype.getTables.call(this);return $.extend(res,_tables),res},_tmplReadInfo:function(item){if(!item)return null;try{return{id:item.id,endpoint:item.endpoint||"",representation:item.representation||"",title:item.title||"",dataSet:item.dataSet?JSON.parse(item.dataSet):null,creation_date:item.creation_date}}catch(e){return log&&log("_tmplReadInfo","KO",item.id),null}},_tmplQuery:function(representation,endpoint){var self=this,deferred=$.Deferred(),req=_TMPL_QUERY,params=[];if(representation||endpoint)req+=" where ",representation&&(req+="representation = ?",params.push(representation),endpoint&&(req+=" and ")),endpoint&&(req+="endpoint = ?",params.push(endpoint));return self._executeSql(req,params).then(function(result){log&&log("_tmplQuery","OK");if(!result||!result.rows||result.rows.length==0)return deferred.resolve([]);var resources=[],rec;for(var i=0;i<result.rows.length;i++)rec=self._tmplReadInfo(result.rows.item(i)),rec&&resources.push(rec);deferred.resolve(resources)}).fail(function(status){_logError("_tmplQuery",status),deferred.reject(status.$exception||new Error(status.message))}),deferred.promise()},_tmplRead:function(id){var self=this,deferred=$.Deferred();return self._executeSql(_TMPL_READ,[id]).then(function(result){log&&log("_tmplRead",id,"OK");if(!result||!result.rows||result.rows.length==0)return deferred.resolve(null);deferred.resolve(self._tmplReadInfo(result.rows.item(0)))}).fail(function(status){_logError("_tmplRead",status),deferred.reject(status.$exception||new Error(status.message))}),deferred.promise()},_tmplUpdate:function(id,ctx){var self=this;return self._tmplRead(id).then(function(result){if(!result||!ctx)return;return self._tmplSave($.extend(result,ctx),!1)})},_tmplDelete:function(id){var self=this,deferred=$.Deferred();return self._executeSql(_TMPL_DELETE,[id]).then(function(result){log&&log("_tmplDelete",id,result?"OK":"KO"),deferred.resolve()}).fail(function(status){_logError("_tmplDelete",status),deferred.reject(status.$exception||new Error(status.message))}),deferred.promise()},_tmplDeleteAll:function(){var self=this,deferred=$.Deferred();return self._executeSql(_TMPL_DELETE_ALL).then(function(result){log&&log("_tmplDeleteAll OK"),deferred.resolve()}).fail(function(status){_logError("_tmplDeleteAll",status),deferred.reject(status.$exception||new Error(status.message))}),deferred.promise()},_tmplSave:function(ctx,updateDate){var self=this,deferred=$.Deferred();return!ctx||!ctx.id?(log&&log("_tmplSave error","Invalid parameters"),deferred.reject(new Error("Invalid parameters"))):self._tmplDelete(ctx.id).then(function(){if(ctx["creation_date"]==null||updateDate)ctx.creation_date=utils.getCurISODateTime(new Date);return self._executeSql(_TMPL_INSERT,[ctx.id,ctx.endpoint,ctx.representation,ctx.title,JSON.stringify(ctx.dataSet),ctx.creation_date])}).then(function(){log&&log("_tmplSave",ctx.id,"OK"),deferred.resolve(ctx)}).fail(function(status){_logError("_tmplSave",status),deferred.reject(status.$exception||new Error(status.message))}),deferred.promise()},_tmplCount:function(){return this._executeSql(_TMPL_COUNT,[]).then(function(result){return result&&result.rows.length>0?result.rows.item(0).counter:0}).fail(function(status){return _logError("_tmplCount",status),0})},templateOperation:function(op){switch(op){case"save":return this._tmplSave(arguments[1],!0);case"delete":return this._tmplDelete(arguments[1]);case"deleteAll":return this._tmplDeleteAll();case"read":return this._tmplRead(arguments[1]);case"update":return this._tmplUpdate(arguments[1],arguments[2]);case"query":return this._tmplQuery(arguments[1],arguments[2],arguments[3]);case"readall":return this._tmplQuery(arguments[1]);case"count":return this._tmplCount();default:return $.smReject(storageInterface.buildErrResult("Unknown template operation["+op+"]"))}}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/storage/storageWebSQL",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/mobileDetect","syracuse-tablet/html/js/storage/storageWebSQLTemplates"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("webSQL",!1),mobileDetect=require("syracuse-tablet/html/js/helpers/mobileDetect"),_storageInterface=require("syracuse-tablet/html/js/storage/storageWebSQLTemplates").Klass;exports.getStorageInterface=function(){return _storageInterface},exports.isAvailable=function(){return mobileDetect.checkBrowserName("chrome")&&mobileDetect.isOs("ios")||mobileDetect.checkBrowserName("safari")&&mobileDetect.isOs("osx")?(log&&log("chrome on ios - force indexedDB"),null):window.openDatabase!=null}}),define("syracuse-tablet/html/js/storage/storageIndexedDBBase",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/storage/storageInterface","syracuse-tablet/html/js/helpers/logger"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),locale=require("syracuse-tablet/html/js/helpers/locale"),storageInterface=require("syracuse-tablet/html/js/storage/storageInterface"),Base=storageInterface.Klass,log=require("syracuse-tablet/html/js/helpers/logger").getLogger("indexedDB",!1),_databaseVersion=22,_indexedDB=window.indexedDB||window.webkitIndexedDB,_logError=function(title,status){log&&log(title+" ERROR");if(!status)return;var request=status.target||status.currentTarget||status.originalTarget;if(request&&request.error&&request.error.message){log&&log((request.error.name?"["+request.error.name+"]":"")+request.error.message);return}log&&log(storageInterface.resultToString(status))},_Klass=utils.defineClass(function(){Base.call(this,"IndexedDB storage interface",_databaseVersion)},Base,{init:function(requester){var self=this;requester=requester||"",log&&log("_INIT "+requester);var deferred=$.Deferred(),step=globals.isTestEnvironment()?self._initTestDB():$.smResolve();return step.then(function(){return self.db?(log&&log("DATABASE ALREADY INITIALIZED!"),storageInterface.buildResult(storageInterface.StatusCodes.OK)):(log&&log("DATABASE INIT!"),self._openDB())}).then(function(status){log&&log("_openDB OK "+requester),deferred.resolve(status)}).fail(function(e){_logError("_openDB KO "+requester);var msg=self._eventToMessage(e);msg&&msg.toLowerCase().indexOf("versionerrror")&&(msg+="<br>"+locale.text("db.err.version")),deferred.reject(storageInterface.buildErrResult(locale.text("db.err.init"),msg))}),deferred.promise()},_initTestDB:function(requester){var self=this,deferred=$.Deferred();return $.smResolve().then(function(){self.db&&(self.db.close(),self.db=null),self.useTestDatabase=!0,self.databaseName=storageInterface.databaseName+"-test",log&&log("DATABASE IN TEST MODE! "+requester);var req=_indexedDB.deleteDatabase(self.databaseName);req.onsuccess=function(){deferred.resolve()},req.onerror=function(e){_logError("REQUEST ERROR! "+requester),deferred.reject(e)},req.onblocked=function(e){_logError("REQUEST BLOCKED! "+requester),deferred.reject(e)}}).fail(function(e){_logError("_initTestDB KO "+requester),deferred.reject(e)}),deferred.promise()},_openDB:function(){var deferred=$.Deferred(),self=this;if(self.useTestDatabase===!1&&self.db)deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK));else{var request;try{log&&log("Open database, request version: "+self.databaseVersion),request=_indexedDB.open(self.databaseName,self.databaseVersion),request.onupgradeneeded=function(e){log&&log("Open database, need upgrade"),self.db=e.target.result||e.target.source,self._createObjectStore()},request.onsuccess=function(e){log&&log("Open database, success");var db=e.target.result||e.target.source;if(!db.setVersion&&self.databaseVersion!=db.version){log&&log("Open database, versions missmatch: "+self.DatabaseVersion+" != "+db.version);var sdv=db.setVersion(self.databaseVersion);sdv.onsuccess=function(e){log&&log("Open database, setting version, success"),self.db=db,self._createObjectStore(),log&&log("Open database, opened"),deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK))},sdv.onerror=function(e){log&&log("Open database, setting version, error",e),self.db=null,deferred.reject(e)}}else log&&log("Open database, opened"),self.db=db,deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK))},request.onerror=function(e){_logError("Open database, error",e),self.db=null,deferred.reject(e)}}catch(ex){_logError("Open database, exception",ex),self.db=null,deferred.reject(ex)}}return deferred.promise()},getObjectStores:function(){return{}},_createObjectStore:function(){var self=this,db=self.db;log&&log("Updating database");try{var objectStores=this.getObjectStores();Object.keys(objectStores).forEach(function(name){var os=objectStores[name];db.objectStoreNames.contains(name)&&(log&&log("Deleting objectStore: "+name),db.deleteObjectStore(name)),log&&log("Creating objectStore: "+name);var obj=db.createObjectStore(name,os.options);Object.keys(os.indexes).forEach(function(iname){var idx=os.indexes[iname];log&&log("Creating index: "+iname),obj.createIndex(iname,idx.key,idx.options)})})}catch(e){throw _logError("_createObjectStore, error",e),e}},_eventToMessage:function(event){var request=event.target||event.currentTarget||event.originalTarget;return request&&request.error&&request.error.message?(request.error.name?"["+request.error.name+"]":"")+request.error.message:JSON.stringify(event)},clearDatabaseSupported:function(){return!0},clearDatabase:function(){var self=this,deferred=$.Deferred();return $.smResolve().then(function(){var req=window.indexedDB.deleteDatabase(self.databaseName);req.onsuccess=function(){deferred.resolve(!0)},req.onerror=function(e){deferred.resolve(!1),console.log("Database deletion failed"),console.log(e)}}).fail(function(){deferred.resolve(!1)}),deferred.promise()}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/storage/storageIndexedDBSData",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/storage/storageIndexedDBBase","syracuse-tablet/html/js/storage/storageInterface","syracuse-tablet/html/js/helpers/logger"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/storage/storageIndexedDBBase").Klass,storageInterface=require("syracuse-tablet/html/js/storage/storageInterface"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("sData",!1),IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction,IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,IDBDatabaseException=window.IDBDatabaseException||window.webkitIDBDatabaseException,READ_ONLY=IDBTransaction&&IDBTransaction.READ_ONLY||"readonly",READ_WRITE=IDBTransaction&&IDBTransaction.READ_WRITE||"readwrite",_objectStores={sdata:{options:{autoIncrement:!0},indexes:{read_write_one:{key:"key_collection_endpoint_context",options:{unique:!0}},read_write_all:{key:"collection_endpoint_context",options:{unique:!1}},read_write_ctx:{key:"context",options:{unique:!1}}}}},_Klass=utils.defineClass(function(){Base.call(this)},Base,{getObjectStores:function(){var res=Base.prototype.getObjectStores.call(this);return $.extend(res,_objectStores),res},put:function(opts){var deferred=$.Deferred(),self=this;try{var db=self.db;log&&log("PUT: ",JSON.stringify(opts));if(!opts.$key||!opts.$collection||!opts.$endpoint||!opts.$context)throw new Error("Insufficient parameters");var tx=db.transaction(["sdata"],READ_WRITE),objectStore=tx.objectStore("sdata"),context=JSON.stringify(opts.$context),key=[opts.$key,opts.$collection,opts.$endpoint,context].join("_"),index=objectStore.index("read_write_one"),keyRange=IDBKeyRange.only(key),request=index.openCursor(keyRange),mustInsert=!0,datetime=utils.getCurISODateTime(),doInsert=function(){var obj={context:context,collection:opts.$collection,endpoint:opts.$endpoint,key:opts.$key,last_updated:datetime,last_read:datetime,key_collection_endpoint_context:key,collection_endpoint_context:[opts.$collection,opts.$endpoint,context].join("_"),data:opts.$data},reqt=objectStore.add(obj);reqt.onerror=function(event){deferred.reject(storageInterface.buildErrResult("error writing to database: "+self._eventToMessage(event)))},reqt.onsuccess=function(event){deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK,opts.$data))}};request.onsuccess=function(event){try{var cr=event.target.result;if(cr){if(opts.$data.$etag){var etag=cr.value&&cr.value.data.$etag;if(etag===opts.$data.$etag){deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK,opts.$data));return}}cr["delete"](),cr["continue"]()}else doInsert()}catch(e){deferred.reject(storageInterface.buildErrResult("error writing to database",e))}},request.onerror=function(event){event.target.errorCode==IDBDatabaseException.NOT_FOUND_ERR?doInsert():deferred.reject(storageInterface.buildErrResult("error writing to database: "+self._eventToMessage(event)))}}catch(e){deferred.reject(storageInterface.buildErrResult("error writing to database",e))}finally{return deferred.promise()}},read:function(opts){var deferred=$.Deferred(),self=this;try{var db=self.db;log&&log("READ: ",JSON.stringify(opts));if(!opts.$key||!opts.$collection||!opts.$endpoint||!opts.$context)throw new Error("Insufficient parameters");var tx=db.transaction(["sdata"],READ_WRITE),objectStore=tx.objectStore("sdata"),context=JSON.stringify(opts.$context),key=[opts.$key,opts.$collection,opts.$endpoint,context].join("_"),index=objectStore.index("read_write_one"),keyRange=IDBKeyRange.only(key),request=index.openCursor(keyRange);request.onsuccess=function(event){try{var cr=event.target&&event.target.result&&event.target.result.value;cr?deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK,cr.data,null,null,{$lastRead:cr.last_read,$lastUpdated:cr.last_updated})):deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.NOT_FOUND))}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}},request.onerror=function(event){event.target.errorCode==IDBDatabaseException.NOT_FOUND_ERR?deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.NOT_FOUND)):deferred.reject(storageInterface.buildErrResult("error reading from database: "+self._eventToMessage(event)))}}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}finally{return deferred.promise()}},query:function(opts){var deferred=$.Deferred(),self=this;try{var db=self.db;log&&log("QUERY: ",JSON.stringify(opts));if(!opts.$collection||!opts.$endpoint||!opts.$context)throw new Error("Insufficient parameters");var tx=db.transaction(["sdata"],READ_WRITE),objectStore=tx.objectStore("sdata"),context=JSON.stringify(opts.$context),key=[opts.$collection,opts.$endpoint,context].join("_"),index=objectStore.index("read_write_all"),keyRange=IDBKeyRange.only(key),request=index.openCursor(keyRange),results=[],meta=[];request.onsuccess=function(event){try{var cr=event.target.result;if(cr){var data=cr.value.data;results.push(data),meta.push({$lastRead:cr.value.last_read,$lastUpdated:cr.value.last_updated}),cr["continue"]()}else deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK,results,null,null,meta))}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}},request.onerror=function(event){event.target.errorCode==IDBDatabaseException.NOT_FOUND_ERR?deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK,results,null,null,meta)):deferred.reject(storageInterface.buildErrResult("error reading from database: "+self._eventToMessage(event)))}}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}finally{return deferred.promise()}},remove:function(opts){var deferred=$.Deferred(),self=this;try{var db=self.db;log&&log("REMOVE: ",JSON.stringify(opts));if(!opts.$key||!opts.$collection||!opts.$endpoint||!opts.$context)throw new Error("Insufficient parameters");var tx=db.transaction(["sdata"],READ_WRITE),objectStore=tx.objectStore("sdata"),context=JSON.stringify(opts.$context),key=[opts.$key,opts.$collection,opts.$endpoint,context].join("_"),index=objectStore.index("read_write_one"),keyRange=IDBKeyRange.only(key),request=index.openCursor(keyRange);request.onsuccess=function(event){try{var cr=event.target.result;cr?(cr["delete"](),deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK))):deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.NOT_FOUND))}catch(e){deferred.reject(storageInterface.buildErrResult("error deleting from database",e))}},request.onerror=function(event){event.target.errorCode==IDBDatabaseException.NOT_FOUND_ERR?deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.NOT_FOUND)):deferred.reject(storageInterface.buildErrResult("error reading from database: "+self._eventToMessage(event)))}}catch(e){deferred.reject(storageInterface.buildErrResult("error deleting from database",e))}finally{return deferred.promise()}},clearCollection:function(opts){var deferred=$.Deferred(),self=this;try{var db=self.db;log&&log("CLEAR: ",JSON.stringify(opts));var tx=db.transaction(["sdata"],READ_WRITE),objectStore=tx.objectStore("sdata"),context=JSON.stringify(opts.$context),key=context,request=objectStore.openCursor(),records=[],deleteMatches=function(){$.smForEachPromise(records,function(rec){return self.remove({$context:opts.$context,$collection:rec.collection,$endpoint:rec.endpoint,$key:rec.key})}).then(function(){deferred.resolve()}).fail(function(e){deferred.reject(e)})};request.onsuccess=function(event){try{var cr=event.target.result;cr?(opts.$collection.test(cr.value.collection)&&(!opts.$not_read_since||cr.value.last_read<opts.$not_read_since)&&records.push(cr.value),cr["continue"]()):deleteMatches()}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}},request.onerror=function(event){event.target.errorCode==IDBDatabaseException.NOT_FOUND_ERR?deleteMatches():deferred.reject(storageInterface.buildErrResult("error reading from database: "+self._eventToMessage(event)))}}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}finally{return deferred.promise()}},computeCollectionSize:function(opts){var deferred=$.Deferred(),self=this;try{var db=self.db;log&&log("SIZE: ",JSON.stringify(opts));var tx=db.transaction(["sdata"],READ_WRITE),objectStore=tx.objectStore("sdata"),context=JSON.stringify(opts.$context),key=context,request=objectStore.openCursor(),returnData={numRecords:0,sizeRecords:0};request.onsuccess=function(event){try{var cr=event.target.result;cr?(opts.$collection.test(cr.value.collection)&&(!opts.$not_read_since||cr.value.last_read<opts.$not_read_since)&&(returnData.numRecords++,returnData.sizeRecords+=JSON.stringify(cr.value).length),cr["continue"]()):deferred.resolve(storageInterface.buildResult(storageInterface.StatusCodes.OK,returnData))}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}},request.onerror=function(event){event.target.errorCode==IDBDatabaseException.NOT_FOUND_ERR?deferred.resolve():deferred.reject(storageInterface.buildErrResult("error reading from database: "+self._eventToMessage(event)))}}catch(e){deferred.reject(storageInterface.buildErrResult("error reading from database",e))}finally{return deferred.promise()}}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/storage/storageIndexedDBDrafts",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/storage/storageIndexedDBSData","syracuse-tablet/html/js/storage/storageInterface","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),Base=require("syracuse-tablet/html/js/storage/storageIndexedDBSData").Klass,storageInterface=require("syracuse-tablet/html/js/storage/storageInterface"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("drafts",!1),notifications=require("syracuse-tablet/html/js/helpers/notifications"),IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction,IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,IDBDatabaseException=window.IDBDatabaseException||window.webkitIDBDatabaseException,READ_ONLY=IDBTransaction&&IDBTransaction.READ_ONLY||"readonly",READ_WRITE=IDBTransaction&&IDBTransaction.READ_WRITE||"readwrite",_objectStores={drafts:{options:{keyPath:"id",autoIncrement:!0},indexes:{}},workingcopies:{options:{keyPath:"id",autoIncrement:!0},indexes:{}}},_logError=function(who,e){if(!log)return;log("INDEXED DB - ERROR");for(var i=0;i<arguments.length;i++){var e=arguments[i];if(typeof e=="string"){log(e);continue}if(e&&e.target&&e.target.errorCode!=IDBDatabaseException.NOT_FOUND_ERR){log(JSON.stringify(e,null,2));continue}log(JSON.stringify(jsutils.convertToDiagnoses(e),null,2))}},_objName=function(type){return type==="d"?"drafts":"workingcopies"},_Klass=utils.defineClass(function(){Base.call(this)},Base,{getObjectStores:function(){var res=Base.prototype.getObjectStores.call(this);return $.extend(res,_objectStores),res},_draftsObjectStore:function(type,readOpt){var self=this,deferred=$.Deferred();try{var tx=self.db.transaction([_objName(type)],readOpt||READ_WRITE);tx.oncomplete=function(event){log&&log("tx.oncomplete",JSON.stringify(event,null,2))},tx.onerror=function(event){log&&log("tx.onerror",JSON.stringify(event,null,2))},deferred.resolve(tx.objectStore(_objName(type)))}catch(e){_logError("_draftsObjectStore - "+_objName(type),e),deferred.reject(e)}return deferred.promise()},_draftGetObject:function(type,id,fail){var self=this,deferred=$.Deferred();return self._draftsObjectStore(type,READ_ONLY).then(function(objectStore){var request=objectStore.get(id);request.onsuccess=function(event){try{var result=request.result&&request.result.data?JSON.parse(request.result.data):null;deferred.resolve(result),log&&log("_draftGetObject - "+_objName(type),"OK")}catch(e){log&&log("_draftGetObject - "+_objName(type),"Error parsing data"),fail?deferred.reject({$diagnoses:[{$message:"_draftGetObject - "+_objName(type)+" - Error parsing data"}]}):deferred.resolve(null)}},request.onerror=function(event){_logError("_draftGetObject - "+_objName(type),event),fail?deferred.reject({$diagnoses:[{$message:_objName(type)+" - IndexedDB.OpenCursor error",$stackTrace:self._eventToMessage(event)}]}):deferred.resolve(null)}}).fail(function(e){fail?deferred.reject(e):deferred.resolve(null)}),deferred.promise()},_draftGetAllObjects:function(type,fail){var self=this,deferred=$.Deferred();return self._draftsObjectStore(type,READ_ONLY).then(function(objectStore){var request=objectStore.openCursor(),result=[],data;request.onsuccess=function(event){var cursor=event.target.result;if(cursor){try{data=cursor.value&&cursor.value.data?JSON.parse(cursor.value.data):null,data&&result.push(data)}catch(e){log&&log("_draftGetAllObjects - "+_objName(type),"Error parsing data")}cursor.continue()}else log&&log("_draftGetAllObjects - "+_objName(type),"OK"),deferred.resolve(result)},request.onerror=function(event){_logError("_draftGetAllObjects - "+_objName(type),event),fail?deferred.reject({$diagnoses:[{$message:_objName(type)+" - IndexedDB.openCursor error",$stackTrace:self._eventToMessage(event)}]}):deferred.resolve([])}}).fail(function(e){fail?deferred.reject(e):deferred.resolve([])}),deferred.promise()},_draftPutObject:function(type,id,data,fail){var self=this,deferred=$.Deferred();return!data||!id?(_logError("_draftPutObject - "+_objName(type),"Invalid parameters"),fail?deferred.reject({$diagnoses:[{$message:"_draftPutObject - "+_objName(type)+" - Invalid parameters"}]}):deferred.resolve(null)):self._draftsObjectStore(type,READ_WRITE).then(function(objectStore){var _put=function(created){var request=objectStore.put({id:id,data:JSON.stringify(data),creation_date:utils.getCurISODateTime(new Date)});request.onsuccess=function(event){log&&log("_draftPutObject - "+_objName(type),"OK"),deferred.resolve(data,created)},request.onerror=function(event){_logError("_draftPutObject - "+_objName(type),event),fail?deferred.reject({$diagnoses:[{$message:_objName(type)+" - IndexedDB.put error",$stackTrace:self._eventToMessage(event)}]}):deferred.resolve(null)}},request=objectStore.get(id);request.onsuccess=function(event){_put(!0)},request.onerror=function(event){_put(!1)}}).fail(function(e){fail?deferred.reject(e):deferred.resolve(null)}),deferred.promise()},_draftDeleteObject:function(type,id,fail){var self=this,deferred=$.Deferred();return self._draftsObjectStore(type,READ_WRITE).then(function(objectStore){var request=objectStore["delete"](id);request.onsuccess=function(event){log&&log("_draftDeleteObject - "+_objName(type),"OK"),deferred.resolve(!0)},request.onerror=function(event){_logError("_draftDeleteObject - "+_objName(type),event),fail?deferred.reject({$diagnoses:[{$message:_objName(type)+" -  IndexedDB.delete error",$stackTrace:self._eventToMessage(event)}]}):deferred.resolve(!1)}}).fail(function(e){fail?deferred.reject(e):deferred.resolve(!1)}),deferred.promise()},_draftDeleteAllObjects:function(type,id,fail){var self=this,deferred=$.Deferred();return self._draftsObjectStore(type,READ_WRITE).then(function(objectStore){var request=objectStore.clear();request.onsuccess=function(event){log&&log("_draftDeleteAllObjects"+_objName(type),"OK"),deferred.resolve(!0)},request.onerror=function(event){_logError("_draftDeleteAllObjects"+_objName(type),event),fail?deferred.reject({$diagnoses:[{$message:_objName(type)+" -  IndexedDB.clear error",$stackTrace:self._eventToMessage(event)}]}):deferred.resolve(!1)}}).fail(function(e){fail?deferred.reject(e):deferred.resolve(!1)}),deferred.promise()},_draftCountAllObjects:function(type,fail){var self=this,deferred=$.Deferred();return self._draftsObjectStore(type,READ_ONLY).then(function(objectStore){var request=objectStore.count();request.onsuccess=function(event){log&&log("_draftCountAllObjects"+_objName(type),"OK",request.result),deferred.resolve(request.result)},request.onerror=function(event){_logError("_draftCountAllObjects"+_objName(type),event),fail?deferred.reject({$diagnoses:[{$message:_objName(type)+" -  IndexedDB.count error",$stackTrace:self._eventToMessage(event)}]}):deferred.resolve(0)}}).fail(function(e){fail?deferred.reject(e):deferred.resolve(0)}),deferred.promise()},_wrkcpyRead:function(id){return this._draftGetObject("w",id,!1)},_wrkcpyDelete:function(id){return this._draftDeleteObject("w",id,!1)},_wrkcpyDeleteAll:function(){return this._draftDeleteAllObjects("w",!1)},_wrkcpyUpdate:function(dataSet){return dataSet?this._draftPutObject("w",dataSet.$uuid,dataSet,!1):$.smResolve(null)},_wrkcpyCreate:function(dataSet){return this._wrkcpyUpdate(dataSet)},_draftReadList:function(){return this._draftGetAllObjects("d",!1)},_draftRead:function(id){return this._draftGetObject("d",id,!1)},_draftDelete:function(id){var self=this;return self._draftDeleteObject("d",id,!1).then(function(result){return self._draftNotifyChanged(),result})},_draftDeleteAll:function(){var self=this;return self._deleteAllObject("d",!1).then(function(result){return self._draftNotifyChanged(),result})},_draftSave:function(ctx){if(!ctx)return $.smResolve(null);var self=this;return self._draftPutObject("d",ctx.id,ctx,!1).then(function(data,created){return created&&self._draftNotifyChanged(),data})},_draftCount:function(notify){return this._draftCountAllObjects("d",!1).then(function(count){return notify&&notifications.publish("sm.drafts.changed",count),count})},_draftNotifyChanged:function(){return this._draftCount(!0)},draftOperation:function(op){switch(op){case"wrkcpyUpdate":return this._wrkcpyUpdate(arguments[1]);case"wrkcpyRead":return this._wrkcpyRead(arguments[1]);case"wrkcpyDelete":return this._wrkcpyDelete(arguments[1]);case"wrkcpyCreate":return this._wrkcpyCreate(arguments[1],arguments[2]);case"wrkcpyDeleteAll":return this._wrkcpyDeleteAll(arguments[1]);case"draftSave":return this._draftSave(arguments[1]);case"draftDelete":return this._draftDelete(arguments[1]);case"draftDeleteAll":return this._draftDeleteAll();case"draftRead":return this._draftRead(arguments[1]);case"draftReadList":return this._draftReadList();case"draftCount":return this._draftCount(!1);case"draftNotifyChanged":var self=this;setTimeout(function(){self._draftNotifyChanged()});return;default:return $.smReject(storageInterface.buildErrResult("Unknown Draft operation["+op+"]"))}}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/storage/storageIndexedDBTemplates",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/storage/storageInterface","syracuse-tablet/html/js/storage/storageIndexedDBDrafts","syracuse-tablet/html/js/helpers/logger"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),storageInterface=require("syracuse-tablet/html/js/storage/storageInterface"),Base=require("syracuse-tablet/html/js/storage/storageIndexedDBDrafts").Klass,log=require("syracuse-tablet/html/js/helpers/logger").getLogger("templates",!1),IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction,IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,IDBDatabaseException=window.IDBDatabaseException||window.webkitIDBDatabaseException,READ_ONLY=IDBTransaction&&IDBTransaction.READ_ONLY||"readonly",READ_WRITE=IDBTransaction&&IDBTransaction.READ_WRITE||"readwrite",_objectStores={edittemplates:{options:{keyPath:"id",autoIncrement:!0},indexes:{repandep:{key:["representation","endpoint"],options:{unique:!1}}}}},_logError=function(who,e){if(!log)return;log("INDEXED DB - ERROR");for(var i=0;i<arguments.length;i++){var e=arguments[i];if(typeof e=="string"){log(e);continue}if(e&&e.target&&e.target.errorCode!=IDBDatabaseException.NOT_FOUND_ERR){log(JSON.stringify(e,null,2));continue}log(JSON.stringify(jsutils.convertToDiagnoses(e),null,2))}},_Klass=utils.defineClass(function(){Base.call(this)},Base,{getObjectStores:function(){return $.extend(Base.prototype.getObjectStores.call(this),_objectStores)},_tmplOnError:function(deferred,event,fail,value,caller){_logError(caller,event),fail?deferred.reject({$diagnoses:[{$message:"IndexedDB Error - "+caller,$stackTrace:this._eventToMessage(event)}]}):deferred.resolve(value)},_tmplOnExcep:function(deferred,fail,e,value){fail?deferred.reject(e):deferred.resolve(value)},_tmplObjectStore:function(readOpt){var self=this,deferred=$.Deferred();try{var tx=self.db.transaction("edittemplates",readOpt||READ_WRITE);tx.oncomplete=function(event){log&&log("tx.oncomplete",JSON.stringify(event,null,2))},tx.onerror=function(event){log&&log("tx.onerror",JSON.stringify(event,null,2))},deferred.resolve(tx.objectStore("edittemplates"))}catch(e){_logError("_tmplObjectStore",e),deferred.reject(e)}return deferred.promise()},_tmplGetObject:function(id,fail){var self=this,deferred=$.Deferred();return self._tmplObjectStore(READ_ONLY).then(function(objectStore){var request=objectStore.get(id);request.onsuccess=function(event){deferred.resolve(request.result)},request.onerror=function(event){self._tmplOnError(deferred,event,fail,null,"_tmplGetObject")}}).fail(function(e){self._tmplOnExcep(deferred,fail,e,null)}),deferred.promise()},_tmplGetAllObjects:function(fail,filter){var self=this,deferred=$.Deferred();return self._tmplObjectStore(READ_ONLY).then(function(objectStore){var request=objectStore.openCursor(),result=[],data;request.onsuccess=function(event){var cursor=event.target.result;cursor?(cursor.value&&(filter==null||filter(cursor.value)===!0)&&result.push(cursor.value),cursor.continue()):deferred.resolve(result)},request.onerror=function(event){self._tmplOnError(deferred,event,fail,[],"_tmplGetAllObjects")}}).fail(function(e){self._tmplOnExcep(deferred,fail,e,[])}),deferred.promise()},_tmplPutObject:function(data,updateDate,fail){var self=this,deferred=$.Deferred();if(!data||!data.id)fail?deferred.reject({$diagnoses:[{$message:"_tmplPutObject - Invalid parameters"}]}):deferred.resolve(null);else{var id=data.id;self._tmplObjectStore(READ_WRITE).then(function(objectStore){var _put=function(created){data=$.extend(!0,{},data);if(data["creation_date"]==null||updateDate)data.creation_date=utils.getCurISODateTime(new Date);var request=objectStore.put(data);request.onsuccess=function(event){deferred.resolve(data,created)},request.onerror=function(event){self._tmplOnError(deferred,event,fail,null,"_tmplPutObject")}},request=objectStore.get(id);request.onsuccess=function(event){_put(!0)},request.onerror=function(event){_put(!1)}}).fail(function(e){self._tmplOnExcep(deferred,fail,e,null)})}return deferred.promise()},_tmplDeleteObject:function(id,fail){var self=this,deferred=$.Deferred();return self._tmplObjectStore(READ_WRITE).then(function(objectStore){var request=objectStore["delete"](id);request.onsuccess=function(event){deferred.resolve(!0)},request.onerror=function(event){self._tmplOnError(deferred,event,fail,!1,"_tmplDeleteObject")}}).fail(function(e){self._tmplOnExcep(deferred,fail,e,!1)}),deferred.promise()},_tmplDeleteAllObjects:function(id,fail){var self=this,deferred=$.Deferred();return self._tmplObjectStore(READ_WRITE).then(function(objectStore){var request=objectStore.clear();request.onsuccess=function(event){deferred.resolve(!0)},request.onerror=function(event){self._tmplOnError(deferred,event,fail,!1,"_tmplDeleteAllObjects")}}).fail(function(e){self._tmplOnExcep(deferred,fail,e,!1)}),deferred.promise()},_tmplCountAllObjects:function(fail){var self=this,deferred=$.Deferred();return self._tmplObjectStore(READ_ONLY).then(function(objectStore){var request=objectStore.count();request.onsuccess=function(event){deferred.resolve(request.result)},request.onerror=function(event){self._tmplOnError(deferred,event,fail,0,"_tmplCountAllObjects")}}).fail(function(e){self._tmplOnExcep(deferred,fail,e,0)}),deferred.promise()},_tmplReadInfo:function(data){if(!data)return null;try{return{id:data.id,endpoint:data.endpoint||"",representation:data.representation||"",title:data.title||"",dataSet:data.dataSet,creation_date:data.creation_date}}catch(e){return log&&log("_tmplReadInfo","KO",data.id),null}},_tmplQueryWidthCompoundIndex:function(representation,endpoint,fail){var self=this,deferred=$.Deferred();return self._tmplObjectStore(READ_ONLY).then(function(objectStore){var request;if(representation||endpoint){var index=objectStore.index("repandep");request=index.openCursor(IDBKeyRange.only([representation,endpoint]))}else request=objectStore.openCursor();var result=[],data;request.onsuccess=function(event){var cursor=event.target.result;cursor&&cursor.value?(result.push(cursor.value),cursor.continue()):(log&&log("_tmplQuery - OK"),deferred.resolve(result))},request.onerror=function(event){self._tmplOnError(deferred,event,fail,[],"_tmplGetAllObjects")}}).fail(function(e){self._tmplOnExcep(deferred,fail,e,[])}),deferred.promise()},_tmplQuery:function(representation,endpoint,fail){return this._tmplGetAllObjects(fail,function(value){return representation!=null&&representation!=value.representation?!1:endpoint!=null&&endpoint!=value.endpoint?!1:!0})},_tmplRead:function(id){return this._tmplGetObject(id,!1)},_tmplUpdate:function(id,ctx){var self=this;return self._tmplRead(id).then(function(result){if(!result||!ctx)return;return self._tmplSave($.extend(result,ctx),!1)})},_tmplDelete:function(id){return this._tmplDeleteObject(id,!1)},_tmplDeleteAll:function(){return this._tmplDeleteAllObjects(!1)},_tmplSave:function(ctx,updateDate){var self=this,deferred=$.Deferred();return!ctx||!ctx.id?(log&&log("_tmplSave error","Invalid parameters"),deferred.reject(new Error("Invalid parameters"))):self._tmplDelete(ctx.id).then(function(){return self._tmplPutObject(ctx,updateDate,!1)}).then(function(){log&&log("_tmplSave",ctx.id,"OK"),deferred.resolve(ctx)}).fail(function(status){_logError("_tmplSave",status),deferred.reject(status.$exception||new Error(status.message))}),deferred.promise()},_tmplCount:function(){return this._tmplCountAllObjects()},templateOperation:function(op){switch(op){case"save":return this._tmplSave(arguments[1],!0);case"delete":return this._tmplDelete(arguments[1]);case"deleteAll":return this._tmplDeleteAll(arguments[1],arguments[2]);case"read":return this._tmplRead(arguments[1]);case"update":return this._tmplUpdate(arguments[1],arguments[2]);case"query":return this._tmplQuery(arguments[1],arguments[2],arguments[3]);case"readall":return this._tmplQuery(arguments[1]);case"count":return this._tmplCount();default:return $.smReject(storageInterface.buildErrResult("Unknown template operation["+op+"]"))}}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/storage/storageIndexedDB",["require","exports","module","syracuse-tablet/html/js/storage/storageIndexedDBTemplates"],function(require,exports,module){var _storageInterface=require("syracuse-tablet/html/js/storage/storageIndexedDBTemplates").Klass;exports.getStorageInterface=function(){return _storageInterface},exports.isAvailable=function(){var indexedDB=window.indexedDB||window.webkitIndexedDB;return indexedDB!=null}}),define("syracuse-tablet/html/js/storage/storage",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/storage/storageInterface","syracuse-tablet/html/js/storage/storageWebSQL","syracuse-tablet/html/js/storage/storageIndexedDB"],function(require,exports,module){function _getStorageImpl(noFail){if(_storageImpl)return _storageImpl;_impls.some(function(impl){impl=_modules[impl];if(impl.isAvailable()){var ctor=impl.getStorageInterface();return _storageImpl=new ctor,!0}return!1});if(_storageImpl==null&&noFail!==!0)throw new Error("No storage interface (indexedDB or WebSQL) has been found");return _storageImpl}var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("storage",!1),storageInterface=require("syracuse-tablet/html/js/storage/storageInterface"),_modules={webSQL:require("syracuse-tablet/html/js/storage/storageWebSQL"),indexedDB:require("syracuse-tablet/html/js/storage/storageIndexedDB")},_impls=["webSQL","indexedDB"],_storageImpl;exports.getStorage=_getStorageImpl,exports.StatusCodes=storageInterface.StatusCodes,exports.init=function(supportedDB){if(supportedDB==null)_getStorageImpl();else{log&&log("Force supported DB="+supportedDB);var impl=_modules[supportedDB];if(!impl||!impl.isAvailable())throw new Error("Storage interface ("+supportedDB+") is not supported");var ctor=impl.getStorageInterface();_storageImpl=new ctor}return log&&log("DATABASE="+_storageImpl.infoString),_storageImpl.init()}}),define("syracuse-tablet/html/js/application/settings",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/storage/storage","syracuse-tablet/html/js/helpers/logger"],function(require,exports,module){function _getContext(){var ctx=globals.getUserCtx();return ctx?ctx:{$user:"none",$role:"none",$lang:"en-US"}}function _checkContextUserRole(){var ctx=_getContext();if(_currentContextUserRole.user!=ctx.$user||_currentContextUserRole.role!=ctx.$role)_currentContextUserRole.user=ctx.$user,_currentContextUserRole.role=ctx.$role,_currentContextUserRole.lang=ctx.$lang,_settingsUserRole=null}function _readSettingsUserRole(){var storage=globals.getStorage(),ctx={$user:_currentContextUserRole.user,$role:_currentContextUserRole.role,$lang:"none"};return storage.read({$context:ctx,$collection:"$settings",$endpoint:"$local",$key:"$user_and_role"}).then(function(result){return result.$status===storageModule.StatusCodes.OK?result.$data:{}})}function _checkContextUser(){var ctx=_getContext();if(_currentContextUser.user!=ctx.$user||_currentContextUser.role!=ctx.$role)_currentContextUser.user=ctx.$user,_currentContextUser.role=ctx.$role,_currentContextUser.lang=ctx.$lang,_settingsUser=null}function _readSettingsUser(){if(_settingsUser==null){var storage=globals.getStorage(),ctx={$user:_currentContextUser.user,$role:"none",$lang:"none"};return storage.read({$context:ctx,$collection:"$settings",$endpoint:"$local",$key:"$user"}).then(function(result){result.$status===storageModule.StatusCodes.OK?_settingsUser=result.$data:_settingsUser={},log&&log("Read user settings..."),log&&log(JSON.stringify(_settingsUser))})}return $.smResolve()}function _writeSettingsUser(){var storage=globals.getStorage(),ctx={$user:_currentContextUser.user,$role:"none",$lang:"none"};return log&&log("Writing user settings..."),log&&log(_settingsUser),storage.put({$context:ctx,$collection:"$settings",$endpoint:"$local",$key:"$user",$data:_settingsUser}).then(function(result){return result.$status===storageModule.StatusCodes.OK?result.$data:{}})}var globals=require("syracuse-tablet/html/js/helpers/globals"),storageModule=require("syracuse-tablet/html/js/storage/storage"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("settings",!1),_currentContextUserRole={},_currentContextUser={},_settingsUserRole=null,_settingsUser=null;exports.readUserPagePrefs=function(pageId){var storage=globals.getStorage(),gc=_getContext(),ctx={$user:gc.$user,$role:"none",$lang:"none"};return storage.read({$context:ctx,$collection:"$settings",$endpoint:"$local",$key:pageId}).then(function(result){var res;return result.$status===storageModule.StatusCodes.OK&&(res=result.$data),res=res||{},res.favorites=res.favorites||[],log&&log("read user page setting: "+pageId),log&&log(JSON.stringify(res)),res})},exports.writeUserPagePrefs=function(pageId,prefs){var storage=globals.getStorage(),gc=_getContext(),ctx={$user:gc.$user,$role:"none",$lang:"none"};return exports.readUserPagePrefs(pageId).then(function(oldPrefs){return"favorites"in prefs&&(oldPrefs.favorites=prefs.favorites),"filter"in prefs&&(oldPrefs.filter=prefs.filter),"sort"in prefs&&(oldPrefs.sort=prefs.sort),"chartDetail"in prefs&&(oldPrefs.chartDetail=prefs.chartDetail),oldPrefs}).then(function(newPrefs){return log&&log("write user page setting: "+pageId),log&&log(JSON.stringify(newPrefs)),storage.put({$context:ctx,$collection:"$settings",$endpoint:"$local",$key:pageId,$data:newPrefs})})},exports.getLastUserProfile=function(profile){var ctx={$user:"none",$role:"none",$lang:"none"},storage=globals.getStorage();return storage.read({$context:ctx,$collection:"$settings",$endpoint:"$local",$key:"$last_user_profile"}).then(function(result){return result.$status===storageModule.StatusCodes.OK?result.$data:null})},exports.setLastUserProfile=function(profile){var ctx={$user:"none",$role:"none",$lang:"none"},storage=globals.getStorage();return storage.put({$context:ctx,$collection:"$settings",$endpoint:"$local",$key:"$last_user_profile",$data:profile}).then(function(result){return result.$status===storageModule.StatusCodes.OK?result.$data:null})},exports.getGlobalSettings=function(){var storage=globals.getStorage(),ctx={$user:"none",$role:"none",$lang:"none"};return storage.read({$context:ctx,$collection:"$settings",$endpoint:"$local",$key:"$global_settings"}).then(function(result){var settings;return result.$status===storageModule.StatusCodes.OK?settings=result.$data:settings={"device-type":"auto"},globals.setGlobalSettings(settings),settings})},exports.setGlobalSettings=function(settings){var storage=globals.getStorage(),ctx={$user:"none",$role:"none",$lang:"none"},def=$.Deferred();return storage.put({$context:ctx,$collection:"$settings",$endpoint:"$local",$key:"$global_settings",$data:settings}).then(function(){globals.setGlobalSettings(settings),def.resolve(settings)}).fail(function(e){def.resolve()}),def.promise()},exports.getLoginRememberMe=function(){return _readSettingsUser().then(function(){return _settingsUser.loginRememberMe!==!0?!1:!0})},exports.setLoginRememberMe=function(value){return _readSettingsUser().then(function(apps){value=value!==!1,_settingsUser.loginRememberMe!==value&&(_settingsUser.loginRememberMe=value,_writeSettingsUser())})}}),define("syracuse-tablet/html/js/init/initContext",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalSelectContext","syracuse-tablet/html/js/sdata/sdataCommonResources","syracuse-tablet/html/js/storage/localStorage","syracuse-tablet/html/js/application/settings"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalSelectContext=require("syracuse-tablet/html/js/ui/modals/modalSelectContext"),sdataCommonResources=require("syracuse-tablet/html/js/sdata/sdataCommonResources"),localStorage=require("syracuse-tablet/html/js/storage/localStorage"),settings=require("syracuse-tablet/html/js/application/settings"),_profileSettings=null,_checkNavigatorLang=function(){var navLang=utils.getNavigatorLanguage(),result;return _profileSettings&&_profileSettings.locales&&_profileSettings.locales.some(function(l){if(utils.sameLanguage(l.code,navLang))return result=l.code,!0}),result||"en-US"};exports.getLastUsedContext=function(userName){var context;try{var settingsKey=userName+"_lastContext",contextString=localStorage.getItem(settingsKey);contextString&&contextString.length>0&&(context=JSON.parse(contextString))}catch(e){}return context},exports.setLastUsedContext=function(userName,context){try{var settingsKey=userName+"_lastContext",contextString=JSON.stringify(context);localStorage.setItem(settingsKey,contextString)}catch(e){}},exports.removeLastUsedContext=function(userName){try{localStorage.removeItem(userName+"_lastContext")}catch(e){}};var _checkContext=function(context){return context&&context.language&&context.role&&context.endpoint?context:null},_askUserSettings=function(currentContext,contextToRestore,fromUserAction,isOffLine){var deferred=$.Deferred(),opts={offline:isOffLine,hideEndpoints:contextToRestore!=null&&contextToRestore.endpoint!=null,hideRoles:contextToRestore!=null&&contextToRestore.role!=null};return(new modalSelectContext.Modal(currentContext,_profileSettings,opts,isOffLine)).show().then(function(selectedContext){if(selectedContext==null||selectedContext.action!=="ok"){selectedContext&&selectedContext.action==="logout"||fromUserAction!==!0?deferred.reject({$redirectPage:"login",message:"login.authentication",title:"logout.msg"}):deferred.resolve(null);return}opts.hideEndpoints===!0&&(selectedContext.endpoint=contextToRestore.endpoint),opts.hideRoles===!0&&(selectedContext.role=contextToRestore.role),deferred.resolve(selectedContext)}).fail(function(e){deferred.reject(e)}),deferred.promise()},_updateServerUserProfile=function(userProfile,context,fromUserAction){var change=!1,upChanges={},endPoints=null;return change=_profileSettings.roles.some(function(role){if(role.code===context.role){endPoints=role.endPoints;if(role.$uuid!==userProfile.selectedRole.$uuid)return upChanges.selectedRole={$uuid:role.$uuid},!0}return!1})||change,change=endPoints&&endPoints.some(function(ep){return ep.code!==context.endpoint||userProfile.selectedEndpoint!=null&&ep.$uuid===userProfile.selectedEndpoint.$uuid?!1:(upChanges.selectedEndpoint={$uuid:ep.$uuid},!0)})||change,change=_profileSettings.locales.some(function(lang){return lang.code===context.language&&lang.$uuid!==userProfile.selectedLocale.$uuid?(upChanges.selectedLocale={$uuid:lang.$uuid},!0):!1})||change,change?(fromUserAction&&globals.getApplication().waitWheelStart(),sdataCommonResources.updateUserProfile(upChanges).then(function(newProfile){return globals.setUserProfile(newProfile),settings.setLastUserProfile(newProfile)}).then(function(newProfile){return newProfile?$.extend(context,{role:newProfile.selectedRole.code,language:newProfile.selectedLocale.code,endpoint:newProfile.selectedEndpoint.code}):null})):settings.setLastUserProfile(userProfile).then(function(){return null})};exports.init=function(fromUserAction,contextToRestore,offlineLogin){fromUserAction!==!0&&(_profileSettings=null);var userProfile=globals.getUserProfile();if(!userProfile)throw new Error("Unexpected empty user profile");var userName=userProfile.user.$value,isOffLine=offlineLogin==1||globals.isOnline()!==!0,step=settings.getGlobalSettings(),def=$.Deferred();return offlineLogin?step.then(function(){if(_checkContext(exports.getLastUsedContext(userName)))return;return $.smReject(new Error("offline.nocontext"))}).then(function(e){def.resolve(e)}).fail(function(e){def.reject(e)}):_profileSettings?step.then(function(){return sdataCommonResources.isConnectionAlive()}).then(function(alive){isOffLine=alive!==!0}).then(function(e){def.resolve(e)}).fail(function(e){def.reject(e)}):step.then(function(){return sdataCommonResources.getUserProfileSettings()}).then(function(profileSettings){_profileSettings=profileSettings,def.resolve()}).fail(function(e){if(e.$noConnectionError){isOffLine=!0,def.resolve();return}def.reject(e)}),def.then(function(){if(contextToRestore){var lastCtx=exports.getLastUsedContext(userName);contextToRestore.language=lastCtx?lastCtx.language:_checkNavigatorLang(),contextToRestore=_checkContext(contextToRestore);if(contextToRestore)return $.smResolve(contextToRestore)}var currentContext=_checkContext(exports.getLastUsedContext(userName));return fromUserAction===!0||currentContext==null?(currentContext==null&&(currentContext={role:userProfile.selectedRole.code,language:userProfile.selectedLocale.code,endpoint:userProfile.selectedEndpoint.code}),_askUserSettings(currentContext,contextToRestore,fromUserAction,isOffLine)):$.smResolve(currentContext)}).then(function(selectedContext){return selectedContext==null?null:offlineLogin===!0?null:(globals.setUserCtx({$user:userName,$role:selectedContext.role,$lang:selectedContext.language}),locale.setLocale(selectedContext.language),globals.setEndpoint(selectedContext.endpoint,selectedContext.endpointDescr),exports.setLastUsedContext(userName,selectedContext),_updateServerUserProfile(userProfile,selectedContext,fromUserAction))}).then(function(selectedContext){return $.smResolve(contextToRestore,fromUserAction?selectedContext==null:null)})},exports.askNewContext=function(){return exports.init(!0).then(function(contextToRestore,canceled){return canceled})},exports.switchContext=function(contextToRestore){if(!contextToRestore)return;var contextToRestore=$.extend(!0,{},contextToRestore);contextToRestore.endpoint||(contextToRestore.endpoint=globals.getEndpoint());var userCtx=globals.getUserCtx();return contextToRestore.language||(contextToRestore.language=userCtx.$lang),contextToRestore.role||(contextToRestore.role=userCtx.$role),exports.init(!1,contextToRestore)}}),define("syracuse-tablet/html/js/sdata/entities/clientContract",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/sdata/sdataUtils"],function(require,exports,module){function _buildPageInfo(repr,facet,entity){var page={$page:{},$cache:{}};return _buildPage(repr,facet,entity,page.$page),page}function _buildPage(repr,facet,entity,page){if(facet.smStartsWith("$cube"))page.$prototype=entity.$createProto();else if(facet==="$query"||facet==="$lookup")page.$prototype={$properties:{$resources:{$type:"application/x-array",$item:_buildPrototype(repr,facet),$url:"{$baseUrl}/"+repr+"('{$key}')?representation="+repr+".$queryItem"}}},page.$prototype.$url="{$baseUrl}/"+repr+"?representation="+repr+"."+facet,page.$prototype.$properties.$resources.$item.$key="{$uuid}",page.$prototype.$properties.$resources.$item.$value=entity.$value,page.$prototype.$properties.$resources.$item.$links={$details:{$url:"{$baseUrl}/"+repr+"('{$key}')?representation="+repr+".$details",$title:"Details"},$edit:{$url:"{$baseUrl}/"+repr+"('{$key}')?representation="+repr+".$edit",$title:"Edit"}},page.$prototype.$links={$create:{$url:"{$baseUrl}/"+repr+"('{$key}')?representation="+repr+".$create",$title:"Create New"}},page.$prototype.$key="{$uuid}";else{page.$prototype=_buildPrototype(repr,facet),page.$prototype.$url="{$baseUrl}/"+repr+"('{$key}')?representation="+repr+"."+facet,page.$prototype.$key="{$uuid}",page.$prototype.$links={};var links={$edit:{$url:"{$baseUrl}/"+repr+"('{$key}')?representation="+repr+".$edit",$title:"Edit"},$query:{$url:"{$baseUrl}/"+repr+"?representation="+repr+".$query",$title:"List"},$save:{$url:"{$baseUrl}/"+repr+"('{$key}')?representation="+repr+".$save",$title:"Save"},$details:{$url:"{$baseUrl}/"+repr+"('{$key}')?representation="+repr+".$details",$title:"Detail"}};switch(facet){case"$create":page.$prototype.$links.$save=links.$save,page.$prototype.$links.$query=links.$query;break;case"$details":page.$prototype.$links.$edit=links.$edit,page.$prototype.$links.$query=links.$query;break;case"$edit":page.$prototype.$links.$save=links.$save,page.$prototype.$links.$details=links.$details,page.$prototype.$links.$query=links.$query;break;default:throw new Error(facet?"facet "+facet+" not handled yet":"No facet specified")}}entity.$title&&!page.$prototype.$title&&(page.$prototype.$title=entity.$title);var $article=entity.$articles&&entity.$articles[facet];$article&&(page.$article=$article),page.$prototype.$baseUrl=_LOCAL_ENTITIES_URL,entity.$prototype&&entity.$prototype(page.$prototype,repr,facet)}function _buildPrototype(repr,facet){var entity=_entities[repr];if(!entity)return null;var proto={$properties:{}};return Object.keys(entity.$properties).forEach(function(key){var prop=entity.$properties[key],$type=prop.$type||"application/x-string",propNew=proto.$properties[key]={$type:$type};for(var i=0;i<_propertiesToCopy.length;i++){var pname=_propertiesToCopy[i],p=prop[pname];p&&(propNew[pname]=p)}}),proto}var globals=require("syracuse-tablet/html/js/helpers/globals"),sdataUtils=require("syracuse-tablet/html/js/sdata/sdataUtils"),_LOCAL_ENTITIES_URL="http://localhost:8124/mobile1/x3/erp/local",_entities={},_propertiesToCopy=["$title","$isExcluded","$isHidden","$isMandatory","$isReadOnly","$isDisabled","$format","$x3Format","$unit","$value","$shortTitle","$capabilities","$item","$minimum","$maximum","$exclusiveMinimum","$exclusiveMaximum","$minItems","$maxItems","$isNullable","$isUnique","$pattern","$minLength","$maxLength","$precision","$scale","$enum","$format","$url"];exports.registerApp=function(app){globals.getMetaData().registerStaticApp(app)},exports.registerEntity=function(entity){_entities[entity.$entityName]=entity},exports.getEntity=function(entity){return _entities[entity]},exports.getPageInfo=function(name,options){var repr=name.split(".");repr.length===5&&(repr=repr.slice(3,5));if(repr[0].smStartsWith("QUERY~")||repr[0].smStartsWith("STATS~")){var p=repr[0].split("~");repr[0]=p[1]}var ent=_entities[repr[0]];if(!ent)return null;var state={home:!1,type:"regular",subtype:repr[1]?repr[1].substring(1):"unknown",cached:!1,refreshed:!1};return state.name=name,state},exports.getRegularPageInfo=function(pageId){var repr=pageId.split(".");repr.length===5&&(repr=repr.slice(3,5));if(repr[0].smStartsWith("QUERY~")||repr[0].smStartsWith("STATS~")){var p=repr[0].split("~");repr[0]=p[1]}var ent=_entities[repr[0]],pageInfo;return ent&&(pageInfo=_buildPageInfo(repr[0],repr[1],ent)),$.smResolve(pageInfo)},exports.getPrototype=function(repr,facet){return _buildPrototype(repr,facet)},exports.isLocalEntityUrl=function(url){return url?url.smStartsWith(_LOCAL_ENTITIES_URL):!1},exports.getLocalEntityUrl=function(entity,path){return _LOCAL_ENTITIES_URL+"/"+entity+(path?path:"")},exports.callLocalEntityUrl=function(url){var sdataUrl=sdataUtils.parseSDataURL(url);if(!sdataUrl||!sdataUrl.entity)return null;var entity=exports.getEntity(sdataUrl.entity);return!entity||!entity.$urlCall?null:entity.$urlCall(sdataUrl,sdataUrl.path.split("/").splice(6))}}),define("syracuse-tablet/html/js/application/pageRegistry",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/sdata/entities/clientContract"],function(require,exports,module){function _addOptions(pageName,pageInfo,options,currentPage){options=options||{},pageInfo.options=$.extend(!0,{},options),_addGadgetData(pageInfo,currentPage)}function _addGadgetData(pageInfo,currentPage){var gadgetId=pageInfo.options["gadget-id"];if(gadgetId){var $properties=currentPage&&currentPage.prototype&&currentPage.prototype.json&&currentPage.prototype.json.$properties;$properties&&Object.keys($properties).some(function(vignetteId){var vignette=$properties[vignetteId];if(vignette&&vignette.$gadget&&vignette.$gadget.$uuid===gadgetId){var json=vignette.$gadget;return pageInfo.options.gadget=json,!0}return!1})}}function _createDummyPageInfo(pageName){var pageInfo={name:pageName,home:!1,type:"regular",subtype:"",cached:!1,refreshed:!1};if(pageName){var x=pageName.split(".");x.length>0&&x[x.length-1].smStartsWith("$")&&(pageInfo.subtype=x[x.length-1].substring(1))}return pageInfo}function _addAuthoringInfo(pageInfo){if(!pageInfo.authoringName){var segs=pageInfo.name.split("."),authoringName;segs.length===5?authoringName=segs[0]+"."+segs[1]+"."+segs[3]+"."+segs[4]:authoringName=pageInfo.name,segs.length===2&&(authoringName="syracuse.collaboration."+authoringName),pageInfo.authoringName=authoringName}}function _registerStaticPages(){var pages={login:null,pageDrafts:{$prototype:{$title:locale.text("drafts.page.title")}}};for(var name in pages)_staticPages[name]=$.extend(!0,_defStaticInfo(name),pages[name])}var globals=require("syracuse-tablet/html/js/helpers/globals"),locale=require("syracuse-tablet/html/js/helpers/locale"),utils=require("syracuse-tablet/html/js/helpers/utils"),clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),_staticPages={},_getPageInfo=function(pageName,options,currentPage){return options=options||{},$.smResolve().then(function(){var pageInfo=_staticPages[pageName];return pageInfo}).then(function(pageInfo){return pageInfo||(pageInfo=clientContract.getPageInfo(pageName,options)),pageInfo}).then(function(pageInfo){if(pageName==="rowdetail"||pageName==="carddesign"||pageName==="chartdetail"){if(!currentPage)throw new Error(pageName+" - Not null currentPage expected");var ctrl=currentPage.getControl?currentPage.getControl(options.controlId):null;if(!ctrl)throw new Error(pageName+" - Control not found - id:"+options.controlId);if(!ctrl.childPageGetPageInfo)throw new Error(pageName+" - Control must implement childPageGetPageInfo");return ctrl.childPageGetPageInfo(pageName)}return pageInfo||(pageInfo=globals.getMetaData().getPageInfo(pageName)),pageInfo}).then(function(pageInfo){return pageInfo||(pageInfo=_createDummyPageInfo(pageName)),_addAuthoringInfo(pageInfo),pageInfo}).then(function(pageInfo){return _addOptions(pageName,pageInfo,options,currentPage),pageInfo.uuid=utils.readableuid("page",pageInfo.type,pageInfo.name),pageInfo.applicationName=globals.getApplication().dao.getApplicationName(),$.extend(!0,{},pageInfo)})},_defStaticInfo=function(name){return{name:name,type:"static",subtype:"html",cached:!1,refreshed:!1,home:!1,disableAuthoring:!0,isLogin:name==="login",$prototype:{$properties:{}},$article:{$layoutType:"stack",$items:[]}}};exports.getPageInfo=_getPageInfo,exports.init=function(){_registerStaticPages()}}),define("syracuse-tablet/html/js/authoring/authoringSData",["require","exports","module","syracuse-tablet/html/js/sdata/sdataHttp"],function(require,exports,module){function _extractErrors(data,result){return result==null&&(result={errors:!1,diags:{$diagnoses:[]}}),Object.keys(data).forEach(function(key){var value=data[key];key==="$diagnoses"?value.forEach(function(d){result.diags.$diagnoses.push(d),d.$severity=="error"&&(result.errors=!0)}):value&&typeof value=="object"&&_extractErrors(value,result)}),result}var sdataHttp=require("syracuse-tablet/html/js/sdata/sdataHttp"),_DEVICE_NAME="mobile";exports.getPageVariants=function(pageData){return $.smResolve().then(function(){pageData=$.extend(!0,{},{device:_DEVICE_NAME},pageData);if(!pageData.application||!pageData.contract||!pageData.representation||!pageData.facet||!pageData.device)return $.smReject("Not all mandatory parameters present: "+JSON.stringify(pageData));var code=[pageData.application,pageData.contract,pageData.representation,pageData.facet,pageData.device].join("."),key=encodeURIComponent(code).replace(/'/g,"''"),req={url:"/sdata/syracuse/collaboration/syracuse/pageDefs(code%20eq%20'"+key+"')?representation=pageDef.$details"};return sdataHttp.send(req)}).then(function(response){return response&&response.isSuccess?response.responseJSON.variants||[]:response.status===404?[]:response&&response.responseJSON&&response.responseJSON.$diagnoses?$.smReject(response.responseJSON):$.smReject("Unknown error")})},exports.deletePageVariants=function(pageData){return $.smResolve().then(function(){pageData=$.extend(!0,{},{device:_DEVICE_NAME},pageData);if(!pageData.application||!pageData.contract||!pageData.representation||!pageData.facet||!pageData.device)return $.smReject("Not all mandatory parameters present: "+JSON.stringify(pageData));var code=[pageData.application,pageData.contract,pageData.representation,pageData.facet,pageData.device].join("."),key=encodeURIComponent(code).replace(/'/g,"''"),req={url:"/sdata/syracuse/collaboration/syracuse/pageDefs(code%20eq%20'"+key+"')?representation=pageDef.$edit",method:"DELETE"};return sdataHttp.send(req).then(function(response){if(response&&response.isSuccess)return;return response&&response.responseJSON&&response.responseJSON.$diagnoses?$.smReject(response.responseJSON):$.smReject("Unknown error")})})};var _createPageDefinitionWC=function(opts){var params={pageContext:[opts.application,opts.contract,opts.representation,opts.facet].join("."),device:_DEVICE_NAME,representation:"pageAuth.$edit"},url="/sdata/syracuse/collaboration/syracuse/pageAuths"+(opts.variant!=null?"('"+opts.variant+"')":"/$template")+"/$workingCopies?"+Object.keys(params).map(function(key){return key+"="+params[key]}).join("&"),req={url:url,method:"POST"};return sdataHttp.send(req).then(function(response){return response&&response.isSuccess?response.responseJSON:response&&response.responseJSON&&response.responseJSON.$diagnoses?$.smReject(response.responseJSON):$.smReject("Unknown error")})},_savePageDefinitionWC=function(opts,wc){var parameters={roles:opts.roles,users:opts.users,endpoints:opts.endpoints,saveAsOption:opts.saveAsOption,isFactory:!1,isModelRepresentation:!1,personalCopy:!1,variantCode:opts.variantCode,variantTitle:opts.variantTitle,variantDescription:opts.variantDescription};switch(opts.saveAsOption){case"factory_variant":parameters.isFactory=!0;break;case"personal_copy":parameters.personalCopy=!0;break;case"shared_copy":break;case"global_variant":}wc.$actions={};var save;opts.variant?(save=wc.$actions.$save={},delete parameters.saveAsOption):save=wc.$actions.saveAs={},save.$isRequested=!0,save.$parameters=parameters;var req={url:wc.$url,method:"PUT",send:wc};return sdataHttp.send(req).then(function(response){return response&&response.isSuccess?response.responseJSON:response&&response.responseJSON&&response.responseJSON.$diagnoses?$.smReject(response.responseJSON):$.smReject("Unknown error")})};exports.savePageDefinition=function(opts){var workingCopy;return _createPageDefinitionWC(opts).then(function(wc){workingCopy=wc;var send=$.extend(!0,{},workingCopy);return send.content=send.content||{},send.content.$article=opts.article,_savePageDefinitionWC(opts,send)}).then(function(wcSaved){var data=$.extend(!0,{},workingCopy,wcSaved),result=_extractErrors(data);return result.errors?$.smReject(result.diags):data})}}),define("syracuse-tablet/html/js/authoring/authoringHtml",["require","exports","module"],function(require,exports,module){function _getCompiled(name){var c=_compiled[name];if(c)return c;var t=_templates[name];return c=Handlebars.compile(t),_compiled[name]=c,c}var _templates={authPanelHeader:'		<div style="display:table;table-layout:fixed;;width:100%;">			<div style="display:table-row;width:100%; ">				<div style="display:table-cell;width:300px;">					<div style="display:table;">						<div style="display:table-row;position:absolute;top:0;">							<div style="display:table-cell;">								<button class="btn btn-auth-header" id="s-m-auth-settings-id" type="button"><label class="glyphicon glyphicon-cog"></label>{{label_settings}}</button> 							</div>							<div style="display:table-cell;" >								<div class="btn-group" id="s-m-auth-orientation-id" data-toggle="buttons">									<button class="btn btn-auth-header active" id="s-m-auth-vertical-id" data-auth-orientation="portrait" title="{{label_preview_portrait}}"> 										<input type="radio" name="orientation" checked> 										<label class="glyphicon glyphicon-resize-vertical"></label> 									</button> 									<button class="btn btn-auth-header" id="s-m-auth-horizontal-id" data-auth-orientation="landscape" title="{{label_preview_landscape}}"> 										<input type="radio" name="orientation"> 										<label class="glyphicon glyphicon-resize-horizontal"></label> 									</button> 								</div>							</div>							<div style="display:table-cell;">								<button class="btn btn-auth-header" id="s-m-auth-scale-id" type="button" title="{{label_scale_to_fit}}"><label class="glyphicon glyphicon-fullscreen"></button> 							</div>						</div>					</div>				</div>				<div style="display:table-cell;" id="s-m-auth-header-actions-id">					<div style="display:table;">						<div style="display:table-row;position:absolute;top:0;">							<button style="display:table-cell;" class="btn btn-auth-header" id="s-m-auth-new-layout-id" type="button"><label class="glyphicon glyphicon-blackboard"></label><span>{{label_new_layout}}</span></button> 							<button style="display:table-cell;" class="btn btn-auth-header" id="s-m-auth-remove-all-id" type="button"><label class="glyphicon glyphicon-erase"></label><span>{{label_remove_all}}</span></button> 							<button style="display:table-cell;" class="btn btn-auth-header disabled" id="s-m-auth-remove-id" type="button"><label class="glyphicon glyphicon-trash"></label><span>{{label_remove}}</span></button> 							<button style="display:table-cell;" class="btn btn-auth-header disabled" id="s-m-auth-remove-cnt-id" type="button"><label class="glyphicon glyphicon-erase"></label><span>{{label_remove_container}}</span></button> 						</div>					</div>				</div>				<div style="display:table-cell;">					<button id="auth-btn-close-id" style="float:right;" class="btn btn-danger" type="button"><div class="glyphicon glyphicon-remove"></label></button> 					<button id="auth-btn-save-id" style="float:right;" class="btn btn-default" type="button"><div class="glyphicon glyphicon-ok"></label></button> 					<button id="auth-btn-undo-all-id" style="float:right;" class="btn btn-auth-header" type="button"><div class="icon-undoall"></label>{{label_undo_all}}</button> 					<button id="auth-btn-undo-id"  style="float:right;" class="btn btn-auth-header" type="button"><div class="icon-undo"></label>{{label_undo}}</button> 				</div>			</div>		</div>',authPanelFooter:'		<div class="btn-group"> 		</div>',authPanelRightStructure:'		<div class="s-m-site-auth-panel-content"> 			<header id="authPanelControlType">{{label_design}}</header> 			<p class="form-control-static" id="authPanelControlTitle"> </p> 			<div id="authPanelControl" class="tab-pane panel-body active"> 				<div id="authPanelControlSimple"> 				</div> 			</div> 		</div>',authPanelLeftStructure:'		<div class="s-m-site-auth-panel-content"> 			<ul class="nav nav-pills" role="tablist"> 				<li class="active"><a aria-expanded="true" href="#s-m-auth-tree-box" role="tab" data-toggle="tab">{{label_content}}</a></li> 				<li><a href="#s-m-auth-insert-box" role="tab" data-toggle="tab">{{label_insert}}</a></li> 			</ul> 			<div class="tab-content"> 				<div id="s-m-auth-tree-box" class="tab-pane active"> 					<ul class="s-m-auth-tree" id="auth-structure-root-id"></ul> 				</div> 				<div id="s-m-auth-insert-box" class="tab-pane"> 					<div class="panel panel-primary s-m-panel-auth-prop"> 						<div class="panel-heading" role="tab" id="auth-lp-cnt-containers-header"> 							<a data-toggle="collapse" data-parent="#accordion" href="#auth-lp-cnt-containers-clpse" 								aria-expanded="true" aria-controls="auth-lp-cnt-containers-clpse" 								<h4 class="panel-title"> 									{{label_containers}}								</h4> 							</a> 						</div> 						<div id="auth-lp-cnt-containers-clpse" class="panel-collapse collapse in" 							role="tabpanel" aria-labelledby="auth-lp-cnt-containers-header"> 							<label>{{lab_drag_to_add}}</label><br> 							<div class="s-m-auth-btn-container s-m-draggable fa fa-th" data-auth-bind="group" title="{{lab_group}}" data-auth-drag-action="add_layout"></div> 							<div class="s-m-auth-btn-container s-m-draggable fa fa-square-o" data-auth-bind="tile" title="{{lab_tile}}" data-auth-drag-action="add_layout"></div> 							<div class="s-m-auth-btn-container s-m-draggable fa fa-bars" data-auth-bind="stack" title="{{lab_stack}}" data-auth-drag-action="add_layout"></div> 						</div> 					</div> 					<div class="panel panel-primary s-m-panel-auth-prop"> 						<div class="panel-heading" role="tab" id="auth-lp-cnt-props-header"> 							<a data-toggle="collapse" data-parent="#accordion" href="#auth-lp-cnt-props-clpse" 								aria-expanded="true" aria-controls="auth-lp-cnt-props-clpse">								<h4 class="panel-title"> 									{{label_fields}}								</h4> 							</a> 						</div> 						<div id="auth-lp-cnt-props-clpse" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="auth-lp-cnt-props-header"> 						</div> 					</div> 				</div> 			</div> 		</div>',authPanelPropertyGroup:' 		<div class="panel panel-primary s-m-panel-auth-prop s-m-auth-prop-type-{{type}}"> 			<div class="panel-heading" role="tab" id="heading_{{id}}"> 				<a data-toggle="collapse" data-parent="#{{#if parentId}}{{parentId}}{{/if}}{{#unless parentId}}accordion{{/unless}}" href="#collapse_{{id}}" {{#if expanded}} aria-expanded="true"{{/if}} aria-controls="collapse_{{id}}" {{#unless expanded}}class="collapsed"{{/unless}}>					<h4 class="panel-title"> 						{{label}}					</h4> 				</a> 			</div> 			<div id="collapse_{{id}}" class="panel-collapse collapse {{#if expanded}}in{{/if}}" role="tabpanel" aria-labelledby="heading_{{id}}"> 			</div> 		</div>',authPanelPropertySeperator:' 		<div class="auth-group-seperator"></div> 		',authPanelPropertyRadio:' 		<div class="btn-group" data-toggle="buttons" style="width: 100%;"> 			{{#each options}} 				<div class="btn-group" style="width: 100%; display: {{this.display}};" id="{{this.id}}"> 					<label class="s-m-auth-btn-radio-icon s-m-auth-btn-block" id="{{this.id}}_lab" data-s-m-auth-value="{{this.value}}"> 						<input type="radio" name="{{group}}" id="{{this.id}}">{{this.label}} 					</label> 				</div> 			{{/each}} 		</div>',authPanelPropertyRadioIcon:' 		<div class="btn-group" data-toggle="buttons" style="width: 100%;"> 			{{#each options}} 				<div class="btn-group"> 					<label class="auth-btn-icon {{icon}}" id="{{this.id}}_lab" data-s-m-auth-value="{{this.value}}"> 						<input type="radio" name="{{group}}" id="{{this.id}}"> 					</label> 				</div> 			{{/each}} 		</div>',authPanelPropertyCheckbox:' 		<div class="btn-group" style="width: 100%;"> 			{{#each options}} 				<div class="btn-group" style="width: 100%; display: {{this.display}};" id="{{this.id}}"> 					<label class="s-m-auth-btn-checkbox-icon s-m-auth-btn-block" id="{{this.id}}_lab" data-s-m-auth-value="{{this.value}}"> 							<i class="fa fa-square {{#if checked}}fa-check-square{{/if}}" style="margin-right:5px"></i>{{this.label}} 					</label> 				</div> 			{{/each}} 		</div>',authPanelPropertyInput:' 			<div class="form-group"> 				<input class="form-control" id="{{id}}" value="{{value}}" /> 			</div>',authPanelPropertyInputLocale:' 		<div class="form-group"> 			<input class="form-control" id="{{id}}" value="{{value}}" data-old-value="{{oldValue}}" data-old-uuid="{{oldUUID}}"/> 		</div>',authPanelSliderStep:' 		<div class="form-group"> 			<section style="padding-left:10px;padding-right:10px;">				<input id="{{id}}" type="text" data-slider-min="{{min}}" data-slider-max="{{max}}" data-slider-step="{{step}}"  data-slider-value="{{value}}" data-slider-orientation="horizontal" data-slider-tooltip="hide">				{{#if displayValue}}<span class="s-m-slider-value">{{#if valText}}{{valText}}{{/if}}{{#unless valText}}{{value}}{{/unless}}</span>{{/if}}			</section>		</div>',authPanelGaugeSlider:'		<div class="form-group s-m-auth-g-slider"> 			<section>				<input id="{{id}}" type="text" data-slider-min="{{min}}" data-slider-max="{{max}}" data-slider-step="{{step}}"  data-slider-value="{{value}}" data-slider-orientation="horizontal" data-slider-tooltip="hide" class="s-m-auth-g-range">				<span id="{{id}}SliderVal">{{value}}</span>			</section>		</div>	',authPanelPropertyCellSize:' 		<section>			<label class="s-m-auth-btn-checkbox-icon s-m-auth-btn-block">				<input type="checkbox">				{{sameSize}}			</label>			{{#each sizes}} 				<section class = "{{prop}}">					<label class="{{class}} auth-size-device-header" style="width: 100%">{{this.label}}</label> 					<div class="btn-group" data-toggle="buttons" style="width: 100%;"> 						{{#each ../values}} 							<div class="btn-group"> 								<label class="auth-btn-size-sel" id="{{this.id}}_lab" data-s-m-auth-prop="{{../this.prop}}" data-s-m-auth-value="{{this}}"> 									<input type="radio" name="{{group}}" id="{{../this.prop}}={{this}}">{{this}} 								</label> 							</div> 						{{/each}} 					</div> 				</section>			{{/each}}		</section>',authPanelPropertyJSON:' 			<div class="form-group"> 				<textarea class="form-control" id="{{id}}" rows="10">{{value}}</textarea> 				<div class="btn-group btn-group-justified" role="group">					<a class="btn btn-default" data-action="jsonApply">{{label_apply}}</a> 					<a class="btn btn-default" data-action="openInNewTab">{{label_display}}</a> 				</div>			</div><div style="clear: both;"></div>',authPanelPropertyPROTOTYPE:' 			<div class="form-group"> 				<textarea readonly class="form-control" id="{{id}}" rows="10">{{value}}</textarea> 				<div class="btn-group btn-group-justified" role="group">					<a class="btn btn-default" data-action="openInNewTab">{{label_display}}</a> 				</div>			</div>',authPanelPropertyGBorderValues:'		<div class="form-group">			<p class="s-m-auth-g-borders-tip">{{label_tip}}</p>			<label>{{label_min}}</label>			{{{markupMin}}}			<label>{{label_max}}</label>			{{{markupMax}}}			<button class="btn btn-default btn-block" style="margin-top:5%;">{{label_apply}}</button> 		</div>	',authPanelPropertyGSegmentsNumber:'		<div class="form-group">			{{{value}}} 			<button class="btn btn-default btn-block" style="margin-top:5%;">{{label_apply}}</button> 		</div>	',gaugeBorderInput:'		<textarea class="form-control" id={{id}} rows="1">{{value}}</textarea>	',gaugeSelect:'		<select id={{id}} style="color:black;" class="form-control">			{{#each options}}				<option value="{{option_value}}" {{#if selected}}selected=true{{/if}}>{{option_value}}</option>			{{/each}}		</select>	',gaugeSegment:'		<div id="{{id}}" class="s-m-auth-seg-slot">			<div class="s-m-g-seg-info-block">				<div class="s-m-g-seg-label">					<label>{{label_valstart}}</label>				</div>				<div class="s-m-g-seg-value">					<input type="text" class="form-control" value="{{value_valstart}}" id="{{id}}-valstart">				</div>			</div>			<div class="s-m-g-seg-info-block">				<div class="s-m-g-seg-label">					<label>{{label_valend}}</label>				</div>				<div class="s-m-g-seg-value">					<input type="text" class="form-control" value="{{value_valend}}" id="{{id}}-valend">				</div>			</div>			<div class="s-m-g-seg-info-block">				<div class="s-m-g-seg-label">					<label>{{label_propstart}}</label>				</div>				<div class="s-m-g-seg-value">					{{{value_propstart}}}				</div>			</div>			<div class="s-m-g-seg-info-block">				<div class="s-m-g-seg-label">					<label>{{label_propend}}</label>				</div>				<div class="s-m-g-seg-value">					{{{value_propend}}}				</div>			</div>			<div class="s-m-g-seg-info-block">				<div class="s-m-g-seg-label">					<label>{{label_color}}</label>				</div>				<div class="s-m-g-seg-value">					<input type="text" class="form-control" value="{{value_color}}" id="{{id}}-color">				</div>			</div>		</div>	',authPanelButton:'		<div class="s-m-auth-g-apply-slot">			<button class="btn btn-default btn-block {{css}}" style="margin-top:5%;">{{label}}</button> 		</div>	'},_compiled={};exports.execute=function(name,ctx){var c=_getCompiled(name);return c(ctx)}}),define("syracuse-tablet/html/js/authoring/authoringVal",["require","exports","module","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/ui/modals/modal"],function(require,exports,module){function getAuthoringPropertiesLayouts(){return _authProperties&&_authProperties.getPropertiesLayouts()}function _validate(fullPage,article,properties){var errors=[];try{_checkNode(fullPage,null,article,properties,errors)}catch(e){errors.push("javascriptException - validate\n"+jsutils.cleanStack(e.stack))}return errors}function _checkNode(fullPage,parent,node,properties,errors){Object.keys(_propertiesToCheck).some(function(key){node[key]!==undefined&&_propertiesToCheck[key](fullPage,parent,node,key,properties,errors)});var children;node.$items?children=node.$items:node.$article&&(children=[node.$article]),children&&children.forEach(function(child){_checkNode(fullPage,node,child,properties,errors)})}function _checkLayoutType(fullPage,parent,node,key,properties,errors){var type=node.$layoutType,ptype=parent&&parent.$layoutType,known=["stack","row","cell","hub","hubGroup","tile"];if(known.indexOf(type)<0){errors.push(locale.text("auth.err.unknown.layout",[type]));return}if(!fullPage)return;switch(type){case"hub":parent!=null&&errors.push(locale.text("auth.err.hub.notroot"));break;case"hubGroup":ptype!="hub"&&errors.push(locale.text("auth.err.hubgroup.nohub"));break;case"tile":ptype!="hubGroup"&&errors.push(locale.text("auth.err.tile.nohubgroup"))}}function _checkCellSize(fullPage,parent,node,key,properties,errors){var value=+node[key];value>=1&&value<=12||errors.push(locale.text("auth.err.cellSize",[key,value]))}function _checkTileSize(fullPage,parent,node,key,properties,errors){var value=node[key],valid=getAuthoringPropertiesLayouts().properties.tileSize.values.map(function(e){return e.value});valid.indexOf(value)<0&&errors.push(locale.text("auth.err.tileSize",[valid.join(", "),value]))}var locale=require("syracuse-tablet/html/js/helpers/locale"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),_authProperties;exports.setProperties=function(properties){_authProperties=properties},exports.validateJSON=function(fullPage,jsonText,properties){var obj;try{if($.isPlainObject(jsonText))obj=jsonText;else{if(!(jsonText!=null&&jsonText.length>0))throw new Error("Unexpected bad JSONtext");obj=JSON.parse(jsonText)}var errors=_validate(fullPage,obj,properties);if(!(errors.length>0))return obj;var text="\n"+errors.join("\n");modal.error(locale.text("auth.panel.save_error_title"),{message:locale.text("auth.panel.save_error_json"),detail:text})}catch(e){modal.error(locale.text("auth.panel.save_error_title"),{message:locale.text("auth.panel.save_error_json"),detail:e})}},exports.toSortedJSON=function(obj){var toJSON=function(){var self=this,that={},$items,$article;return Object.keys(self).forEach(function(key){self.hasOwnProperty(key)&&(key==="$items"?$items=self[key]:key==="$article"?$article=self[key]:key!=="toJSON"&&(that[key]=self[key]))}),$article&&(that.$article=$article),$items&&(that.$items=$items),self.toJSON&&delete self.toJSON,that.toJSON&&delete that.toJSON,that};JSON.stringify(obj,function replacer(key,value){return $.isPlainObject(value)&&(value.toJSON=toJSON),value});var str=JSON.stringify(obj,null," ");return str};var _propertiesToCheck={$layoutType:_checkLayoutType,$size:_checkTileSize,$widthXs:_checkCellSize,$widthSm:_checkCellSize,$widthMd:_checkCellSize,$widthLg:_checkCellSize}}),define("syracuse-tablet/html/js/authoring/authoringComponents",["require","exports","module","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),locale=require("syracuse-tablet/html/js/helpers/locale"),_templates={genericSlider:'		<div class="form-group" {{#if margin}}style="margin-bottom:{{margin}}px;"{{/if}}> 			<section style="padding-left:10px;padding-right:10px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis">				<input id="{{id}}" type="text" data-slider-min="{{min}}" data-slider-max="{{max}}" data-slider-step="{{step}}"  data-slider-value="{{value}}" data-slider-orientation="horizontal" data-slider-tooltip="hide">				{{#if displayValue}}<p class="s-m-slider-value">{{#if valText}}{{valText}}{{/if}}{{#unless valText}}{{value}}{{/unless}}</p>{{/if}}			</section>		</div>',flatRadio:'		<div class="btn-group" style="margin-bottom:10px;" data-toggle="buttons">			{{#each btns}}				<label class="btn btn-primary">					<input type="radio" autocomplete="off" value="{{value}}">					{{title}}				</label>			{{/each}}		</div>',select:'		<div style="position:relative;{{#if margin}}margin-bottom:{{margin}}px;{{/if}}">		  <select class="selectpicker {{css}}"  data-width="100%" {{#if dataSize}}data-size="{{dataSize}}"{{/if}}>		  	{{#each options}}		     	<option value="{{value}}">{{title}}</option>			{{/each}}		  </select>		</div>',actionBtns:'		<div style="text-align:center;">			<div class="btn-group" role="group" style="margin-bottom:10px;">				{{#each btns}}					<button type="button" class="btn btn-default" value="{{value}}">{{title}}</button>				{{/each}}			</div>		</div>',colorPicker:'		<input type="text" {{#if id}}id="{{id}}"{{/if}} class="form-control {{css}}""></input>',editableList:'		<section class = "auth-editableList  {{css}}" {{#if id}}id="{{id}}"{{/if}} >			<ul class="list-group auth-editableList"></ul>			<div class="authMsg"></div>			<div class="btn-group btn-group-justified" role="group">				<a type="button" class="btn btn-default authLstAct" data-action="append">					<i class="fa fa-plus"></i>					<span>{{addTitle}}</span>				</a>				<a style="display:none" type="button" class="btn btn-default authLstAct" data-action="validate">					<i class="fa fa-check"></i>					<span>{{validateTitle}}</span>				</a>				<a style="display:none" type="button" class="btn btn-default authLstAct" data-action="cancel">					<i class="fa fa-times"></i>					<span>{{cancelTitle}}</span>				</a>			</div>		</section>',editableListItem:'		<li class="list-group-item {{css}}" data-params="{{id}}">			<span>				<span>{{#if title}}{{title}}{{/if}}{{#if titleHtml}}{{{titleHtml}}}{{/if}}</span>				<span class="fa fa-pencil" data-action="editItem"></span>				<span class="fa fa-times" data-action="deleteItem"></span>			</span>		</li>',colorPalettePicker:'		<section class="auth-colorPalettePicker {{dropDirection}}">			<div class="input-group" data-toggle="dropdown" aria-expanded="false">				<span class="form-control auth-paletteColor"></span>				<span class="input-group-addon"><div class="fa fa-times"></div></span>			</div>			<div class="dropdown-menu" style="width: 100%;width: 100%;padding-left: 5px;padding-right: 5px;">				<div class="auth-paletteRoot" data-toggle="buttons" style="width: 100%;white-space: normal;" >				</div>		  	</div>		</section>',colorPaletteItem:'		<div class="auth-paletteItem {{css}}" data-id="{{id}}" data-name="{{name}}" data-css="{{css}}">		</div>',iconPalettePicker:'		<section class="auth-iconPalettePicker {{dropDirection}}">			<div class="input-group" data-toggle="dropdown" aria-expanded="false">				<span class="form-control auth-paletteIcon"></span>				<span class="input-group-addon"><div class="fa fa-times"></div></span>			</div>			<div class="dropdown-menu">				<div class="auth-paletteRoot" data-toggle="buttons" style="width: 100%;white-space: normal;" >				</div>		  	</div>		</section>',iconPaletteItem:'		<div class="auth-paletteItem {{css}}" data-params="{{name}}" data-css="{{css}}">		</div>',switcher:'		 <input {{#if id}}id="{{id}}"{{/if}} type="checkbox">',checkboxList:' 		<section class="auth-checkboxList {{css}}" {{#if id}}id="{{id}}"{{/if}}/>',checkboxListContent:' 		<div class="btn-group s-m-list">			{{#each list}} 				<div class="s-m-item btn-group" data-id = "{{id}}"> 					<label> 						<input type="checkbox" {{#if checked}}checked{{/if}}>{{label}} 					</label> 				</div> 			{{/each}}		</div>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[name],tmpl=_templates[key]=Handlebars.compile(tmpl)),tmpl(ctx)},_components={editableList:function(options,name){options=options||{},this.options=options,this.name=name||"editableList",this.createMarkup=function($$parent){return this.$$panel=$(_getHtml("editableList",{id:options.id,css:options.css||"",addTitle:options.appendTitle||locale.text("append"),validateTitle:options.validateTitle||locale.text("validate"),cancelTitle:options.cancelTitle||locale.text("cancel")})).appendTo($$parent),options.isHidden===!0&&this.hide(),this.options.doAction&&this.$$panel.on("click","[data-action]",jsutils.bindFn(this.onClick,this)),this.$$list=this.$$panel.find("ul"),this.$$panel},this.onClick=function(event){var $$target=$(event.target).closest("[data-action]"),action=$$target.attr("data-action"),id;action==="append"||action==="cancel"?id="":action==="editItem"||action==="deleteItem"?id=$$target.closest("[data-params]").attr("data-params")||"":action==="validate"&&(id=$$target.attr("data-params")||"");var done=this.options.doAction(action,id,this);done==1&&(action==="deleteItem"?$$target.closest("li").off().remove():action==="editItem"||action==="append"?this.toggleEditStatus(!0,id):(action==="validate"||action==="cancel")&&this.toggleEditStatus(!1))},this.insertRecords=function(records){if(!records||!this.$$list)return;$.isPlainObject(records)&&(records=[records]);if(!Array.isArray(records))return;var self=this;records.forEach(function(record){if(!record||!record.id)return;var $$newRec=$(_getHtml("editableListItem",{id:record.id,css:record.css||"",titleHtml:record.titleHtml,title:record.title})),$$oldRec=self.$$list.find('[data-params="'+record.id+'"]');$$oldRec.length>0?($$oldRec.before($$newRec),$$oldRec.remove()):$$newRec.appendTo(self.$$list)})},this.destroyMarkup=function(){this.options=null,this.$$list&&(this.$$list.off(),this.$$list=null),this.$$panel=null},this.clear=function(){if(!this.$$list)return;this.$$list.find("li").remove()},this.toggleEditStatus=function(editMode,recordId){if(!this.$$panel)return;this.$$panel.find('[data-action="append"]').toggle(editMode!==!0),this.$$panel.find('[data-action="validate"]').toggle(editMode===!0).attr("data-params",editMode===!0?recordId:""),this.$$panel.find('[data-action="cancel"]').toggle(editMode===!0)},this.disableAppendBtn=function(disabled){this.$$panel.find('[data-action="append"]').attr("disabled",disabled===!0)},this.toggleMessage=function(msgText,type){if(!this.$$panel)return;var $$msg=this.$$panel.find(".authMsg");$$msg.empty().removeClass(),msgText&&msgText.trim().length>0&&($$msg.text(msgText),type&&$$msg.addClass("s-m-"+type)),$$msg.addClass("authMsg")}},colorPicker:function(options,name){options=options||{},this.options=options,this.name=name||"colorPicker",this.createMarkup=function($$parent){return this.$$picker=$(_getHtml("colorPicker",{id:options.id,css:options.css||""})).appendTo($$parent),options.isHidden===!0&&this.$$picker.hide(),this.$$picker.minicolors({control:options.control||"hue",defaultValue:options.value||"",inline:options.inline===!0,letterCase:options.letterCase||"lowercase",opacity:options.opacity===!0,position:options.position||"top left",theme:"bootstrap",change:options.onChange?jsutils.bindFn(this.onChange,this):null}),this.$$panel=this.$$picker,this.$$panel},this.onChange=function(event){this.options.onChange(event,this)},this.destroyMarkup=function(){this.options.onChange=null,this.options=null,this.$$picker&&(this.$$picker.minicolors("destroy"),this.$$picker=null)},this.getValue=function(type){if(!this.$$picker)return;var meth;return type==="rgbObject"||type==="rgbString"||type==="rgbaString"?meth=type:meth="value",this.$$picker.minicolors(meth)},this.setValue=function(valueHexa){if(!this.$$picker)return;return this.$$picker.minicolors("value",valueHexa)}},colorPalettePicker:function(options,name){options=options||{},this.options=options,this.name=name||"colorPalettePicker",this.createMarkup=function($$parent){var css=options.css||"";return this.$$panel=$(_getHtml("colorPalettePicker",{id:options.id,css:css,dropDirection:options.dropUp===!0?"dropup":"dropdown"})).appendTo($$parent),this.$$rootPalette=this.$$panel.find(".auth-paletteRoot"),this.$$input=this.$$panel.find(".auth-paletteColor"),this.$$clearBtn=this.$$panel.find(".input-group-addon").on("click",jsutils.bindFn(this.onClear,this)),this.$$rootPalette.on("click","[data-id]",jsutils.bindFn(this.onSelectColor,this)),options.isHidden===!0&&this.$$panel.hide(),options.palette&&this.updatePalette(options.palette),this.setValue(options.color),this.$$panel},this.updatePalette=function(palette){if(!palette)return;var html=[];palette.forEach(function(item){item.items?(item.title&&html.push('<div class ="authPaletteSection">'+item.title+"</div>"),item.items.forEach(function(subItem){subItem.name=subItem.name||subItem.id,html.push(_getHtml("colorPaletteItem",subItem))})):html.push(_getHtml("colorPaletteItem",item))}),this.$$rootPalette.html(html.join(""))},this.onClear=function(event){this.$$panel.is(".open")||(event.stopPropagation(),this.setValue(null),this.options.onSelectColor&&this.options.onSelectColor(null))},this.onSelectColor=function(event){var $$t=$(event.target),value={id:$$t.attr("data-id")||"",name:$$t.attr("data-name")||"",css:$$t.attr("data-css"),bgColor:$$t.css("background-color"),color:$$t.css("color"),hex:this.getHexColor($$t.css("background-color"))};this.setValue(value),this.options.onSelectColor&&this.options.onSelectColor(value)},this.destroyMarkup=function(){this.$$rootPalette&&(this.$$rootPalette.off(),this.$$rootPalette=null),this.options=null,this.$$clearBtn.off(),this.$$clearBtn=this.$$input=this.$$panel=null},this.getValue=function(){var $$selected=this.$$panel.find(".auth-paletteItem.current");return $$selected.length==0?null:{css:$$selected.attr("data-css")||"",name:$$selected.attr("data-name")||"",id:$$selected.attr("data-id")||"",bgColor:$$selected.css("background-color"),color:$$selected.css("color"),hex:this.getHexColor($$selected.css("background-color"))}},this.setValue=function(color){this.$$panel.find(".auth-paletteItem.current").removeClass("current"),color&&this.$$panel.find('[data-id="'+color.id+'"]').addClass("current"),this.$$input.removeClass().addClass("form-control").text(color?color.name:locale.text("auth.components.palette.nocolor")),color&&this.$$input.addClass(color.css)},this.getHexColor=function(color){var value="#",toHex=function(n){return n=parseInt(n,10),("00"+n.toString(16)).slice(-2)};return/^rgb\(.*\)$/.test(color)?(color.match(/([0-9]+)/g).forEach(function(val){value+=toHex(val)}),value):null}},iconPalettePicker:function(options,name){options=options||{},this.options=options,this.name=name||"iconPalettePicker",this.createMarkup=function($$parent){var css=options.css||"";return this.$$panel=$(_getHtml("iconPalettePicker",{id:options.id,css:css,dropDirection:options.dropUp===!0?"dropup":"dropdown"})).appendTo($$parent),this.$$rootPalette=this.$$panel.find(".auth-paletteRoot"),this.$$input=this.$$panel.find(".auth-paletteIcon"),this.$$clearBtn=this.$$panel.find(".input-group-addon").on("click",jsutils.bindFn(this.onClear,this)),this.$$rootPalette.on("click","[data-params]",jsutils.bindFn(this.onSelectIcon,this)),options.isHidden===!0&&this.$$panel.hide(),options.palette&&this.updatePalette(options.palette),this.setValue(options.icon),this.$$panel},this.updatePalette=function(palette){if(!palette)return;var html=[];palette.forEach(function(item){html.push(_getHtml("iconPaletteItem",item))}),this.$$rootPalette.html(html.join(""))},this.onClear=function(event){this.$$panel.is(".open")||(event.stopPropagation(),this.setValue(null))},this.onSelectIcon=function(event){var $$t=$(event.target),old=this.getValue(),value={name:$$t.attr("data-params"),css:$$t.attr("data-css")};if(old&&old.name==value.name&&old.css==value.css)return;this.setValue(value),this.options.onSelectIcon&&this.options.onSelectIcon(value)},this.destroyMarkup=function(){this.$$rootPalette&&(this.$$rootPalette.off(),this.$$rootPalette=null),this.options=null,this.$$clearBtn.off(),this.$$clearBtn=this.$$input=this.$$panel=null},this.getValue=function(){var $$selected=this.$$panel.find(".auth-paletteItem.current");return $$selected.length==0?null:{css:$$selected.attr("data-css")||"",name:$$selected.attr("data-params")||""}},this.setValue=function(icon){this.$$panel.find(".auth-paletteItem.current").removeClass("current"),icon&&this.$$panel.find('[data-params="'+icon.name+'"]').addClass("current"),this.$$input.removeClass().addClass("form-control").empty(),icon?this.$$input.html('<div class="iconIcon '+icon.css+'"></div><div class="iconName">'+icon.name+"</div>"):this.$$input.text(locale.text("auth.components.palette.noicon"))}},select:function(options,name){options=options||{};if(!options.onChange)throw new Error("select component - onChange is mandatory");options.options=options.options||[],options.value==null&&(options.value=Object.keys(options.options)[0]),this.name=name||"select",this.options=options;var optselect={options:options.options||[],css:options.css||""};options.dataSize&&(optselect.dataSize=options.dataSize),this.createMarkup=function($$parent){return this.$$panel=$(_getHtml("select",optselect)).appendTo($$parent),this.$$select=this.$$panel.find("select"),this.$$select.selectpicker(),this.$$select.selectpicker("val",options.value),this.$$select.on("change",jsutils.bindFn(this.onChange,this)),options.isHidden===!0&&this.$$select.selectpicker("hide"),this.$$panel},this.onChange=function(event){this.options.onChange(event,this)},this.destroyMarkup=function(){this.options.onChange=null,this.options=null,this.$$select&&(this.$$select.off(),this.$$select.selectpicker("destroy"),this.$$select=null)},this.getValue=function(){if(!this.$$select)return;return this.$$select.selectpicker("val")},this.setValue=function(value){if(!this.$$select)return;return this.$$select.selectpicker("val",value)},this.update=function(selectOpts,defValue){if(!this.$$select)return;selectOpts=selectOpts||[],this.$$select.find("option").remove();var self=this;selectOpts.forEach(function(v,idx){self.$$select.append('<option value="'+v.value+'">'+v.title+"</option>")}),defValue==null&&selectOpts.length>0&&(defValue=selectOpts[0].value),defValue!=null&&this.$$select.selectpicker("val",defValue),this.$$select.selectpicker("refresh")},this.clear=function(){this.update(null)}},flatRadio:function(options,name){this.name=name||"flatRadio",this.options=options,this.createMarkup=function($$parent){return this.$$panel=$(_getHtml("flatRadio",{btns:this.options.btns})).appendTo($$parent).on("change","input",this.options.onClick),this.$$panel.find('input[value="'+this.options.value+'"]').parent().button("toggle"),this.$$panel},this.destroyMarkup=function(){this.options.onClick=null,this.options=null,this.$$panel&&(this.$$panel.off(),this.$$panel=null)}},switcher:function(options,name){this.name=name||"switcher",this.options=options,this.createMarkup=function($$parent){return this.$$panel=$(_getHtml("switcher",{id:this.options.id})).appendTo($$parent),this.setValue(this.options.checked),this.$$panel.bootstrapSwitch("onText",this.options.onText||locale.text("auth.switcher.onText")),this.$$panel.bootstrapSwitch("offText",this.options.offText||locale.text("auth.switcher.offText")),this.$$panel.bootstrapSwitch("size",this.options.size||"small"),this.$$panel.bootstrapSwitch("onColor",this.options.onColor||"default"),this.$$panel.bootstrapSwitch("offColor",this.options.offColor||"default"),this.options.onSwitchChange&&this.$$panel.bootstrapSwitch("onSwitchChange",jsutils.bindFn(this.onSwitchChange,this)),this.$$panel},this.onSwitchChange=function(event,state){this.options.onSwitchChange(event,state)},this.destroyMarkup=function(){this.options=null,this.$$panel&&(this.$$panel.bootstrapSwitch("destroy"),this.$$panel=null)},this.getValue=function(value){if(!this.$$panel)return;return this.$$panel.bootstrapSwitch("state")},this.setValue=function(value){if(!this.$$panel)return;this.$$panel.bootstrapSwitch("state",value===!0,!0)}},actionBtns:function(options,name){this.name=name||"actionBtns",this.options=options,this.createMarkup=function($$parent){return this.$$panel=$(_getHtml("actionBtns",{btns:this.options.btns})).on("click",this.options.onClick).appendTo($$parent),this.$$panel},this.destroyMarkup=function(){this.options.onClick=null,this.options=null,this.$$panel&&(this.$$panel.off(),this.$$panel=null)}},genericSlider:function(options,name){this.name=name||"genericSlider",this.options=options,this.label=options.label,this.createMarkup=function($$parent){var displayValue=this.options.displayValue||this.options.slideHandler!=null;this.$$panel=$(_getHtml("genericSlider",{value:this.options.value,min:this.options.min,max:this.options.max,step:this.options.step||1,valText:this.options.value!=null?this.options.slideHandler?this.options.slideHandler(this.options.value,this):this.options.value:"",displayValue:displayValue,margin:this.options.margin+""})),$$parent.append(this.$$panel),this.$$textValue=$(".s-m-slider-value",this.$$panel),this.$$slider=$("input",this.$$panel).slider({}),displayValue&&this.$$slider.on("slide",jsutils.bindFn(this.onSlider,this,"slide")),this.options.stopHandler&&this.$$slider.on("slideStop",jsutils.bindFn(this.onSlider,this,"stop")),this.options.startHandler&&this.$$slider.on("slideStart",jsutils.bindFn(this.onSlider,this,"start")),displayValue==="above"&&this.$$panel.find(".s-m-slider-value").detach().prependTo(this.$$panel.find("section"))},this.destroyMarkup=function(){this.options.startHandler=null,this.options.stopHandler=null,this.options.slideHandler=null,this.options=null,this.$$slider&&(this.$$slider.off(),this.$$slider.slider("destroy"),this.$$slider=null),this.$$panel&&this.$$panel.remove()},this.onSlider=function(slideEvt,action){if(action==="start"){this.options.startHandler(slideEvt.value,this);return}if(action==="slide"){this.$$textValue.text(this.options.slideHandler?this.options.slideHandler(slideEvt.value,this):slideEvt.value);return}if(action==="stop"){this.options.value!=slideEvt.value&&(this.options.value=slideEvt.value,this.options.stopHandler(slideEvt.value,this));return}},this.update=function(opts){if(!opts)return;opts.min!=null&&this.$$slider.slider("setAttribute","min",opts.min),opts.max!=null&&this.$$slider.slider("setAttribute","max",opts.max),opts.step!=null&&this.$$slider.slider("setAttribute","step",opts.step),opts.value!=null&&(this.$$slider.slider("setValue",opts.value),this.$$textValue.text(this.options.slideHandler?this.options.slideHandler(opts.value):opts.value))}},checkboxList:function(options,name){options=options||{},this.options=options,this.name=name||"checkboxList",this.createMarkup=function($$parent){return this.$$panel=$(_getHtml("checkboxList",{id:options.id,css:options.css||""})).appendTo($$parent),options.isHidden===!0&&this.hide(),this.options.onClick&&this.$$panel.on("click",'input[type="checkbox"]',jsutils.bindFn(this.onClick,this)),this._createList(options.list),this.$$panel},this.destroyMarkup=function(){this.$$panel&&(this.$$panel.find('input[type="checkbox"]').off(),this.$$panel.off(),this.$$panel=null),this.options=null},this.onClick=function(evt){var $$input=$(evt.target);this.options.onClick($$input.closest(".s-m-item").attr("data-id"),$$input.is(":checked"))},this.getValue=function(format){if(!this._$$list)return null;var obj=format!=="array",res=obj?{}:[];return this._$$list.find(".s-m-item").each(function(){var $$this=$(this);if(!$$this.is(":visible"))return;var checked=$$this.find("input:checkbox").prop("checked")===!0,id=$$this.attr("data-id");obj?res[id]=checked:res.push({checked:checked,id:id})}),res},this.setValue=function(list){this.updateValue(list)},this.reset=function(){this.updateValue(null)},this.updateValue=function(list){if(!this.$$panel)return;var self=this;self._$$list.find("[data-id]").each(function(){$(this).val(!1)}),list=this._checkInputList(list);if(list.length===0)return;list.forEach(function(itm){if(!itm||!itm.id)return;var $$item=self._$$list.find('[data-id="'+itm.id+'"]');if($$item.length===0)return;itm.isHidden===!0&&$$item.hide();if(itm.checked!==!0)return;$$item.attr("data-id",itm.id),$$item.find("input:checkbox").prop("checked",itm.checked===!0),$$item.find("label").text(itm.label)})},this._createList=function(list){if(!this.$$panel)return;this._$$list&&this._$$list.remove(),list=this._checkInputList(list);var newList=[];list.forEach(function(itm){itm.id&&(itm.id=itm.id,itm.checked=itm.checked===!0,itm.label=itm.label||itm.id,newList.push(itm))}),this._$$list=$(_getHtml("checkboxListContent",{list:newList})).appendTo(this.$$panel)},this._arrayToPlainobject=function(){},this._checkInputList=function(list){if(!list)return[];if(Array.isArray(list))return list;if(!$.isPlainObject(list))return[];var res=[];for(var p in list)res.push({id:p,checked:list[p]===!0});return res}}};exports.newComponent=function(type,opts,name){var f=_components[type];if(!f)throw new Error("Unknown authoring component ["+type+"]");return new f(opts,name)}}),define("syracuse-tablet/html/js/ui/modals/modalTranslationPage",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/modals/modalDialog"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),_templateAll={header:'		<buttons class="pull-right"> 			<button type="button" class="btn btn-default s-m-modal-btn-validate" data-action="$validate"></button> 			<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 		</buttons> 		<div class="modal-title">{{title}}</div> 			',content:' 			<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">				<div class="form-group"> 					<table class="s-m-translation" >					<tr>					<th>{{currentLang.title}}</th><th>{{translateLang.title}}</th>					</tr>					{{#each localizations}}					<tr>					<td>{{this.value}}</td><td><input type="text" id="{{this.key}}" value="{{this.valueTranslate}}"></td>					</tr>					{{/each}}					</table>				</div> 			</div>',footer:""},_Klass=utils.defineClass(function ModalTranslationPage(ctx){this.context=$.extend(!0,{},ctx),modalDialog.ModalBase.call(this),this.result=null},modalDialog.ModalBase,{_getTemplates:function(){return{std:_templateAll}},_getDataContext:function(){var localizations=[],$localization=this.context.$localization,currentLang=this.context.currentLang,translateLang=this.context.translateLang;if(!$localization[currentLang.value])return[];Object.keys($localization[currentLang.value]).forEach(function(key){$localization[currentLang.value][key]&&localizations.push({key:key,value:$localization[currentLang.value][key],valueTranslate:$localization[translateLang.value]&&$localization[translateLang.value][key]?$localization[translateLang.value][key]:""})});var data={};return data.localizations=localizations,data.currentLang=currentLang,data.translateLang=translateLang,data.title=this.context.pageTitle,data},_onShow:function(){modalDialog.ModalBase.prototype._onShow.call(this)},_onValidate:function(){var currentLang=this.context.currentLang.value,translateLang=this.context.translateLang.value,localization=this.context.$localization,value,res;Object.keys(localization[currentLang]).forEach(function(key){value=$("input[id='"+key+"'").val(),localization[translateLang]&&localization[translateLang][key]!==""&&(res||(res={}),res[key]=localization[translateLang][key]);if(!localization[translateLang]&&value!==""||localization[translateLang]&&(localization[translateLang][key]&&value!=localization[translateLang][key]||!localization[translateLang][key]&&value))res||(res={}),res[key]=value}),res&&(localization[translateLang]=res,this.result=localization)},_onCancel:function(){this.result=null},_getResult:function(){return this.result}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral",["require","exports","module","syracuse-tablet/html/js/authoring/authoringHtml","syracuse-tablet/html/js/authoring/authoringVal","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/ui/modals/modal","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/authoring/authoringComponents","syracuse-tablet/html/js/sdata/sdataCommonResources","syracuse-tablet/html/js/ui/modals/modalTranslationPage"],function(require,exports,module){function _createMarkupJSON($$parent,prop,sel,data){var value=authVal.toSortedJSON(data.articlePage),html=authHtml.execute("authPanelPropertyJSON",{id:"auth_opt_"+prop.name,value:value,label_apply:locale.text("auth.panel.label_apply"),label_display:locale.text("auth.panel.label_display")}),$$panel=$(html),title=sel.$$elmt.text(),_getJson=function(validate){var val=$("textarea",$$panel).val(),articleParsed;if(validate)articleParsed=authVal.validateJSON(!0,$("textarea",$$panel).val(),_properties);else try{articleParsed=JSON.parse(val)}catch(e){return jsutils.convertToDiagnoses(e)}return articleParsed?authVal.toSortedJSON(articleParsed):null};$("a[data-action]",$$panel).click(function(){var act=$(this).attr("data-action");try{if(act==="jsonApply"){var articleString=_getJson(!0);articleString&&notifications.publish(["sm.auth.change.prop.ui"],articleString)}else if(act==="openInNewTab"){var title=globals.getApplication().currentPage.prototype;title&&(title=title.data("$title")),title=title&&title.length>0?locale.text("auth.panel.label_page")+": "+title:"",_openInNewTab("sageMobileJsonAuthoring",_getJson(!1),title)}}catch(e){throw console.log(e.stack),e}}),$$parent.append($$panel)}function _createMarkupPrototype($$parent,prop,sel,data){var json,isPage=sel.$$elmt&&sel.$$elmt.is(".s-m-page"),title;if(data.control)json=data.control.prototype&&data.control.prototype.json,title=data.control.$bind||data.control.id;else if(isPage){var controller=sel.$$elmt.smPageController();controller&&(title=controller.prototype.data("$title"),json=controller.prototype&&controller.prototype.json)}var value;json?value=JSON.stringify(json,null," "):value=locale.text("auth.PROTOTYPE_NONE");var html=authHtml.execute("authPanelPropertyPROTOTYPE",{id:"auth_opt_"+prop.name,value:value,label_display:locale.text("auth.panel.label_display")}),$$panel=$(html);$$parent.append($$panel),json&&!$.isEmptyObject(json)&&$("a[data-action]",$$panel).click(function(){var act=$(this).attr("data-action");act==="openInNewTab"&&(title=locale.text("auth.panel.label_"+(isPage?"page":"control"))+": "+title,_openInNewTab("sageMobilePrototype",authVal.toSortedJSON(json),title))})}function getLangDescription(lang,langList){var desc;return langList.forEach(function(v){v.value===lang&&(desc=v.title)}),desc}function _getValueOrDefault(prop,sel,data){var value=data.articleSelection&&data.articleSelection[prop.key];return value=value!=null?value:prop["default"],value}function _setValue(prop,sel,data,value){data.articleSelection[prop.key]=value,data.articleSelection.$isDirty=data.articleSelection.$isDirty||{},data.articleSelection.$isDirty[prop.key]=!0}function _notifyChangePropUI($$parent,sel,data){var $$json=$("textarea#auth_opt_JSON");$$json.val(authVal.toSortedJSON(data.articleSelection)),notifications.publish(["sm.auth.change.item.prop.ui"],data)}function _notifyAuthVariantChange(article){var articleString=authVal.toSortedJSON(article);$("textarea#auth_opt_JSON").val(articleString),notifications.publish(["sm.auth.change.prop.ui"],articleString)}function _createMarkupRadio($$parent,prop,sel,data){var ctx={group:"auth_opt_"+prop.name,options:[]},value=_getValueOrDefault(prop,sel,data),allHidden=!0;prop.values.forEach(function(v){ctx.options.push({id:ctx.group+"_"+v.value,value:""+v.value,label:v.label,display:v.isHidden?"none":"block"}),allHidden=allHidden&&v.isHidden});var html=authHtml.execute("authPanelPropertyRadio",ctx),$$panel=$(html);$("label[data-s-m-auth-value='"+(""+value)+"']",$$panel).eq(0).button("toggle"),$("label",$$panel).on("click",function(e){var $$ct=$(e.currentTarget).closest("[data-s-m-auth-value]"),value=$$ct.attr("data-s-m-auth-value");$$ct.eq(0).button("toggle"),value==="true"?value=!0:value==="false"&&(value=!1),_setValue(prop,sel,data,value),_notifyChangePropUI($$parent,sel,data)}),$$parent.append($$panel),allHidden?$$parent.parent(".s-m-panel-auth-prop").hide():$$parent.parent(".s-m-panel-auth-prop").show()}function _refreshMarkupRadio($$parent,prop,sel,data){var allHidden=!0;prop.values.forEach(function(v){var id="auth_opt_"+prop.name+"_"+v.value,$$btn=$("#"+id,$$parent),display=v.isHidden?"none":"block";$$btn.css("display",display),allHidden=allHidden&&v.isHidden}),allHidden?$$parent.parent(".s-m-panel-auth-prop").hide():$$parent.parent(".s-m-panel-auth-prop").show()}function _createMarkupCheckboxes($$parent,prop,sel,data){var ctx={group:"auth_opt_"+prop.name,options:[]},allHidden=!0,value=data.articleSelection&&data.articleSelection[prop.key]||{};prop.values.forEach(function(v){var cb=value[v.key]!=null?value[v.key]:v["default"];ctx.options.push({id:ctx.group+"_"+v.key,value:v.key,label:v.label,checked:cb,display:v.isHidden?"none":"block"}),allHidden=allHidden&&v.isHidden});var html=authHtml.execute("authPanelPropertyCheckbox",ctx),$$panel=$(html);$("label",$$panel).on("click",function(e){var $$ct=$(e.target).closest("[data-s-m-auth-value]"),key=$$ct.attr("data-s-m-auth-value"),$$cb=$("i",$$ct),value=$("i",$$ct).toggleClass("fa-check-square").is(".fa-check-square"),v=data.articleSelection[prop.key]=data.articleSelection[prop.key]||{};v[key]=value,_notifyChangePropUI($$parent,sel,data)}),$$parent.append($$panel),allHidden?$$parent.parent(".s-m-panel-auth-prop").hide():$$parent.parent(".s-m-panel-auth-prop").show()}function _refreshMarkupCheckboxes($$parent,prop,sel,data){var allHidden=!0;prop.values.forEach(function(v){var id="auth_opt_"+prop.name+"_"+v.key,$$btn=$("#"+id,$$parent),display=v.isHidden?"none":"block";$$btn.css("display",display),allHidden=allHidden&&v.isHidden}),allHidden?$$parent.parent(".s-m-panel-auth-prop").hide():$$parent.parent(".s-m-panel-auth-prop").show()}function _createMarkupIconPicker($$parent,prop,sel,data){var value=data.articleSelection&&data.articleSelection[prop.key]||null,opts={palette:prop.values||[],dropUp:prop.dropUp||!0,onSelectIcon:function(value){_setValue(prop,sel,data,value),_notifyChangePropUI($$parent,sel,data)}};prop._paletteIcon=authComponents.newComponent("iconPalettePicker",opts),prop._paletteIcon.createMarkup($$parent),prop._paletteIcon.setValue(data.articleSelection[prop.key]||prop["default"])}function _destroyMarkupIconPicker($$parent,prop,sel,data){prop._paletteIcon&&(prop._paletteIcon.destroyMarkup(),prop._paletteIcon=null)}var authHtml=require("syracuse-tablet/html/js/authoring/authoringHtml"),authVal=require("syracuse-tablet/html/js/authoring/authoringVal"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),locale=require("syracuse-tablet/html/js/helpers/locale"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),globals=require("syracuse-tablet/html/js/helpers/globals"),authComponents=require("syracuse-tablet/html/js/authoring/authoringComponents"),sdataCommonResources=require("syracuse-tablet/html/js/sdata/sdataCommonResources"),modalTranslationPage=require("syracuse-tablet/html/js/ui/modals/modalTranslationPage"),_colorPalette=[{title:"primecolor",items:["sagegreen","green","blue","darkgrey","white","black"]},{title:"secondcolor",items:["lightgreen","grey","medium-grey","orange","purple","medium-purple","skyblue"]},{title:"notifcolors",items:["alert","warning"]}],_cachePalette={},_getColorPalette=function(){if(_cachePalette.colorPalette)return _cachePalette.colorPalette;_cachePalette.colorPalette=[];var _scan=function(items,array){return array=array||[],items.forEach(function(item){if(item.items){var items=_scan(item.items);array.push({title:item.title?locale.text("colorsPalette."+item.title):null,items:items})}else if(typeof item=="string"){var id=item.toLowerCase();array.push({id:id,name:locale.textNoFail("colorsPalette.colors."+id)||item.smCapitalize(),css:"s-m-color-"+id})}}),array};return _scan(_colorPalette,_cachePalette.colorPalette)},_getColorValues=function(){if(_cachePalette.colorValues)return _cachePalette.colorValues;_cachePalette.colorValues=[];var _scan=function(items){items.forEach(function(item){item.items?_scan(item.items):typeof item=="string"&&_cachePalette.colorValues.push({value:item.toLowerCase(),label:locale.textNoFail("colorsPalette.colors."+item)||item.smCapitalize()})})};return _scan(_colorPalette),_cachePalette.colorValues},_getColorInfo=function(id){return _cachePalette.colorInfos?_cachePalette.colorInfos[id]:(_cachePalette.colorInfos={},_getColorValues().forEach(function(color){_cachePalette.colorInfos[color.value]={id:color.value,name:color.label,css:"s-m-color-"+color.value}}),_cachePalette.colorInfos[id])},_openInNewTab=function(tabid,jsonString,title){if(!jsonString||jsonString.trim().length===0)return;var myWindow=window.open("about:blank",tabid,undefined,!0);setTimeout(function(){myWindow.document.write("<html><body><pre>"+(title?title+"\n":"")+locale.text("auth.panel.label_date")+": "+(new Date).toLocaleString()+"</pre><pre>"+jsonString+"</pre></body></html>")})},_properties={SEPARATOR:{isSeparatror:!0},JSON:{key:"$JSON",createMarkup:_createMarkupJSON,type:"expert"},PROTOTYPE:{key:"$PROTOYPE",createMarkup:_createMarkupPrototype,type:"expert"},translation:function(controller,sel,data){if(!data.articleSelection.$localization||$.isEmptyObject(data.articleSelection.$localization[globals.getUserCtx().$lang]))return null;this.name="translation",this.type="expert",this.createMarkup=function($$parent,prop,sel,data){var self=this;sdataCommonResources.queryLocalePreferences().then(function(ls){var selectOpts=[];ls.forEach(function(v){selectOpts.push({title:v.description,value:v.code})});var opts={options:selectOpts,onChange:self.onChange.bind(self,$$parent,data)};self.langList=authComponents.newComponent("select",opts,"selectLang"),self.langList.createMarkup($$parent)})},this.onChange=function($$parent,data,event,componentSelect){var context={};context.$localization=data.articleSelection.$localization,context.currentLang={value:globals.getUserCtx().$lang,title:getLangDescription(globals.getUserCtx().$lang,componentSelect.options.options)},context.translateLang={value:componentSelect.getValue(),title:getLangDescription(componentSelect.getValue(),componentSelect.options.options)},this.buildPanel($$parent,data,context)},this.buildPanel=function($$parent,data,context){if(this.$$panel==undefined){var html=authHtml.execute("authPanelButton",{label:locale.text("auth.translation.openPage"),css:"s-m-auth-translation-open"});this.$$panel=$(html),this.$$panel.attr("data-action","openTranslation"),$$parent.append(this.$$panel)}else this.$$panel.off("click");var eventData={};eventData.$$parent=$$parent,eventData.data=data,eventData.context=context,eventData.context.pageTitle=locale.text("auth.translation.page"),this.$$panel.click(eventData,function(){var modal=new modalTranslationPage.Modal(eventData.context);modal.show().then(function(result){result&&(eventData.data.articleSelection.$localization=result,_notifyChangePropUI(eventData.$$parent,null,eventData.data))}).fail(function(e){globals.getModal().error(e)})})}}},_initProperty=function(p){var pre="auth",lk=pre+"."+p.name;p.label==null&&(p.label=locale.text(lk)),p.values&&p.values.forEach(function(v,idx){if($.isPlainObject(v)){var vk=lk+"."+(""+(v.value!=null?v.value:v.key));v.label==null&&(v.label=locale.text(vk))}else p.values[idx]={label:v+"",valu:v}})},_initProperties=function(properties,dest){var pre="auth";Object.keys(properties).forEach(function(prop){var p=properties[prop];dest&&(dest[prop]=p);if(typeof p=="function")return;p.name=prop,_initProperty(p)})},_err=function(title,ee){return modal.error(title,ee),!0};exports.getColorValues=_getColorValues,exports.getColorPalette=_getColorPalette,exports.getColorInfo=_getColorInfo,exports.properties=_properties,exports.err=_err,exports.createMarkupIconPicker=_createMarkupIconPicker,exports.destroyMarkupIconPicker=_destroyMarkupIconPicker,exports.createMarkupRadio=_createMarkupRadio,exports.refreshMarkupRadio=_refreshMarkupRadio,exports.createMarkupCheckboxes=_createMarkupCheckboxes,exports.refreshMarkupCheckboxes=_refreshMarkupCheckboxes,exports.getValueOrDefault=_getValueOrDefault,exports.setValue=_setValue,exports.notifyAuthVariantChange=_notifyAuthVariantChange,exports.notifyChangePropUI=_notifyChangePropUI,exports.initProperties=_initProperties,exports.initProperty=_initProperty,exports.getModuleProperties=function($$elmt,controller,props,sel,data){props.push(_properties.SEPARATOR),$$elmt.is(".s-m-page")?(props.push(_properties.JSON),props.push(_properties.SEPARATOR),props.push(_properties.PROTOTYPE),props.push(_properties.SEPARATOR),props.push(_properties.translation)):data&&data.control&&data.control.prototype&&props.push(_properties.PROTOTYPE)},exports.initModuleProperties=function(dest){exports.initProperties(_properties,dest)}}),define("syracuse-tablet/html/js/authoring/arrays/authArrayGeneral",["require","exports","module","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/jsutils"],function(require,exports,module){var authPropsGeneral=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),locale=require("syracuse-tablet/html/js/helpers/locale"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),_templates={subtitle:'		<section class="s-m-prop-subtitle" {{#if id}}id="{{id}}"{{/if}} style="{{#if notHidden}}overflow:hidden;{{/if}}white-space:nowrap;text-overflow:ellipsis;{{#if margin}}margin-bottom:{{margin}}px;{{/if}}">			{{#if title}}<p>{{title}}</p>{{/if}}			<div></div>		</section>',subPropTitle:' 		<div class="panel panel-primary s-m-panel-auth-prop s-m-auth-prop-type-{{type}}"> 			<div style="overflow:hidden;" class="panel-heading" role="tab" id="heading_{{id}}"> 				<a style="width:100%;display:table;" data-toggle="collapse" data-parent="#{{#if parentId}}{{parentId}}{{/if}}{{#unless parentId}}accordion{{/unless}}" href="#collapse_{{id}}" {{#if expanded}} aria-expanded="true"{{/if}} aria-controls="collapse_{{id}}" {{#unless expanded}}class="collapsed"{{/unless}}>					<div style="display:table-row;white-space: nowrap;">						<h4 class="panel-title" style="display:table-cell;"> 							{{label}}						</h4> 						{{#if info}}<span style="padding-left: 10px;font-size:x-small;display:table-cell;text-align: right;"><i>{{info}}</i></span>{{/if}}					</div>				</a> 			</div> 			<div id="collapse_{{id}}" class="panel-collapse collapse {{#if expanded}}in{{/if}}" role="tabpanel" aria-labelledby="heading_{{id}}"> 			</div> 		</div>',statusLine:'		<span style="display:table;table-layout:fixed;width:100%">			<span style="display:table-row;">				<span style="display:table-cell;overflow:hidden;text-overflow:ellipsis;white-space: nowrap;">{{field}} {{operator}} {{value}}</span>				<span class="{{css}}" style="{{style}}display:table-cell;width:{{sizeColor}}px;height:{{sizeColor}}px;margin-right:5px;"></span>			</span>		</span>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[name],tmpl=_templates[key]=Handlebars.compile(tmpl)),tmpl(ctx)},_properties={chartDetailButton:function(controller,sel,data){this.name=null,this.label=null,this.key=null,this.controller=controller,this.control=data.control,this.createButtonMarkup=function(){var level=this.control.level,label="auth."+(level>0&&this.control.hasSublevel()?"subLevel":"chartDetail")+".openDesign";return this.$$OpenButton=$('<button id="auth_opt_chart_design" type="button" class="btn btn-default">'+locale.text(label)+"</button>"),this.$$OpenButton.on("click",jsutils.bindFn(this.onClickButton,this)),this.$$OpenButton},this.destroyButtonMarkup=function(context){this.control=null,this.controller=null,this.$$OpenButton&&(this.$$OpenButton.off("click"),this.$$OpenButton.remove(),this.$$OpenButton=null)},this.onClickButton=function(evt){var opt=null,level=0;if(this.control.hasSublevel()){level=this.control.level+1;var rowId=this.control.rowIdx2Id(0);opt=this.control.drillDownOpt(rowId),opt.level=level,level>1&&(opt.action="$drillDown")}this.control.triggerOpenChartDetail(opt),this.destroyButtonMarkup()}},arrayDisplay:function(controller,sel,data){this.name="arrayDisplay",this.label=null,this.key="$display",this["default"]="table",this.values=[];var self=this;["table","separator","card","carousel","chart"].forEach(function(val){(data.control.isAuthoringPropAllowed==null||data.control.isAuthoringPropAllowed("arrayDisplay",val))&&self.values.push({value:val})}),this.createMarkup=authPropsGeneral.createMarkupRadio,this.refreshMarkup=authPropsGeneral.refreshMarkupRadio},arraySeparator:{key:"$separator","default":"blank",values:[{value:"blank"},{value:"dash"},{value:"colon"},{value:"semicolon"}],createMarkup:authPropsGeneral.createMarkupRadio,refreshMarkup:authPropsGeneral.refreshMarkupRadio},arrayProtoFilters:function(controller,sel,data){this.name="arrayProtoFilters",this.label=null,this.key="$filters",this["default"]=controller.isVignette?"none":"list",this.values=[{value:"list"},{value:"tabs"},{value:"none"}],this.createMarkup=authPropsGeneral.createMarkupRadio,this.refreshMarkup=authPropsGeneral.refreshMarkupRadio},arrayQueryLink:function(controller,sel,data){this.name="arrayQueryLink",this.label=null,this.isHidden=!0,this.values=[],this.key="$detailsLink",this["default"]="$details",this.createMarkup=authPropsGeneral.createMarkupRadio,this.refreshMarkup=authPropsGeneral.refreshMarkupRadio,this.initMarkup=function(controller,sel,data){var links=data.control.prototype.getDataByPath("$item.$links");if(!links||links.length===0)return;controller.isVignette&&(this["default"]="$queryfullpage",this.values.push({value:"$queryfullpage",label:locale.text("auth.arrayQueryLink.queryfullpage")}));var self=this;$.each(links,function(key,link){var method=link&&link.$method||"GET";link&&method==="GET"&&(key.indexOf("$")!==0||["$edit","$details"].indexOf(key)>-1)&&self.values.push({value:key,label:link.$title?controller.prototype.resolveExpression(link.$title)+" - "+key:key})}),this.isHidden=this.values.length===1&&this.values[0].value==="$details"}},arrayOptions:function(controller,sel,data){this.name="arrayOptions",this.label=null,this.key="$arrayOptions";var ctrl=data.control;this.values=[],ctrl.$display==="card"&&ctrl.isCarouselDisplay()?this.values.push({key:"rowIndex","default":!0}):ctrl.isArrayChart()&&ctrl.isHighChart()?this.values.push({key:"showPagination","default":!1}):(ctrl.isArrayField()||(this.values.push({key:"showPagination","default":controller.isVignette?!1:!0}),ctrl.isArrayChart()||(this.values.push({key:"showSortFilter","default":controller.isVignette?!1:!0}),this.values.push({key:"showSearch","default":controller.isVignette?!1:!0}))),ctrl.$display==="table"&&!ctrl.prototype.isSingleArray()&&!ctrl.isArrayChart()&&!controller.prototype.isQueryLikeFacet()&&this.values.push({key:"showRowDetailLink","default":!1}),this.values.push({key:"rowIndex","default":ctrl.$display==="card"}),ctrl.$display==="card"&&this.values.push({key:"hideEmptyRows","default":!1})),this.createMarkup=authPropsGeneral.createMarkupCheckboxes,this.refreshMarkup=authPropsGeneral.refreshMarkupCheckboxes}};exports.getHtml=_getHtml,exports.initModuleProperties=function(dest){authPropsGeneral.initProperties(_properties,dest)},exports.getModuleProperties=function($$elmt,controller,props,sel,data){data.control.isArrayChart()&&(controller.state.type!=="chartdetail"||data.control.hasSublevel())&&props.push(_properties.chartDetailButton),props.push(_properties.arrayDisplay),data.control.$display==="separator"?props.push(_properties.arraySeparator):(props.push(_properties.arrayOptions),sel.$$elmt.is(".s-m-control.s-m-chart")||(!data.control.isArrayField()&&controller.$filtersGet()&&controller.$filtersGet().length>1&&props.push(_properties.arrayProtoFilters),controller.prototype.isQuery()&&props.push(_properties.arrayQueryLink)))}}),define("syracuse-tablet/html/js/ui/fontUtils",["require","exports","module"],function(require,exports,module){var _paginBtns={$first:"glyphicon glyphicon-step-backward",$previous:"glyphicon glyphicon-chevron-left",$next:"glyphicon glyphicon-chevron-right",$last:"glyphicon glyphicon-step-forward"},_tileIcons=["adjust","adn","ambulance","anchor","android","angellist","apple","archive","asterisk","automobile","ban","bank","barcode","bell","bicycle","binoculars","bitbucket","bolt","book","bookmark","briefcase","building","bullhorn","bullseye","calculator","calendar","camera","certificate","chain","child","circle","clipboard","codepen","cog","cogs","columns","compass","dashboard","database","envelope","exclamation","eye","fax","file","flag","flash","folder","globe","heart","home","image","inbox","info","institution","key","laptop","leaf","legal","lock","magic","money","paperclip","phone","plane","rocket","search","shield","sitemap","sliders","star","steam","stethoscope","stop","suitcase","th","tumblr","twitch","twitter","umbrella","warning","wrench"],_getIconByName=function(name){switch(name){case"$multiSelection":return"glyphicon glyphicon-list-alt";case"$cancelMultiSel":case"$cancelEdit":return"fa fa-undo";case"$edit":return"fa fa-edit";case"$query":return"fa fa-list";case"$save":return"fa fa-save";case"$details":return"fa fa-level-down";case"$delete":return"fa fa-trash-o";case"$create":return"fa fa-plus-square";case"$image-sign":return"fa fa-pencil";case"$image-camera":return"fa fa-camera";case"$image-ink":return"fa fa-paint-brush";case"appUpdate":return"fa fa-history";case"appSetup":return"fa fa-download";case"gear":return"fa fa-gear";case"expand":return"fa fa-expand";case"compress":return"fa fa-compress";case"GPSPicker":return"fa fa-dot-circle-o";case"scanBarcodePicker":return"fa fa-barcode";case"penTextInputPicker":return"fa fa-pencil-square-o";case"$showtemplates":return"fa fa-file-text-o";case"$showtemplatesEmpty":return"fa fa-file-o";case"$apply":return"fa fa-check";case"$refresh":return"fa fa-save";case"lookupPicker":return"glyphicon glyphicon-eye-open";case"datePicker":return"glyphicon glyphicon-calendar";case"timePicker":return"glyphicon glyphicon-time"}return _tileIcons.indexOf(name)>-1?"fa fa-"+name:""};exports.getIconByName=_getIconByName,exports.checkBoxIcon=function(val){return["glyphicon",val?"glyphicon-ok":"glyphicon-remove"]},exports.phoneFieldIcon=function(){return"fa fa-phone"},exports.emailFieldIcon=function(){return"fa fa-envelope-o"},exports.documentFieldIcon=function(){return"fa fa-file-text"},exports.binaryFieldIcon=function(){return"fa fa-file-0"},exports.paginationIcon=function(linkName){return _paginBtns[linkName]},exports.layoutExpandCollapseIcon=function(collapse,advancedTheme){return collapse?advancedTheme?"fa fa-ellipsis-h":"fa fa-chevron-down":advancedTheme?"fa fa-times":"fa fa-chevron-up"},exports.pageIcon=function(name){if(name==="settings")return"fa fa-gear";if(name==="clearCache")return"fa fa-history";if(name==="switchContext")return"fa fa-user";if(name==="search")return"fa fa-search";if(name==="sidePanelL")return"fa fa-caret-square-o-left";if(name==="sidePanelR")return"fa fa-angle-double-right";if(name==="home")return"fa fa-home";if(name==="designPage")return"fa fa-paint-brush";if(name==="back")return"fa fa-arrow-circle-o-left";if(name==="developmentPage")return"fa fa-wrench";if(name==="bars")return"fa fa-bars";if(name==="backIphone")return"fa fa-angle-left";if(name==="about")return"fa fa-info-circle";if(name==="logout")return"fa fa-sign-out";if(name==="pinPage_1")return"fa fa-thumb-tack";if(name==="pinPage_2")return"fa fa-times";if(name==="pageConfig")return"fa fa-paint-brush";if(name==="nativeShare")return"fa fa-share-alt";if(name==="mailto")return"fa fa-envelope";if(name==="freshness")return"fa fa-bookmark";if(name==="drafts")return"fa fa-building-o";if(name==="dashboardList")return"fa fa-list-ul";if(name==="mydashboard")return"fa fa-chevron-left"},exports.dashboardIcon=function(name){if(name==="removeTile")return"fa fa-trash-o";if(name==="editTile")return"fa fa-pencil";if(name==="moveTile")return"fa fa-sitemap";if(name==="dashboardList")return"fa fa-list-ul";if(name==="templateList")return"fa fa-list-ul";if(name==="addGroup")return"fa fa-sitemap";if(name==="addHiddenTile")return"fa fa-th-large";if(name==="moveGroupAfter")return"fa fa-arrow-left";if(name==="moveGroupBefore")return"fa fa-arrow-right";if(name==="removeGroup")return"fa fa-trash-o";if(name==="emptyTile")return"fa fa-exclamation-triangle"},exports.ctrlIcon=function(name){if(name==="editrow")return"fa fa-pencil-square-o";if(name==="detailrow")return"fa fa-hand-o-right";if(name==="delrow")return"fa fa-remove";if(name==="addrow")return"fa fa-plus"},exports.vignetteIcons=function(name){if(name==="home")return"fa fa-home";if(name==="back")return"fa fa fa-arrow-circle-o-left";if(name==="refresh")return"fa fa-history"},exports.sortIcon=function(name){if(name==="asc")return"fa fa-long-arrow-up";if(name==="none")return"fa fa-times";if(name==="desc")return"fa fa-long-arrow-down"},exports.filterIcon=function(name){if(name==="panel")return"fa fa-bars";if(name==="filtered")return"fa fa-filter";if(name==="edit")return"fa fa-pencil";if(name==="delete")return"fa fa-times";if(name==="separator")return"fa fa-plus"},exports.sortFilterTab=function(name){if(name==="sort")return"fa fa-arrows-v";if(name==="filter")return"fa fa-filter";if(name==="memo")return"fa fa-star";if(name==="apply")return"fa fa-check"},exports.getTileIconList=function(){return _tileIcons};var _arrayStatusIconNames=["thumbs-down","thumbs-o-down","thumbs-up","thumbs-o-up","hand-o-down","hand-o-up","lock","unlock","unlock-alt","smile-o","meh-o","check","check-circle","check-circle-o","check-square","check-square-o","square","square-o","circle","circle-thin","circle-o","close","comment","comment-o","comments","comments-o","photo","film","barcode","bars","plus","plus-circle","plus-square","plus-square-o","minus","minus-circle","minus-square","minus-square-o","question","question-circle","trash","trash-o","info","info-circle","flag","flag-checkered","flag-o","female","male","mars","venus","user","users","user-plus","user-times","user-secret","facebook-official","file","file-o","dollar","eur","gbp","yen","rub","rupee","shekel","cny","ils","inr","krw","money","turkish-lira","won","envelope-square","envelope-o","envelope","exclamation","exclamation-circle","exclamation-triangle"],_arrayStatusIcons=null,_getArrayStatusIconList=function(){return _arrayStatusIcons==null&&(_arrayStatusIcons=[],_arrayStatusIconNames.forEach(function(name){_arrayStatusIcons.push({css:"fa fa-"+name,name:name})})),_arrayStatusIcons};exports.getArrayStatusIconList=_getArrayStatusIconList,exports.getArrayStatusDefIcon=function(){return{name:"circle",css:"fa fa-circle"}};var _arrayActionsIconNames=_arrayStatusIconNames.slice(0),_arrayActionsIcons=null,_getPageActionIcon=function(){return _arrayActionsIcons==null&&(_arrayActionsIconNames=_arrayActionsIconNames.concat(["download","save","undo","edit","history","eraser","reply","refresh"]),_arrayActionsIcons=[],_arrayActionsIconNames.forEach(function(name){_arrayActionsIcons.push({css:"fa fa-"+name,name:name})})),_arrayActionsIcons};exports.getPageActionIcon=_getPageActionIcon;var _emptyImageIconNames=["image","user","users","warning","file-movie-o","file-image-o","paperclip","film"],_emptyImageIcons=null;exports.getEmptyImageIconList=function(){return _emptyImageIcons==null&&(_emptyImageIcons=[],_emptyImageIconNames.forEach(function(name){_emptyImageIcons.push({css:"fa fa-"+name,name:name})})),_emptyImageIcons},exports.getEmptyImageDefIcon=function(){return{name:"image",css:"fa fa-image"}},exports.getEmptyFileDefIcon=function(){return{name:"file",css:"fa fa-file"}};var _urlIconNames=["globe","map-marker","street-view","road","link","cloud","database","bed","cutlery","glass","train","subway","taxi","ship","plane"],_urlIcons=null;exports.getUrlIconList=function(){return _urlIcons==null&&(_urlIcons=[],_urlIconNames.forEach(function(name){_urlIcons.push({css:"fa fa-"+name,name:name})})),_urlIcons},exports.getUrlDefIcon=function(){return{name:"Url",css:"fa fa-globe"}};var _colImageIconNames=["image","user","users","warning","file-movie-o","file-image-o","paperclip","film"],_colImageIcons=null;exports.getColImageIconList=function(){return _colImageIcons==null&&(_colImageIcons=[],_colImageIconNames.forEach(function(name){_colImageIcons.push({css:"fa fa-"+name,name:name})})),_colImageIcons},exports.getColImageDefIcon=function(emptyImage){return{name:"image",css:emptyImage===!0?"fa fa-times":"fa fa-image"}},exports.getPinVignetteIcon=function(what){return what=="all"?"fa fa-toggle-on fa-toggle-off":what=="on"?"fa fa-toggle-on":"fa fa-toggle-off"},exports.getCarouselIcon=function(what){return what=="left"?"glyphicon glyphicon-chevron-left":what=="right"?"glyphicon glyphicon-chevron-right":""},exports.getDraftIcons=function(name){switch(name){case"synch":return"fa fa-upload";case"remove":return"fa fa-trash";case"stop":return"fa fa-stop"}}}),define("syracuse-tablet/html/js/authoring/arrays/authArrayTable",["require","exports","module","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral","syracuse-tablet/html/js/authoring/arrays/authArrayGeneral","syracuse-tablet/html/js/authoring/authoringComponents","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var authPropsGeneral=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),authArrayGeneral=require("syracuse-tablet/html/js/authoring/arrays/authArrayGeneral"),authComponents=require("syracuse-tablet/html/js/authoring/authoringComponents"),locale=require("syracuse-tablet/html/js/helpers/locale"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_maxCharWidth=50,_defCharWidth=20,_defPercentWidth=20,_tableConfigKeys=["$bind","$type","$titleOrig","$widthType","$widthVal","$refDescFormat","$refDescPosition","$imgIcon","$imgDisplayIcon","$imgHeight"],_TableColumnPanel=function(parent,colInfo){this.name="arrayTableColumn",this.label=colInfo.$title||colInfo.$bind,this.parent=parent,this.colInfo=colInfo;if(parent.isSingleArray||!this.colInfo.$widthType)this.colInfo.$widthType="auto";this._myProperties=[],this.createMarkup=function($$parent){this.$$parent=$$parent,parent.isSingleArray||(this.colNameChoiceAdd(),this.colWidthTypeAdd(),this.colWidthValAdd()),this.colXrefAdd(),this.colImageAdd(),this.colImgHeightAdd()},this._add2PropHeading=function(title,prop,$$forceParent){var $$root=$(authArrayGeneral.getHtml("subtitle",{title:title,margin:10,id:prop.name})).appendTo($$forceParent||this.$$parent).find("div");return prop.name==="selectName"&&$$root.css({textOverflow:"inherit"}),prop.createMarkup?(prop.createMarkup($$root),this._myProperties.push(prop)):prop.jquery&&$$root.append(prop),prop},this.colNameChoiceAdd=function(){var idx=this.parent.getFieldProto(this.colInfo.$bind).idx,selectOpts=[];this.parent._protoValue.forEach(function(v){selectOpts.push({title:v.$title,value:v.$bind})});var opts={value:this.colInfo.$bind,options:selectOpts,onChange:jsutils.bindFn(this.colNameSelect,this)};this._add2PropHeading(locale.text("auth.tableDesign.selColName"),authComponents.newComponent("select",opts,"selectName"))},this.colNameSelect=function(event,prop){this.colInfo=this.parent.getFieldProto($(event.target).val()).value;var $$title=prop.$$panel.closest(".panel-primary").find(".panel-title");$$title.text(this.colInfo.$title),$$title.next("span").find("i").text(this.colInfo?this.colInfo.$bind:""),this.$$xrefroot.toggle(this.colInfo.$type==="application/x-reference"),this.$$imageroot.toggle(this.colInfo.$type==="image")},this.colWidthTypeAdd=function(){this._add2PropHeading(locale.text("auth.tableDesign.width"),authComponents.newComponent("flatRadio",{btns:[{value:"auto",title:locale.text("auth.tableDesign.auto")},{value:"fixed",title:locale.text("auth.tableDesign.fixed")},{value:"percent",title:"%"}],onClick:jsutils.bindFn(this.colWidthTypeChanged,this),value:this.colInfo.$widthType||"auto"}))},this.colWidthTypeChanged=function(evt){$(evt.target).val()!==this.colInfo.$widthType&&(this.colInfo.$widthType=$(evt.target).val(),this.colWidthValUpdt())},this.colWidthValAdd=function(){var opts={slideHandler:jsutils.bindFn(this.colWidthValSlide,this),stopHandler:jsutils.bindFn(this.colWidthValChange,this),value:this.colInfo.$widthVal||0,min:0,max:this.colInfo.$widthType==="percent"?100:_maxCharWidth,margin:0};this.propWidthVal=this._add2PropHeading(locale.text("auth.tableDesign.selWidth"),authComponents.newComponent("genericSlider",opts)),this.colWidthValUpdt(opts.value)},this.colWidthValSlide=function(val,prop){return this.colInfo.$widthType==="percent"?val+"%":val+" "+locale.text("auth.tableDesign.characters")},this.colWidthValChange=function(val,prop){this.colInfo.$widthVal=val},this.colWidthValUpdt=function(forceValue){var show=this.colInfo.$widthType!=="auto";this._toggleProp(this.propWidthVal,show);if(!show)return;this.propWidthVal.update({value:forceValue||(this.colInfo.$widthType==="percent"?_defPercentWidth:_defCharWidth),max:this.colInfo.$widthType==="percent"?100:_maxCharWidth})},this.colXrefAdd=function(){var style=this.colInfo.$type!=="application/x-reference"?"display:none":"";this.$$xrefroot=$('<section class="xrefColumn" style="'+style+'" ></section>').appendTo(this.$$parent);var pos=this.colInfo.$refDescPosition||globals.XREF_DESCRPOS_TABLE;this._xrefDescrPos=this._createXRefSelect("pos",["bottom","right","left","top","none"],pos),this._xrefDescrFmt=this._createXRefSelect("fmt",["desc","title","desctitle","titledesc"],this.colInfo.$refDescFormat||"desc"),this.$$xrefroot.find("#selectDescrfmt").toggle(pos!=="none")},this._createXRefSelect=function(type,codes,def){var selectOpts=[],defIdx=codes.indexOf(def);defIdx==-1&&(defIdx=0);var textRoot="auth."+(type=="fmt"?"refDescFormat":"refDescPosition");codes.forEach(function(code,idx){selectOpts.push({code:code,title:locale.text(textRoot+"."+code),value:idx})});var opts={value:defIdx,options:selectOpts,onChange:jsutils.bindFn(this.colXrefChange,this,type)};return this._add2PropHeading(locale.text(textRoot),authComponents.newComponent("select",opts,"selectDescr"+type),this.$$xrefroot),selectOpts},this.colXrefChange=function(event,prop,type){var idx=parseInt($(event.target).val(),10),ref=type==="fmt"?this._xrefDescrFmt:this._xrefDescrPos;ref=ref[idx].code,type=="pos"&&this.$$xrefroot.find("#selectDescrfmt").toggle(ref!=="none"),this.colInfo["$refDesc"+(type==="fmt"?"Format":"Position")]=ref},this.colImageAdd=function(){var style=this.colInfo.$type!=="image"?"display:none":"";this.$$imageroot=$('<section class="ximageColumn" style="'+style+'" ></section>').appendTo(this.$$parent);var displayIcon=this.colInfo.$imgDisplayIcon===!0,opts={checked:displayIcon,size:"small",onSwitchChange:this.onImgDisplayIconChanged.bind(this)};this._add2PropHeading(locale.text("auth.imgcol.displayIcon"),authComponents.newComponent("switcher",opts),this.$$imageroot),opts={palette:fontUtils.getColImageIconList(),dropUp:!0,icon:this.colInfo.$imgIcon||fontUtils.getColImageDefIcon(),onSelectIcon:this.onImgIconChanged.bind(this)},this.propImageIcon=this._add2PropHeading(locale.text("auth.imgcol.iconPicker"),authComponents.newComponent("iconPalettePicker",opts),this.$$imageroot),this._toggleProp(this.propImageIcon,displayIcon)},this.onImgIconChanged=function(icon){this.colInfo.$imgIcon=icon},this.onImgDisplayIconChanged=function(event,status){this.colInfo.$imgDisplayIcon=status,this._toggleProp(this.propImageIcon,status)},this.colImgHeightAdd=function(){var opts={value:this.colInfo.$imgHeight||"medium",options:[],onChange:jsutils.bindFn(this.imgHeightSelect,this)};["xsmall","small","medium","large","xlarge"].forEach(function(s){opts.options.push({title:locale.text("auth.imgHeight."+s),value:s})});var prop=this._add2PropHeading(locale.text("auth.imgHeight"),authComponents.newComponent("select",opts));this._toggleProp(prop,this.colInfo.$type==="image")},this.imgHeightSelect=function(event,prop,type){this.colInfo.$imgHeight=$(event.target).val()},this._toggleProp=function(prop,show){return prop.$$panel.closest("section.s-m-prop-subtitle").toggle(show)},this.destroyMarkup=function(){this.parent=null,this.colInfo=null,this._myProperties&&(this._myProperties.forEach(function(p){p.destroyMarkup&&p.destroyMarkup()}),this._myProperties=null),this.$$parent&&(this.$$parent.closest(".s-m-panel-auth-prop").remove(),this.$$parent=null)}},_properties={arrayTableHeader:{key:"$tableHeaderShow","default":!0,values:[{value:!0},{value:!1}],createMarkup:authPropsGeneral.createMarkupRadio,refreshMarkup:authPropsGeneral.refreshMarkupRadio},arrayTableDesign:function(controller,sel,data){this.isHidden=!1,this.name="arrayTableDesign",this.label=null,this.key="$table",this.controller=controller,this.ctrlArray=data.control,this._generalProperties=[],this._columnProperties=[],this._protoValue=[],this.initMarkup=function(controller,sel,data){this._protoValue=this.ctrlArray.getColumnsInfo(!0),this.isSingleArray=this.ctrlArray.prototype.isSingleArray()||this._protoValue.length<=1,this._orginalValue=data.articleSelection.$table;var hasValue=this._orginalValue!=null&&this._orginalValue.length>0;hasValue||(this._orginalValue=null),this._initProps(hasValue?this._orginalValue:this._protoValue),this.isSingleArray?this.isHidden=this._protoValue.length===0||this._protoValue[0].$type!=="application/x-reference":this.addPropNbColumns(),this.isHidden||this.addPropActionButtons(sel,data)},this._initProps=function(props,createEntry){var self=this;self._columnProperties=[],props.forEach(function(prop){self._createColumnProperty(prop,createEntry)})},this.addPropNbColumns=function(){var opts={slideHandler:function(val){return val+" columns"},stopHandler:jsutils.bindFn(this.updateColumns,this),value:this._columnProperties.length,min:1,max:this._protoValue.length,displayValue:"above"};this._generalProperties.push(authComponents.newComponent("genericSlider",opts,"nbcolumns"))},this._updateNbCols=function(){var prop;this._generalProperties.some(function(p){if(p.name==="nbcolumns")return prop=p,!0}),prop.update({value:this._columnProperties.length})},this.addPropActionButtons=function(sel,data){var btns=[{value:"save",title:locale.text("auth.tableDesign.save")}];this._generalProperties.push(authComponents.newComponent("actionBtns",{btns:btns,onClick:jsutils.bindFn(this.onClickAction,this,sel,data)}))},this.onClickAction=function(evt,sel,data){var action=$(evt.target).val();if(action==="save"){var value=[],entry,self=this,conf;this._columnProperties.forEach(function(prop){if(!prop.colInfo)return;entry={},_tableConfigKeys.forEach(function(p){if(p!=="$titleOrig"||utils.isExpression(prop.colInfo[p]))conf=prop.colInfo[p],conf!=null&&(entry[p]=$.isPlainObject(conf)?$.extend(!0,{},conf):conf)}),value.push(entry)}),authPropsGeneral.setValue(this,sel,data,value),authPropsGeneral.notifyChangePropUI(this.$$parent,sel,data);return}if(action==="restore"){if(this._orginalValue){this._clearColumns(),this._initProps($.extend(!0,[],this._orginalValue),!0),this._updateNbCols();return}action="all"}if(action==="all"){this.updateColumns(null),this._updateNbCols();return}},this.createMarkup=function($$parent,prop,sel,data){this.$$parent=$$parent,this._accordionId=utils.UUID(),this.$$myAccordion=$('<div id="'+this._accordionId+'" ></div>'),$$parent.append(this.$$myAccordion);var self=this,$$entry;self._generalProperties.forEach(function(prop){$$entry=$(authArrayGeneral.getHtml("subtitle",{title:prop.label?prop.label||prop.name:null})),prop.createMarkup($$entry.find("div")),self.$$myAccordion.append($$entry)}),self._columnProperties.forEach(function(prop){self._createColEntry(prop)})},this._createColEntry=function(prop){var id=utils.UUID(),$$parent;if(!this.isSingleArray){var $$propGroup=$(authArrayGeneral.getHtml("subPropTitle",{id:id,type:"child columns",label:prop.label,info:prop.colInfo?prop.colInfo.$bind:null,expanded:!1,parentId:this._accordionId}));$$parent=$$propGroup.find("#collapse_"+id),this.$$myAccordion.append($$propGroup)}else this.$$myAccordion.append($$propGroup),$$parent=$('<div style="padding-left:10px;padding-right:10px;"></div>').appendTo(this.$$myAccordion);prop.createMarkup($$parent)},this.destroyMarkup=function(){this.$$parent=null,this.ctrlArray=null,this.controller=null,this._getAllProps().forEach(function(p){p.destroyMarkup()}),this._generalProperties=null,this._columnProperties=null},this._getAllProps=function(){return(this._generalProperties||[]).concat(this._columnProperties||[])},this.updateColumns=function(nbCols){this.$$myAccordion&&this.$$myAccordion.find(".collapse").collapse("hide");var init=nbCols==null;nbCols=init?this._protoValue.length:nbCols;var startFrom=0;if(init)this._clearColumns();else if(this._columnProperties.length>0){for(var i=this._columnProperties.length-1;i>=nbCols;i--)this._columnProperties[i].destroyMarkup(),this._columnProperties.splice(i,1);startFrom=this._columnProperties.length}for(var i=startFrom;i<nbCols;i++)this._createColumnProperty(this._protoValue[i],!0)},this._createColumnProperty=function(config,createEntry){var proto=this.getFieldProto(config.$bind,!0);if(!proto)return null;config.$title=this.controller.prototype.resolveExpression(proto.value.$title)||config.$bind,config.$type=proto.value.$type,config.$titleOrig=proto.value.$titleOrig;var prop=new _TableColumnPanel(this,config);return this._columnProperties.push(prop),createEntry&&this._createColEntry(prop),prop},this._clearColumns=function(){this._columnProperties&&this._columnProperties.forEach(function(p){p.destroyMarkup()}),this._columnProperties=[]},this.getProtoValByIdx=function(idx){if(idx<0||idx>=this._protoValue.length)throw new Error("unexpected bad index["+idx+"]");return this._protoValue[idx]},this.getFieldProto=function(bind,noFail){var res=null;this._protoValue.some(function(v,idx){if(v.$bind===bind)return res={idx:idx,value:v},!0});if(res==null&&noFail!==!0)throw new Error("unexpected null value - bind=["+bind+"]");return res}}};exports.initModuleProperties=function(dest){authPropsGeneral.initProperties(_properties,dest)},exports.getModuleProperties=function($$elmt,controller,props,sel,data){data.control.prototype.isSingleArray()||props.push(_properties.arrayTableHeader),props.push(_properties.arrayTableDesign)}}),define("syracuse-tablet/html/js/authoring/arrays/authArrayCard",["require","exports","module","syracuse-tablet/html/js/authoring/authoringComponents","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral","syracuse-tablet/html/js/application/eventListener","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/jsutils"],function(require,exports,module){var authComponents=require("syracuse-tablet/html/js/authoring/authoringComponents"),authPropsGeneral=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),eventListener=require("syracuse-tablet/html/js/application/eventListener"),locale=require("syracuse-tablet/html/js/helpers/locale"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),_properties={arrayCardsPerRow:{key:"$cardsPerRow","default":"2",values:[{value:"1"},{value:"2"},{value:"3"},{value:"4"}],createMarkup:authPropsGeneral.createMarkupRadio,refreshMarkup:authPropsGeneral.refreshMarkupRadio},arrayBgColor:{key:"$arrayBgColor","default":"",colorChange:function(value,sel,data,prop){authPropsGeneral.setValue(this,sel,data,value?value.id:""),authPropsGeneral.notifyChangePropUI(this.$$parent,sel,data)},createMarkup:function($$parent,prop,sel,data){var opts={color:"",palette:authPropsGeneral.getColorPalette(),dropUp:!1,onSelectColor:jsutils.bindFn(this.colorChange,this,sel,data,prop)};this.paletteColor=authComponents.newComponent("colorPalettePicker",opts),this.paletteColor.createMarkup($$parent),this.paletteColor.setValue(authPropsGeneral.getColorInfo(data.control.article.$arrayBgColor))}},arrayCardsMinWidth:function(controller,sel,data){this.name="arrayCardsMinWidth",this.label=null,this.key="$minWidth",this["default"]=1,this.min=0,this.max=20,this.step=1,this.createMarkup=function($$parent,prop,sel,data){this.ctrl=data.control,this.$$parent=$$parent,this.originValue=authPropsGeneral.getValueOrDefault(this,sel,data);var opts={id:"auth_opt_"+this.name,value:this.originValue,min:this.min,max:this.max,step:this.step||1,slideHandler:jsutils.bindFn(this.onSlide,this,"slide"),startHandler:jsutils.bindFn(this.onSlide,this,"start"),stopHandler:jsutils.bindFn(this.onSlide,this,"stop",sel,data)};this._slider=authComponents.newComponent("genericSlider",opts),this._slider.createMarkup($$parent)},this.onSlide=function(value,prop,action,sel,data){var res=this.ctrl.authOnSlideMinSize(value,action);if(action==="slide")return res;action==="stop"&&this.originValue!=value&&(authPropsGeneral.setValue(this,sel,data,value),authPropsGeneral.notifyChangePropUI(this.$$parent,sel,data))},this.destroyMarkup=function(){this.ctrl=null,this.$$parent=null,this.$$slider&&(this.$$slider.slider("destroy"),this.$$slider=null)},this._sliderSetValue=function(slideEvt,$$parent,sel,data,originValue){this.ctrl.authOnSlideMinSize(slideEvt,"stop"),originValue!=slideEvt.value&&(authPropsGeneral.setValue(this,sel,data,slideEvt.value),authPropsGeneral.notifyChangePropUI($$parent,sel,data))}},arrayCardButton:function(controller,sel,data){this.name=null,this.label=null,this.key=null,this.controller=controller,this.control=data.control,this.createButtonMarkup=function(){return this.$$OpenButton=$('<button id="auth_opt_card_design" type="button" class="btn btn-default">'+locale.text("auth.tableDesign.openDesign")+"</button>"),this.$$OpenButton.on("click",jsutils.bindFn(this.onClickOpenButton,this)),this.$$OpenButton},this.destroyButtonMarkup=function(context){this.control=null,this.controller=null,this.$$OpenButton&&(this.$$OpenButton.off("click"),this.$$OpenButton.remove(),this.$$OpenButton=null)},this.onClickOpenButton=function(evt){if(!this.control)return;var attrs={"data-control-id":this.control.id,"data-parent-id":this.controller.id,"data-nav":"carddesign","data-nav-target":"application"};eventListener.triggerNavigation(this.control.$$elmt,attrs),this.destroyButtonMarkup()}},arrayCardsEmptyCells:{key:"$emptycell","default":"nodisplay",values:[{value:"filled"},{value:"withtitle"},{value:"nodisplay"}],createMarkup:authPropsGeneral.createMarkupRadio,refreshMarkup:authPropsGeneral.refreshMarkupRadio}};exports.initModuleProperties=function(dest){authPropsGeneral.initProperties(_properties,dest)},exports.getModuleProperties=function($$elmt,controller,props,sel,data){data.control.prototype.isSingleArray()||props.push(_properties.arrayCardsPerRow,_properties.arrayCardsMinWidth,_properties.arrayCardsEmptyCells,_properties.arrayCardButton,_properties.arrayBgColor)},exports.getCardDesignButton=function(controller){return new _properties.arrayCardButton(controller)}}),define("syracuse-tablet/html/js/helpers/fieldOperators",["require","exports","module","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var locale=require("syracuse-tablet/html/js/helpers/locale"),_excludedTypes=["application/x-array","image","application/x-document","application/x-binary","application/x-object","text/rtf","text/html","application/x-password"],_numberOperators=["gt","ge","lt","le","eq","ne"],_stringOperators=["like","gt","ge","lt","le","eq","ne","like_s"],_defOperators=["eq","ne"],_DATE={type:"application/x-date",checkFieldValue:function(fieldValue){return String(fieldValue)},checkValue:function(value){return String(value)},operators:_numberOperators,defOperator:"eq"},_TIME={type:"application/x-time",checkFieldValue:function(fieldValue){return fieldValue},checkValue:function(value){return value},operators:_numberOperators,defOperator:"eq"},_DATETIME={type:"application/x-datetime",checkFieldValue:function(fieldValue){return fieldValue},checkValue:function(value){return value},operators:_numberOperators,defOperator:"eq"},_DEC={type:"application/x-decimal",checkFieldValue:function(fieldValue){return fieldValue},checkValue:function(value){return parseFloat(value)},operators:_numberOperators,defOperator:"eq"},_REAL={type:"application/x-real",checkFieldValue:function(fieldValue){return fieldValue},checkValue:function(value){return parseFloat(value)},operators:_numberOperators,defOperator:"eq"},_INT={type:"application/x-integer",checkFieldValue:function(fieldValue){return parseInt(fieldValue,10)},checkValue:function(value){return parseInt(value,10)},operators:_numberOperators,defOperator:"eq"},_QTY={type:"application/x-quantity",checkFieldValue:function(fieldValue){return parseFloat(fieldValue)},checkValue:function(value){return parseFloat(value)},operators:_numberOperators,defOperator:"eq"},_STR={type:"application/x-string",checkFieldValue:function(fieldValue){return String(fieldValue)},checkValue:function(value){return String(value)},operators:_stringOperators,defOperator:"like"},_TEXT={type:"text/plain",checkFieldValue:function(fieldValue){return String(fieldValue)},checkValue:function(value){return String(value)},operators:_stringOperators,defOperator:"like"},_REF={type:"application/x-reference",checkFieldValue:function(fieldValue){return fieldValue&&fieldValue.$value?String(fieldValue.$value).toUpperCase():null},checkValue:function(value){return value?String(value).toUpperCase():null},operators:_stringOperators,defOperator:"like"},_CHOICE={type:"application/x-choice",checkFieldValue:function(fieldValue){return parseInt(fieldValue,10)},checkValue:function(value){return parseInt(value,10)},operators:_numberOperators,defOperator:"eq"},_BOOL={type:"application/x-boolean",checkFieldValue:function(fieldValue){return fieldValue},checkValue:function(value){return value},operators:_defOperators,defOperator:"eq"},_types={};[_DATE,_TIME,_DATETIME,_DEC,_REAL,_INT,_QTY,_STR,_TEXT,_REF,_BOOL,_CHOICE].forEach(function(t){_types[t.type]=t});var _operatorsWithTitle={},_operatorsByType=function($type){var t=_types[$type];return t?t.operators:_defOperators},_getOperators=function($type,withTitle,exclude){var operators;if(withTitle===!0){if(_operatorsWithTitle[$type]==null){var ops=_operatorsByType($type),res=[];ops.forEach(function(op){res.push({title:locale.text("field.operator."+op),value:op})}),_operatorsWithTitle[$type]=res}operators=_operatorsWithTitle[$type]}else operators=_operatorsByType($type);if(exclude&&exclude.length>0){var tmp=operators;operators=[],tmp.forEach(function(o){exclude.indexOf(o)<0&&operators.push(o)})}return operators},_getDefaultOperator=function($type){var t=_types[$type];return t?t.defOperator:"eq"},_evaluateOperator=function($type,fieldValue,operator,value){var fieldType=_types[$type];return fieldType==null?(console.log("_evaluateOperator - Type ["+$type+"] not evaluated"),!1):fieldType.operators.indexOf(operator)<0?!1:(fieldValue=fieldType.checkFieldValue(fieldValue),value=fieldType.checkValue(value),fieldValue==null||value==null?!1:operator==="eq"?fieldValue==value:operator==="ne"?fieldValue!=value:operator==="like"?fieldValue.indexOf?fieldValue.indexOf(value)>=0:!1:operator==="like_s"?fieldValue.smStartsWith?fieldValue.smStartsWith(value):!1:operator==="gt"?fieldValue>value:operator==="ge"?fieldValue>=value:operator==="lt"?fieldValue<value:operator==="le"?fieldValue<=value:!1)};exports.getDefaultOperator=_getDefaultOperator,exports.getOperators=_getOperators,exports.evaluateOperator=_evaluateOperator,exports.acceptOperator=function($type){return _excludedTypes.indexOf($type)<0},exports.checkValue=function($type,value){var fieldType=_types[$type];return fieldType?fieldType.checkValue(value):null}}),define("syracuse-tablet/html/js/helpers/types/date",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){function _padLeft(str,len,ch){str=str?str.toString():"";if(!ch||ch.length==0)ch=" ";while(str.length<len)str=ch+str;return str}function DateObj(value){this._value=value}function _dayName(weekDay,abbrev){return abbrev?_dateInfo().abbreviatedDayNames[weekDay]:_dateInfo().dayNames[weekDay]}function _monthName(month,abbrev){return abbrev?_dateInfo().abbreviatedMonthNames[month-1]:_dateInfo().monthNames[month-1]}function _pad2(val){var s=val.toString();return s.length==1?"0"+s:s}function _toOffset(date){var year=date.year,month=date.month,day=date.day,y=month<=2?year-1:year,n4=Math.floor(y/4)-Math.floor(492.5),n100=Math.floor(y/100)-Math.floor(19.7),n400=Math.floor(y/400)-Math.floor(4.925),nLeap=n4-n100+n400;return(year-1970)*365+nLeap+_monthOffsets[month-1]+day-1}function _fromOffset(offset){var julian=2440588+offset,l=julian+68569,n=Math.floor(4*l/146097);l-=Math.floor((146097*n+3)/4);var i=Math.floor(4e3*(l+1)/1461001);l=l-Math.floor(1461*i/4)+31;var j=Math.floor(80*l/2447),day=l-Math.floor(2447*j/80);l=Math.floor(j/11);var month=j+2-12*l,year=100*(n-49)+i+l;return new DateObj(year*1e4+month*100+day)}function _make(year,month,day){return new DateObj(year*1e4+month*100+day)}function _isLeap(year){return year%4===0&&(year%100!==0||year%400===0)}function _daysInMonth(year,month){return month==2?_isLeap(year)?29:28:_monthLengths[month-1]}function _isWorkDay(weekDay){return weekDay!=0&&weekDay!=6}function _amDesignator(){return _dateInfo().amDesignator||"AM"}function _pmDesignator(){return _dateInfo().pmDesignator||"PM"}function _walkFormat(format,map){function count(i){var ch=format[i],k=1;while(format[i+k]===ch)k++;return k}var i=0,len=format.length;while(i<len){var c=format[i];switch(c){case"'":i++;var literal="";for(;i<len;i++)if(format[i]==="'"){i++;if(format[i]!=="'")break;literal+="'"}else literal+=format[i];map.literal(literal);break;case"d":case"M":case"y":var repeat=count(i);map[c](repeat),i+=repeat;break;default:map.literal(c),i++}}}function _parse(str,format){function parseInteger(max){if(!/\d/.test(str[j]))throw new Error(locale.text("date.notNumber",str.substring[j]));var beg=j++;while(j<beg+max&&/\d/.test(str[j]))j++;return parseInt(str.substring(beg,j),10)}function parseName(names){for(var k=0;k<names.length;k++){var name=names[k],len=name.length;if(str.substring(j,j+len).toUpperCase()==name.toUpperCase())return j+=len,k}throw new Error(locale.text("date.unknown",str.substring(j)))}var day,weekday,month,year,j=0;return _walkFormat(format,{literal:function(literal){if(str.substring(j,j+literal.length)!==literal)throw new Error(locale.text("date.wrongFormat",literal,str.substring(j)));j+=literal.length},d:function(arg){switch(arg){case 1:case 2:day=parseInteger(2);break;case 3:weekday=parseName(_dateInfo().abbreviatedDayNames);break;case 4:weekday=parseName(_dateInfo().dayNames);break;default:throw new Error(locale.text("date.badDay",format.substring(j)))}},M:function(arg){switch(arg){case 1:case 2:month=parseInteger(2);break;case 3:month=parseName(_dateInfo().abbreviatedMonthNames)+1;break;case 4:month=parseName(_dateInfo().monthNames)+1;break;default:throw new Error(locale.text("date.badDay",format.substring(j)))}},y:function(arg){switch(arg){case 2:year=parseInteger(2),year=year<40?2e3+year:1900+year;break;case 4:year=parseInteger(4),year=year>99?year:year<40?2e3+year:1900+year;break;default:throw new Error(locale.text("date.badYear",format.substring(j)))}}}),_make(year,month,day)}var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),_dateInfo=locale.getDatetimeInfo;exports.validate=function(value,constraints,errors){if(value==null){if(constraints.$isMandatory)return errors.push(locale.text("date.valMan"));if(!constraints.$isNullable)return errors.push(locale.text("date.valNull"));return}if(!(value instanceof DateObj)){errors.push(locale.text("date.valDate"));return}if(!(value.month>=1&&value.month<=12)){errors.push(locale.text("date.invMonth"));return}if(!(value.day>=1&&value.day<=_daysInMonth(value.year,value.month))){errors.push(locale.text("date.invDay"));return}};var _monthOffsets=[0,31,59,90,120,151,181,212,243,273,304,334],_monthLengths=[31,28,31,30,31,30,31,31,30,31,30,31];exports.amDesignator=_amDesignator,exports.pmDesignator=_pmDesignator,utils.defineClass(DateObj,null,{year:{get:function(){return Math.floor(this._value/1e4)}},month:{get:function(){return Math.floor(this._value/100)%100}},day:{get:function(){return this._value%100}},weekDay:{get:function(){return(2440589+_toOffset(this))%7}},yearDay:{get:function(){var month=this.month,leap=month>2&&_isLeap(this.year)?1:0;return _monthOffsets[month-1]+leap+this.day}},week:{get:function(){var begOfWeek1=_make(this.year,1,4).begOfWeek(1);return Math.floor((7+_toOffset(this)-_toOffset(begOfWeek1))/7)}},valueOf:function(){return this.toString()},compare:function(date){return this._value-date._value},equals:function(date){return this._value===date._value},between:function(begin,end){return begin._value<=this._value&&this._value<=end._value},isLeapYear:function(){return _isLeap(this.year)},isWorkDay:function(){return _isWorkDay(this.weekDay)},daysInMonth:function(){return _daysInMonth(this.year,this.month)},begOfYear:function(){return _make(this.year,1,1)},endOfYear:function(){return _make(this.year,12,31)},begOfQuarter:function(){return _make(this.year,Math.floor((this.month-1)/3)*3+1,1)},endOfQuarter:function(){return this.begOfQuarter().addMonths(2).endOfMonth()},begOfMonth:function(){return _make(this.year,this.month,1)},endOfMonth:function(){return _make(this.year,this.month,this.daysInMonth())},sameMonth:function(day){return day=Math.min(day,this.daysInMonth()),_make(this.year,this.month,day)},pastDay:function(day,includeThis){var delta=day-this.day;return delta>0||delta==0&&!includeThis?this.addMonths(-1).sameMonth(day):this.sameMonth(day)},futureDay:function(day,includeThis){var delta=day-this.day;return delta<0||delta==0&&!includeThis?this.addMonths(1).sameMonth(day):this.sameMonth(day)},pastMonth:function(month,includeThis){var delta=this.month-month;return delta=delta==0?includeThis?0:12:delta>0?delta:delta+12,this.addMonths(-delta)},futureMonth:function(month,includeThis){var delta=month-this.month;return delta=delta==0?includeThis?0:12:delta>0?delta:delta+12,this.addMonths(delta)},begOfWeek:function(startDay){var delta=this.weekDay-(startDay||0);return delta==0?this:delta>0?this.addDays(-delta):this.addDays(-delta-7)},endOfWeek:function(startDay){return this.begOfWeek(startDay).addDays(6)},sameWeek:function(weekDay,startDay){return this.begOfWeek(startDay).futureWeekDay(weekDay,!0)},pastWeekDay:function(weekDay,includeThis){var result=this.begOfWeek(weekDay);return!includeThis&&result.equals(this)?this.addWeeks(-1):result},futureWeekDay:function(weekDay,includeThis){return this.pastWeekDay(weekDay,!includeThis).addWeeks(1)},addYears:function(years){if(years==0)return this;var year=this.year+years,month=this.month,day=Math.min(this.day,_daysInMonth(year,month));return _make(year,month,day)},addMonths:function(months){if(months==0)return this;var self=this,day=self.day,month0=self.month-1,year=self.year;month0+=months,year+=Math.floor(month0/12);var month=(month0+12e4)%12+1,monthLen=_daysInMonth(year,month);return day=day<monthLen?day:monthLen,_make(year,month,day)},addWeeks:function(weeks){return this.addDays(7*weeks)},addDays:function(days){return days==0?this:_fromOffset(_toOffset(this)+days)},daysDiff:function(date){return _toOffset(this)-_toOffset(date)},add:function(delta){return this.addYears(delta.years||0).addMonths(delta.months||0).addWeeks(delta.weeks||0).addDays(delta.days||0)},toString:function(format){var self=this;if(format==null){var str=self._value.toString();return str=_padLeft(str,8,"0"),str.substring(0,4)+"-"+str.substring(4,6)+"-"+str.substring(6,8)}var result="";return _walkFormat(format,{literal:function(lit){result+=lit},d:function(repeat){switch(repeat){case 1:result+=self.day.toString();break;case 2:result+=_pad2(self.day);break;case 3:result+=_dayName(self.weekDay,!0);break;case 4:result+=_dayName(self.weekDay);break;default:throw new Error(locale.text("date.formatd",repeat))}},M:function(repeat){switch(repeat){case 1:result+=self.month.toString();break;case 2:result+=_pad2(self.month);break;case 3:result+=_monthName(self.month,!0);break;case 4:result+=_monthName(self.month);break;default:throw new Error(locale.text("date.formatM",repeat))}},y:function(repeat){switch(repeat){case 2:result+=self.year.toString().substring(2,4);break;case 4:result+=self.year.toString();break;default:throw new Error(locale.text("date.formatM",repeat))}}}),result},at:function(time,millisecond){throw new Error(locale.text("date.notInstalled"))},toJsDate:function(utc){return utc?new Date(Date.UTC(this.year,this.month-1,this.day)):new Date(this.year,this.month-1,this.day)},isNull:function(){return this._value==0}}),exports.monthName=_monthName,exports.monthFromName=function(name){var n=_dateInfo().monthNames,m=_dateInfo().abbreviatedMonthNames,s=name.toLowerCase();for(var i=0;i<n.length;i++)if(n[i].toLowerCase()==s||m[i].toLowerCase()==s)return i+1;return-1},exports.dayName=_dayName,exports.weekDayFromName=function(name){var n=_dateInfo().dayNames,m=_dateInfo().abbreviatedDayNames,o=_dateInfo().shortestDayNames,s=name.toLowerCase();for(var i=0;i<n.length;i++)if(n[i].toLowerCase()==s||m[i].toLowerCase()==s)return i;return-1},exports.isLeap=_isLeap,exports.daysInMonth=_daysInMonth,exports.today=function(utc){return exports.fromJsDate(new Date,utc)},exports.parse=function(str,format){if(str==null)throw new Error(locale.text("date.dateNull"));if(format==null){if(str.length!=10)throw new Error(locale.text("date.badFormat",str));var value=parseInt(str.replace(/-/g,""),10);return new DateObj(value)}return _parse(str,format)},exports.walkFormat=_walkFormat,exports.fromJsDate=function(jsDate,utc){return utc?_make(jsDate.getUTCFullYear(),jsDate.getUTCMonth()+1,jsDate.getUTCDate()):_make(jsDate.getFullYear(),jsDate.getMonth()+1,jsDate.getDate())},exports.fromInternalValue=function(value){return new DateObj(value)},exports.makeInWeek=function(year,week,wday){var dday=wday?wday-1:6;return _make(year,1,4).begOfWeek(1).addDays(7*(week-1)+dday)},exports.isDate=function(obj){return obj instanceof DateObj},exports.sunday=0,exports.Sunday=0,exports.monday=1,exports.Monday=1,exports.tuesday=2,exports.Tuesday=2,exports.wednesday=3,exports.Wednesday=3,exports.thursday=4,exports.Thursday=4,exports.friday=5,exports.Friday=5,exports.saturday=6,exports.Saturday=6,exports.make=_make,exports.getLocalShortDate=function(dateISOString){if(!dateISOString||dateISOString.length<6)return"";var tmp=dateISOString.split("-"),d=_make(+tmp[0],+tmp[1],+tmp[2]);return d.toString(locale.getDateFormat())}}),define("syracuse-tablet/html/js/helpers/types/time",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){function Time(value){value=(value+31536e7)%86400,this._value=value}function _pad2(val){var s=val.toString();return s.length==1?"0"+s:s}function _parse2(str,beg,end){return parseInt(str.substring(beg,end),10)}function _make(hour,minute,second){return new Time(hour*3600+(minute||0)*60+(second||0))}function _amDesignator(){return _dateInfo().amDesignator||"AM"}function _pmDesignator(){return _dateInfo().pmDesignator||"AM"}function _walkFormat(format,map){function count(i){var ch=format[i],k=1;while(format[i+k]===ch)k++;return k}var i=0,len=format.length;while(i<len){var c=format[i];switch(c){case"'":i++;var literal="";for(;i<len;i++)if(format[i]==="'"){i++;if(format[i]!=="'")break;literal+="'"}else literal+=format[i];map.literal(literal);break;case"H":case"h":case"m":case"s":case"t":var repeat=count(i);map[c](repeat),i+=repeat;break;default:map.literal(c),i++}}}function _parse(str,format){function parseInteger(max){if(!/\d/.test(str[j]))throw new Error(locale.text("time.noNumber",str.substring[j]));var beg=j++;while(j<beg+max&&/\d/.test(str[j]))j++;return parseInt(str.substring(beg,j),10)}function parseName(names){for(var k=0;k<names.length;k++){var name=names[k],len=name.length;if(str.substring(j,j+len).toUpperCase()==name.toUpperCase())return j+=len,k}throw new Error(locale.text("time.unknown",str.substring(j)))}function from12to24(mode,index){switch(mode[index]){case mode[0]:hour=hour===12?0:hour;break;case mode[1]:hour>=1&&hour<=11&&(hour+=12)}}var hour,minute,second,timeMode,abbrTimeMode,timeModes=[_amDesignator(),_pmDesignator()],abbrTimeModes=[timeModes[0].substring(0,1),timeModes[1].substring(0,1)],j=0;_walkFormat(format,{literal:function(literal){if(str.substring(j,j+literal.length)!==literal)throw new Error(locale.text("time.wrongFormat",literal,str.substring(j)));j+=literal.length},H:function(arg){switch(arg){case 1:case 2:hour=parseInteger(2);break;default:throw new Error(locale.text("time.badHour",format.substring(j)))}},h:function(arg){switch(arg){case 1:case 2:hour=parseInteger(2);break;default:throw new Error(locale.text("time.badHour",format.substring(j)))}},m:function(arg){switch(arg){case 2:minute=parseInteger(2);break;default:throw new Error(locale.text("time.badMin",format.substring(j)))}},s:function(arg){switch(arg){case 2:second=parseInteger(2);break;default:throw new Error(locale.text("time.badSec",format.substring(j)))}},t:function(arg){switch(arg){case 1:abbrTimeMode=parseName(abbrTimeModes);break;case 2:timeMode=parseName(timeModes);break;default:throw new Error(locale.text("time.badMarker",format.substring(j)))}}});if(timeMode!=null||abbrTimeMode!=null){if(hour>12)throw new Error(locale.text("time.badHourVal",hour,timeMode));var mode=timeMode!=null?timeModes:abbrTimeModes,index=timeMode!=null?timeMode:abbrTimeMode;from12to24(mode,index)}return _make(hour,minute,second)}var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),_dateInfo=locale.getDatetimeInfo;exports.validate=function(value,constraints,errors){if(value==null){if(constraints.$isMandatory)return errors.push(locale.text("time.valMan"));if(!constraints.$isNullable)return errors.push(locale.text("time.valNull"));return}if(!(value instanceof Time)){errors.push(locale.text("time.valTime"));return}},utils.defineClass(Time,null,{hour:{get:function(){return Math.floor(this._value/3600)}},minute:{get:function(){return Math.floor(this._value/60)%60}},second:{get:function(){return this._value%60}},value:{get:function(){return this._value}},valueOf:function(){return this.toString()},compare:function(time){return this._value-time._value},equals:function(time){return this._value===time._value},between:function(begin,end){return begin._value<=this._value&&this._value<=end._value},begOfDay:function(){return _make(0,0,0)},endOfDay:function(){return _make(23,59,59)},begOfHour:function(){return _make(this.hour,0,0)},endOfHour:function(){return _make(this.hour,59,59)},begOfMinute:function(){return _make(this.hour,this.minute,0)},endOfMinute:function(){return _make(this.hour,this.minute,59)},toString:function(format){var self=this;if(format==null)return _pad2(self.hour)+":"+_pad2(self.minute)+":"+_pad2(self.second);var result="";return _walkFormat(format,{literal:function(lit){result+=lit},H:function(repeat){switch(repeat){case 1:result+=self.hour;break;case 2:result+=_pad2(self.hour);break;default:throw new Error(locale.text("time.formatH",repeat))}},h:function(repeat){switch(repeat){case 1:var hour=self.hour;hour===0?result+=12:result+=hour>12?hour-12:hour;break;case 2:var hour=self.hour;hour===0?result+=12:result+=hour>12?_pad2(hour-12):_pad2(hour);break;default:throw new Error(locale.text("time.formath",repeat))}},m:function(repeat){switch(repeat){case 2:result+=_pad2(self.minute);break;default:throw new Error(locale.text("time.formatm",repeat))}},s:function(repeat){switch(repeat){case 2:result+=_pad2(self.second);break;default:throw new Error(locale.text("time.formats",repeat))}},t:function(repeat){switch(repeat){case 1:result+=self.hour<12?_amDesignator().substring(0,1):_pmDesignator().substring(0,1);break;case 2:result+=self.hour<12?_amDesignator():_pmDesignator();break;default:throw new Error(locale.text("time.formata",repeat))}}}),result},secondsDiff:function(t){return this._value-t._value},addHours:function(hours){return hours==0?this:new Time(this._value+hours*3600)},addMinutes:function(minutes){return minutes==0?this:new Time(this._value+minutes*60)},addSeconds:function(seconds){return seconds==0?this:new Time(this._value+seconds)},add:function(delta){return this.addHours(delta.hours||0).addMinutes(delta.minutes||0).addSeconds(delta.seconds||0)},isNull:function(){return this._value==0}}),exports.make=_make,exports.fromSeconds=function(seconds){return new Time(seconds)},exports.fromJsDate=function(js,utc){return utc?_make(js.getUTCHours(),js.getUTCMinutes(),js.getUTCSeconds()):_make(js.getHours(),js.getMinutes(),js.getSeconds())},exports.now=function(utc){return exports.fromJsDate(new Date,utc)},exports.parse=function(str,format){if(str==null)throw new Error(locale.text("time.isNull"));if(format==null){if(str.length!=5&&str.length!=8)throw new Error(locale.text("time.badFormat",str));var value=str.length==8?_parse2(str,0,2)*3600+_parse2(str,3,5)*60+_parse2(str,6,8):_parse2(str,0,2)*3600+_parse2(str,3,5)*60;return new Time(value)}return _parse(str,format)},exports.amDesignator=_amDesignator,exports.pmDesignator=_pmDesignator}),define("syracuse-tablet/html/js/helpers/types/datetime",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/types/date","syracuse-tablet/html/js/helpers/types/time","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){function _pad2(val){var s=val.toString();return s.length==1?"0"+s:s}function _pad3(val){var s=val.toString();switch(s.length){case 1:return"00"+s;case 2:return"0"+s;default:return s}}function Datetime(value,tzOffset){this._value=value,tzOffset!=null&&(this._tzOffset=tzOffset)}function _ms(dt){return(dt._value+63072e9)%1e3}function _utc(dt){var utc=dt._utc;if(!utc){var d=new Date(dt._value);utc=d.getUTCFullYear()*1e4*1e5+(d.getUTCMonth()+1)*100*1e5+d.getUTCDate()*1e5+d.getUTCHours()*3600+d.getUTCMinutes()*60+d.getUTCSeconds(),d._utc=utc}return utc}function _local(dt){var local=dt._local;if(!local){var d=new Date(dt._value);local=d.getFullYear()*1e4*1e5+(d.getMonth()+1)*100*1e5+d.getDate()*1e5+d.getHours()*3600+d.getMinutes()*60+d.getSeconds(),d._local=local}return local}function _formatTzOffset(offset,len){var s="-";offset<0&&(s="+",offset=-offset);var hr=Math.round(offset/60),min=offset-hr*60;return s+=len>1?_pad2(hr):hr,s+=len>2||min?":"+(len>1?_pad2(min):min):"",s}function _parseIso(str){var year=0,month=0,day=0,hours=0,minutes=0,seconds=0,ms=0,offset=0,convertError=!0,d=/(\d{4})-(\d{2})-(\d{2})([T\s]?)(\d{2})?(:)?(\d{2})?(:)?(\d{2})?(\.(\d{3}))?(Z)?(([+-])(\d{2}))?(.*$)/.exec(str);if(d){convertError=!1,year=+d[1],month=d[2]-1,day=+d[3],hours=+(d[5]||0),minutes=+(d[7]||0),seconds=+(d[9]||0),ms=+(d[11]||0);if(d[12]==="Z"){d[14]==="-"?offset=(d[15]||0)*60:d[14]==="+"&&(offset=-(d[15]||0)*60);var utc=Date.UTC(year,month,day,hours,minutes+offset,seconds,ms);return new Datetime(utc)}var jsDate=new Date(year,month,day,hours,minutes+offset,seconds,ms);return new Datetime(jsDate.getTime(),jsDate.getTimezoneOffset())}if(convertError)throw new Error(locale.text("datetime.noParse",str))}function _make(year,month,day,hour,minute,second,millis){var jsDate=new Date(year,month-1,day,hour||0,minute||0,second||0,millis||0);return new Datetime(jsDate.getTime(),jsDate.getTimezoneOffset())}function _makeUtc(year,month,day,hour,minute,second,millis){var jsDate=new Date(Date.UTC(year,month-1,day,hour||0,minute||0,second||0,millis||0));return new Datetime(jsDate.getTime(),jsDate.getTimezoneOffset())}function _walkFormat(format,map){function count(i){var ch=format[i],k=1;while(format[i+k]===ch)k++;return k}var i=0,len=format.length;while(i<len){var c=format[i];switch(c){case"'":i++;var literal="";for(;i<len;i++)if(format[i]==="'"){i++;if(format[i]!=="'")break;literal+="'"}else literal+=format[i];map.literal(literal);break;case"H":case"h":case"m":case"s":case"S":case"t":case"d":case"M":case"y":var repeat=count(i);map[c](repeat),i+=repeat;break;default:map.literal(c),i++}}}function _parse(str,format){function parseInteger(max){if(!/\d/.test(str[j]))throw new Error(locale.text("datetime.noNumber",str.substring[j]));var beg=j++;while(j<beg+max&&/\d/.test(str[j]))j++;return parseInt(str.substring(beg,j),10)}function parseName(names){for(var k=0;k<names.length;k++){var name=names[k],len=name.length;if(str.substring(j,j+len).toUpperCase()==name.toUpperCase())return j+=len,k}throw new Error(locale.text("datetime.unknown",str.substring(j)))}function from12to24(mode,index){switch(mode[index]){case mode[0]:hour=hour===12?0:hour;break;case mode[1]:hour>=1&&hour<=11&&(hour+=12)}}var day,weekday,month,year,hour,minute,second,millis,timeMode,abbrTimeMode,timeModes=[date.amDesignator(),date.pmDesignator()],abbrTimeModes=[timeModes[0].substring(0,1),timeModes[1].substring(0,1)],j=0;_walkFormat(format,{literal:function(literal){if(str.substring(j,j+literal.length)!==literal)throw new Error(locale.text("datetime.formatMis",literal,str.substring(j)));j+=literal.length},d:function(arg){switch(arg){case 1:case 2:day=parseInteger(2);break;case 3:weekday=parseName(_dateInfo().abbreviatedDayNames);break;case 4:weekday=parseName(_dateInfo().dayNames);break;default:throw new Error(locale.text("datetime.badDay",format.substring(j)))}},M:function(arg){switch(arg){case 1:case 2:month=parseInteger(2);break;case 3:month=parseName(_dateInfo().abbreviatedMonthNames)+1;break;case 4:month=parseName(_dateInfo().monthNames)+1;break;default:throw new Error(locale.text("datetime.badDay",format.substring(j)))}},y:function(arg){switch(arg){case 2:year=parseInteger(2),year=year<40?2e3+year:1900+year;break;case 4:year=parseInteger(4),year=year>99?year:year<40?2e3+year:1900+year;break;default:throw new Error(locale.text("datetime.badYear",format.substring(j)))}},H:function(arg){switch(arg){case 1:case 2:hour=parseInteger(2);break;default:throw new Error(locale.text("datetime.badHour",format.substring(j)))}},h:function(arg){switch(arg){case 1:case 2:hour=parseInteger(2);break;default:throw new Error(locale.text("datetime.badHour",format.substring(j)))}},m:function(arg){switch(arg){case 2:minute=parseInteger(2);break;default:throw new Error(locale.text("datetime.badMin",format.substring(j)))}},s:function(arg){switch(arg){case 2:second=parseInteger(2);break;default:throw new Error(locale.text("datetime.badSec",format.substring(j)))}},t:function(arg){switch(arg){case 1:abbrTimeMode=parseName(abbrTimeModes);break;case 2:timeMode=parseName(timeModes);break;default:throw new Error(locale.text("datetime.badMarker",format.substring(j)))}}});if(timeMode!=null||abbrTimeMode!=null){if(hour>12)throw new Error(locale.text("datetime.badHourVal",hour,timeMode));var mode=timeMode!=null?timeModes:abbrTimeModes,index=timeMode!=null?timeMode:abbrTimeMode;from12to24(mode,index)}return _make(year,month,day,hour,minute,second,millis)}function _getIndexOfZ(format){function count(i){var ch=format[i],k=1;while(format[i+k]===ch)k++;return k}var i=0,len=format.length;while(i<len){var c=format[i];if(c==="'"){i++;var literal="";for(;i<len;i++)if(format[i]==="'"){i++;if(format[i]!=="'")break;literal+="'"}else literal+=format[i]}else{if(c==="Z")return i;i++}}}var utils=require("syracuse-tablet/html/js/helpers/utils"),date=require("syracuse-tablet/html/js/helpers/types/date"),time=require("syracuse-tablet/html/js/helpers/types/time"),locale=require("syracuse-tablet/html/js/helpers/locale"),_dateInfo=locale.getDatetimeInfo;exports.validate=function(value,constraints,errors){if(value==null){if(constraints.$isMandatory)return errors.push(locale.text("datetime.valMand"));if(!constraints.$isNullable)return errors.push(locale.text("datetime.valNull"));return}if(!(value instanceof Datetime)){errors.push(locale.text("datetime.valDT"));return}if(!(value.month>=1&&value.month<=12)){errors.push(locale.text("datetime.valMon"));return}if(!(value.day>=1&&value.day<=date.daysInMonth(value.year,value.month))){errors.push(locale.text("datetime.valDay"));return}},exports.Datetime=utils.defineClass(Datetime,null,{date:{get:function(){return date.fromInternalValue(Math.floor(_local(this)/1e5))}},time:{get:function(){return time.fromSeconds(_local(this)%1e5)}},year:{get:function(){return this.date.year}},month:{get:function(){return this.date.month}},day:{get:function(){return this.date.day}},weekDay:{get:function(){return this.date.weekDay}},yearDay:{get:function(){return this.date.yearDay}},hour:{get:function(){return this.time.hour}},minute:{get:function(){return this.time.minute}},second:{get:function(){return this.time.second}},millisecond:{get:function(){return _ms(this)}},utcDate:{get:function(){return date.fromInternalValue(Math.floor(_utc(this)/1e5))}},utcTime:{get:function(){return time.fromSeconds(_utc(this)%1e5)}},utcYear:{get:function(){return this.utcDate.year}},utcMonth:{get:function(){return this.utcDate.month}},utcDay:{get:function(){return this.utcDate.day}},utcWeekDay:{get:function(){return this.utcDate.weekDay}},utcYearDay:{get:function(){return this.utcDate.yearDay}},utcHour:{get:function(){return this.utcTime.hour}},utcMinute:{get:function(){return this.utcTime.minute}},utcSecond:{get:function(){return this.utcTime.second}},utcMillisecond:{get:function(){return _ms(this)}},value:{get:function(){return this._value}},timezoneOffset:{get:function(){return this._tzOffset==null&&(this._tzOffset=this.toJsDate().getTimezoneOffset()),this._tzOffset}},compare:function(dt){return this._value-dt._value},equals:function(dt){return this._value===dt._value},between:function(begin,end){return begin._value<=this._value&&this._value<=end._value},addYears:function(years){return this.date.addYears(years).at(this.time,this.millisecond)},addMonths:function(months){return this.date.addMonths(months).at(this.time,this.millisecond)},addWeeks:function(weeks){return this.date.addWeeks(weeks).at(this.time,this.millisecond)},addDays:function(days){return this.date.addDays(days).at(this.time,this.millisecond)},addHours:function(hours){return new Datetime(this._value+hours*3600*1e3)},addMinutes:function(minutes){return new Datetime(this._value+minutes*60*1e3)},addSeconds:function(seconds){return new Datetime(this._value+seconds*1e3)},addMilliseconds:function(millis){return new Datetime(this._value+millis)},addDayFractions:function(fraction){return new Datetime(this._value+fraction*86400*1e3)},millisDiff:function(dt){return this._value-dt._value},begOfMonth:function(){return _make(this.year,this.month,1)},begOfWeek:function(startDay){var delta=this.weekDay-(startDay||0);return delta==0?this:delta>0?this.addDays(-delta):this.addDays(-delta-7)},add:function(delta){return this.addYears(delta.years||0).addMonths(delta.months||0).addWeeks(delta.weeks||0).addDays(delta.days||0).addHours(delta.hours||0).addMinutes(delta.minutes||0).addSeconds(delta.seconds||0).addMillis(delta.millis||0)},toString:function(format){var self=this;if(format==null)return(new Date(this._value)).toISOString();var utc=_getIndexOfZ(format),_date=utc?self.utcDate:self.date,_time=utc?self.utcTime:self.time,result="";return _walkFormat(format,{literal:function(lit){result+=lit},H:function(repeat){switch(repeat){case 1:result+=_time.hour.toString();break;case 2:result+=_pad2(_time.hour);break;default:throw new Error(locale.text("datetime.formatH",repeat))}},h:function(repeat){switch(repeat){case 1:result+=_time.hour<13?_time.hour:_time.hour-12;break;case 2:result+=_pad2(_time.hour<13?_time.hour:_time.hour-12);break;default:throw new Error(locale.text("datetime.formath",repeat))}},m:function(repeat){switch(repeat){case 2:result+=_pad2(_time.minute);break;default:throw new Error(locale.text("datetime.formatm",repeat))}},s:function(repeat){switch(repeat){case 2:result+=_pad2(self.second);break;default:throw new Error(locale.text("datetime.formats",repeat))}},t:function(repeat){switch(repeat){case 1:result+=self.hour<12?_dateInfo().amDesignator.substring(0,1):_dateInfo().pmDesignator.substring(0,1);break;case 2:result+=self.hour<12?_dateInfo().amDesignator:_dateInfo().pmDesignator;break;default:throw new Error(locale.text("datetime.formata",repeat))}},d:function(repeat){switch(repeat){case 1:result+=_date.day.toString();break;case 2:result+=_pad2(_date.day);break;case 3:result+=date.dayName(_date.weekDay,!0);break;case 4:result+=date.dayName(_date.weekDay);break;default:throw new Error(locale.text("datetime.formatd",repeat))}},M:function(repeat){switch(repeat){case 1:result+=_date.month.toString();break;case 2:result+=_pad2(_date.month);break;case 3:result+=date.monthName(_date.month,!0);break;case 4:result+=date.monthName(_date.month);break;default:throw new Error(locale.text("datetime.formatM",repeat))}},y:function(repeat){switch(repeat){case 2:result+=_date.year.toString().substring(2,4);break;case 4:result+=_date.year.toString();break;default:throw new Error(locale.text("datetime.formaty",repeat))}},S:function(repeat){repeat===3?result+=_pad3(self.millisecond):new Error(locale.text("datetime.formatS",repeat))}}),result},toJsDate:function(){return new Date(this._value)},withoutTimezoneOffset:function(){return new Datetime(this._value)},isNull:function(){return this._value==0}}),exports.now=function(withMillis){var jsDate=new Date,millis=jsDate.getTime();return withMillis||(millis=Math.floor(millis/1e3)*1e3),new Datetime(millis,jsDate.getTimezoneOffset())},exports.parse=function(str,format){if(str==null)throw new Error(locale.text("datetime.isNull"));return format==null?_parseIso(str):_parse(str,format)},exports.fromJsDate=function(jsDate){return new Datetime(jsDate.getTime(),jsDate.getTimezoneOffset())},exports.isDatetime=function(obj){return obj instanceof Datetime},exports.fromInternalValue=function(value){return new Datetime(value)},exports.dayName=function(weekDay,abbrev){return abbrev?_dateInfo().abbreviatedDayNames[weekDay]:_dateInfo().dayNames[weekDay]},exports.monthName=function(month,abbrev){return abbrev?_dateInfo().abbreviatedMonthNames[month-1]:_dateInfo().monthNames[month-1]},exports.make=_make,exports.makeUtc=_makeUtc,date.make(1,1,1).constructor.prototype.at=function(time,millisecond){return exports.make(this.year,this.month,this.day,time.hour,time.minute,time.second,millisecond)},exports.sunday=0,exports.Sunday=0,exports.monday=1,exports.Monday=1,exports.tuesday=2,exports.Tuesday=2,exports.wednesday=3,exports.Wednesday=3,exports.thursday=4,exports.Thursday=4,exports.friday=5,exports.Friday=5,exports.saturday=6,exports.Saturday=6,exports.walkFormat=_walkFormat}),define("syracuse-tablet/html/js/helpers/types/numberFormat",["require","exports","module","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){function FormatObj(prefix,postfix,properties){this.prefix=prefix,this.postfix=postfix,this.properties=properties}function _processDirective(directive,fObj){var f=new FormatObj(fObj.prefix,fObj.postfix,fObj.properties),hasDecimalSeparator,hasGroupSeparator,dsIndex=directive.indexOf("."),gsIndex=directive.indexOf(",");f.properties.hasDecimalSeparator=hasDecimalSeparator=dsIndex>-1,f.properties.hasGroupSeparator=hasGroupSeparator=gsIndex>-1;if(hasDecimalSeparator){var decimal=directive.substring(dsIndex+1);f.properties.mandatoryAfter=decimal.indexOf("0")>-1?decimal.match(/0/g).length:0,f.properties.maxAfter=decimal.length}hasGroupSeparator&&(f.properties.groupSize=hasDecimalSeparator?dsIndex-gsIndex-1:directive.substring(gsIndex+1).length);var integer=hasDecimalSeparator?directive.substring(0,dsIndex):directive;return f.properties.mandatoryBefore=integer.indexOf("0")>-1?integer.match(/0/g).length:0,f.properties.directive=directive,f.properties.hasPercent=directive.indexOf("%")>-1,f.properties.hasPermil=directive.indexOf("‰")>-1,f.properties.hasSignFormat=directive.indexOf("+")>-1&&directive.indexOf("+")===0,f}function _walkFormat(format,map){function count(i){var ch=format[i],k=1;while(validDir.indexOf(format[i+k])>-1)k++;return k}var i=0,len=format.length,validDir="0#.,%‰+";while(i<len){var c=format[i];switch(c){case"'":i++;var literal="";for(;i<len;i++)if(format[i]==="'"){i++;if(format[i]!=="'")break;literal+="'"}else literal+=format[i];map.literal(literal);break;case"0":case"#":case".":case"%":case"‰":case"+":var directiveLength=count(i);map.directive(i,i+directiveLength),i+=directiveLength;break;case";":map.listSeparator(),i++;break;default:map.literal(c),i++}i===len&&map.listSeparator()}}function _addSeparator(num,gs,size){var result="",len=num.length,c="",count=0;for(var i=len-1;i>=0;i--)c=num[i],result+=c,++count,count%size===0&&i>0&&(result+=gs);return result.split("").reverse().join("")}function _format(val,format){var prefix,postfix,j=0,formatsList=[],directiveProcessed=!1,f=new FormatObj("","",{});_walkFormat(format,{literal:function(literal){directiveProcessed?f.postfix+=literal:f.prefix+=literal},directive:function(beg,end){var directive=format.substring(beg,end);f=_processDirective(directive,f),directiveProcessed=!0},listSeparator:function(){directiveProcessed=!1,formatsList.push(f),f=new FormatObj("","",{}),prefix="",postfix=""}});var flen=formatsList.length;switch(flen){case 1:return _formatNumber(val,formatsList[0]);case 2:case 3:return val===0?_formatZero(formatsList[2]):val<0?_formatNumber(val.toString().substring(1),formatsList[1]):_formatNumber(val,formatsList[0]);default:throw new Error(flen===0?locale.text("numberFormat.noFormat"):locale.text("numberFormat.manyFormat"))}}function _formatZero(fObj){return fObj.prefix}function _formatNumber(num,fObj){var res="",gs=locale.getNumberGroupSeparator(),ds=locale.getNumberDecimalSeparator(),directive=fObj.properties.directive;num=fObj.properties.hasPercent?num*100:num,num=fObj.properties.hasPermil?num*1e3:num;if(directive==null)return num;if(fObj.properties.hasDecimalSeparator){var decimalPart="",maxAfter=fObj.properties.maxAfter,decimalFormat=directive.substr(directive.indexOf(".")+1,maxAfter),decimalValue=num%1,decimalString=""+decimalValue.toFixed(maxAfter);decimalString=decimalString.substring(decimalString.indexOf(".")+1);for(var i=0;i<maxAfter;i++){var f=decimalFormat.charAt(i),n=decimalString.charAt(i);if(f==="0")decimalPart+=n;else if(f==="#"&&n!=="0")decimalPart+=n;else if(f==="#"&&n==="0"){var notParsed=decimalString.substring(i);if(!notParsed.match("[1-9]"))break;decimalPart+=n}}res=decimalPart?ds+decimalPart:res}else num=Math.round(num);var intPart=num<0?""+Math.ceil(num):""+Math.floor(num);intPart=intPart.replace(/[^\d]+/g,"");var intFormat=directive.indexOf(".")===-1?directive:directive.substring(0,directive.indexOf("."));if(intPart.length<fObj.properties.mandatoryBefore){var missing=fObj.properties.mandatoryBefore-intPart.length,toAdd="";for(var i=0;i<missing;i++)toAdd+="0";intPart=toAdd+intPart}return fObj.properties.hasGroupSeparator&&fObj.properties.groupSize<intPart.length&&(intPart=_addSeparator(intPart,gs,fObj.properties.groupSize)),intPart=parseInt(intPart,10)===0&&fObj.properties.mandatoryBefore===0?"":intPart,intPart=intPart&&num<0?"-"+intPart:intPart,res=intPart+res,res=fObj.properties.hasSignFormat&&num>0?"+"+res:res,res+=fObj.properties.hasPercent?"%":"",res+=fObj.properties.hasPermil?"‰":"",fObj.prefix+res+fObj.postfix}function _parse(str,format){var prefix,postfix,j=0,formatsList=[],directiveProcessed=!1,f=new FormatObj("","",{});return _walkFormat(format,{literal:function(literal){directiveProcessed?f.postfix+=literal:f.prefix+=literal},directive:function(beg,end){var directive=format.substring(beg,end);f=_processDirective(directive,f),directiveProcessed=!0},listSeparator:function(){directiveProcessed=!1,formatsList.push(f),f=new FormatObj("","",{}),prefix="",postfix=""}}),_parseFormats(str,formatsList)}function _parseFormats(str,formatsList,negative){var flen=formatsList.length,num,gs=locale.getNumberGroupSeparator(),ds=locale.getNumberDecimalSeparator();switch(flen){case 1:var fObj=formatsList[0],formatNumber=str,integerPart,decimalPart,prefix=fObj.prefix,postfix=fObj.postfix;formatNumber=prefix?formatNumber.substring(prefix.length):formatNumber,formatNumber=postfix?formatNumber.substring(0,formatNumber.length-postfix.length):formatNumber;var splitted=formatNumber.split(ds);if(splitted.length>2)throw new Error(locale.text("numberFormat.oneSep",formatNumber));integerPart=splitted[0]?splitted[0].match(/[0-9]/g).join(""):"0",decimalPart=splitted.length>1?splitted[1].match(/[0-9]/g).join(""):"",num=parseFloat(decimalPart?integerPart+"."+decimalPart:integerPart),num=formatNumber.charAt(0)==="-"?parseFloat("-"+num):num,num=fObj.properties.hasPercent?num/100:num,num=fObj.properties.hasPermil?num/1e3:num,num=negative?parseFloat("-"+num):num;break;case 2:case 3:var validFormat="1234567890"+ds+gs+"%‰-+",len=formatsList.length,slen=str.length;for(var i=0;i<len;i++){var f=formatsList[i],prefix=f.prefix,postfix=f.postfix,prefixDefined=prefix?!0:!1,postfixDefined=postfix?!0:!1,pre,post;pre=prefixDefined?str.substring(0,prefix.length):"",post=postfixDefined?str.substring(slen-postfix.length):"";if(prefixDefined&&!postfixDefined&&pre.indexOf(prefix)>-1||prefixDefined&&postfixDefined&&pre.indexOf(prefix)>-1&&post.indexOf(postfix)>-1||!prefixDefined&&postfixDefined&&post.indexOf(postfix)>-1||!prefixDefined&&!postfixDefined&&validFormat.indexOf(str.charAt(0))>-1&&validFormat.indexOf(str.charAt(slen-1))>-1)break}var flist=[];flist.push(formatsList[i]);switch(i){case 0:num=_parseFormats(str,flist);break;case 1:num=_parseFormats(str,flist,!0);break;case 2:num=0;break;default:throw new Error(locale.text("numberFormat.cannotParse"))}break;default:throw new Error(flen===0?locale.text("numberFormat.noFormat"):locale.text("numberFormat.manyFormats"))}return num}var locale=require("syracuse-tablet/html/js/helpers/locale");exports.format=function(val,format){if(isNaN(val))throw new Error(locale.text("numberFormat.notNumber",val));if(format==null){val=val.toString();var dsIndex=val.indexOf("."),hasDecimal=dsIndex>-1,intPart=hasDecimal?val.substring(0,dsIndex):val,decimalPart=hasDecimal?val.substring(dsIndex+1):"",gs=locale.getNumberGroupSeparator()||"",ds=hasDecimal?locale.getNumberDecimalSeparator()||".":"";return _addSeparator(intPart,gs,3)+ds+decimalPart}return _format(val,format)},exports.parse=function(str,format){return str?format==null?parseFloat(str):_parse(str,format):0}}),define("syracuse-tablet/html/js/helpers/formatApi",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/types/date","syracuse-tablet/html/js/helpers/types/datetime","syracuse-tablet/html/js/helpers/types/time","syracuse-tablet/html/js/helpers/types/numberFormat"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),date=require("syracuse-tablet/html/js/helpers/types/date"),datetime=require("syracuse-tablet/html/js/helpers/types/datetime"),time=require("syracuse-tablet/html/js/helpers/types/time"),numberFormat=require("syracuse-tablet/html/js/helpers/types/numberFormat"),_cache={},_cacheLocaleHash;exports.getFormatter=function($type,$format){if($format=="$url")return null;var ctor=_formatters[$type];if(!ctor)return null;var curLocaleHash=locale.getCurrentLocaleHash();curLocaleHash!==_cacheLocaleHash&&(_cacheLocaleHash=curLocaleHash,_cache={});var cache=_cache[$type];cache||(cache=_cache[$type]={});var key=$format||"noformat",fmt=cache[key];return fmt?fmt:(fmt=new ctor($type,$format),cache[key]=fmt,fmt)};var Formatter=utils.defineClass(function($type,$format){this.$format=$format,this.$type=$type},null,{_isEmpty:function(value){return value==null?!0:(value=""+value,value=value.trim(),value===""?!0:!1)},formatValue:function(value,editMode){return value},formatValueEdit:function(value){return this.formatValue(value,!0)},parseValue:function(value,errors){errors.push("No parser for this type, return this dummy error to not override value by null")},getFormat:function(){return this.format}}),DateFormatter=utils.defineClass(function($type,$format){Formatter.call(this,$type,$format),this.format=locale.getDateFormat(),this.twoDigitYearSwitch=40},Formatter,{_isEmpty:function(value){return value==null?!0:(value=""+value,value=value.trim(),value===""?!0:value==="0000-00-00"?!0:!1)},_checkShortYear:function(year){if(year.year){var y=year.year;y<100&&year.add({years:y<this.twoDigitYearSwitch?2e3:1900})}else year=year>99?year:year<this.twoDigitYearSwitch?2e3+year:1900+year;return year},formatValue:function(value,editMode){if(this._isEmpty(value))return"";var p=value.split(/[^\d]+/),format;if(p.length>=3){p[0]=this._checkShortYear(+p[0]);var d=date.make(+p[0],+p[1],+p[2]);format=d.toString(this.format)}else format=value;return format},parseValue:function(value,errors){var fmt;if(this._isEmpty(value))return"";try{fmt=date.parse(value,this.format),fmt=this._checkShortYear(fmt)}catch(e){return errors.push(locale.text("field.invalidInput",[this.format])),value}return fmt.toString("yyyy-MM-dd")},validateValue:function(value,errors){var fmt;if(this._isEmpty(value))return"";try{fmt=date.parse(value,this.format),date.validate(fmt,{},errors)}catch(e){errors.push(locale.text("field.invalidInput",[this.format]))}return errors.length===0}}),DateTimeFormatter=utils.defineClass(function($type,$format){DateFormatter.call(this,$type,$format),this.format=locale.getDateTimeFormat()},DateFormatter,{_isEmpty:function(value){return value==null?!0:(value=""+value,value=value.trim(),value===""?!0:value==="0000-00-00T00:00:00Z"?!0:!1)},formatValue:function(value,editMode){if(this._isEmpty(value))return editMode===!0?datetime.now().toString(this.format):"";var p=value.split(/[^\d]+/),format;if(p.length>=6){p[0]=this._checkShortYear(+p[0]);var d=datetime.make(+p[0],+p[1],+p[2],+p[3],+p[4],+p[5]);format=d.toString(this.format)}else format=value;return format},parseValue:function(value,errors){var fmt;if(this._isEmpty(value))return"";try{fmt=datetime.parse(value,this.format),fmt=this._checkShortYear(fmt)}catch(e){return errors.push(locale.text("field.invalidInput",[this.format])),value}return fmt.toString("yyyy-MM-ddTHH:mm:ss.SSS")+"Z"}}),TimeFormatter=utils.defineClass(function($type,$format){Formatter.call(this,$type,$format),this.$format==="TT"?this.format=locale.getTimeFormat():this.format=locale.getTimeFormatShort()},Formatter,{formatValue:function(value,editMode){if(this._isEmpty(value))return"";var p=value.split(/[^\d]+/),format;if(p.length>=2){var t=time.make(+p[0],+p[1],+p[2]);format=t.toString(this.format)}else format=value;return format},parseValue:function(value,errors){if(this._isEmpty(value))return"";var p=value.split(/[^\d]+/);if(p.length>=1){var t=time.make(+p[0],+p[1],+p[2]);return t.toString("HH:mm:ss")}}}),NumberFormatter=utils.defineClass(function($type,$format){Formatter.call(this,$type,$format),this.format=this.$format||locale.getNumberFormat(this.$type)},Formatter,{formatValue:function(value,editMode){if(this._isEmpty(value))return"";var format=numberFormat.format(value,this.format);return format},parseValue:function(value,errors){if(this._isEmpty(value))return"";try{var fmt=numberFormat.parse(value,this.format)}catch(e){return errors.push(locale.text("field.invalidInput",[this.format])),value}return fmt}}),_formatters={"application/x-integer":NumberFormatter,"application/x-decimal":NumberFormatter,"application/x-real":NumberFormatter,"application/x-date":DateFormatter,"application/x-time":TimeFormatter,"application/x-datetime":DateTimeFormatter}}),define("syracuse-tablet/html/js/authoring/arrays/authArrayStatus",["require","exports","module","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral","syracuse-tablet/html/js/authoring/arrays/authArrayGeneral","syracuse-tablet/html/js/authoring/authoringComponents","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/fieldOperators","syracuse-tablet/html/js/helpers/formatApi","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var authPropsGeneral=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),authArrayGeneral=require("syracuse-tablet/html/js/authoring/arrays/authArrayGeneral"),authComponents=require("syracuse-tablet/html/js/authoring/authoringComponents"),locale=require("syracuse-tablet/html/js/helpers/locale"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),utils=require("syracuse-tablet/html/js/helpers/utils"),fieldOperators=require("syracuse-tablet/html/js/helpers/fieldOperators"),formatApi=require("syracuse-tablet/html/js/helpers/formatApi"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_noValue="$$novalue$$",_properties={arrayStatusEnabled:function(controller,sel,data){this.key="$statusEnabled",this.name="arrayStatusEnabled",this["default"]="none",this.values=[{value:"none"},{value:"mono"}],data.control.$display==="card"&&this.values.push({value:"multi"}),this.createMarkup=authPropsGeneral.createMarkupRadio,this.refreshMarkup=authPropsGeneral.refreshMarkupRadio},arrayStatus:function(controller,sel,data){this.name="arrayStatus",this.label=null,this["default"]=null,this.key="$status",this.ctrlArray=data.control,this.isTable=(this.ctrlArray.article.$display||"table")==="table",this._myProperties=[],this.initMarkup=function(controller,sel,data){this._protoValue=this.ctrlArray.getColumnsInfo();var authStatus=data.articleSelection[this.key]||[];this.statusList=[];var self=this,proto;authStatus.forEach(function(c){proto=self.getFieldProto(c.field),proto!=null&&(c=$.extend(!0,{},c),c.id=utils.UUID(),self.statusList.push(c))})},this.getFieldProto=function(bind){var res=null;return this._protoValue.some(function(v,idx){if(v.$bind===bind)return res=v,!0}),res},this.getRecordInfo=function(id){if(!id)return null;var idx=-1,rec=null;return this.statusList.some(function(c,i){if(c.id===id)return rec=c,idx=i,!0}),idx===-1?null:{record:rec,idx:idx}},this.destroyMarkup=function(){this.ctrl=null,this.$$parent=null,this._protoValue=null,this.ctrlArray=null,this._myProperties&&(this._myProperties.forEach(function(p){p.destroyMarkup&&p.destroyMarkup()}),this._myProperties=null)},this.createMarkup=function($$parent,prop,sel,data){this.ctrl=data.control,this.$$parent=$$parent,this.statusListAdd(sel,data),this.editSectionAdd()},this.statusListAdd=function(sel,data){var opts={css:"statuslist",doAction:jsutils.bindFn(this.listCallBackAction,this,sel,data),appendTitle:locale.text("auth.arrayStatus.append")};this.listStatusDisplayer=authComponents.newComponent("editableList",opts),this._addParam("statuslist",this.listStatusDisplayer,!0),this.updateStatusList()},this.editSectionAdd=function(){this.editStatusSection=this._addSubSection("editstatus"),this.editStatusSection.$$panel.hide(),this.editStatusSection.$$content.css("padding-left","7px"),this.editStatusSection.$$title.css("font-weight","bold");var $$rootComponents=this.editStatusSection.$$content;this.paramFieldAdd($$rootComponents),this.paramOperatorAdd($$rootComponents),this.paramValueAdd($$rootComponents),this.paramColorAdd($$rootComponents),this.paramIconAdd($$rootComponents)},this.listCallBackAction=function(action,recordId,listStatusDisplayer,sel,data){if(action==="append")return this._updateParams(null),!0;if(action==="cancel")return this._resetParams(),this.editStatusSection.$$panel.hide(),!0;var recInfo=this.getRecordInfo(recordId);if(action==="validate"){var newRecord=this.validateRecord(!0);return newRecord?(recInfo==null?this.statusList.push(newRecord):(this.statusList.splice(recInfo.idx,1),this.statusList.splice(recInfo.idx,0,newRecord)),this.updateStatusList(!0,sel,data),this._resetParams(),!0):!1}if(action==="deleteItem")return recInfo?(this.statusList.splice(recInfo.idx,1),this.updateStatusList(!0,sel,data),!0):!1;if(action==="editItem")return recInfo?(this._updateParams(recInfo.record),!0):!1},this.validateRecord=function(errorMsg){var self=this,_fail=function(msg){if(errorMsg===!0){var text=msg||locale.text("auth.arrayStatus.invalid");self.listStatusDisplayer.toggleMessage(text,"error"),setTimeout(function(){self.listStatusDisplayer.toggleMessage(null)},2500)}return null},rec={};rec.field=this.fieldSelector.getValue(),rec.operator=this.operatorSelector.getValue();var proto=this.getFieldProto(rec.field);if(!proto)return _fail();rec.$type=proto.$type,rec.$format=proto.$format,rec.$type==="application/x-boolean"?rec.value=this.componentBoolVal.getValue():rec.value=this.$$valueElmt.val()||"";var formatter=formatApi.getFormatter(rec.$type,proto.$format);if(formatter){var errors=[];rec.value=formatter.parseValue(rec.value,errors);if(errors.length>0)return _fail(errors.join(""));rec.value!=null&&rec.value!=this.$$valueElmt.val()&&this.$$valueElmt.val(formatter.formatValueEdit(rec.value))}return rec.$type=="application/x-reference"&&(rec.value=(rec.value||"").toUpperCase()),this.paletteColor&&(rec.color=this.paletteColor.getValue()),this.paletteIcon&&(rec.icon=this.paletteIcon.getValue()),rec.id=utils.UUID(),rec.field==_noValue||rec.operator==_noValue||rec.color==null?_fail():rec},this._updateParams=function(record){var edit=record!=null;record=record||{},this.editStatusSection.$$panel.show(),this.fieldSelector.setValue(record.field||_noValue),this.updateOperators(record.$type,record.operator||_noValue),this.paletteColor&&this.paletteColor.setValue(record.color),this.paletteIcon&&this.paletteIcon.setValue(record.icon);var val=record.value;if(val!=null){var formatter=formatApi.getFormatter(record.$type,record.$format);val=formatter?formatter.formatValueEdit(val):val}var isBool=record.$type==="application/x-boolean";this.$$valSection.toggle(!isBool),this.$$boolValSection.toggle(isBool),this.componentBoolVal.setValue(isBool&&val===!0),this.$$valueElmt.val(isBool||val==null?"":val)},this._resetParams=function(){this.editStatusSection.$$panel.hide(),this.fieldSelector.setValue(_noValue),this.operatorSelector.clear(),this.paletteColor.setValue(""),this.$$valueElmt.val("")},this.updateStatusList=function(updateAuthoring,sel,data){var clearBefore=!0;clearBefore&&this.listStatusDisplayer.clear();var records=[],style,css;this.statusList.forEach(function(c){c.icon?(css=c.icon.css,style="color:"+c.color.bgColor+";font-size:1.4em;"):(css=c.color?c.color.css:"",style=""),records.push({titleHtml:authArrayGeneral.getHtml("statusLine",{field:c.field,operator:c.operator,value:c.value,css:css,style:style,sizeColor:15}),id:c.id})}),this.listStatusDisplayer.insertRecords(records);if(updateAuthoring==1){var value=[];this.statusList.forEach(function(c){c=$.extend(!0,{},c),delete c.id,value.push(c)}),authPropsGeneral.setValue(this,sel,data,value),authPropsGeneral.notifyChangePropUI(this.$$parent,sel,data);return}},this.paramFieldAdd=function($$root){var selectOpts=[{title:locale.text("auth.arrayStatus.novalue"),value:_noValue}];this._protoValue.forEach(function(v,idx){fieldOperators.acceptOperator(v.$type)&&selectOpts.push({title:v.$title,value:v.$bind})});var opts={value:_noValue,options:selectOpts,css:"statusField",onChange:jsutils.bindFn(this.onParamFieldSelect,this),isHidden:!1};this.fieldSelector=authComponents.newComponent("select",opts),this._addParam("field",this.fieldSelector,!0,$$root,!0)},this.paramOperatorAdd=function($$root){var opts={value:_noValue,options:[{title:locale.text("auth.arrayStatus.novalue"),value:_noValue}],css:"statusOperator",onChange:jsutils.bindFn(this.onParamOperatorSelect,this),isHidden:!1};this.operatorSelector=authComponents.newComponent("select",opts),this._addParam("operator",this.operatorSelector,!0,$$root,!0),this.updateOperators()},this.paramValueAdd=function($$root){this.$$valueElmt=$('<input class="form-control statusValue"></input>');var opts={size:"small",onText:"True",offText:"False"};this.$$valSection=this._addParam("value",this.$$valueElmt,!0,$$root).hide(),this.componentBoolVal=authComponents.newComponent("switcher",opts),this.$$boolValSection=this._addParam("value",this.componentBoolVal,!0,$$root).hide()},this.paramColorAdd=function($$root){var opts={palette:authPropsGeneral.getColorPalette(),dropUp:!0};this.paletteColor=authComponents.newComponent("colorPalettePicker",opts),this._addParam("color",this.paletteColor,!0,$$root,!0)},this.paramIconAdd=function($$root){var opts={palette:fontUtils.getArrayStatusIconList(),dropUp:!0};this.paletteIcon=authComponents.newComponent("iconPalettePicker",opts),this._addParam("icon",this.paletteIcon,!0,$$root,!1)},this.onParamFieldSelect=function(event,prop){var field=this.getFieldProto($(event.target).val());this.updateOperators(field.$type,"eq"),this.$$valSection.toggle(!this.$$boolValSection.toggle(field.$type==="application/x-boolean").is(":visible"))},this.updateOperators=function(typeField,defValue){defValue=defValue==null?_noValue:defValue;var selectOpts=[{title:locale.text("auth.arrayStatus.novalue"),value:_noValue}],ops=fieldOperators.getOperators(typeField,!0);ops&&ops.forEach(function(v,idx){selectOpts.push({title:v.title,value:v.value})}),this.operatorSelector.update(selectOpts,defValue)},this.onParamOperatorSelect=function(event,prop){},this._addParam=function(prop,component,title,$$parent,mandatory){var $$parent=$$parent||this.$$parent,$$title,$$root;if(title){var res=this._addSubSection(prop,$$parent,mandatory);$$root=res.$$content,$$title=res.$$panel}else $$root=$$parent;if(component==null)throw new Error("unexpected null component");var $$panel;return component.createMarkup?(component.createMarkup($$root),this._myProperties.push(component),$$panel=component.$$panel):component.jquery&&($$root.append(component),$$panel=component),$$title?$$title:$$panel},this._addSubSection=function(textId,$$parent,mandatory){var $$panel=$(authArrayGeneral.getHtml("subtitle",{title:locale.text("auth.arrayStatus."+textId)+(mandatory===!0?"*":""),margin:10,id:"arrayStatus"+textId.smCapitalize()})).appendTo($$parent||this.$$parent);return{$$panel:$$panel,$$content:$$panel.children("div"),$$title:$$panel.children("p")}}}};exports.initModuleProperties=function(dest){authPropsGeneral.initProperties(_properties,dest)},exports.getModuleProperties=function($$elmt,controller,props,sel,data){if(!controller.prototype.isLookup()){props.push(_properties.arrayStatusEnabled);var status=data.control.getAuthoring("$statusEnabled");(status==="mono"||status==="multi")&&props.push(_properties.arrayStatus)}}}),define("syracuse-tablet/html/js/authoring/arrays/authArrayCarousel",["require","exports","module","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"],function(require,exports,module){var authPropsGeneral=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),_properties={arrayCarouselPeriod:{key:"$carouselPeriod","default":"none",values:[{value:"none"},{value:"slow"},{value:"normal"},{value:"fast"}],createMarkup:authPropsGeneral.createMarkupRadio,refreshMarkup:authPropsGeneral.refreshMarkupRadio}};exports.initModuleProperties=function(dest){authPropsGeneral.initProperties(_properties,dest)},exports.getModuleProperties=function($$elmt,controller,props,sel,data){props.push(_properties.arrayCarouselPeriod)}}),define("syracuse-tablet/html/js/authoring/arrays/authoringPropertiesChart",["require","exports","module","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/authoring/authoringComponents","syracuse-tablet/html/js/helpers/jsutils"],function(require,exports,module){var authPropsGeneral=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),authComponents=require("syracuse-tablet/html/js/authoring/authoringComponents"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),_err=authPropsGeneral.err,_noValue="$$novalue$$",_templates={subtitle:'		<section {{#if id}}id="{{id}}"{{/if}} style="{{#if notHidden}}overflow:hidden;{{/if}}white-space:nowrap;text-overflow:ellipsis;{{#if margin}}margin-bottom:{{margin}}px;{{/if}}">			{{#if title}}<p>{{title}}</p>{{/if}}			<div></div>		</section>',serieTitle:' 		<div class="panel panel-primary s-m-panel-auth-prop s-m-auth-prop-type-{{type}}"> 			<div style="overflow:hidden;" class="panel-heading" role="tab" id="heading_{{id}}"> 				<a id="serie_{{id}}" style="width:100%;display:table;" data-toggle="collapse" data-parent="#{{#if parentId}}{{parentId}}{{/if}}{{#unless parentId}}accordion{{/unless}}" href="#collapse_{{id}}" {{#if expanded}} aria-expanded="true"{{/if}} aria-controls="collapse_{{id}}" {{#unless expanded}}class="collapsed"{{/unless}}>					<div style="display:table-row;white-space: nowrap;">						<h4 class="panel-title" style="display:table-cell;"> 							{{label}}						</h4> 					</div>				</a> 			</div> 			<div id="collapse_{{id}}" class="panel-collapse collapse {{#if expanded}}in{{/if}}" role="seriepanel" aria-labelledby="heading_{{id}}"> 			</div> 		</div>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[name],tmpl=_templates[key]=Handlebars.compile(tmpl)),tmpl(ctx)},_SeriePanel=function(parent,serieInfo){this.name=serieInfo.name,this.label=serieInfo.$title,this.parent=parent,this.bind=serieInfo.$bind,this.color=serieInfo.color,this.isHidden=serieInfo.isHidden},_properties={chartHeight:{key:"$chartHeight","default":"medium",values:[{value:"xsmall"},{value:"small"},{value:"medium"},{value:"large"},{value:"xlarge"}],createMarkup:authPropsGeneral.createMarkupRadio},chartStyle:function(controller,sel,data){this.name="chartStyle",this.key="$style",this["default"]="line",this._chartGetMeasureCountVisible=function(){var count=data.control.prototype.chartGetNbMeasures();return data.articleSelection.$seriesOptions&&Object.keys(data.articleSelection.$seriesOptions).forEach(function(key){data.articleSelection.$seriesOptions[key].isHidden&&count--}),count},this.values=[{value:"line"},{value:"bar"},{value:"column"}],this._chartGetMeasureCountVisible()===1&&this.values.push({value:"pie"}),this.createMarkup=authPropsGeneral.createMarkupRadio},chartOptions:function(controller,sel,data){var values=[{key:"isTitleHidden","default":!1}],valuesPie=[{key:"isLabelsHidden","default":!1}],valueslineBarColumn=[{key:"isLegendHidden","default":!1},{key:"isGridLineHidden","default":!1},{key:"isXLabelHidden","default":!1},{key:"isXLabelsHidden","default":!1},{key:"isYLabelHidden","default":!1},{key:"isYLabelsHidden","default":!1}];this.name="chartOptions",this.key="$chartOptions",this.values=values.concat(data.articleSelection.$style==="pie"?valuesPie:valueslineBarColumn),this.createMarkup=authPropsGeneral.createMarkupCheckboxes},chartInverted:{key:"$inverted","default":!1,values:[{value:!1},{value:!0}],createMarkup:authPropsGeneral.createMarkupRadio},seriesOptions:function(controller,sel,data){this.name="seriesOptions",this.key="$seriesOptions",this._serieProperties=[],this.initMarkup=function(controller,sel,data){this._protoValue=data.control.prototype.chartGetMeasureInfo(),this._orginalValue=data.articleSelection[this.key];var hasValue=this._orginalValue!=null;this._initProps(hasValue?this._mergeValue():this._protoValue)},this.createMarkup=function($$parent,prop,sel,data){this.$$parent=$$parent,this._accordionId=utils.UUID(),this.$$myAccordion=$('<div id="'+this._accordionId+'" ></div>'),$$parent.append(this.$$myAccordion);var self=this;self._serieProperties.forEach(function(prop){self._createSerieEntry(prop,sel,data)})},this.destroyMarkup=function(){this._serieProperties&&this._serieProperties.forEach(function(prop){prop.destroyMarkup&&prop.destroyMarkup()}),this._serieProperties=null,this.$$parent&&(this.$$parent.closest(".s-m-panel-auth-prop").remove(),this.$$parent=null),this.$$parent&&(this.$$myAccordion=null)},this._mergeValue=function(){var res={},self=this;return Object.keys(self._protoValue).forEach(function(key){res[key]=$.extend(!0,{},self._protoValue[key]),Object.keys(self._orginalValue&&self._orginalValue[key]||{}).forEach(function(prop){res[key][prop]=self._orginalValue[key][prop]})}),res},this._initProps=function(props,createEntry){var self=this;self._serieProperties=[],Object.keys(props).forEach(function(key){self._createSerieProperty(props[key],createEntry)})},this._createSerieProperty=function(prop,createEntry){var prop=new _SeriePanel(this,prop);this._serieProperties.push(prop),createEntry&&this._createSerieEntry(prop)},this._createSerieEntry=function(prop,sel,data){var id=prop.bind,$$parent,$$propGroup=$(_getHtml("serieTitle",{id:id,type:"child",label:prop.label,expanded:!1,parentId:this._accordionId}));$$parent=$$propGroup.find("#collapse_"+id),this.$$myAccordion.append($$propGroup),this.paramHiddenAdd($$parent,sel,data,prop),data.articleSelection.$style!=="pie"&&this.paramColorAdd($$parent,sel,data,prop)},this.paramHiddenAdd=function($$root,sel,data,prop){var opts={size:"small",onText:"True",offText:"False",onSwitchChange:this.onSwitchChange.bind(this,sel,data,prop)};this.componentBoolVal=authComponents.newComponent("switcher",opts),this._addParam(prop,"isHidden",this.componentBoolVal,!0,$$root,!1);var value=this._getPropValue(prop.bind,"isHidden")||!1;this.componentBoolVal.setValue(!value)},this.onSwitchChange=function(sel,data,prop,event,value){var seriesOptions=$.extend(!0,{},data.articleSelection[this.key]);seriesOptions[prop.bind]=seriesOptions[prop.bind]||{},seriesOptions[prop.bind].isHidden=!value,authPropsGeneral.setValue(this,sel,data,seriesOptions),authPropsGeneral.notifyChangePropUI(this.$$parent,sel,data)},this.paramColorAdd=function($$root,sel,data,prop){var opts={color:"",palette:authPropsGeneral.getColorPalette(),dropUp:!0,onSelectColor:jsutils.bindFn(this.colorChange,this,sel,data,prop)};this.paletteColor=authComponents.newComponent("colorPalettePicker",opts);var param=this._addParam(prop,"color",this.paletteColor,!0,$$root,!1);this._getPropValue(prop.bind,"isHidden")&&param.hide(),this.paletteColor.setValue(this._getPropValue(prop.bind,"color"))},this._getPropValue=function(bind,property){var res=null;return this._serieProperties.forEach(function(prop){prop.bind===bind&&(res=prop[property])}),res},this.colorChange=function(value,sel,data,prop){var seriesOptions=$.extend(!0,{},data.articleSelection[this.key]);seriesOptions[prop.bind]=seriesOptions[prop.bind]||{},seriesOptions[prop.bind].color=value,authPropsGeneral.setValue(this,sel,data,seriesOptions),authPropsGeneral.notifyChangePropUI(this.$$parent,sel,data)},this._addParam=function(prop,textId,component,title,$$parent,mandatory){var $$parent=$$parent||this.$$parent,$$title,$$root;if(title){var res=this._addSubSection(prop,textId,$$parent,mandatory);$$root=res.$$content,$$title=res.$$panel}else $$root=$$parent;if(component==null)throw new Error("unexpected null component");var $$panel;return component.createMarkup?(component.createMarkup($$root),this._serieProperties.push(component),$$panel=component.$$panel):component.jquery&&($$root.append(component),$$panel=component),$$title?$$title:$$panel},this._addSubSection=function(prop,textId,$$parent,mandatory){var $$panel=$(_getHtml("subtitle",{title:locale.text("auth.seriesOptions."+textId)+(mandatory===!0?"*":""),margin:10,id:"seriesColor"+prop.bind.smCapitalize()})).appendTo($$parent||this.$$parent);return{$$panel:$$panel,$$content:$$panel.children("div"),$$title:$$panel.children("p")}}},axisLabels:function(controller,sel,data){this.name="axisLabels",this.key="$axisLabels",this.labels=1,this.selectOpts=_getSelectOptions(data.control);if(this.selectOpts.length<=1)return null;this.createMarkup=function($$parent,prop,sel,data){var opts={value:_noValue,options:[{title:"",value:_noValue}].concat(this.selectOpts),onChange:this.onChange.bind(this,$$parent,data)};this.fieldLabelList=authComponents.newComponent("select",opts,"selectLabel"),this.fieldLabelList.createMarkup($$parent),data.articleSelection&&data.articleSelection[this.key]&&data.articleSelection[this.key][this.labels]&&this.fieldLabelList.setValue(data.articleSelection[this.key][this.labels])},this.onChange=function($$parent,data,event,componentSelect){var axisOptions=$.extend(!0,{},data.articleSelection[this.key]);componentSelect.getValue()===_noValue&&axisOptions[this.labels]?delete axisOptions[this.labels]:axisOptions[this.labels]=componentSelect.getValue(),authPropsGeneral.setValue(this,sel,data,axisOptions),authPropsGeneral.notifyChangePropUI(this.$$parent,sel,data)}}},_getSelectOptions=function(control){var selectOpts=[],measures=control.prototype.chartGetMeasureInfo(),dataset=control.builder.getDataSet(),$properties=control.prototype.getProperties(function(prop,$bind){return dataset&&dataset.length>0?dataset[0][$bind]!==undefined&&measures[$bind]===undefined:!1});return Object.keys($properties).forEach(function(v){if(!$properties[v].$title){var ids=v.split("_");ids.lenght>=2&&ids[0]==="C"&&($properties[v].$title=($properties[v.substr(2)]?$properties[v.substr(2)].$title:"")+" ("+v+")")}$properties[v].$title&&selectOpts.push({title:$properties[v].$title,value:v})}),selectOpts};exports.initModuleProperties=function(dest){authPropsGeneral.initProperties(_properties,dest)},exports.getModuleProperties=function($$elmt,controller,props,sel,data){data.control.chartNeedsHeight&&data.control.chartNeedsHeight()&&props.push(_properties.chartHeight),props.push(_properties.chartStyle,_properties.chartOptions,_properties.seriesOptions,_properties.axisLabels)}}),define("syracuse-tablet/html/js/authoring/arrays/authoringPropertiesArrays",["require","exports","module","syracuse-tablet/html/js/authoring/arrays/authArrayGeneral","syracuse-tablet/html/js/authoring/arrays/authArrayTable","syracuse-tablet/html/js/authoring/arrays/authArrayCard","syracuse-tablet/html/js/authoring/arrays/authArrayStatus","syracuse-tablet/html/js/authoring/arrays/authArrayCarousel","syracuse-tablet/html/js/authoring/arrays/authoringPropertiesChart"],function(require,exports,module){var authArrayGeneral=require("syracuse-tablet/html/js/authoring/arrays/authArrayGeneral"),authArrayTable=require("syracuse-tablet/html/js/authoring/arrays/authArrayTable"),authArrayCard=require("syracuse-tablet/html/js/authoring/arrays/authArrayCard"),authArrayStatus=require("syracuse-tablet/html/js/authoring/arrays/authArrayStatus"),authArrayCarousel=require("syracuse-tablet/html/js/authoring/arrays/authArrayCarousel"),authoringPropertiesChart=require("syracuse-tablet/html/js/authoring/arrays/authoringPropertiesChart");exports.initModuleProperties=function(dest){authArrayGeneral.initModuleProperties(dest),authArrayCard.initModuleProperties(dest),authArrayTable.initModuleProperties(dest),authArrayStatus.initModuleProperties(dest),authArrayCarousel.initModuleProperties(dest),authoringPropertiesChart.initModuleProperties(dest)},exports.getModuleProperties=function($$elmt,controller,props,sel,data){sel.$$elmt.is(".s-m-control.s-m-chart")?(authArrayGeneral.getModuleProperties($$elmt,controller,props,sel,data),authoringPropertiesChart.getModuleProperties($$elmt,controller,props,sel,data)):(authArrayGeneral.getModuleProperties($$elmt,controller,props,sel,data),data.control.$display!=="separator"&&(data.control.$display==="card"?(data.control.isCarouselDisplay()&&authArrayCarousel.getModuleProperties($$elmt,controller,props,sel,data),authArrayCard.getModuleProperties($$elmt,controller,props,sel,data)):data.control.$display==="table"&&(data.control.prototype.isSingleArray()||authArrayTable.getModuleProperties($$elmt,controller,props,sel,data)),authArrayStatus.getModuleProperties($$elmt,controller,props,sel,data)))}}),define("syracuse-tablet/html/js/authoring/authoringPropertiesGauge",["require","exports","module","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/authoring/authoringHtml","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"],function(require,exports,module){function _createMarkupGBorderValues($$parent,prop,sel,data){var ctx={};ctx.label_apply=locale.text("auth.g.label_apply");var idMin="s-m-auth-g-borders-min",idMax="s-m-auth-g-borders-max",isProperty=data.articleSelection.$gSetBorderValues==="bind"?!0:!1;if(isProperty){var valMin=data.articleSelection.$gauge.$bindMin,valMax=data.articleSelection.$gauge.$bindMax;ctx.label_tip=locale.text("auth.gBorderValues.label_tip.property"),ctx.label_min=locale.text("auth.gBorderValues.label_min.property"),ctx.label_max=locale.text("auth.gBorderValues.label_max.property");var optionsMin=[],optionsMax=[];optionsMin.push({option_value:"0",selected:valMin==="0"});if(!(data.control.controller.prototype&&data.control.controller.prototype.json&&data.control.controller.prototype.json.$properties)){_err(locale.text("auth.gBorderValues.err.prototype.title"),locale.text("auth.gBorderValues.err.prototype.msg"));return}$.each(data.control.controller.prototype.json.$properties,function(bind,value){_isGaugeValuePropertyType(value.$type)&&bind!==data.control.$bind&&bind!==data.articleSelection.$bind&&(optionsMin.push({option_value:bind,selected:valMin===bind}),optionsMax.push({option_value:bind,selected:valMax===bind}))}),ctx.markupMin=authHtml.execute("gaugeSelect",{id:idMin,options:optionsMin}),ctx.markupMax=authHtml.execute("gaugeSelect",{id:idMax,options:optionsMax})}else{var valMin,valMax;data.articleSelection.$gauge.$bindMin&&typeof data.articleSelection.$gauge.$bindMin=="string"?valMin=data.control.controller.dao.data[data.articleSelection.$gauge.$bindMin]:valMin=data.articleSelection.$gauge.$bindMin,data.articleSelection.$gauge.$bindMax&&typeof data.articleSelection.$gauge.$bindMax=="string"?valMax=data.control.controller.dao.data[data.articleSelection.$gauge.$bindMax]:valMax=data.articleSelection.$gauge.$bindMax,ctx.label_tip=locale.text("auth.gBorderValues.label_tip.input"),ctx.label_min=locale.text("auth.gBorderValues.label_min.input"),ctx.label_max=locale.text("auth.gBorderValues.label_max.input"),ctx.markupMin=authHtml.execute("gaugeBorderInput",{id:idMin,value:valMin}),ctx.markupMax=authHtml.execute("gaugeBorderInput",{id:idMax,value:valMax})}var html=authHtml.execute("authPanelPropertyGBorderValues",ctx),$$panel=$(html);$("button",$$panel).on("click",function(e){var err=!1,vvMin=$(e.target).parent().find("#"+idMin).val(),vvMax=$(e.target).parent().find("#"+idMax).val(),errTitle=locale.text("auth.gBorderValues.err.title");if(!isNaN(parseInt(vvMin),10)&&!isNaN(parseInt(vvMax),10))vvMax<vvMin&&(err=_err(errTitle,locale.text("auth.gBorderValues.err.msg.lowerMax",[vvMax,vvMin])));else{if(typeof vvMin!="string"||typeof vvMax!="string")err=_err(errTitle,locale.text("auth.gBorderValues.err.msg.bothString",[vvMin,vvMax]));vvMin===vvMax&&(err=_err(errTitle,locale.text("auth.gBorderValues.err.msg.samebind")))}err||(data.articleSelection.$gauge.$bindMin=vvMin,data.articleSelection.$gauge.$bindMax=vvMax,authPropsGeneral.notifyChangePropUI($$parent,sel,data))}),$$parent.append($$panel)}function _createMarkupGSegmentsNumbers($$parent,prop,sel,data){var value=data.articleSelection.$gauge.segments?data.articleSelection.$gauge.segments.length:"",options=[];for(var ii=0,jj=maxSegments+1;ii<jj;ii++){var opt={};ii==0?(opt.option_value=locale.text("auth.gSegmentsNumber.default"),opt.selected=value?!0:!1):(opt.option_value=ii,opt.selected=value==ii),options.push(opt)}var ctx={value:authHtml.execute("gaugeSelect",{id:"s-m-auth-g-segnumbers-txt",options:options}),label_apply:locale.text("auth.g.label_apply")},html=authHtml.execute("authPanelPropertyGSegmentsNumber",ctx),$$panel=$(html);$("button",$$panel).on("click",function(e){var vv=$(e.target).prev().val();if(value!=vv)if(vv&&isNaN(parseInt(vv,10)))_err(locale.text("auth.gSegmentsNumber.err.title"),locale.text("auth.gSegmentsNumber.err.msg.expectedNumber",[vv]));else{if(vv){data.articleSelection.$gauge.segments=data.articleSelection.$gauge.segments||[],data.articleSelection.$gauge.segments.length>vv&&data.articleSelection.$gauge.segments.splice(vv);for(var ii=0,jj=vv;ii<jj;ii++)data.articleSelection.$gauge.segments[ii]=data.articleSelection.$gauge.segments[ii]||{}}else data.articleSelection.$gauge.segments=null;authPropsGeneral.notifyChangePropUI($$parent,sel,data)}}),$$parent.append($$panel)}function _createMarkupGSegmentsConfig($$parent,prop,sel,data){var seg=data.articleSelection.$gauge.segments[prop.segIdx],idRoot="s-m-auth-seg-",idx=prop.segIdx,segInfo={};segInfo.id=idRoot+idx,segInfo.label_valstart=locale.text("auth.gSegmentsConfig.label_valstart"),segInfo.value_valstart=seg.valStart,segInfo.label_valend=locale.text("auth.gSegmentsConfig.label_valend"),segInfo.value_valend=seg.valEnd,segInfo.label_propstart=locale.text("auth.gSegmentsConfig.label_propstart"),segInfo.value_propstart=authHtml.execute("authPanelGaugeSlider",{id:segInfo.id+"-propstart",min:0,max:1,step:.1,value:seg.propStart}),segInfo.label_propend=locale.text("auth.gSegmentsConfig.label_propend"),segInfo.value_propend=authHtml.execute("authPanelGaugeSlider",{id:segInfo.id+"-propend",min:0,max:1,step:.1,value:seg.propEnd}),segInfo.label_color=locale.text("auth.gSegmentsConfig.label_color"),segInfo.value_color=seg.color,segInfo.label_apply=locale.text("auth.g.label_apply");var html=authHtml.execute("gaugeSegment",segInfo),$$panel=$(html),$$rangeInputArr=$("input.s-m-auth-g-range",$$panel);$$rangeInputArr.slider(),$$rangeInputArr.on("slide",function(slideEvt){var $$input=$(slideEvt.target),$$output=$$input.next();$$output.text(slideEvt.value)}),$$parent.append($$panel)}function _createMarkupApply($$parent,prop,sel,data){var html=authHtml.execute("authPanelButton",{label:locale.text("auth.gSegmentsConfigApply.label"),css:"s-m-auth-g-apply"}),$$panel=$(html);$("button",$$panel).on("click",function(e){var segs=[],$$segments=$(e.target).parent().parent().find(".s-m-auth-seg-slot");for(var ii=0,jj=$$segments.length;ii<jj;ii++){var $$seg=$($$segments[ii]),id=$$seg.attr("id"),segInfo={};segInfo.valStart=$("#"+id+"-valstart",$$seg).val(),segInfo.valEnd=$("#"+id+"-valend",$$seg).val(),segInfo.propStart=$("#"+id+"-propstart",$$seg).val(),segInfo.propEnd=$("#"+id+"-propend",$$seg).val(),segInfo.color=$("#"+id+"-color",$$seg).val(),segInfo.valStart=segInfo.valStart===""?null:segInfo.valStart,segInfo.valEnd=segInfo.valEnd===""?null:segInfo.valEnd,segInfo.propStart=segInfo.propStart===""?null:segInfo.propStart,segInfo.propEnd=segInfo.propEnd===""?null:segInfo.propEnd,segInfo.color=segInfo.color===""?null:segInfo.color;var vStart=segInfo.valStart,vEnd=segInfo.valEnd;if(vStart&&isNaN(parseInt(vStart.replace(".","").replace(",",""),10))){_err(locale.text("auth.gSegmentsConfig.err.title"),locale.text("auth.gSegmentsConfig.err.msg.expectedNumber",[locale.text("auth.gSegmentsConfig.label_valstart"),vStart]));return}if(vEnd&&isNaN(parseInt(vEnd.replace(".","").replace(",",""),10))){_err(locale.text("auth.gSegmentsConfig.err.title"),locale.text("auth.gSegmentsConfig.err.msg.expectedNumber",[locale.text("auth.gSegmentsConfig.label_valend"),vEnd]));return}segs.push(segInfo)}data.articleSelection.$gauge.segments=segs,authPropsGeneral.notifyChangePropUI($$parent,sel,data)}),$$parent.append($$panel)}function _destroySlider($$parent,prop){var $$slider=$$parent.find("input.s-m-auth-g-range");$$slider.length>0&&$$slider.slider&&$$slider.slider("destroy")}function _getModuleProperties($$elmt,controller,props,sel,data){if(_isGaugeValuePropertyType(data.type)){var isGauge;data.articleSelection.$numDisplay?isGauge=data.articleSelection.$numDisplay==="gauge":(isGauge=data.articleSelection.$gauge?!0:!1,data.articleSelection.$numDisplay=isGauge?"gauge":"normal"),props.push(_properties.numDisplay);if(isGauge){data.articleSelection.$gSetBorderValues||(data.articleSelection.$gauge.$bindMax?data.articleSelection.$gSetBorderValues=typeof data.articleSelection.$gauge.$bindMax=="string"?"bind":"value":data.articleSelection.$gSetBorderValues="default"),props.push(_properties.gSetBorderValues),data.articleSelection.$gSetBorderValues!=="default"&&props.push(_properties.gBorderValues),props.push(_properties.gSegmentsNumber);if(data.articleSelection.$gauge.segments&&data.articleSelection.$gauge.segments.length>0){for(var ii=0,jj=data.articleSelection.$gauge.segments.length;ii<jj;ii++){var name="gSegmentsConfig"+ii;_properties[name]={"default":"",createMarkup:_createMarkupGSegmentsConfig,type:"child-child",destroyMarkup:_destroySlider,label:locale.text("auth.gSegmentsConfig",[ii+1]),segIdx:ii,name:name},props.push(_properties[name])}props.push(_properties.gSegmentsConfigApply)}}}}function _isGaugeValuePropertyType(type){return type.indexOf("integer")>=0||type.indexOf("real")>=0||type.indexOf("decimal")>=0||type.indexOf("quantity")>=0?!0:!1}var locale=require("syracuse-tablet/html/js/helpers/locale"),authHtml=require("syracuse-tablet/html/js/authoring/authoringHtml"),authPropsGeneral=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),_err=authPropsGeneral.err,maxSegments=5,_properties={numDisplay:{key:"$numDisplay","default":"normal",values:[{value:"normal"},{value:"gauge"}],createMarkup:authPropsGeneral.createMarkupRadio,refreshMarkup:authPropsGeneral.refreshMarkupRadio},gSetBorderValues:{key:"$gSetBorderValues","default":"default",values:[{value:"default"},{value:"value"},{value:"bind"}],createMarkup:authPropsGeneral.createMarkupRadio,refreshMarkup:authPropsGeneral.refreshMarkupRadio,type:"child"},gBorderValues:{"default":"",createMarkup:_createMarkupGBorderValues,type:"child"},gSegmentsNumber:{"default":"",createMarkup:_createMarkupGSegmentsNumbers,type:"child"},gSegmentsConfig:{"default":"",createMarkup:_createMarkupGSegmentsConfig,type:"child",destroyMarkup:_destroySlider},gSegmentsConfigApply:{applyMarkup:_createMarkupApply}};exports.initModuleProperties=function(dest){authPropsGeneral.initProperties(_properties,dest)},exports.getModuleProperties=_getModuleProperties}),define("syracuse-tablet/html/js/authoring/authoringPropertiesCtrls",["require","exports","module","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral","syracuse-tablet/html/js/authoring/arrays/authoringPropertiesArrays","syracuse-tablet/html/js/authoring/authoringPropertiesGauge","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var authUtils=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),authoringPropertiesArrays=require("syracuse-tablet/html/js/authoring/arrays/authoringPropertiesArrays"),authoringPropertiesGauge=require("syracuse-tablet/html/js/authoring/authoringPropertiesGauge"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_modules=[authoringPropertiesArrays,authoringPropertiesGauge],_canBeEmpty=function(typ){switch(typ){case"integer":case"real":case"decimal":case"quantity":case"boolean":return!1;default:return!0}},_ctrlFieldsProperties={checkBoxDisplayAs:{key:"$displayAs","default":"icon",values:[{value:"icon"},{value:"text"}],createMarkup:authUtils.createMarkupRadio},isTitleHidden:{key:"$isTitleHidden","default":!1,values:[{value:!0},{value:!1}],createMarkup:authUtils.createMarkupRadio,type:"default"},hideIfEmpty:{key:"$hideIfEmpty","default":!1,values:[{value:!0},{value:!1}],createMarkup:authUtils.createMarkupRadio},isSignature:{key:"$isSignature","default":!1,values:[{value:!0},{value:!1}],createMarkup:authUtils.createMarkupRadio},imgScale:{key:"$imgScale","default":"original",values:[{value:"original"},{value:"small"},{value:"medium"},{value:"large"}],createMarkup:authUtils.createMarkupRadio},scanGPS:{key:"$scanGPS","default":!1,values:[{value:!0},{value:!1}],createMarkup:authUtils.createMarkupRadio},scanBarcode:{key:"$scanBarcode","default":!1,values:[{value:!0},{value:!1}],createMarkup:authUtils.createMarkupRadio},labelPosition:{key:"$labelPosition","default":"left",values:[{value:"left"},{value:"top"}],createMarkup:authUtils.createMarkupRadio},labelAlign:{key:"$labelAlign","default":"left",values:[{value:"left"},{value:"center"},{value:"right"}],createMarkup:authUtils.createMarkupRadio,refreshMarkup:authUtils.refreshMarkupRadio},theme:{key:"$theme","default":"none",values:[{value:"none"},{value:"largetitle"}],createMarkup:authUtils.createMarkupRadio,toggleTheme:function($$elmt,theme){this.removeTheme($$elmt,theme),this.addTheme($$elmt,theme)},removeTheme:function($$elmt,theme){var e=$$elmt.get(0);if(!e.className||e.className.indexOf("s-m-theme")===-1)return;var newClassName=[];e.className.split(" ").forEach(function(c){c&&!c.smStartsWith("s-m-theme")&&newClassName.push(c)});if(e.className.length===0)return;e.className=newClassName.join(" ")},addTheme:function($$elmt,theme){if(!theme||theme==="none")return;$$elmt.addClass("s-m-theme-"+theme)}},refDescPosition:{key:"$refDescPosition","default":"right",values:[{value:"bottom"},{value:"right"},{value:"left"},{value:"top"},{value:"none"}],createMarkup:authUtils.createMarkupRadio},refDescFormat:{key:"$refDescFormat","default":"desc",values:[{value:"desc"},{value:"title"},{value:"desctitle"},{value:"titledesc"}],createMarkup:authUtils.createMarkupRadio},textHeight:{key:"$textHeight","default":"medium",values:[{value:"small"},{value:"medium"},{value:"large"},{value:"xlarge"}],createMarkup:authUtils.createMarkupRadio,refreshMarkup:authUtils.refreshMarkupRadio},emptyImageIcon:{key:"$emptyImageIcon","default":fontUtils.getEmptyImageDefIcon(),values:fontUtils.getEmptyImageIconList(),createMarkup:authUtils.createMarkupIconPicker,destroyMarkup:authUtils.destroyMarkupIconPicker},emptyIconSize:{key:"$emptyIconSize","default":"small",values:[{value:"small"},{value:"medium"},{value:"large"},{value:"xlarge"}],createMarkup:authUtils.createMarkupRadio,refreshMarkup:authUtils.refreshMarkupRadio},urlIcon:{key:"$urlIcon","default":fontUtils.getUrlDefIcon(),values:fontUtils.getUrlIconList(),createMarkup:authUtils.createMarkupIconPicker,destroyMarkup:authUtils.destroyMarkupIconPicker},urlIconSize:{key:"$urlIconSize","default":"small",values:[{value:"small"},{value:"medium"},{value:"large"},{value:"xlarge"}],createMarkup:authUtils.createMarkupRadio,refreshMarkup:authUtils.refreshMarkupRadio},imgHeight:{key:"$imgHeight","default":"small",values:[{value:"xsmall"},{value:"small"},{value:"medium"},{value:"large"},{value:"xlarge"}],createMarkup:authUtils.createMarkupRadio,refreshMarkup:authUtils.refreshMarkupRadio}};exports.initModuleProperties=function(dest){authUtils.initProperties(_ctrlFieldsProperties,dest),_modules.forEach(function(module){module.initModuleProperties(dest)})},exports.getModuleProperties=function($$elmt,controller,props,sel,data){var isField=sel.$$elmt.is(".s-m-control.s-m-field"),isArray=sel.$$elmt.is(".s-m-control.s-m-array");if(isField||isArray&&!controller.prototype.isQueryLikeFacet()){props.push(_ctrlFieldsProperties.isTitleHidden);var labelPosition=!0,alignment=!0;authUtils.getValueOrDefault(_ctrlFieldsProperties.isTitleHidden,sel,data)?labelPosition=!1:authUtils.getValueOrDefault(_ctrlFieldsProperties.labelPosition,sel,data)!=="top"&&(alignment=!1),labelPosition&&props.push(_ctrlFieldsProperties.labelPosition),alignment&&props.push(_ctrlFieldsProperties.labelAlign)}else sel.$$elmt.is(".s-m-control.s-m-chart-array")&&props.push(_ctrlFieldsProperties.isTitleHidden);isField?(_canBeEmpty(data.type)&&props.push(_ctrlFieldsProperties.hideIfEmpty),props.push(_ctrlFieldsProperties.theme),data.type==="boolean"&&props.push(_ctrlFieldsProperties.checkBoxDisplayAs),data.type==="reference"&&(props.push(_ctrlFieldsProperties.refDescFormat),props.push(_ctrlFieldsProperties.refDescPosition)),(data.type==="rtf"||data.type==="html"||data.type==="plain")&&props.push(_ctrlFieldsProperties.textHeight),data.type==="image"&&(props.push(_ctrlFieldsProperties.emptyImageIcon,_ctrlFieldsProperties.emptyIconSize,_ctrlFieldsProperties.imgHeight),controller.isEditMode()&&props.push(_ctrlFieldsProperties.imgScale,_ctrlFieldsProperties.isSignature)),data.type==="string"&&data.control&&data.control.cssType==="s-m-url"&&props.push(_ctrlFieldsProperties.urlIcon,_ctrlFieldsProperties.urlIconSize),controller.isEditMode()&&(data.control.getNativeCapabilityAuthoring("GPS")!=null&&props.push(_ctrlFieldsProperties.scanGPS),data.control.getNativeCapabilityAuthoring("scanBarcode")!=null&&props.push(_ctrlFieldsProperties.scanBarcode)),authoringPropertiesGauge.getModuleProperties($$elmt,controller,props,sel,data)):isArray&&(data.control.$display==="separator"&&props.push(_ctrlFieldsProperties.theme),authoringPropertiesArrays.getModuleProperties($$elmt,controller,props,sel,data))},exports.toggleTheme=function($$elmt,theme){if(!$$elmt)return;return _ctrlFieldsProperties.theme.toggleTheme($$elmt,theme)}}),define("syracuse-tablet/html/js/authoring/authoringPropertiesLayouts",["require","exports","module","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral","syracuse-tablet/html/js/authoring/authoringHtml","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/authoring/authoringComponents","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/modals/modal"],function(require,exports,module){function _createMarkupInput($$parent,prop,sel,data){var value=authPropsGeneral.getValueOrDefault(prop,sel,data),html=authHtml.execute("authPanelPropertyInput",{id:"auth_opt_"+prop.name,value:value}),$$panel=$(html);$("input",$$panel).blur(function(){var value=$(this).val();authPropsGeneral.setValue(prop,sel,data,value),authPropsGeneral.notifyChangePropUI($$parent,sel,data)}),$$parent.append($$panel)}function _createMarkupInputLocale($$parent,prop,sel,data){var oldUUID=authPropsGeneral.getValueOrDefault(prop,sel,data),value;oldUUID=oldUUID||"";if(oldUUID.indexOf("{@")<0)value=oldUUID,oldUUID="";else{var loc=data.articlePage.$localization&&data.articlePage.$localization[locale.getCurrentLocale()];value=oldUUID.replace(/\{\@(\S+)\}/g,function(m,g){return loc&&loc[g]||m}),value===oldUUID&&(value=data.control.controller.prototype.resolveExpression(oldUUID,null,!0))}var html=authHtml.execute("authPanelPropertyInputLocale",{id:"auth_opt_"+prop.name,value:value,oldValue:value,oldUUID:oldUUID}),$$panel=$(html);$("input",$$panel).blur(function(){var value=$(this).val(),oldValue=$(this).attr("data-old-value"),oldUUID=$(this).attr("data-old-uuid");value===oldValue?(oldUUID.length>0&&(value=oldUUID),_setValue($$parent,prop,sel,data,value)):oldValue&&value&&utils.isLocalizationExits(data.articlePage.$localization,oldUUID)?modal.simpleConfirmPromise({message:locale.text("auth.msg.keepTranslation")}).then(function(result){result.action==="yes"&&(data.articleSelection.keepKey=oldUUID),_setValue($$parent,prop,sel,data,value)}):_setValue($$parent,prop,sel,data,value)}),$$parent.append($$panel)}function _setValue($$parent,prop,sel,data,value){authPropsGeneral.setValue(prop,sel,data,value),authPropsGeneral.notifyChangePropUI($$parent,sel,data)}function _createMarkupIcon($$parent,prop,sel,data){var ctx={group:"auth_opt_"+prop.name,options:[]},value=authPropsGeneral.getValueOrDefault(prop,sel,data);ctx.options.push({id:ctx.group+"_none",value:"",icon:"fa fa-remove"}),fontUtils.getTileIconList().forEach(function(v){var css=fontUtils.getIconByName(v);ctx.options.push({id:ctx.group+"_"+v,value:v,icon:css})});var html=authHtml.execute("authPanelPropertyRadioIcon",ctx),$$panel=$(html);$("label[data-s-m-auth-value='"+(""+value)+"']",$$panel).eq(0).button("toggle"),$("label",$$panel).on("click",function(e){var $$ct=$(e.currentTarget),value=$$ct.attr("data-s-m-auth-value");$$ct.eq(0).button("toggle"),authPropsGeneral.setValue(prop,sel,data,value),authPropsGeneral.notifyChangePropUI($$parent,sel,data)}),$$parent.append($$panel)}var authPropsGeneral=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),authHtml=require("syracuse-tablet/html/js/authoring/authoringHtml"),locale=require("syracuse-tablet/html/js/helpers/locale"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),authComponents=require("syracuse-tablet/html/js/authoring/authoringComponents"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),utils=require("syracuse-tablet/html/js/helpers/utils"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),_properties={tileColor:{key:"$bgColor","default":"",values:authPropsGeneral.getColorValues(),colorChange:function(value,sel,data,prop){authPropsGeneral.setValue(this,sel,data,value?value.id:""),authPropsGeneral.notifyChangePropUI(this.$$parent,sel,data)},createMarkup:function($$parent,prop,sel,data){var opts={color:"",palette:authPropsGeneral.getColorPalette(),dropUp:!1,onSelectColor:jsutils.bindFn(this.colorChange,this,sel,data,prop)};this.paletteColor=authComponents.newComponent("colorPalettePicker",opts),this.paletteColor.createMarkup($$parent),this.paletteColor.setValue(authPropsGeneral.getColorInfo(data.articleSelection.$bgColor))}},tileSize:{key:"$size","default":"medium",values:[{value:"small"},{value:"medium"},{value:"wide"},{value:"large"},{value:"full"},{value:"all"}],createMarkup:authPropsGeneral.createMarkupRadio},layoutTitle:function(controller,sel,data){this.name="layoutTitle",this.key="$title";var titleList=controller.prototype.getAllX3Title();if(!titleList||!titleList.length){this["default"]="",this.createMarkup=_createMarkupInputLocale;return}this.values=titleList,this.createMarkup=function($$parent,prop,sel,data){var opts={value:"",options:titleList,onChange:jsutils.bindFn(this.valueChange,this,sel,data,prop),dataSize:20};this.titleSelect=authComponents.newComponent("select",opts),this.titleSelect.createMarkup($$parent),data.articleSelection&&data.articleSelection.$title&&this.titleSelect.setValue(data.articleSelection.$title)},this.valueChange=function(event,titleSelect,sel,data,prop){authPropsGeneral.setValue(this,sel,data,titleSelect.getValue()),authPropsGeneral.notifyChangePropUI(this.$$parent,sel,data)}},layoutCollapsible:{key:"$collapsible","default":"notcollapsible",values:[{value:"notcollapsible"},{value:"expanded"},{value:"collapsed"}],createMarkup:authPropsGeneral.createMarkupRadio},tileIcon:{key:"$icon","default":"",createMarkup:_createMarkupIcon},cellSize:function(controller,sel,data){this["default"]=4,this.name="cellSize",this.destroyMarkup=function(){this.$$parent=null,this._$$panel&&(this._$$panel.off(),this._$$panel=null)},this.createMarkup=function($$parent,prop,sel,data){var self=this;self.$$parent=$$parent;var values=["1","2","3","4","5","6","7","8","9","10","11","12"];self._sizes=[{prop:"widthAll",label:locale.text("auth.cellSize.widthAll"),"class":"s-m-auth-highlight-all"},{prop:"widthXs",label:locale.text("auth.cellSize.$widthXs"),"class":"s-m-auth-highlight-xs"},{prop:"widthSm",label:locale.text("auth.cellSize.$widthSm"),"class":"s-m-auth-highlight-sm"},{prop:"widthMd",label:locale.text("auth.cellSize.$widthMd"),"class":"s-m-auth-highlight-md"},{prop:"widthLg",label:locale.text("auth.cellSize.$widthLg"),"class":"s-m-auth-highlight-lg"}],self._$$panel=$(authHtml.execute("authPanelPropertyCellSize",{id:"auth_opt_"+prop.name,sizes:self._sizes,values:values,sameSize:locale.text("auth.cellSize.sameSize")}));var last="12";self._sizes.forEach(function(size){var value=data.articleSelection&&data.articleSelection["$"+size.prop];value=value||last,last=value,$("label[data-s-m-auth-prop='"+size.prop+"'][data-s-m-auth-value='"+value+"']",self._$$panel).button("toggle")}),self._$$panel.on("click","label.auth-btn-size-sel",jsutils.bindFn(self.onClickSize,this,sel,data)),self._$$panel.on("click",'input[type="checkbox"]',jsutils.bindFn(self.onClickSameSize,this,sel,data)),self._$$panel.appendTo($$parent),self.toggleSameSize($$parent,data.articleSelection.$sameSize)},this.onClickSize=function(e,sel,data){var self=this,$$ct=$(e.currentTarget);$$ct.eq(0).button("toggle"),self._sizes.forEach(function(size){$$ct=self._$$panel.find("label.active[data-s-m-auth-prop='"+size.prop+"']");if($$ct.length>0){var value=$$ct.attr("data-s-m-auth-value");data.articleSelection["$"+size.prop]=value}}),authPropsGeneral.notifyChangePropUI(this.$$parent,sel,data)},this.onClickSameSize=function(e,sel,data){data.articleSelection.$sameSize=$(e.currentTarget).prop("checked"),authPropsGeneral.notifyChangePropUI(this.$$parent,sel,data)},this.toggleSameSize=function($$parent,yes){yes=yes===!0,this._$$panel.find("section.widthAll").toggle(yes),this._$$panel.find("section:not(.widthAll)").toggle(!yes),this._$$panel.find('input[type="checkbox"]').prop("checked",yes)}},layoutTheme:function(controller,sel,data){if(data.articleSelection.$collapsible===undefined||data.articleSelection.$collapsible==="notcollapsible")return null;var level=data.control.$$elmt.parents(".s-m-stack").length;this.name="layoutTheme",this.key="$theme",this["default"]=String.fromCharCode(96+level),this.values=[],this.values.push({value:String.fromCharCode(96+level)}),this.values.push({value:"advanced"}),this.createMarkup=authPropsGeneral.createMarkupRadio}},_layoutProps={stack:[_properties.tileColor,_properties.layoutTitle,_properties.layoutCollapsible,_properties.layoutTheme],row:[_properties.tileColor],"hub-group":[_properties.layoutTitle],tile:[_properties.layoutTitle,_properties.tileColor,_properties.tileSize,,_properties.tileIcon],cell:[_properties.tileColor,_properties.cellSize]};exports.properties=_properties,exports.getModuleProperties=function($$elmt,controller,props,sel,data){Object.keys(_layoutProps).some(function(key){var cls="s-m-"+key;$$elmt.hasClass(cls)&&_layoutProps[key].forEach(function(p){props.push(p)})})},exports.initModuleProperties=function(dest){authPropsGeneral.initProperties(_properties,dest)}}),define("syracuse-tablet/html/js/authoring/page/authoringActions",["require","exports","module","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral","syracuse-tablet/html/js/authoring/authoringComponents","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var authPropsGeneral=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),authComponents=require("syracuse-tablet/html/js/authoring/authoringComponents"),locale=require("syracuse-tablet/html/js/helpers/locale"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_templates={subtitle:'		<section class="s-m-prop-subtitle" {{#if id}}id="{{id}}"{{/if}} style="{{#if notHidden}}overflow:hidden;{{/if}}white-space:nowrap;text-overflow:ellipsis;{{#if margin}}margin-bottom:{{margin}}px;{{/if}}">			{{#if title}}<p>{{title}}</p>{{/if}}			<div></div>		</section>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[name],tmpl=_templates[key]=Handlebars.compile(tmpl)),tmpl(ctx)},_addSubSection=function(title,id,$$parent){var $$panel=$(_getHtml("subtitle",{title:title,margin:10,id:id})).appendTo($$parent||this.$$parent);return{$$panel:$$panel,$$content:$$panel.children("div"),$$title:$$panel.children("p")}},_optionsProperties=["footerHeader","refreshPage","multiselection","backIfSuccess"],_noValue="$$novalue$$",_properties={actionSettings:function(controller,sel,data){this.name="actionSettings",this.label=null,this["default"]=null,this.key="$pageActionSettings",this._myProperties=[],this._page=data.page,this.controller=controller,this.initMarkup=function(controller,sel,data){if(!this._page)return;var $links=this._page.getProtoLinks();this._$links=[];if($links)for(var l in $links){var entry=$.extend(!0,{},$links[l]);entry.name=l,entry.$title=this._page.prototype.resolveExpression(entry.$title)||entry.name,this._$links.push(entry)}var baseArticle=data.articleSelection||{};baseArticle=baseArticle[this.key]||[],this._actionList=[];var self=this;baseArticle.forEach(function(act){self.getActionProto(act.name)&&(act.$title=self._page.prototype.resolveExpression(act.$title)||entry.name,act.options=act.options||{},self._actionList.push($.extend(!0,{},act)))})},this.getActionProto=function(name){var res=null;return this._$links.some(function(v,idx){if(v.name===name)return res=v,!0}),res},this.getActionInfo=function(actName){if(!actName)return null;var idx=-1,rec=null;return this._actionList.some(function(c,i){if(c.name===actName)return rec=c,idx=i,!0}),idx===-1?null:{record:rec,idx:idx}},this.destroyMarkup=function(){this._page=null,this.$$parent=null,this.controller=null,this._$links=null,this._myProperties&&(this._myProperties.forEach(function(p){p.destroyMarkup&&p.destroyMarkup()}),this._myProperties=null)},this.createMarkup=function($$parent,prop,sel,data){if(!this._page)return;this.$$parent=$$parent,this._page.prototype.isQuery()&&this.downloadOptAdd(sel,data),this.actionListAdd(sel,data),this.editSectionAdd(),this.checkAppendButton()},this.downloadOptAdd=function(sel,data){var value=authPropsGeneral.getValueOrDefault({key:"$allowDownload","default":!1},sel,data),opts={size:"small",onText:"True",offText:"False",onSwitchChange:this.onAllowDownloadChanged.bind(this,sel,data)};this.allowDownload=authComponents.newComponent("switcher",opts),this.$$allowDownload=this._addParam("allowDownload",this.allowDownload,!0),this.allowDownload.setValue(value)},this.onAllowDownloadChanged=function(sel,data,event,value){authPropsGeneral.setValue({key:"$allowDownload"},sel,data,value),authPropsGeneral.notifyChangePropUI(this.$$parent,sel,data)},this.actionListAdd=function(sel,data){var opts={css:"actionlist",doAction:jsutils.bindFn(this.listCallBackAction,this,sel,data),appendTitle:locale.text("auth.actionSettings.append")};this.listActionDisplayer=authComponents.newComponent("editableList",opts),this._addParam("actionlist",this.listActionDisplayer,!0),this.updateActionList()},this.editSectionAdd=function(){this.editActionSection=this._addSubSection("editaction"),this.editActionSection.$$panel.hide(),this.editActionSection.$$content.css("padding-left","7px"),this.editActionSection.$$title.css("font-weight","bold");var $$rootComponents=this.editActionSection.$$content;this.paramActionAdd($$rootComponents),this.paramOptionsAdd($$rootComponents),this.paramIconAdd($$rootComponents)},this.checkAppendButton=function(){if(!this.listActionDisplayer)return;this.listActionDisplayer.disableAppendBtn(this._actionList.length>=this._$links.length)},this.listCallBackAction=function(action,recordId,listActionDisplayer,sel,data){if(action==="append")return this._updateParams(null),!0;if(action==="cancel")return this._resetEditParams(),this.editActionSection.$$panel.hide(),this.checkAppendButton(),!0;var recInfo=this.getActionInfo(recordId);if(action==="validate"){var newRecord=this.validateRecord(!0);return newRecord?(recInfo==null?this._actionList.push(newRecord):(this._actionList.splice(recInfo.idx,1),this._actionList.splice(recInfo.idx,0,newRecord)),this.updateActionList(!0,sel,data),this._resetEditParams(),this.checkAppendButton(),!0):!1}if(action==="deleteItem")return recInfo?(this._actionList.splice(recInfo.idx,1),this.checkAppendButton(),this.updateActionList(!0,sel,data),!0):!1;if(action==="editItem")return recInfo?(this._updateParams(recInfo.record),!0):!1},this.validateRecord=function(errorMsg){var self=this,rec={},_fail=function(msg,params){if(errorMsg===!0){var text=locale.text("auth.actionSettings.invalid"+(msg||""),params);self.listActionDisplayer.toggleMessage(text,"error"),setTimeout(function(){self.listActionDisplayer.toggleMessage(null)},2500)}return null};rec.name=this.actionSelector.getValue();if(!rec.name||rec.name==_noValue)return _fail();rec.icon=this.paletteIcon.getValue();var info=this.getActionProto(rec.name);if(!info)return _fail(".action",[rec.name]);rec.$title=info.$title,rec.options=this.optionsList.getValue();var nbChecked=0;for(var p in rec.options)rec.options[p]===!0&&nbChecked++;return nbChecked===0&&!rec.icon?_fail(".empty"):rec.options.footerHeader&&!rec.icon?_fail(".icon"):rec},this._updateParams=function(record){var edit=record!=null;record=record||{},this.editActionSection.$$panel.show(),this.paramActionUpdate(record.name||_noValue,!0,record.options),this.optionsList.updateValue(record.options),this.paletteIcon.setValue(record.icon)},this._resetEditParams=function(){this.editActionSection.$$panel.hide(),this.actionSelector.setValue(_noValue)},this.updateActionList=function(updateAuthoring,sel,data){var clearBefore=!0;clearBefore&&this.listActionDisplayer.clear();var records=[];this._actionList.forEach(function(c){records.push({titleHtml:"<span>"+(c.$title||c.name)+"</span>",id:c.name})}),this.listActionDisplayer.insertRecords(records);if(updateAuthoring==1){var value=[];this._actionList.forEach(function(c){c=$.extend(!0,{},c),value.push(c)}),authPropsGeneral.setValue(this,sel,data,value),authPropsGeneral.notifyChangePropUI(this.$$parent,sel,data);return}},this.paramActionAdd=function($$root){var opts={css:"actionName",onChange:jsutils.bindFn(this.onParamActionSelect,this),isHidden:!1};this.actionSelector=authComponents.newComponent("select",opts),this._addParam("action",this.actionSelector,!0,$$root,!0),this.paramActionUpdate(_noValue)},this.onParamActionSelect=function(event,prop){},this.paramActionUpdate=function(value,forceAddValue,options){var selectOpts=[{title:locale.text("auth.actionSettings.novalue"),value:_noValue}],self=this;this._$links.forEach(function(v,idx){if(options&&options.multiselection===!0&&v.name.smStartsWith("$"))return;(forceAddValue===!0&&value===v.name||!self.getActionInfo(v.name))&&selectOpts.push({title:v.$title,value:v.name})}),this.actionSelector.update(selectOpts,value||_noValue)},this.paramOptionsAdd=function($$root){var opts={list:[],onClick:jsutils.bindFn(this.onClickOptions,this)},self=this;_optionsProperties.forEach(function(x){if(x==="multiselection"&&!self._page.prototype.isQuery())return;opts.list.push({id:x,label:locale.text("auth.actionSettings."+x)})}),this.optionsList=authComponents.newComponent("checkboxList",opts),this._addParam("options",this.optionsList,!0,$$root,!1)},this.onClickOptions=function(id,checked){this.paramActionUpdate(this.actionSelector.getValue(),!0,this.optionsList.getValue())},this.paramIconAdd=function($$root){var opts={palette:fontUtils.getPageActionIcon(),dropUp:!0};this.paletteIcon=authComponents.newComponent("iconPalettePicker",opts),this._addParam("icon",this.paletteIcon,!0,$$root,!1)},this._addParam=function(prop,component,title,$$parent,mandatory){var $$parent=$$parent||this.$$parent,$$title,$$root;if(title){var res=this._addSubSection(prop,$$parent,mandatory);$$root=res.$$content,$$title=res.$$panel}else $$root=$$parent;if(component==null)throw new Error("unexpected null component ["+prop+"]");var $$panel;return component.createMarkup?(component.createMarkup($$root),this._myProperties.push(component),$$panel=component.$$panel):component.jquery&&($$root.append(component),$$panel=component),$$title?$$title:$$panel},this._addSubSection=function(textId,$$parent,mandatory){var title=locale.text("auth.actionSettings."+textId)+(mandatory===!0?"*":""),id="actionSettings"+textId.smCapitalize();return _addSubSection(title,id,$$parent||this.$$parent)}}};exports.addSubSection=_addSubSection,exports.initModuleProperties=function(dest){authPropsGeneral.initProperties(_properties,dest)},exports.getModuleProperties=function($$elmt,controller,props,sel,data){props.push(_properties.actionSettings)}}),define("syracuse-tablet/html/js/authoring/page/authoringChartDetail",["require","exports","module","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"],function(require,exports,module){var authPropsGeneral=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),_properties={chartDetailDisplay:{key:"$display","default":"bothSideToSide",values:[{value:"chartOnly"},{value:"arrayOnly"},{value:"bothSideToSide"}],createMarkup:authPropsGeneral.createMarkupRadio}};exports.initModuleProperties=function(dest){authPropsGeneral.initProperties(_properties,dest)},exports.getModuleProperties=function($$elmt,controller,props,sel,data){props.push(_properties.chartDetailDisplay)}}),define("syracuse-tablet/html/js/authoring/authoringPropertiesPages",["require","exports","module","syracuse-tablet/html/js/authoring/page/authoringActions","syracuse-tablet/html/js/authoring/page/authoringChartDetail","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral","syracuse-tablet/html/js/authoring/authoringComponents","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var authoringActions=require("syracuse-tablet/html/js/authoring/page/authoringActions"),authoringChartDetail=require("syracuse-tablet/html/js/authoring/page/authoringChartDetail"),authPropsGeneral=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),authComponents=require("syracuse-tablet/html/js/authoring/authoringComponents"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),locale=require("syracuse-tablet/html/js/helpers/locale"),_getPage=function($$elmt,control){return control&&control.isVignette()?control.getPage():$$elmt&&$$elmt.is(".s-m-page")?$$elmt.smPageController():null},_properties={variants:function(controller,sel,data){this.key="$variant",this.views=controller.views;if(!this.views||this.views.length<=1)return;var titles=[],currentSelection;this.views.forEach(function(view,idx){titles.push({title:view.$title,value:view.uuid||view.$url,selected:view.$selected}),view.$selected&&(currentSelection=view.uuid||view.$url)}),this.applyMarkup=function($$parent,prop,sel,data){var subsection=this._addSubSection($$parent),opts={css:"variants-list",value:currentSelection,options:titles,onChange:jsutils.bindFn(this.valueChange,this,sel,data,prop),dataSize:20};this.viewSelect=authComponents.newComponent("select",opts),this.viewSelect.createMarkup(subsection.$$content),data.articleSelection&&data.articleSelection.$variant&&this.viewSelect.setValue(data.articleSelection.$variant)},this._addSubSection=function($$parent){var title=locale.text("auth.page.views"),id="pageViewsList";return authoringActions.addSubSection(title,id,$$parent)},this.valueChange=function(event,viewSelect,sel,data,prop){var uuid=viewSelect.getValue(),self=this,variants=data&&data.page&&data.page.variants;if(!variants)return;var variantSelected=$.smFind(variants,function(variant){return uuid.indexOf(variant.$uuid)>-1?!0:!1});variantSelected&&(this.views.forEach(function(view){view.$selected=!1;if(view.$url===uuid||view.uuid==uuid)view.$selected=!0}),authPropsGeneral.notifyAuthVariantChange(JSON.parse(variantSelected.pageData.content).$article))}}},_modules=[authoringActions,authoringChartDetail];exports.initModuleProperties=function(dest){_modules.forEach(function(module){module.initModuleProperties(dest)})},exports.getModuleProperties=function($$elmt,controller,props,sel,data){data.page=_getPage($$elmt,data.control);if(data.page==null)return;data.page.state.type==="chartdetail"&&authoringChartDetail.getModuleProperties($$elmt,controller,props,sel,data),props.push(_properties.variants),authoringActions.getModuleProperties($$elmt,controller,props,sel,data)}}),define("syracuse-tablet/html/js/authoring/authoringProperties",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral","syracuse-tablet/html/js/authoring/authoringPropertiesCtrls","syracuse-tablet/html/js/authoring/authoringPropertiesLayouts","syracuse-tablet/html/js/authoring/authoringPropertiesPages"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),authoringPropertiesGeneral=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),authoringPropertiesCtrls=require("syracuse-tablet/html/js/authoring/authoringPropertiesCtrls"),authoringPropertiesLayouts=require("syracuse-tablet/html/js/authoring/authoringPropertiesLayouts"),authoringPropertiesPages=require("syracuse-tablet/html/js/authoring/authoringPropertiesPages"),_propsModules=[authoringPropertiesPages,authoringPropertiesLayouts,authoringPropertiesCtrls,authoringPropertiesGeneral],_properties;exports.initProperties=function(force){if(_properties!=null&&force!=1)return;_properties={},_propsModules.forEach(function(module){module.initModuleProperties(_properties)})},exports.getAllProperties=function(){return _properties},exports.getProperties=function(sel,data){var $$elmt=sel.$$elmt,props=[],controller=$$elmt.is(".s-m-page")?$$elmt.smPageController():utils.findController($$elmt);return _propsModules.forEach(function(module){module.getModuleProperties($$elmt,controller,props,sel,data)}),props.forEach(function(p,idx){if(typeof p=="function"){var prop=props[idx]=new p(controller,sel,data);prop.initMarkup&&prop.initMarkup(controller,sel,data),authoringPropertiesGeneral.initProperty(prop)}}),props},exports.getPropertiesLayouts=function(){return authoringPropertiesLayouts}}),define("syracuse-tablet/html/js/authoring/authoringHelpers",["require","exports","module","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/authoring/authoringSData","syracuse-tablet/html/js/authoring/authoringProperties","syracuse-tablet/html/js/authoring/authoringHtml","syracuse-tablet/html/js/authoring/authoringVal","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/ui/uiUtils"],function(require,exports,module){var jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),locale=require("syracuse-tablet/html/js/helpers/locale"),authoringSData=require("syracuse-tablet/html/js/authoring/authoringSData"),authProps=require("syracuse-tablet/html/js/authoring/authoringProperties"),authHtml=require("syracuse-tablet/html/js/authoring/authoringHtml"),authVal=require("syracuse-tablet/html/js/authoring/authoringVal"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),uiutils=require("syracuse-tablet/html/js/ui/uiUtils"),_openPanels=[];exports.triggerResizeInternal=function(opts){uiutils.triggerResizeInternal(opts)},exports.selectElement=function(sel){$(".s-m-auth-selected").removeClass("s-m-auth-selected");var $$elmt=$("#"+sel.id,$("#s-m-app-id")),domItem=$$elmt[0]},exports.findControl=function($$ctrl){return utils.findControl($$ctrl)},exports.getSelectionById=function(id){var $$item=$("#s-m-app-id #"+id);return $$item.length<=0?null:{$$elmt:$$item,id:id}},exports.getSelectionData=function(sel){if(!sel||!sel.id)return null;var app=globals.getApplication(),article=$.extend(!0,{},app.currentPage.article),title,type,control=exports.findControl(sel.$$elmt);control&&control.isControl()?(title=control.prototype&&control.prototype.data("$title"),title?title+=" ("+control.$bind+")":title=control.$bind,type=control.typeName):(title=locale.text("auth.label_layout"),type=sel.$$elmt.attr("id"),type=type.replace(/\d/g,""));var articleSelection=control&&control.getArticle()||app.currentPage.article;return{articlePage:article,articleSelection:articleSelection,title:title,type:type,control:control}};var _PropertyPanel=function($$parent){this.$$parent=$$parent,this.destroyHandlers=[],this.propInstances=[],this.destroy=function(){this.destroyHandlers.forEach(function(h){h&&h()}),this.propInstances.forEach(function(p){p.destroyMarkup&&p.destroyMarkup()}),this.destroyHandlers=this.propInstances=null,this.$$parent&&this.$$parent.empty()},this.addDestroyHandler=function($$content,prop){this.destroyHandlers.push(jsutils.bindFn(prop.destroyMarkup,null,$$content,prop))},this.addPropInstance=function(prop){this.propInstances.push(prop)}};exports.createPropertyPanel=function($$parent,sel,data){var props=authProps.getProperties(sel,data);if(!props)return;var propertyPanel=new _PropertyPanel($$parent),$$accord=$('<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">'),id,num=0,toDestroy=[],article=sel.articleSelection,topButtons=[];return props.forEach(function(prop){id="auth_prop_"+prop.name;var expanded=!1;if(prop.createMarkup){var $$block=$(authHtml.execute("authPanelPropertyGroup",{id:id,expanded:expanded,label:prop.label,type:prop.type||"default"})),$$content=$("#collapse_"+id,$$block);prop.createMarkup($$content,prop,sel,data),$.isPlainObject(prop)&&prop.destroyMarkup?propertyPanel.addDestroyHandler($$content,prop):prop.constructor&&propertyPanel.addPropInstance(prop),prop.isHidden===!0&&$$block.hide()}else if(prop.createButtonMarkup)topButtons.unshift(prop);else if(prop.applyMarkup)prop.applyMarkup($$accord,prop,sel,data);else if(prop.isSeparatror)var $$block=$(authHtml.execute("authPanelPropertySeperator",{id:id,expanded:expanded,label:prop.label,type:prop.type||"default"}));$$accord.append($$block),num++}),topButtons.forEach(function(prop){notifications.publish("sm.auth.top.button","add",prop)}),$$parent.append($$accord),_openPanels.forEach(function(id){$$parent.find("#"+id).collapse({toggle:!0})}),propertyPanel},exports.refreshPropertyPanels=function(sel,data){var props=authProps.getProperties(sel,data);if(!props)return;props.forEach(function(prop){if(prop.refreshMarkup){var id="#collapse_auth_prop_"+prop.name,$$panel=$(id);prop.refreshMarkup($$panel,prop,sel,data)}})},exports.savePanelStates=function(){_openPanels=[],$(".collapse.in","#authPanelControlSimple").each(function(){_openPanels.push($(this).attr("id"))})},exports.getPageVariants=function(page){var segs=page.split(".");return authoringSData.getPageVariants({application:segs[0],contract:segs[1],representation:segs[2],facet:segs[3]})},exports.saveAuthoring=function(page,opts){return $.smResolve().then(function(){var segs=page.split("."),pageData={application:segs[0],contract:segs[1],representation:segs[2],facet:segs[3],roles:[],users:[],endpoints:[],saveAsOption:opts.variantType,variantCode:opts.code,variantTitle:opts.title,variantDescription:opts.description,article:opts.article,variant:opts.uuid};return pageData.saveAsOption==="personal_copy"&&pageData.users.push({$uuid:globals.getUserUuid()}),pageData}).then(function(pageData){var promise=authoringSData.savePageDefinition(pageData),isCreation=pageData.variant==null;return isCreation?promise.then(function(data){var view=data.$actions.saveAs.$links.$view;view.$selected=!0;var page=globals.getApplication().currentPage,segs=page.state.authoringName.split(".");return authoringSData.getPageVariants({application:segs[0],contract:segs[1],representation:segs[2],facet:segs[3]}).then(function(variants){return page.variants=variants,page.views=page.views||[],page.views.forEach(function(view){view.$selected=!1}),page.views.push(view),view})}):promise})},exports.getPropertiesVariants=function(page){var propertiesVariants=[],properties={},viewSelected,isPersonal,self=this;return!page||!page.views||!page.views.length||!page.variants||page.variants.length===0?propertiesVariants:(viewSelected=$.smFind(page.views,function(view){return view.$selected}),page.variants.forEach(function(variant){isPersonal=!variant.$factory&&(!variant.roles||!variant.roles.length)&&(!variant.endpoints||!variant.endpoints.length)&&variant.users&&variant.users.length===1,properties={description:variant.description,isFactory:variant.$factory,isPersonal:isPersonal,isGlobal:!variant.$factory&&!isPersonal,title:variant.title,code:variant.code,comment:variant.comment,factoryOwner:variant.$factoryOwner,uuid:variant.$uuid,isSelected:viewSelected!=null&&viewSelected.$url&&viewSelected.$url.indexOf(variant.$uuid)>-1},propertiesVariants.push(properties)}),propertiesVariants)},exports.getPropertiesCurrentVariant=function(page){var properties={};if(!page||!page.views||!page.views.length||!page.variants||!page.variants.length)return properties;var viewSelected=$.smFind(page.views,function(view){return view.$selected});if(!viewSelected)return properties;var variantSelected=$.smFind(page.variants,function(variant){return viewSelected.$url.indexOf(variant.$uuid)>-1?!0:!1});if(!variantSelected)return properties;var isPersonal=!viewSelected.$isFactory&&!variantSelected.roles.length&&!variantSelected.endpoints.length&&variantSelected.users.length===1;return properties={description:viewSelected.$description,isFactory:viewSelected.$isFactory,isPersonal:isPersonal,isGlobal:!viewSelected.$isFactory&&!isPersonal,title:viewSelected.$title,url:viewSelected.$url,code:variantSelected.code,comment:variantSelected.comment,factoryOwner:variantSelected.$factoryOwner,uuid:variantSelected.$uuid},properties},exports.rebuildArticleByPageStruct=function(page,states){function _copyLocNode(uuid){Object.keys($localization).forEach(function(lang){var texts=$localizationNew[lang]=$localizationNew[lang]||{};texts[uuid]=$localization[lang][uuid]})}function _findLocMatch(text){var oldTexts=$localization[curLang]||{},match;return Object.keys(oldTexts).some(function(uuid){return oldTexts[uuid]===text?(match=uuid,!0):!1}),match}function _checkLocalization(nodeArticle){var propsPerNode=["$title"];propsPerNode.forEach(function(key){var text=nodeArticle[key];nodeArticle.$theme==="advanced"&&(text="",nodeArticle[key]="");if(text){var uuid=text.match(/\{\@(\S+)\}/);if(uuid&&uuid[1])_copyLocNode(uuid[1]);else{uuid=_findLocMatch(text);if(!uuid){var keepKey=nodeArticle.keepKey?nodeArticle.keepKey.match(/\{\@(\S+)\}/):null;uuid=keepKey?keepKey[1]:utils.UUID(),keepKey&&(_copyLocNode(uuid),delete nodeArticle.keepKey);var texts=$localizationNew[curLang]=$localizationNew[curLang]||{};texts[uuid]=text}else _copyLocNode(uuid);nodeArticle[key]="{@"+uuid+"}"}}})}function _walkNode(article,node){var nodeArticle=node.getAuthArticle();_checkLocalization(nodeArticle);if(states){var state=node.getAuthState(nodeArticle.$isDirty||{});if(state){var path=node.getPathInTree();path=path.join("."),states[path]=state}}delete nodeArticle.$isDirty,Object.keys(nodeArticle).forEach(function(key){article[key]=nodeArticle[key]});if(node.isVignette()){var page=node.getPage();if(page){var rootLayout=page.rootLayout;article.$article={},_walkNode(article.$article,rootLayout)}}else node.children&&node.children.length>0&&(article.$items=[],node.children.forEach(function(child){var childArticle={};article.$items.push(childArticle),_walkNode(childArticle,child)}))}var curLang=locale.getCurrentLocale(),rootLayout=page.rootLayout,$localization=page.article&&page.article.$localization||{},$localizationNew={},jsonArticlePage={};utils.authCopyPageProperties(page.article,jsonArticlePage),_walkNode(jsonArticlePage,rootLayout),jsonArticlePage.$localization=$localizationNew;var articleJSON=authVal.toSortedJSON(jsonArticlePage);return articleJSON}}),define("syracuse-tablet/html/js/authoring/authoringPanelRight",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/authoring/authoringHelpers","syracuse-tablet/html/js/authoring/authoringHtml"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),globals=require("syracuse-tablet/html/js/helpers/globals"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),authHelpers=require("syracuse-tablet/html/js/authoring/authoringHelpers"),authHtml=require("syracuse-tablet/html/js/authoring/authoringHtml");exports.Panel=utils.defineClass(function AuthoringPanelRight(){var self=this;self.$$panel=null,self.topButtons=[]},null,{show:function(){var self=this;self._ensurePanel(),self._subscribe(),self.$$panel.show(),self.$$splitter.show(),self._minWidth=4*globals.getSiteLayout().splitterWidth,self._initDefaults(),$(".btn",self.$$panelSave).eq(0).button("toggle"),$('.nav-pills a[href="#authPanelControl"]').tab("show")},hide:function(){var self=this;self._ensurePanel(),self.$$panel.hide(),self.$$splitter.hide(),self._unscribe()},_subscribe:function(){var self=this;notifications.subscribe(self,["sm.main.layout.changed"]),notifications.subscribe(self,["sm.auth.set.page"]),notifications.subscribe(self,["sm.auth.set.selection"]),notifications.subscribe(self,["sm.auth.change.prop.ui"]),notifications.subscribe(self,["sm.auth.top.button"])},_unscribe:function(){var self=this;notifications.unsubscribe(self,["sm.main.layout.changed"]),notifications.unsubscribe(self,["sm.auth.set.page"]),notifications.unsubscribe(self,["sm.auth.set.selection"]),notifications.unsubscribe(self,["sm.auth.change.prop.ui"]),notifications.unsubscribe(self,["sm.auth.top.button"])},notifMainLayoutChanged:function(){var self=this;self.$$panel.find(".tab-content").css({height:self.$$panel.height()-100})},_ensurePanel:function(){var self=this;if(this.$$panel)return;var ctx={label_design:locale.text("auth.panel.label_design")};self.$$panel=$("#s-m-auth-panel-right-id"),$(authHtml.execute("authPanelRightStructure",ctx)).appendTo(self.$$panel),self.$$panelRightStruct=self.$$panel.find("#authPanelControlTitle"),self._getDomObjects(),self._initSplitter(),self._initDomEvents()},_getDomObjects:function(){var self=this;self.$$panelControlSimple=$("#authPanelControlSimple"),self.$$panelControlExpert=$("#authPanelControlExpert"),self.$$authPageName=$("#authPageName"),self.$$panelControlTitle=$("#authPanelControlTitle"),self.$$panelControlType=$("#authPanelControlType"),self.$$panelEdit=$("#authPanelEdit")},_initDomEvents:function(){var self=this},_initDefaults:function(){var self=this;self.$$panelControlTitle.text(""),self.$$panelControlType.text(locale.text("auth.panel.label_design")),self.destroyPropertyPanel()},destroyPropertyPanel:function(context){if(this.topButtons){var preserveButtons=[];this.topButtons.forEach(function(prop){prop.destroyButtonMarkup&&prop.destroyButtonMarkup(context)===!1&&preserveButtons.push(prop)}),this.topButtons=preserveButtons}this._propertyPanel&&(this._propertyPanel.destroy(),this._propertyPanel=null)},notifAuthSetPage:function(page){var self=this;self.currentPageName=page.state.authoringName,self.currentPageId=page.id,self.$$authPageName.text(self.currentPageName),self._initDefaults();var saveAttr;page.state.type=="carddesign"?saveAttr="saveCardDesign":page.state.type=="chartdetail"&&(saveAttr="saveChartDetail"),saveAttr?$("#auth-btn-save-id").attr("data-save-type",saveAttr):$("#auth-btn-save-id").removeAttr("data-save-type")},notifAuthChangePropUi:function(articlePage){var self=this},notifAuthSetSelection:function(id){var self=this;self.$$panelControlTitle.text(""),self.$$panelControlType.text(locale.text("auth.panel.label_design"));var sel=id?authHelpers.getSelectionById(id):null;authHelpers.savePanelStates(),self.destroyPropertyPanel({origin:"selection"});var data;if(sel){data=authHelpers.getSelectionData(sel);if(data){self.$$panelControlTitle.text(data.title||""),self.$$panelControlType.text(locale.text("auth.panel.label_design")+" "+data.type||"");var article=data.articleSelection;article&&(this._propertyPanel=authHelpers.createPropertyPanel(self.$$panelControlSimple,sel,data))}}if(globals.isAutoUITestMode()){var i=data?data.control?data.control.getUnitTestId():data.page.state.name:null;globals.getUnitTestMgr().authAddRightPanelId(self.$$panelControlTitle.parent(),i)}},getPageArticle:function(){return this.getPage().article},getPage:function(){var page=$("#s-m-app-id").find("#"+this.currentPageId).smPageController();if(!page)throw new Error("Page not found "+this.currentPageId);if(!page.isActive())throw new Error("Page not active "+this.currentPageId);return page},_initSplitter:function(){var self=this;self.$$splitter=$("#s-m-auth-splitter-right-id"),self.$$splitter.draggable({axis:"x",stop:function(e,ui){var $$splitter=$(this),pos=$$splitter.position(),width=$$splitter.width(),panelRightSize=Math.max(self._minWidth,$(window).width()-pos.left-width);$$splitter.css({left:$(window).width()-panelRightSize-width+"px"}),authHelpers.triggerResizeInternal({layout:{authPanelRight:{width:panelRightSize}}})}})},notifAuthTopButton:function(action,prop){if(!this.$$panelRightStruct||!prop.createButtonMarkup)return;this.topButtons.push(prop),this.$$panelRightStruct.after(prop.createButtonMarkup(this.getPage()))}})}),define("syracuse-tablet/html/js/authoring/authoringDrag",["require","exports","module","syracuse-tablet/html/js/authoring/authoringHelpers","syracuse-tablet/html/js/controls/ctrlFactory","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/globals"],function(require,exports,module){function _updateHoverStack(){var newList=[];$.each(_$$lastElements,function(idx,$$last){$$last.removeClass("s-m-top-stack"),$$last.hasClass("s-m-auth-hover-droptarget")&&newList.push($$last)});var $$last=newList[newList.length-1];return $$last&&$$last.addClass("s-m-top-stack"),_$$lastElements=newList,$$last}function _updateDragHelper($$drop,$$helper,$$draggable){var data=_getDropData($$drop,$$draggable),allowed=_isDropAllowed(data);$$helper.removeClass("drop_move"),$$helper.removeClass("drop_add"),$$helper.removeClass("drop_disabled");if(!allowed){$$helper.addClass("drop_disabled"),$("#s-m-auth-drag-helper-desc-id",$$helper).text("");return}var desc="",title;data.moveBeforeCtrl?title=_controlTitle(data.moveBeforeCtrl):title=_controlTitle(data.toContainer);switch(data.action){case"add_layout":data.moveBeforeCtrl?desc=locale.text("auth.drag.add.before",[title]):desc=locale.text("auth.drag.add.intoend",[title]),$$helper.addClass("drop_add");break;case"add_bind":data.moveBeforeCtrl?desc=locale.text("auth.drag.add.before",[title]):desc=locale.text("auth.drag.add.intoend",[title]),$$helper.addClass("drop_add");break;case"move_ctrl":data.moveBeforeCtrl?desc=locale.text("auth.drag.move.before",[title]):desc=locale.text("auth.drag.move.intoend",[title]),$$helper.addClass("drop_move");break;case"move_layout":data.moveBeforeCtrl?desc=locale.text("auth.drag.move.before",[title]):desc=locale.text("auth.drag.move.intoend",[title]),$$helper.addClass("drop_move")}$("#s-m-auth-drag-helper-desc-id",$$helper).text(desc)}function _isDropAllowed(data){if(!data.toType)return!1;var targetLayout,container;data.ctrl&&(data.container=data.ctrl.parent),data.toCtrl&&data.toCtrl.isLayout()?(container=data.toCtrl,targetLayout=data.toType):data.toCtrl&&(container=data.toCtrl.parent,targetLayout=container.$type,data.moveBeforeCtrl=data.toCtrl),data.toContainer=container;if(data.action==="add_layout"){if(data.bind=="stack"){if(targetLayout!=="stack"&&targetLayout!=="cell"&&targetLayout!=="tile")return!1}else if(data.bind=="group"){if(targetLayout!=="stack"&&targetLayout!=="hub")return!1}else if(data.bind=="tile"&&targetLayout!=="row"&&targetLayout!=="hubGroup"&&targetLayout!=="stack"&&targetLayout!=="hub")return!1;return!0}if(data.action==="add_bind"){if(data.parent!=data.toParent)return!1;if(targetLayout==="stack"||targetLayout==="tile"||targetLayout==="cell"||targetLayout==="hubGroup")return!0}if(data.action==="move")if(data.ctrl&&!data.ctrl.isLayout()){data.action="move_ctrl";if(data.parent!=data.toParent)return!1;if(targetLayout==="stack"||targetLayout==="tile"||targetLayout==="cell"||targetLayout==="hubGroup")return!0}else if(data.ctrl&&data.ctrl.isLayout()){data.action="move_layout";if(data.type=="stack"){if(targetLayout!=="stack"&&targetLayout!=="cell"&&targetLayout!=="tile")return!1}else if(data.type=="tile"){if(targetLayout!=="hubGroup")return!1}else if(data.type=="cell"){if(targetLayout!=="row")return!1}else if(data.type=="row"){if(targetLayout!=="stack"&&targetLayout!=="cell"&&targetLayout!=="tile")return!1}else if(data.type=="hubGroup"&&targetLayout!=="hub")return!1;var $$dropToChildren=data.toCtrl.$$elmt.closest("#"+data.ctrl.id);if($$dropToChildren.length>0)return!1;var vignetteScopeOk=!0,$$fromVignette=data.ctrl.$$elmt.closest(".s-m-control.s-m-vignette"),$$toVignette=data.toCtrl.$$elmt.closest(".s-m-control.s-m-vignette");return $$fromVignette.length!==$$toVignette.length?vignetteScopeOk=!1:$$toVignette.length===0?vignetteScopeOk=!0:$$fromVignette.length===1&&$$toVignette.length===1&&($$fromVignette.attr("id")===$$toVignette.attr("id")?vignetteScopeOk=!0:vignetteScopeOk=!1),vignetteScopeOk}return!1}function _getDropData($$drop,$$draggable){var action,fromId,toId,bind,parent;action=$$draggable.attr("data-auth-drag-action");switch(action){case"move":fromId=$$draggable.attr("data-ctrl-id");break;case"add_bind":bind=$$draggable.attr("data-auth-bind"),parent=$$draggable.attr("data-auth-bind-parent"),parent=parent===""?null:parent;break;case"add_layout":bind=$$draggable.attr("data-auth-bind");break;default:action="move",fromId=$$draggable.attr("id")}var ctrl,$$ctrl;if(fromId&&fromId.length>0){$$ctrl=$("#"+fromId),ctrl=authHelpers.findControl($$ctrl);var v=ctrl&&ctrl.controller.getParentVignette();v&&(parent=v.$bind)}toId=$$drop.attr("data-ctrl-id"),toId&&toId.length>0?$$ctrl=$("#"+toId):(toId=$$drop.attr("id"),$$ctrl=$$drop);var toParent,toCtrl=authHelpers.findControl($$ctrl);if(toCtrl&&toCtrl.controller.isVignette){var v=toCtrl.controller.getParentVignette();v&&(toParent=v.$bind)}return!toCtrl&&$$ctrl.is(".s-m-page,.s-m-full")&&(toCtrl=globals.getApplication().currentPage.rootLayout),{action:action,bind:bind,ctrl:ctrl,type:ctrl&&ctrl.$type,parent:parent,fromId:fromId,toId:toId,toType:toCtrl&&toCtrl.$type,toCtrl:toCtrl,toParent:toParent}}function _addLayout(data){var layoutType="stack",toContainer=data.toContainer,parent;switch(data.bind){case"group":data.toType=="hub"?layoutType="hubGroup":layoutType="row";break;case"tile":data.toType=="hubGroup"?layoutType="tile":data.toType=="row"?layoutType="cell":data.toType=="stack"?(parent=ctrlFactory.createLayout(data.toCtrl.controller,toContainer,{$layoutType:"row"},{}),layoutType="cell",toContainer=parent):data.toType=="hub"&&(parent=ctrlFactory.createLayout(data.toCtrl.controller,toContainer,{$layoutType:"hubGroup"},{}),layoutType="tile",toContainer=parent);break;case"stack":layoutType="stack"}var article={$layoutType:layoutType},ctrl=ctrlFactory.createLayout(data.toCtrl.controller,toContainer,article,{});data.moveBeforeCtrl&&(parent?(data.toContainer.removeChildRef(parent),data.toContainer.addChildBefore(parent,data.moveBeforeCtrl)):(toContainer.removeChildRef(ctrl),toContainer.addChildBefore(ctrl,data.moveBeforeCtrl))),notifications.publish(["sm.auth.change.item.prop.ui"])}function _addBind(data){var article={$bind:data.bind},toContainer=data.toContainer;if(data.toType=="hubGroup"){var parent=ctrlFactory.createLayout(data.toCtrl.controller,toContainer,{$layoutType:"tile"},{});toContainer=parent}var ctrl=ctrlFactory.createBindControl(data.toCtrl.controller,toContainer,article,{});data.moveBeforeCtrl&&(data.toContainer.removeChildRef(ctrl),data.toContainer.addChildBefore(ctrl,data.moveBeforeCtrl)),notifications.publish(["sm.auth.change.item.prop.ui"])}function _moveControl(data){data.container.removeChildRef(data.ctrl);var toContainer=data.toContainer;if(data.toType=="hubGroup"){var parent=ctrlFactory.createLayout(data.toCtrl.controller,toContainer,{$layoutType:"tile"},{});toContainer.removeChildRef(parent),toContainer.addChildBefore(parent,data.moveBeforeCtrl),parent.addChildBefore(data.ctrl,null)}else toContainer.addChildBefore(data.ctrl,data.moveBeforeCtrl);notifications.publish(["sm.auth.change.item.prop.ui"])}function _moveLayout(data){data.container.removeChildRef(data.ctrl),data.toContainer.addChildBefore(data.ctrl,data.moveBeforeCtrl),notifications.publish(["sm.auth.change.item.prop.ui"])}function _controlTitle(ctrl){var title=ctrl.prototype&&ctrl.prototype.data("$title");return title?ctrl.$bind&&(title=title+" ("+ctrl.$bind+")"):title=ctrl.$bind,title||(title=ctrl.$type),title}var authHelpers=require("syracuse-tablet/html/js/authoring/authoringHelpers"),ctrlFactory=require("syracuse-tablet/html/js/controls/ctrlFactory"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),locale=require("syracuse-tablet/html/js/helpers/locale"),globals=require("syracuse-tablet/html/js/helpers/globals"),_$$lastElements=[];exports.getClosestDragElement=function($$source){var $$draggable=$$source.closest(".ui-draggable");return $$draggable},exports.dropDrop=function($$drop,$$helper,$$draggable){$$drop=_$$lastElements.length>0&&_$$lastElements[_$$lastElements.length-1],_$$lastElements=[];if(!$$drop)return;var data=_getDropData($$drop,$$draggable);if(!_isDropAllowed(data))return;data.action==="add_layout"?_addLayout(data):data.action=="add_bind"?_addBind(data):data.action=="move_ctrl"?_moveControl(data):data.action=="move_layout"&&_moveLayout(data)},exports.dropAccept=function($$drop,$$draggable){var data=_getDropData($$drop,$$draggable);return!0},exports.dropOut=function($$drop,$$helper,$$draggable){$$drop.removeClass("s-m-top-stack");var $$top=_updateHoverStack();$$top&&_updateDragHelper($$top,$$helper,$$draggable)},exports.dropOver=function($$drop,$$helper,$$draggable){_$$lastElements.push($$drop),_updateHoverStack(),_updateDragHelper($$drop,$$helper,$$draggable)}}),define("syracuse-tablet/html/js/authoring/authoringPanelLeft",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/authoring/authoringHelpers","syracuse-tablet/html/js/authoring/authoringHtml","syracuse-tablet/html/js/authoring/authoringDrag"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),locale=require("syracuse-tablet/html/js/helpers/locale"),globals=require("syracuse-tablet/html/js/helpers/globals"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),authHelpers=require("syracuse-tablet/html/js/authoring/authoringHelpers"),authHtml=require("syracuse-tablet/html/js/authoring/authoringHtml"),authDrag=require("syracuse-tablet/html/js/authoring/authoringDrag"),$$lastHoverList;exports.Panel=utils.defineClass(function AuthoringPanelLeft(){var self=this;self.$$panel=null,self.$$page=$("#s-m-app-id"),self._bindsOnPage=[]},null,{show:function(){var self=this;self._ensurePanel(),self._subscribe(),self.$$panel.show(),self.$$splitter.show(),self._minWidth=2*globals.getSiteLayout().splitterWidth,self.$$panel.find(".s-m-site-auth-panel-content > ul.nav.nav-pills > li").each(function(){self._minWidth+=$(this).outerWidth()})},hide:function(){var self=this;self._ensurePanel(),self.$$panel.hide(),self.$$splitter.hide(),self._unscribe()},_subscribe:function(){var self=this;notifications.subscribe(self,["sm.main.layout.changed"]),notifications.subscribe(self,["sm.auth.set.page"]),notifications.subscribe(self,["sm.auth.change.prop.ui"]),notifications.subscribe(self,["sm.auth.set.selection"]),notifications.subscribe(self,["sm.auth.remove.selection"]),notifications.subscribe(self,["sm.auth.hover.in"]),notifications.subscribe(self,["sm.auth.hover.out"]),notifications.subscribe(self,["sm.page.loaded"])},_unscribe:function(){var self=this;notifications.unsubscribe(self,["sm.main.layout.changed"]),notifications.unsubscribe(self,["sm.auth.set.page"]),notifications.unsubscribe(self,["sm.auth.change.prop.ui"]),notifications.unsubscribe(self,["sm.auth.set.selection"]),notifications.unsubscribe(self,["sm.auth.remove.selection"]),notifications.unsubscribe(self,["sm.auth.hover.in"]),notifications.unsubscribe(self,["sm.auth.hover.out"]),notifications.unsubscribe(self,["sm.page.loaded"])},notifMainLayoutChanged:function(){var self=this;$("#s-m-auth-tree-box",self.$$panel).css({height:self.$$panel.height()-45}),$("#s-m-auth-insert-box",self.$$panel).css({height:self.$$panel.height()-40})},_ensurePanel:function(){var self=this;if(this.$$panel)return;var ctx={label_content:locale.text("auth.panel.label_content"),label_insert:locale.text("auth.panel.label_insert"),label_containers:locale.text("auth.panel.label_containers"),label_fields:locale.text("auth.panel.label_fields"),lab_drag_to_add:locale.text("auth.label_layout.drag"),lab_group:locale.text("auth.label_layout.group"),lab_tile:locale.text("auth.label_layout.tile"),lab_stack:locale.text("auth.label_layout.stack")};self.$$panel=$("#s-m-auth-panel-left-id"),self.$$panel.append($(authHtml.execute("authPanelLeftStructure",ctx))),self._getDomObjects(),self._initSplitter()},_getDomObjects:function(){var self=this;self.$$structureRoot=$("#auth-structure-root-id",self.$$panel),self.$$prototypeRoot=$("#auth-lp-cnt-props-clpse",self.$$panel)},_initSplitter:function(){var self=this;self.$$splitter=$("#s-m-auth-splitter-left-id"),self.$$splitter.draggable({axis:"x",stop:function(e,ui){var $$splitter=$(this),pos=$$splitter.position(),width=$$splitter.width(),panelLeftSize=Math.max(self._minWidth,pos.left);$$splitter.css({left:panelLeftSize+"px"}),authHelpers.triggerResizeInternal({layout:{authPanelLeft:{width:panelLeftSize}}})}})},notifAuthSetPage:function(page){var self=this;self._resetContent(page.article)},notifAuthChangePropUi:function(articlePage){var self=this,article=JSON.parse(articlePage);self._resetContent(article)},notifPageLoaded:function(page){var self=this;globals.getCurrentPage().isDashboard()&&self._resetContent(globals.getCurrentPage().article)},_resetContent:function(article){var self=this;self._buildPageStructTree(),self._buildProtoStructTree(),self._initDomEvents(),self._initDrag()},notifAuthSetSelection:function(id){var self=this,$$item=self._getItemById(id);if($$item.length>0){$$item.addClass("s-m-auth-selected");var $$tb=$("#s-m-auth-tree-box",self.$$panel),o1=$$tb.offset(),o2=$$item.offset();if(o2.top<o1.top||o2.top>o1.top+$$tb.height()){var scroll=o2.top-(o1.top+$$tb.height()/2);$("#s-m-auth-tree-box",self.$$panel).animate({scrollTop:scroll},500)}}},notifAuthRemoveSelection:function(id){var self=this,$$item=self._getItemById(id);$$item.removeClass("s-m-auth-selected")},notifAuthHoverIn:function(id){var self=this,$$item=self._getItemById(id);$$item.addClass("s-m-auth-hover")},notifAuthHoverOut:function(id){var self=this,$$item=self._getItemById(id);$$item.removeClass("s-m-auth-hover")},_getItemById:function(id){var self=this;return $('[data-ctrl-id="'+id+'"]',self.$$panel)},_buildPageStructTree:function(){function _walkNode(node,$$parent,bindParent,level){var nodeArticle=node.getArticle(),id=node.id,typeClass,label;if(level===1){node.children&&node.children.length>0&&node.children.forEach(function(child){if(child.article.$noAuthoring)return;var $$ul=$('<ul class="s-m-auth-tree">').appendTo($$parent);_walkNode(child,$$ul,bindParent,level+1)});return}if(node.isControl()){var title=node.prototype&&node.prototype.data("$title");typeClass=node.typeName,label=title?title:nodeArticle.$bind;var bind=bindParent!=null?bindParent+"."+node.$bind:node.$bind;self._bindsOnPage.push(bind)}else typeClass=nodeArticle.$layoutType||node.typeName,label=nodeArticle.$title?node.getArticleText("$title")+" ("+typeClass+")":typeClass;var $$item=$('<li class="s-m-auth-tree s-m-auth-tree-'+typeClass+'">').appendTo($$parent);if(globals.isAutoUITestMode()&&node.getUnitTestId){var i=node.getUnitTestId();i&&globals.getUnitTestMgr().authAddTreeElmtId($$item,i)}var $$p=$('<p title="'+nodeArticle.$bind+'" data-ctrl-id="'+id+'" class="s-m-draggable s-m-droppable" data-auth-drag-action="move">'+label+"</p>");$$item.append($$p);if(node.isVignette()){self._bindsOnPage.push(node.$bind);var page=node.getPage();if(page){var rootLayout=page.rootLayout,$$ul=$('<ul class="s-m-auth-tree">').appendTo($$item),$$li=_walkNode(rootLayout,$$ul,node.$bind,level+1);$(">p",$$li).removeClass("s-m-draggable")}}else node.children&&node.children.length>0&&node.children.forEach(function(child){if(child.article.$noAuthoring)return;var $$ul=$('<ul class="s-m-auth-tree">').appendTo($$item);_walkNode(child,$$ul,bindParent,level+1)});return $$item}var self=this;self._bindsOnPage=[];var page=globals.getApplication().currentPage,rootLayout=page.rootLayout,label=page.prototype.data("$title")||locale.text("page");self.$$structureRoot.empty();var $$item=$('<li class="s-m-auth-tree s-m-auth-tree-page">').appendTo(self.$$structureRoot);$$item.append('<p data-ctrl-id="'+page.id+'">'+label+"</p>");var $$ul=$('<ul class="s-m-auth-tree">').appendTo($$item),$$li=_walkNode(rootLayout,$$ul,null,1);$(">p",$$li).removeClass("s-m-draggable")},_buildProtoStructTree:function(){var self=this,page=globals.getApplication().currentPage,label=page.prototype.data("$title");self.$$prototypeRoot.empty();var $$item=$('<li class="s-m-auth-tree s-m-auth-tree-page">').appendTo(self.$$prototypeRoot);$$item.append('<p data-ctrl-id="'+page.id+'">'+label+"</p>");var $$ul=$('<ul class="s-m-auth-tree">').appendTo($$item);if(jsutils.isInstanceOf(page,"DashboardPage")){var props=page.prototype.getPropertyNames();props.forEach(function(key){self._addVignette(page,key,$$ul)})}else self._addPage(page,$$ul)},_addVignette:function(page,vignette,$$parent){var self=this,proto=page.prototype,prop=proto.property(vignette),title=proto.property(vignette,"$title"),label=title?title+" ("+vignette+")":vignette,$$item=$('<li class="s-m-auth-tree s-m-auth-tree-vignette">').appendTo($$parent);$$item.append('<p class="s-m-draggable" data-auth-bind="'+vignette+'"  data-auth-drag-action="add_bind">'+label+"</p>");var ctrlVignette=page.getControlByBind(vignette);if(ctrlVignette){$$item.removeClass("s-m-draggable"),$$item.addClass("disabled"),page=ctrlVignette.getPage();if(page){var $$ul=$('<ul class="s-m-auth-tree">').appendTo($$item);self._addPage(page,$$ul,vignette);var $$children=$("li",$$ul);self._bindsOnPage.indexOf(vignette)>-1&&$$children.length<=0&&$$item.remove(),$$children.length<=0&&$$ul.remove()}else self._bindsOnPage.indexOf(vignette)>-1&&$$item.remove()}},_addPage:function(page,$$parent,bindParent){var self=this,label="?",proto=page.prototype,props=proto.getPropertyNames();props.forEach(function(key){if(proto.property(key,"$isExcluded")!==!0){var bind=bindParent!=null?bindParent+"."+key:key;if(self._bindsOnPage.indexOf(bind)<0){var title=proto.property(key,"$title"),type=proto.property(key,"$type"),typeClass=utils.getTypeName(type),label=title?title+" ("+key+")":key,$$item=$('<li class="s-m-auth-tree s-m-auth-tree-'+typeClass+'">').appendTo($$parent);$$item.append('<p class="s-m-draggable" data-auth-bind="'+key+'" data-auth-bind-parent="'+(bindParent||"")+'" data-auth-drag-action="add_bind">'+label+"</p>")}}})},_initDomEvents:function(){var self=this;$("li.s-m-auth-tree > p",$("#auth-structure-root-id")).not("li.s-m-auth-hidden > p").mouseover(function(e){var $$o=$(e.currentTarget);if($$lastHoverList){$$lastHoverList.removeClass("s-m-auth-hover");var id=$$lastHoverList.attr("id");notifications.publishEx(["sm.auth.hover.out"],{exclude:[self]},id)}$$o.addClass("s-m-auth-hover"),$$lastHoverList=$$o;var id=$$o.attr("data-ctrl-id");return notifications.publishEx(["sm.auth.hover.in"],{exclude:[self]},id),!1}),$("li.s-m-auth-tree > p",$("#auth-structure-root-id")).not("li.s-m-auth-hidden > p").mouseout(function(e){var $$o=$(e.currentTarget);$$o.removeClass("s-m-auth-hover");var id=$$o.attr("data-ctrl-id");notifications.publishEx(["sm.auth.hover.out"],{exclude:[self]},id)}),$("li.s-m-auth-tree > p",$("#auth-structure-root-id")).not("li.s-m-auth-hidden > p").click(function(e){return self.setSelection($(e.currentTarget),!1),!1}),$("li.s-m-auth-tree > p",$("#auth-structure-root-id")).not("li.s-m-auth-hidden > p").dblclick(function(e){return self.makeVisibleInPage($(e.currentTarget)),!1})},setSelection:function($$newSel,noScroll){var self=this,$$old=$(".s-m-auth-selected",self.$$panel);$$old.removeClass("s-m-auth-selected");var id=$$old.attr("data-ctrl-id");notifications.publishEx(["sm.auth.remove.selection"],{exclude:[self]},id),$$newSel?($$newSel.addClass("s-m-auth-selected"),id=$$newSel.attr("data-ctrl-id")):id=null,notifications.publishEx(["sm.auth.set.selection"],{exclude:[self]},id,noScroll==null?!0:noScroll)},makeVisibleInPage:function($$sel){var self=this;self.setSelection($$sel,!1)},_initDrag:function(){var self=this,dragParam={scroll:!1,containment:$("body"),helper:function(event){var $$source=$(event.target);return self._createDragHelper($$source)},appendTo:"body"};$(".s-m-draggable",self.$$panel).draggable(dragParam),$(".s-m-droppable",self.$$structureRoot).droppable({greedy:!0,hoverClass:"s-m-auth-hover-droptarget",tolerance:"pointer",drop:function(event,ui){var $$helper=ui.helper,$$draggable=ui.draggable;return authDrag.dropDrop($(this),$$helper,$$draggable)},accept:function($$draggable){return authDrag.dropAccept($(this),$$draggable)},over:function(event,ui){var $$helper=ui.helper,$$draggable=ui.draggable;return authDrag.dropOver($(this),$$helper,$$draggable)}})},_createDragHelper:function($$source){var $$dragSource=authDrag.getClosestDragElement($$source),text;if($$dragSource.attr("data-auth-drag-action")==="add_layout"){var name=$$dragSource.attr("data-auth-bind");text=locale.text("auth.drag."+name)}else text=$$dragSource.text();var $$helper=$('<div class="s-m-auth-drag-helper"><p id="s-m-auth-drag-helper-label-id">&nbsp;</p><p id="s-m-auth-drag-helper-desc-id">&nbsp;</p><div style="clear:both;"></div></div>');return $("#s-m-auth-drag-helper-label-id",$$helper).text(text),$$helper[0]}})}),define("syracuse-tablet/html/js/authoring/authoringPage",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/authoring/authoringHelpers","syracuse-tablet/html/js/authoring/authoringDrag"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),authHelpers=require("syracuse-tablet/html/js/authoring/authoringHelpers"),authDrag=require("syracuse-tablet/html/js/authoring/authoringDrag"),_selectedRecord="s-m-auth-rec-selected",$$lastHoverElement,_elementsNoAuthoring=[".s-m-array .s-m-control",".s-m-array .s-m-layout",".s-m-control.header",".s-m-control.footer",".s-m-control.navigationpanel",".s-m-control.pageactionpanelregular",".s-m-control.breadcrumbs",".s-m-control.toolbar",".s-m-control.s-m-field > .s-m-value.edit > .s-m-control.s-m-unit",".s-m-layout.s-m-hub",".s-m-main-content > .s-m-scroll-elmt > .s-m-stack",".s-m-main-content > .s-m-stack"];exports.AuthPage=utils.defineClass(function AuthPage(){var self=this;self.__onElementClick=self._onElementClick.bind(self),self.__onElementMouseOver=self._onElementMouseOver.bind(self),self.__onElementMouseOut=self._onElementMouseOut.bind(self),self.$$page=$("#s-m-app-id")},null,{enable:function(){var self=this;self._subscribe()},disable:function(){var self=this;self._unscribe()},enableAuthCss:function(){var self=this;self.disableAuthCss(),$(".s-m-control").addClass("s-m-auth"),$(".s-m-layout").addClass("s-m-auth"),$(".s-m-layout").addClass("s-m-auth"),$(".s-m-page").addClass("s-m-auth"),$("section.s-m-card").addClass("s-m-auth"),_elementsNoAuthoring.forEach(function(e){$(e).removeClass("s-m-auth")}),$(".s-m-auth",self.$$page).on("click",self.__onElementClick),$(".s-m-auth",self.$$page).on("mouseover",self.__onElementMouseOver),$(".s-m-auth",self.$$page).on("mouseout",self.__onElementMouseOut),self._enableDrop()},disableAuthCss:function(){var self=this;self._disableDrop();var $$smAuth=$(".s-m-auth",self.$$page);$$smAuth.off("click",self.__onElementClick),$$smAuth.off("mouseover",self.__onElementMouseOver),$$smAuth.off("mouseout",self.__onElementMouseOut),$$smAuth.removeClass("s-m-auth"),$(".s-m-record."+_selectedRecord,self.$$page).removeClass(_selectedRecord)},_subscribe:function(){var self=this;notifications.subscribe(self,["sm.auth.hover.in"]),notifications.subscribe(self,["sm.auth.hover.out"]),notifications.subscribe(self,["sm.auth.set.selection"]),notifications.subscribe(self,["sm.auth.remove.selection"])},_unscribe:function(){var self=this;notifications.unsubscribe(self,["sm.auth.hover.in"]),notifications.unsubscribe(self,["sm.auth.hover.out"]),notifications.unsubscribe(self,["sm.auth.set.selection"]),notifications.unsubscribe(self,["sm.auth.remove.selection"])},_enableDrop:function(){var self=this,dragParam={scroll:!1,containment:$("body"),tolerance:"pointer",helper:function(event){var $$source=$(event.target);return self._createDragHelper($$source)},appendTo:"body",revert:function($$drop){return"invalid"},start:function(){},stop:function(){}};$(".s-m-auth").droppable({greedy:!1,hoverClass:"s-m-auth-hover-droptarget",tolerance:"pointer",drop:function(event,ui){var $$helper=ui.helper,$$draggable=ui.draggable;return authDrag.dropDrop($(this),$$helper,$$draggable)},accept:function($$draggable){return authDrag.dropAccept($(this),$$draggable)},over:function(event,ui){var $$helper=ui.helper,$$draggable=ui.draggable;return authDrag.dropOver($(this),$$helper,$$draggable)},out:function(event,ui){var $$helper=ui.helper,$$draggable=ui.draggable;return authDrag.dropOut($(this),$$helper,$$draggable)}})},_disableDrop:function(){$(".s-m-auth.ui-droppable").droppable("destroy")},_createDragHelper:function($$source){var $$dragSource=authDrag.getClosestDragElement($$source),control=authHelpers.findControl($$dragSource);if(!control)return;var $$helper=$('<p class="s-m-auth-drag-helper">'),text;return control.prototype?(text=control.prototype.data("$title"),text?text=text+"("+control.$bind+")":text=control.$bind):(text=control.title,text?text=text+" ("+control.typeName+")":text=control.typeName),$$helper.text(text),$$helper[0]},_onElementClick:function(e){var self=this,$$o=$(e.currentTarget);if($$o.is("section.s-m-card")){$$o.closest("table").find(".s-m-record."+_selectedRecord).removeClass(_selectedRecord),$$o.closest(".s-m-record").addClass(_selectedRecord);return}var id=this.getCurrentSelected().removeClass("s-m-auth-selected").attr("id");id&&notifications.publishEx(["synch.sm.auth.remove.selection"],{exclude:[self]},id),id=$$o.addClass("s-m-auth-selected").attr("id"),notifications.publishEx(["synch.sm.auth.set.selection"],{exclude:[self]},id);if(utils.stopClickEvent(e))return!1},_onElementMouseOver:function(e){var self=this,$$o=$(e.currentTarget);return $$lastHoverElement&&($$lastHoverElement.removeClass("s-m-auth-hover"),notifications.publishEx(["sm.auth.hover.out"],{exclude:[self]},$$lastHoverElement.attr("id"))),notifications.publishEx(["sm.auth.hover.in"],{exclude:[self]},$$o.attr("id")),$$o.addClass("s-m-auth-hover"),$$lastHoverElement=$$o,!1},_onElementMouseOut:function(e){var self=this,$$o=$(e.currentTarget);$$o.removeClass("s-m-auth-hover"),notifications.publishEx(["sm.auth.hover.out"],{exclude:[self]},$$o.attr("id"))},notifAuthHoverIn:function(id){var self=this,$$pageItem=self._getItemById(id);$$pageItem.addClass("s-m-auth-hover")},notifAuthHoverOut:function(id){var self=this,$$pageItem=self._getItemById(id);$$pageItem.removeClass("s-m-auth-hover")},notifAuthSetSelection:function(id,noScroll){var self=this,$$item=self._getItemById(id);$$item&&$$item.length>0&&($$item.addClass("s-m-auth-selected"),noScroll!==!0&&self._scrollToVisibleArea($$item))},notifAuthRemoveSelection:function(id){var self=this,$$item=self._getItemById(id);$$item.removeClass("s-m-auth-selected")},_getItemById:function(id){return $("#"+id,this.$$page)},getCurrentSelectionId:function(){return this.getCurrentSelected().attr("id")},getCurrentSelected:function(){return $(".s-m-auth-selected:visible",this.$$page)},_scrollToVisibleArea:function($$item){var self=this,page=globals.getApplication().currentPage,scroller=page&&page._gestureMgr||page&&page.rootLayout&&page.rootLayout._gestureMgr;scroller&&scroller.makeVisible($$item)}})}),define("syracuse-tablet/html/js/ui/modals/modalChooseDevice",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalDialog"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),_templateAll={header:'			<buttons class="pull-right"> 				<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 			</buttons> 			<div class="modal-title">{{title}}</div> 			',content:' 			<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">				<div class="form-group s-m-scroll-element"> 					<div class="list-group" id="modal-device-select-list-id"> 						{{#each devices}} 							<a draggable="false" href="#" class="list-group-item" data-action="clickDevice" data-params="{{name}}">{{label}}</a> 						{{/each}} 					</div> 				</div> 		    </div>',footer:""},_Klass=utils.defineClass(function ModalChooseDevice(device){var self=this;modalDialog.ModalBase.call(self),self.selectedDevice=device},modalDialog.ModalBase,{_getTemplates:function(){var self=this;return{std:_templateAll}},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="config-tile half_right":displayFlags.modalClass="config-tile full",displayFlags},_getDataContext:function(){var self=this,devices=[],site=globals.getSiteLayout(),devs=site.getDeviceTemplates();for(var dev in devs)devices.push({name:dev,label:locale.textOpt("auth.device."+dev+".title")||dev});var data={title:locale.text("auth.device.title"),devices:devices};return data},_onShow:function(){var self=this;modalDialog.ModalBase.prototype._onShow.call(self),$('a[data-params="'+self.selectedDevice+'"]').addClass("active")},_onValidate:function(){},_onCancel:function(){var self=this;self.selectedApps={}},_onAction:function(action,param){var self=this;return action==="clickDevice"?(self.selectedDevice=param,!0):!1},_getResult:function(){var self=this;return self.selectedDevice}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/ui/modals/modalNewLayout",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalDialog"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),_templateAll={header:'		<buttons class="pull-right"> 			<button type="button" class="btn btn-default s-m-modal-btn-validate" data-action="$validate"></button> 			<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 		</buttons> 		<div class="modal-title">{{title}}</div> 			',content:' 			<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">				<div class="alert alert-warning" role="alert"> 					{{warning}} 				</div> 				<div class="form-group" id="dir"> 					<label>{{lab_dir}}</label>         			<div class="btn-group btn-group-vertical btn-group-justified" data-toggle="buttons"> 						<label class="btn btn-default {{#if horizontal}}active{{/if}}"> 							<input type="radio" id="horizontal" name="scroll" value="horizontal" {{#if horizontal}}checked{{/if}}/>{{lab_horizontal}}						</label> 						<label class="btn btn-default {{#unless horizontal}}active{{/unless}}"> 							<input type="radio" id="vertical" name="scroll" value="vertical" {{#unless horizontal}}checked{{/unless}}/>{{lab_vertical}}						</label> 					</div> 				</div> 				<div class="form-group" id="tpl"> 					<label>{{lab_tpl}}</label> 					<div class="btn-group btn-group-vertical btn-group-justified" data-toggle="buttons"> 						<label class="btn btn-default {{#if template}}active{{/if}}"> 							<input type="radio" id="template" name="empty" value="true" {{#if template}}checked{{/if}}/>{{lab_template}}						</label> 						<label class="btn btn-default {{#unless template}}active{{/unless}}"> 							<input type="radio" id="empty" name="empty" value="false" {{#unless template}}checked{{/unless}}/>{{lab_empty}}						</label> 					</div> 				</div> 			</div>',footer:""},_Klass=utils.defineClass(function ModalNewLayout(_defaults){var self=this;modalDialog.ModalBase.call(self),self._defaults=_defaults,self.result=null},modalDialog.ModalBase,{_getTemplates:function(){var self=this;return{std:_templateAll}},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="half_right":displayFlags.modalClass="full",displayFlags},_getDataContext:function(){var self=this,data={label_validate:locale.text("modal.ok"),label_cancel:locale.text("modal.cancel"),title:locale.text("modal.newlayout.title"),warning:locale.text("modal.newLayout.warning"),lab_horizontal:locale.text("modal.newLayout.horizontal"),lab_vertical:locale.text("modal.newLayout.vertical"),lab_template:locale.text("modal.newLayout.template"),lab_empty:locale.text("modal.newLayout.empty"),lab_dir:locale.text("modal.newLayout.dir"),lab_tpl:locale.text("modal.newLayout.tpl"),horizontal:self._defaults.scroll==="horizontal",template:self._defaults.template};return data},_onValidate:function(){var self=this,dir=self.$$elmt.find("#dir label.active input").val(),tpl=self.$$elmt.find("#tpl label.active input").val();self.result={scroll:dir,template:tpl==="true"}},_onCancel:function(){var self=this;self.result=null},_getResult:function(){var self=this;return self.result}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/authoring/authoringHeader",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/authoring/authoringHtml","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/ui/modals/modalChooseDevice","syracuse-tablet/html/js/authoring/authoringHelpers","syracuse-tablet/html/js/ui/modals/modalNewLayout"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),locale=require("syracuse-tablet/html/js/helpers/locale"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),authHtml=require("syracuse-tablet/html/js/authoring/authoringHtml"),globals=require("syracuse-tablet/html/js/helpers/globals"),modalChooseDevice=require("syracuse-tablet/html/js/ui/modals/modalChooseDevice"),authHelpers=require("syracuse-tablet/html/js/authoring/authoringHelpers"),modalNewLayout=require("syracuse-tablet/html/js/ui/modals/modalNewLayout");exports.Panel=utils.defineClass(function AuthoringPanelHeader(){var self=this;self.$$panel=null},null,{show:function(){var self=this;self._ensurePanel(),self._subscribe(),self.$$panel.show(),self._initDefaults()},hide:function(){var self=this;self._ensurePanel(),self.$$panel.hide(),self._unscribe()},_ensurePanel:function(){var self=this;if(this.$$panel)return;var ctx={label_settings:locale.text("auth.device.settings"),label_save:locale.text("auth.panel.label_save"),label_remove:locale.text("auth.panel.label_remove"),label_remove_container:locale.text("auth.panel.label_remove_container"),label_remove_all:locale.text("auth.panel.label_remove_all"),label_new_layout:locale.text("auth.panel.label_new_layout"),label_preview_portrait:locale.text("auth.panel.label_preview_portrait"),label_preview_landscape:locale.text("auth.panel.label_preview_landscape"),label_scale_to_fit:locale.text("auth.panel.label_scale_to_fit"),label_undo:locale.text("auth.label_undo"),label_undo_all:locale.text("auth.label_undo_all")};self.$$panel=$("#s-m-auth-panel-header-id"),self.$$panel.append($(authHtml.execute("authPanelHeader",ctx))),self._getDomObjects(),self._initDomEvents()},_getDomObjects:function(){var self=this;self.$$orientation=$("#s-m-auth-orientation-id",self.$$panel),self.$$removeItem=$("#s-m-auth-remove-id",self.$$panel),self.$$removeCnt=$("#s-m-auth-remove-cnt-id",self.$$panel),self.$$removeAllItems=$("#s-m-auth-remove-all-id",self.$$panel),self.$$newLayout=$("#s-m-auth-new-layout-id",self.$$panel),self.$$undo=$("#auth-btn-undo-id",self.$$panel),self.$$undoAll=$("#auth-btn-undo-all-id",self.$$panel)},_initDomEvents:function(){var self=this;$("#s-m-auth-settings-id").on("click",self._onChooseDevice.bind(self)),$("#s-m-auth-scale-id").on("click",self._onScaleDevice.bind(self)),$("#s-m-auth-vertical-id").on("click",self._onOrientation.bind(self)),$("#s-m-auth-horizontal-id").on("click",self._onOrientation.bind(self)),self.$$removeItem.on("click",self._onRemoveItem.bind(self)),self.$$removeCnt.on("click",self._onRemoveCnt.bind(self)),self.$$removeAllItems.on("click",self._onRemoveAllItems.bind(self)),self.$$newLayout.on("click",self._onNewLayout.bind(self)),self.$$undo.on("click",self._onUndo.bind(self)),self.$$undoAll.on("click",self._onUndoAll.bind(self)),$("#auth-btn-save-id").on("click",self._onSave.bind(self)),$("#auth-btn-close-id").on("click",self._onClose.bind(self))},_initDefaults:function(){var self=this},_subscribe:function(){var self=this;notifications.subscribe(self,["sm.main.layout.changed"]),notifications.subscribe(self,["sm.auth.set.selection"]),notifications.subscribe(self,["sm.auth.change.prop.ui"]),notifications.subscribe(self,["sm.auth.history.change"])},_unscribe:function(){var self=this;notifications.unsubscribe(self,["sm.main.layout.changed"]),notifications.unsubscribe(self,["sm.auth.set.selection"]),notifications.unsubscribe(self,["sm.auth.change.prop.ui"]),notifications.unsubscribe(self,["sm.auth.history.change"])},notifMainLayoutChanged:function(){var self=this,site=globals.getSiteLayout(),cur=site.getCurrentLayoutSettings();cur.pageParameters.forceAutoScale===!0?$("#s-m-auth-scale-id").addClass("active"):$("#s-m-auth-scale-id").removeClass("active"),cur.pageParameters.orientation==="landscape"?($("#s-m-auth-horizontal-id").addClass("active"),$("#s-m-auth-vertical-id").removeClass("active")):($("#s-m-auth-horizontal-id").removeClass("active"),$("#s-m-auth-vertical-id").addClass("active"))},notifAuthChangePropUi:function(articlePage){var self=this},notifAuthSetSelection:function(id){var self=this;self._currentSelectionId=id,self._enableRemoveBtn()},notifAuthHistoryChange:function(pageHistory){var self=this;pageHistory.length>0?(self.$$undo.removeClass("disabled"),self.$$undoAll.removeClass("disabled")):(self.$$undo.addClass("disabled"),self.$$undoAll.addClass("disabled"))},_enableRemoveBtn:function(){var self=this,stateRemove=!1,stateRemoveCnt=!1,sel,data,parent;self._currentSelectionId&&(sel=authHelpers.getSelectionById(self._currentSelectionId),data=sel&&authHelpers.getSelectionData(sel),!data||!data.control?stateRemove=!1:stateRemove=!0),data&&data.control&&data.control&&(data.control.isRoot()&&(stateRemove=!1),data.control.isLayout()&&(stateRemoveCnt=!0)),stateRemove!==!1?self.$$removeItem.removeClass("disabled"):self.$$removeItem.addClass("disabled"),stateRemoveCnt!==!1?self.$$removeCnt.removeClass("disabled"):self.$$removeCnt.addClass("disabled")},_setDeviceSize:function(size,orientation){var params={layout:{pageParameters:{}}};size&&(params.layout.pageParameters.device=size),orientation&&(params.layout.pageParameters.orientation=orientation),params.layout.pageParameters.forcePreview=!0,authHelpers.triggerResizeInternal(params)},_onRemoveItem:function(){if(!this._currentSelectionId)return;var sel=authHelpers.getSelectionById(this._currentSelectionId),data=sel&&authHelpers.getSelectionData(sel);if(!data||!data.control||data.control.isRoot())return;this._enableRemoveBtn(!1),data.control.parent.removeChild(data.control),notifications.publish(["sm.auth.change.item.prop.ui"])},_onRemoveCnt:function(){if(!this._currentSelectionId)return;var sel=authHelpers.getSelectionById(this._currentSelectionId),data=sel&&authHelpers.getSelectionData(sel);if(!data||!data.control)return;data.control.removeChildren(),notifications.publish(["sm.auth.change.item.prop.ui"])},_onRemoveAllItems:function(){var page=globals.getApplication().currentPage;page.rootLayout.removeChildren(),notifications.publish(["sm.auth.change.item.prop.ui"])},_onClose:function(){notifications.publish(["sm.auth.close"])},_onSave:function(evt){notifications.publish(["sm.auth.save"],$("#auth-btn-save-id").attr("data-save-type"))},_onChooseDevice:function(elmt){var self=this,site=globals.getSiteLayout(),cur=site.getCurrentLayoutSettings(),modal=new modalChooseDevice.Modal(cur.pageParameters.device);modal.show().then(function(result){result!=null&&(self._setDeviceSize(result),notifications.publish(["sm.auth.display.changed"],"device"))})},_onScaleDevice:function(elmt){var site=globals.getSiteLayout(),cur=site.getCurrentLayoutSettings(),params={layout:{pageParameters:{forceAutoScale:cur.pageParameters.forceAutoScale===!1}}};authHelpers.triggerResizeInternal(params),notifications.publish(["sm.auth.display.changed"],"scale")},_onOrientation:function(elmt){var self=this,orient=$(elmt.currentTarget).attr("data-auth-orientation");orient&&(self._setDeviceSize(null,orient),notifications.publish(["sm.auth.display.changed"],"orientation"))},_onNewLayout:function(){var self=this,page=globals.getApplication().currentPage,data={scroll:jsutils.isInstanceOf(page,"DashboardPage")?"horizontal":"vertical",template:!0},modal=new modalNewLayout.Modal(data);modal.show().then(function(result){result!=null&&notifications.publish(["sm.auth.new.layout"],result.scroll,result.template)})},_onUndo:function(){notifications.publish(["sm.auth.undo"],!1)},_onUndoAll:function(){notifications.publish(["sm.auth.undo"],!0)}})}),define("syracuse-tablet/html/js/authoring/authoringFooter",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/authoring/authoringHtml"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),authHtml=require("syracuse-tablet/html/js/authoring/authoringHtml");exports.Panel=utils.defineClass(function AuthoringPanelFooter(){var self=this;self.$$panel=null},null,{show:function(){var self=this;self._ensurePanel(),self._subscribe(),self.$$panel.show(),self._initDefaults()},hide:function(){var self=this;self._ensurePanel(),self.$$panel.hide(),self._unscribe()},_ensurePanel:function(){var self=this;if(this.$$panel)return;var ctx={};self.$$panel=$("#s-m-auth-panel-footer-id"),self.$$panel.append($(authHtml.execute("authPanelFooter",ctx))),self._getDomObjects(),self._initDomEvents()},_getDomObjects:function(){var self=this},_initDomEvents:function(){var self=this},_initDefaults:function(){var self=this},_subscribe:function(){var self=this;notifications.subscribe(self,["sm.main.layout.changed"]),notifications.subscribe(self,["sm.auth.set.selection"]),notifications.subscribe(self,["sm.auth.change.prop.ui"])},_unscribe:function(){var self=this;notifications.unsubscribe(self,["sm.main.layout.changed"]),notifications.unsubscribe(self,["sm.auth.set.selection"]),notifications.unsubscribe(self,["sm.auth.change.prop.ui"])},notifMainLayoutChanged:function(){var self=this},notifAuthChangePropUi:function(articlePage){var self=this},notifAuthSetSelection:function(id){var self=this}})}),define("syracuse-tablet/html/js/ui/modals/modalSaveAuth",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalDialog"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),_templateAll={header:'			<buttons class="pull-right"> 				<button type="button" class="btn btn-default s-m-modal-btn-validate" data-action="$validate"></button> 				<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 			</buttons> 			<div class="modal-title">{{title}}</div> 			',content:' 			<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">			<div class="s-m-scroll-element"> 		 		{{#each fields}}				<div class="form-group"> 					<label>{{label}}</label> 					<input class="{{css}} form-control" id="{{id}}" type="text" value="{{value}}" {{readonly}}/> 				</div> 				{{/each}}				<label id="saveType" params="{{saveType}}" >{{label_save_type}}</label> 				<div class="btn-group btn-group-justified" data-toggle="buttons"> 			   {{#each buttons}}					<div class="btn-group"> 					<label class="{{css}} btn btn-primary {{active}}" data-action="clickType" data-params="{{id}}"  >					<input type="radio"  name="options" id="{{id}}" {{checked}}>{{label}} 					</label>					</div>				{{/each}}				</div> 			</div> 			</div>',footer:""},_Klass=utils.defineClass(function ModalSaveAuth(saveContext){var self=this;modalDialog.ModalBase.call(self),self.saveContext=saveContext,self.result=null},modalDialog.ModalBase,{destroy:function(){$("input.evt-input",this.$$elmt).off(),modalDialog.ModalBase.prototype.destroy.call(this)},_getTemplates:function(){var self=this;return{std:_templateAll}},getDisplayFlags:function(){var displayFlags=this.displayFlags||{};return displayFlags.modalClass="config-tile half_right",displayFlags},_getDataContext:function(){var self=this;self.currentVariant=$.smFind(self.saveContext.variants,function(variant){return variant.isSelected})||{},self.currentVariant.comment=self.currentVariant.comment||self.saveContext.comment;var readonly="readonly",data={title:locale.text("auth.save.title"),page:self.saveContext.pageName,fields:[{id:"authCode",label:locale.text("auth.panel.label_code"),value:self.currentVariant.code,readonly:readonly,css:"evt-input"},{id:"authTitle",label:locale.text("auth.panel.label_title"),value:self.currentVariant.title,readonly:readonly,css:"evt-input"},{id:"authDescription",label:locale.text("auth.panel.label_description"),value:self.currentVariant.description,readonly:readonly,css:"evt-input"},{id:"authComment",label:locale.text("auth.panel.label_comment"),value:self.currentVariant.comment||self.saveContext.comment}],saveType:"save",label_save_type:locale.text("auth.panel.label_save"),buttons:[{id:"personal_copy",label:locale.text("auth.panel.label_personal"),active:self.currentVariant.isPersonal&&self._isPersonelVariantAutorized()?"active":"",css:self._isPersonelVariantAutorized()?"":"disabled"},{id:"global_variant",label:locale.text("auth.panel.label_global"),active:self.currentVariant.isGlobal&&self._isGlobalVariantAutorized()?"active":"",css:self._isGlobalVariantAutorized()?"":"disabled"},{id:"factory_variant",label:locale.text("auth.panel.label_factory"),active:self.currentVariant.isFactory&&self._canUpdateFactory(self.currentVariant)?"active":"",css:self._canManageFactory()?"":"disabled"}]};return data},_canUpdateFactory:function(variant){return this._canManageFactory()&&this.saveContext.securityProfile.factoryId===variant.factoryOwner},_canManageFactory:function(){return this.saveContext.securityProfile.factoryId!=""&&this._isGlobalVariantAutorized()},_isGlobalVariantAutorized:function(){return this.saveContext.securityProfile.personalizationLevel==="admin"},_isPersonelVariantAutorized:function(){return this.saveContext.securityProfile.personalizationLevel==="admin"||this.saveContext.securityProfile.personalizationLevel==="user"},_onShow:function(evt){var self=this;modalDialog.ModalBase.prototype._onShow.call(this,evt),$("input.evt-input",self.$$elmt).on("input",self._onInput.bind(self)),self._refreshBtnValidate()},_onAction:function(action,param){if(action!=="clickType")return!1;var self=this,ctxUI={},create=!1;switch(param){case"factory_variant":self._canManageFactory()&&(self.currentVariant=$.smFind(self.saveContext.variants,function(variant){return variant.isFactory&&variant.factoryOwner===self.saveContext.securityProfile.factoryId}),self.currentVariant||(create=!0,self.currentVariant={isFactory:!0,code:this.saveContext.securityProfile.factoryId,title:this.saveContext.securityProfile.factoryId,description:this.saveContext.securityProfile.factoryId,factoryOwner:this.saveContext.securityProfile.factoryId,comment:""}));break;case"global_variant":self.currentVariant=$.smFind(self.saveContext.variants,function(variant){return variant.isGlobal}),self.currentVariant||(create=!0,this.currentVariant={isGlobal:!0,code:"GLOBAL",title:"GLOBAL",description:"GLOBAL",comment:""});break;case"personal_copy":self.currentVariant=$.smFind(self.saveContext.variants,function(variant){return variant.isPersonal}),self.currentVariant||(create=!0,this.currentVariant={isPersonal:!0,code:"PERSONAL",title:"PERSONAL",description:"PERSONAL",comment:""})}$("label[data-params='"+param+"']",self.$$elmt).eq(0).button("toggle");if(create)var UI={saveType:"saveAs",label_save_type:locale.text("auth.panel.label_saveas_option")};else var UI={saveType:"save",label_save_type:locale.text("auth.panel.label_save")};return UI.fields=[{id:"authCode",value:self.currentVariant.code,readonly:!create},{id:"authTitle",value:self.currentVariant.title,readonly:!create},{id:"authDescription",value:self.currentVariant.description,readonly:!create},{id:"authComment",value:self.currentVariant.comment,readonly:!1}],self._changeUI(UI),!1},_changeUI:function(ctx){var self=this,$$saveType=self.$$elmt.find("#saveType");$$saveType.attr("params",ctx.saveType),$$saveType.text(ctx.label_save_type);var field;ctx.fields.forEach(function(item){field=self.$$elmt.find("#"+item.id),field.val(item.value),item.readonly?field.attr("readonly","readonly"):field.removeAttr("readonly")}),this._refreshBtnValidate(!0)},_onValidate:function(){var self=this;self.result={code:self.$$elmt.find("#authCode").val(),title:self.$$elmt.find("#authTitle").val(),description:self.$$elmt.find("#authDescription").val(),comment:self.$$elmt.find("#authComment").val(),variantType:$("label[data-action='clickType'].active",self.$$elmt).attr("data-params"),uuid:self.currentVariant.uuid}},_onCancel:function(){var self=this;self.result=null},_onInput:function(evt){this._refreshBtnValidate()},_refreshBtnValidate:function(focus){var disabled=!1,$$field;disabled=!$("label[data-action='clickType'].active",this.$$elmt).attr("data-params"),disabled||($$field=this.$$elmt.find("#authCode"),(disabled=$$field.val().trim().length<=0)||($$field=this.$$elmt.find("#authTitle"),(disabled=$$field.val().trim().length<=0)||($$field=this.$$elmt.find("#authDescription"),disabled=$$field.val().trim().length<=0))),focus&&disabled&&$$field&&$$field.focus(),$("button[data-action='$validate']").toggleClass("disabled",disabled)},_getResult:function(){var self=this;return self.result}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/authoring/authoring",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/authoring/authoringHelpers","syracuse-tablet/html/js/authoring/authoringPanelRight","syracuse-tablet/html/js/authoring/authoringPanelLeft","syracuse-tablet/html/js/authoring/authoringPage","syracuse-tablet/html/js/authoring/authoringHeader","syracuse-tablet/html/js/authoring/authoringFooter","syracuse-tablet/html/js/authoring/authoringArticleGen","syracuse-tablet/html/js/authoring/authoringVal","syracuse-tablet/html/js/ui/modals/modalSaveAuth","syracuse-tablet/html/js/application/eventListener","syracuse-tablet/html/js/ui/modals/modal","syracuse-tablet/html/js/authoring/authoringProperties","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),authHelpers=require("syracuse-tablet/html/js/authoring/authoringHelpers"),authoringPanelRight=require("syracuse-tablet/html/js/authoring/authoringPanelRight"),authoringPanelLeft=require("syracuse-tablet/html/js/authoring/authoringPanelLeft"),authoringPage=require("syracuse-tablet/html/js/authoring/authoringPage"),authoringHeader=require("syracuse-tablet/html/js/authoring/authoringHeader"),authoringFooter=require("syracuse-tablet/html/js/authoring/authoringFooter"),authoringArticleGen=require("syracuse-tablet/html/js/authoring/authoringArticleGen"),authVal=require("syracuse-tablet/html/js/authoring/authoringVal"),modalSaveAuth=require("syracuse-tablet/html/js/ui/modals/modalSaveAuth"),eventListener=require("syracuse-tablet/html/js/application/eventListener"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),authProps=require("syracuse-tablet/html/js/authoring/authoringProperties"),locale=require("syracuse-tablet/html/js/helpers/locale"),_authInterface,_authEvents=["sm.page.loaded","sm.auth.change.item.prop.ui","sm.auth.change.prop.ui","sm.auth.close","sm.auth.save","sm.auth.new.layout","sm.auth.set.page","sm.auth.display.changed","sm.auth.undo"];exports.toggleDesignPage=function(){_authInterface||(_authInterface=new AuthInterface),_authInterface.toggleDesignPage()},exports.isEnabled=function(){return _authInterface&&_authInterface.isActive},exports.checkBack=function(){return exports.isEnabled()?_authInterface.checkBack():!0},exports.destroy=function(){if(!_authInterface)return;_authInterface.destroy(),_authInterface=null};var AuthInterface=utils.defineClass(function AuthoringInterface(){var self=this;self.$$authPanel=null,self.isActive=!1,self.undoPageHistory={},self.isDirty=!1,self.rightPanel=new authoringPanelRight.Panel,self.leftPanel=new authoringPanelLeft.Panel,self.headerPanel=new authoringHeader.Panel,self.footerPanel=new authoringFooter.Panel,self.authPage=new authoringPage.AuthPage,authProps.initProperties(authHelpers),authVal.setProperties(authProps)},null,{destroy:function(){var self=this;["rightPanel","leftPanel","headerPanel","authPage"].forEach(function(p){self[p]&&self[p].destroy&&self[p].destroy(),self[p]=null})},toggleDesignPage:function(forceStatus){this.isActive||forceStatus===!1?this.disable():this.enable()},enable:function(){var self=this;self._subscribe(),self.authPage.enable(),self.rightPanel.show(),self.leftPanel.show(),self.headerPanel.show(),self.footerPanel.show();var page=globals.getApplication().currentPage;authHelpers.getPageVariants(page.state.authoringName).then(function(variants){page.variants=variants,notifications.publish(["sm.auth.set.page"],page),authHelpers.triggerResizeInternal({preserveScroll:!0,layout:{authPanelLeft:{visible:!0},authPanelRight:{visible:!0},authPanelHeader:{visible:!0},authPanelFooter:{visible:!0},pageParameters:{forcePreview:!0}}}),self.authPage.enableAuthCss(),self.isActive=!0,self.isDirty=!1,globals.setAuthoringActive(!0)})},disable:function(){var self=this;self.authPage.disable(),self.rightPanel.hide(),self.leftPanel.hide(),self.headerPanel.hide(),self.footerPanel.hide(),self.isActive=!1,self.authPage.disableAuthCss(),authHelpers.triggerResizeInternal({preserveScroll:!0,layout:{authPanelLeft:{visible:!1},authPanelRight:{visible:!1},authPanelHeader:{visible:!1},authPanelFooter:{visible:!1},pageParameters:{forcePreview:!1}}}),self.isActive=!1,self._unscribe(),globals.setAuthoringActive(!1)},_subscribe:function(){notifications.subscribe(this,_authEvents)},_unscribe:function(){notifications.unsubscribe(this,_authEvents)},notifPageLoaded:function(page){var self=this;if(!self.isActive)return;if(page&&page.state&&page.state.disableAuthoring){self.authPage.disableAuthCss(),self.toggleDesignPage();return}page&&!page.isVignette&&notifications.publish(["sm.auth.set.page"],page),self.authPage.enableAuthCss()},notifAuthSetPage:function(page){var self=this,parentAuthoringName=self.currentPageName;self.currentPageName=page.state.authoringName,self.currentPageFullName=page.state.name,self.displayedArticle=JSON.stringify(page.article),self.undoPageHistory[self.currentPageName]||(self.undoPageHistory[self.currentPageName]={parentPageName:parentAuthoringName,articles:[]}),notifications.publish(["sm.auth.history.change"],self.undoPageHistory[self.currentPageName].articles)},notifAuthChangePropUi:function(articlePage,states,vignetteToUpdt){var self=this;self.displayedArticle!=null&&(self.isDirty=!0,self.undoPageHistory[self.currentPageName].articles.push(self.displayedArticle),notifications.publish(["sm.auth.history.change"],self.undoPageHistory[self.currentPageName].articles),self.displayedArticle=null),self._updateLayoutPage(articlePage,states,vignetteToUpdt)},notifAuthChangeItemPropUi:function(data){var self=this,page=globals.getApplication().currentPage,states={},articleJSON=authHelpers.rebuildArticleByPageStruct(page,states),vignetteToUpdt=null;data&&data.control&&data.control.controller&&(vignetteToUpdt=data.control.controller.getParentVignette()),notifications.publish(["sm.auth.change.prop.ui"],articleJSON,states,vignetteToUpdt)},notifAuthClose:function(articlePage){var self=this,pageType=globals.getApplication().currentPage.state.type;pageType==="carddesign"||pageType==="chartdetail"?self._authGoBackAuthoring(articlePage):self._authCloseAuthoring(articlePage)},_authCloseAuthoring:function(articlePage){var self=this,_end=function(){self.undoPageHistory={},notifications.publish(["sm.auth.history.change"],[]),self.disable()};self.isDirty===!0?modal.simpleConfirmPromise({message:locale.text("auth.msg.close")}).then(function(result){result.action==="yes"&&_end()}):_end()},_authGoBackAuthoring:function(articlePage){var self=this;this._isArticleChange(this.displayedArticle)?modal.simpleConfirmPromise({message:locale.text("auth.msg.close")}).then(function(result){if(result.action==="yes"){var article=self.undoPageHistory[self.currentPageName].articles.shift();self.undoPageHistory[self.currentPageName].articles=[],notifications.publish(["sm.auth.history.change"],self.undoPageHistory[self.currentPageName].articles),notifications.publishEx(["sm.auth.change.prop.ui"],{exclude:[self]},article),globals.getApplication().goBack()}}):globals.getApplication().goBack()},notifAuthDisplayChanged:function(type){this.leftPanel.setSelection(null)},notifAuthSave:function(typeSave){var self=this;if(typeSave){if(this._isArticleChange(this.displayedArticle)){self.undoPageHistory[self.currentPageName].articles=[];var parentPageName=self.undoPageHistory[self.currentPageName].parentPageName;parentPageName&&notifications.publish(["sm.auth.history.change"],self.undoPageHistory[parentPageName].articles)}eventListener.triggerAction(globals.getApplication().currentPage.$$elmt,typeSave);return}var article=self.rightPanel.getPageArticle(),articleParsed=authVal.validateJSON(!0,article,authProps.getAllProperties());if(!articleParsed)return;var propertiesVariantSelected=authHelpers.getPropertiesCurrentVariant(self.rightPanel.getPage()),comment=articleParsed&&articleParsed.$comment,context={code:propertiesVariantSelected.code||locale.text("auth.panel.authCodeDefault"),title:propertiesVariantSelected.title||locale.text("auth.panel.authTitleDefault"),description:propertiesVariantSelected.description||locale.text("auth.panel.authDescriptionDefault"),isFactory:propertiesVariantSelected.isFactory,isGlobal:propertiesVariantSelected.isGlobal,isPersonal:propertiesVariantSelected.isPersonal,factoryOwner:propertiesVariantSelected.factoryOwner,securityProfile:globals.getSecurityProfile(),uuid:propertiesVariantSelected.uuid,comment:propertiesVariantSelected.comment||comment,variants:authHelpers.getPropertiesVariants(self.rightPanel.getPage())};context.pageName=self.currentPageName;var modal=new modalSaveAuth.Modal(context),canceled=!1,modalCtx;modal.show().then(function(ctx){modalCtx=ctx,canceled=modalCtx==null;if(canceled)return;articleParsed.$comment=ctx.comment;var params={code:ctx.code,title:ctx.title,description:ctx.description,variantType:ctx.variantType,uuid:ctx.uuid,article:articleParsed};return params.article=utils.sanitizeArticle(params.article),authHelpers.saveAuthoring(self.currentPageName,params)}).then(function(newView){if(canceled)return;modalCtx.uuid||self.rightPanel.notifAuthSetSelection(),self.isDirty=!1;var opt={articleParsed:articleParsed,view:newView};return globals.getMetaData().updatePageAuthoring(self.currentPageFullName,opt)}).then(function(){if(canceled)return;globals.getModal().info(locale.text("auth.panel.save_ok_title"),locale.text("auth.panel.save_ok_text"))}).fail(function(e){globals.getModal().error(locale.text("auth.panel.save_error_title"),e)})},notifAuthNewLayout:function(type,template){var page=globals.getApplication().currentPage;authoringArticleGen.genNewArticle({page:page,orientation:type,template:template}).then(function(article){var articleJSON=authVal.toSortedJSON(article);notifications.publish(["sm.auth.change.prop.ui"],articleJSON)}).fail(function(e){modal.error(e)})},notifAuthUndo:function(all){var self=this,article;all?(article=self.undoPageHistory[self.currentPageName].articles.shift(),self.undoPageHistory[self.currentPageName].articles=[]):article=self.undoPageHistory[self.currentPageName].articles.pop(),notifications.publish(["sm.auth.history.change"],self.undoPageHistory[self.currentPageName].articles),notifications.publishEx(["sm.auth.change.prop.ui"],{exclude:[self]},article),self._updateLayoutPage(article)},_updateLayoutPage:function(articlePage,states,vignetteToUpdt){var self=this,page=globals.getApplication().currentPage;try{var articleParsed=JSON.parse(articlePage)}catch(e){}if(!articleParsed)return;var path=self._findSelectionPath();authHelpers.savePanelStates(),self.displayedArticle=articlePage,self.authPage.disableAuthCss(),page.authUpdateLayout(articleParsed,vignetteToUpdt).then(function(){self.authPage.enableAuthCss(),states&&self._applyPreviousStates(states),self._selectByPath(path)})},_applyPreviousStates:function(states){var self=this,page=globals.getApplication().currentPage;for(var statePath in states){statePath=statePath.length>0?statePath.split("."):[];var node=page.rootLayout.findChildByPath(statePath);node&&node.setAuthState(states[statePath])}},_findSelectionPath:function(){var id=this.authPage.getCurrentSelectionId();if(id===globals.getApplication().currentPage.id)return"$$currentpage$$";var sel=id&&authHelpers.getSelectionById(id),data=sel&&authHelpers.getSelectionData(sel);if(!data||!data.control)return null;var path=data.control.getPathInTree();return path},_selectByPath:function(path){var page=globals.getApplication().currentPage;if(!path||!page)return;if(path==="$$currentpage$$")path=page.id;else{var node=page.rootLayout.findChildByPath(path);path=node?node.id:null}path&&notifications.publishEx(["sm.auth.set.selection"],{exclude:[this]},path)},_isArticleChange:function(articleBefore){var article=JSON.stringify(globals.getApplication().currentPage.article);return articleBefore!==article},checkBack:function(){var pageType=globals.getApplication().currentPage.state.type;return pageType==="carddesign"||pageType==="chartdetail"?!0:(notifications.publish(["sm.auth.close"]),!1)}})}),define("syracuse-tablet/html/js/ui/developmentPage",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/storage/localStorage"],function(require,exports,module){function _setActive(flag){localStorage.setItem("devPanelOpen",flag?"true":"false")}var globals=require("syracuse-tablet/html/js/helpers/globals"),uiutils=require("syracuse-tablet/html/js/ui/uiUtils"),localStorage=require("syracuse-tablet/html/js/storage/localStorage"),_template='	<div id="page_dev_mode" style="margin: 0; width: auto; position: absolute; z-index: 9999">     <div class="modal-dialog" style="margin: 0; width: auto;"> 		<div class="modal-content" style="width: 230px;"> 		    <div class="modal-header"> 				<h4 class="modal-title">{{title}}</h4> 		    </div> 		    <div class="modal-body"> 				<div class="form-group"> 					<label>{{label_device}}</label>					<select class="form-control" id="dev-select-device"> 					{{#each devices}}						<option value="{{this.device}}.{{this.orientation}}" {{#if this.selected}}selected{{/if}}>						{{this.description}}						</option>					{{/each}}					</select>					<span class="input-group"> 						<input id="dev-device-scale" type="checkbox" {{#if scaleChecked}}checked{{/if}}>{{label_scale}} 					</span> 				</div> 				<div class="form-group"> 					<span class="input-group"> 						<input id="dev-cache" type="checkbox" {{#if cacheChecked}}checked{{/if}}>{{label_cache}} 	  				</span> 				</div> 			</div> 		    <div class="modal-footer"> 				<button type="button" class="btn" id="btn_dev_close">{{label_close}}</button> 				<button type="button" class="btn btn-default" disabled="true" id="btn_dev_apply">{{label_apply}}</button>     			<button type="button" class="btn" id="btn_dev_ok">{{label_ok}}</button> 			</div> 		</div> 	</div> 	</div>',_show=function(){_setActive(!0);if($("#page_dev_mode").is(":visible"))return;var modalHtml=Handlebars.compile(_template),cache=globals.getCache(),site=globals.getSiteLayout(),devs=site.getDeviceTemplates(),ctx={title:"Development settings",label_device:"Device",devices:[],label_scale:"Scale if needed",label_cache:"Disable caching",label_close:"Cancel",label_ok:"Ok",label_apply:"Apply",scaleChecked:localStorage.getItem("devPanelScale")==="true",cacheChecked:localStorage.getItem("devPanelCache")==="true"};ctx.devices.push({device:"<No emulation>",orientation:"landscape",description:"<No emulation>"});for(var dev in devs)devs[dev].orientations.forEach(function(o){var devName=dev,orientName=o,opt={device:dev,orientation:o,description:devName+" ("+o+")"};ctx.devices.push(opt)});var lastDev=localStorage.getItem("devPanelDevice")||"<No emulation>.landscape";ctx.devices.forEach(function(d){d.selected=lastDev===d.device+"."+d.orientation}),modalHtml=modalHtml(ctx),$("body").append($(modalHtml));var $$page=$("#page_dev_mode");$$page.draggable(),$("#btn_dev_ok",$$page).on("click",function(){apply(),$$page.remove()}),$("#btn_dev_apply",$$page).on("click",function(){apply(),$("#btn_dev_apply",$$page).attr("disabled","true")}),$("#btn_dev_close",$$page).on("click",function(){_setActive(!1),$$page.remove()}),$("#dev-select-device",$$page).on("change",function(){$("#btn_dev_apply",$$page).removeAttr("disabled")}),$('input[type="checkbox"]',$$page).on("click",function(){$("#btn_dev_apply",$$page).removeAttr("disabled")});var apply=function(){var device=$$page.find("#dev-select-device").val(),dev=device.split("."),params={layout:{pageParameters:{}}};localStorage.setItem("devPanelDevice",device),device==="<No emulation>.landscape"?(params.layout.pageParameters.forcePreview=!1,params.layout.pageParameters.forceAutoScale=!1,params.layout.pageParameters.device="tablet",params.layout.pageParameters.orientation="landscape"):(params.layout.pageParameters.device=dev[0],params.layout.pageParameters.orientation=dev[1],params.layout.pageParameters.forcePreview=!0,$("#dev-device-scale",$$page).is(":checked")===!0?(params.layout.pageParameters.forceAutoScale=!0,localStorage.setItem("devPanelScale","true")):(params.layout.pageParameters.forceAutoScale=!1,localStorage.setItem("devPanelScale","false"))),$("#dev-cache",$$page).is(":checked")===!0?(localStorage.setItem("devPanelCache","true"),cache.disableCache(!0)):(localStorage.setItem("devPanelCache","false"),cache.disableCache(!1)),uiutils.triggerResizeInternal(params)};apply()};exports.wasActive=function(){return localStorage.getItem("devPanelOpen")==="true"},exports.show=_show}),define("syracuse-tablet/html/js/ui/modals/modalShowLegal",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalDialog","syracuse-tablet/html/js/sdata/sdataHttp","syracuse-tablet/html/js/helpers/types/date"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),sdataHttp=require("syracuse-tablet/html/js/sdata/sdataHttp"),date=require("syracuse-tablet/html/js/helpers/types/date"),_templateAll={header:'			<buttons class="pull-right"> 				<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 			</buttons> 			<div class="modal-title">{{title}}</div> 			',content:' 			<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">			<div class="s-m-scroll-element"> 				<div class="form-group"> 					<div class="s-m-header-brand"> 						<span class="s-m-brand">{{label_brand}}</span> 						<span class="s-m-product">{{label_product}}</span> 					</div> 					<span class="s-m-product-update-label">{{label_update}}</span><span class="s-m-product-update-value">{{update}}</span> 				</div> 				<div class="form-group"> 					<h3>{{label_legal}}</h3> 					<label>{{text1}}</label> 					<label>{{text2}}</label> 					<label>{{text3}}</label> 					<label>{{text4}}</label> 					<label>{{text5}}</label> 					<label>{{text6}}</label> 				</div> 				{{#if licenses}} 				<div class="form-group"> 					<h3>{{label_license}}</h3> 					{{#each licenses}} 						<div class="s-m-field"><div class="s-m-title">{{../label_registrationNumber}}</div><div class="s-m-value">{{toRegNum}}</div></div> 						<div class="s-m-field"><div class="s-m-title">{{../label_licensedTo}}</div><div class="s-m-value">{{toName}}</div></div> 						<div class="s-m-field"><div class="s-m-title">{{../label_reference}}</div><div class="s-m-value">{{toRefNum}}</div></div> 						<div class="s-m-field"><div class="s-m-title">{{../label_installedBy}}</div><div class="s-m-value">{{installedBy}}</div></div> 						<div class="s-m-field"><div class="s-m-title">{{../label_expiryDate}}</div><div class="s-m-value">{{expiryDate}}</div></div> 					{{/each}} 				</div> 				{{/if}} 				{{#if userAgent}} 					<h3>{{label_user_agent}}</h3> 					<div class="form-group"> 						<label>{{userAgent}}</label> 						<label>{{lookAndFeel}}</label> 					</div> 				{{/if}} 				{{#if builddate}} 					<div class="form-group"> 						<label>{{builddate}}</label> 					</div> 				{{/if}} 				{{#if pageInfo}} 					<h3>{{pageInfo.label}}</h3> 					<div class="form-group pageInfo"> 						{{#each pageInfo.properties}} 							<div class="s-m-field"><div class="s-m-title">{{label}}:</div><div class="s-m-value">{{value}}</div></div> 						{{/each}} 					</div> 				{{/if}} 			</div> 			</div>',footer:""},_Klass=utils.defineClass(function ModalShowLegal(){var self=this;modalDialog.ModalBase.call(self)},modalDialog.ModalBase,{_getTemplates:function(){var self=this;return{std:_templateAll}},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="show-legal half_right":displayFlags.modalClass="show-legal full",displayFlags},_getDataContext:function(){var self=this;return sdataHttp.send({method:"GET",url:"/sdata/syracuse/collaboration/syracuse/licenses/$service/current"}).then(function(data){var version=null,licenses=[];if(data&&data.isSuccess&&data.responseJSON)return data.responseJSON.forEach(function(lic){var l={};l.expiryDate=locale.text("modal.legal.license.expiryDateValue",[date.getLocalShortDate(lic.validFrom),date.getLocalShortDate(lic.expiryDate)]),l.toName=lic.licensedTo.name,l.toRegNum=lic.licensedTo.registrationNumber,l.toRefNum=lic.licensedTo.reference,l.installedBy=lic.reseller.name,licenses.push(l),version||(version=lic.productVersion)}),{version:version,licenses:licenses}}).then(function(licData){var labels=locale.getProductLabels(),showBuildDate=window.location.href.indexOf("SHOW_VERSION_NUMBER")>-1,pageInfo,currPage=globals.getApplication().currentPage;globals.isDvlpMode()&&currPage&&currPage.state&&(pageInfo={label:locale.text("modal.legal.pageinfo.lablel"),properties:[{value:currPage.state.authoringName?currPage.state.authoringName+".mobile":"",label:locale.text("modal.legal.pageinfo.authname")}]});var data={title:locale.text("modal.legal.title"),label_brand:labels.brand,label_product:labels.product,label_update:locale.text("modal.legal.update"),label_license:locale.text("modal.legal.about.license"),label_legal:locale.text("modal.legal.about.legal"),label_user_agent:locale.text("modal.legal.about.user_agent"),update:licData&&licData.version||"?",licenses:licData&&licData.licenses,builddate:showBuildDate&&locale.text("modal.legal.builddate",[globals.getBuildTimeStamp()]),text1:locale.text("modal.legal.text1"),text2:locale.text("modal.legal.text2"),text3:locale.text("modal.legal.text3"),text4:locale.text("modal.legal.text4"),text5:locale.text("modal.legal.text5"),text6:locale.text("modal.legal.text6"),label_registrationNumber:locale.text("modal.legal.license.registrationNumber"),label_licensedTo:locale.text("modal.legal.license.licensedTo"),label_reference:locale.text("modal.legal.license.reference"),label_userLicense:locale.text("modal.legal.license.userLicense"),label_installedBy:locale.text("modal.legal.license.installedBy"),label_server:locale.text("modal.legal.license.server"),label_expiryDate:locale.text("modal.legal.license.expiryDate"),userAgent:globals.isDvlpMode()?navigator.userAgent:"",lookAndFeel:globals.isDvlpMode()?globals.getLookAndFeel():"",pageInfo:pageInfo};return data})},_onValidate:function(){},_onCancel:function(){},_getResult:function(){}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/ui/modals/modalSettings",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalDialog","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/native/native"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),globals=require("syracuse-tablet/html/js/helpers/globals"),native=require("syracuse-tablet/html/js/helpers/native/native"),_cacheOptions={"1week":{days:7},"2week":{days:14},month:{days:30},all:{days:null}},_templateAll={header:'		<buttons class="pull-right"> 			<button type="button" class="btn btn-default s-m-modal-btn-validate" data-action="$validate"></button> 		</buttons> 		<div class="modal-title">{{title}}</div> 			',content:' 			<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">				<div class="form-group s-m-scroll-element"> 					<header>{{label_device}}</header> 					<div class="btn-group btn-group-justified" data-toggle="buttons" id="s-m-radio-type-id"> 						<div class="btn-group"> 							<label class="btn btn-primary" data-action="clickType" data-params="auto"> 								<input type="radio" name="s-m-radio-type">{{label_auto}} 							</label> 						</div> 						<div class="btn-group"> 							<label class="btn btn-primary" data-action="clickType" data-params="smartphone"> 								<input type="radio" name="s-m-radio-type">{{label_smartphone}} 							</label> 						</div> 						<div class="btn-group"> 							<label class="btn btn-primary" data-action="clickType" data-params="tablet"> 								<input type="radio" name="s-m-radio-type">{{label_tablet}} 							</label> 						</div> 					</div> 					{{#if showConfigServers}} 						<header>{{label_servers}}</header> 						<div class="btn-group btn-group-justified"> 							<div class="btn-group"> 								<label class="btn btn-primary" data-action="selectServer" data-params="">{{label_switch_server}}</label> 							</div> 						</div> 					{{/if}} 					<header id="s-m-cache-id">{{label_cache}}</header> 					<span id="s-m-cache-explain">{{label_cache_clear}} 					<div id="s-m-cache-btns-id" class="btn-group btn-group-justified"> 						<label id="s-m-cache-clear-all-id" class="btn btn-primary s-m-cache-btn" data-action="clearCache" data-params="clear,all">{{label_cache_all}}<div></div></label> 						<label id="s-m-cache-clear-1week-id" class="btn btn-primary s-m-cache-btn" data-action="clearCache" data-params="clear,1week">{{label_cache_week1}}<div></div></label> 						<label id="s-m-cache-clear-2week-id" class="btn btn-primary s-m-cache-btn" data-action="clearCache" data-params="clear,2week">{{label_cache_week2}}<div></div></label> 						<label id="s-m-cache-clear-month-id" class="btn btn-primary s-m-cache-btn" data-action="clearCache" data-params="clear,month">{{label_cache_month}}<div></div></label> 					</div> 					<div style="display:table-row;"> 					<label id="s-m-cache-confirm-id" class="btn btn-primary s-m-confirm" data-action="clearCache" data-params="confirm,all" style="display: none;">{{label_cache_confirm}}</label> 					<label id="s-m-cache-cancel-id" class="btn btn-warning s-m-cancel" data-action="clearCache" data-params="cancel" style="display: none;">{{label_cancel}}</label> 					</div> 					<div id="s-m-cache-progress-id" class="progress" style="display: none;"> 						<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 100%">{{label_clearing}}</div> 					</div> 										<div id="s-m-cache-ok-id" class="alert alert-success" role="alert" style="display: none">{{label_clearing_ok}}</div> 					<div style="width:100%; display: inline-block;"></div> 				</div> 			</div>',footer:""},_Klass=utils.defineClass(function ModalSettings(settings){var self=this;modalDialog.ModalBase.call(self),self.settings=settings&&$.extend(!0,{},settings)||{},self.settings["device-type"]=self.settings["device-type"]||"auto",self.result=null},modalDialog.ModalBase,{_getTemplates:function(){var self=this;return{std:_templateAll,smartphone:_templateAll}},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="settings half_right":displayFlags.modalClass="settings full",displayFlags},_getDataContext:function(){var self=this,data={title:locale.text("settings.title"),label_device:locale.text("settings.device.label"),label_auto:locale.text("settings.device.auto"),label_smartphone:locale.text("settings.device.smartphone"),label_tablet:locale.text("settings.device.tablet"),label_cache:locale.text("settings.cache.label"),label_cache_clear:locale.text("settings.cache.clear"),label_cache_week1:locale.text("settings.cache.week1"),label_cache_week2:locale.text("settings.cache.week2"),label_cache_month:locale.text("settings.cache.month"),label_cache_all:locale.text("settings.cache.all"),label_cache_confirm:locale.text("settings.cache.confirm"),label_clearing:locale.text("settings.cache.clearing"),label_clearing_ok:locale.text("settings.cache.clearing_ok"),label_apps:locale.text("settings.apps.label"),label_apps_update:locale.text("settings.apps.update"),label_apps_confirm:locale.text("settings.apps.confirm"),label_apps_wait:locale.text("settings.apps.wait"),label_apps_ok:locale.text("settings.apps.ok"),label_cancel:""};return native.hasCapability("nativeApp")&&(data.showConfigServers=!0,data.label_servers=locale.text("settings.servers.servers"),data.label_switch_server=locale.text("settings.servers.switch")),data},_onShow:function(){var self=this;modalDialog.ModalBase.prototype._onShow.call(self),$("label[data-params='"+self.settings["device-type"]+"']",self.$$elmt).eq(0).button("toggle"),self._computeCacheSize()},_onValidate:function(){var self=this,$$active=$("#s-m-radio-type-id .active ",this.$$elmt),deviceType=$$active.length<1?"auto":$$active.attr("data-params")||"auto";self.settings["device-type"]=deviceType,self.result=self.settings},_onCancel:function(){var self=this;self.result=null},_onAction:function(action,param){var self=this;switch(action){case"clickType":$("label[data-params='"+param+"']",self.$$elmt).eq(0).button("toggle");break;case"clearCache":self._clearCache(param);break;case"clearApps":self._clearApps(param);break;case"selectServer":return native.hasCapability("nativeApp")&&native.getModule("nativeApp").selectServer(),!0}return!1},_clearApps:function(param){var self=this,p=param.split(","),action=p[0],data=p[1];self._setButtons("clearApps","apps",action,data);if(action==="confirm")return globals.getMetaData().removeApplications().always(function(){globals.setNeedToCheckAppsList(!0),self._setButtons("clearApps","apps","ok","")})},_clearCache:function(param){var self=this,p=param.split(","),action=p[0],data=p[1];self._setButtons("clearCache","cache",action,data);if(action==="confirm"){var dt=self._getDateBefore(_cacheOptions[data].days);return globals.getCache().clearCache({$not_read_since:dt}).always(function(){self._setButtons("clearCache","cache","ok",""),self._computeCacheSize()})}},_setButtons:function(action,prefix,state,data){var self=this;switch(state){case"confirm":$("#s-m-"+prefix+"-progress-id",self.$$elmt).show(),$("#s-m-"+prefix+"-confirm-id",self.$$elmt).hide(),$("#s-m-"+prefix+"-cancel-id",self.$$elmt).hide();break;case"cancel":$("#s-m-"+prefix+"-btns-id",self.$$elmt).show(),$("#s-m-"+prefix+"-confirm-id",self.$$elmt).hide(),$("#s-m-"+prefix+"-cancel-id",self.$$elmt).hide();break;case"clear":$("#s-m-"+prefix+"-confirm-id",self.$$elmt).show(),$("#s-m-"+prefix+"-cancel-id",self.$$elmt).show(),$("#s-m-"+prefix+"-btns-id",self.$$elmt).hide(),$("#s-m-"+prefix+"-confirm-id",self.$$elmt).attr("data-params","confirm,"+(data||""));break;case"ok":$("#s-m-"+prefix+"-progress-id",self.$$elmt).hide(),$("#s-m-"+prefix+"-ok-id",self.$$elmt).show(),setTimeout(function(){$("#s-m-"+prefix+"-ok-id",self.$$elmt).hide(),$("#s-m-"+prefix+"-btns-id",self.$$elmt).show()},3e3)}},_getDateBefore:function(days){if(!days)return"9999-99-99-00-00-00";var today=new Date,dt=new Date(today);return dt.setDate(today.getDate()-days),dt=dt.toJSON().slice(0,10)+"-00-00-00",dt},_computeCacheSize:function(){var self=this;Object.keys(_cacheOptions).forEach(function(co){var dt=self._getDateBefore(_cacheOptions[co].days);return globals.getCache().computeCacheSize({$not_read_since:dt}).always(function(result){self._updateCacheSize(co,result)})})},_updateCacheSize:function(key,result){var self=this,$$div=$("#s-m-cache-clear-"+key+"-id > div",self.$$elmt),units=[locale.text("global.units.kilobytes"),locale.text("global.units.megabytes")];$$div.empty();if(result&&result.$data){var size=result.$data.sizeRecords,sizeUnit=locale.text("global.units.bytes");while(size>=1024&&units.length>0)size=(size+1023)/1024,sizeUnit=units.shift();var sizeText=Math.round(size)+" "+sizeUnit;$$div.append($("<span>"+result.$data.numRecords+" "+locale.text("global.units.files")+"</span><span>"+sizeText+"</span>"))}},_getResult:function(){var self=this;return self.result}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/helpers/dashboardWelcomeUtils",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/storage/storage","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modal","syracuse-tablet/html/js/helpers/native/native","syracuse-tablet/html/js/sdata/sdataCommonResources","syracuse-tablet/html/js/helpers/utils"],function(require,exports,module){function _defaultWelcomeApplication(){var app={$application:{$uuid:"$welcomeApplication",applicationName:"$welcomeApplication",title:"",description:"",iconName:"gears",$homeDashboard:{$uuid:"$welcomeDashboard",dashboardName:"$welcomeDashboard"}},$dashboards:{$welcomeDashboard:{$pageInfo:{isWelcomePage:!0,disableAuthoring:!0},$update:function(dashboard){return _updateDashboard(dashboard)},$dashboardName:"$welcomeDashboard",$title:""}}};return app}function _updateDashboard(){return _getWelcomeDashboard(!0).then(function(dashboard){return _defaultDashboard(dashboard)}).then(function(dashboard){var nativeVoiceCommmands=native.getModule("voiceCommands"),voiceBookmarks=nativeVoiceCommmands?[]:null;return dashboard.$pageInfo={isWelcomePage:!0,disableAuthoring:!0},dashboard.$dashboardName="$welcomeDashboard",dashboard})}function _getWelcomeDashboard(forceReadFromServer,uuid){return(forceReadFromServer||uuid)&&globals.isOnline()?sdataCommonResources.queryWelcomeDashboard(uuid).then(function(dashboard){return _setMetaWelcomeDashboard(dashboard)}).then(function(dashboardMeta){if(dashboardMeta){var meta=globals.getMetaData();return meta.getApplications(!1).then(function(apps){return _cleanApplications(dashboardMeta),apps.forEach(function(appInfo){if(appInfo.applicationName!=="$welcomeApplication"){var bind="$welcome_"+appInfo.applicationName;dashboardMeta.$gadgets[bind]=_gadget(appInfo),dashboardMeta.$vignettes[bind]=_vignette(appInfo)}}),dashboardMeta})}return null}):_readWelcomeDashboardUser()}function _getRoles(currentRoles){var ActiveRoles={};return currentRoles&&(ActiveRoles=currentRoles.reduce(function(roles,current){return roles[current.$uuid]="active",roles},{})),sdataCommonResources.queryRoles().then(function(roles){return roles.forEach(function(role){ActiveRoles[role.$uuid]&&(role.$selected=ActiveRoles[role.$uuid])}),roles})}function _setMetaWelcomeDashboard(dashboard){var welcomeDashboard=dashboard&&dashboard.content;if(welcomeDashboard){welcomeDashboard.$views=dashboard.$views,welcomeDashboard.$factoryOwner=dashboard.$factoryOwner,welcomeDashboard.roles=dashboard.roles,welcomeDashboard.description=dashboard.description,welcomeDashboard.$pageInfo={isWelcomePage:!0,disableAuthoring:!0},welcomeDashboard.$dashboardName="$welcomeDashboard";if(welcomeDashboard.$views){var currentViewSelected=welcomeDashboard.$views.filter(function(view){return view.$selected});currentViewSelected.length===0&&(welcomeDashboard.$views[0].$selected=!0)}}return welcomeDashboard}function _defaultDashboard(dashboard){dashboard=dashboard||{};var step;if(dashboard.$article){var meta=globals.getMetaData(),forceReadApps=globals.needToCheckAppsList();globals.setNeedToCheckAppsList(!1),forceReadApps=forceReadApps&&globals.isOnline();var nativeVoiceCommmands=native.getModule("voiceCommands"),voiceBookmarks=nativeVoiceCommmands?[]:null;step=meta.getApplications(forceReadApps).then(function(apps){return apps.forEach(function(appInfo){var bind="$welcome_"+appInfo.applicationName;_checkTileStatus(appInfo,_getTileByBind(dashboard.$article,bind));if(nativeVoiceCommmands){var voiceCmd=nativeVoiceCommmands.createCommandFromAppli(dashboard.$gadgets[bind].$title,appInfo);voiceCmd&&voiceBookmarks.push(voiceCmd)}}),voiceBookmarks&&nativeVoiceCommmands.setVoiceCommands(voiceBookmarks),dashboard})}else step=_updateDefaultDashboard(dashboard,{defaultArticle:!0});return step.then(function(dashboard){return dashboard.$views=dashboard.$views||[],dashboard.$views.length>0&&!dashboard.$views[0].$isPersonal||dashboard.$views.length===0?(_unLocalizeHubGroups(dashboard.$article),dashboard.$roles=[],dashboard.description=locale.text("welcome.mydashboard"),dashboard.$factoryOwner="",dashboard.$views.forEach(function(view){view.$selected=!1}),dashboard.$views.unshift({$description:dashboard.description,$factoryOwner:dashboard.$factoryOwner,$isPersonal:!0,$selected:!0}),_writeWelcomeDashboardUser(dashboard).then(function(dashboard){return dashboard})):dashboard})}function _cleanApplications(dashboard){return Object.keys(dashboard.$gadgets).forEach(function(key){dashboard.$gadgets[key].pinPageId||(delete dashboard.$gadgets[key],delete dashboard.$vignettes[key])}),dashboard}function _emptyDashboard(){var dashboard={$pageInfo:{isWelcomePage:!0,disableAuthoring:!0},$dashboardName:"$welcomeDashboard",$title:""};return _updateDefaultDashboard(dashboard,{emptyArticle:!0})}function _updateDefaultDashboard(dashboard,opts){opts=opts||{};var meta=globals.getMetaData(),appList;dashboard.$title=dashboard.$title||locale.text("welcome.title.home"),dashboard.$gadgets={},dashboard.$vignettes={},dashboard.$article={$layoutType:"hub",$items:[]},dashboard.appList={hidden:[],visible:[]};var nativeVoiceCommmands=native.getModule("voiceCommands"),voiceBookmarks=nativeVoiceCommmands?[]:null;return $.smResolve().then(function(){var forceReadApps=globals.needToCheckAppsList();return globals.setNeedToCheckAppsList(!1),forceReadApps=forceReadApps&&globals.isOnline(),meta.getApplications(forceReadApps)}).then(function(apps){appList=apps}).then(function(){return _addApps(dashboard,appList,voiceBookmarks,opts)}).then(function(){return voiceBookmarks&&nativeVoiceCommmands.setVoiceCommands(voiceBookmarks),dashboard}).fail(function(e){return console.log(e),$.smReject(e)})}function _buildGadget(page){return page.dashboardName?_buildDashboardGadget(page):_buildRepresentationGadget(page)}function _buildRepresentationGadget(page){return{$type:"$representation",$title:page.title,entity:page.entity,action:page.action,representation:page.representation,facet:page.facet,keyParameter:page.key,endpoint:page.endpoint,applicationName:page.applicationName,icon:page.icon}}function _buildDashboardGadget(page){return{$type:page.$type||"$dashboard",$title:page.title,dashboardName:page.dashboardName,applicationName:page.applicationName,sdataParameters:page.sdataParameters,endpoint:page.endpoint,icon:page.icon}}function _isPinnedPage(pinPageId){var self=this;return pinPageId==null?$.smResolve(!1):globals.getMetaData().getWelcomeDashboard().then(function(dashboard){if(dashboard.$factoryOwner)return 0;if(!pinPageId)return 1;if(!dashboard||!dashboard.$gadgets)return 1;var isPinnedPage=Object.keys(dashboard.$gadgets).some(function(key){return dashboard.$gadgets[key].pinPageId===pinPageId?!0:!1});return isPinnedPage?2:1})}function _getPinnedPageContext(pinPageId){var self=this;return pinPageId?globals.getMetaData().getWelcomeDashboard().then(function(dashboard){if(!dashboard||!dashboard.voiceCommandContext)return null;var context=null;return Object.keys(dashboard.$gadgets).some(function(key){if(dashboard.$gadgets[key].pinPageId===pinPageId){var voiceCommandContext=dashboard.voiceCommandContext[key];return voiceCommandContext&&voiceCommandContext.currentState?(context=voiceCommandContext.currentState.savedContext,!0):!1}}),context}):$.smResolve(!1)}function _isPinnedTile($bind){return globals.getMetaData().getWelcomeDashboard().then(function(dashboard){return dashboard.$vignettes[$bind]!=undefined})}function _addGroup(dashboard,text){var personal=!dashboard.$factoryOwner||dashboard.$factoryOwner==="",uuid=personal?null:utils.UUID(),titleContent=uuid?"{@"+uuid+"}":text,grp=_hubGroup(_groupTypes.quickLinks,titleContent);return uuid&&(dashboard.$article.$localization=dashboard.$article.$localization||{},utils.setLocalization(dashboard.$article.$localization,uuid,text)),grp}function _addPinnedPage(pageData){var self=this,endpoint=globals.getEndpoint();return globals.getMetaData().getWelcomeDashboard().then(function(dashboard){var quikLinksGroup=_getHubGroup(dashboard.$article,_groupTypes.quickLinks);if(!quikLinksGroup){var grp=_addGroup(dashboard,locale.text("welcome.myquicklinks"));dashboard.$article.$items.unshift(grp),quikLinksGroup=dashboard.$article.$items[0]}var gadgetName="$$$"+utils.UUID(),vignetteName=gadgetName,gadget=_buildGadget(pageData);if(gadget.endpoint===endpoint){gadget.pinPageId=pageData.id,dashboard.$gadgets[gadgetName]=gadget,dashboard.$vignettes[vignetteName]={$uuid:gadgetName,$displayStyle:"$link"},quikLinksGroup.$items.push({$layoutType:"tile",$bgColor:"darkgrey",$items:[{$bind:vignetteName}],$size:"medium"}),dashboard.voiceCommandContext=dashboard.voiceCommandContext||{},dashboard.voiceCommandContext[gadgetName]=pageData.voiceCommandContext;var nativeVoiceCommmands=native.getModule("voiceCommands");nativeVoiceCommmands&&nativeVoiceCommmands.addVoiceCommand(nativeVoiceCommmands.createCommandFromPage(pageData))}return _writeWelcomeDashboard(dashboard)})}function _addPinnedTile(article,prototype,localization){var self=this,endpoint=globals.getEndpoint();return globals.getMetaData().getWelcomeDashboard().then(function(dashboard){var pinnedTilesGroups=_getHubGroup(dashboard.$article,_groupTypes.pinnedTiles);if(!pinnedTilesGroups){var grp=_addGroup(dashboard,locale.text("welcome.pinnedTiles")),quikLinksGroup=_getHubGroup(dashboard.$article,_groupTypes.quickLinks);quikLinksGroup&&(quikLinksGroup=dashboard.$article.$items.shift()),dashboard.$article.$items.unshift(grp),pinnedTilesGroups=dashboard.$article.$items[0],quikLinksGroup&&dashboard.$article.$items.unshift(quikLinksGroup)}var layout,layout=$.extend(!0,{},article);article.$layoutType!=="tile"&&(layout.$bgColor="darkgrey",layout.$layoutType="tile",layout.$size="large"),pinnedTilesGroups.$items.push(layout),dashboard.$article.$localization=dashboard.$article.$localization||{},Object.keys(localization).forEach(function(lang){Object.keys(localization[lang]).forEach(function(key){dashboard.$article.$localization[lang]=dashboard.$article.$localization[lang]||{},dashboard.$article.$localization[lang][key]=localization[lang][key]})});var $bind=article.$items[0].$bind;return dashboard.$gadgets[$bind]=prototype.getVignetteGadget(),dashboard.$gadgets[$bind].pinPageId=$bind,dashboard.$vignettes[$bind]={$uuid:$bind,$type:prototype.json.$type,$displayStyle:prototype.json.$displayStyle,$dbId:prototype.json.$dbId,$title:prototype.json.$title},_writeWelcomeDashboard(dashboard)})}function _removePinnedPage(pageId,groupType,doSave){var self=this;return globals.getMetaData().getWelcomeDashboard().then(function(dashboard){var gadgetId=_getGadgetIdPinnedPage(dashboard.$gadgets,pageId);if(!gadgetId)return null;var nativeVoiceCommmands=native.getModule("voiceCommands");return nativeVoiceCommmands&&nativeVoiceCommmands.removeVoiceCommand(dashboard.$gadgets[gadgetId].$title),delete dashboard.$gadgets[gadgetId],_removePinnedTile(dashboard.$article,gadgetId,groupType),delete dashboard.$vignettes[gadgetId],dashboard.voiceCommandContext&&dashboard.voiceCommandContext[gadgetId]&&delete dashboard.voiceCommandContext[gadgetId],doSave?_writeWelcomeDashboard(dashboard):dashboard})}function _unLocalizeHubGroups($article){function _walk(items){if(!items)return;items.forEach(function(item){if(item.$layoutType==="hubGroup"){var uuid=item.$title.match(/\{\@(\S+)\}/);item.$title=localization[uuid&&uuid[1]],utils.removeLocalization($article.$localization,uuid&&uuid[1])}_walk(item.$items)})}var localization=utils.getArticleLocalization($article);return localization?(_walk($article.$items),$article):$article}function _removePinnedTile($article,$bind,groupType){var grp=_getTileHubGroup($article,$bind);if(!grp)return;var items=grp.$items.filter(function(item){if(item.$items[0].$bind!==$bind)return!0});grp.$items=items;if(!grp.$items||grp.$items.length===0)items=$article.$items.filter(function(item){if(item!=grp)return!0;var uuid=item.$title.match(/\{\@(\S+)\}/);utils.removeLocalization($article.$localization,uuid&&uuid[1])}),$article.$items=items}function _getDashboard(dashboard){var cleaneddashboard=$.extend(!0,{},dashboard);return cleaneddashboard?(delete cleaneddashboard.$views,delete cleaneddashboard.roles,delete cleaneddashboard.$pageInfo,delete cleaneddashboard.$update,delete cleaneddashboard.description,cleaneddashboard):cleaneddashboard}function _addApps(dashboard,apps,voiceBookmarks,opts){var apps,groups={sageAppli:_hubGroup(_groupTypes.sageAppli,locale.text("welcome.sageapp")),byDefault:_hubGroup("default",locale.text("welcome.myapps"))},nativeVoiceCommmands=native.getModule("voiceCommands");apps.forEach(function(appInfo){var name=appInfo.applicationName,name="$welcome_"+appInfo.applicationName,gadget=_gadget(appInfo),vignette={$uuid:name};if(nativeVoiceCommmands){var voiceCmd=nativeVoiceCommmands.createCommandFromAppli(gadget.$title,appInfo);voiceCmd&&voiceBookmarks.push(voiceCmd)}dashboard.$gadgets[name]=gadget,dashboard.$vignettes[name]=vignette;if(opts.defaultArticle){var appTile={$layoutType:"tile",$bgColor:"darkgrey",$items:[{$bind:name}],$size:"medium"};_checkTileStatus(appInfo,appTile),groups[appInfo.isSageApplication?"sageAppli":"byDefault"].$items.push(appTile)}});for(var p in groups)(globals.isDvlpMode()||p!=="sageAppli")&&groups[p].$items.length>0&&dashboard.$article.$items.push(groups[p])}function _gadget(appInfo){var gadget={$type:"$application",$title:appInfo.title,applicationName:appInfo.applicationName,icon:appInfo.iconName};return gadget}function _vignette(appInfo){var vignette={$uuid:"$welcome_"+appInfo.applicationName};return vignette}function _checkTilesStatus(dashboard){var meta=globals.getMetaData(),forceReadApps=globals.needToCheckAppsList();return globals.setNeedToCheckAppsList(!1),meta.getApplications(forceReadApps).then(function(apps){return _cleanApplications(dashboard),apps.forEach(function(appInfo){var bind="$welcome_"+appInfo.applicationName;dashboard.$gadgets[bind]=_gadget(appInfo),dashboard.$vignettes[bind]=_vignette(appInfo),_checkTileStatus(appInfo,_getTileByBind(dashboard.$article,bind))}),dashboard})}function _checkTileStatus(app,appTile){if(app.versionNumber==null||!appTile)return;app.localVersionNumber!=null&&(app.localVersionNumber!=app.versionNumber?appTile.$icon="appUpdate":appTile.$icon=null)}function _writeWelcomeDashboard(dashboard,localOnly){return dashboard.$views[0].$isPersonal&&dashboard.$views[0].$selected?_writeWelcomeDashboardUser(dashboard,localOnly):_writeCommonWelcomeDashboard(dashboard)}function _writeWelcomeDashboardUser(dashboard,localOnly){var cleanedDashboard=_getDashboard(dashboard),storage=globals.getStorage(),ctx=globals.getUserCtx(),ctx={$user:ctx.$user,$role:ctx.$role,$lang:"none"},t=(new Date).getTime();return storage.put({$context:ctx,$collection:"$welcomeDashboard",$endpoint:"$local",$key:ctx.$user+"_"+ctx.$role,$data:cleanedDashboard}).then(function(result){if(!localOnly&&result.$status===storageModule.StatusCodes.OK&&globals.isOnline()){var securityProfile=globals.getSecurityProfile(),data={user:{$uuid:globals.getUserUuid()},role:{$uuid:globals.getSeletedRoleUuid()},description:dashboard.description||locale.text("welcome.mydashboard"),clientId:"",content:cleanedDashboard,isPersonal:!0};return _saveEntityWelcomeDashboard(data).then(function(data){return _setMetaWelcomeDashboard(data)})}return dashboard})}function _saveEntityWelcomeDashboard(data){return sdataCommonResources.updateWelcomeDashboard(data).then(function(data){return data}).fail(function(e){modal.error(locale.text("dashboard.welcome.updating.error"),e,function(){return data})})}function _writeCommonWelcomeDashboard(dashboard,opts){var currentView;Object.keys(dashboard.$views).some(function(key){if(dashboard.$views[key].$selected)return currentView=dashboard.$views[key],!0});var uuid=opts?opts.uuid:currentView?currentView.$uuid:null,roles=dashboard.roles,cleanedDashboard=_getDashboard(dashboard),data={uuid:uuid,user:{$uuid:globals.getUserUuid()},role:{$uuid:globals.getSeletedRoleUuid()},roles:roles,description:dashboard.description||"Dashboard template",clientId:"",content:cleanedDashboard};return _saveEntityWelcomeDashboard(data).then(function(data){return _setMetaWelcomeDashboard(data)})}function _deleteCommonWelcomeDashboard(uuid){return sdataCommonResources.deleteWelcomeDashboard(uuid).then(function(data){return data}).fail(function(e){modal.error(locale.text("dashboard.welcome.deleting.error"),e,function(){return{}})})}function _readWelcomeDashboardUser(){var storage=globals.getStorage(),ctx=globals.getUserCtx(),ctx={$user:ctx.$user,$role:ctx.$role,$lang:"none"},t=(new Date).getTime();return storage.read({$context:ctx,$collection:"$welcomeDashboard",$endpoint:"$local",$key:ctx.$user+"_"+ctx.$role}).then(function(result){return result.$status===storageModule.StatusCodes.OK?result.$data:{}})}function _hubGroup(grpTyp,title){return{$layoutType:"hubGroup",$groupType:grpTyp,$capabilities:_getHubGroupCapabilities(grpTyp),$title:title,$items:[]}}function _getHubGroupCapabilities(grpTyp){var capabilities="";switch(grpTyp){case _groupTypes.quickLinks:capabilities="edit,delete,draggable";break;case _groupTypes.pinnedTiles:capabilities="edit,delete,draggable";break;case _groupTypes.sageAppli:capabilities="edit,delete,draggable";break;case _groupTypes.default:capabilities="edit,delete,draggable"}return capabilities}function _getHubGroup($article,groupType){var grp;if(!$article||!$article.$items)return;return $article.$items.forEach(function(item){!grp&&item.$layoutType==="hubGroup"&&item.$groupType===groupType&&(grp=item)}),grp}function _getHubgroupsByType($article,groupType){function _walk(items){if(!items)return;items.forEach(function(item){item.$layoutType==="hubGroup"&&item.$groupType===groupType&&hub.push(item),_walk(item.$items)})}var hub=[];return _walk($article.$items),hub}function _getTileHubGroup($article,$bind){var grp;return $article.$items.forEach(function(hubgroup){!grp&&hubgroup.$items.length>0&&hubgroup.$items.forEach(function(item){item.$items[0].$bind===$bind&&(grp=hubgroup)})}),grp}function _getTileByBind($article,$bind){function _walk(items){if(!items)return;items.forEach(function(item){item.$layoutType==="tile"&&!tile&&item.$items[0].$bind===$bind&&(tile=item),tile||_walk(item.$items)})}var tile;return _walk($article.$items),tile}function _removeTileByBind($article,$bind){function _walk(items){if(remove)return;if(!items)return;var idx=0;items.forEach(function(item){if(remove)return;item.$layoutType==="tile"&&!remove&&item.$items[0].$bind===$bind&&(remove={collection:items,idx:idx}),idx++,remove||_walk(item.$items)})}var remove;return _walk($article.$items),remove&&remove.collection.splice(remove.idx,1),$article}function _getGadgetIdPinnedPage($gadgets,pinPageId){var gadgetId;return $gadgets?(Object.keys($gadgets).forEach(function(key){!gadgetId&&$gadgets[key].pinPageId===pinPageId&&(gadgetId=key)}),gadgetId):null}var globals=require("syracuse-tablet/html/js/helpers/globals"),storageModule=require("syracuse-tablet/html/js/storage/storage"),locale=require("syracuse-tablet/html/js/helpers/locale"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),native=require("syracuse-tablet/html/js/helpers/native/native"),sdataCommonResources=require("syracuse-tablet/html/js/sdata/sdataCommonResources"),utils=require("syracuse-tablet/html/js/helpers/utils"),_groupTypes={quickLinks:"quicklinks",pinnedTiles:"pinnedTiles",sageAppli:"sageAppli","default":"default"};exports.getPinnedPageContext=_getPinnedPageContext,exports.defaultWelcomeApplication=_defaultWelcomeApplication,exports.getWelcomeDashboard=_getWelcomeDashboard,exports.writeWelcomeDashboard=_writeWelcomeDashboard,exports.writeWelcomeDashboardUser=_writeWelcomeDashboardUser,exports.writeCommonWelcomeDashboard=_writeCommonWelcomeDashboard,exports.deleteCommonWelcomeDashboard=_deleteCommonWelcomeDashboard,exports.setMetaWelcomeDashboard=_setMetaWelcomeDashboard,exports.updateDashboard=_updateDashboard,exports.emptyDashboard=_emptyDashboard,exports.addPinnedPage=_addPinnedPage,exports.removePinnedPage=_removePinnedPage,exports.isPinnedPage=_isPinnedPage,exports.removeTileByBind=_removeTileByBind,exports.unLocalizeHubGroups=_unLocalizeHubGroups,exports.addPinnedTile=_addPinnedTile,exports.isPinnedTile=_isPinnedTile,exports.checkTilesStatus=_checkTilesStatus,exports.groupType=function(name){return _groupTypes[name]||"default"},exports.hubGroup=_hubGroup,exports.getHubGroupCapabilities=_getHubGroupCapabilities,exports.getRoles=_getRoles}),define("syracuse-tablet/html/js/application/application",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/modals/modal","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/application/authentication","syracuse-tablet/html/js/application/eventListener","syracuse-tablet/html/js/application/pageLoader","syracuse-tablet/html/js/init/initContext","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/application/pageRegistry","syracuse-tablet/html/js/authoring/authoring","syracuse-tablet/html/js/ui/developmentPage","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/application/settings","syracuse-tablet/html/js/ui/modals/modalShowLegal","syracuse-tablet/html/js/ui/modals/modalSettings","syracuse-tablet/html/js/ui/modals/modalConfirm","syracuse-tablet/html/js/helpers/native/native","syracuse-tablet/html/js/sdata/sdataCommonResources","syracuse-tablet/html/js/helpers/dashboardWelcomeUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("app"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),globals=require("syracuse-tablet/html/js/helpers/globals"),auth=require("syracuse-tablet/html/js/application/authentication"),eventListener=require("syracuse-tablet/html/js/application/eventListener"),pageLoader=require("syracuse-tablet/html/js/application/pageLoader"),initContext=require("syracuse-tablet/html/js/init/initContext"),uiutils=require("syracuse-tablet/html/js/ui/uiUtils"),pageRegistry=require("syracuse-tablet/html/js/application/pageRegistry"),authoring=require("syracuse-tablet/html/js/authoring/authoring"),developmentPage=require("syracuse-tablet/html/js/ui/developmentPage"),locale=require("syracuse-tablet/html/js/helpers/locale"),settings=require("syracuse-tablet/html/js/application/settings"),modalShowLegal=require("syracuse-tablet/html/js/ui/modals/modalShowLegal"),modalSettings=require("syracuse-tablet/html/js/ui/modals/modalSettings"),modalConfirm=require("syracuse-tablet/html/js/ui/modals/modalConfirm"),native=require("syracuse-tablet/html/js/helpers/native/native"),sdataCommonResources=require("syracuse-tablet/html/js/sdata/sdataCommonResources"),dashboardWelcomeUtils=require("syracuse-tablet/html/js/helpers/dashboardWelcomeUtils"),_appConfig={transition:null,openLinkInVignette:!1,loadUserImage:!0},_subscribe=function(self){notifications.subscribe(self,["sm.modal.open","sm.modal.close","sm.main.layout.changed","sm.user.logged.in"],1)},_Application=utils.defineClass(function($$elmt,factory){this.$$elmt=$$elmt,this.currentPage=null,this._$config=$.extend(!0,{},_appConfig),this.factory=factory,this._pageLoader=null,this._nbModals=0,this._wait=uiutils.waitWheelCreate($$elmt),this.homePageId=null,this.uuid="root",this.history=[],this.pushState=!0},null,{init:function(){eventListener.bindEvents(this),this.dao=this.factory.createDaoApp(this),_subscribe(this),this.$$elmt.show()},destroy:function(){authoring.destroy(),this._wait&&(uiutils.waitWheelDestroy(this._wait),this._wait=null),this.currentPage&&(this.currentPage.destroy(),this.currentPage=null),this.$$elmt&&(this.removeAllChildPages(this.$$elmt),this.$$elmt.unbind(),this.$$elmt.remove(),this.$$elmt=null),this.dao&&(this.dao.destroy(),this.dao=null),this._pageLoader&&(this._pageLoader.destroy(),this._pageLoader=null),notifications.unsubscribe(),$(window).unbind()},isLoadingPage:function(){return this._pageLoader!=null&&this._pageLoader.isLoading()},onUnload:function(){this.destroy()},onBeforeUnload:function(){},isWelcomeApplication:function(){return this.uuid==="$welcomeApplication"},getTitle:function(){return this.dao.getApplicationTitle()},gotoHome:function(){var self=this,deferred=$.Deferred();return setTimeout(function(){self.changePage(self.homePageId).then(function(){deferred.resolve()}).fail(function(e){deferred.reject(e)})}),deferred.promise()},$config:function(id){return utils.getPropByPath(this._$config,id)},notifModalOpen:function(){this._nbModals++,log&&log("notifModalOpen nbModals="+this._nbModals)},notifModalClose:function(){this._nbModals=Math.max(this._nbModals-1,0),log&&log("notifModalClose nbModals="+this._nbModals)},notifMainLayoutChanged:function(info,orientation,deviceType){var self=this;self.$$elmt.width(info.application.width),self.$$elmt.height(info.application.height),self.currentPage&&(self.currentPage.onMainPageResize(info,orientation,deviceType),info.afterMainPageLoaded===!0&&globals.isAutoUITestMode()&&globals.getUnitTestMgr().notifPageLoaded("after",self.currentPage)),info.deviceChanged&&self.triggerUpdtDraftsCount()},getScrollOffset:function(){return{top:this.$$elmt.scrollTop(),left:this.$$elmt.scrollLeft()}},hasModalOpen:function(){return log&&log("_nbModals="+this._nbModals),this._nbModals>0},_actGotoWelcomeApplication:function(){return this.gotoWelcomeApplication()},_actLogout:function(actionName){this.logout("logout.msg")},_actOpenDraft:function(draftId){var self=this;if(!draftId)return;return globals.getStorage().draftOperation("draftRead",draftId).then(function(ctx){if(!ctx||!ctx.restoredContext)return;self._switchToContext(ctx.restoredContext)})},_actHistoryBack:function(){window.history.back()},_actSwitchContext:function(){var self=this;initContext.askNewContext().then(function(canceled){if(canceled==1)return;self.gotoWelcomeApplication(!0)}).fail(function(e){self.waitWheelStop();if(e!=null&&e.$redirectPage==="login"){var msg;e.$diagnoses&&e.$diagnoses.length>0?msg=e.$diagnoses[0].$message:msg=e.message||e.$message,self.logout(msg)}else globals.getModal().error(locale.text("user.context.error"),e)})},_actDevelopmentPage:function(){developmentPage.show()},_actSettings:function(){var self=this;return settings.getGlobalSettings().then(function(set){var modal=new modalSettings.Modal(set);return modal.show()}).then(function(result){if(result)return settings.setGlobalSettings(result)})},_actDesignPage:function(){authoring.toggleDesignPage()},_addRemovePinPage:function(add){if(add===undefined)return;var self=this,pageData=self.currentPage.getPinPageData();add?(pageData.dashboardName&&pageData.applicationName===self.dao.getApplicationName()&&pageData.dashboardName===self.dao.getHomeDashboardName()&&(pageData.icon=self.dao.getApplicationIcon()),dashboardWelcomeUtils.addPinnedPage(pageData).then(function(){var notify={severityClass:"success",title:"",body:locale.text("pin.page.add.ok",[pageData.title]),onlyWebapp:!0};globals.getModal().notify(notify),notifications.publish("sm.page.pin.state.change",2)})):dashboardWelcomeUtils.removePinnedPage(pageData.id,dashboardWelcomeUtils.groupType("quickLinks"),!0).then(function(){var notify={severityClass:"success",title:"",body:locale.text("pin.page.remove.ok",[pageData.title]),onlyWebapp:!0};globals.getModal().notify(notify),notifications.publish("sm.page.pin.state.change",1)})},_actAbout:function(){var modal=new modalShowLegal.Modal;modal.show()},_switchToApplication:function(appName,options){var self=this;return globals.getMetaData().checkApplicationUpdate(appName).then(function(update){if(update!==!0)return!1;var modal=new modalConfirm.Modal(locale.text("modal.confirm.update"),null,!0);return modal.show().then(function(result){return result==="yes"})}).then(function(forceUpdate){return globals.getMetaData().getApplication(appName,!1,forceUpdate)}).then(function(appDetails){return self._setCurrentApplication(appDetails,options)}).fail(function(e){return self.waitWheelStop(),e&&e.$noConnectionError==1&&globals.setOffline(!0,{severityClass:"error",body:locale.text("action.needs.net")}),$.smReject(e)})},gotoWelcomeApplication:function(switchContext){var self=this,step;return globals.isLoggedIn()?step=globals.getMetaData().getWelcomeApplication(switchContext).then(function(appDetails){return self._setCurrentApplication(appDetails,{forceChange:!0})}):step=this.gotoLogin(),step},gotoLogin:function(reason,isError,offlineHint){var self=this,deferred=$.Deferred();return setTimeout(function(){self.changePage("login",{reason:reason,isError:isError===!0,offlineHint:offlineHint}).then(function(){deferred.resolve()}).fail(function(e){deferred.reject(e)})},0),deferred.promise()},_setCurrentApplication:function(appInfo,options){var self=this,deferred=$.Deferred();options=options||{};try{if(!appInfo)throw new Error("Null appInfo");log&&log("Switch to Syracuse Mobile Application "+appInfo.applicationName),self.currentPage&&self.currentPage.deactivate();if(!appInfo.$application.$uuid)throw new Error("No application $uuid - "+appInfo.applicationName);if(self.uuid!==appInfo.$application.$uuid||options.forceChange)self.dao.setApplication(appInfo),self.homePageId=globals.getMetaData().getDashboardPageName(self.dao.getHomeDashboardName()),self.uuid=appInfo.$application.$uuid,self.applicationName=appInfo.$application.applicationName||self.uuid,self.welcomeApplication=appInfo.$application.welcomeApplication||!1;options.noPageChange!==!0?self.gotoHome().then(function(){deferred.resolve()}).fail(function(e){deferred.reject(e)}):deferred.resolve()}catch(e){self.currentPage&&self.currentPage.activate(),options.dontDiplayErrors===!0?deferred.reject(e):modal.error("Error switching application",e,function(){deferred.reject(e)})}return deferred.promise()},_gotoPage:function(state,back,loadOptions){var self=this,step;return self._pageLoader||(self._pageLoader=self._createPageLoader()),self.applicationName&&state.applicationName!=self.applicationName?step=self._switchToApplication(state.applicationName,{noPageChange:!0}):step=$.smResolve(),step.then(function(){return state.isLogin===!1&&!globals.isLoggedIn()?(self.gotoLogin("Authentication is required"),$.smResolve()):self._pageLoader.isLoading()?$.smResolve():self._pageLoader.load(state,back,loadOptions).then(function(page){return notifications.publish(["sm.mainpage.loaded"],self.history),page})})},_createPageLoader:function(){var self=this,loader=new pageLoader.Klass({beforeLoading:function(){globals.isAutoUITestMode()&&globals.getUnitTestMgr().notifPageLoaded("before")},waitWheelStop:function(){self.waitWheelStop()},getRootElmt:function(){return self.$$elmt},waitWheelStart:function(){self.waitWheelStart()},getCurrentPage:function(){return self.currentPage},setCurrentPage:function(page){self.currentPage=page,page.state.isLogin===!0?self.historyReset(page):page.state.name===self.homePageId&&(log&&log("Home page "+self.homePageId+" - Destroy all pages except current"),self.removeAllChildPages(self.$$elmt,page))},historyPush:function(state){self.history.push(state),self.pushState?window.history.pushState({x:new Date},utils.UUID(),null):window.history.replaceState({x:new Date},utils.UUID(),null)},succeeded:function(dstPage,pageToClose,parentNotifInfo,back,loadOptions){log&&log("succeeded - win="+window.history.length+" - app="+self.history.length),(dstPage.isNew||back&&pageToClose&&pageToClose.isChild&&pageToClose.sizeModified)&&uiutils.triggerResizeInternal({afterMainPageLoaded:!0}),globals.isAutoUITestMode()&&globals.getUnitTestMgr().notifPageLoaded("after",dstPage);if(parentNotifInfo&&parentNotifInfo.notifId){var controllerToNotify=globals.getController(parentNotifInfo.parentId);controllerToNotify?notifications.notifyController(parentNotifInfo.notifId,controllerToNotify,parentNotifInfo.notifData,parentNotifInfo.controlId):notifications.publish(parentNotifInfo.notifId,parentNotifInfo.notifData)}self.triggerUpdtDraftsCount()}});return loader},triggerUpdtDraftsCount:function(){globals.getStorage().draftOperation("draftNotifyChanged")},historyReset:function(page){this.removeAllChildPages(this.$$elmt,page),this.history=[]},historyScan:function(cb){for(var i=this.history.length-1;i>=0;i--)if(cb(this.history[i])===!0)break},historyLog:function(title){this.historyScan(function(state){console.log("	",state.name)})},_checkBack:function(){return authoring&&!authoring.checkBack()?!1:this.currentPage?this.currentPage.checkBack():!0},historyPop:function(event,pageFilter){var self=this,deferred=$.Deferred(),res;if(this._pageLoader&&this._pageLoader.isLoading()){self._pageLoader.stopLoading("back"),self._pageLoader.destroy(),self._pageLoader=null;return}res=self._checkBack();var step;return utils.isPromise(res)?step=res:step=$.smResolve(res),step.then(function(kontinue){if(kontinue!==!0)return deferred.resolve(null);log&&log("History pop before - win="+window.history.length+" - app="+self.history.length);if(self._nbModals>0)return event&&event.preventDefault(),deferred.resolve(null);if(self.uuid==="root"||self.history.length===0)return window.history.back(),deferred.resolve(null);if(pageFilter&&self.history.length>0){var selectedIdx=-1;for(var i=self.history.length-1;i>=0;i--)if(pageFilter(self.history[i])){selectedIdx=i;break}if(selectedIdx<0)return event&&event.preventDefault(),deferred.resolve(null);while(self.history.length>selectedIdx+2){var state=self.history.pop(),pageToRemove=$("#"+state.uuid).smPageController();pageToRemove&&pageToRemove!=self.currentPage&&pageToRemove.destroy()}}var state=self.history.length>0?self.history.pop():null;if(state&&(state.isWelcomePage||state.isLogin))return deferred.resolve(null);state=self.history.length>0?self.history[self.history.length-1]:null,event&&event.preventDefault(),self.pushState=!0,state&&setTimeout(function(){var step;state.isWelcomePage&&!self.currentPage.isLookup()?step=self.gotoWelcomeApplication():step=self._gotoPage(state,!0),step.then(function(newPage){deferred.resolve(newPage)}).fail(function(e){deferred.reject(e)})},0)}).fail(function(e){deferred.reject(e)}),deferred.promise()},goBack:function(pageFilter){var deferred=$.Deferred();return this.historyPop(null,pageFilter).then(function(newPage){deferred.resolve(newPage)}).fail(function(e){globals.getModal().error(null,e,function(){deferred.reject(e)})}),deferred.promise()},changePage:function(pageName,pageOptions,changePageOpts,savedContext){var self=this;pageOptions=pageOptions||{},changePageOpts=changePageOpts||{};var step;pageName=="$welcomeDashboard.$mobileDashboard"&&(pageOptions.applicationName="$welcomeApplication");var switchApplication=pageOptions.applicationName&&self.applicationName!=pageOptions.applicationName;return switchApplication?step=self._switchToApplication(pageOptions.applicationName,{noPageChange:!0}):step=$.smResolve(),step.then(function(){pageName||(pageName=self.homePageId);var curPage;if(pageOptions.parentId&&pageOptions.parentId.length>0){curPage=globals.getController(pageOptions.parentId);if(!curPage)throw new Error("changePage - Can't find parent page - "+pageOptions.parentId)}else curPage=self.currentPage;return pageRegistry.getPageInfo(pageName,pageOptions,curPage)}).then(function(pageInfo){return switchApplication!==!0&&self.currentPage&&self.currentPage.isSamePage(pageInfo)?$.smResolve(self.currentPage):(savedContext&&(pageInfo.savedContext=savedContext),self._gotoPage(pageInfo,!1,{dontDisplayLoadErr:changePageOpts.callerhandlesErrors,restoreSavedContext:savedContext!=null}))}).fail(function(e){self.waitWheelStop();var next=e&&e.$redirectPage||"welcomePage";return next==="current"&&self.currentPage?self.refreshPage():next==="login"?self.gotoLogin(locale.text("login.timeout.message"),!0):changePageOpts.callerhandlesErrors!==!0&&(e&&e.$noConnectionError==1?self.gotoWelcomeApplication():globals.getModal().error(null,e,function(){self.gotoWelcomeApplication()})),e})},logout:function(msgOrLocaleId,isError,offlineHint){var deferred=$.Deferred(),self=this,_loggedOut=function(){log&&log("User Logged out"),globals.clearUserCtx(),deferred.resolve(),msgOrLocaleId||(isError=!1);var text=locale.textNoFail(msgOrLocaleId);text||(text=msgOrLocaleId),auth.check().then(function(){self.gotoLogin(text,isError,offlineHint)})};return self.waitWheelStart(),auth.check().then(function(up){return up?auth.logout():!0}).then(function(ok,message){self.waitWheelStop(),ok?_loggedOut(msgOrLocaleId):_loggedOut(message)}).fail(function(e){self.waitWheelStop(),modal.error("Logout error",e,function(){_loggedOut()})}),deferred.promise()},refreshPage:function(options){var self=this;if(!self.currentPage||self.currentPage.destroyed){self.gotoWelcomeApplication();return}self.currentPage.refresh(options).then(function(){}).fail(function(e){globals.getModal().error(locale.text("err.load.main"),e,function(){var next=e&&e.$redirectPage;next==="login"?self.gotoLogin(locale.text("login.timeout.message"),!0):self.gotoWelcomeApplication()})})},waitWheelStart:function(){uiutils.waitWheelStart(this._wait)},waitWheelStop:function(){uiutils.waitWheelStop(this._wait)},getMessageSlot:function(){this._$$actMsgSlot||(this._$$actMsgSlot={});var deviceType=globals.getSiteLayout().getDeviceType(),orientation=globals.getSiteLayout().getPageOrientation(),key=deviceType+orientation;if(this._$$actMsgSlot[key])return this._$$actMsgSlot[key];var $$slot=this._$$actMsgSlot[key]=$("<div>").addClass("s-m-act-msg-slot").addClass(deviceType).addClass(orientation);return this.$$elmt.prepend($$slot),$$slot},_actPinPage:function(){var self=this,pin=!1,liveTileRemove=!1,nativeLiveTile=self.currentPage.nativeCapabilities.liveTile?native.getModule("liveTile"):null;dashboardWelcomeUtils.isPinnedPage(self.currentPage.getPinPageId()).then(function(isPinned){pin=isPinned!=2;var message=locale.text("pin.page."+(pin?"add":"remove")+".confirm");return globals.getModal().simpleConfirmPromise({message:message})}).then(function(result){if(result.action!=="yes")return;self._addRemovePinPage(pin)}).fail(function(e){globals.getModal().error(e)})},removeAllChildPages:function($$elmt){if(!$$elmt)return;$$elmt.jquery||($$elmt=$($$elmt));var exclude=Array.prototype.slice.call(arguments,1);$$elmt.children(".s-m-page").each(function(idx){var page=$(this).smPageController();page&&Array.prototype.indexOf.call(exclude,page)==-1&&page.destroy()})},getHistory:function(){return this.history},_nativeGetContextToRestore:function(){var self=this;if(!self.currentPage||self.currentPage.state.isLogin||self.currentPage.state.isWelcomePage)return null;var stackHistory=[];self.history&&self.history.forEach(function(state){if(state.isLogin||state.isWelcomePage||state.options&&state.options.parentId!=null)return;stackHistory.push(state)});var history=null,start=stackHistory&&stackHistory.length>0?stackHistory.length-2:-1,state;for(var i=start;i>=0;i--){state=stackHistory[i],history||(history=[]),history.unshift(state);if(state.name===self.homePageId)break}var context;if(self.currentPage.isChild){var state=stackHistory[stackHistory.length-1];if(!state)return;context={endpoint:globals.getEndpoint(),applicationName:state.applicationName,role:globals.getUserRole(),currentState:state}}else context=self.currentPage.getRestoreContext("nativeAppClosing");if(!context)return;return context.history=history,context},notifUserLoggedIn:function(fromInitProcess,restoredContext){var self=this;self._restoreHistoryContext(restoredContext).then(function(){fromInitProcess===!0&&notifications.publish(["sm.application.ready"],!0)}).fail(function(){self.gotoWelcomeApplication().always(function(){fromInitProcess===!0&&notifications.publish(["sm.application.ready"],!1)})})},_restoreHistoryContext:function(restoredContext){var self=this,step=self.gotoWelcomeApplication();return!restoredContext||restoredContext.applicationName==null?step:step.then(function(){var appName=restoredContext.applicationName;return appName!==self.applicationName||appName!==self.uuid?globals.getMetaData().getApplication(appName).then(function(app){var def=$.Deferred();return app?def.resolve(restoredContext):(globals.getModal().notify(locale.text("restorecontext.bad"),locale.text("restorecontext.badapp",[appName])),restoredContext=null,def.resolve()),def.promise()}):$.smResolve(restoredContext)}).then(function(){if(!restoredContext||!restoredContext.currentState)return null;restoredContext.history&&restoredContext.history.length>0&&restoredContext.history.forEach(function(state){self.history.push(state)});var opts=$.extend(!0,{},restoredContext.currentState.options);return opts.applicationName=restoredContext.applicationName,self.changePage(restoredContext.currentState.name,opts,null,restoredContext.currentState.savedContext)}).fail(function(e){globals.getModal().error("Error restoring page context",e)})},nativeWrapperJSInterface:function(moduleName,action){var self=this;if(moduleName==="nativeApp"&&action==="applicationClosing"){var ctx=self._nativeGetContextToRestore(!0);return ctx?JSON.stringify(ctx,null,2):null}if(moduleName==="nativeApp"&&action==="backButtonPressed")return!self.currentPage||self.currentPage.state.isLogin||self.currentPage.state.isWelcomePage?!1:(setTimeout(function(){self.goBack()}),!0);if(moduleName==="nativeApp"&&action==="applicationActivated"){if(!self.currentPage||!self.currentPage.state.isLogin)return;window.location.reload()}if(moduleName==="voiceCommands"&&action==="executeVoiceCommand"){var cmd=arguments[2];if(!cmd)return;if(cmd.type==="openBookmark"){if(!cmd.context)return;log&&log("Bookmark: "+JSON.stringify(cmd||{})),self._switchToContext(cmd.context);return}}if(moduleName==="share"&&action==="handleLink"){var contextId=arguments[2],step=contextId?sdataCommonResources.readSharedContext(contextId):$.smResolve(null);step.then(function(context){self._restoreHistoryContext(context)});return}},_switchToContext:function(context){var self=this;if(!context)return;var step,context;context.endpoint&&context.endpoint!==globals.getEndpoint()?step=initContext.switchContext(context).then(function(contextToRestore){return $.smResolve(contextToRestore&&contextToRestore.applicationName,!0)}):step=$.smResolve(context.applicationName,!1),step.then(function(applicationName,forceGotoWelcomeApp){var step=forceGotoWelcomeApp===!0?self.gotoWelcomeApplication():$.smResolve();return step.then(function(){if(applicationName)return self._switchToApplication(applicationName,{noPageChange:!0})})}).then(function(){if(!context.currentState)return self.gotoHome();var opts=$.extend(!0,{},context.currentState.options);return self.changePage(context.currentState.name,opts)}).fail(function(e){(!e||e.$noConnectionError!=1)&&globals.getModal().error(e)})}});exports.Application=_Application}),define("syracuse-tablet/html/js/helpers/controller",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/articleParser","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),globals=require("syracuse-tablet/html/js/helpers/globals"),articleParser=require("syracuse-tablet/html/js/helpers/articleParser"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_Klass=utils.defineClass(function(id,prototype,article,options){this.options=options||{},this.id=id||utils.UUID(),this.prototype=prototype,this.article=article,this.rootLayout=null,this.dao=null,this._evtListener=null,this.isVignette=!1,this._controlsMap={},this._layoutsMap={},this.$activity="read",globals.addController(this),notifications.subscribe(this,["sm.lookup.selection"],1),this.destroyed=!1},null,{resetMaps:function(){this._controlsMap={},this._layoutsMap={}},destroy:function(){if(this.destroyed)return;globals.removeController(this),this._controlsMap=null,this._layoutsMap=null,this.dao&&(this.dao.destroy(),this.dao=null),this.rootLayout&&(this.rootLayout.destroy(),this.rootLayout=null),this.prototype&&(this.prototype.destroy(),this.prototype=null),this.removeEventListener(),notifications.unsubscribe(this),this.article=null,this.prototype=null,this.destroyed=!0},addControl:function(c){if(!c||!this._controlsMap)return;this._controlsMap[c.id]=c},removeControl:function(c){if(!c||!this._controlsMap)return;delete this._controlsMap[c.id]},addLayout:function(c){if(!c||!this._layoutsMap)return;this._layoutsMap[c.id]=c},getControl:function(id){return this._controlsMap&&this._controlsMap[id]},getLayout:function(id){return this._layoutsMap&&this._layoutsMap[id]},getStructElmt:function(id){return this.getControl(id)||this.getLayout(id)},forEachControl:function(callBack){if(!callBack)return;var c=null;for(var id in this._controlsMap)if(callBack(id,this._controlsMap[id])){c=this._controlsMap[id];break}return c},getControlByBind:function($bind){for(var p in this._controlsMap)if(this._controlsMap[p].$bind===$bind)return this._controlsMap[p];return null},setDao:function(dao){this.dao&&this.dao.destroy&&this.dao.destroy(),this.dao=dao},isEditMode:function(){return this.$activity==="edit"||this.$activity==="create"},setActivity:function(activity){this.$activity=activity||"read"},buildControlsTree:function(opts){return this.rootLayout&&this.rootLayout.destroy(),this.rootLayout=articleParser.article2Controls(this,this.article,this.prototype,opts||{}),this.rootLayout},render:function($$parent,buildOpts){if(!this.rootLayout)return;this.rootLayout.buildHtml($$parent,this.dao,buildOpts),this.rootLayout.$$elmt.attr("data-controller-id",this.id)},refresh:function(options,callBackInterface){throw new Error("Not implemeneted")},refreshControls:function(ids,options){var self=this;if(self.destroyed)return;var errors=[];if(self.destroyed)return errors;var _refresh=function(ctrl){if(!ctrl)return;ctrl.refresh(self.dao,options),ctrl.hasError()&&errors.push(ctrl)};return ids&&ids.length>0?ids.forEach(function(id){_refresh(self._controlsMap[id])}):Object.keys(self._controlsMap).forEach(function(key){_refresh(self._controlsMap[key])}),errors},notifActionLink:function(success,link,result,options){throw new Error("not implemented")},notifLookupSelection:function(rowData,controlId){try{var ctrl=this.getControl(controlId);if(!ctrl)throw new Error("Control not found '"+controlId+"'");if(!ctrl.setLookupValue)throw new Error("Control must implement setLookupValue '"+controlId+"'");ctrl.setLookupValue(rowData)}catch(e){globals.getModal().error("notifLookupSelection failed",e)}},checkControlsData:function(){if(!this.isEditMode())return!0;var self=this,ok=!0,firstError,c;return Object.keys(self._controlsMap).forEach(function(key){c=self._controlsMap[key],c&&c.checkData&&(ok=ok&&c.checkData(),!ok&&firstError==null&&(firstError=c))}),firstError&&firstError.setFocus(),ok},makeVisible:function(c){},applyChange:function(newData){if(!newData||!this.dao)return;this.dao.applyChange(newData),this.refreshControls(null,{refreshValue:!0})},addEventListener:function(eventName,method){if(!method||typeof method!="function")return;this._evtListener||(this._evtListener={}),this._evtListener[eventName]=jsutils.bindFn(method,this)},removeEventListener:function(eventName){if(!this._evtListener)return;if(eventName)this._evtListener[eventName]=null;else for(var p in this._evtListener)this._evtListener=null},getEventListener:function(eventName){return this._evtListener?this._evtListener[eventName]:null}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/pages/helpers/helpers",["require","exports","module","syracuse-tablet/html/js/helpers/native/native","syracuse-tablet/html/js/helpers/globals"],function(require,exports,module){var native=require("syracuse-tablet/html/js/helpers/native/native"),globals=require("syracuse-tablet/html/js/helpers/globals"),_linksMap={header:{smartphone:{details:{$edit:!0,$delete:!0},edit:{$canceledit:!0,$save:!0},query:{$create:!0},create:{$save:!0,$canceledit:!0}},tablet:{}},footer:{smartphone:{},tablet:{details:{$edit:!0,$delete:!0,$query:!0},edit:{$save:!0,$canceledit:!0},query:{$create:!0},create:{$save:!0,$canceledit:!0}}},actionpanel:{}},_isSingleItemLink=function(url){return/\((\S*\{\S*\}\S*)\).*\?.*representation=/.test(url)?!0:!1},_isOfficeLink=function(name,info){return name.smStartsWith("$word")||name.smStartsWith("$excel")||info.$type!=null&&info.$type.indexOf("openxml")>=0},_isPaginLink=function(name){return name==="$first"||name==="$previous"||name==="$next"||name==="$last"},_nativeCapabilities={liveTile:{regular:{query:!0,stat:!0,cube:!0}},scheduleMessage:{regular:{query:!0,details:!0,edit:!1},dashboard:{std:!0,welcome:!1}},share:{regular:{query:!0,details:!0},dashboard:{std:!0,welcome:!1}}},_nonNativeCapabilities={mailto:{regular:{query:!0,details:!0},dashboard:{std:!0,welcome:!1}}},_notInPanel=["$edit","$create","$delete","$details","$query","$save","$canceledit"];exports.excludeFromPanel=function(name,forceFooterHeader,link,facet){return _notInPanel.indexOf(name)>=0?!0:facet==="query"&&link&&link.$url&&_isSingleItemLink(link.$url)?!0:forceFooterHeader===!0},exports.checkLink=function(name,info){return info==null||info.$isExcluded===!0?!1:_isPaginLink(name)?!1:name.smStartsWith("$")&&_isOfficeLink(name,info)?!1:!0},exports.getLinkMap=function(toolbar,deviceType,facet){var lMap=_linksMap[toolbar];if(!lMap)throw new Error("Unexpected toolbar parameter ["+toolbar+"]. Expected 'header', 'footer' or 'actionpanel'");if(toolbar==="actionpanel")return lMap;lMap=lMap[deviceType||"tablet"];if(!lMap)throw new Error("Unexpected deviceType parameter ["+deviceType+"]. Expected 'tablet', 'smartphone'");facet==="lookup"&&(facet="query"),facet==="summary"&&(facet="details"),lMap=lMap[facet];if(!lMap)throw new Error("Unexpected facet parameter ["+facet+"]");return lMap};var _pageSubType=function(page){return page?page.state.subtype.split(" ")[0]:null};exports.getNativeCapabilities=function(page){var result={};if(!page||!page.state||!page.state.type||!page.state.subtype)return result;var subtype=_pageSubType(page),pageCapability;return["liveTile","scheduleMessage","share"].forEach(function(capability){pageCapability=_nativeCapabilities[capability],result[capability]=pageCapability&&native.hasCapability(capability),result[capability]&&(result[capability]=pageCapability[page.state.type]!=null&&pageCapability[page.state.type][subtype]===!0)}),result},exports.getNonNativeCapabilities=function(page){var result={};if(globals.isNativeModeEnabled()||!page||!page.state||!page.state.type||!page.state.subtype)return result;var subtype=_pageSubType(page),cpblties;return["mailto"].forEach(function(cpb){cpblties=_nonNativeCapabilities[cpb],result[cpb]=cpblties&&cpblties[page.state.type]!=null&&cpblties[page.state.type][subtype]===!0}),result},exports.insidePageControls=["header","breadcrumbs","topToolbar","footer"],exports.topPageControls=["header","breadcrumbs","topToolbar"]}),define("syracuse-tablet/html/js/pages/helpers/panelsManager",["require","exports","module","syracuse-tablet/html/js/pages/helpers/helpers","syracuse-tablet/html/js/controls/ctrlFactory"],function(require,exports,module){var pageHelpers=require("syracuse-tablet/html/js/pages/helpers/helpers"),ctrlFactory=require("syracuse-tablet/html/js/controls/ctrlFactory"),_PanelManager=function(page){this.controller=page,this.$$dismissPanel=page.$$elmt.children(".s-m-side-panel-dismiss"),this.$$panels={left:page.$$elmt.children("aside.s-m-panel.s-m-left"),right:page.$$elmt.children("aside.s-m-panel.s-m-right")},this.destroy=function(){this.controller=null,this.$$dismissPanel=null,this.$$panels=null},this.checkDestroyed=function(){return this.controller==null||this.$$dismissPanel==null||this.controller.destroyed},this.panelAttach=function(where,panel,action){if(this.checkDestroyed()||!panel||where!="right"&&where!="left")return;var currentPanel=this.controller.getPageControl(where);currentPanel&&currentPanel!=panel&&this.panelDetach(where);if(!panel.isAttached(where)){var $$parent=this.$$panels[where];if($$parent.length!=1)return;this.controller.addControl(panel),this.controller._pageControls.add(where,panel).attach($$parent,where)}return this.panelToggle(where,panel,action)},this.panelToggle=function(where,panel,action){var self=this;if(self.checkDestroyed())return;var $$root=self.$$panels[where];if(!$$root)return;panel||(panel=self.controller.getPageControl(where));if(!panel||!panel.$$elmt)return null;var wasVisible=$$root.is(":visible");if(action==="resize"){if(!wasVisible)return null}else $$root.toggle(action==="close"?!1:undefined);var isVisible=$$root.is(":visible");wasVisible!==isVisible&&panel.notifyToggled(where,action,isVisible);var newWidth=isVisible?$$root.width():0;panel.closeBox!=1&&self.$$dismissPanel[isVisible?"addClass":"removeClass"](where).css(where,newWidth);if(panel.overlap!=1){var shiftElmts=[self.controller.$$contentElmt];pageHelpers.insidePageControls.forEach(function(id){var c=self.controller.getPageControl(id);c&&c.$$elmt&&shiftElmts.push(c.$$elmt.parent())}),shiftElmts.forEach(function($$elmt){$$elmt.css("left",(isVisible?(where==="right"?-1:1)*newWidth:0)+"px")})}return panel},this.panelDetach=function(where){if(this.checkDestroyed())return;var p=this.controller.getPageControl(where);if(!p)return;this.panelToggle(where,p,"close"),this.controller.removeControl(p)},this.panelCreate=function(panelId,options,actionController){return options=$.extend({},options),ctrlFactory.createPanel(actionController||this.controller,panelId,options)},this.panelResize=function(context){context=context||{};var self=this;setTimeout(function(){self.forEachPanel(function(where,panel){if(context.deviceChanged===!0){self.panelToggle(where,panel,"close");return}self.panelToggle(where,panel,"resize"),panel.onResize&&panel.onResize(context)})})},this.forEachPanel=function(cb){if(this.checkDestroyed())return;var controller=this.controller;["right","left"].forEach(function(w){var p=controller.getPageControl(w);p&&cb(w,p)})}};exports.Klass=_PanelManager}),define("syracuse-tablet/html/js/pages/helpers/pageControlsManager",["require","exports","module","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/pages/helpers/helpers"],function(require,exports,module){var jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),pageHelpers=require("syracuse-tablet/html/js/pages/helpers/helpers"),PageControlsManager=function(page){this.page=page,this.map={},this.statics={},this.add=function(id,ctrl){if(!ctrl)return;return this.map[id]&&console.log("Page Control "+id+" already exists"),this.map[id]=ctrl,pageHelpers.insidePageControls.indexOf(id)>=0&&(this.statics[id]=ctrl),ctrl},this.get=function(id){return this.map[id]},this.remove=function(ctrl){if(!ctrl)return;var ctrlType=null;for(var id in this.map)if(this.map[id]===ctrl){ctrlType=id;break}return ctrlType&&(delete this.map[ctrlType],delete this.statics[ctrlType]),ctrl.detach?ctrl.detach():ctrl.$$elmt&&ctrl.$$elmt.detach(),ctrl},this.destroyControls=function(){if(!this.map)return;var c;for(var id in this.map)c=this.map[id],c&&!jsutils.isInstanceOf(c,"SidePanel")&&c.destroy();this.map={},this.statics={}},this.status=function(){var x=[];for(var id in this.map)x.push(id+"="+this.map[id].id);return x.join("/")},this.destroy=function(){this.page=null,this.destroyControls()},this.buildHtml=function(dao,buildOptions){for(var id in this.statics){var $$parent=this.page.$$elmt.children(id);$$parent.length<1&&($$parent=this.page.$$elmt.children(".s-m-"+id)),this.statics[id].buildHtml($$parent,dao,buildOptions)}},this.afterRender=function(buildOpts){for(var id in this.statics)this.statics[id].afterRender&&this.statics[id].afterRender(buildOpts)},this.forAllCtrls=function(cb){for(var id in this.map)cb(id,this.map[id])},this.closeSidePanel=function(){},this.doAfterPageReload=function(addToControlMap){var c;for(var id in this.map){var c=this.map[id];addToControlMap&&this.page.addControl(c),c.refresh&&c.refresh()}}};exports.Klass=PageControlsManager}),define("syracuse-tablet/html/js/pages/page",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/uiSettings","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/controller","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/ui/rect","syracuse-tablet/html/js/controls/ctrlFactory","syracuse-tablet/html/js/helpers/scroller/scrollerHelpers","syracuse-tablet/html/js/application/settings","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/native/native","syracuse-tablet/html/js/sdata/sdataCommonResources","syracuse-tablet/html/js/helpers/native/native","syracuse-tablet/html/js/pages/helpers/helpers","syracuse-tablet/html/js/pages/helpers/panelsManager","syracuse-tablet/html/js/pages/helpers/pageControlsManager","syracuse-tablet/html/js/helpers/dashboardWelcomeUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),locale=require("syracuse-tablet/html/js/helpers/locale"),uiSettings=require("syracuse-tablet/html/js/helpers/uiSettings"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/helpers/controller").Klass,log=require("syracuse-tablet/html/js/helpers/logger").getLogger("page"),uiutils=require("syracuse-tablet/html/js/ui/uiUtils"),uiRect=require("syracuse-tablet/html/js/ui/rect"),ctrlFactory=require("syracuse-tablet/html/js/controls/ctrlFactory"),scroller=require("syracuse-tablet/html/js/helpers/scroller/scrollerHelpers"),settings=require("syracuse-tablet/html/js/application/settings"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),native=require("syracuse-tablet/html/js/helpers/native/native"),sdataCommonResources=require("syracuse-tablet/html/js/sdata/sdataCommonResources"),nativeExtLink=require("syracuse-tablet/html/js/helpers/native/native").getModule("extLink"),pageHelpers=require("syracuse-tablet/html/js/pages/helpers/helpers"),PanelManager=require("syracuse-tablet/html/js/pages/helpers/panelsManager").Klass,PageControlsMgr=require("syracuse-tablet/html/js/pages/helpers/pageControlsManager").Klass,dashboardWelcomeUtils=require("syracuse-tablet/html/js/helpers/dashboardWelcomeUtils"),_templates={fullpage:'		<section class="s-m-page s-m-full {{type}} {{subtype}}" id="{{pageid}}" {{#if parentId}}data-parent-id="{{parentId}}"{{/if}}> 			<header></header> 			<section class="s-m-breadcrumbs" style="display:none"></section> 			<section class="s-m-topToolbar"  style="display:none"></section> 			<section class="s-m-main-content"></section> 			<footer style="display:none"></footer> 		</section> 	',vignette:'<section class= "s-m-page s-m-nested {{type}} {{subtype}}" id="{{pageid}}"></section>',panels:'		<div class="s-m-side-panel-dismiss" data-action="toggleSidePanel" data-params="close,all"></div> 		<aside class="s-m-panel s-m-left"></aside> 		<aside class="s-m-panel s-m-right"></aside>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl(ctx||{})},_defOpts={header:!0,footer:!0,breadcrumbs:!1,topToolbar:!1},_Page=utils.defineClass(function Page($$parent,state,prototype,article,options){Base.call(this,state.uuid,prototype,article,$.extend({},_defOpts,options)),this._pageControls=null,this._panelsManager=null,this._$$parent=$$parent,this.state=state,this.state.options=state.options||{},this.ctrlAfterRenderCalls=[],this.ctrlSaveCtxCalls=[],this._offline=!1,this.isVignette=state.options.vignette===!0,this.isChild=state.options.parentId!=null,this.nativeCapabilities=pageHelpers.getNativeCapabilities(this),this.nonNativeCapabilities=pageHelpers.getNonNativeCapabilities(this),this.isChild&&(this.state.cached=!0),this._initRootElmt($$parent),this.isNew=!1,this.lastSelectedRow=null,this.nbCharts=0,this._panelSharedSettings=null,notifications.subscribe(this,["sm.select.row","sm.updt.card.article","sm.updt.chart.detail.article","sm.scroller.update"],1)},Base,{resetMaps:function(){Base.prototype.resetMaps.call(this),this.ctrlAfterRenderCalls=[],this.ctrlSaveCtxCalls=[]},_initRootElmt:function($$parent){var self=this,type=self.state.type,root,ctx={pageid:self.id,type:type,subtype:self.state.subtype,parentId:self.getParentId()};if(self.isVignette){self.$$contentElmt=self.$$elmt=$(_getHtml("vignette",ctx));if(self.state.options.parentVignette==null)throw new Error("Unexpected null dparent vignette");self.state.options.parentVignette.destroyed||(self._panelsManager=self.state.options.parentVignette.controller._panelsManager)}else{self.$$elmt=$(_getHtml("fullpage",ctx)),self.$$contentElmt=self.$$elmt.children("section.s-m-main-content"),self._pageControls=new PageControlsMgr(self);var shift=0;pageHelpers.topPageControls.forEach(function(id){self.options[id]===!0&&(shift+=uiSettings.getProp(id+".height"))}),shift>0&&self.$$contentElmt.css({top:shift}),self.$$elmt.append($(_getHtml("panels"))),self._panelsManager=new PanelManager(self)}self.scrollAllowed()?(self.$$scrollWrapper=$('<div class="s-m-scroll-wrapper"/>').appendTo(self.$$contentElmt),self.$$scrollWrapper.css({height:"auto"}),self.$$ctrlsRootElmt=self.$$scrollWrapper,self._gestureMgr=scroller.newScroller(self.$$scrollWrapper,{isPageScroller:!self.isVignette})):self.$$ctrlsRootElmt=self.$$contentElmt,self.$$elmt.hide(),self.$$elmt.appendTo($$parent),self.$$elmt.smPageController(self)},destroy:function(){if(this.destroyed)return;Base.prototype.destroy.call(this),this._$$parent=null,this._pageControls&&(this._pageControls.destroy(),this._pageControls=null),this._panelsManager&&(this.isVignette||this._panelsManager.destroy(),this._panelsManager=null),this._waiting&&(uiutils.waitWheelDestroy(this._waiting),this._waiting=null),this.ctrlAfterRenderCalls=null,this.ctrlSaveCtxCalls=null,this._gestureMgr&&(this._gestureMgr.destroy(),this._gestureMgr=null),this.$$elmt&&(this.$$elmt.smPageRemoveController(this),this.$$elmt.unbind(),this.$$elmt.remove(),this.$$elmt=null),this._panelSharedSettings&&(notifications.unsubscribe(this,"sm.page.share"),this._panelSharedSettings.destroy(),this._panelSharedSettings=null)},destroySiblings:function(){if(this.$$elmt){log&&log("Page destroySiblings","destroySiblings");var next=this.$$elmt.siblings(function(idx){var ctrl=$(this).smPageController();ctrl&&ctrl.destroy()})}},_actPageShare:function(){this._panelSharedSettings||(notifications.subscribe(this,"sm.page.share"),this._panelSharedSettings=this.panelCreate(globals.PANELPAGESHARE)),this.panelAttach("right",this._panelSharedSettings,"toggle")},getPageShareContext:function(){var settings={opt:this.nativeCapabilities,ctx:{pageTitle:this.state.$title},vignettes:[]};return this.vignettes&&this.vignettes.forEach(function(vignette){var page=vignette.getPage();page&&page.showPageShare()&&settings.vignettes.push({id:vignette.id,opt:page.nativeCapabilities,ctx:{pageTitle:page.state.$title||vignette.parent.title}})}),settings},getType:function(){return this.state.type},getProp:function(prop){return utils.getPropByPath(this.state,prop)},getPageControl:function(typeControl){return this._pageControls?this._pageControls.get(typeControl):!1},openLinkInVignette:function(){return this.state.options.openLinkInVignette===!0},load:function(loadOptions){var self=this;loadOptions=loadOptions||{};var timeLine=utils.getTimeLine("page",self.state.name);return timeLine&&timeLine.start(),$.smResolve().then(function(){return self.initOnLoad()}).then(function(){return self.buildHtmlOption(loadOptions)}).then(function(opts){return self.buildOpts=opts,self.loadStructure(loadOptions)}).then(function(){timeLine&&timeLine.step("loadStructure");if(self.destroyed)return;return self.loadData(loadOptions)}).then(function(){timeLine&&timeLine.step("loadData");if(self.destroyed)return;return self.render(loadOptions,self.buildOpts)}).then(function(){timeLine&&timeLine.step("render");if(self.destroyed)return;return self.afterRender(loadOptions,self.buildOpts)}).then(function(){timeLine&&timeLine.stop()})},loadStructure:function(loadOptions){var self=this;return $.smResolve().then(function(){if(!self.article||!self.prototype)throw new Error("loadStructure - NULL article or prototype");if(self._pageControls&&loadOptions.skipPageControls!==!0){var top=0;pageHelpers.insidePageControls.forEach(function(id){if(self.options[id]===!0){var ctrl=self.createPageControl(id);ctrl&&(self["_page"+id.smCapitalize()]=self._pageControls.add(id,ctrl),pageHelpers.topPageControls.indexOf(id)>=0&&(self["_$$"+id]=self.$$elmt.children("section.s-m-"+id).show().css("top",top),top+=uiSettings.getProp(id+".height")))}})}var opts={notifyFocus:self.isVignette&&self.isEditMode()};self.buildControlsTree(opts)})},createPageControl:function(id){return ctrlFactory.createPageControl(id,this)},loadData:function(loadOptions){var self=this;return $.smResolve().then(function(){self.setDao(null)})},render:function(loadOptions,buildOpts){var self=this;return $.smResolve().then(function(){if(!self.rootLayout)throw new Error("buildHtml - NULL rootLayout");self._pageControls&&loadOptions.skipPageControls!==!0&&self._pageControls.buildHtml(self.dao,buildOpts),self.$$ctrlsRootElmt&&(self.beforeAddContent(),Base.prototype.render.call(self,self.$$ctrlsRootElmt,buildOpts))})},initOnLoad:function(){return $.smResolve()},buildHtmlOption:function(loadOptions){var self=this,resultOpts={authoringUpdate:loadOptions.authoringUpdate===!0,updateLayout:loadOptions.updateLayout===!0,makeFullHeight:self.isVignette,toolBars:{showAuthoring:self.state.disableAuthoring!==!0,showUserMenuLinks:!self.isChild,showHome:!self.isChild&&!this.state.isWelcomePage,showActions:!0,showNativeShare:self.nativeCapabilities.share,showPageShare:self.showPageShare(),showPageMailto:this.nonNativeCapabilities.mailto===!0,showDrafts:!0,showDevelopment:globals.isDesktop()&&globals.isDvlpMode()}};return dashboardWelcomeUtils.isPinnedPage(self.getPinPageId()).then(function(isPinned){resultOpts.toolBars.statusPinPage=self.isChild?0:isPinned}).then(function(){self.isChild&&(self.$facet==="lookup"?resultOpts.showAuthoring=resultOpts.showAuthoring&&!0:resultOpts.showAuthoring=!1)}).then(function(){return resultOpts})},authUpdateLayout:function(article,options){return this.article=article,options=options||{},options.authoringUpdate=!0,this.reload(options)},refresh:function(options,callBackInterface){var self=this;return self.isActive()?this.reload():$.smResolve().then(function(){var deferred=$.Deferred();return self.activate(null,function(){return deferred.resolve()}),deferred.promise()}).then(function(){return self.reload()})},reload:function(options){var self=this;self.waitWheelStart(),self.resetMaps(),self.rootLayout.destroy();var updatePageControls=(self.article.$allowDownload!=null||self.article.$pageActionSettings!=null)&&self._pageControls!=null;return updatePageControls&&self._pageControls.destroyControls(),self.$$ctrlsRootElmt.empty(),options=options||{},options.updateLayout==null&&(options.updateLayout=!0),options.reload=!0,options.skipPageControls=updatePageControls===!1,self.load(options).then(function(){self._pageControls&&self._pageControls.doAfterPageReload(options.skipPageControls),uiutils.triggerResizeInternal(options)}).then(function(){self.waitWheelStop()}).fail(function(e){self.waitWheelStop(),globals.getModal().error("Error",e)})},onMainPageResize:function(info,orientation,deviceType){var self=this;if(self.destroyed)return;if(!this.isVignette){if(this._prevPageInfo==null||info.orientationChanged||info.deviceChanged)this._prevPageInfo&&this.$$elmt.removeClass(this._prevPageInfo.deviceType+" "+this._prevPageInfo.orientation),this.$$elmt.addClass(deviceType+" "+orientation),info.deviceChanged&&(this.toggleHeaderFooter("header",null,!0),this.toggleHeaderFooter("footer",null,!0)),this._prevPageInfo={deviceType:deviceType,orientation:orientation};var top=0,left=0,contentHeight=info.application.height,contentWidth=info.application.width;if(self._pageControls){info.contentWidth=contentWidth,info.contentHeight=contentHeight,self._pageControls.forAllCtrls(function(id,ctrl){ctrl.onMainPageResize&&ctrl.onMainPageResize(info,orientation,deviceType)});var ctrl;pageHelpers.insidePageControls.forEach(function(id){ctrl=self.getPageControl(id);if(ctrl&&ctrl.isVisible()){var ch=ctrl.getHeight();contentHeight-=ch;if(pageHelpers.topPageControls.indexOf(id)>=0){var $$root=self["_$$"+id];$$root&&($$root.css({top:top}),top+=ch)}}})}self.$$contentElmt.css({top:top+"px",left:left+"px",width:contentWidth+"px",height:contentHeight+"px"})}self._mainContentRect=uiRect.elmtRect(self.$$contentElmt,"computed"),self._mainContentRect.moveLeft(parseInt(self.$$contentElmt.css("padding-left"),10)),self.onResize(info),self._initScroll(info&&info.preserveScroll)},getMainContentRect:function(){return this._mainContentRect},onResize:function(context){this.sizeModified!=1&&(this._resizeContext&&context?this.sizeModified=this._resizeContext.contentHeight!=context.contentHeight||this._resizeContext.contentWidth!=context.contentWidth:this.sizeModified=!1),this._resizeContext=$.extend({},context),this.rootLayout&&this.rootLayout.onResize&&this.rootLayout.onResize(context),!this.isVignette&&this._panelsManager&&this._panelsManager.panelResize(context)},afterRender:function(loadOptions,buildOpts){var self=this;return $.smResolve().then(function(){self.ctrlAfterRenderCalls.forEach(function(c){c.afterRender(buildOpts)}),self._pageControls&&loadOptions.skipPageControls!==!0&&self._pageControls.afterRender(buildOpts)})},beforeAddContent:function(){},addTitle:function(title,description){var html="";title&&(html='<header class="s-m-page-title">'+title+"</header>"),description&&(html+="<p>"+description+"<p>"),html.length>0&&$(html).prependTo(this.$$ctrlsRootElmt)},addControl:function(c){Base.prototype.addControl.call(this,c),c.isPageControl()||(c.afterRender&&this.ctrlAfterRenderCalls.push(c),c.savedCtxCreate&&c.savedCtxRestore&&this.ctrlSaveCtxCalls.push(c)),c.$type==="application/x-array"&&jsutils.isInstanceOf(c,"CtrlArrayChart")&&c.isHighChart()&&this.nbCharts++},removeControl:function(c){if(!c)return;return Base.prototype.removeControl.call(this,c),this._pageControls&&c.isPageControl()&&this._pageControls.remove(c),c},activate:function(pageToClose,cb){var self=this;self._show(pageToClose,function(){self.getSavedContext()?self.savedCtxRestore(self.getSavedContext()):self.lastSelectedRow&&self._hilightLastSelectedRow(self.lastSelectedRow),cb&&cb()})},activated:function(){},deactivate:function(cb){this._hide(cb)},savedCtxCreate:function(type){var self=this;type=type||"back";var ctx={type:type,pageName:this.state.name};self.lastSelectedRow&&(ctx.lastSelectedRow=self.lastSelectedRow),type!=="link"&&self._gestureMgr&&(ctx.scroll=self._gestureMgr.savedCtxCreate(type));if(self.ctrlSaveCtxCalls&&self.ctrlSaveCtxCalls.length>0){var ctxCtrls={};self.ctrlSaveCtxCalls.forEach(function(c){var ctrlCtx=c.savedCtxCreate(type);ctrlCtx&&(ctxCtrls[c.$bind]=ctrlCtx)}),$.isEmptyObject(ctxCtrls)||(ctx.ctxCtrls=ctxCtrls)}return ctx},savedCtxRestore:function(ctx){var self=this;if(!ctx)return;if(ctx.pageName!=this.state.name)return;self._gestureMgr&&ctx.scroll&&self._gestureMgr.savedCtxRestore(ctx.scroll,!0);if(ctx.ctxCtrls)for(var bind in ctx.ctxCtrls){var c=self.getControlByBind(bind),ctrlCtx=self.getCtrlSavedContext(bind);c&&c.savedCtxRestore&&ctrlCtx&&c.savedCtxRestore(ctrlCtx)}},getSavedContext:function(propName){var ctx=this.state.savedContext;return!propName||!ctx?ctx:ctx[propName]},updateSavedContext:function(clear){this.state.savedContext=clear?null:this.savedCtxCreate()},getCtrlSavedContext:function(bind){var ctx=this.getSavedContext("ctxCtrls");return ctx&&bind?ctx[bind]:null},_hilightLastSelectedRow:function(lastSelectedRow,old){var self=this,toggle=function(rowInfo,show){var c=self.getControlByBind(rowInfo.array$Bind);c&&c.selectLastSelectedRow&&c.selectLastSelectedRow(rowInfo.rowId,show)};return old&&toggle(old,!1),lastSelectedRow?(toggle(lastSelectedRow,!0),!0):!1},_show:function(currentPage,cb){var self=this,transition=self.getProp("transition");if(currentPage){currentPage._hide(function(){self.$$elmt.show(transition||0,function(){cb&&cb()})});return}self.$$elmt.show(transition==null?0:transition,cb)},_hide:function(cb){if(!this.$$elmt){cb&&cb();return}this._pageControls&&this._pageControls.closeSidePanel("all");var transition=this.getProp("transition");this.$$elmt.hide(transition==null?0:transition,cb)},isActive:function(){return this.$$elmt&&this.$$elmt.is(":visible")},isLookup:function(){return this.prototype&&this.prototype.isLookup()},isAppHomePage:function(){return this.state.name===globals.getApplication().homePageId},getParentNotif:function(){throw new Error("not implemented")},getParentId:function(){return this.isChild?this.state.options.parentId:null},getOpenLinkAttrs:function(){return{"data-nav":this.state.name}},_actTest:function(params){var e=$('<h5 style="color:red">Action test succeeded</h5>').prependTo(this.$$elmt);window.setTimeout(function(){e.remove()},2e3)},_actHome:function(){globals.getApplication().gotoWelcomeApplication()},waitWheelStart:function(controlId){if(controlId){var c=this.getControl(controlId);c&&c.waitWheelStart&&c.waitWheelStart();return}if(this.getParentVignette()){this.getParentVignette().waitWheelStart();return}this._waiting||(this._waiting=uiutils.waitWheelCreate(this.$$elmt)),uiutils.waitWheelStart(this._waiting)},waitWheelStop:function(controlId){if(controlId){var c=this.getControl(controlId);c&&c.waitWheelStop&&c.waitWheelStop();return}if(this.getParentVignette()){this.getParentVignette().waitWheelStop();return}this._waiting&&uiutils.waitWheelStop(this._waiting)},notifSelectRow:function(arrayId,rowId,rowdata){var c=this.getControl(arrayId);if(!c)return;var old=this.lastSelectedRow;this.lastSelectedRow={array$Bind:c.$bind,rowId:rowId},this._hilightLastSelectedRow(this.lastSelectedRow,old)},checkBack:function(){return!0},goBack:function(){return this.isVignette?this.getParentVignette().goBack():globals.getApplication().goBack()},initVignetteScroll:function(back){if(!this._gestureMgr)return;var viewRect=this.getParentVignette().getScrollViewRect(),keepOldScrolling=back===!0;this._gestureMgr.init(viewRect,"v",0,keepOldScrolling)},_initScroll:function(preserveScroll){if(!this._gestureMgr)return;if(this.scrollAllowed()){var viewRect=this.isVignette?this.getParentVignette().getScrollViewRect():this._mainContentRect;if(viewRect&&viewRect.height<this.$$scrollWrapper.height()){var valMax=0;preserveScroll=preserveScroll===!0||this.isNew!==!0,this._gestureMgr.init(viewRect,"v",valMax,preserveScroll);var autoScroll=this.state.options["auto-scroll"];autoScroll!=null&&(this.autoScroll(autoScroll),this.state.options["auto-scroll"]=undefined)}else this._gestureMgr.reset()}else this._gestureMgr.reset()},notifScrollerUpdate:function(force){if(!this._gestureMgr)return;if(force!==!0&&this._gestureMgr.viewRect&&this._mainContentRect.equals(this._gestureMgr.viewRect,!0))return;this._initScroll(!0)},autoScroll:function(value){this._gestureMgr&&this._gestureMgr.autoScroll(value)},scrollAllowed:function(){return!this.isVignette&&!this.isDashboard("hub")},isDashboard:function(typeDashboard){return!1},isNestedInDashboard:function(typeDashboard){return this.isVignette?this.getParentVignette()?this.getParentVignette().controller.isDashboard(typeDashboard):!1:!1},getScrollOffset:function(){return globals.getApplication().getScrollOffset()},getScrollValue:function(){return this._gestureMgr?this._gestureMgr.getScroll():0},getParentVignette:function(){return this.state.options.parentVignette},getVignettePageDashboard:function(){return!this.isVignette||!this.getParentVignette()?globals.getApplication().currentPage:this.getParentVignette().controller},getParentDashboardType:function(){return!this.isVignette||!this.getParentVignette()?null:jsutils.isInstanceOf(this.getParentVignette().parent,"LayoutTile")?"hub":"stack"},getGestureMgr:function(){return this._gestureMgr},makeVisible:function(c){if(!c||!this.getGestureMgr()||!c.$$elmt)return;this.getGestureMgr().makeVisible(c.$$elmt)},panelAttach:function(where,panel,action){return this._panelsManager?this._panelsManager.panelAttach(where,panel,action):null},panelDetach:function(where){return this._panelsManager?this._panelsManager.panelDetach(where):null},panelCreate:function(panelId,options){var actionController=this;return this._panelsManager?this._panelsManager.panelCreate(panelId,options,actionController):null},_actToggleSidePanel:function(action,side){if(!this._panelsManager)return;var self=this,side=side==null||side==="all"?["left","right"]:[side];side.forEach(function(where){self._panelsManager.panelToggle(where,null,action)})},externalLink:function(param){nativeExtLink?nativeExtLink.openExternalLink(param):window.open(param)},_actExternalLink:function(param){var Url="";for(var i=0,l=arguments.length;i<l;i++)typeof arguments[i]=="string"&&(Url=Url?Url+",":"",Url+=arguments[i]);this.externalLink(Url)},getPinPageId:function(){},getPinPageData:function(){return{name:this.state.name,title:this.prototype.data("$title")||locale.text("no.title"),id:this.getPinPageId(),icon:"star",applicationName:this.state.applicationName,voiceCommandContext:this.getRestoreContext("pinPage")}},getRestoreContext:function(reason){var self=this,ctx={endpoint:globals.getEndpoint(),applicationName:self.state.applicationName,role:globals.getUserRole(),currentState:{type:self.state.type,name:self.state.name,savedContext:self.savedCtxCreate("link"),options:{}}};return self.state.options&&["dataParams"].forEach(function(p){var val=self.state.options[p];val!=null&&(ctx.currentState.options[p]=val)}),ctx},getTileLinkContext:function(){var self=this;return sdataCommonResources.createSharedContext(this.getRestoreContext("sharedLink")).then(function(uuid){return{Title:self.state.$title,DeepLink:{Title:self.state.$title,Url:jsutils.getOpenLinkUrl(uuid)}}}).fail(function(){return null})},getAuthoring:function(path,defValue){var val=utils.getPropByPath(this.article,path);return val!=null?val:defValue},notifUpdtCardArticle:function(notifData,controlId){var array=this.getControl(controlId);if(!array||!notifData)return;array.setCardAuthoring(notifData.article)},notifUpdtChartDetailArticle:function(notifData,controlId){var chart=this.getControl(controlId);if(!chart||!notifData)return;chart.setChartDetailAuthoring(notifData.article,notifData.level)},getLinkedPageArticle:function(ctrlId){if(!ctrlId)return;var ctrl=utils.findControl($("#"+ctrlId,this.$$elmt));if(!ctrl||!ctrl.getLinkedPageArticle)return;return ctrl.getLinkedPageArticle()},getToolbarLinks:function(){return null},getProtoLinks:function(){return null},getMultiSelectionLinks:function(){return null},actionGetSettings:function(actName,prop){var $actionsSettings=this.getAuthoring("$pageActionSettings");if(!$actionsSettings)return null;var res;return $actionsSettings.some(function(setting){return setting.name===actName?(res=setting,!0):!1}),res==null?null:prop==null?res:res[prop]},isMultiSelectionEnabled:function(){return this.getAuthoring("$allowDownload")===!0||this.getMultiSelectionLinks()!=null},hasFooterHeaderActions:function(){return!1},toggleHeaderFooter:function(typeControl,newControl,show){if(this.destroyed)return null;var originalControl=this["_page"+typeControl.smCapitalize()];if(originalControl==null)return null;var currentControl=this.getPageControl(typeControl);newControl==null&&(newControl=originalControl,show=undefined);if(show===!0&&newControl===currentControl)return currentControl;if(show===!1&&newControl!==currentControl)return currentControl;currentControl&&(this.removeControl(currentControl),newControl===currentControl&&show===!1&&(newControl=originalControl)),this._pageControls.add(typeControl,newControl),this.addControl(newControl);var $$root=this.$$elmt.children(typeControl);return newControl.$$elmt?($$root.append(newControl.$$elmt),newControl.$$elmt.find("a").css("display","inline-block")):newControl.buildHtml($$root,this.dao),newControl.notifToggled(!0),currentControl},showPageShare:function(){return this.nativeCapabilities?this.nativeCapabilities.liveTile||this.nativeCapabilities.scheduleMsg||this.nativeCapabilities.share:!1},setOffLine:function(yes,notify){this._offline=yes===!0},isOffLine:function(){return this._offline===!0},notifPageShare:function(action,data){var result;switch(action){case"link":result=this._sharePageLink();break;case"liveTile":result=this._shareAddLiveTile(data);break;case"schedule":result=this._shareScheduleMessage(data)}result&&result.fail(function(error){window.smNativeLogger&&window.smNativeLogger.log("notifPageShare Error",error.message,error.stack),globals.getModal().notify({severityClass:"error",body:error.message})})},_sharePageLink:function(){return this.getTileLinkContext().then(function(ctx){native.getModule("share").sharePageLink({pageData:ctx})})},_shareAddLiveTile:function(data){var liveTileModule=native.getModule("liveTile");if(!data||!liveTileModule)return $.smResolve();var options={},self=this;return self.getTileLinkContext().then(function(ctx){var page=data.vignette?self.getControl(data.vignette).getPage():self,pageData=page.getPinPageData();return options=$.extend(!0,{},pageData,ctx,data),options.applicationName=self.state.applicationName,options.endpoint=pageData.endpoint||globals.getEndpoint(),liveTileModule.addLiveTile(options)}).then(function(result){if(result&&result.error)throw new Error(result.error.text);globals.getModal().notify({severityClass:"success",title:"",body:locale.text("liveTile.page.add.ok"),onlyWebapp:!1})})},_shareScheduleMessage:function(data){var scheduleMessageModule=native.getModule("scheduleMessage");if(!data||!scheduleMessageModule)return;return this.getTileLinkContext().then(function(ctx){if(!ctx)return;data.DeepLink=ctx.DeepLink,scheduleMessageModule.scheduledMsg(data)})},isSamePage:function(state){return!this.destroyed&&this.isActive()&&state&&state.name===this.state.name},_actPageMailto:function(){var self=this;sdataCommonResources.createSharedContext(this.getRestoreContext("sharedLink")).then(function(uuid){var email=["mailto:?subject="];email.push(encodeURIComponent(self.state.$title||"")),email.push("&body="),email.push(encodeURIComponent(jsutils.getOpenLinkUrl(uuid)));var win=window.open(email.join(""));win&&setTimeout(function(){win.close()},100)}).fail(function(){return null})}});exports.Page=_Page}),define("syracuse-tablet/html/js/ui/modals/modalMultiButtons",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/modals/modalDialog"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),_templateAll={header:'		{{#if title}}<div class="modal-title">{{title}}</div>{{/if}}',content:'		<div class="s-m-modal-content">			<p>{{{message}}}</p>		</div>',footer:'	{{#each buttons}}		<button type="button" {{#if isHidden}}style="display:none"{{/if}} class="btn btn-default {{#if smallBtns}}btn-sm{{/if}}{{#if isDisabled}}disabled{{/if}}" data-action="{{action}}">{{label}}</button>	{{/each}}'},_Klass=utils.defineClass(function ModalMultiButtons(title,message,opts){modalDialog.ModalBase.call(this),this._dataContext=$.extend({title:title,message:modalDialog.checkMsg(message||"")},opts),this.selectedAction=opts.defaultAction||null;var sl=globals.getSiteLayout();this._dataContext.buttons.forEach(function(b){b.smallBtns=sl.getDeviceType()==="smartphone"&&sl.getPageOrientation()==="portrait"})},modalDialog.ModalBase,{_getTemplates:function(){return{std:_templateAll}},getDisplayFlags:function(){var res=this.displayFlags||{};return res.modalClass="multibuttons "+this.deviceType,res},_getDataContext:function(){return this._dataContext},_onAction:function(action,param){return this.selectedAction=action,!0},_getResult:function(){return this.selectedAction},_checkButtonSize:function(){var sl=globals.getSiteLayout();this.$$elmt.find("button").toggleClass("btn-sm",sl.getDeviceType()==="smartphone"&&sl.getPageOrientation()==="portrait")},notifMainLayoutChanged:function(info,orientation,deviceType){this._checkButtonSize()}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/pages/pageDashboard",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/pages/page","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/ui/modals/modal","syracuse-tablet/html/js/ui/modals/modalMultiButtons","syracuse-tablet/html/js/helpers/mobileDetect"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/pages/page").Page,locale=require("syracuse-tablet/html/js/helpers/locale"),globals=require("syracuse-tablet/html/js/helpers/globals"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),modalMultiButtons=require("syracuse-tablet/html/js/ui/modals/modalMultiButtons"),mobileDetect=require("syracuse-tablet/html/js/helpers/mobileDetect"),_Page=utils.defineClass(function DashboardPage($parent,state,prototype,article,options){options.breadcrumbs==null&&(options.breadcrumbs=!0),Base.call(this,$parent,state,prototype,article,options),this.vignettes=[],this._vignettesLoaderStates=[],this.views=options.views;var app=globals.getApplication();app.dao.isSageApplication()&&this.state.dashboardName===app.dao.getHomeDashboardName()&&this.$$contentElmt.addClass(app.dao.getAppBackGroundClass()),this._nbCharts=0,this._editModeVignettes=null},Base,{destroy:function(){if(this.destroyed)return;Base.prototype.destroy.call(this),this._editModeVignettes=null,this.vignettes=null,this._vignettesLoaderStates=null},loadData:function(loadOptions){return null},reload:function(options){return this.vignettes=[],Base.prototype.reload.call(this,options)},beforeAddContent:function(){},addControl:function(c){Base.prototype.addControl.call(this,c),c&&c.isVignette&&c.isVignette()&&this.vignettes.push(c)},afterRender:function(loadOptions,buildOpts){var self=this;return Base.prototype.afterRender.call(self,loadOptions,buildOpts).then(function(){if(self.vignettes==null||self.vignettes.length==0)return;var vignetteNum=0,dashName=self.prototype.data("$dashboardName"),join=$.Deferred();return loadOptions.forceSynchroVignettes=globals.isAuthoringActive()||loadOptions.forceSynchroVignettes||globals.isAutoUITestMode(),setTimeout(function(){if(self.destroyed||!self.vignettes)return;self.vignettes.forEach(function(v){vignetteNum++;var vignetteId=dashName+"#"+vignetteNum,restoredState=self.state.options.vignettesPageStates&&self.state.options.vignettesPageStates[vignetteId],pageOptions=restoredState||{};pageOptions.sdataParameters=self.state.options&&self.state.options.sdataParameters||{};var vLoadOptions={updateLayout:loadOptions.updateLayout===!0};v.load(vignetteId,pageOptions,vLoadOptions).then(function(page,error){return self._checkVignetteLoadError(error),vignetteNum===self.vignettes.length&&join.resolve(),page&&page.nbCharts!=null&&(self.nbCharts+=page.nbCharts),page&&page.isEditMode&&page.isEditMode()&&(self._editModeVignettes||(self._editModeVignettes=[]),self._editModeVignettes.push(page)),page})})}),loadOptions.forceSynchroVignettes===!0?join.promise():$.smResolve()})},_checkVignetteLoadError:function(error){var self=this;if(!self.vignettes||!self._vignettesLoaderStates)return;self._vignettesLoaderStates.push({error:error});if(self._vignettesLoaderStates.length===this.vignettes.length){var goLogin=!1,e;self._vignettesLoaderStates.some(function(s){if(s.error&&s.error.$redirectPage==="login")return e=s.error,!0}),self._vignettesLoaderStates=[],e&&modal.error(locale.text("error.page.loading"),e,function(){globals.getApplication().gotoLogin(locale.text("login.timeout.message"))})}},onMainPageResize:function(info,orientation,deviceType){Base.prototype.onMainPageResize.call(this,info,orientation,deviceType),this._chartsCounter=0,this.vignettes.forEach(function(v){v.onMainPageResize(info,orientation,deviceType)})},countChartLoaded:function(chart){if(this._chartsCounter==null||!globals.getCurrentPage().isDashboard("hub")||!mobileDetect.checkBrowserName("chrome"))return;this._chartsCounter++,this._chartsCounter===this.nbCharts&&(this._$$fakeLink||(this._$$fakeLink=$('<link rel="stylesheet" type="text/css">')),this._$$fakeLink.appendTo($("head")).detach(),this._chartsCounter=null)},authUpdateLayout:function(article,vignetteToUpdt){return this.article=article,vignetteToUpdt?vignetteToUpdt.reloadPage({updateLayout:!0,authoringUpdate:!0}):(this.vignettes=[],Base.prototype.authUpdateLayout.call(this,article))},savedCtxCreate:function(type){var ctx=Base.prototype.savedCtxCreate.call(this,type);ctx.vignettes=[];var p;this.vignettes&&this.vignettes.forEach(function(v){p=v.getPage(),ctx.vignettes.push(p?p.savedCtxCreate(type):null)});if(this.isDashboard("hub")&&this.rootLayout){var hubCtx=this.rootLayout.savedCtxCreate(type);hubCtx&&(ctx.hubCtx=this.rootLayout.savedCtxCreate(type))}return ctx},savedCtxRestore:function(ctx){Base.prototype.savedCtxRestore.call(this,ctx),this._savedVignetteContext=ctx.vignettes,ctx.hubCtx&&this.isDashboard("hub")&&this.rootLayout.savedCtxRestore(ctx.hubCtx)},getSavedCtxVignette:function(v){if(v==null||this._savedVignetteContext==null)return null;var idx=this.vignettes.indexOf(v);return idx==-1||idx>this._savedVignetteContext.length-1?null:this._savedVignetteContext[idx]},getPinPageId:function(){var self=this,parameters=JSON.stringify(self.state.options.sdataParameters);return self.state.dashboardName+(parameters?"_"+parameters:"")},_sdataParam2String:function(){var self=this,params;return self.state.options.sdataParameters&&Object.keys(self.state.options.sdataParameters).forEach(function(key){var opt=key+"="+self.state.options.sdataParameters[key];params?params+="&"+opt:params=opt}),params},getPinPageData:function(){var pageData=Base.prototype.getPinPageData.call(this);pageData.dashboardName=this.state.dashboardName,pageData.$type=this.state.options&&this.isAppHomePage()===!0?"$application":"$dashboard";var sdParam=this._sdataParam2String();return sdParam!=null&&sdParam.trim().length>0&&(pageData.sdataParameters=sdParam),pageData.endpoint=globals.getEndpoint(),pageData},getRestoreContext:function(reason){var ctx=Base.prototype.getRestoreContext.call(this,reason);$.isEmptyObject(this.state.options.sdataParameters)||(ctx.currentState.options.sdataParameters=this.state.options.sdataParameters);if(!this.vignettes)return;ctx.currentState.options.vignettesPageStates||(ctx.currentState.options.vignettesPageStates={});var vStates=ctx.currentState.options.vignettesPageStates;return this.vignettes.forEach(function(v){var p=v.getPage();if(p){var state=p.getRestoreContext(reason);if(!state.currentState||!state.currentState.options)return;vStates[v.vignetteId]=state.currentState.options}}),ctx},isDashboard:function(typeDashboard){return typeDashboard&&this.article?this.article.$layoutType===typeDashboard:!0},getGestureMgr:function(){return this.isDashboard("hub")&&this.rootLayout?this.rootLayout.getGestureMgr():Base.prototype.getGestureMgr.call(this)},getScrollOffset:function(){var offset=globals.getApplication().getScrollOffset();if(this.isDashboard("hub")&&this.getGestureMgr()){var o=this.getGestureMgr().getOffset();return offset.top+=o.top,offset.left+=o.left,o}return offset},checkBack:function(){if(!this._editModeVignettes||this._editModeVignettes.length==0)return Base.prototype.checkBack.call(this);if(this._editModeVignettes.length===1)return this._editModeVignettes[0].checkBack();var isDirty=this._editModeVignettes.some(function(page){return page&&page.dao&&page.dao.isDirty});return isDirty?this.askDiscardChanges():!0},askDiscardChanges:function(){var opts={buttons:[],defaultAction:"no"};return["no","yes"].forEach(function(act){opts.buttons.push({action:act,label:locale.text(act)})}),(new modalMultiButtons.Modal(locale.text("dashboard.discardchanges.title"),locale.text("dashboard.discardchanges.info"),opts)).show().then(function(result){return result==="yes"})},scrollAllowed:function(){return!this.isDashboard("hub")}});exports.Page=_Page}),define("syracuse-tablet/html/js/ui/modals/modalConfigTile",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalDialog","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/authoring/authoringProperties"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),authoringProperties=require("syracuse-tablet/html/js/authoring/authoringProperties"),_templateAll={header:'		<buttons class="pull-right"> 			<button type="button" class="btn btn-default s-m-modal-btn-validate" data-action="$validate"></button> 			<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 		</buttons> 		<div class="modal-title">{{title}}</div> 			',content:' 			<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">				<div class="form-group s-m-scroll-element"> 					<label>{{lab_title}}</label> 					<div>{{tileTitle}}</div>					<label>{{lab_color}}</label> 					<div class="s-m-list-colors">						{{#each colors}} 							<a draggable="false" href="#" {{#if active}}class="active"{{/if}} data-action="clickColor" data-params="{{value}}">								<div class="s-m-bg s-m-color-{{value}}"> 								</div> 							</a>						{{/each}} 					</div> 					<label>{{lab_size}}</label> 					<div class="s-m-list-sizes">						{{#each sizes}} 							<a draggable="false" href="#" {{#if active}}class="active"{{/if}} data-action="clickSize" data-params="{{value}}">{{label}}</a>						{{/each}} 					</div> 					<label>{{lab_icon}}</label> 					<div class="s-m-list-icons">						{{#each icons}} 							<a draggable="false" href="#" {{#if active}}class="active"{{/if}} data-action="clickIcon" data-params="{{value}}"> 								<i class="{{label}}"/> 							</a>						{{/each}} 					</div> 					<div style="width:100%; display: inline-block;"></div> 				</div> 			</div>',footer:""},_Klass=utils.defineClass(function ModalConfigTile(tile){var self=this;modalDialog.ModalBase.call(self),self.tile=tile,self.result=null},modalDialog.ModalBase,{_getTemplates:function(){var self=this;return{std:_templateAll}},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="config-tile half_right":displayFlags.modalClass="config-tile full",displayFlags},_getDataContext:function(){var self=this;authoringProperties.initProperties();var properties=authoringProperties.getAllProperties(),data={label_validate:locale.text("welcome.tile.cfg.ok"),label_cancel:locale.text("welcome.tile.cfg.cancel"),title:locale.text("welcome.tile.cfg.title"),lab_title:locale.text("welcome.tile.cfg.lab_title"),lab_color:locale.text("welcome.tile.cfg.lab_color"),lab_size:locale.text("welcome.tile.cfg.lab_size"),lab_icon:locale.text("welcome.tile.cfg.lab_icon")};return data.colors=properties.tileColor.values.map(function(e){return{active:self.tile.color===e.value,value:e.value,label:e.label}}),data.sizes=properties.tileSize.values.map(function(e){return{active:self.tile.size===e.value,value:e.value,label:e.label}}),data.icons=fontUtils.getTileIconList().map(function(e){var cls=fontUtils.getIconByName(e);return{active:self.tile.icon===e,value:e,label:cls}}),data.tileTitle=self.tile.title,data},_onValidate:function(){var self=this,$$selected=self.$$elmt.find("a.active"),i,tile=$.extend(!0,{},self.tile);for(i=0;i<$$selected.length;i++){var action=$($$selected[i]).attr("data-action"),param=$($$selected[i]).attr("data-params");switch(action){case"clickColor":tile.color=param;break;case"clickSize":tile.size=param;break;case"clickIcon":tile.icon=param}}self.result=tile},_onCancel:function(){var self=this;self.result=null},_onAction:function(action,param){var self=this;switch(action){case"clickColor":case"clickSize":case"clickIcon":var $$old=self.$$elmt.find('a.active[data-action="'+action+'"]'),$$new=self.$$elmt.find('a[data-action="'+action+'"][data-params="'+param+'"]');$$old.removeClass("active"),$$new.addClass("active")}return!1},_getResult:function(){var self=this;return self.result}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/ui/dragManager",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/ui/uiUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),defaultOptions={drag:{options:{containment:".s-m-main-content",disabled:!1,helper:"clone",opacity:1}},drop:{options:{tolerance:"pointer",hoverClass:"s-m-hover-droptarget"}}},_Klass=utils.defineClass(function DragManager(dragOpts,dropOpt,$$parent){this._notif=new Notifier,this._dropUI=new DropUI,this._init(dragOpts,dropOpt,$$parent),this.params,this.dragEnable=dragOpts.enable,notifications.subscribe(this,["sm.drag.state.change"])},null,{notifDragStateChange:function(enable){this.dragEnable=enable},destroy:function(){this._notif=null,$(this.dropOpts.selector).droppable("destroy"),$(this.dragOpts.selector).draggable("destroy"),this._dropUI.destroy()},_init:function(dragOpts,dropOpts,$$parent){var self=this;self.dropOpts=$.extend(!0,defaultOptions.drop,dropOpts),self.dragOpts=$.extend(!0,defaultOptions.drag,dragOpts),self._notif.register(self.dragOpts.notify),self._notif.register(self.dropOpts.notify),$(self.dropOpts.selector).droppable($.extend(!0,self.dropOpts.options,{drop:function(event,ui){self._notif.publish("drop",$(this),ui,self.params)},out:function(event,ui){self._notif.publish("out",$(this),ui)},over:function(event,ui){self._notif.publish("over",$(this),ui)}})),$(self.dragOpts.selector).draggable($.extend(!0,self.dragOpts.options,{create:function(event,ui){self._notif.publish("create",$(this),ui)},start:function(event,ui){ui.helper.css("z-index",2e3),ui.helper.addClass("s-m-dragElement"),self._notif.publish("start",$(this),ui)},drag:function(event,ui){if(!self.dragEnable)return!1;event.stopPropagation()},stop:function(event,ui){self.dragEnable=self.dragOpts.enable,self._notif.publish("stop",$(this),ui)},isOnDrag:function(){return self.dragEnable}}))},showIndicator:function(opts,params){this.params=params,this._dropUI.show(opts)},hideIndicator:function(){this._dropUI.hide()},getNotifs:function(){return this._notif.get()}}),DropUI=utils.defineClass(function DropUI(dragOpts,dropOpt,$$parent){this._elmt={}},null,{destroy:function(){this._elmt&&$(this._elmt).remove(),this._elmt=null},show:function(opts){this.hide(),this._elmt=uiUtils.createDomElement("div",["s-m-ui-drop"],null,null,opts.$$parent),opts&&opts.left&&(this._elmt.style.left=opts.left),opts&&opts.top&&(this._elmt.style.top=opts.top),opts&&opts.width&&(this._elmt.style.width=opts.width),opts&&opts.height&&(this._elmt.style.height=opts.height)},hide:function(){this.destroy()}}),Notifier=utils.defineClass(function Notifier(dragOpts,dropOpt,$$parent){this._notifs={}},null,{register:function(notifs){var self=this;if(!notifs)return;Object.keys(notifs).forEach(function(key){self._notifs[key]=notifs[key]})},get:function(event){var self=this;if(event)return self._notifs[event];var notif=[];return Object.keys(self._notifs).forEach(function(key){notif.push(self._notifs[key])}),notif},publish:function(event,$$elt1,$$elt2,params){var self=this;if(!event||!self.get(event))return;notifications.publish(self.get(event),$$elt1,$$elt2,params)}});exports.DragManager=_Klass}),define("syracuse-tablet/html/js/ui/modals/modalChooseDashboardGroup",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalDialog"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),_templateAll={header:'			<buttons class="pull-right"> 				<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 			</buttons> 			<div class="modal-title">{{title}}</div> 			',content:' 			<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">				<div class="form-group s-m-scroll-element"> 					<div class="list-group">						{{#each groups}} 							<a draggable="false" href="#" class="list-group-item" data-action="clickGroup" data-params="{{id}}">								<h4 class="list-group-item-heading">{{title}}</h4>							</a>						{{/each}} 					</div> 				</div> 			</div>',footer:""},_Klass=utils.defineClass(function ModalChooseDashboardGroup(groups){var self=this;modalDialog.ModalBase.call(self),groups=groups||[],self.groups=[],groups.forEach(function(group){self.groups.push({title:group.title,id:group.id})}),self.selectedGroup={}},modalDialog.ModalBase,{_getTemplates:function(){var self=this;return{std:_templateAll}},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="half_right":displayFlags.modalClass="full",displayFlags},_getDataContext:function(){var self=this;return{title:locale.text("welcome.move.tile.title"),groups:self.groups}},_onCancel:function(){var self=this;self.selectedgroup=null},_onAction:function(action,param){var self=this;return action==="clickGroup"&&(self.selectedgroup=param),!0},_getResult:function(){var self=this;return self.selectedgroup}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/pages/customizedDashboard",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/pages/pageDashboard","syracuse-tablet/html/js/ui/modals/modalConfigTile","syracuse-tablet/html/js/controls/ctrlFactory","syracuse-tablet/html/js/ui/dragManager","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/ui/modals/modalChooseDashboardGroup","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/ui/uiUtils"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),Base=require("syracuse-tablet/html/js/pages/pageDashboard").Page,modalConfigTile=require("syracuse-tablet/html/js/ui/modals/modalConfigTile"),ctrlFactory=require("syracuse-tablet/html/js/controls/ctrlFactory"),dragManager=require("syracuse-tablet/html/js/ui/dragManager").DragManager,notifications=require("syracuse-tablet/html/js/helpers/notifications"),modalChooseDashboardGroup=require("syracuse-tablet/html/js/ui/modals/modalChooseDashboardGroup"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),uiutils=require("syracuse-tablet/html/js/ui/uiUtils"),_initConfigPage=!1,_scroll=0,_Page=utils.defineClass(function CustomizedDashboard($parent,state,prototype,article,options){Base.call(this,$parent,state,prototype,article,options)},Base,{destroy:function(){this.destroyConfigHeaderFooter(),$(".s-m-hub-group > header > input.title").off("change"),Base.prototype.destroy.call(this)},afterRender:function(loadOptions,buildOpts){var self=this;return loadOptions.forceSynchroVignettes=!0,Base.prototype.afterRender.call(self,loadOptions,buildOpts).then(function(){_initConfigPage&&self._toggleConfigPage("enable"),_initConfigPage=!1})},_actPageConfig:function(){var self=this;this._afterChangePage()},_actCancelPageConfig:function(){var self=this;this._afterChangePage()},_actPublishPageConfig:function(){},_actRemoveTile:function(vignetteId){},_actRemoveGroup:function(id){},_titleChange:function(event,opt){var self=this,uuid=this._setLocalization(opt.title.val(),opt.title.attr("data-old-uuid")).then(function(uuid){var titleContent=uuid?"{@"+uuid+"}":opt.title.val();self._changeHubGroupTitle(opt.layout,titleContent)})},_changeHubGroupTitle:function(layout,titleContent){var self=this;return globals.getMetaData().getDashboard(self.prototype.getDataByPath("$dashboardName")).then(function(dashboard){var idx=$.inArray(layout.article,self.article.$items);return idx>=0&&(self.article.$items[idx].$title=titleContent,dashboard.$article=self.article,self.dirty=!0,notifications.publish(["sm.dashboard.state.change"],self._getHeaderFooterOptions())),dashboard})},_actChangeGroupTile:function(vignetteId){var self=this,tileToMove=self._getTileInfo(vignetteId),layoutGroupOriginId=tileToMove.ctrl.parent.parent.id,groups=[];self.rootLayout.children.forEach(function(group){group.id!==layoutGroupOriginId&&groups.push({title:group.getTitle(),id:group.id})});var modal=new modalChooseDashboardGroup.Modal(groups);modal.show().then(function(result){if(result){var groupSelected=result.id,opts={dragId:vignetteId,dropId:result,where:"append"};self._moveTile(opts)}})},_afterChangePage:function(opts){opts=opts||{},this._toggleConfigPage(opts.forceStatus),_initConfigPage=opts.forceStatus!="disabled";var gesture=this.getGestureMgr();_scroll=opts.scroll=="end"?99999:opts.keepScrollValue?_scroll:this.getGestureMgr().getScroll()},_initScroll:function(preserveScroll){var self=this;Base.prototype._initScroll.call(self,preserveScroll);var gesture=this.getGestureMgr();_scroll===99999&&(_scroll=gesture.getScrollMin()-30*(gesture.isNative()?1:-1)),self.getGestureMgr().autoScroll(_scroll)},_actConfigTile:function(vignetteId){var self=this,ti=self._getTileInfo(vignetteId),classes=ti.$$tile.attr("class"),size="medium",cls=classes.split(" "),validSizes=["small","medium","wide","large","full","all"];cls&&cls.some(function(c){return validSizes.indexOf(c)>-1?(size=c,!0):!1});var color=/s-m-color-(\w+)/.exec(classes);color=color&&color.length>1&&color[1]||"darkgrey";var tile={title:ti.title||ti.gadget.$title,color:color,size:size,icon:ti.icon||ti.gadget.icon},modal=new modalConfigTile.Modal(tile);modal.show().then(function(result){result!=null&&self._applyTileChanges(ti,result)})},_applyTileChanges:function(tileInfo,tile){},_toggleConfigPage:function(forceStatus){!this._configHeader&&forceStatus!="disabled"&&(this._configHeader=ctrlFactory.createDashboardConfigHeader(this,this._getHeaderFooterOptions())),!this._configFooter&&forceStatus!="disabled"&&(this._configFooter=ctrlFactory.createDashboardConfigFooter(this,this._getHeaderFooterOptions()));var enable=forceStatus!=null?forceStatus=="enable":!this.configActive;this.toggleHeaderFooter("header",this._configHeader,enable),this.toggleHeaderFooter("footer",this._configFooter,enable),enable===!0?this.enabledConfig():this.disableConfig()},destroyConfigHeaderFooter:function(){if(!this._configHeader&&!this.configFooter)return;this.toggleHeaderFooter("header",null),this.removeControl(this._configHeader),this._configHeader.destroy(),this._configHeader=null,this.toggleHeaderFooter("footer",null),this.removeControl(this._configFooter),this._configFooter.destroy(),this._configFooter=null},_getHeaderFooterOptions:function(){return null},_actCloseDashboardConfig:function(){this._toggleConfigPage("disable")},_dragUI:function(ev){return $(ev.currentTarget).hasClass("s-m-group-handle")?$(ev.currentTarget).parent().clone():$(ev.currentTarget).clone()},enabledConfig:function(options){var self=this;self.configActive=!0;var $$tiles=$(".s-m-tile",self.$$elmt);$$tiles.addClass("s-m-tile-edit");var $$hubGroups=$(".s-m-hub-group",self.$$elmt);for(var i=0;i<$$tiles.length;i++){var $$tile=$($$tiles[i]);$$tile.attr("data-tile-config-id",i),$$tile.attr("data-disable-navigation",!0);var $$vignette=$(".s-m-vignette",$$tile);$$tile.attr("data-empty-tile")?$$tile.append($('<btn class="cfg remove '+fontUtils.dashboardIcon("removeTile")+'" data-action="removeEmptyTile" data-params="'+$$tile.attr("data-empty-tile")+'">')):($$tile.append($('<div class="cfg insert top" data-param="top" data-vignette-id="'+$$vignette.attr("id")+'"></div>')),$$tile.append($('<div class="cfg insert bottom" data-param="bottom" data-vignette-id="'+$$vignette.attr("id")+'"></div>')),$$tile.append($('<div class="cfg insert left" data-param="left" data-vignette-id="'+$$vignette.attr("id")+'"></div>')),$$tile.append($('<div class="cfg insert right" data-param="right" data-vignette-id="'+$$vignette.attr("id")+'"></div>')),$$hubGroups.length>1&&$$tile.append($('<btn class="cfg changegroup '+fontUtils.dashboardIcon("moveTile")+'" data-action="changeGroupTile" data-params="'+$$vignette.attr("id")+'">')),$$tile.append($('<btn class="cfg config '+fontUtils.dashboardIcon("editTile")+'" data-action="configTile" data-params="'+$$vignette.attr("id")+'">')),$$tile.append($('<btn class="cfg remove '+fontUtils.dashboardIcon("removeTile")+'" data-action="removeTile" data-params="'+$$vignette.attr("id")+'">')))}$$hubGroups.each(function(){var layout=self.getLayout($(this).attr("id"));if(layout.isEditable){var $$title=$(".title",layout.$$header);$$title.removeAttr("readonly"),$$title.on("change",jsutils.bindFn(self._titleChange,self,{layout:layout,title:$$title})),layout.isDeletable&&(!layout.children||layout.children.length===0)&&layout.$$header.append($('<btn class="cfg remove '+fontUtils.dashboardIcon("removeGroup")+'" data-action="removeGroup" data-params="'+$(this).attr("id")+'">'));var active=!$(this).is(":last-child");layout.$$header.append($('<btn class="cfg move s-m-move-group '+(active?"":"disabled ")+fontUtils.dashboardIcon("moveGroupBefore")+(active?'" data-action="moveGroup" data-params="right,'+$(this).attr("id"):" ")+'">')),active=!$(this).is(":first-child"),layout.$$header.append($('<btn class="cfg move s-m-move-group '+(active?"":"disabled ")+fontUtils.dashboardIcon("moveGroupAfter")+(active?'" data-action="moveGroup" data-params="left,'+$(this).attr("id"):" ")+'">'))}}),self._dragManagerCreate(),notifications.subscribe(self,["sm.dashboard.title.change"]),notifications.subscribe(self,["sm.vignette.pressed"]),uiutils.triggerResizeInternal()},notifDashboardTitleChange:function(title){},notifVignettePressed:function(vignetteId){var tileInfo=this._getTileInfo(vignetteId);tileInfo.$$tile.toggleClass("s-m-draggable",!0),notifications.publish("sm.drag.state.change",!0)},_dragManagerDestroy:function(){this.dragManager&&(notifications.unsubscribe(this,this.dragManager.getNotifs()),this.dragManager.destroy(),this.dragManager=null)},_dragManagerCreate:function(){var self=this,dragOpts={selector:".s-m-hub-group>header>.s-m-group-handle,.s-m-tile:not([data-empty-tile])",enable:!1,notify:{start:"sm.drag.start",stop:"sm.drag.stop"},options:{opacity:.4,delay:0,scrollSensitivity:100,scrollSpeed:50,helper:self._dragUI}},dropOpts={selector:".s-m-hub-group,.insert",notify:{drop:"sm.element.drop",out:"sm.element.out",over:"sm.element.over"},options:{helper:"clone"}};self.dragManager=new dragManager(dragOpts,dropOpts,self.$$elmt),notifications.subscribe(self,self.dragManager.getNotifs())},disableConfig:function(){var self=this;self._dragManagerDestroy(),self.configActive=!1,self.$$pageConfigHeader&&(self.$$pageConfigHeader.remove(),self.$$pageConfigHeader=null),self.getPageControl("footer").show(),$(".s-m-tile-edit").removeClass("s-m-tile-edit"),$(".cfg",self.$elmt).remove(),notifications.unsubscribe(self,["sm.dashboard.title.change"])},notifDragStart:function($$dragElt,ui){$$dragElt.is(".s-m-hub-group>header>.s-m-group-handle")&&($$dragElt.closest(".s-m-hub-group").toggleClass("s-m-not-droppable",!0),ui.helper.css("width",ui.helper.css("width")),ui.helper.css("background-color","#009fda"),ui.helper.css("color","white"))},notifDragStop:function($$dragElt,ui){notifications.publish("sm.drag.state.change",!1),$$dragElt.toggleClass("s-m-draggable",!1);if($$dragElt.is(".s-m-hub-group>header>.s-m-group-handle")){$$dragElt.closest(".s-m-hub-group").toggleClass("s-m-not-droppable",!1);return}},notifElementDrop:function($$dropElt,ui,params){var $$dragElt=ui.draggable;$$dragElt.hasClass("s-m-tile")&&this._tileDrop($$dropElt,$$dragElt,params),$$dragElt.is(".s-m-hub-group > header > .s-m-group-handle")&&this._groupDrop($$dropElt,$$dragElt,params)},_tileDrop:function($$dropElt,$$dragElt,params){var optsMoveTile=this._getOptsMoveTile($$dropElt,$$dragElt,params);if(optsMoveTile.where==="append"&&!$$dropElt.hasClass("empty"))return;this._moveTile(optsMoveTile)},_groupDrop:function($$dropElt,$$dragElt,params){var $$goupTarget=$$dropElt.closest(".s-m-hub-group");if($$goupTarget.hasClass("s-m-not-droppable"))return;var layoutTarget=this._layoutsMap[$$goupTarget.attr("id")],$$goupToMove=$$dragElt.closest(".s-m-hub-group"),layoutToMove=this._layoutsMap[$$goupToMove.attr("id")];this._moveGroup(layoutTarget,layoutToMove)},_actMoveGroup:function(where,id){var layoutToMove=this._layoutsMap[id],$$goupTarget=where==="right"?layoutToMove.$$elmt.next():layoutToMove.$$elmt.prev(),layoutTarget=this._layoutsMap[$$goupTarget.attr("id")],position=layoutTarget.$$elmt.position();this._prevPageInfo.orientation==="landscape"?where==="right"?_scroll=position.left-parseInt(layoutToMove.$$elmt.width(),10)+parseInt(layoutTarget.$$elmt.width(),10)-100:_scroll=position.left-100:where==="right"?_scroll=position.top-parseInt(layoutToMove.$$elmt.height(),10)+parseInt(layoutTarget.$$elmt.height(),10)-100:_scroll=position.top-100,_scroll*=this.getGestureMgr().isNative()?1:-1,where==="right"?this._moveGroup(layoutTarget,layoutToMove):this._moveGroup(layoutToMove,layoutTarget)},_getOptsMoveTile:function($$dropElt,$$dragElt,params){var optMoveTile={dropId:$$dropElt.attr("id"),dragId:$(".s-m-vignette",$$dragElt).attr("id"),where:"append"};return $$dropElt.hasClass("insert")&&(optMoveTile.dropId=params?params.target:$$dropElt.attr("data-vignette-id"),optMoveTile.where=params?params.before?"top":"bottom":$$dropElt.attr("data-param")),optMoveTile},notifElementOut:function($$dropElt,ui){var $$dragElt=ui.draggable;if($$dragElt.is(".s-m-hub-group>header> .s-m-group-handle")){var $$group=$$dropElt.closest(".s-m-hub-group");$$group.toggleClass("s-m-over-droptarget",!1)}this.dragManager.hideIndicator()},notifElementOver:function($$dropElt,ui){var $$dragElt=ui.draggable;$$dragElt.hasClass("s-m-tile")&&this._tileOver($$dropElt,$$dragElt),$$dragElt.is(".s-m-hub-group>header > .s-m-group-handle")&&this._groupOver($$dropElt,$$dragElt)},_tileOver:function($$dropElt,$$dragElt){var optsMoveTile=this._getOptsMoveTile($$dropElt,$$dragElt),cellOrigineInfo=this._getCellInfo(optsMoveTile.dragId),targetInfo=optsMoveTile.where==="append"&&$$dropElt.hasClass("empty")?this._getGroupInfo(optsMoveTile.dropId,$$dropElt):this._getCellInfo(optsMoveTile.dropId),where=this._tileWhere(optsMoveTile,cellOrigineInfo,targetInfo);if(where&&where.parent){var opts={top:where.top,left:where.left,height:where.height,width:where.width,$$parent:where.parent};this.dragManager.showIndicator(opts,{before:where.before,target:where.idTileTarget||where.idTarget})}else this.dragManager.hideIndicator()},_groupOver:function($$dropElt,$$dragElt){var $$group=$$dropElt.closest(".s-m-hub-group");if($$group.hasClass("s-m-not-droppable"))return;$$group.toggleClass("s-m-over-droptarget",!0);var $$header=$("header:first",$$group);if($$header.length>0){var opts={$$parent:$$group};this.dragManager.showIndicator(opts,{before:!1,target:""})}else this.dragManager.hideIndicator()},_tileWhere:function(optsMoveTile,cellOrigineInfo,targetInfo){if(optsMoveTile.where==="append")return{top:parseInt($("header",targetInfo.targetElmt).css("height"),10)+"px",left:"0px",width:cellOrigineInfo.$$tile.css("width"),height:"10px",idTarget:targetInfo.id,before:!1,parent:targetInfo.targetElmt};var layoutGroup=targetInfo.tileCtrl.parent.parent,before=optsMoveTile.where==="top"||optsMoveTile.where==="left",where;switch(cellOrigineInfo.tileSize){case"small":targetInfo.tileSize==="small"||targetInfo.tileSize==="medium"?where={top:"0px",left:before?"-5px":parseInt(targetInfo.$$tile.css("width"),10)-5+"px",width:"10px",height:cellOrigineInfo.$$tile.css("height"),parent:targetInfo.$$tile}:where={top:before?"-5px":layoutGroup.cells[targetInfo.cellIndex].h-5+"px",left:"0px",width:cellOrigineInfo.$$tile.css("width"),height:"10px",parent:targetInfo.cellDomItem};break;case"medium":targetInfo.tileSize==="small"||targetInfo.tileSize==="medium"?where={top:"0px",left:before?"-5px":layoutGroup.cells[targetInfo.cellIndex].w-5+"px",width:"10px",height:cellOrigineInfo.$$tile.css("height"),parent:targetInfo.cellDomItem}:where={top:before?"-5px":layoutGroup.cells[targetInfo.cellIndex].h-5+"px",left:"0px",width:cellOrigineInfo.$$tile.css("width"),height:"10px",parent:targetInfo.cellDomItem};break;case"wide":case"large":case"full":where={top:before?"-5px":layoutGroup.cells[targetInfo.cellIndex].h-5+"px",left:"0px",width:cellOrigineInfo.$$tile.css("width"),height:"10px",parent:targetInfo.cellColumn%2?layoutGroup.cells[targetInfo.cellIndex-1].domItem:targetInfo.cellDomItem};break;case"all ":}if(where){var layoutTile=targetInfo.cellChildren[before?0:targetInfo.cellChildren.length-1];where.idTileTarget=layoutTile.children[0].id,where.before=before}return where},_getCellInfo:function(tileId){var tileInfos=this._getTileInfo(tileId);if(!tileInfos)return{};var layoutGroup=tileInfos.ctrl.parent.parent,$$dhtmlCell=tileInfos.ctrl.$$elmt.parent().parent(),index=$$dhtmlCell.attr("data-cellIndex"),cells=layoutGroup.cells;return{tileSize:tileInfos.size,tileCtrl:tileInfos.ctrl,$$tile:tileInfos.$$tile,cellIndex:index,cellDomItem:cells[index].domItem,cellColumn:cells[index].abs,cellChildren:cells[index].children}},_getTileInfo:function(vignetteId){var ctrl=this.getControl(vignetteId);if(!ctrl)return;var $$vignette=$("#"+vignetteId),$$tile=$$vignette.closest(".s-m-tile");return{$$tile:$$tile,$$vignette:$$vignette,$$remove:$(".s-m-tile btn.remove",$$tile),ctrl:ctrl,gadget:ctrl.prototype.data("$gadget"),size:ctrl.parent.article.$size,title:ctrl.article&&ctrl.article.$title?ctrl.article.$title:null,icon:ctrl.article&&ctrl.article.$icon?ctrl.article.$icon:null}},_getGroupInfo:function(groupId,$$elmt){return{id:groupId,targetElmt:$$elmt}},isSamePage:function(state){return!1}});exports.Page=_Page}),define("syracuse-tablet/html/js/ui/modals/modalChooseApps",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalDialog"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),_templateAll={header:'			<buttons class="pull-right"> 				<button type="button" class="btn btn-default s-m-modal-btn-validate" data-action="$validate"></button> 				<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 			</buttons> 			<div class="modal-title">{{title}}</div> 			',content:' 			<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">				<div class="form-group s-m-scroll-element"> 					<div class="list-group">						{{#each appList}} 							<a draggable="false" href="#" class="list-group-item" data-action="clickApp" data-params="{{uuid}}">								<h4 class="list-group-item-heading">{{title}}</h4>								<p class="list-group-item-text">{{description}}</p>							</a>						{{/each}} 					</div> 				</div> 			</div>',footer:""},_Klass=utils.defineClass(function ModalChooseApps(appList){var self=this;modalDialog.ModalBase.call(self),self.appList=[],appList.forEach(function(a){self.appList.push(a)}),self.selectedApps={}},modalDialog.ModalBase,{_getTemplates:function(){var self=this;return{std:_templateAll}},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="half_right":displayFlags.modalClass="full",displayFlags},_getDataContext:function(){var self=this;return{label_validate:locale.text("welcome.select.app.add"),label_cancel:locale.text("welcome.select.app.cancel"),title:locale.text("welcome.select.app.title"),appList:self.appList}},_onValidate:function(){},_onCancel:function(){var self=this;self.selectedApps={}},_onAction:function(action,param){var self=this;if(action==="clickApp"){var $$app=self.$$elmt.find('[data-params="'+param+'"]');self.selectedApps[param]?($$app.removeClass("active"),delete self.selectedApps[param]):($$app.addClass("active"),self.selectedApps[param]=!0)}return!1},_getResult:function(){var self=this;return Object.keys(self.selectedApps)}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/ui/modals/modalChooseWelcomeDashboard",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalDialog"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),_templateAll={header:'			<buttons class="pull-right"> 				<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 			</buttons> 			<div class="modal-title">{{title}}</div> 			',content:' 			<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">				<div class="form-group s-m-scroll-element"> 					<div class="list-group">						{{#each views}} 							<a draggable="false" href="#" class="list-group-item  {{selected}}" data-action="clickView" data-params="{{uuid}}">								<h4 class="list-group-item-heading">{{description}}</h4>								<p class="list-group-item-text">{{factoryOwner}}</p>							</a>						{{/each}} 					</div> 				</div> 			</div>',footer:'{{#if createLabel}}			<button type="button" class="btn btn-default" data-action="createTemplate"> {{createLabel}}</button>			{{/if}}'},_Klass=utils.defineClass(function ModalChooseWelcomeDashboard(opts){var self=this;modalDialog.ModalBase.call(self),self.views=[],self.title=opts.title,self.result=null,opts.showCreateTemplate&&(self.createLabel=locale.text("dashboard.welcome.create.template")),opts.views.forEach(function(view){self.views.push({description:view.$description,personal:view.$isPersonal,selected:view.$selected?"active":"",uuid:view.$uuid,factoryOwner:view.$factoryOwner})})},modalDialog.ModalBase,{_getTemplates:function(){var self=this;return{std:_templateAll}},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="half_right":displayFlags.modalClass="full",displayFlags},_getDataContext:function(){var self=this;return{title:self.title,views:self.views,createLabel:self.createLabel}},_onCancel:function(){var self=this;self.result=null},_onAction:function(action,param){var self=this;return action==="clickView"&&(self.result={selectedView:param}),action==="createTemplate"&&(self.result={selectedView:null}),!0},_getResult:function(){var self=this;return self.result}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/ui/modals/modalChooseRoles",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalDialog"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),_templateAll={header:'			<buttons class="pull-right"> 				<button type="button" class="btn btn-default s-m-modal-btn-validate" data-action="$validate"></button> 				<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 			</buttons> 			<div class="modal-title">{{title}}</div> 			',content:' 			<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">				<div class="form-group s-m-scroll-element"> 					<div class="list-group">						{{#each roleList}} 							<a draggable="false" href="#" class="list-group-item {{selected}}" data-action="clickRole" data-params="{{uuid}}">								<h4 class="list-group-item-heading">{{code}}</h4>								<p class="list-group-item-text">{{description}}</p>							</a>						{{/each}} 					</div> 				</div> 			</div>',footer:""},_Klass=utils.defineClass(function ModalChoosRoles(roleList){var self=this;modalDialog.ModalBase.call(self),self.roleList=[],self.rolesSelected={},roleList.forEach(function(role){self.roleList.push({code:role.$code,description:role.$description,uuid:role.$uuid,selected:role.$selected}),role.$selected&&(self.rolesSelected[role.$uuid]=!0)}),self.selectedRoles=$.extend(!0,{},self.rolesSelected)},modalDialog.ModalBase,{_getTemplates:function(){var self=this;return{std:_templateAll}},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="half_right":displayFlags.modalClass="full",displayFlags},_getDataContext:function(){var self=this;return{title:locale.text("welcome.select.roles.title"),roleList:self.roleList}},_onValidate:function(){},_onCancel:function(){var self=this;self.selectedRoles=$.extend(!0,{},self.rolesSelected)},_onAction:function(action,param){var self=this;if(action==="clickRole"){var $$app=self.$$elmt.find('[data-params="'+param+'"]');self.selectedRoles[param]?($$app.removeClass("active"),delete self.selectedRoles[param]):($$app.addClass("active"),self.selectedRoles[param]=!0)}return!1},_getResult:function(){var self=this,change=self._compare(self.selectedRoles,self.rolesSelected);return{change:change,selectedRoles:Object.keys(self.selectedRoles)}},_compare:function(roles1,roles2){roles1=roles1||{},roles2=roles2||{};for(var prop in roles1)if(!roles2[prop])return!0;for(var prop in roles2)if(!roles1[prop])return!0;return!1}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/pages/pageWelcomeDashboard",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/pages/customizedDashboard","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalChooseApps","syracuse-tablet/html/js/helpers/dashboardWelcomeUtils","syracuse-tablet/html/js/helpers/dashboardUtils","syracuse-tablet/html/js/ui/modals/modalChooseWelcomeDashboard","syracuse-tablet/html/js/ui/modals/modalChooseRoles","syracuse-tablet/html/js/ui/modals/modal","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/pages/customizedDashboard").Page,locale=require("syracuse-tablet/html/js/helpers/locale"),modalChooseApps=require("syracuse-tablet/html/js/ui/modals/modalChooseApps"),dashboardWelcomeUtils=require("syracuse-tablet/html/js/helpers/dashboardWelcomeUtils"),dashboardUtils=require("syracuse-tablet/html/js/helpers/dashboardUtils"),modalChooseWelcomeDashboard=require("syracuse-tablet/html/js/ui/modals/modalChooseWelcomeDashboard"),modalChooseRoles=require("syracuse-tablet/html/js/ui/modals/modalChooseRoles"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_initConfigPage=!1,_Page=utils.defineClass(function WelcomeDashboardPage($parent,state,prototype,article,options){options=options||{},this.roles=options.roles,this.dirty=!1,options.breadcrumbs=!1,Base.call(this,$parent,state,prototype,article,options),this.vignettes=[]},Base,{destroy:function(){Base.prototype.destroy.call(this),notifications.unsubscribe(this,["sm.dashboard.create.template"]),notifications.unsubscribe(this,["sm.dashboard.delete.template"]),notifications.unsubscribe(this,["sm.dashboard.select.template"])},beforeAddContent:function(){this.$$elmt.addClass("s-m-page-welcome-background")},buildHtmlOption:function(loadOptions){var self=this;return Base.prototype.buildHtmlOption.call(self,loadOptions).then(function(opts){var saveOpts=self._getOptionsSave();return $.extend(!0,{},opts,{makeFullHeight:!1,showAddTiles:self._isHiddenTiles()&&loadOptions.updateLayout,toolBars:{showAuthoring:!1,showUserMenuLinks:!0,showHome:!1,showPageConfig:!0,showDashboardList:saveOpts.publish||saveOpts.savePublished,showMyDashboard:!saveOpts.personal&&saveOpts.userFactoryOwner!="",title:saveOpts.title,showDrafts:!0,statusPinPage:0}})})},_getHeaderFooterOptions:function(){var opts=this._getOptionsSave(),optList=this._optDashboardList();return opts.hiddenTiles=this._isHiddenTiles(),opts.views=optList.views,opts.roles=$.extend(!0,[],this.roles),opts.dirty=this.dirty,opts.currentView=this.views.filter(function(view){return view.$selected}),opts},_isHiddenTiles:function(){var unbindTiles=dashboardUtils.getUnbindGadgets(this.article,this.prototype);return unbindTiles.length>0},afterRender:function(loadOptions,buildOpts){var self=this;return loadOptions.forceSynchroVignettes=!0,Base.prototype.afterRender.call(self,loadOptions,buildOpts)},_afterChangePage:function(opts){var self=this;Base.prototype._afterChangePage.call(this,opts),self.reload(),notifications.publish(["sm.dashboard.state.change"],this._getHeaderFooterOptions())},enabledConfig:function(){Base.prototype.enabledConfig.call(this,{addHiddenTileLabel:locale.text("page.configure.add.app")})},_actRemoveTile:function(vignetteId){var self=this,tile=self._getTileInfo(vignetteId),layoutGroup=tile.ctrl.parent.parent,step,groupType=tile.ctrl.parent.parent.article.$groupType;tile.gadget.$type==="$application"&&!tile.gadget.pinPageId?step=globals.getMetaData().getDashboard(self.prototype.getDataByPath("$dashboardName")).then(function(dashboard){var idx=$.inArray(tile.ctrl.parent.article,layoutGroup.article.$items);return idx>=0&&layoutGroup.article.$items.splice(idx,1),dashboard.$article=self.article,dashboard}):step=dashboardWelcomeUtils.removePinnedPage(tile.gadget.pinPageId,groupType),step.then(function(dashboard){return self._updateWelcomeDashboard(dashboard,{dirty:!0})}).then(function(dashboard){return dashboardUtils.getDashboardInfo(dashboard)}).then(function(dashboardInfo){self.article=dashboardInfo.article,self.prototype=dashboardInfo.prototype,self._afterChangePage()})},_actRemoveEmptyTile:function($bind){var self=this,article=dashboardWelcomeUtils.removeTileByBind(this.article,$bind);self._updateWelcomeDashboardArticle(article,{dirty:!0}).then(function(){self._afterChangePage()})},_changeHubGroupTitle:function(layout,titleContent){var self=this;Base.prototype._changeHubGroupTitle.call(self,layout,titleContent).then(function(dashboard){self._updateWelcomeDashboard(dashboard,{dirty:!0})})},_applyTileChanges:function(tileInfo,tile){var self=this,article=tileInfo.ctrl.parent.article;article.$bgColor=tile.color||"darkgrey",article.$size=tile.size||"medium";var articleVignette=tileInfo.ctrl.article;articleVignette.$icon=tile.icon||articleVignette.$icon,globals.getMetaData().getDashboard(self.prototype.getDataByPath("$dashboardName")).then(function(dashboard){return dashboard.$article=self.article,dashboard}).then(function(dashboard){return self._updateWelcomeDashboard(dashboard,{dirty:!0})}).then(function(){self._afterChangePage()})},_moveTile:function(opts){var self=this,layoutGroupTarget,idxTarget,tileTarget,items,tileToMove=self._getTileInfo(opts.dragId),layoutGroupOrigin=tileToMove.ctrl.parent.parent,idxOrigin=$.inArray(tileToMove.ctrl.parent.article,layoutGroupOrigin.article.$items);if(!(idxOrigin>=0))return;items=layoutGroupOrigin.article.$items.splice(idxOrigin,1),opts.where==="append"?(layoutGroupTarget=self.getLayout(opts.dropId),idxTarget=layoutGroupTarget.article.$items.length):(tileTarget=self._getTileInfo(opts.dropId),layoutGroupTarget=tileTarget.ctrl.parent.parent,idxTarget=$.inArray(tileTarget.ctrl.parent.article,layoutGroupTarget.article.$items)),idxTarget>=0&&((opts.where==="bottom"||opts.where==="right"&&idxTarget<layoutGroupTarget.article.$items.length)&&idxTarget++,layoutGroupTarget.article.$items.splice(idxTarget,0,items[0])),globals.getMetaData().getDashboard(self.prototype.getDataByPath("$dashboardName")).then(function(dashboard){return dashboard.$article=self.article,dashboard}).then(function(dashboard){globals.getMetaData().updateWelcomeDashboard(dashboard).then(function(){self.dirty=!0,self._afterChangePage()})})},_moveGroup:function(layoutTarget,layoutToMove){var self=this,idxOrigin=$.inArray(layoutToMove.article,self.article.$items);if(!(idxOrigin>=0))return;var items=self.article.$items.splice(idxOrigin,1),idxTarget=$.inArray(layoutTarget.article,self.article.$items);idxTarget>=0&&self.article.$items.splice(idxTarget+1,0,items[0]),self._updateWelcomeDashboardArticle(self.article,{dirty:!0}).then(function(){self._afterChangePage({keepScrollValue:!0})})},_actAddGroup:function(){var self=this;self._addArticleGroup().then(function(){self._afterChangePage({scroll:"end"})})},_addArticleGroup:function(){var self=this,options=self._getOptionsSave(),uuid=options.personal?null:utils.UUID(),text=locale.text("welcome.newgroup"),titleContent=uuid?"{@"+uuid+"}":text;return self.article.$items.push(dashboardWelcomeUtils.hubGroup(dashboardWelcomeUtils.groupType("default"),titleContent)),self._setLocalization(text,uuid).then(function(){return self._updateWelcomeDashboardArticle(self.article,{dirty:!0})})},_actRemoveGroup:function(id){var self=this,layout=self.getLayout(id),idx=$.inArray(layout.article,self.article.$items);if(idx>=0){self.article.$items.splice(idx,1);var uuid=layout.getArticleTextUUID("$title");utils.removeLocalization(self.article.$localization,uuid)}self._updateWelcomeDashboardArticle(self.article,{dirty:!0}).then(function(){self._afterChangePage()})},_actAddHiddenTile:function(hubGroupId){var self=this,hiddenList=dashboardUtils.getUnbindGadgets(self.article,self.prototype),modal=new modalChooseApps.Modal(hiddenList);modal.show().then(function(result){result&&result.length>0&&$.smForEachPromise(result,function(uuid){var tile={$layoutType:"tile",$bgColor:"darkgrey",$items:[{$bind:uuid}],$size:"medium"};return self._appendTileToGroup(tile,hubGroupId),$.smResolve()}).then(function(){return self._updateWelcomeDashboardArticle(self.article,{dirty:!0})}).then(function(){self._afterChangePage()})})},_actRoleList:function(){var self=this,opts=[];dashboardWelcomeUtils.getRoles(self.roles).then(function(roles){var modal=new modalChooseRoles.Modal(roles),change=!1;return modal.show().then(function(result){if(result&&result.change){change=result.change;var roles=[];return result.selectedRoles.forEach(function(uuid){roles.push({$uuid:uuid})}),roles}return null}).then(function(roles){roles&&globals.getMetaData().getDashboard(self.prototype.getDataByPath("$dashboardName")).then(function(dashboard){return dashboard.roles=roles,self.roles=roles,dashboard}).then(function(dashboard){return self._updateWelcomeDashboard(dashboard,{dirty:!0})}).then(function(dashboard){notifications.publish(["sm.dashboard.state.change"],self._getHeaderFooterOptions()),notifications.publish(["sm.dashboard.roles.change"],dashboard.roles)})})})},_actTemplateList:function(){var self=this,currentTitle=self.views.filter(function(view){return view.$selected})[0].$description,opts=this._optDashboardList(),modal=new modalChooseWelcomeDashboard.Modal(opts);modal.show().then(function(result){result&&dashboardWelcomeUtils.getWelcomeDashboard(!0,result.selectedView).then(function(dashboard){dashboard.description=currentTitle;var opts=self._getOptionsSave();opts.personal&&dashboardWelcomeUtils.unLocalizeHubGroups(dashboard.$article),self._changeCurrentDashboard(dashboard,{dirty:!0})})})},_changeCurrentDashboard:function(dashboard,opts){var self=this;self._updateWelcomeDashboard(dashboard,{dirty:opts.dirty}).then(function(dashboard){return self.article=dashboard.$article,dashboardUtils.getDashboardInfo(dashboard)}).then(function(dashboardInfo){self.prototype=dashboardInfo.prototype,self._afterChangePage(opts)})},_actDashboardList:function(){var self=this;this._dashboardTemplates||(this._dashboardTemplates=this.panelCreate(globals.PANELDASHBOARDTEMPLATES,this._optDashboardList(!0)),notifications.subscribe(self,["sm.dashboard.create.template"]),notifications.subscribe(self,["sm.dashboard.delete.template"]),notifications.subscribe(self,["sm.dashboard.select.template"])),this.panelAttach("right",this._dashboardTemplates,"toggle")},_actMyDashboard:function(){var self=this,personalView=self.views.filter(function(view){return view.$isPersonal}),uuid=personalView.length>0&&personalView[0].$uuid;uuid&&dashboardWelcomeUtils.getWelcomeDashboard(!0,uuid).then(function(dashboard){self._updateWelcomeDashboard(dashboard,{dirty:self.dirty}).then(function(){globals.getApplication().gotoWelcomeApplication()})})},notifDashboardCreateTemplate:function(){var self=this;dashboardWelcomeUtils.emptyDashboard().then(function(dashboard){return dashboard.description=locale.text("welcome.newtemplate"),dashboard.roles=[],self._updateWelcomeDashboard(dashboard,{dirty:!0})}).then(function(dashboard){return self.article=dashboard.$article,self.roles=[],self.views.forEach(function(view){view.$selected=!1}),self.views.push({$description:dashboard.description,$factoryOwner:globals.getSecurityProfile().factoryId,$isPersonal:!1,$selected:!0}),dashboardUtils.getDashboardInfo(dashboard)}).then(function(dashboardInfo){return self.prototype=dashboardInfo.prototype,self._addArticleGroup()}).then(function(){self._afterChangePage()})},notifDashboardDeleteTemplate:function(uuid){var self=this;uuid&&dashboardWelcomeUtils.deleteCommonWelcomeDashboard(uuid).then(function(data){var diags=data.$diagnoses;diags&&diags.length>0&&diags.forEach(function(diag){var notify={severityClass:globals.X3_SEVERITY_TO_BS[diag.$severity]||diag.$severity||"error",title:diag.$message};globals.getModal().notify(notify)});var currentView=self.views.filter(function(view){return view.$selected}),changeCurrentView=uuid===currentView[0].$uuid;if(changeCurrentView){var dashboard=dashboardWelcomeUtils.setMetaWelcomeDashboard(data.$resources);self._changeCurrentDashboard(dashboard,{dirty:!1,forceStatus:"disabled"}),currentView=[]}self.views=data.$resources.$views,self.views.forEach(function(view){view.$selected=!1,view.$selected=currentView[0]&&currentView[0].$uuid?view.$uuid===currentView[0].$uuid:view.$uuid===data.$resources.$uuid,changeCurrentView&&view.$selected&&notifications.publish(["sm.view.change"],view)}),notifications.publish(["sm.dashboard.list.views.change"],self._optDashboardList(!0))})},notifDashboardSelectTemplate:function(uuid){var self=this;dashboardWelcomeUtils.getWelcomeDashboard(!0,uuid).then(function(dashboard){self._updateWelcomeDashboard(dashboard,{dirty:self.dirty}).then(function(){globals.getApplication().gotoWelcomeApplication()})})},_optDashboardList:function(ownerOnly){var optSave=this._getOptionsSave(),optList={title:locale.text(ownerOnly?"welcome.select.dashboard.title":"welcome.select.template.title"),views:$.extend(!0,[],this.views.filter(function(view){return ownerOnly?!view.$isPersonal&&view.$factoryOwner===optSave.userFactoryOwner:!view.$isPersonal})),showCreateTemplate:ownerOnly};return optList},_appendTileToGroup:function(tile,groupId){var self=this,hubGrp=self.getLayout(groupId);hubGrp.article.$items.push(tile)},_actCloseDashboardConfig:function(){var step,self=this,opts=self._getOptionsSave(),uuid=null,currentView=self.views.filter(function(view){return view.$selected});currentView&&currentView[0]?step=dashboardWelcomeUtils.getWelcomeDashboard(!0,currentView[0].$uuid):step=dashboardWelcomeUtils.updateDashboard(),step.then(function(dashboard){return self._updateWelcomeDashboard(dashboard,{dirty:!1})}).then(function(){Base.prototype._actCloseDashboardConfig.call(self),globals.getApplication().gotoWelcomeApplication()}).fail(function(){Base.prototype._actCloseDashboardConfig.call(self),globals.getApplication().gotoWelcomeApplication()})},_actRestaurPersonalDashboard:function(){this._actSavePersonalDashboard()},_actSavePersonalDashboard:function(){var self=this;return globals.getMetaData().getDashboard(self.prototype.getDataByPath("$dashboardName")).then(function(dashboard){return dashboardWelcomeUtils.writeWelcomeDashboardUser(dashboard)}).then(function(dashboard){return self._updateWelcomeDashboard(dashboard,{dirty:!1})}).then(function(){self._afterChangePage();var notify={severityClass:"success",title:"",body:locale.text("dashboard.welcome.saved"),onlyWebapp:!0};globals.getModal().notify(notify)})},_actSaveTemplateDashboard:function(){var self=this;globals.getMetaData().getDashboard(self.prototype.getDataByPath("$dashboardName")).then(function(dashboard){var currentView=self.views.filter(function(view){return view.$selected}),opts={uuid:currentView?currentView[0].$uuid:null};return dashboardWelcomeUtils.writeCommonWelcomeDashboard(dashboard,opts)}).then(function(dashboard){return self.views=$.extend(!0,[],dashboard.$views),self._updateWelcomeDashboard(dashboard,{dirty:!1})}).then(function(){self._afterChangePage();var notify={severityClass:"success",title:"",body:locale.text("dashboard.welcome.published"),onlyWebapp:!0};globals.getModal().notify(notify)})},notifDashboardTitleChange:function(title){var self=this;globals.getMetaData().getDashboard(self.prototype.getDataByPath("$dashboardName")).then(function(dashboard){return dashboard.description=title,self._updateWelcomeDashboard(dashboard,{dirty:!0})}).then(function(){notifications.publish(["sm.dashboard.state.change"],self._getHeaderFooterOptions())})},_updateWelcomeDashboardArticle:function(article,options){var self=this;return globals.getMetaData().getDashboard(self.prototype.getDataByPath("$dashboardName")).then(function(dashboard){return dashboard.$article=article||dashboard.$article,dashboard}).then(function(dashboard){return self._updateWelcomeDashboard(dashboard,options)})},_updateWelcomeDashboard:function(dashboard,options){var self=this;return globals.getMetaData().updateWelcomeDashboard(dashboard).then(function(dashboard){return self.dirty=options?options.dirty:!1,dashboard})},_getOptionsSave:function(){var userFactory=globals.getSecurityProfile().factoryId,views=this.views||[],currentView=views.filter(function(view){return view.$selected}),currentIsPerso=currentView.length>0&&currentView[0].$isPersonal||currentView.length===0;return{userFactoryOwner:userFactory,personal:currentIsPerso,dirty:this.dirty,publish:userFactory!=="",savePublished:userFactory!==""&&userFactory===this.options.factoryOwner,deleteDashboard:userFactory!==""&&userFactory===this.options.factoryOwner,title:currentIsPerso?null:currentView[0].$description}},_setLocalization:function(text,oldUuid){var step,self=this;return oldUuid?(utils.isLocalizationExits(self.article.$localization,oldUuid)?step=modal.simpleConfirmPromise({message:locale.text("dashboard.welcome.group.keepTranslation")}).then(function(result){return result.action==="yes"?oldUuid:(self.article.$localization=utils.removeLocalization(self.article.$localization,oldUuid),utils.UUID())}):step=$.smResolve(oldUuid||utils.UUID()),step.then(function(uuid){return self.article.$localization=self.article.$localization||{},utils.setLocalization(self.article.$localization,uuid,text),uuid})):$.smResolve()}});exports.Page=_Page}),define("syracuse-tablet/html/js/sdata/sdatawhere/operator",["require","exports","module","syracuse-tablet/html/js/helpers/utils"],function(require,exports,module){var helpers=require("syracuse-tablet/html/js/helpers/utils");exports.Operator=function(code,text,precedence,isPrefix,isInfix,isAssociative,isPredicate){var self=this;self.code=code,self.text=text,self.precedence=precedence,self.isPrefix=isPrefix,self.isInfix=isInfix,self.isAssociative=isAssociative,self.isPredicate=isPredicate},helpers.defineClass(exports.Operator,null,{toString:function(){return this.text}}),exports.operators=new function(){function createOp(code,text,precedence,isPrefix,isInfix,isAssociative,isPredicate){var op=new exports.Operator(code||text,text,precedence,isPrefix,isInfix,isAssociative,isPredicate);self.operators[op.text]=op}function init(){createOp(null,".",1,!1,!0,!0,!1),createOp(null,"not",2,!0,!1,!1,!1),createOp("*","mul",3,!1,!0,!0,!1),createOp("/","div",3,!1,!0,!0,!1),createOp("%","mod",3,!1,!0,!0,!1),createOp(null,"+",4,!1,!0,!0,!1),createOp(null,"-",4,!0,!0,!0,!1),createOp("=","eq",5,!1,!0,!1,!0),createOp("<>","ne",5,!1,!0,!1,!0),createOp("<","lt",5,!1,!0,!1,!0),createOp("<=","le",5,!1,!0,!1,!0),createOp(">","gt",5,!1,!0,!1,!0),createOp(">=","ge",5,!1,!0,!1,!0),createOp(null,"between",5,!1,!0,!1,!0),createOp(null,"in",5,!1,!0,!1,!0),createOp(null,"like",5,!1,!0,!1,!0),createOp(null,"and",6,!1,!0,!0,!0),createOp(null,"or",7,!1,!0,!0,!0),createOp(null,"(",8,!0,!1,!1,!1),createOp(null,")",8,!1,!1,!1,!1),createOp(null,",",8,!1,!1,!1,!1)}var self=this;return self.operators={},init(),self}}),define("syracuse-tablet/html/js/sdata/sdatawhere/token",["require","exports","module","syracuse-tablet/html/js/helpers/utils","./operator"],function(require,exports,module){var helpers=require("syracuse-tablet/html/js/helpers/utils"),operators=require("./operator");exports.tokenType={identifier:"identifier",operator:"operator",literal:"literal"},exports.Token=function(type,line,offset,length,val){var self=this;self.type=type,self.value=val;var _line=line,_offset=offset,_length=length;self.getRemainingText=function(){return _line.substring(_offset,_line.length)}},helpers.defineClass(exports.Token,null,{matches:function(code){return this.value instanceof operators.Operator&&this.value.code==code}})}),define("syracuse-tablet/html/js/sdata/sdatawhere/tokenizer",["require","exports","module","./token","./operator"],function(require,exports,module){var token=require("./token"),operators=require("./operator");exports.Tokenizer=new function(){function _skipSpaces(chars,i){while(i<chars.length&&chars[i]===" ")i++;return i}function _isDigit(str){return(new RegExp("[0-9]")).test(str)}function _isLetter(str){return(new RegExp("[$a-zA-Z%']")).test(str)}function _isWordChar(str){return(new RegExp("[$a-zA-Z0-9_%']")).test(str)}function _parseNumber(line,chars,i,tokens){var end=i+1;while(end<chars.length&&_isDigit(chars[end]))end++;var val;if(end<chars.length&&chars[end]==="."){end++;while(end<chars.length&&_isDigit(chars[end]))end++;val=parseFloat(line.substring(i,end))}else val=parseInt(line.substring(i,end),10);return tokens.push(new token.Token(token.tokenType.literal,line,i,end-i,val)),end}function _parseWord(line,chars,i,tokens){var end=i+1;while(end<chars.length&&_isWordChar(chars[end]))end++;var word=chars.substr(i,end-i),op=operators.operators.operators[word.toLowerCase()];if(op!=null)tokens.push(new token.Token(token.tokenType.operator,line,i,end-i,op));else{var lit;(lit=_literals[word])!==undefined?tokens.push(new token.Token(token.tokenType.literal,line,i,end-i,lit)):tokens.push(new token.Token(token.tokenType.identifier,line,i,end-i,word))}return end}function _parseQuotedString(line,chars,i,tokens){var quote=chars[i],end=i+1,dest=0,res="";while(end<chars.length){if(chars[end]===quote){end++;if(end===chars.length||chars[end]!==quote)return tokens.push(new token.Token(token.tokenType.literal,line,i,end-i,res)),end}res+=chars[end++]}throw new Error("quoted string not terminated: "+line.substring(i))}function _parseOperator(line,ch,i,tokens){var op=operators.operators.operators[ch];return tokens.push(new token.Token(token.tokenType.operator,line,i,1,op)),i+1}function _parseDateTime(line,chars,i,tokens){var end=i+1,len=chars.length;while(end<len){if(chars[end]=="@")break;end++}if(end===chars.length)throw new Error("Where parser: date constant not terminated:"+line.substring(i,line.length));var str=chars.substr(i+1,end-i-1),dt=new Date(str);if(dt!=null){var nt=new token.Token(token.tokenType.literal,line,i,end+1-i,dt);nt.dataType="datetime",nt.svalue=str,tokens.push(nt)}return end+1}var self=this,_literals={"true":!0,"false":!1,"null":null};return self.tokenize=function(line){var tokens=[],i=0;while(i<line.length){i=_skipSpaces(line,i);var ch=line[i];switch(ch){case"@":i=_parseDateTime(line,line,i,tokens);break;case'"':case"'":i=_parseQuotedString(line,line,i,tokens);break;case".":case"-":case"+":case"(":case")":case",":i=_parseOperator(line,ch,i,tokens);break;default:if(_isLetter(ch))i=_parseWord(line,line,i,tokens);else{if(!_isDigit(ch))throw new Error("invalid character: "+line.substring(i));i=_parseNumber(line,line,i,tokens)}}}return tokens},self}}),define("syracuse-tablet/html/js/sdata/sdatawhere/expression",["require","exports","module","syracuse-tablet/html/js/helpers/utils"],function(require,exports,module){var helpers=require("syracuse-tablet/html/js/helpers/utils");exports.Expression=function(config){var self=this;self.children=null,config.operator?(self.type="operator",self.value=config.operator,self.children=[],config.expression1&&self.children.push(config.expression1),config.expression2&&self.children.push(config.expression2)):config.expressionType&&(self.type=config.expressionType,self.value=config.value,self.svalue=config.svalue,self.dataType=config.dataType,self.type==="function"&&(self.children=[]))},helpers.defineClass(exports.Expression,null,{isPredicate:function(){switch(this.type){case"operator":return this.value.isPredicate;case"identifier":return!0;case"function":return!0;case"literal":return!1;default:throw new Error("invalid expression type: "+this.type)}},toString:function(){if(this.children==null)return this.value.toString();var sb=[];sb.push("["+this.value.toString());for(var i=0;i<this.children.length;i++)sb.push(" "+this.children[i].toString());return sb.push("]"),sb.join("")}})}),define("syracuse-tablet/html/js/sdata/sdatawhere/parser",["require","exports","module","./token","./operator","./tokenizer","./expression"],function(require,exports,module){var token=require("./token"),operators=require("./operator"),tokenizer=require("./tokenizer"),expression=require("./expression");exports.Parser=new function(){function _finishBetween(tokens,tokenIndex,exp,precedence){if(tokenIndex[0]==tokens.length||!tokens[tokenIndex[0]].matches("and"))throw new Error("invalid expression: expected 'and' after "+tokens[tokenIndex[0]-1].getRemainingText());tokenIndex[0]++;var arg=_parseExpression(tokens,tokenIndex,precedence);exp.children.push(arg)}function _parseExpression(tokens,tokenIndex,precedence){var exp=_parseTerm(tokens,tokenIndex);while(tokenIndex[0]<tokens.length){var tk=tokens[tokenIndex[0]],op=tk.value instanceof operators.Operator?tk.value:null;if(op==null||!op.isInfix||op.precedence>precedence)break;tokenIndex[0]++;if(op.code=="in"){if(tokenIndex[0]===tokens.length||!tokens[tokenIndex[0]].matches("("))throw new Error("invalid expression: '(' expected after "+tk.getRemainingText());tokenIndex[0]++,exp=new expression.Expression({operator:op,expression1:exp}),_parseArguments(tokens,tk,tokenIndex,exp.children)}else{var arg=_parseExpression(tokens,tokenIndex,op.precedence-1);exp=new expression.Expression({operator:op,expression1:exp,expression2:arg}),op.code=="between"&&_finishBetween(tokens,tokenIndex,exp,op.precedence)}if(!op.isAssociative&&op.precedence==precedence)return exp}return exp}function _parseTerm(tokens,tokenIndex){if(tokenIndex[0]==tokens.length)throw new Error("premature end of expression");var tk=tokens[tokenIndex[0]];switch(tk.type){case token.tokenType.identifier:return tokenIndex[0]++,tokenIndex[0]<tokens.length&&tokens[tokenIndex[0]].matches("(")?_parseFunctionCall(tokens,tk,tokenIndex):new expression.Expression({expressionType:"identifier",value:tk.value});case token.tokenType.literal:return tokenIndex[0]++,new expression.Expression({expressionType:"literal",value:tk.value,svalue:tk.svalue,dataType:tk.dataType});case token.tokenType.operator:var op=tk.value;if(!op.isPrefix)throw new Error("invalid expression: expected beginning of term at "+tk.getRemainingText());return tokenIndex[0]++,_parsePrefixOperator(tokens,op,tokenIndex);default:throw new Error("internal error: bad token type "+tk.type)}}function _parseArguments(tokens,tk,tokenIndex,arguments0){if(tokenIndex[0]<tokens.length&&tokens[tokenIndex[0]].matches(")")){tokenIndex[0]++;return}while(tokenIndex[0]<tokens.length){var arg=_parseExpression(tokens,tokenIndex,_maxPrecedence);arguments0.push(arg);if(tokenIndex[0]<tokens.length&&tokens[tokenIndex[0]].matches(")")){tokenIndex[0]++;return}if(tokenIndex[0]==tokens.length||!tokens[tokenIndex[0]].matches(","))throw new Error("invalid expression: expected ',' or ')' at "+tokens[tokenIndex[0]].getRemainingText());tokenIndex[0]++}throw new Error("invalid function call syntax: argument missing after "+tk.getRemainingText())}function _parsePrefixOperator(tokens,op,tokenIndex){var arg1;switch(op.code){case"-":case"not":return arg1=_parseExpression(tokens,tokenIndex,1),new expression.Expression({operator:op,expression1:arg1});case"(":arg1=_parseExpression(tokens,tokenIndex,op.precedence);if(tokenIndex[0]==tokens.length||!tokens[tokenIndex[0]].matches(")"))throw new Error("invalid expression: expected ')' after "+tokens[tokenIndex[0]-1].getRemainingText());return tokenIndex[0]++,arg1;default:throw new Error("internal error: bad prefix operator "+op.code)}}function _parseFunctionCall(tokens,tk,tokenIndex){tokenIndex[0]++;var exp=new expression.Expression({expressionType:"function",value:tk.value});return _parseArguments(tokens,tk,tokenIndex,exp.children),exp}var self=this,_maxPrecedence=8;return self.parse=function(str){if(str==null||str.length==0)return null;var tokens=tokenizer.Tokenizer.tokenize(str),tokenIndex=[];tokenIndex[0]=0;var exp=_parseExpression(tokens,tokenIndex,_maxPrecedence);if(tokenIndex[0]!=tokens.length)throw new Error("invalid expression: unexpected token at "+tokens[tokenIndex[0]].getRemainingText());return exp},self}}),define("syracuse-tablet/html/js/sdata/sdatawhere/whereUtils",["require","exports","module"],function(require,exports,module){function _exec(data,exp,proto){if(exp.type=="identifier"){exp.property=data[exp.value];var item=proto&&proto.$properties&&proto.$properties.$resources?proto.$properties.$resources.$item:null;item&&item.$properties&&item.$properties[exp.value]&&item.$properties[exp.value].$type==="application/x-boolean"&&(exp.property=exp.property===!0?2:1)}else if(exp.type=="literal")exp.property=exp.dataType=="datetime"?exp.svalue:exp.value;else if(exp.children){var property=null;if(exp.type=="operator")switch(exp.value.code){case"and":exp.children.forEach(function(child){_exec(data,child,proto)}),exp.property=exp.children[0].property&&exp.children[1].property;break;case"or":exp.children.forEach(function(child){_exec(data,child,proto)}),exp.property=exp.children[0].property||exp.children[1].property;break;case"between":exp.children.forEach(function(child){_exec(data,child,proto)}),exp.property=exp.children[0].property>=exp.children[1].property&&exp.children[0].property<=exp.children[2].property;break;case">=":exp.children.forEach(function(child){_exec(data,child,proto)}),exp.property=exp.children[0].property>=exp.children[1].property;break;case">":exp.children.forEach(function(child){_exec(data,child,proto)}),exp.property=exp.children[0].property>exp.children[1].property;break;case"<=":exp.children.forEach(function(child){_exec(data,child,proto)}),exp.property=exp.children[0].property<=exp.children[1].property;break;case"<":exp.children.forEach(function(child){_exec(data,child,proto)}),exp.property=exp.children[0].property<exp.children[1].property;break;case"like_s":exp.children.forEach(function(child){_exec(data,child,proto)}),exp.property=exp.children[0].property.toUpperCase().indexOf(exp.children[1].property.toUpperCase())===0;break;case"like":exp.children.forEach(function(child){_exec(data,child,proto)});var val=exp.children[1].property.toUpperCase().replace(/%/g,"");exp.property=exp.children[0].property.toUpperCase().indexOf(val)>=0;break;case"=":exp.children.forEach(function(child){_exec(data,child,proto)}),exp.children[0].property=="0000-00-00"&&exp.children[1].dataType==="datetime"&&(exp.children[0].property=""),exp.children[1].property=="0000-00-00"&&exp.children[0].dataType==="datetime"&&(exp.children[1].property=""),exp.property=exp.children[0].property==exp.children[1].property;break;case"<>":exp.children.forEach(function(child){_exec(data,child,proto)}),exp.children[0].property=="0000-00-00"&&exp.children[1].dataType==="datetime"&&(exp.children[0].property=""),exp.children[1].property=="0000-00-00"&&exp.children[0].dataType==="datetime"&&(exp.children[1].property=""),exp.property=exp.children[0].property!=exp.children[1].property;break;case".":_exec(data,exp.children[0],proto),_exec(exp.children[0].property,exp.children[1],proto),exp.property=exp.children[1].property;break;default:exp.property=property,exp.children.forEach(function(child){_exec(data,child,proto),child.type=="literal"&&(child.property=property)})}else if(exp.type=="function")throw new Error("exp.type == 'function' not implemented")}}exports.execWhere=function(dataContext,exp,proto){return exp==null?!0:(_exec(dataContext,exp,proto),exp.property)}}),define("syracuse-tablet/html/js/sdata/sdataDispatcherLocal",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/sdata/sdatawhere/parser","syracuse-tablet/html/js/sdata/sdatawhere/whereUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),parser=require("syracuse-tablet/html/js/sdata/sdatawhere/parser").Parser,whereUtils=require("syracuse-tablet/html/js/sdata/sdatawhere/whereUtils");exports.Dispatcher=utils.defineClass(function(){},null,{getEntity:function($representation){var repr=$representation&&$representation.split(".");return repr&&repr[0]&&repr[0].smStartsWith("QUERY~")?repr=repr[0].split("~")[1]:repr&&repr[0]&&repr[0].smStartsWith("STATS~")?repr=repr[0].split("~")[1]:repr=repr&&repr[0],repr&&clientContract.getEntity(repr)},accept:function(op,data){var self=this,deferred=$.Deferred();return deferred.resolve(self.getEntity(op.$representation)!=null),deferred.promise()},prototype:function(op,data){var deferred=$.Deferred();return deferred.reject("Dispatcher should never request for prototypes since they are cached in the application model on client side"),deferred.promise()},"new":function(op,data){var self=this,ent=self.getEntity(op.$representation);return ent.$services.$new(op,data)},read:function(op,data){var self=this,ent=self.getEntity(op.$representation);return ent.$services.$read(op,data)},query:function(op,data){var self=this,ent=self.getEntity(op.$representation),list=ent.$services.$query(op,data);if(op.$where){var deferred=$.Deferred();return list.then(function(resources){var list=resources.$resources,exp=parser.parse(op.$where),repr=op.$representation&&op.$representation.split("."),$proto=clientContract.getPrototype(repr[0],repr[1]),res=[];list.forEach(function(item,i){whereUtils.execWhere(item,exp,$proto)&&res.push(item)}),deferred.resolve({$resources:res})}).fail(function(e){deferred.reject(e)}),deferred.promise()}return list},save:function(op,data){var self=this,ent=self.getEntity(op.$representation);return ent.$services.$save(op,data)},"delete":function(op,data){var self=this,ent=self.getEntity(op.$representation);return ent.$services.$delete(op,data)},service:function(op,data){var self=this,ent=self.getEntity(op.$representation);return ent.$services[op.$service](op,data)}})}),define("syracuse-tablet/html/js/sdata/sdataDispatcherHttp",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/sdata/sdataHttp"],function(require,exports,module){function _returnSyncAsync(promise,result,sync){if(sync){var timeLine=utils.getTimeLine("cacheUpdate",utils.UUID());return timeLine&&timeLine.start("Start writing to cache"),promise.then(function(){return timeLine&&timeLine.step("completed"),result})}return result}var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),globals=require("syracuse-tablet/html/js/helpers/globals"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("sdataDispatcher"),sdataHttp=require("syracuse-tablet/html/js/sdata/sdataHttp"),_authQueryCache={},_writeCacheModeSync={query:!1,read:!1};exports.Dispatcher=utils.defineClass(function(){notifications.subscribe(this,"sm.authcache.destroy")},null,{notifAuthcacheDestroy:function(pageId){if(!pageId)return;_authQueryCache[pageId]=null},accept:function(){var deferred=$.Deferred();return deferred.resolve(!0),deferred.promise()},_isOnline:function(){return globals.isOnline()},_isOfflineError:function(result){return result&&result.status<100?!0:!1},_networkError:function(titleId,result){var title=locale.text(titleId,[result?" - status="+result.status:""]);if(result&&result.responseJSON&&result.responseJSON.$diagnoses)return result.responseJSON.$title=title,result.responseJSON.$httpStatus=result.status,$.smReject(result.responseJSON);var detail=null;if(result&&result.responseText){detail=result.responseText.trim();if(detail.smStartsWith("{")||detail.toLowerCase().indexOf("<html")>=0)detail=null}return $.smReject({$httpStatus:result.status,$title:title,detail:detail})},_offlineNoCachedDataMessage:function(){return $.smReject({$noConnectionError:!0,$diagnoses:[{$message:locale.text("error.network.offline.cache"),$severity:"error"}]})},_useCache:function(op,action){var cache=globals.getCache();if(cache.isDisabled())return!1;var nocache=op.$parsedUrl&&op.$parsedUrl.query&&op.$parsedUrl.query.nocache;return nocache&&action==="read"?!1:!0},prototype:function(op,data,options){var deferred=$.Deferred();return deferred.reject("Dispatcher should never request for prototypes since they are cached in the application model on client side"),deferred.promise()},"new":function(op,data,options){var self=this,cacheRead,usedCache;return self._isOnline()?(cacheRead=$.smResolve(),usedCache=!1):(cacheRead=self._newGetCache(op,data),usedCache=!0),cacheRead.then(function(result){return result?(log&&log("Read template from cache: "+op.$representation),result.$uuid=utils.UUID(),result):self._newDoHttp(op,data).then(function(result){if(result.isSuccess){var data=result.responseJSON;return self._newPutCache(op,data).then(function(){return data})}if(!!usedCache||result.responseJSON!=null&&result.responseJSON.$noConnectionError!==!0)return self._networkError("sdata.error.template",netResult||result);var netResult=result;return self._newGetCache(op,data).then(function(result){return result?(log&&log("Read template from cache fallback: "+op.$representation),result.$uuid=utils.UUID(),result):self._networkError("sdata.error.template",netResult)})})})},_newGetCache:function(op){var self=this;if(self._useCache(op,"read")){var cache=globals.getCache();return log&&log("Reading template from cache: "+op.$representation),cache.read({$representation:"$templates",$endpoint:op.$endpoint,$key:op.$representation})}return log&&log("Disabled reading template from cache : "+op.$representation),$.smResolve()},_newDoHttp:function(op,data){var send={method:"GET",url:op.$link.$url};return sdataHttp.send(send)},_newPutCache:function(op,data){var self=this;if(self._useCache(op,"write")){log&&log("Writing template to cache: "+op.$representation);var cache=globals.getCache();return cache.put({$representation:"$templates",$key:op.$representation,$endpoint:op.$endpoint,$data:data})}return log&&log("Disabled writing template to cache : "+op.$representation),$.smResolve()},read:function(op,data,options){var self=this,cacheRead,forceUseCache=options.forceUseCache,usedCache;return self._isOnline()&&forceUseCache!==!0?(cacheRead=$.smResolve(),usedCache=!1):(cacheRead=self._readGetCache(op,data),usedCache=!0),cacheRead.then(function(result){return result?(log&&log("Read data from cache: "+op.$representation),result.$cacheHint={},result):self._readDoHttp(op,data).then(function(result){if(result.isSuccess){var data=result.responseJSON,prom=self._readPutCache(op,data).then(function(){return data});return _returnSyncAsync(prom,data,_writeCacheModeSync.read)}return self._isOfflineError(result)?usedCache?forceUseCache===!0?null:self._offlineNoCachedDataMessage():self._readGetCache(op,data).then(function(data){return data?(data.$cacheHint={},data):forceUseCache===!0?null:self._offlineNoCachedDataMessage()}):self._networkError("sdata.error.read",result)})})},_readGetCache:function(op){var self=this;if(self._useCache(op,"read")){var cache=globals.getCache();return log&&log("Reading data from cache: "+op.$representation),cache.read({$representation:op.$representation,$endpoint:op.$endpoint,$key:op.$key})}return log&&log("Disabled reading data from cache : "+op.$representation),$.smResolve()},_readDoHttp:function(op,data){var send={method:"GET",url:op.$link.$url};return sdataHttp.send(send)},_readPutCache:function(op,data){var self=this;if(self._useCache(op,"write")){log&&log("Writing data to cache: "+op.$representation);var cache=globals.getCache();return cache.put({$representation:op.$representation,$key:op.$key,$endpoint:op.$endpoint,$data:data})}return log&&log("Disabled writing data to cache : "+op.$representation),$.smResolve()},query:function(op,dataToSend,options){var self=this,cacheRead,usedCache,forceUseCache=options.forceUseCache,isStatsRequest=op.$isRequest===!0||op.$isStats===!0;return self._useCache(op,"read")!==!0||self._isOnline()&&forceUseCache!==!0?(cacheRead=$.smResolve(null),usedCache=!1):(cacheRead=self._queryReadCache(op,options),usedCache=!0),cacheRead.then(function(cacheResult,isAuthCache){var step;if(cacheResult!=null){log&&log("Queried data from cache: "+op.$representation);if(isStatsRequest){var response=cacheResult;response||(response={}),response.$resources||(response.$resources=[]),step=$.smResolve(response)}else if(isAuthCache===!0)step=$.smResolve(cacheResult);else{var response={};step=self._queryCutAndAddLinks(op,cacheResult,response).then(function(){return response.$resources||(response.$resources=[]),response.$resources.length>0&&(response.$cacheHint={}),response})}}else step=$.smResolve(null);return step.then(function(cacheResponse){return cacheResponse&&cacheResponse.$resources&&cacheResponse.$resources.length>0?cacheResponse:self._queryDoHttp(op).then(function(httpResult){if(httpResult.isSuccess){var data=httpResult.responseJSON||{};data.$resources=data.$resources||[];var prom;if(self._useCache(op,"write"))var prom=self._queryPutCache(op,data,options).then(function(){return data});else{log&&log("Disabled writing data to cache : "+op.$representation);var prom=$.smResolve(data)}return _returnSyncAsync(prom,data,_writeCacheModeSync.query)}return self._isOfflineError(httpResult)?usedCache?forceUseCache===!0?null:self._offlineNoCachedDataMessage():self._queryReadCache(op,options).then(function(cacheResult){if(!cacheResult)return forceUseCache===!0?null:self._offlineNoCachedDataMessage();log&&log("Queried data from cache: "+op.$representation);if(isStatsRequest){var response=cacheResult;return response||(response={}),response.$resources||(response.$resources=[]),response.$resources.length>0&&(response.$cacheHint={}),$.smResolve(response)}var response={};return self._queryCutAndAddLinks(op,cacheResult,response).then(function(){response.$resources||(response.$resources=[]);if(response.$resources.length>0)return response.$cacheHint={},response})}):self._networkError("sdata.error.read",httpResult)})})})},_queryCutAndAddLinks:function(op,result,response){result=result||[];var self=this,baseUrl=op.$parsedUrl.source.split("?")[0],query="",key,max=globals.OFFLINEQUERYCOUNT,orderBy="";op.$parsedUrl.query&&op.$parsedUrl.query.where&&(query+="&where="+op.$parsedUrl.query.where),key=op.$parsedUrl.query&&op.$parsedUrl.query.key;var firstKeyRead,lastKeyRead,resources=response.$resources=[],hasNextPage=!1,hasPreviousPage=!1,i,pageName=op.$endpoint+"."+op.$representation;return globals.getMetaData().getPrototype(pageName).then(function(proto){var val,kv,orderBy="";proto=proto.$properties&&proto.$properties.$resources&&proto.$properties.$resources.$item||proto;var keyField;proto.$key?keyField=proto.$key.replace(/{/g,"").replace(/}/g,""):keyField="$uuid",op.$parsedUrl.query&&op.$parsedUrl.query.orderBy&&(orderBy=self._buildOrderBy(op,keyField,op.$parsedUrl.query.orderBy),query+="&orderBy="+orderBy);var keyType=proto.$properties[keyField],isNumericKey=keyType&&keyType.$type&&keyType.$type!=="application/x-string",gotMatch=!1;if(key&&key.smStartsWith("gt")){val=key.substr(3),val=isNumericKey?+val:val;for(i=0;i<result.length;i++){gotMatch||(kv=self._calculateKey(proto,result[i]),kv=isNumericKey?+kv:""+kv);if(kv==val&&!gotMatch)gotMatch=!0;else if(gotMatch){resources.push(result[i]);if(resources.length>max)break}else hasPreviousPage=!0}resources.length>0&&(resources.length>max&&(resources.pop(),hasNextPage=!0),firstKeyRead=self._calculateKey(proto,resources[0]),lastKeyRead=self._calculateKey(proto,resources[resources.length-1]))}else if(key&&key.smStartsWith("lt")){if(key.length>3){val=isNumericKey?+key.substr(3):""+key.substr(3);for(i=result.length-1;i>=0;i--){gotMatch||(kv=self._calculateKey(proto,result[i]),kv=isNumericKey?0+kv:""+kv);if(kv==val&&!gotMatch)gotMatch=!0;else if(gotMatch){resources.push(result[i]);if(resources.length>max)break}else hasNextPage=!0}resources.length>max&&(hasPreviousPage=!0,resources.pop())}else for(i=result.length-1;i>=0;i--){resources.push(result[i]);if(resources.length>max)break}resources.length>0&&(resources.length>max&&(hasPreviousPage=!0,resources.pop()),response.$resources=resources=resources.reverse(),firstKeyRead=self._calculateKey(proto,resources[0]),lastKeyRead=self._calculateKey(proto,resources[resources.length-1]))}else{for(i=0;i<result.length;i++){resources.push(result[i]);if(resources.length>max)break}resources.length>0&&(resources.length>max&&(hasNextPage=!0,resources.pop()),firstKeyRead=self._calculateKey(proto,resources[0]),lastKeyRead=self._calculateKey(proto,resources[resources.length-1]))}var links=response.$links={};key&&(links.$first={$url:baseUrl+"?representation="+op.$representation+query}),key&&firstKeyRead&&hasPreviousPage&&key!=="gt"&&(links.$previous={$url:baseUrl+"?representation="+op.$representation+query+"&key=lt."+firstKeyRead}),key!=="lt"&&lastKeyRead&&hasNextPage&&(links.$next={$url:baseUrl+"?representation="+op.$representation+query+"&key=gt."+lastKeyRead}),key!=="lt"&&hasNextPage&&(links.$last={$url:baseUrl+"?representation="+op.$representation+query+"&key=lt"})})},_reqStatsGetCacheOpts:function(op,data){var key="",q=op.$parsedUrl.query;Object.keys(q).forEach(function(param){key+=param+q[param]}),key=utils._checksum(key);var opts={$representation:op.$representation,$endpoint:op.$endpoint,$key:key};return data!=null&&(opts.$data=data),opts},_queryReadCache:function(op,options){var self=this,cache=globals.getCache();log&&log("Querying data from cache: "+op.$representation);var p=op.$endpoint+"."+op.$representation;return globals.getMetaData().getPrototype(p).then(function(proto){self._checkQueryPrototype(op,proto);if(op.$isRequest===!0||op.$isStats===!0)return cache.read(self._reqStatsGetCacheOpts(op)).fail(function(e){return $.smReject(e)});if(globals.isAuthoringActive()&&options.$authCacheId&&_authQueryCache[options.$authCacheId])return $.smResolve(_authQueryCache[options.$authCacheId],!0);var filters=proto.$filters,where=self._extendWhereWithFilter(op,filters),proto=proto.$properties&&proto.$properties.$resources&&proto.$properties.$resources.$item||proto,keyField;proto.$key?keyField=proto.$key.replace(/{/g,"").replace(/}/g,""):keyField="$uuid";var orderBy=self._parseOrderBy(op.$orderBy,keyField);return cache.query({$proto:proto,$endpoint:op.$endpoint,$where:where,$orderBy:orderBy}).fail(function(e){return $.smReject(e)})})},_queryDoHttp:function(op){var send={method:"GET",url:op.$link.$url};return sdataHttp.send(send)},_queryPutCache:function(op,data,options){var self=this;log&&log("Writing data to cache: "+op.$representation);var cache=globals.getCache(),pageName=op.$endpoint+"."+op.$representation;return data||(data={}),data.$resources||(data.$resources=[]),globals.getMetaData().getPrototype(pageName).then(function(proto){return op.$isRequest===!0||op.$isStats===!0?cache.put(self._reqStatsGetCacheOpts(op,data)):(options.$authCacheId&&(_authQueryCache[options.$authCacheId]=data),proto=proto.$properties&&proto.$properties.$resources&&proto.$properties.$resources.$item||proto,$.smForEachPromise(data.$resources,function(item){var key=self._calculateKey(proto,item);return key||(key=item.$uuid),cache.put({$representation:op.$representation,$key:key,$endpoint:op.$endpoint,$data:item})}))})},save:function(op,data,options){var self=this;return self._saveDoHttp(op,data).then(function(result){if(result.isSuccess){var data=result.responseJSON;return self._savePutCache(op,data).then(function(){return result})}return result})},_saveDoHttp:function(op,data){var send={method:op.$link.$method,url:op.$link.$url,send:data};return sdataHttp.send(send)},_savePutCache:function(op,data){var self=this;try{if(self._useCache(op,"write")){log&&log("Writing data to cache: "+op.$representation);var cache=globals.getCache(),key=op.$key,step;if(!key){var pageName=op.$endpoint+"."+op.$representation;step=globals.getMetaData().getPrototype(pageName).then(function(proto){return proto=proto.$properties&&proto.$properties.$resources&&proto.$properties.$resources.$item||proto,key=self._calculateKey(proto,data),key})}else step=$.smResolve(key);step.then(function(key){self._removeFromCache({$representation:op.$representation,$key:key,$endpoint:op.$endpoint}).then(function(){return cache.put({$representation:op.$representation,$key:key,$endpoint:op.$endpoint,$data:data})})})}return log&&log("Disabled writing data to cache : "+op.$representation),$.smResolve()}catch(e){return $.smReject(e)}},"delete":function(op,data,options){var self=this,deferred=$.Deferred();try{self._deleteDoHttp(op,data).then(function(result){if(result.isSuccess){var data=result.responseJSON;return self._deleteRemoveCache(op,data).then(function(){return result})}return result}).then(function(result){deferred.resolve(result)}).fail(function(e){deferred.reject(e)})}catch(e){deferred.reject(e)}return deferred.promise()},_deleteDoHttp:function(op,data){var send={method:op.$link.$method,url:op.$link.$url};return sdataHttp.send(send)},_deleteRemoveCache:function(op,data){var self=this;if(self._useCache(op,"write")){log&&log("Deleting data from cache: "+op.$representation);var cache=globals.getCache();self._removeFromCache({$representation:op.$representation,$key:op.$key,$endpoint:op.$endpoint}).then(function(){return cache.remove({$representation:op.$representation,$key:op.$key,$endpoint:op.$endpoint})})}return log&&log("Disabled deleting data from cache : "+op.$representation),$.smResolve()},service:function(op,data,options){if(this._isOnline()){var send={method:op.$link.$method,url:op.$link.$url,send:data};return sdataHttp.send(send)}return $.smResolve({$diagnoses:[{$severity:"error",$message:locale.text("error.service.offline")}]})},_calculateKey:function(proto,item){var key;return proto.$key?key=proto.$key.replace(/\{(.*?)\}/g,function(match,prop){return item[prop]}):key=item.$uuid,key},_getKeyFields:function(proto){var key=proto.$key||proto.$properties&&proto.$properties.$resources&&proto.$properties.$resources.$item&&proto.$properties.$resources.$item.$key;if(key){var list=[];return key.replace(/\{(.*?)\}/g,function(match,prop){list.push(prop)}),list.length<1?["$uuid"]:list}return["$uuid"]},_checkQueryPrototype:function(op,proto){proto.$properties&&proto.$properties.$resources&&proto.$properties.$resources.$item&&(proto.$properties.$resources.$item.$type="{$baseType}."+op.$representation)},_removeFromCache:function(op){var self=this,cache=globals.getCache(),facets=["$edit","$create","$details","$query","$lookup"],rep=op.$representation.split(".")[0];return $.smForEachPromise(facets,function(facet){return op.$representation.indexOf("."+facet)>0?$.smResolve():cache.remove({$representation:rep+"."+facet,$key:op.$key,$endpoint:op.$endpoint})})},_parseOrderBy:function(orderBy,keyField){if(!orderBy)return[{property:keyField,sort:"ASC"}];var o=[];return orderBy.split(",").map(function(field){field=field.trim();var d=field.split(" "),f=d[0].trim();if(f.length>0){var dir="ASC";d.length>1&&(dir=d[1].toUpperCase(),dir=dir!=="DESC"?"ASC":"DESC"),o.push({property:f,sort:dir})}}),o},_buildOrderBy:function(op,keyField,orderBy){return orderBy?(orderBy===keyField||orderBy.indexOf(keyField+" ")>-1||orderBy.indexOf(keyField+",")>-1||(orderBy.indexOf(" DESC")>-1?orderBy+=", "+keyField+" DESC":orderBy+=", "+keyField+" ASC"),orderBy):keyField},_extendWhereWithFilter:function(op,filters){var self=this,where=op.$where;if(!filters)return where;var filterName=op.$parsedUrl&&op.$parsedUrl.query&&op.$parsedUrl.query.filter;if(!filterName)return where;var filter=filters&&filters[filterName];if(!filter)return where;var fw=self._checkFilterWhere(filterName,filter.$where);return fw?(where?where="("+where+") and ("+fw+")":where="("+fw+")",where):where},_checkFilterWhere:function(filterName,where){var invalid=where.match(/(\[F\:\w+\]?)/g);return invalid?(globals.getModal().error(locale.text("sdata.error.filter.screenFieldTitle"),locale.text("sdata.error.filter.screenFieldDetails",[filterName,invalid.join(","),where])),null):where}})}),define("syracuse-tablet/html/js/sdata/sdataDispatcher",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/sdata/sdataUtils","syracuse-tablet/html/js/sdata/sdataDispatcherLocal","syracuse-tablet/html/js/sdata/sdataDispatcherHttp","syracuse-tablet/html/js/helpers/native/native"],function(require,exports,module){var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("sdataDispatcher"),globals=require("syracuse-tablet/html/js/helpers/globals"),sdataUtils=require("syracuse-tablet/html/js/sdata/sdataUtils"),dispLocal=require("syracuse-tablet/html/js/sdata/sdataDispatcherLocal").Dispatcher,dispHttp=require("syracuse-tablet/html/js/sdata/sdataDispatcherHttp").Dispatcher,nativeDispatcherListener=require("syracuse-tablet/html/js/helpers/native/native").getModule("dispatcherListener"),_dispatchers=[new dispLocal,new dispHttp];exports.dispatch=function(link,data,options){var deferred=$.Deferred(),notifyNativeAfter;nativeDispatcherListener&&(notifyNativeAfter=function(){nativeDispatcherListener.dispatcherNotifyAfter({Method:link.$method,Url:link.$url})});try{log&&log("Dispatch: "+link.$method+": "+link.$url),options=options||{};var op=exports.parseLink(link),dispatcher;$.smForEachPromise(_dispatchers,function(disp){return disp.accept(op,data)},function(disp,result){return result===!0?(dispatcher=disp,!0):!1});var cacheStatus;options.forceUseCache&&(cacheStatus=globals.getCache().isDisabled(),globals.getCache().disableCache(!1));var prom=dispatcher[op.$operation](op,data,options);if(!prom)throw notifyNativeAfter&&notifyNativeAfter(),new Error("Could not dispatch: "+link.$method+": "+link.$url+" ("+op.$operation+")");prom.then(function(result){options.forceUseCache&&globals.getCache().disableCache(cacheStatus),notifyNativeAfter&&notifyNativeAfter(),deferred.resolve(result)}).fail(function(e){options.forceUseCache&&globals.getCache().disableCache(cacheStatus),notifyNativeAfter&&notifyNativeAfter(),deferred.reject(e)})}catch(e){deferred.reject(e)}return deferred.promise()};var _repExp=/\$prototypes\('(.*?)'\)/,_keyExp=/\('(.*?)'\)/;exports.parseLink=function(link){var url=link.$url,result={$link:link,$parsedUrl:sdataUtils.parseSDataURL(link.$url)};result.$endpoint=result.$parsedUrl.application+"."+result.$parsedUrl.contract+"."+result.$parsedUrl.dataset;var dir=result.$parsedUrl.directory,idx;if(link.$method==="GET"){if(url.indexOf("$prototypes")>-1)result.$operation="prototype",result.$representation=_repExp.exec(url)[1];else if(dir.indexOf("$template")>-1)result.$operation="new",result.$representation=result.$parsedUrl.query&&result.$parsedUrl.query.representation;else if(result.$parsedUrl.$services)result.$operation="service",result.$service=result.$parsedUrl.$services,result.$representation=result.$parsedUrl.query&&result.$parsedUrl.query.representation;else{var key=_keyExp.exec(dir);result.$isStats=dir.indexOf("/STATS(")>-1,result.$isRequest=dir.indexOf("/QUERY(")>-1,result.$representation=result.$parsedUrl.query&&result.$parsedUrl.query.representation,key&&!result.$isStats&&!result.$isRequest?(result.$operation="read",result.$key=key[1]):result.$operation="query"}result.$parsedUrl.query&&result.$parsedUrl.query.where&&(result.$where=result.$parsedUrl.query.where),result.$parsedUrl.query&&result.$parsedUrl.query.orderBy&&(result.$orderBy=result.$parsedUrl.query.orderBy)}else if(result.$parsedUrl.$services)result.$operation="service",result.$service=result.$parsedUrl.$services,result.$representation=result.$parsedUrl.query&&result.$parsedUrl.query.representation;else if(link.$method==="DELETE"){var key=_keyExp.exec(dir);result.$operation="delete",result.$key=key[1],result.$representation=result.$parsedUrl.query&&result.$parsedUrl.query.representation}else{var key=_keyExp.exec(dir);key?(result.$operation="save",result.$key=key[1],result.$representation=result.$parsedUrl.query&&result.$parsedUrl.query.representation):(result.$operation="save",result.$representation=result.$parsedUrl.query&&result.$parsedUrl.query.representation)}return result}}),define("syracuse-tablet/html/js/helpers/deltaManager",["require","exports","module"],function(require,exports,module){function _isVariantArray(list){var first=list&&list.length>0?list[0]:null;return first&&first.$uuid==undefined&&typeof first=="object"&&Object.keys(first).length==1?!0:!1}function _ensureServerIndex(list){if(_isVariantArray(list))for(var ii=0,jj=list.length;ii<jj;ii++){var record=list[ii];typeof record=="object"&&(record[Object.keys(record)[0]].$serverIndex=ii)}else if(list.length&&typeof list[0]=="object"&&list[0].$uuid!==undefined)for(var ii=0,jj=list.length;ii<jj;ii++)list[ii].$serverIndex=ii}function _applyPageRecordDelta(options,record,subRecord,targetMap,targetList,variantKey){if(subRecord.$uuid!==undefined){if(!subRecord.$isDeleted)if(subRecord.$uuid!==undefined&&targetMap[subRecord.$uuid])if(variantKey){var newNecord=_applyObjectDelta(options,targetMap[subRecord.$uuid],subRecord);record={},record[variantKey]=newNecord,targetList.push(record)}else targetList.push(_applyObjectDelta(options,targetMap[subRecord.$uuid],subRecord));else targetList.push(record)}else targetList.push(record)}function _applyObjectArrayDelta(options,targetList,sourceList){if(sourceList)if(targetList.length==sourceList.length)for(var ii=0,jj=sourceList.length;ii<jj;ii++)_applyObjectDelta(options,targetList[ii],sourceList[ii]);else{targetList.splice(0,targetList.length);for(var ii=0,jj=sourceList.length;ii<jj;ii++)targetList.push(sourceList[ii])}return targetList}function _applyObjectDelta(options,target,source,isObjectDelta){options=options||{};if(source){var properties=Object.keys(source),isData;for(var ii=0,jj=properties.length;ii<jj;ii++){var property=properties[ii];isData=property.charAt(0)!="$";var targetValue=target[property],sourceValue=source[property];if(typeof sourceValue=="object"){if(targetValue!=null&&sourceValue!==null)if(Array.isArray(sourceValue)){if(isObjectDelta||!isData)sourceValue=_applyObjectArrayDelta(options,targetValue,sourceValue);else if(options.$isEditMode||options.$isPartialDelta)sourceValue=exports.applyPageArrayDelta(options,targetValue,sourceValue)}else sourceValue=_applyObjectDelta(options,targetValue,sourceValue,isObjectDelta);Array.isArray(sourceValue)&&isData&&_ensureServerIndex(sourceValue)}target[property]=sourceValue}}return target}exports.cleanServerIndex=function(source){if(source&&typeof source=="object")if(Array.isArray(source))for(var ii=0,jj=source.length;ii<jj;ii++)exports.cleanServerIndex(source[ii]);else{delete source.$serverIndex;var properties=Object.keys(source);for(var ii=0,jj=properties.length;ii<jj;ii++)exports.cleanServerIndex(source[properties[ii]])}return source},exports.applyObjectDelta=_applyObjectDelta,exports.applyPageArrayDelta=function(options,targetList,sourceList){options=options||{};if(sourceList){var targetMap={},isVariant=_isVariantArray(sourceList);if(options.$isPartialDelta||sourceList.length==1&&sourceList[0].$index!==undefined){var found,foundIndex;for(var ii=0,jj=sourceList.length;ii<jj;ii++){found=null;var sourceRecord=sourceList[ii];foundIndex=0;for(var mm=targetList.length;foundIndex<mm;foundIndex++){found=targetList[foundIndex];if(found.$uuid==sourceRecord.$uuid)break;found=null}found?sourceRecord.$isDeleted?targetList.splice(foundIndex,1):(_applyObjectDelta(options,found,sourceRecord),sourceRecord.$index!==undefined&&sourceRecord.$index!=foundIndex&&(targetList.splice(foundIndex,1),targetList.splice(sourceRecord.$index,0,found),delete found.$index)):sourceRecord.$isDeleted||(sourceRecord.$index!==undefined?targetList.splice(sourceRecord.$index,0,sourceRecord):targetList.push(sourceRecord))}}else{for(var ii=0,jj=targetList.length;ii<jj;ii++){var record=targetList[ii];record&&(record.$uuid!==undefined?targetMap[record.$uuid]=record:isVariant&&(record=record[Object.keys(record)[0]],record.$uuid!==undefined&&(targetMap[record.$uuid]=record)))}targetList=[];for(var ii=0,jj=sourceList.length;ii<jj;ii++){var record=sourceList[ii];if(isVariant){var variantKey=Object.keys(record)[0];_applyPageRecordDelta(options,record,record[variantKey],targetMap,targetList,variantKey)}else _applyPageRecordDelta(options,record,record,targetMap,targetList)}}}return targetList}}),define("syracuse-tablet/html/js/application/daoSdata",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/articleParser","syracuse-tablet/html/js/helpers/deltaManager","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/logger"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),globals=require("syracuse-tablet/html/js/helpers/globals"),articleParser=require("syracuse-tablet/html/js/helpers/articleParser"),deltaManager=require("syracuse-tablet/html/js/helpers/deltaManager"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("daoSData",!1),_linksNameTampering=function($link){var $linkRenamed={},name="";return $link?(Object.keys($link).forEach(function(key){switch(key){case"levelDown":name="$drillUp";break;case"levelUp":name="$drillDown";break;default:name=key}$linkRenamed[name]=$link[key]}),$linkRenamed):$linkRenamed},_DataProcessor=function(){this.removeprop=function(operation,o,name,result){return operation?operation.exclude!=null&&operation.exclude.indexOf(name)>=0?!1:operation.regExp?operation.regExp.test(name)?(delete o[name],result&&(result.removeprop==null&&(result.removeprop={_nbRemoved:0}),result.removeprop[name]==null&&(result.removeprop[name]=0),result.removeprop[name]++,result.removeprop._nbRemoved++),!1):!0:!1:!1},this.dataToTemplate=function(operation,o,name,result){return operation?name==="$uuid"?(o.hasUUID=!0,!1):name.toLowerCase()==="etag"||name.smStartsWith("$")?(delete o[name],!1):!0:!1},this._walkArray=function(o,operation,result){if(!o)return;var self=this;o.forEach(function(e){typeof e=="object"&&self._walk(e,operation,result)})},this._walkPlainObject=function(o,operation,result){if(!o)return;var p=Object.keys(o),e,name,walkInside;for(var ii=0,jj=p.length;ii<jj;ii++){name=p[ii],e=o[name],walkInside=!0;for(var opName in operation)this[opName]&&(walkInside=this[opName](operation[opName],o,name,result));walkInside&&typeof e=="object"&&this._walk(e,operation,result)}},this._walk=function(o,operation,result){if(!o||!operation)return;typeof o=="object"&&(Array.isArray(o)?this._walkArray(o,operation,result):$.isPlainObject(o)&&this._walkPlainObject(o,operation,result))},this.process=function(operation,data){var result;return log!=null&&(result={startTime:(new Date).getTime()}),this._walk(data,operation,result),log!=null&&result&&(log("getActionPayload - operations - Elsaped=",(new Date).getTime()-result.startTime,"ms"),log("Result: ",JSON.stringify(result,null,2))),result}},_getResourcesTime=function($resources){var utcTime=(new Date).getTime();return $resources?($resources.forEach(function(item){item.$cache&&(utcTime=Math.min(utils.getTimeFromString(item.$cache.$lastUpdated),utcTime))}),utcTime):utcTime},_defMetaData={$properties:{$isExcluded:!1,$isHidden:!1,$isMandatory:!1,$isReadOnly:!1,$isDisabled:!1,$diagnoses:null,$x3Format:null,$value:null,$format:null,$capabilities:null},$links:{$isDisabled:!1,$isHidden:!1,$style:!1,$isRequested:!1}},_updt=function(src,dst){var m={},j;for(var p in _defMetaData)j=src[p],j&&!$.isEmptyObject(j)&&(m[p]=j);return $.isEmptyObject(m)?null:($.extend(dst,m),m)},_updateMeta=function(fromData,toData,properties,isRowData){if(!fromData||!toData)return!1;var meta=_updt(fromData,toData);if(isRowData==1&&meta&&meta.$properties)for(var p in meta.$properties)if(meta.$properties[p].$diagnoses!=null){toData.$arrayUpdateError=!0;break}var done=meta!=null;if(properties)for(var name in properties){var proto=properties[name];if(proto&&proto.$type==="application/x-array"&&fromData[name])if(!articleParser.isSingleArray(proto)){var arrSrc=fromData[name],arrDst=toData[name];if(!arrDst)throw new Error("Unexpected empty data array - "+name);for(var idx=0;idx<arrSrc.length&&idx<arrDst.length;idx++){var rowData=arrDst[idx];meta=_updateMeta(arrSrc[idx],rowData,proto.$item.$properties,!0),rowData.$arrayUpdateError&&isRowData&&(toData.$arrayUpdateError=!0),done=meta!=null||done}}else if(proto.$item.$type==="application/x-reference"){var arrSrc=fromData[name],arrDst=toData[name],dst,src;for(var idx=0;idx<arrSrc.length&&idx<arrDst.length;idx++){dst=arrDst[idx],src=arrSrc[idx];for(var p in _defMetaData.$properties)src&&src[p]!=null?dst[p]=src[p]:proto.$item[p]!=null?dst[p]=proto.$item[p]:dst[p]=_defMetaData.$properties[p]}}}return done},_Dao=utils.defineClass(function DaoSdata(data,prototype,options){options=options||{};if(!prototype)throw new Error("Prototype is mandatory");this.prototype=prototype,this.data=data||{},this.$bind=options.$bind||"",this.parent=options.parent,this.parent||(this._creationDate=new Date),this.resetCache(),this.enableWorkingCopy=!1,this._initDirty(),this.isRowDetailDao=options.isRowDetailDao===!0},null,{destroy:function(destroyProto){this.parent=null,this.data=null,destroyProto===!0&&this.prototype&&this.prototype.destroy(),this.prototype=null,this._dataProcessor=null},resetCache:function(){this._cache={metaData:{},queryData:null}},setValue:function(name,value,notify){var done=!1,curVal=this.data[name];if(this.prototype.isReference(name)){var valName=this.prototype.getFieldNameForValue(name);if(valName!==name){var strVal;typeof value=="object"?strVal=value.$value||"":strVal=value+"";if(strVal!=this.data[valName]){this.data[name]=curVal={},this.data[valName]=strVal;if(strVal===value)curVal.$value=strVal;else for(var p in value)curVal[p]=value[p];curVal[valName]=strVal,done=!0}}else if(curVal==null||curVal.$value!=value)throw new Error("Syracuse entities - x-refrence setValue not implemented")}else if(curVal==null||curVal!==value)this.data[name]=value,done=!0;return done&&this.setDirty(),done},_initDirty:function(){if(this.prototype.isSingleArray(!0)){this.isDirty=!0,notifications.publish("sm.dao.dirty",!0,this.data.$uuid);return}this.resetDirty(!0)},resetDirty:function(forceNotify){this._toggleDirty(!1,forceNotify)},setDirty:function(forceNotify){this._toggleDirty(!0,forceNotify)},_toggleDirty:function(yes,forceNotify){if(this.prototype.isSingleArray(!0)){this.isDirty=!0;return}yes=yes===!0,this.publishDirty(yes,forceNotify),this.isDirty=yes},publishDirty:function(dirty,forceNotify){if(!this.isRowDetailDao&&(this.$bind==null||this.$bind.length>0))return;if(forceNotify!==!0&&this.isDirty===dirty)return;notifications.publish("sm.dao.dirty",dirty===!0,this.data.$uuid)},getValue:function(name,defValue,searchInParents){if(!name||name.length===0)return defValue;var val=this.data[name];if(val==null)return searchInParents&&this.parent?this.parent.getValue(name,defValue,searchInParents):defValue;if(this.prototype.isReference(name)){var nameValue=this.prototype.getFieldNameForValue(name);nameValue!=name?(typeof val!="object"&&(val={}),val.$value=this.getValue(nameValue,defValue)):val={$value:val}}return val},getPathValue:function(path){return jsutils.getPropByPath(this.data,path)},getMetaData:function(type,propName){if(!type)throw new Error("getMetaData - type expected");if(propName==null)return;var protoPropName=propName;type==="$properties"&&this.prototype.isReference(propName)&&(propName=this.prototype.getFieldNameForValue(propName));var meta=this._cache.metaData[type];if(meta){if(propName==null)return meta;if(propName!=null&&meta[propName]!=null)return meta[propName];meta=meta[propName]={}}else meta=this._cache.metaData[type]={},propName!=null&&(meta=meta[propName]={});var proto=this.prototype.data(type);proto&&propName!=null&&(proto=proto[protoPropName]);var data=this.data[type];data&&propName!=null&&(data=data[propName]);var props=_defMetaData[type];if(!props)throw new Error("getMetaData - unexpected type["+type+"]");for(var p in props){if(data&&data[p]!=null){meta[p]=data[p];continue}proto&&proto[p]!=null?meta[p]=proto[p]:meta[p]=props[p]}return meta},removeMetaDiagnoses:function(fieldName){this.prototype.isReference(fieldName)&&(fieldName=this.prototype.getFieldNameForValue(fieldName)),[this.data,this._cache.metaData].forEach(function(data){var meta=data.$properties;meta&&meta[fieldName]&&(meta[fieldName].$diagnoses=undefined)})},getFieldInfo:function(name){return{meta:this.getMetaData(),value:this.getValue()}},getArrayData:function($bind,protoArray,localPaginator){if(!protoArray)throw new Error("getArrayData - Prototype Array is mandatory");var arrayData;if(protoArray.isSingleArray()){arrayData=[];var rsrcs=this.getValue($bind)||[],meta=this.data.$properties&&this.data.$properties[$bind];meta=meta?meta.$items:null;var proto=protoArray.getPrototype("$item"),self=this;rsrcs.forEach(function(rsrc,idx){var data={};data[globals.SINGLEARRAYPROP]=rsrc,data.$uuid=utils.UUID();var diag=null,errEntry;if(proto.property(globals.SINGLEARRAYPROP).$type==="application/x-reference"){var valFld=proto.getFieldNameForValue(globals.SINGLEARRAYPROP);valFld&&(data[valFld]=rsrc[valFld]),rsrc.$diagnoses&&(diag=rsrc.$diagnoses,errEntry=valFld)}else meta&&meta[idx]&&(diag=meta[idx].$diagnoses),errEntry=globals.SINGLEARRAYPROP;diag&&diag.length>0&&(data.$arrayUpdateError=!0,data.$properties={},data.$properties[errEntry]={$diagnoses:diag}),arrayData.push(new _Dao(data,proto,{parent:self,$bind:$bind}))})}else arrayData=this._createArrayData($bind,protoArray,localPaginator);return{$resources:arrayData||[]}},_createArrayData:function($bind,protoArray,localPaginator){var res=[],rsrcs=this.getValue($bind);if(rsrcs&&rsrcs.length>0){var startIdx=localPaginator?Math.max(0,localPaginator.currentIdx):0,length=localPaginator?Math.min(rsrcs.length,startIdx+localPaginator.count):rsrcs.length,protoRow=protoArray.getPrototype("$item");for(var i=startIdx;i<length;i++)res.push(new _Dao(rsrcs[i],protoRow,{parent:this,$bind:$bind}))}return res},getQueryData:function(protoArray,localPaginator){if(!protoArray)throw new Error("getQueryData - Prototype Array is mandatory");var protoLinks=_linksNameTampering(protoArray.getDataByPath("$item.$links"));protoLinks=$.extend(!0,{},protoLinks,this.getValue("$links"));var dataLinks=_linksNameTampering(this.getPathValue("$properties.$resources.$item.$links")),res={$itemsPerPage:this.getValue("$itemsPerPage"),$links:$.extend(!0,{},protoLinks,dataLinks)};return res.$resources=this._createArrayData("$resources",protoArray,localPaginator),res},getLookupData:function(protoArray,localPaginator){return this.getQueryData(protoArray,localPaginator)},getCubeData:function($bind,protoArray,localPaginator){var protoLinks=_linksNameTampering(protoArray.getDataByPath("$item.$links")),dataLinks=_linksNameTampering(this.getPathValue("$properties.$resources.$item.$links")),res={$links:$.extend(!0,{},protoLinks,dataLinks),$properties:this.getPathValue("$properties.$resources.$item.$properties")};return res.$resources=this._createArrayData($bind,protoArray,localPaginator),res},getQueryResources:function(){return this.getValue("$resources")||[]},parseExpression:function(expression){return utils.parseExpression(expression,this,this.prototype)},setRowIndex:function(value){this.setValue(globals.ROWIDXPROP,value,!1)},getActionPayload:function(link,isEditMode){var operations={removeprop:{regExp:/^\$/,exclude:["$links","$parameters","$uuid","$index","$serverIndex","$etag","$trackingId"]}},result=this._processData(operations);if(!link)return;var payload;link.$method!=="PUT"&&link.$method!=="POST"||isEditMode!==!0?payload={}:payload=$.extend(!0,{},this.data),payload.$parameters=payload.$parameters||{};var self=this;return $.each(link.$parameters||[],function(name,value){payload.$parameters[name]=self.parseExpression(value)}),payload},clone:function(){return new _Dao($.extend(!0,{},this.data),this.prototype,{parent:this.parent,$bind:this.$bind,isRowDetailDao:this.isRowDetailDao===!0})},workingCopyGetId:function(onlyIfDirty){return null},updateMeta:function(src){if(!src)return!1;this.resetCache();var done=_updateMeta(src,this.data,this.prototype.data("$properties"));return done&&this.setDirty(),done},updateParentRow:function(create,singleArrayRowIdx){if(!this.parent||!this.data||$.isEmptyObject(this.data))return!1;var id=this.data.$uuid,grid=this.parent.data[this.$bind];if(!grid){if(!create)return!1;grid=this.parent.data[this.$bind]=[]}var single=this.prototype.isSingleArray();if(create){var newdata=single?this.data[globals.SINGLEARRAYPROP]:this.data;grid.push($.isPlainObject(newdata)?$.extend({},newdata):newdata)}else{var idx=-1,newdata=this.data;if(single){grid.length>singleArrayRowIdx&&(idx=singleArrayRowIdx);if(idx<0)return!1;newdata=this.data[globals.SINGLEARRAYPROP]}else{grid.some(function(r,i){if(r.$uuid==id)return idx=i,!0});if(idx<0)return!1}if(utils.areEqual(newdata,grid[idx]))return!1;grid[idx]=$.isPlainObject(newdata)?$.extend({},newdata):newdata}return this.parent.setDirty(),!0},deleteRow:function(field,rowidoridx){var grid=this.data[field];if(!grid)return!1;var idx=-1;return this.prototype.isSingleArray(!1,field)?(rowidoridx=parseInt(rowidoridx,10),grid.length>rowidoridx&&(idx=rowidoridx)):grid.some(function(r,i){if(r.$uuid==rowidoridx)return idx=i,!0}),idx<0?!1:(grid.splice(idx,1),this.setDirty(),!0)},checkArrayUpdateError:function(){var d=this.data,errors=!1;if(d.$properties)for(var p in d.$properties)if(p.$diagnoses&&p.$diagnoses.length>0){errors=!0;break}if(!errors){var props=this.prototype.data("$properties")||{};for(var p in props)if(props[p].$type==="application/x-array"&&this.data[p]&&this.data[p].some(function(r){if(r.$arrayUpdateError)return!0})){errors=!0;break}}errors||(d.$arrayUpdateError=!1)},applyChange:function(newData,opts){newData||(newData={}),this.resetCache(),opts||(opts={}),opts.$isPartialDelta==null&&(opts.$isPartialDelta=!0),opts.$isEditMode==null&&(opts.$isEditMode=!0),deltaManager.applyObjectDelta(opts,this.data,newData),this.setDirty()},isValid:function(){return this.prototype!=null&&this.data!=null&&this.prototype.isValid()},expired:function(timeout){var creDate,dao=this;while(dao!=null&&(creDate=dao._creationDate)!=null)dao=this.parent;return creDate?(new Date).getTime()-creDate.getTime()>timeout:!1},_processData:function(operation,data){return this._dataProcessor||(this._dataProcessor=new _DataProcessor),this._dataProcessor.process(operation,data||this.data)},dataFreshness:function(){var freshNess={dateTime:0};return this.data&&(freshNess.dateTime=(new Date).getTime(),this.data.dateTime&&(freshNess.dateTime=Math.min(freshNess.dateTime,(new Date).getTime())),this.data.$cacheHint&&(this.data.$cache?freshNess.dateTime=Math.min(freshNess.dateTime,utils.getTimeFromString(this.data.$cache.$lastUpdated)):freshNess.dateTime=Math.min(freshNess.dateTime,_getResourcesTime(this.data.$resources)))),freshNess},getTemplateData:function(){var op={dataToTemplate:{}},data=$.extend(!0,{},this.data);return this._processData(op,data),data},_setTmplWalkProto:function(proto,data,dataSet){var self=this;if(!data||!proto||!proto.$properties)return;var parentKey;proto&&proto.$key&&(parentKey=utils.sdataExtractKeyFields(proto.$key));for(var p in proto.$properties){var prop=proto.$properties[p];if(prop==null||data[p]==null)continue;if(parentKey&&parentKey.indexOf(p)>=0)continue;if(prop.$type==="application/x-array"){dataSet[p]=[];if(data[p].length==0)continue;var protoArray=prop.$item;data[p].forEach(function(rowData,idx){if(protoArray.$type==="application/json"){var filteredRowData=self._setTmplWalkProto(protoArray,rowData,{});$.isEmptyObject(filteredRowData)||dataSet[p].push(self._setTmplWalkProto(protoArray,rowData,{}))}else dataSet[p].push(rowData)})}else dataSet[p]=data[p]}return data["hasUUID"]==1&&dataSet["$uuid"]==null&&(dataSet.$uuid=utils.UUID()),dataSet},setTemplateData:function(data){if(!this.prototype)return;this._setTmplWalkProto(this.prototype.json,data,this.data),this.setDirty()},initParentBasedDefaultValues:function(){var self=this;if(!this.parent)return;var parentRepr=this.parent.prototype.data("$representation");if(!parentRepr)return;var rowProperties=this.prototype.data("$properties"),parentProperties=this.parent.prototype.data("$properties");if(!rowProperties||!parentProperties)return;$.each(rowProperties,function(name,rowProperty){if(rowProperty.$type==="application/x-reference"){var $itemUrl=rowProperty.$item&&rowProperty.$item.$url,itemRepr=/representation=(.+?)\./.exec($itemUrl);itemRepr=itemRepr&&itemRepr.length>1?itemRepr[1]:null;if(itemRepr===parentRepr){var $refValue=rowProperty.$item.$refValue,$lookupValue=rowProperty.$item.$lookupValue,parentValue=self.parent.getValue($lookupValue);parentValue!=null&&self.setValue(name,parentValue)}}})}});exports.Dao=_Dao,exports.emptyDao=function(prototype){return new _Dao({$properties:{}},prototype)}}),define("syracuse-tablet/html/js/application/gadget",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),_Gadget=utils.defineClass(function(jsonData){var self=this;self._data=jsonData},null,{destroy:function(){var self=this;self._data=null},isRequest:function(){return this._data.$type==="$request"},isStatistics:function(){return this._data.$type==="$stats"},data:function(prop){return this._data?this._data[prop]:null},getEndPoint:function(){return this._data.endpoint||globals.getEndpoint()},isDefaultEndpoint:function(){return!this._data.endpoint},getPageName:function(){var self=this;if(!self.isValid())return null;var rep;if(self.isRequest())rep=self.getRequestRepresentation();else if(self.isStatistics())var rep=self.getStatsRepresentation();else var rep=self._data.representation;return self.getEndPoint()+"."+rep+"."+self._data.facet},getSDataUrl:function(proto){var self=this,url;switch(self._data.$type){case"$representation":["$details","$edit"].indexOf(self._data.action)>-1?url=proto.data("$url",{$key:self._data.keyParameter}):["$create"].indexOf(self._data.action)>-1?(url=proto.data("$url"),url=url.replace(/\((.*?)\)/,"/$template")):url=proto.data("$url");break;case"$request":url=proto.data("$baseUrl"),url=url+"/QUERY('"+self._data.requestName+"')?representation="+self.getRequestRepresentation()+".$query",self._data.parameters&&Object.keys(self._data.parameters).forEach(function(name){var value=self._data.parameters[name].value;if(!value)return;if(name==="where"&&/{\S+}/.test(value))return;url=url+"&"+name+"="+value});break;case"$stats":url=proto.data("$baseUrl"),url=url+"/STATS('"+self._data.statName+"')?representation="+self.getStatsRepresentation()+".$cube",self._data.parameters&&Object.keys(self._data.parameters).forEach(function(name){var value=self._data.parameters[name].value;if(!value)return;if(name==="where"&&/{\S+}/.test(value))return;url=url+"&"+name+"="+value})}return url},getRequestRepresentation:function(){return"QUERY~"+this._data.requestName+"~"+this._data.requestLevel},getStatsRepresentation:function(){return"STATS~"+this._data.statName},getJSON:function(){return $.extend(!0,{},this._data)},isValid:function(){return this.getInvalidReason()==null},getInvalidReason:function(){var t=this._data.$type;return t==="$representation"||t==="$stats"||t==="$request"?this._data.$uuid.smStartsWith("test")?null:(this.getEndPoint()||"").trim().length==0?"No endpoint":null:null},getParameters:function(){return this._data.parameters||{}}});exports.Klass=_Gadget}),define("syracuse-tablet/html/js/ui/modals/modalSaveDraft",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/modals/modalMultiButtons","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/ui/modals/modalMultiButtons").Modal,locale=require("syracuse-tablet/html/js/helpers/locale"),_template={comment:'		<div style="display:table;">			<div style="display:table-row;">				<div style="display:table-cell;padding-right: 20px;">					{{comment}}				</div>				<div style="display:table-cell;width:100%;">					<input type="text" style="width: 100%;">				</div>			</div>		</div>'},_Klass=utils.defineClass(function ModalSaveDraft(comment,offline){var opts={buttons:[]};["cancel","save"].forEach(function(act){opts.buttons.push({action:act,label:locale.text(act)})});var type=offline===!0?"offline":"online";Base.call(this,locale.text("drafts.dlog.save.title."+type),locale.text("drafts.dlog.save.info."+type),opts),this._comment=comment||""},Base,{_attachDOM:function(){Base.prototype._attachDOM.call(this),$(Handlebars.compile(_template.comment)({comment:locale.text("comment").smCapitalize()})).appendTo(this.$$elmt.find(".s-m-modal-content")).find('input[type="text"]').val(this._comment).focus()},_getResult:function(){return{action:Base.prototype._getResult.call(this),comment:this.$$elmt.find('input[type="text"]').val()}}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/pages/helpers/draftManager",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalMultiButtons","syracuse-tablet/html/js/ui/modals/modalSaveDraft"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),globals=require("syracuse-tablet/html/js/helpers/globals"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalMultiButtons=require("syracuse-tablet/html/js/ui/modals/modalMultiButtons"),modalSaveDraft=require("syracuse-tablet/html/js/ui/modals/modalSaveDraft"),_DraftMgr=function(page){this._page=page,this._draftStatus=null,this._errMsg=null,this.destroy=function(){this._page=null},this.checkBack=function(){var self=this;return self._offlineDraftId?self.offlineDraftAskRemove():!self._page.dao||!self._page.dao.isDirty?$.smResolve(!0):this._pageLoadedFromDraft()?this.save(!1,!1):self.askSaveDraft()},this.askSaveDraft=function(){var self=this,opts={buttons:[],defaultAction:"no"};["drafts.dlog.savedraft.button","no","yes"].forEach(function(act){opts.buttons.push({action:act,label:locale.text(act)})});var modal=new modalMultiButtons.Modal(locale.text("drafts.dlog.savedraft.title"),locale.text("drafts.dlog.savedraft.info"),opts);return modal.show().then(function(result){return result==="drafts.dlog.savedraft.button"?self.save(!1,!0).then(function(saved,draftCtx){return saved===!0}):result!=="no"})},this.save=function(offline,confirm){var self=this,deferred=$.Deferred(),step;return confirm===!0?step=(new modalSaveDraft.Modal(self._comment||"",offline===!0)).show():step=$.smResolve({action:"save",comment:self._comment}),step.then(function(result){return result==null||result.action!="save"?null:self.saveInDB(result.comment,offline)}).then(function(ctx){ctx&&globals.getModal().notify({severityClass:offline?"warning":"success",title:locale.text("drafts.notify.saved"+(offline?".offline":"")),body:offline?locale.text("drafts.notify.saved"):null,delay:offline?"medium":"short"}),deferred.resolve(ctx!=null,ctx)}).fail(function(e){globals.getModal().error(locale.text("drafts.error.saving"),e,function(){deferred.resolve(!1,null)})}),deferred.promise()},this.saveInDB=function(comment,offline){var self=this,uuid=jsutils.getPropByPath(self._page,"dao.data.$uuid");if(!uuid)return $.smReject("Unexpected null uuid");var restoredCtx=self._page.getRestoreContext();restoredCtx.currentState.options["workingCopy-Id"]=null,restoredCtx.currentState.options["draft-id"]=uuid;if(!self._draftSaveLink){var links=self._page.getProtoLinks();Object.keys(links).some(function(key){if(key==="$save")return self._draftSaveLink=links[key],!0})}if(!self._draftSaveLink)return $.smReject("Unexpected $save link not found in prototype");var draftContext={id:uuid,endpoint:globals.getEndpointDescr(),representation:self._page.prototype.data("$representation"),status:offline?"offline":self._draftStatus||"unsavedchanges",errorMsg:self._draftStatus==="error"?self._errMsg:"",title:self._page.prototype.data("$title")||"",comment:comment||"",restoredContext:restoredCtx,dataSet:self._page.dao.data,saveLink:self._draftSaveLink,creation_date:utils.getCurISODateTime(new Date)};return globals.getStorage().draftOperation("draftSave",draftContext)},this.notifDataLoaded=function(refreshed){this.offlineDraftRemove(),this._draftStatus=null,this._errMsg=null,this._page.dao.publishDirty(this._pageLoadedFromDraft(),!0)},this._pageLoadedFromDraft=function(){return this._page._dataLoadedFrom==="draft"},this.notifSaveSucceeded=function(result){return this.offlineDraftRemove(),result&&result.responseJSON&&result.responseJSON.$uuid?globals.getStorage().draftOperation("draftDelete",result.responseJSON.$uuid):$.smResolve()},this.notifSaveFailed=function(result){var self=this,responseJSON=result&&result.responseJSON?result.responseJSON:{};return responseJSON.$noConnectionError===!0?(self.save(!0,self._offlineDraftId==null&&!self._pageLoadedFromDraft()).then(function(saved,draftCtx){saved?(self._offlineDraftId=draftCtx.id,self._page.dao.resetDirty(),self._comment=draftCtx.comment):(self._offlineDraftId=null,self._comment=null)}),!1):(self._offlineDraftId=null,self.offlineDraftRemove(),self._draftStatus="error",self._errMsg=responseJSON&&responseJSON.$diagnoses&&responseJSON.$diagnoses.length>0?responseJSON.$diagnoses[0].$message:0,!0)},this.offlineDraftAskRemove=function(){var self=this,opts={buttons:[],defaultAction:"no"};["cancel","no","drafts.dlog.removeoffline.button"].forEach(function(act){opts.buttons.push({action:act,label:locale.text(act)})});var modal=new modalMultiButtons.Modal(locale.text("drafts.dlog.removeoffline.title"),locale.text("drafts.dlog.removeoffline.info"),opts);return modal.show().then(function(result){return result==="drafts.dlog.removeoffline.button"?self.offlineDraftRemove().always(function(){return self._offlineDraftId=null,"removed"}):result==="cancel"?"cancel":"kept"}).then(function(result){return result==="cancel"?!1:(self._offlineDraftId=null,result==="removed"?!0:self._page.dao.isDirty?self.saveInDB(self._comment,!0).always(function(){return!0}):!0)})},this.offlineDraftRemove=function(){var self=this,deferred=$.Deferred();return self._offlineDraftId?globals.getStorage().draftOperation("draftDelete",self._offlineDraftId).always(function(){self._offlineDraftId=null,deferred.resolve()}):deferred.resolve(),deferred.promise()},this.loadFromDraft=function(draftId){var self=this;return self._comment=null,globals.getStorage().draftOperation("draftRead",draftId).then(function(ctx){var data;return ctx&&ctx.dataSet&&(data=ctx.dataSet,self._comment=ctx.comment,self._draftStatus=ctx.status,self._errMsg=ctx.errorMsg),$.smResolve(data,data!=null?"draft":null)}).fail(function(e){return null})}};exports.Klass=_DraftMgr}),define("syracuse-tablet/html/js/sdata/filterHelper",["require","exports","module","syracuse-tablet/html/js/sdata/sdatawhere/parser"],function(require,exports,module){function _setFilterRightValue(filter){var cp=filter.prop,cv,value=(filter.originalValue||filter.value)==null?"":filter.originalValue||filter.value;switch(cp.$type){case"application/x-password":case"application/x-string":return cv=value.replace(/'/g,"\\'"),filter.operator==="like"?cv="%"+cv+"%":filter.operator==="like_s"&&(cv+="%"),cv="'"+cv+"'",cv;case"application/x-integer":case"application/x-real":case"application/x-decimal":case"application/x-quantity":return value;case"application/x-date":if(!value)return null;return"@"+value+"@";case"application/x-datetime":return"@"+value+"@";case"application/x-time":return null;case"application/x-boolean":return value?"true":"false";case"application/x-choice":return cp.$value&&cp.$value.$type==="application/x-string"?"'"+value.replace(/'/g,"\\'")+"'":value+"";case"application/x-reference":return typeof value!="string"&&(value=filter.value),cv=(value||"").replace(/'/g,"\\'"),cv="'"+cv+"'",cv;default:}return null}var parser=require("syracuse-tablet/html/js/sdata/sdatawhere/parser").Parser;exports.getFilterWhereClause=function(filterInfo){var filterClause="";return filterInfo!=null&&filterInfo.length!=0&&$.each(filterInfo,function(idx,filter){var cf="("+filter.id+" "+(filter.operator==="like_s"?"like":filter.operator)+" "+_setFilterRightValue(filter)+")";filterClause=filterClause.length==0?cf:filterClause+" and "+cf}),filterClause},exports.getSearchClause=function(searchInfo){var searchClause="";return searchInfo&&($.each(searchInfo,function(idx,search){var cf="("+search.id+" "+search.operator+" "+_setFilterRightValue(search)+")";searchClause=searchClause.length==0?cf:searchClause+" or "+cf}),searchClause&&(searchClause="("+searchClause+")")),searchClause},exports.isValidWhere=function(where){try{return parser.parse(where),!0}catch(e){return!1}}}),define("syracuse-tablet/html/js/pages/pageRegular",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/pages/page","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/sdata/sdataDispatcher","syracuse-tablet/html/js/application/appFactory","syracuse-tablet/html/js/application/daoSdata","syracuse-tablet/html/js/sdata/sdataUtils","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/application/eventListener","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/native/native","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/application/gadget","syracuse-tablet/html/js/pages/helpers/draftManager","syracuse-tablet/html/js/pages/helpers/helpers","syracuse-tablet/html/js/helpers/fieldOperators","syracuse-tablet/html/js/application/settings","syracuse-tablet/html/js/sdata/filterHelper","syracuse-tablet/html/js/helpers/dashboardWelcomeUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),Base=require("syracuse-tablet/html/js/pages/page").Page,globals=require("syracuse-tablet/html/js/helpers/globals"),dispatcher=require("syracuse-tablet/html/js/sdata/sdataDispatcher"),factory=require("syracuse-tablet/html/js/application/appFactory"),daoSdata=require("syracuse-tablet/html/js/application/daoSdata"),sdataUtils=require("syracuse-tablet/html/js/sdata/sdataUtils"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),eventListener=require("syracuse-tablet/html/js/application/eventListener"),locale=require("syracuse-tablet/html/js/helpers/locale"),native=require("syracuse-tablet/html/js/helpers/native/native"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),Gadget=require("syracuse-tablet/html/js/application/gadget").Klass,draftMgr=require("syracuse-tablet/html/js/pages/helpers/draftManager"),pageHelpers=require("syracuse-tablet/html/js/pages/helpers/helpers"),fieldOperators=require("syracuse-tablet/html/js/helpers/fieldOperators"),settings=require("syracuse-tablet/html/js/application/settings"),filterHelper=require("syracuse-tablet/html/js/sdata/filterHelper"),dashboardWelcomeUtils=require("syracuse-tablet/html/js/helpers/dashboardWelcomeUtils"),_Page=utils.defineClass(function RegularPage($parent,state,prototype,article,options){options.breadcrumbs==null&&(options.breadcrumbs=!0),Base.call(this,$parent,state,prototype,article,options),this.gadget=this.state.options.gadget?new Gadget(this.state.options.gadget):null,this.openedFromDashboard=this.gadget!=null,this._originalSdataUrl=this.state.options["sdata-url"],this._originalSdataUrl||(this.gadget?this._originalSdataUrl=this.gadget.getSDataUrl(this.prototype):this._originalSdataUrl=this.prototype.data("$url")),this._originalSdataUrl=utils.checkUrlHostAndPort(this._originalSdataUrl),this._initSdataInfo(),this.representation=this.prototype.data("$representation");var url=this.prototype.data("$url"),facet;url&&url.length>0?facet=sdataUtils.parseSDataURL(url).facet:this.parentPage&&(facet=this.parentPage.$facet),facet&&(this.$facet=facet,this.setActivity(facet==="edit"?"edit":facet==="create"?"create":"read")),this.enableWorkingCopy=this.isEditMode()&&native.hasCapability("nativeApp")&&!this.isChild,this._draftEnabled()&&(this._draftMgr=new draftMgr.Klass(this)),notifications.subscribe(this,["sm.rowdetail.update","sm.rowdetail.delete","sm.action.link"],1)},Base,{_draftEnabled:function(){return!this.isEditMode()||this.isChild?!1:this.prototype&&this.prototype.getDataByPath("$links.$save")},pageInitAsync:function(){var self=this;self.pagePrefs={};var step;return self.gadget&&self.gadget.data("pinPageId")!=null?step=dashboardWelcomeUtils.getPinnedPageContext(self.gadget.data("pinPageId")):step=$.smResolve(),step.then(function(savedContextPinnedPage){return savedContextPinnedPage&&(self.state.savedContext=savedContextPinnedPage),self.readPageSettings()}).then(function(){self._init$Filters()})},readPageSettings:function(){var self=this;return $.smResolve().then(function(){return self.getPagePrefsId()}).then(function(pagePrefsId){if(!pagePrefsId)return;return settings.readUserPagePrefs(pagePrefsId)}).then(function(pagePrefs){pagePrefs&&(self.pagePrefs=pagePrefs,self.pagePrefs.isDirty=!1)})},writePageSettings:function(){var self=this;return self.pagePrefs.isDirty?$.smResolve().then(function(){return self.getPagePrefsId()}).then(function(pagePrefsId){if(pagePrefsId)return delete self.pagePrefs.isDirty,settings.writeUserPagePrefs(pagePrefsId,self.pagePrefs)}):$.smResolve()},getPageSettings:function(){return this.pagePrefs},getPagePrefsId:function(){var id=this._originalSdataUrl;if(this.isVignette){var vignette=this.getParentVignette();if(vignette){var vid=vignette.vignetteId;vid&&(id=id+"#"+vid)}}return id},_init$Filters:function(){var savedCtx=this.getSavedContext();savedCtx&&savedCtx.sortInfo&&this.setPageSort(savedCtx.sortInfo),savedCtx&&savedCtx.filterInfo&&this.setPageFilter(savedCtx.filterInfo);var $filterId=savedCtx?savedCtx.$filterId:null;this._$filters=[{id:"nofilter",$title:locale.text("nofilter")}];var auth=this.$filtersGetAuthoring(),filters=$.extend(!0,{},this.prototype.data("$filters"));if(auth==="none"||!filters||$.isEmptyObject(filters)){this._$filtersDisabled=!0;return}var defFilter=null;for(var p in filters){var ttl=this.prototype.resolveExpression(filters[p].$title);if(ttl){var f=$.extend(!0,{},filters[p]);f.$title=ttl,f.id=p,f.$isDefault=!1,$filterId&&f.id===$filterId?defFilter=f:!defFilter&&f.$isDefault===!0&&(defFilter=f),this._$filters.push(f)}}if(this._$filters.length==0)return;defFilter?defFilter.$isDefault=!0:this._$filters[0].$isDefault=!0},_initSdataInfo:function(sdataUrl){sdataUrl||(sdataUrl=this._originalSdataUrl);if(this.gadget){var params=this.gadget.getParameters();params.where&&(sdataUrl=sdataUtils.addWhereClause(sdataUrl,params.where,this.state.options.sdataParameters))}if(!sdataUrl)throw new Error("$url (sDataUrl) is expected");sdataUrl=utils.checkUrlHostAndPort(sdataUrl),this.state.options["sdata-url"]=this.sDataUrl=sdataUrl,this.sDataMethod=this.state.options["sdata-method"]||"GET"},getOriginalSdataUrl:function(){return this._originalSdataUrl},destroy:function(){if(this.destroyed)return;this._draftMgr&&(this._draftMgr.destroy(),this._draftMgr=null);if(this.prototype&&!this.prototype.isLookup()){var keepWorkingCopy=this.enableWorkingCopy===!0&&this.state.options["workingCopy-Id"];!this.isVignette&&!keepWorkingCopy&&!this.isChild?globals.getStorage().draftOperation("wrkcpyDeleteAll"):this.isVignette&&!keepWorkingCopy&&this.dao&&this.dao.workingCopyGetId()&&globals.getStorage().draftOperation("wrkcpyDelete",this.dao.workingCopyGetId())}this.prototype&&this.prototype.acceptServerPagination()&&!globals.isAuthoringActive()&&notifications.publish("sm.authcache.destroy",this.id),Base.prototype.destroy.call(this),this._editTemplatesPanel&&(this._editTemplatesPanel.destroy(),this._editTemplatesPanel=null),this.gadget=null},isSamePage:function(state){return Base.prototype.isSamePage.call(this)&&state&&state.options&&state.options["sdata-url"]===this.sDataUrl},initOnLoad:function(){},beforeAddContent:function(){},afterRender:function(loadOptions,buildOpts){var self=this;return Base.prototype.afterRender.call(self,loadOptions,buildOpts).then(function(){if(self.isVignette)return;var diags=self.dao&&self.dao.data&&self.dao.data.$diagnoses;diags&&diags.length>0&&diags.forEach(function(diag){var notify={severityClass:globals.X3_SEVERITY_TO_BS[diag.$severity]||diag.$severity||"error",title:diag.$message};globals.getModal().notify(notify)})})},activate:function(pageToClose,cb){Base.prototype.activate.call(this,pageToClose,cb),notifications.publish("sm.data.freshness.change",this.dao.dataFreshness())},getOpenLinkAttrs:function(){var res=Base.prototype.getOpenLinkAttrs.call(this);return res["data-sdata-url"]=this.sDataUrl,res["data-sdata-method"]=this.sDataMethod,res["data-gadget-id"]=this.gadget.data("$uuid"),res},refresh:function(options,callBackInterface){var self=this;options=options||{};var deferred=$.Deferred(),url=options["sdata-url"],controlId=options.controlId,type=options.type||"",force=type==="filtersort"||options.forceRefresh===!0,_wait=function(status){var meth="waitWheel"+status.smCapitalize();if(callBackInterface){callBackInterface[meth]&&callBackInterface[meth].call(null,controlId);return}if(self[meth]){self[meth].call(self,controlId);return}};try{var _succeeded=function(){_wait("stop"),self.refreshControls(controlId?[controlId]:null,options),deferred.resolve()};!url&&force!==!0?_succeeded():(_wait("start"),url&&self._initSdataInfo(url),self.loadData({refresh:!0}).then(function(){_succeeded()}).fail(function(e){_wait("stop"),deferred.reject(e)}))}catch(e){deferred.reject(e)}finally{return deferred.promise()}},_getFullSdataUrl:function(){return this._filterSortAllowed()?this._filterSortUpdateUrl():this.sDataUrl},getRestoreContext:function(reason){var ctx=Base.prototype.getRestoreContext.call(this,reason);return ctx?($.isEmptyObject(this.state.options.sdataParameters)||(ctx.currentState.options.sdataParameters=this.state.options.sdataParameters),ctx.currentState.options["sdata-url"]=this.sDataUrl,this.dao&&reason==="nativeAppClosing"&&this.enableWorkingCopy===!0&&(ctx.currentState.options["workingCopy-Id"]=this.dao.workingCopyGetId(!0)),ctx):ctx},savedCtxCreate:function(type){var ctx=Base.prototype.savedCtxCreate.call(this,type),$f=this._$filterGetInfo();$f&&$f.id&&(ctx.$filterId=$f&&$f.id);if(type!="link"||!this._filterSortAllowed())return ctx;var sortInfo=this.getPageSort();sortInfo&&sortInfo.some(function(i){if(i.sort!="none")return!0})&&(ctx.sortInfo=sortInfo);var filterInfo=this.getPageFilter();return filterInfo!=null&&filterInfo!="nofilter"&&(ctx.filterInfo=filterInfo),ctx},loadData:function(loadOptions){var self=this;loadOptions=loadOptions||{};var step,enableWorkingCopy=this.enableWorkingCopy===!0;return loadOptions.reload!==!0&&this.state.options["draft-id"]&&self._draftMgr?step=self._draftMgr.loadFromDraft(this.state.options["draft-id"]):enableWorkingCopy?step=self.loadCheckWorkingCopy(loadOptions):step=$.smResolve(null),step.then(function(data,loadedFrom){return data?$.smResolve(data,loadedFrom):self.loadFromSData(loadOptions)}).then(function(data,loadedFrom){if(self.destroyed)return;data=self._processSdataParams(data),self._dataLoadedFrom=loadedFrom,self.setDao(data?factory.createDaoSdata(data,self.prototype,{enableWorkingCopy:enableWorkingCopy}):self.getEmptyDao(self.prototype)),loadOptions.refresh===!0&&notifications.publish("sm.data.freshness.change",self.dao.dataFreshness()),loadedFrom==="workingCopy"&&self.dao.setDirty(),loadedFrom==="draft"&&(self.state.options["draft-id"]=null),self._draftMgr&&self._draftMgr.notifDataLoaded()})},_processSdataParams:function(data){if(this.$activity!=="create"||this.gadget==null)return data;var params=this.gadget.getParameters();if(!params||!params.context)return data;if($.isEmptyObject(this.state.options.sdataParameters))return data;var ctx={},prop,val,suffix,fldName;for(var p in params.context)fldName=p+"_REF",prop=this.prototype.property(fldName),prop&&(val=utils.parseExpression(params.context[p],this.state.options.sdataParameters),prop.$type==="application/x-reference"?(ctx[fldName]={$value:val},ctx[p]=val):(val=fieldOperators.checkValue(prop.$type,val),ctx[p]=val));return $.isEmptyObject(ctx)?data:$.extend(data,ctx)},getLinksInitStatus:function(){var self=this;if(!self.dao||self.destroyed)return $.smResolve(null);var res={dirtyDao:{isDirty:self.dao.isDirty||self._dataLoadedFrom==="draft",$uuid:self.dao.data.$uuid}};return globals.getStorage().templateOperation("count",globals.getEndpoint(),self.representation).then(function(count){return res.editTemplates={count:count},res})},loadCheckWorkingCopy:function(loadOptions){if(loadOptions.reload===!0)return this.dao&&this.dao.workingCopyGetId()&&globals.getStorage().draftOperation("wrkcpyDelete",this.dao.workingCopyGetId()),$.smResolve(null);if(this.state.options["workingCopy-Id"]){var id=this.state.options["workingCopy-Id"];return this.state.options["workingCopy-Id"]=null,globals.getStorage().draftOperation("wrkcpyRead",id).then(function(data){return $.smResolve(data,data!=null?"workingCopy":null)})}return $.smResolve(null)},loadFromSData:function(loadOptions){var self=this,forceUseCache=loadOptions.updateLayout||utils.forceUseCache(),dispatchOptions={forceUseCache:forceUseCache};return self.prototype.acceptServerPagination()&&(dispatchOptions.$authCacheId=self.id),dispatcher.dispatch({$url:self._getFullSdataUrl(),$method:self.sDataMethod},null,dispatchOptions).then(function(data){return forceUseCache||globals.setOffline(data!=null&&(data.$cache!=null||data.$cacheHint!=null)),$.smResolve(data,"sdata")})},notifLookupSelection:function(rowData,controlId){if(!this.isActive())return;Base.prototype.notifLookupSelection.call(this,rowData,controlId)},notifActionLink:function(success,link,result,options){var self=this;if(!self.isActive())return;try{result=result||{},result.responseJSON=result.responseJSON||{};var _displayMessage=function(thereIsFieldErrors){if(thereIsFieldErrors===!0&&success===!0)return;globals.getModal().displayActionMsg(success,link.name,self.prototype,result.responseJSON)};switch(link.name){case"$save":self._doActSave(success,link,result,options);break;case"$delete":self.goBack().always(function(){_displayMessage()});break;case"$canceledit":self.checkBack().then(function(kontinue){if(kontinue!=1)return;self.dao.resetDirty();var autoScroll=self.getScrollValue();self.goBack().then(function(newPage){if(newPage==null||self._dataLoadedFrom==="draft")return;setTimeout(function(){newPage.autoScroll(autoScroll*.8)})})});break;case"$showtemplates":this._editTemplatesPanel||(this._editTemplatesPanel=this.panelCreate(globals.PANELEDITTEMPLATES,{fromActionMgrUUID:options.fromActionMgrUUID})),this.panelAttach("right",this._editTemplatesPanel,"toggle");break;default:var thereIsFieldErrors=!1;link.$isAction===!0&&result.responseJSON&&(thereIsFieldErrors=self._myApplyChange(result.responseJSON));var settings=self.actionGetSettings(link.name,"options");success===!0&&settings&&settings.backIfSuccess===!0?self.goBack().then(function(){_displayMessage(thereIsFieldErrors)}):settings&&settings.refreshPage===!0?self.refresh({forceRefresh:!0}).then(function(){_displayMessage(thereIsFieldErrors)}):_displayMessage(thereIsFieldErrors)}}catch(e){globals.getModal().error("notifActionLink failed",e)}},_myApplyChange:function(responseJSON){this.dao.applyChange(responseJSON,{$isPartialDelta:!1,$isEditMode:this.isEditMode()});var errors=this.refreshControls(null,{refreshValue:!0});return errors.length>0&&errors[0].setFocus(),this._gestureMgr&&this._gestureMgr.adjust(),errors.length>0},validateBeforeActionLink:function(link){return link?link.$method!=="POST"&&link.$method!=="PUT"?!0:this.checkControlsData():!0},_doActSave:function(success,link,result,options){var self=this;if(success){self.dao.resetDirty();var step;self._draftMgr?step=self._draftMgr.notifSaveSucceeded(result):step=$.smResolve(),step.always(function(){self.openedFromDashboard&&self.$activity==="create"?(globals.getModal().displayActionMsg(success,link.title||link.name,self.prototype,result.responseJSON),self.reload()):self.goBack().always(function(dstPage){globals.getModal().displayActionMsg(success,link.title||link.name,self.prototype,result.responseJSON),dstPage&&dstPage.$activity==="create"&&dstPage.reload()})})}else{if(self.dao.updateMeta(result.responseJSON)){var errors=self.refreshControls(null,{});errors.length>0&&errors[0].setFocus(),self._gestureMgr&&self._gestureMgr.adjust()}(self._draftMgr==null||self._draftMgr.notifSaveFailed(result))&&globals.getModal().actionResult(locale.text("action.save.failed"),result.responseJSON)}},scrollAllowed:function(){return this.prototype.isQueryLikeFacet()?!1:!0},notifRowdetailUpdate:function(info,arrayId){if(!info)return;var childDao=info.dao;if(!childDao)return;var array=this.getControl(arrayId);if(!array)return;var create=info.activity==="create",singleArrayRowIdx;!create&&array.prototype.isSingleArray()&&(singleArrayRowIdx=array.rowId2Idx(childDao.getValue("$uuid")));if(childDao.updateParentRow(create,singleArrayRowIdx)){var errors=this.refreshControls([arrayId],{});errors.length>0&&errors[0].setFocus()}childDao.destroy(!0)},notifRowdetailDelete:function(data,arrayId){if(!data||!data.uuid)return;var array=this.getControl(arrayId);if(!array)return;var rowidOrIdx=data.uuid;array.prototype.isSingleArray()&&(rowidOrIdx=array.rowId2Idx(data.uuid)),this.dao.deleteRow(array.$bind,rowidOrIdx),array.removeRow(data.uuid)},getPinPageId:function(){return this.state.name+"_"+this.sDataUrl},getPinPageData:function(){var self=this,pageData=Base.prototype.getPinPageData.call(self);pageData.sDataUrl=self.sDataUrl,pageData.key=self.prototype.data("$key",self.dao);var pu=jsutils.parseURL(pageData.sDataUrl),repr=pu.query.representation.split(".");pageData.representation=repr[0],pageData.facet=repr[1],pageData.action=repr[1];var ps=pu.path.split("/");pageData.entity=ps[5],pageData.endpoint=pu.path.split("/").slice(2,5).join(".");var value=self.prototype.data("$value",self.dao);return value&&(pageData.title=self.prototype.data("$title")+" - "+value),pageData},searchRefresh:function(){this.refreshPageFilterAndSort()},searchInfoRead:function(){if(!this._filterSortAllowed())return;var field=this.getControlByBind("$resources");if(!field||!field.searchInfoGet)return null;var info=field.searchInfoGet();return info==null||info.length==0?null:info},getPageSort:function(){return this._filterSortAllowed()?this.pagePrefs&&this.pagePrefs.sort:null},getPageFilter:function(){return this._filterSortAllowed()?this.pagePrefs&&this.pagePrefs.filter:null},setPageSort:function(sort){this._filterSortAllowed()||(sort=null);var old=this.getPageSort();if(sort==null&&old==null)return;var changed=old==null||sort==null||old.length!=sort.length;changed=changed||sort.some(function(val,idx){return sort[idx].sort!==old[idx].sort||sort[idx].field!==old[idx].field}),changed&&(this.pagePrefs.sort=sort,this.pagePrefs.isDirty=!0)},setPageFilter:function(filter){this._filterSortAllowed()||(filter=null);var old=this.getPageSort();if(old==null&&filter==null)return;this.pagePrefs.filter=filter,this.pagePrefs.isDirty=!0},refreshPageFilterAndSort:function(){if(!this._filterSortAllowed())return;var ctrlArray=this.getControlByBind("$resources");if(!ctrlArray)return;var attrs={"data-control-id":ctrlArray.id,"data-nav-target":this.isVignette?"vignette":"application","data-nav-type":"filtersort"};this._initSdataInfo(null),eventListener.triggerRefreshPage(ctrlArray.$$elmt,attrs)},_filterSortAllowed:function(){return this.prototype.isLookup()||this.prototype.isQuery()},_filterSortUpdateUrl:function(){var self=this,sdataUrl=jsutils.parseURL(self.sDataUrl),$f=this._$filterGetInfo();$f&&(sdataUrl.query||(sdataUrl.query={}),$f.id==="nofilter"?delete sdataUrl.query.filter:sdataUrl.query.filter=$f.id);if(!self._filterSortAllowed())return jsutils.urlToString(sdataUrl);var sortClause=null,info=self.getPageSort();info!=null&&info.length!=0&&info.some(function(i){if(i.sort!="none")return sortClause={order:i.sort,field:i.id},!0});var filterMsg=!1;info=self.getPageFilter();var filterClause=filterHelper.getFilterWhereClause(info);filterHelper.isValidWhere(filterClause)||(filterClause=null,filterMsg=!0);var searchInfo=self.searchInfoRead(),searchClause=filterHelper.getSearchClause(searchInfo);filterHelper.isValidWhere(searchClause)||(searchClause=null,filterMsg=!0);if(filterMsg){var notify={severityClass:"warning",title:locale.text("error.filter.invalid")};globals.getModal().notify(notify)}if(!sortClause&&!filterClause&&!searchClause)return jsutils.urlToString(sdataUrl);if(sortClause&&sdataUrl.query.key==null){var old=sdataUrl.query.orderBy;sdataUrl.query.orderBy=sortClause.field+" "+sortClause.order,old&&(sdataUrl.query.orderBy=", "+old)}if(filterClause&&sdataUrl.query.key==null){var old=sdataUrl.query.where;sdataUrl.query.where=filterClause,old&&(sdataUrl.query.where=old+" and "+sdataUrl.query.where)}if(searchClause&&sdataUrl.query.key==null){var old=sdataUrl.query.where;sdataUrl.query.where=searchClause,old&&(sdataUrl.query.where=old+" and "+sdataUrl.query.where)}return jsutils.urlToString(sdataUrl)},_$filterGetInfo:function(){if(this.$filtersGet().length===0||this._$filtersDisabled===!0)return null;var f=null;return this.$filtersGet().some(function(x){if(x.$isDefault===!0)return f=x,!0}),f},$filtersGet:function(){return this._$filters},$filtersSelect:function(filterId){if(!this._$filters)return;this._$filtersDisabled=!1,this._$filters.forEach(function(f){f.$isDefault=!1,filterId===f.id&&(f.$isDefault=!0)}),this.refreshPageFilterAndSort()},$filtersGetAuthoring:function(){var c=this.getControlByBind("$resources");return c&&c.$filtersGetAuthoring?c.$filtersGetAuthoring():null},setDao:function(dao){Base.prototype.setDao.call(this,dao),this._multiSelectionLinks=this._protoLinks=this._toolbarLinks=null},getMultiSelectionLinks:function(){var self=this;if(!self.prototype.isQuery())return null;if(self._multiSelectionLinks==null){self._multiSelectionLinks=[];var $links=self.getProtoLinks(),info,link;if($links){var actSettings;$.each($links,function(name,value){if(!pageHelpers.checkLink(name,value)||value.$url==null||value.$url.length==0)return;actSettings=self.actionGetSettings(name);if(actSettings==null||actSettings.options!=null&&actSettings.options.multiselection!==!0)return;info=$.extend({},link,value),info.css=(info.css||"")+" s-m-ismultisel",actSettings&&actSettings.icon!=null&&(info.icon=actSettings.icon.css),self._multiSelectionLinks.push(info)})}}return self._multiSelectionLinks.length==0?null:self._multiSelectionLinks},hasFooterHeaderActions:function(onlyFooterHeader){var tl=this.getToolbarLinks(globals.getSiteLayout().getDeviceType()==="smartphone"?"header":"footer");if(tl.length===0)return!1;if(onlyFooterHeader===!0){for(var i=0;i<tl.length;i++)if(tl[i].footerHeader===!0)return!0;return!1}return tl.length>0},getProtoLinks:function(){var self=this;if(self._protoLinks==null){var $links=$.extend(!0,{},self.prototype.data("$links",null,!0),self.dao?self.dao.getValue("$links"):null);self._protoLinks={};var info,sdataInfo;if(this.prototype.isQuery()){var queryLinks=this.prototype.getDataByPath("$properties.$resources.$item.$links");queryLinks&&$.extend(!0,$links,queryLinks)}$.each($links,function(name,info){if(!pageHelpers.checkLink(name,info))return;info.name=name,info.title=info.$title?self.prototype.resolveExpression(info.$title):"",info.icon=fontUtils.getIconByName(name);if(info.$type==null||info.$type.length!==0||info.$type==="application/json;vnd.sage=syracuse"){if(info.$url){info.$parameters&&$.each(info.$parameters,function(paramName,paramValue){if(paramValue.indexOf("{")>-1&&self.dao){var pv2=self.prototype.resolveExpression(paramValue,self.dao);pv2&&pv2.length>0?paramValue=encodeURIComponent(pv2):paramValue=encodeURIComponent(paramValue)}info.$url=info.$url.replace("{"+paramName+"}",paramValue)});var urlParsed=self.prototype.resolveExpression(info.$url,self.dao,!1,!0);if(urlParsed.indexOf("/mobile1/")>-1){sdataInfo=sdataUtils.getLinkInfo(info.$url,self.dao,!0);if(!sdataInfo)return;$.extend(info,sdataInfo),info.$services&&(info.$isAction=!0)}else info.externalUrl=info.$url}else info.$isAction=!0;info.$uuid==null&&(info.$uuid=utils.UUID()),info.css=info.css||[],info.$isHidden===!0&&info.css.push("hidden"),info.$isDisabled===!0&&info.css.push("disabled"),info.css=info.css.join(" "),self._protoLinks[name]=info;return}})}if(arguments.length==0)return $.isEmptyObject(self._protoLinks)?null:self._protoLinks;var res;for(var i=0;i<arguments.length;i++)self._protoLinks[arguments[i]]&&(res==null&&(res={}),res[arguments[i]]=self._protoLinks[arguments[i]]);return res},getToolbarLinks:function(toolbar,options){var self=this;options=options||{};if(!self.dao)return[];self._toolbarLinks==null&&(self._toolbarLinks={});var device=globals.getSiteLayout().getDeviceType(),facet=self.prototype.getFacet(),key=toolbar+device+facet;if(self._toolbarLinks[key])return self._toolbarLinks[key];var links=self._toolbarLinks[key]=[],$links=self.getProtoLinks();if($links){var lMap=pageHelpers.getLinkMap(toolbar,device,facet),authSettings,forceFooterHeader;$.each($links,function(name,value){authSettings=self.actionGetSettings(name)||{},$.isEmptyObject(authSettings)||(value=$.extend(!0,{},value),authSettings.icon!=null&&(value.icon=authSettings.icon.css),value.footerHeader=authSettings.options!=null&&authSettings.options.footerHeader===!0);if(authSettings.options&&authSettings.options.multiselection===!0)return;forceFooterHeader=value.footerHeader&&device!=="smartphone";if(forceFooterHeader!==!0&&toolbar!=="actionpanel"&&!lMap[name])return;if(toolbar==="actionpanel"&&pageHelpers.excludeFromPanel(name,forceFooterHeader,value,facet))return;links.push(value)})}return links},getEmptyDao:function(proto){return daoSdata.emptyDao(proto)},checkBack:function(){return this._draftMgr?this._draftMgr.checkBack():$.smResolve(!0)}});exports.Page=_Page}),define("syracuse-tablet/html/js/pages/pageRequest",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/pages/pageRegular"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/pages/pageRegular").Page,_hideUnusedFields=function(proto){var props=proto.data("$properties");if(!props)return proto;for(var p in props)props[p].$isExcluded=p!=="$resources";return proto},_Klass=utils.defineClass(function RequestPage($parent,state,prototype,article,options){Base.call(this,$parent,state,_hideUnusedFields(prototype),article,options)},Base,{getPagePrefsId:function(){var id="";if(this.isVignette&&!this.destroyed){var vignette=this.getParentVignette();if(vignette&&!vignette.destroyed){id+=vignette.controller.state.dashboardName||vignette.controller.state.name;var vid=vignette.vignetteId;vid&&(id=id+"#"+vid)}}return id},destroy:function(){Base.prototype.destroy.call(this)}});exports.Page=_Klass}),define("syracuse-tablet/html/js/pages/pageRowDetail",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/pages/pageRegular"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/pages/pageRegular").Page,_Page=utils.defineClass(function RowDetailPage($parent,state,prototype,article,parentPage,options){this.parentPage=parentPage,this.parentPage.state.type==="rowdetail"?this.mainPageId=this.parentPage.mainPageId:this.mainPageId=this.parentPage.state.uuid;if(!this.parentPage)throw new Error("rowdetail page - Unexpected empty parent page");Base.call(this,$parent,state,prototype,article,options),this.setActivity(this.parentPage.$activity),this.enableWorkingCopy=!1},Base,{_initSdataInfo:function(sdataUrl,sdataMethod){},destroy:function(){if(this.destroyed)return;Base.prototype.destroy.call(this),this.parentPage=null,this._notifData=null,this._originalDao&&(this._originalDao.destroy(),this._originalDao=null)},isEditMode:function(){return this.parentPage&&this.parentPage.isEditMode()},buildHtmlOption:function(loadOptions){return Base.prototype.buildHtmlOption.call(this,loadOptions).then(function(opts){return opts.toolBars.showHome=!0,opts.toolBars.showAuthoring=!1,opts})},_actHome:function(){if(!this.parentPage)return;if(this.isVignette)this.getParentVignette().goHome();else{var self=this;globals.getApplication().goBack(function(state){return state.uuid===self.mainPageId})}},loadData:function(loadOptions){if(loadOptions.reload){if(!this._originalDao)return;return this.setDao(this._originalDao.clone()),$.smResolve()}var ctrl=this.parentPage.getControl(this.state.options.controlId);if(!ctrl)throw new Error("rowdetail page - Array datasource not found");var info=ctrl.rowDetailGetInfo();if(!info.dao)throw new Error("rowdetail page - Row data not found");return this.setActivity(info.activity),this.$activity!=="read"?(this._originalDao=info.dao,this.setDao(info.dao.clone())):this.setDao(info.dao),this.singleArrayRowIdx=info.singleArrayRowIdx,$.smResolve()},notifActionLink:function(success,link,result,options){switch(link.name){case"$save":this._doActSave(success,link,options);break;case"$delete":this._doActDelete(success,link,options);break;case"$canceledit":this.goBack();break;default:Base.prototype.notifActionLink.call(this,success,link,result,options)}},validateBeforeActionLink:function(link){return this.checkControlsData()},_doActSave:function(success,link,responseJSON,options){success&&(this.dao.checkArrayUpdateError(),this._notifData={notifId:"sm.rowdetail.update",notifData:{dao:this.dao,activity:this.$activity,singleArrayRowIdx:this.singleArrayRowIdx}},this.dao=null,this.prototype=null,this.goBack())},_doActDelete:function(success,link,responseJSON,options){this._notifData={notifId:"sm.rowdetail.delete",notifData:{uuid:this.dao.getValue("$uuid")}},this.goBack()},getParentNotif:function(){if(this._notifData)return this._notifData.parentId=this.state.options.parentId,this._notifData.controlId=this.state.options.controlId,this._notifData}});exports.Page=_Page}),define("syracuse-tablet/html/js/controls/chart/chartsUtils",["require","exports","module"],function(require,exports,module){var _getChartDetailArticle=function(opt,$bind,chartArticle,arrayArticle){opt=opt||{},opt.display=opt.display||"bothSideToSide",opt.style=opt.style||(chartArticle?chartArticle.$style:"bar"),chartArticle?chartArticle=$.extend(!0,{},chartArticle):chartArticle={$bind:$bind,$forceArray:!1,$isTitleHidden:!0,$arrayOptions:{}},chartArticle.$display||(chartArticle.$display="chart"),chartArticle.$arrayOptions=chartArticle.$arrayOptions||{},chartArticle.$arrayOptions.showPagination=opt.display==="chartOnly",arrayArticle?arrayArticle=$.extend(!0,{},arrayArticle):arrayArticle={$bind:$bind,$forceArray:!0,$isTitleHidden:!0,$arrayOptions:{}},arrayArticle.$display||(arrayArticle.$display="table"),arrayArticle.$arrayOptions||(arrayArticle.$arrayOptions={},arrayArticle.$arrayOptions.showPagination=!0);var res;chartArticle.$isHidden=arrayArticle.$isHidden=!1;switch(opt.display){case"chartOnly":arrayArticle.$isHidden=!0,res={$layoutType:"stack",$items:[{$layoutType:"row",$items:[chartArticle,arrayArticle]}]};break;case"arrayOnly":chartArticle.$isHidden=!0,res={$layoutType:"stack",$items:[{$layoutType:"row",$items:[arrayArticle,chartArticle]}]};break;case"bothStacked":res={$layoutType:"stack",$items:[{$layoutType:"row",$items:[chartArticle,arrayArticle]}]};break;default:res={$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthAll:"6",$sameSize:!0,$bgColor:"transparent",$items:[chartArticle]},{$layoutType:"cell",$widthAll:"6",$sameSize:!0,$bgColor:"transparent",$items:[arrayArticle]}]}]}}return chartArticle.$style=opt.style,res.$display=opt.display,res},_getChartDetailArticlePropertyName=function(level){return level>1?"$chartDetail_"+level:"$chartDetail"};exports.getChartDetailArticlePropertyName=_getChartDetailArticlePropertyName,exports.getChartDetailArticle=_getChartDetailArticle}),define("syracuse-tablet/html/js/pages/pageChartDetail",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/pages/pageRegular","syracuse-tablet/html/js/controls/ctrlFactory","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/controls/chart/chartsUtils","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/pages/pageRegular").Page,ctrlFactory=require("syracuse-tablet/html/js/controls/ctrlFactory"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),chartsUtils=require("syracuse-tablet/html/js/controls/chart/chartsUtils"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_Page=utils.defineClass(function ChartDetailPage($parent,state,prototype,article,parentPage,options){globals.isAuthoringActive()&&(options.header=!1,options.footer=!1,options.breadcrumbs=!1),options.topToolbar=!0,article.$display||(article.$display="bothSideToSide"),this.parentPage=parentPage;if(!this.parentPage)throw new Error("chartdetail page - Unexpected empty parent page");Base.call(this,$parent,state,prototype,article,options),this._mainParentPage=this._findMainPage()},Base,{getPagePrefsId:function(){return null},destroy:function(){if(this.destroyed)return;Base.prototype.destroy.call(this),this.parentPage=null,this._notifData=null},createPageControl:function(id){return id==="topToolbar"?globals.isAuthoringActive()?null:ctrlFactory.createPageControl("topToolbarChartDetail",this):ctrlFactory.createPageControl(id,this)},buildHtmlOption:function(loadOptions){return loadOptions&&(loadOptions.updateLayout=this.state.level!=null&&this.state.level>1?!1:!0),Base.prototype.buildHtmlOption.call(this,loadOptions).then(function(opts){return $.extend(!0,{},opts,{toolBars:{showAuthoring:!1,showUserMenuLinks:!0,showHome:!0,showActions:!1,statusPinPage:!1}})})},afterRender:function(loadOptions,buildOpts){var self=this;return Base.prototype.afterRender.call(this,loadOptions,buildOpts).then(function(){var chart=self.getChart(),array=self.getArray();chart&&chart.article.$isHidden===!1&&array&&array.article.$isHidden===!1&&array.paginAddSynchro(chart)})},activated:function(){var opts={display:this.article.$display,style:this.getChart().article.$style};notifications.publish("sm.chartdetail.updt.toolbar",opts)},getParentNotif:function(){return this._notifData?{parentId:this.state.options.parentId,controlId:this.state.options.controlOriginId||this.state.options.controlId,notifId:"sm.updt.chart.detail.article",notifData:this._notifData}:this.parentPage&&this.parentPage.isVignette?{notifId:"sm.updt.chart.dashboard",notifData:this.state.options.parentId}:null},scrollAllowed:function(){return!0},getChart:function(){return this._findArrayCtrl(!0)},getArray:function(){return this._findArrayCtrl(!1)},getControl:function(controlId){var control=this._controlsMap&&this._controlsMap[controlId];return control?control:this.parentPage?this.parentPage.getControl(controlId):null},_findArrayCtrl:function(chartDisplay){var self=this,res;return this.forEachControl(function(id,ctrl){if(jsutils.isInstanceOf(ctrl,"CtrlArrayChart")&&(chartDisplay?ctrl.isHighChart():!ctrl.isHighChart()))return res=ctrl,!0}),res},_actSaveChartDetail:function(){this._notifData={},this._notifData.article=$.extend(!0,{},this.article),this._notifData.level=this.state.level==null?0:this.state.level,globals.getApplication().goBack()},_setDisplay:function(){var chart=this.getChart(),array=this.getArray();if(!chart||!array)return!1;var prefs=this._getChartDetailPrefs(),opts={display:prefs.display,style:prefs.style},article=chartsUtils.getChartDetailArticle(opts,chart.$bind,chart?chart.article:null,array?array.article:null);for(var p in this.article)p!="$layoutType"&&p!="$items"&&(article[p]=this.article[p]);var self=this,pagingInfo;return array&&array.article.$isHidden===!0?pagingInfo=chart.paginGetInfo():pagingInfo=array.paginGetInfo(),Base.prototype.authUpdateLayout.call(this,article).then(function(){notifications.publish("sm.chartdetail.updt.toolbar",opts),pagingInfo&&pagingInfo.currentIdx>0&&(self.getChart().paginSetInfo(pagingInfo),self.getArray().paginSetInfo(pagingInfo))}),!0},_findMainPage:function(){var parent=this.parentPage;while(jsutils.isInstanceOf(parent,"ChartDetailPage"))parent=parent.parentPage;return parent},_getChartDetailPrefs:function(){var settings=this._mainParentPage.getPageSettings(),levelSettings=settings.chartDetail&&settings.chartDetail[this.state.level];return levelSettings||{}},_setChartDetailPrefs:function(prefs){var settings=this._mainParentPage.getPageSettings();settings.chartDetail=settings.chartDetail||{},settings.chartDetail[this.state.level]=prefs,settings.isDirty=!0},actToolbarSetDisplay:function(opts){this._setChartDetailPrefs(opts),this._setDisplay(),this._mainParentPage.writePageSettings().then(function(){})}});exports.Page=_Page}),define("syracuse-tablet/html/js/pages/pageCardDesign",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/pages/pageRegular","syracuse-tablet/html/js/application/daoSdata"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/pages/pageRegular").Page,daoSdata=require("syracuse-tablet/html/js/application/daoSdata"),_Page=utils.defineClass(function CardDesignPage($parent,state,prototype,article,parentPage,options){options.header=!1,options.footer=!1,options.breadcrumbs=!1;if(!parentPage)throw new Error("carddesign page - Unexpected empty parent page");this.parentPage=parentPage,Base.call(this,$parent,state,prototype,article,options)},Base,{_initSdataInfo:function(sdataUrl,sdataMethod){},destroy:function(){if(this.destroyed)return;Base.prototype.destroy.call(this),this.parentPage=null,this._notifData=null,this._row=null},buildHtmlOption:function(loadOptions){return Base.prototype.buildHtmlOption.call(this,loadOptions).then(function(opts){return opts.toolBars.showHome=!0,opts.cardDesign=!0,opts})},isEditMode:function(){return!1},loadData:function(loadOptions){var ctrl=this.parentPage.getControl(this.state.options.controlId);if(!ctrl)throw new Error("cardDesign page - Array datasource not found");var dao;return ctrl.getArrayData()&&ctrl.getArrayData().$resources.length>0?(this._row||(this._row=ctrl.getRowById(ctrl.$$elmt.find(".s-m-record.s-m-auth-rec-selected").attr("data-params")),this._row=this._row?this._row.row:ctrl.getArrayData().$resources[0],this._row=$.extend(!0,{},this._row.data)),dao=new daoSdata.Dao(this._row,this.prototype,{parent:null,$bind:"carddesign"})):dao=ctrl.getArrayEmptyRow(this,ctrl.prototype,"carddesign",ctrl.getDao()),this.setDao(dao),$.smResolve()},getParentNotif:function(){return this._notifData?{parentId:this.state.options.parentId,controlId:this.state.options.controlId,notifId:"sm.updt.card.article",notifData:this._notifData}:null},_actSaveCardDesign:function(){this._notifData={},this._notifData.article=$.extend(!0,{},this.article),globals.getApplication().goBack()}});exports.Page=_Page}),define("syracuse-tablet/html/js/pages/pageLookup",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/pages/pageRegular"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/pages/pageRegular").Page,_noDataHtml='	<br><br><br>					<h3 class="alert alert-info" style= "text-align:center" role="alert">					No data					</h3>					<br>					<div  style= "font-size:xx-large;text-align:center">					<a draggable="false" href="#" data-action="lookupBack" class="fa fa fa-arrow-circle-o-left" style="display: inline-block;"/>					</div>',_Page=utils.defineClass(function LookupPage($parent,state,prototype,article,options){options.footer=!1,Base.call(this,$parent,state,prototype,article,options),this.selectedRowJson=null},Base,{destroy:function(){if(this.destroyed)return;Base.prototype.destroy.call(this),this.selectedRowJson=null},buildHtmlOption:function(loadOptions){return Base.prototype.buildHtmlOption.call(this,loadOptions).then(function(opts){return opts.toolBars.showBack=!0,opts})},notifSelectRow:function(arrayId,rowId,data){if(!data)return;this.selectedRowJson=data,this._actLookupBack()},afterRender:function(loadOptions,buildOpts){var self=this;return Base.prototype.afterRender.call(self,loadOptions,buildOpts).then(function(){var c=self.forEachControl(function(id,c){return c.$type==="application/x-array"});c&&c.isEmpty==1&&self.$$elmt.html(_noDataHtml)})},getParentNotif:function(){return this.selectedRowJson?{parentId:this.state.options.parentId,controlId:this.state.options.controlId,notifId:"sm.lookup.selection",notifData:this.selectedRowJson}:null},_actLookupBack:function(){this.goBack()}});exports.Page=_Page}),define("syracuse-tablet/html/js/pages/pageHtml",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/helpers/prototype","syracuse-tablet/html/js/pages/page"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),prototype=require("syracuse-tablet/html/js/helpers/prototype"),Base=require("syracuse-tablet/html/js/pages/page").Page,_Page=utils.defineClass(function HtmlPage($$parent,state,options){Base.call(this,$$parent,state,prototype.create(state.$prototype),state.$article,options)},Base,{afterRender:function(loadOptions,buildOpts){var self=this;return Base.prototype.afterRender.call(self,loadOptions,buildOpts).then(function(){self.$$htmlRoot=self.rootLayout.$$elmt,self.appendHtml(self.$$htmlRoot,buildOpts)}).then(function(){uiUtils.triggerResizeInternal()})},appendHtml:function($$parent,buildOpts){}});exports.Page=_Page}),define("syracuse-tablet/html/js/init/initLogin",["require","exports","module","syracuse-tablet/html/js/application/authentication","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/init/initContext","syracuse-tablet/html/js/helpers/native/native","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/sdata/sdataCommonResources"],function(require,exports,module){var auth=require("syracuse-tablet/html/js/application/authentication"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),globals=require("syracuse-tablet/html/js/helpers/globals"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),initContext=require("syracuse-tablet/html/js/init/initContext"),native=require("syracuse-tablet/html/js/helpers/native/native"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("initLogin",!1),sdataCommonRes=require("syracuse-tablet/html/js/sdata/sdataCommonResources"),_readRestoredContext=function(fromInitProcess){var nativeVoiceCommands=native.getModule("voiceCommands");if(fromInitProcess&&nativeVoiceCommands&&nativeVoiceCommands.hasPendingCommand("openBookmark"))return $.smResolve();var ctxUuid=jsutils.getUrlContextId(),step;return ctxUuid?step=sdataCommonRes.readSharedContext(ctxUuid):step=$.smResolve(),step.then(function(urlCtxToRestore){var nativeApp=native.getModule("nativeApp"),contextToRestore;return urlCtxToRestore?(contextToRestore=urlCtxToRestore,contextToRestore.type="url"):nativeApp&&(contextToRestore=nativeApp.getReconnectContext(),contextToRestore&&(contextToRestore.type="native")),contextToRestore})},_notifLoggedIn=function(userProfile,offlineLogin,fromInitProcess){return userProfile?(globals.setUserProfile(userProfile),_readRestoredContext(fromInitProcess).then(function(contextToRestore){var nativeApp=native.getModule("nativeApp");return fromInitProcess!==!0&&nativeApp?(log&&log("Getting reconnect token"),auth.reconnectGetToken().then(function(token,userLogin,sid){return log&&log("Getting reconnect token: "+token,userLogin,sid),nativeApp.setReconnectToken(token,userLogin,sid),contextToRestore})):contextToRestore}).then(function(contextToRestore){return globals.setNeedToCheckAppsList(!0),initContext.init(!1,contextToRestore,offlineLogin)}).then(function(contextToRestore){notifications.publish("sm.user.logged.in",fromInitProcess,contextToRestore)})):$.smReject({$redirectPage:"login"})};exports.init=function(){var step,nativeApp=native.getModule("nativeApp");nativeApp?step=nativeApp.getReconnectToken().then(function(loginCookie,sidCookie){return loginCookie||sidCookie?auth.reconnectSetToken(loginCookie,sidCookie):null}):step=$.smResolve();var def=$.Deferred();return step.then(function(){return auth.checkAvailableAuthentications()}).then(function(auths){return auth.check()}).then(function(profile){profile?_notifLoggedIn(profile,!1,!0).then(function(){def.resolve(!0)}).fail(function(e){def.reject(e)}):def.resolve(!1)}).fail(function(e){e||(e={}),e.$redirectPage="login",def.reject(e)}),def.promise()},exports.notifLoggedIn=_notifLoggedIn}),define("syracuse-tablet/html/js/pages/pageLogin",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/pages/pageHtml","syracuse-tablet/html/js/application/authentication","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/application/settings","syracuse-tablet/html/js/helpers/scroller/scrollerHelpers","syracuse-tablet/html/js/init/initLogin","syracuse-tablet/html/js/init/initContext","syracuse-tablet/html/js/application/authentication","syracuse-tablet/html/js/helpers/native/native","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/pages/pageHtml").Page,auth=require("syracuse-tablet/html/js/application/authentication"),locale=require("syracuse-tablet/html/js/helpers/locale"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),settings=require("syracuse-tablet/html/js/application/settings"),scroller=require("syracuse-tablet/html/js/helpers/scroller/scrollerHelpers"),initLogin=require("syracuse-tablet/html/js/init/initLogin"),initContext=require("syracuse-tablet/html/js/init/initContext"),auth=require("syracuse-tablet/html/js/application/authentication"),nativeApp=require("syracuse-tablet/html/js/helpers/native/native").getModule("nativeApp"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_templates={main:'		<div class="s-m-loginform s-m-scroll-elmt" style="display:none;position: relative;">			<div class="row s-m-login-info">				<div class="col-xs-offset-1 col-xs-10 col-sm-offset-3 col-sm-6 col-md-offset-4 col-md-4 col-lg-offset-4 col-lg-4">					<div id="login-reason" style="display: none" class="alert alert-info" role="alert"></div>					<div id="login-success" style="display: none" class="alert alert-success" role="alert"></div>					<div id="login-fail" style="display:none;max-height:100px;overflow:hidden;" class="alert alert-danger" role="alert"></div>				</div>			</div>			<div id="s-m-login-online" class="row">				<div class="col-xs-offset-1 col-xs-10 col-sm-offset-3 col-sm-6 col-md-offset-4 col-md-4 col-lg-offset-4 col-lg-4">					<div class="panel panel-default">						<div id="s-m-login-withcookie" style="display: none;">							<div class="panel-body s-m-login-body">								<center>									<div id="s-m-rememberme-user-id"></div>								</center>							</div>							<div class="panel-body s-m-login-body">								<button  data-action="forgetme" type="button" class="btn btn-primary s-m-signin-btn">{{label_forgetme}}</button>							</div>							<div class="panel-body s-m-login-body" id="s-m-login-changeuser">								<button  data-action="changeuser" type="button" class="btn btn-primary s-m-signin-btn">{{label_changeuser}}</button>							</div>						</div>						<div  id="s-m-login-withoutcookie">							<div class="s-m-login-header main">								<span class="s-m-signin">{{label_signin}}</span>								<span class="s-m-brand">{{label_brand}}</span>								<span class="s-m-product">{{label_product}}</span>							</div>							<div class="panel-body s-m-login-body" id="s-m-login-basic-fields-id">								<br>								<div class="form-group">									<input type="text" autocorrect="off" autocapitalize="off" value="" class="form-control s-m-login-form-input" placeholder="{{label_user}}"	id="login-user">								</div>								<br>								<div class="form-group">									<input type="password" autocorrect="off" autocapitalize="off" class="form-control s-m-login-form-input" placeholder="{{label_password}}" id="login-password">								</div>								<div class="form-group">									<center>										<label style="font-weight:normal"><input type="checkbox" id="s-m-remember-me-id">{{label_rememberme}}</input></label>									</center>								</div>								<button id="login-login" data-action="login" type="button" class="btn btn-primary s-m-signin-btn">{{act_login}}</button>							</div>							<div class="s-m-login-header" id="s-m-sageid-header">								<span class="s-m-signin">{{sageid_label_header}}</span>							</div>							<div class="panel-body s-m-login-body" id="s-m-sageid-body">								<button id="s-m-sageid-signin" data-action="sageidsignin" type="button" class="btn btn-primary s-m-signin-btn">{{sageid_label_signin}}</button>							</div>							<div id="s-m-login-noauth">								<div class="form-group">									<center>										{{no_auth_method}} 										<br> 										{{contact_admin}} 									</center>								</div>							</div>						</div>					</div>				</div>			</div>			<div id="s-m-login-offline" class="row" style="display: none;">				<div class="col-xs-offset-1 col-xs-10 col-sm-offset-3 col-sm-6 col-md-offset-4 col-md-4 col-lg-offset-4 col-lg-4">					<div class="panel panel-default">						<div class="s-m-login-header"><span class="s-m-signin">{{label_signin}} </span> <span class="s-m-brand">{{label_brand}}</span> <span class="s-m-product">{{label_product}}</span></div>						<div class="s-m-login-header" id="s-m-offline-header">							<span class="s-m-signin">{{offline_label_header}}</span>						</div>						<div class="panel-body s-m-login-body" id="s-m-sageid-body">							<button id="s-m-offline-signin" data-action="offlinesignin" type="button" class="btn btn-primary s-m-signin-btn"> 								<div id="s-m-offline-label">{{offline_label_signin_as}}</div> 								<div id="s-m-offline-user"></div> 							</button>						</div>					</div>				</div>			</div>			<div id="s-m-login-nooffline" class="row" style="display: none;">				<div class="col-xs-offset-1 col-xs-10 col-sm-offset-3 col-sm-6 col-md-offset-4 col-md-4 col-lg-offset-4 col-lg-4">					<div class="panel panel-default">						<div class="s-m-login-header" id="s-m-offline-header">								{{offline_notavail}}						</div>						<div class="panel-body s-m-login-body" id="s-m-sageid-body">							<div>{{offline_emptydb}}</div> 						</div>					</div>				</div>			</div>		</div>	',message:"{{title}}<p>{{message}}</p>{{stack}}"},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[name],tmpl=_templates[key]=Handlebars.compile(tmpl)),tmpl(ctx)},lang,_Page=utils.defineClass(function LoginPage($parent,state,options){options.header=!1,options.footer=!1,Base.call(this,$parent,state,options)},Base,{appendHtml:function($$parent,loadOpts){var self=this;self.$$elmt.addClass("login");var labels=locale.getProductLabels(),_pageContext={label_user:locale.text("login.label.user"),label_password:locale.text("login.label.password"),act_login:locale.text("login.label.signinaction"),label_signin:locale.text("login.label.signin"),label_brand:labels.brand,label_product:labels.product,sageid_label_header:locale.text("sageid.label.header"),sageid_label_signin:locale.text("sageid.label.signin"),offline_label_header:locale.text("login.label.offline"),offline_label_signin_as:locale.text("login.label.login_as"),offline_notavail:locale.text("login.offline.notavail"),offline_emptydb:locale.text("login.offline.emptydb"),label_forgetme:locale.text("login.forgetme"),label_changeuser:locale.text("login.changeuser"),label_rememberme:locale.text("login.rememberme"),no_auth_method:locale.text("login.label.noauth"),contact_admin:locale.text("contact.admin")};$$parent.html(_getHtml("main",_pageContext));var sageId=auth.isAuthenticationAvail("sage-id"),basic=auth.isAuthenticationAvail("basic");$$parent.find("#s-m-login-online").find("#s-m-sageid-header, #s-m-sageid-body").toggle(sageId),$$parent.find("#s-m-login-online").find("#s-m-login-basic-fields-id").toggle(basic),$$parent.find("#s-m-login-online").find("#s-m-login-noauth").toggle(!sageId&&!basic);var msg;self.state.options.reason&&(self.state.options.isError===!0?msg=self.state.options.reason:self._displayText($$parent.find("#login-reason"),self.state.options.reason));var offlineState=!globals.isOnline();self.state.options&&self.state.options.offlineHint!=null&&(offlineState=self.state.options.offlineHint),self._updateStatus(msg,offlineState),$("#s-m-login-basic-fields-id input",self.$$elmt).on("keyup",jsutils.bindFn(self._onEnterPressed,self))},_onEnterPressed:function(e){var self=this;if(e.which==13||e.keyCode==13)e.preventDefault(),self._actLogin()},_actLogin:function(){var self=this,usr=self.$$elmt.find("#login-user").val(),pwd=self.$$elmt.find("#login-password").val();if(usr==null||usr.length<1){self.$$elmt.find("#login-usr").focus();return}if(pwd==null||pwd.length<1){self.$$elmt.find("#login-password").focus();return}self.$$elmt.find("#login-reason").hide(),self.waitWheelStart();var rememberMe=$("#s-m-remember-me-id").is(":checked");return nativeApp&&(rememberMe=!0),settings.setLoginRememberMe(rememberMe).then(function(){return auth.login(usr,pwd,rememberMe)}).then(function(userProfile){return initLogin.notifLoggedIn(userProfile)}).then(function(){self.waitWheelStop()}).fail(function(e,offline){self.waitWheelStop(),self._updateStatus(e,offline)})},_checkMessage:function(e){var self=this;self.message=null,self.stack=null;var diag=jsutils.convertToDiagnoses(e);diag&&diag.$diagnoses&&diag.$diagnoses.length>0&&(diag=diag.$diagnoses[0]),diag&&diag.$message&&(self.message=locale.textNoFail(diag.$message)||diag.$message,self.stack=diag.$stackTrace),e&&e.$redirectPage==="login"?self.message||self._displayText($("#login-reason"),locale.text("login.authentication")):self.message||(self.message="Unexpected empty error message");var $$fail=$("#login-fail");if(self.message){var title=e.title?locale.textNoFail(e.title):locale.text("login.failed")||"Login failed";self._displayText($$fail,_getHtml("message",{title:title,message:self.message||"",stack:self.stack||""}))}else $$fail.empty().hide()},_updateStatus:function(e,forceOffLine){var self=this;forceOffLine&&self.setOffLine(!0),e&&self._checkMessage(e);var step;self._offLineProfile=null,self.isOffLine()?step=settings.getLastUserProfile().then(function(profile){return self._offLineProfile=profile,$.smResolve()}).fail(function(e){return self._checkMessage(e),$.smResolve()}):step=auth.reconnectGetToken().then(function(loginCookie,loginCookieUser,sidCookie){return $.smResolve(loginCookie,loginCookieUser,sidCookie)}),step.then(function(loginCookie,loginCookieUser,sidCookie){$("#s-m-offline-user").text(""),self.isOffLine()?($("#s-m-login-online").hide(),self._offLineProfile?($("#s-m-offline-user").text((self._offLineProfile.user.firstName||"")+" "+(self._offLineProfile.user.lastName||"")),$("#s-m-login-offline").show(),$("#s-m-login-nooffline").hide()):($("#s-m-login-offline").hide(),$("#s-m-login-nooffline").show())):loginCookie?($("#s-m-login-offline").hide(),$("#s-m-login-withoutcookie").hide().find(".s-m-login-header.main").hide(),$("#s-m-login-nooffline").hide(),$("#s-m-login-withcookie").show(),$("#s-m-rememberme-user-id").text(locale.text("login.label.login.cookie",[loginCookieUser]))):($("#s-m-login-online").show(),$("#s-m-login-offline").hide())}).then(function(){return settings.getLoginRememberMe()}).then(function(rememberMe){var $$check=$("#s-m-remember-me-id");nativeApp&&(rememberMe=!0,$$check.closest(".form-group").hide()),$$check.attr("checked",rememberMe)}).fail(function(e){self._checkMessage(e)})},_actForgetme:function(){var userProfile=globals.getUserProfile(),self=this;userProfile&&initContext.removeLastUsedContext(userProfile.user.$value),auth.logout().then(function(){return auth.forgetme()}).always(function(){self.reload()})},_actChangeuser:function(){this._displayText($("#login-reason"),locale.text("login.authentication")),$("#s-m-login-withoutcookie").show(),$("#s-m-login-changeuser").hide(),notifications.notifyController("sm.scroller.update",this)},_displayText:function($$parent,text){if(!$$parent)return;if(!text){$$parent.empty().hide();return}$$parent.show().html(text.replace(/\n/g,"<br>"))},_actSageidsignin:function(){this.waitWheelStart(),this.$$elmt.find("#login-reason").hide(),auth.sageidsignin()},_actOfflinesignin:function(){var self=this;self.$$elmt.find("#login-reason").hide(),initLogin.notifLoggedIn(self._offLineProfile,!0).then(function(){}).fail(function(e){self._updateStatus(e)})},onMainPageResize:function(info,orientation,deviceType){if(this.destroyed)return;this.$$htmlRoot.find("div.s-m-loginform").show(),Base.prototype.onMainPageResize.call(this,info,orientation,deviceType)},scrollAllowed:function(){return!0},destroy:function(){Base.prototype.destroy.call(this)},isOffLine:function(){return Base.prototype.isOffLine.call(this)||!globals.isOnline()},isSamePage:function(state){return!1}});exports.Page=_Page}),define("syracuse-tablet/html/js/application/daoApp",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),_Dao=utils.defineClass(function(appli){var self=this;self._appli=appli,self.appMetaData=null},null,{destroy:function(){var self=this;self._appli=null},isApplicationLoaded:function(){var self=this;return self.appMetaData!=null},setApplication:function(appMetaData){var self=this;appMetaData&&(self.appMetaData=$.extend(!0,{},appMetaData))},getApplicationName:function(){var self=this;return self.appMetaData&&self.appMetaData.$application.applicationName||""},getApplicationTitle:function(){var self=this;return self.appMetaData&&(self.appMetaData.$application.title||self.appMetaData.$application.applicationName)||""},getApplicationIcon:function(){return this.appMetaData&&this.appMetaData.$application.iconName},isSageApplication:function(){return this.appMetaData!=null&&this.appMetaData.$application.isSageApplication===!0},getAppBackGroundClass:function(){return""},getHomeDashboardName:function(){var self=this,homeDash=(self.appMetaData.$application.$homeDashboard.dashboardName||"").trim();homeDash.length==0&&new Error(locale.text("error.page.homenotdefined",[self.getApplicationName()]));if(self.appMetaData&&self.appMetaData.$dashboards)for(var p in self.appMetaData.$dashboards){var data=self.appMetaData.$dashboards[p];if(data.$dashboardName===homeDash)return data.$dashboardName}throw new Error(locale.text("error.page.homenotfound",[self.getApplicationName(),homeDash]))}});exports.Dao=_Dao}),define("syracuse-tablet/html/js/application/daoSdataWrkcpy",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/application/daoSdata"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/application/daoSdata").Dao,_Klass=utils.defineClass(function(data,prototype,options){options=options||{},Base.call(this,data,prototype,options),this.enableWorkingCopy=this.isRowDetailDao?!1:!0},Base,{destroy:function(destroyProto){Base.prototype.destroy.call(this,destroyProto)},setDirty:function(){Base.prototype.setDirty.call(this),this._workingCopyUpdate()},_workingCopyUpdate:function(){var self=this;if(self.enableWorkingCopy!==!0)return;var step;return self.wrkCpyDirty?(console.log("_workingCopyUpdate","update"),globals.getStorage().draftOperation("wrkcpyUpdate",self.data)):(self.wrkCpyDirty=!0,console.log("_workingCopyUpdate","create"),globals.getStorage().draftOperation("wrkcpyCreate",self.data).then(function(data){self.enableWorkingCopy=data!=null}))},workingCopyGetId:function(onlyIfDirty){return this.enableWorkingCopy!==!0&&this.data==null?null:onlyIfDirty===!0&&this.wrkCpyDirty!==!0?null:this.data.$uuid},clone:function(){return new _Klass($.extend(!0,{},this.data),this.prototype,{parent:this.parent,$bind:this.$bind,isRowDetailDao:this.isRowDetailDao===!0})},updateParentRow:function(create,singleArrayRowIdx){var res=Base.prototype.updateParentRow.call(this,create,singleArrayRowIdx);return globals.getStorage().draftOperation("wrkcpyDelete",this.workingCopyGetId()),res}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/pages/pageDrafts",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/rect","syracuse-tablet/html/js/pages/pageHtml","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/application/eventListener","syracuse-tablet/html/js/application/appFactory","syracuse-tablet/html/js/sdata/sdataDispatcher","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/scroller/scrollerHelpers","syracuse-tablet/html/js/helpers/formatApi"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),uiRect=require("syracuse-tablet/html/js/ui/rect"),Base=require("syracuse-tablet/html/js/pages/pageHtml").Page,locale=require("syracuse-tablet/html/js/helpers/locale"),eventListener=require("syracuse-tablet/html/js/application/eventListener"),factory=require("syracuse-tablet/html/js/application/appFactory"),dispatcher=require("syracuse-tablet/html/js/sdata/sdataDispatcher"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),scroller=require("syracuse-tablet/html/js/helpers/scroller/scrollerHelpers"),formatApi=require("syracuse-tablet/html/js/helpers/formatApi"),_templates={error:'<section class="draft-error"><h1>{{error}}<h1><h2>{{contact}}<h2></section>',spinner:'		<div id="draftSpinner">   			<div>				<div class="spinner-loader"></div>			</div>		</div>',record:'			<section id="{{id}}" data-action="clickRecord" data-params="select" class="list-group-item s-m-draft-item {{status}}">				<div>					<div>						<div class="draft-title">{{title}}</div>						<div class="draft-date">{{creation_date}}</div>					</div>					<div>						<div><span class="draft-status">{{statusText}}</span><span class="draft-errorMsg">{{error}}</span></div>						<div class="draft-endpoint">{{endpoint}}</div>					</div>					<div>						<div class="draft-comment"><i class="fa fa-comment-o"></i>{{comment}}</div>						<div class="draft-actions">							<span data-params="edit" class="fa fa-edit"></span>						</div>					</div>				</div>				<span class="badge checked fa fa-check">&nbsp;</span>				<span style="{{#unless index}}display:none;{{/unless}}" class="badge index">{{index}}</span>			</section>',content:'			<div class="s-m-draft-header" style="display:none">				<div>					{{{selectMenu}}}				</div>				<div>					{{{filtersMenu}}}				</div>			</div>			<div id="draftInfo"  style="display:none">{{info}}</div>			<div id="draftPageWrapper" class="s-m-scroll-wrapper">				<div class="list-group s-m-draft-list">				</div>			</div>		</div>',selectMenu:'		<div id="draftSelectMenuId" class="btn-group">			<div class="{{dropDirection}}">				<button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-expanded="false">					<span class="badge"></span>{{title}}<span class="caret"></span>				</button>				<ul class="dropdown-menu dropdown-menu-left" role="menu">					{{#each links}}						<li><a  {{#if $isHidden}}style="display:none"{{/if}} draggable="false"  data-action="selectMenu" data-params="{{params}}" href="#">{{title}}</a></li>					{{/each}}				</ul>			</div>		</div>',filtersMenu:'		<select id="draftFiltersMenu" data-action="filter">		{{#each filterOptions}}			<option value="{{value}}" {{#if selected}}selected{{/if}}>{{title}}</option>		{{/each}}		<select>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[name],tmpl=_templates[key]=Handlebars.compile(tmpl)),tmpl(ctx)},_selectOptionsList=["unselectall","selectall","hideunselected","showunselected"],_toolbarLinks=[{name:"stop",$isHidden:!0},{name:"synch",$isDisabled:!0,$confirm:!0},{name:"remove",$isDisabled:!0,$confirm:!0}],_Page=utils.defineClass(function DraftsPage($parent,state,options){options.header=!0,options.breadcrumbs=!0,options.footer=!0,Base.call(this,$parent,state,options),this._selectedFilter="creation_date:dsc",this._initLabels(),notifications.subscribe(this,["sm.action.link"]),this.dateFormatter=formatApi.getFormatter("application/x-datetime")},Base,{scrollAllowed:function(){return!1},_initLabels:function(){this._filterOptions=[{value:"creation_date:asc",title:locale.text("drafts.filters.dateasc")},{value:"creation_date:dsc",title:locale.text("drafts.filters.datedsc")}]},destroy:function(){Base.prototype.destroy.call(this),this._myGestureMgr&&(this._myGestureMgr.destroy(),this._myGestureMgr=null)},appendHtml:function($$parent,loadOpts){var self=this;self.$$elmt.addClass("drafts"),self.$$htmlRoot.html(_getHtml("content",{filtersMenu:self._buildSortMenu(),selectMenu:self._buildSelectMenu()})),self._$$selectMenu=self.$$htmlRoot.find("#draftSelectMenuId"),self.$$info=self.$$htmlRoot.find("#draftInfo"),self.$$listHeader=self.$$htmlRoot.find(".s-m-draft-header"),self._$$list=self.$$htmlRoot.find(".s-m-draft-list"),self.$$myScrollWrapper=self.$$elmt.find("#draftPageWrapper"),self.$$myScrollWrapper.css({height:"auto"}),self._myGestureMgr=scroller.newScroller(self._$$list,{isPageScroller:!0,direction:"v"}),self._updateList()},_updateList:function(){var self=this;self._$$list.empty(),self._$$spinner=null,self.$$info.hide(),self.$$listHeader.hide(),globals.getStorage().draftOperation("draftReadList").then(function(resources){resources=self._applyFilters(resources||[]);var content;if(resources.length>0){var recordsHtml=[];resources.forEach(function(rsrc,idx){recordsHtml.push(self._getRecordHtml(rsrc,idx))}),content=recordsHtml.join("\n")}self._$$list.html(content),self._$$spinner=$(_getHtml("spinner")).appendTo(self._$$list),self._updateUI()}).fail(function(e){globals.getModal().error(locale.text("drafts.error.loading"),e,function(){self._$$list.html(_getHtml("error",{error:locale.text("error"),contact:locale.text("contact.admin")})),self._updateMyGesture()})})},onMainPageResize:function(info,orientation,deviceType){var self=this;if(self.destroyed)return;Base.prototype.onMainPageResize.call(self,info,orientation,deviceType),setTimeout(function(){var preserveScroll=info?info.preserveScroll:!1;info.orientationChanged||info.deviceChanged?self._updateUI(preserveScroll):self._updateMyGesture(preserveScroll)})},_updateMyGesture:function(preserveScroll){if(!this._myGestureMgr)return;var mainRect=uiRect.elmtRect(this.$$contentElmt,"outer"),viewRect=uiRect.elmtRect(this.$$myScrollWrapper,"outer"),scrollRect=mainRect.intersectRect(viewRect);scrollRect&&scrollRect.height<this._myGestureMgr.$$elmt.height()?this._myGestureMgr.init(scrollRect,null,null,preserveScroll):this._myGestureMgr.reset()},_getRecordHtml:function(rsrc,index){rsrc=$.extend({},rsrc),rsrc.index=index==null?null:index+1;var date=rsrc.creation_date;return date&&(rsrc.creation_date=this.dateFormatter.formatValue(date)),rsrc.statusText=locale.text("drafts.status."+rsrc.status),rsrc.error=rsrc.errorMsg||"",_getHtml("record",rsrc)},_buildSelectMenu:function(){var links=[];return _selectOptionsList.forEach(function(id){links.push({title:locale.text("multiselect.action."+id),params:id,$isHidden:!1})}),_getHtml("selectMenu",{links:links,title:locale.text("multiselect.selected"),dropDirection:"dropdown"})},_buildSortMenu:function(){var self=this;self._selectedFilter=self._selectedFilter||"creation_date:asc";var opts=[];return self._filterOptions.forEach(function(item){item=$.extend({},item),item.selected=item.value===self._selectedFilter,opts.push(item)}),_getHtml("filtersMenu",{filterOptions:opts})},_updateUI:function(preserveScroll){var allRecords=this._selectRecords("all").length,selectedRecords=this._selectRecords(".selected").length;this._$$selectMenu.find("a[data-action]").toggle(selectedRecords>0),this._$$selectMenu.find('a[data-params="selectall"]').toggle(allRecords!==selectedRecords);var hiddenUnselRecords=this._selectRecords(":not(.selected):not(:visible)").length;this._$$selectMenu.find('a[data-params="hideunselected"]').toggle(selectedRecords>0&&selectedRecords<allRecords&&hiddenUnselRecords==0),this._$$selectMenu.find('a[data-params="showunselected"]').toggle(selectedRecords>0&&hiddenUnselRecords>0),this._$$selectMenu.find(".badge").text(selectedRecords),this.$$elmt.find(".draft-synch, .draft-remove").toggleClass("disabled",selectedRecords==0),this.$$info.text(locale.text("drafts.info",[allRecords]));var isEmpty=allRecords==0;isEmpty&&this._$$list.html(locale.text("drafts.emptyList")),this._$$list.toggleClass("empty",isEmpty),this.$$info.toggle(!isEmpty),this.$$listHeader.toggle(!isEmpty),this._updateMyGesture(preserveScroll)},_selectRecords:function(cssSelector){var selector="";return cssSelector!="all"&&(selector+=cssSelector),this._$$list.find("section.s-m-draft-item"+selector)},_actFilter:function(){if(this._busy===!0)return;var val=$(arguments[1]).val();if(val==this._selectedFilter)return;this._selectedFilter=val,this._updateList()},_applyFilters:function(resources){if(!this._selectedFilter)return resources;var f=this._selectedFilter.split(":");if(f.length!=2)return resources;var property=f[0],order=f[1];return resources.sort(function(a,b){a=a[property],b=b[property];if(a==b)return 0;if(a>b)return order=="asc"?1:-1;if(a<b)return order=="asc"?-1:1}),resources},_actSelectMenu:function(action){var self=this;switch(action){case"selectall":case"unselectall":var elmts=self._selectRecords("all").show();action=="unselectall"&&(elmts=self._selectRecords(".selected")),elmts.each(function(){self._toggleRecordSelection($(this),action==="selectall")});break;case"hideunselected":self._selectRecords(":not(.selected)").hide();break;case"showunselected":self._selectRecords(":not(.selected)").show()}this._updateUI()},_actClickRecord:function(params,$$elmt,evt){evt.stopPropagation();if(this._busy===!0)return;var $$rec=$$elmt.closest(".s-m-draft-item");if(!$$rec)return;var action=$$elmt.closest("[data-params]").attr("data-params");if(action==="select")this._toggleRecordSelection($$rec),this._updateUI(!0);else if(action==="edit"){var id=$$rec.attr("id");if(!id)return;eventListener.triggerAction(this.$$elmt,"openDraft",id)}},_toggleRecordSelection:function($$rec,force){if(!$$rec||$$rec.length==0)return;$$rec.toggleClass("selected",force)},_mainUploadBegin:function(name,ids){this._stop=!1,this._busy=!0,this._logData={nbSuccess:0,nbErrors:0},this.$$elmt.find(".draft-stop").removeClass("disabled").show(),this._selectRecords(":not(.selected)").hide()},_mainUploadEnd:function(name){this._busy=!1,this.$$elmt.find(".draft-stop").hide(),this.$$elmt.find(".synchronized").removeClass("synchronized"),this._selectRecords(":not(.selected)").show(),this._refreshIndexes(),this._updateUI()},_refreshIndexes:function(){this._$$list.find(".s-m-draft-item").each(function(idx){$(this).find(".badge.index").text(idx+1).show()})},_upload:function(ids){var self=this;self._mainUploadBegin("upload",ids);var join=$.Deferred();return self._uploadPop(ids).then(function(status){self._mainUploadEnd("upload"),join.resolve(status)}).fail(function(e){self._mainUploadEnd("upload"),join.reject(e)}),join.promise()},_uploadPop:function(ids,_mainDeferred){var first=_mainDeferred==null;first&&(_mainDeferred=$.Deferred());try{if(this._stop===!0){_mainDeferred.resolve("stopped");return}if(!ids||ids.length==0){_mainDeferred.resolve("completed");return}var self=this;self._uploadOne(ids.pop()).then(function(){setTimeout(function(){self._uploadPop(ids,_mainDeferred)})}).fail(function(e){_mainDeferred.reject(e)})}catch(e){_mainDeferred.reject(e)}return first?_mainDeferred.promise():null},_uploadOne:function(id){var self=this,deferred=$.Deferred();return self._uploadOneBegin(id).then(function(ctx){if(!ctx||!ctx.restoredContext)throw new Error("unexpected null draft context");if(!ctx.saveLink||!ctx.saveLink.sDataUrl)throw new Error("unexpected null save link info");return globals.getMetaData().getPageDetails(ctx.restoredContext.currentState).then(function(info){return $.smResolve(ctx,info)}).fail(function(e){return $.smReject(e)})}).then(function(draftCtx,info){var dao=factory.createDaoSdata(draftCtx.dataSet,info.prototype),payload=dao.getActionPayload(draftCtx.saveLink,!0);return dispatcher.dispatch({$url:draftCtx.saveLink.sDataUrl,$method:draftCtx.saveLink.$method},payload).then(function(result){if(!result)throw new Error("unexpected null http response");var responseJSON=result.responseJSON||{},next;return result.isSuccess?next=self._uploadOneEnd(id,"saveSucceeded"):result.status===401?next=$.smReject(locale.text("drafts.error.unauthorized")):result.responseJSON&&result.responseJSON.$noConnectionError===!0?next=$.smReject(locale.text("drafts.error.noconnection")):(dao.updateMeta(responseJSON),draftCtx.status="error",draftCtx.errMsg=responseJSON&&responseJSON.$diagnoses&&responseJSON.$diagnoses.length>0?responseJSON.$diagnoses[0].$message:"",draftCtx.creation_date=utils.getCurISODateTime(new Date),next=self._uploadOneEnd(id,"saveFailed",{draftCtx:draftCtx})),next})}).then(function(){deferred.resolve()}).fail(function(e){return typeof e=="string"&&(e={$diagnoses:[{$message:e}]}),self._uploadOneEnd(id,"exception",{exception:e}).always(function(e){deferred.reject(e)})}),deferred.promise()},_processRecordBegin:function($$rec){if(this._$$spinner){var pos=$$rec.position();this._$$spinner.css({top:pos.top+"px",display:"table"}),this._$$spinner.children().outerHeight($$rec.outerHeight()).show()}this._myGestureMgr&&this._myGestureMgr.makeVisible($$rec)},_processRecordEnd:function($$rec){this._$$spinner&&this._$$spinner.hide(),$$rec},_uploadOneBegin:function(id){return this._processRecordBegin(this.$$elmt.find("#"+id)),globals.getStorage().draftOperation("draftRead",id)},_uploadOneEnd:function(id,status,opts){var self=this,$$record=this.$$elmt.find("#"+id);return this._processRecordEnd($$record),status==="saveSucceeded"?globals.getStorage().draftOperation("draftDelete",id).then(function(){self._logData.nbSuccess++,$$record.remove()}).fail(function(e){return $.smReject(e)}):status==="saveFailed"?(self._logData.nbErrors++,globals.getStorage().draftOperation("draftSave",opts.draftCtx).then(function(){var $$newRecord=$(self._getRecordHtml(opts.draftCtx)).addClass("selected synchronized");$$record.after($$newRecord),$$record.remove()}).fail(function(e){return $.smReject(e)})):status==="exception"?$.smReject(opts.exception):$.smReject(new Error("Unexpected draft status"))},_actSynch:function(){var self=this;self._upload(self._selectRecords(".selected").map(function(){return this.id}).get().reverse()).then(function(status){var nbSuccess=self._logData.nbSuccess,nbErrors=self._logData.nbErrors,count=nbSuccess+nbErrors;globals.getModal().notify({title:locale.text("drafts.synch."+status),body:locale.text("drafts.synch.result",[count,nbSuccess,nbErrors]),severityClass:nbErrors>0?"warning":"success",delay:nbErrors>0?"medium":"short"})}).fail(function(e,status){globals.getModal().error(locale.text("drafts.error.uploading"),e)})},_removePop:function($$records,mainDeferred){var self=this,first=mainDeferred==null;first&&(mainDeferred=$.Deferred());var $$rec=$$records.length>0?$$records.pop():null;if($$rec==null){mainDeferred.resolve();return}return self._processRecordBegin($$rec),globals.getStorage().draftOperation("draftDelete",$$rec.attr("id")).then(function(){self._logData.nbSuccess++,$$rec.remove(),setTimeout(function(){self._removePop($$records,mainDeferred)},500)}).fail(function(e){mainDeferred.reject(e)}),first?mainDeferred.promise():null},_actRemove:function(){var self=this;$.smResolve().then(function(){return self._busy=!0,self._logData={nbSuccess:0},self._selectRecords(".selected").map(function(){return $(this)}).get().reverse()}).then(function($$records){var deferred=$.Deferred();return self._removePop($$records).then(function(){globals.getModal().notify({title:locale.text("drafts.remove.completed",[self._logData.nbSuccess]),severityClass:"success",delay:"short"}),deferred.resolve(!0)}).fail(function(e){globals.getModal().error(locale.text("drafts.error.removing"),e,function(){deferred.resolve(!1)})}),deferred.promise()}).always(function(){self._busy=!1,self._processRecordEnd(null),self._updateUI(),self._refreshIndexes()})},notifActionLink:function(success,link,result,options){if(!this.isActive())return;switch(link.name){case"synch":this._actSynch();break;case"remove":this._actRemove();break;case"stop":this._stop=!0}},getToolbarLinks:function(toolbar,options){var device=globals.getSiteLayout().getDeviceType();if(device==="tablet"&&toolbar==="footer"||device==="smartphone"&&toolbar==="header"){var result=[];return _toolbarLinks.forEach(function(act){result.push({name:act.name,title:locale.text("drafts.action."+act.name),icon:fontUtils.getDraftIcons(act.name),$uuid:utils.UUID(),css:"draft-"+act.name,footerHeader:!0,isClientAction:!0,$confirm:act.$confirm===!0?locale.text("drafts.dlog.confirm."+act.name):null,$isHidden:act.$isHidden===!0,$isDisabled:act.$isDisabled===!0})}),result}return null}});exports.Page=_Page}),define("syracuse-tablet/html/js/application/appFactoryDeps",["require","exports","module","syracuse-tablet/html/js/application/application","syracuse-tablet/html/js/pages/pageDashboard","syracuse-tablet/html/js/pages/pageWelcomeDashboard","syracuse-tablet/html/js/pages/pageRegular","syracuse-tablet/html/js/pages/pageRequest","syracuse-tablet/html/js/pages/pageRowDetail","syracuse-tablet/html/js/pages/pageChartDetail","syracuse-tablet/html/js/pages/pageCardDesign","syracuse-tablet/html/js/pages/pageLookup","syracuse-tablet/html/js/pages/pageLogin","syracuse-tablet/html/js/application/daoApp","syracuse-tablet/html/js/application/daoSdata","syracuse-tablet/html/js/application/daoSdataWrkcpy","syracuse-tablet/html/js/pages/pageDrafts","syracuse-tablet/html/js/application/appFactory"],function(require,exports,module){var Application=require("syracuse-tablet/html/js/application/application").Application,DashoardPage=require("syracuse-tablet/html/js/pages/pageDashboard").Page,WelcomeDashoardPage=require("syracuse-tablet/html/js/pages/pageWelcomeDashboard").Page,RegularPage=require("syracuse-tablet/html/js/pages/pageRegular").Page,RequestPage=require("syracuse-tablet/html/js/pages/pageRequest").Page,RowDetailPage=require("syracuse-tablet/html/js/pages/pageRowDetail").Page,ChartDetailPage=require("syracuse-tablet/html/js/pages/pageChartDetail").Page,CardDesignPage=require("syracuse-tablet/html/js/pages/pageCardDesign").Page,LookupPage=require("syracuse-tablet/html/js/pages/pageLookup").Page,LoginPage=require("syracuse-tablet/html/js/pages/pageLogin").Page,DaoApp=require("syracuse-tablet/html/js/application/daoApp").Dao,DaoSdata=require("syracuse-tablet/html/js/application/daoSdata").Dao,DaoSdataWrkcpy=require("syracuse-tablet/html/js/application/daoSdataWrkcpy").Klass,DraftsPage=require("syracuse-tablet/html/js/pages/pageDrafts").Page,factory=require("syracuse-tablet/html/js/application/appFactory");exports.init=function(){factory.setImpl("Application",Application),factory.setImpl("DashoardPage",DashoardPage),factory.setImpl("WelcomeDashoardPage",WelcomeDashoardPage),factory.setImpl("RegularPage",RegularPage),factory.setImpl("RequestPage",RequestPage),factory.setImpl("RowDetailPage",RowDetailPage),factory.setImpl("ChartDetailPage",ChartDetailPage),factory.setImpl("CardDesignPage",CardDesignPage),factory.setImpl("LookupPage",LookupPage),factory.setImpl("LoginPage",LoginPage),factory.setImpl("DaoApp",DaoApp),factory.setImpl("DaoSdata",DaoSdata),factory.setImpl("DaoSdataWrkcpy",DaoSdataWrkcpy),factory.setImpl("DraftsPage",DraftsPage)}}),define("syracuse-tablet/html/js/controls/structElmt",["require","exports","module","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_Klass=utils.defineClass(function StructElmt(controller,$type,article,options){this.options=options||{},this.controller=controller,this.$type=$type,this.typeName=utils.getTypeName($type),this.article=article||{},this.children=null,this.parent=null,this._dao=null,this.initReuseProperties(),this.destroyed=!1,this.isEmpty=!1},null,{initReuseProperties:function(){this.$$elmt=null,this.id=this.createId(this.typeName)},destroy:function(){this.destroyed=!0,this.children&&(this.children.forEach(function(child){child&&child.destroy()}),this.children=null),this._htmlGeneratorContexts&&this.destroyHtmlGeneratorContexts(),notifications.unsubscribe(this),this.$$elmt&&(this.$$elmt.unbind(),this.$$elmt.remove(),this.$$elmt=null),this.controller=null,this._dao=null,this.parent=null},isRoot:function(){return this.parent==null||this.parent===this.controller},generateHtml:function($$parent,controllerDao,htmlRootCtrl,updateLayout){var opts=this.options;return this.isEmpty=!1,htmlRootCtrl&&(opts.htmlRootCtrl=htmlRootCtrl),opts.isHtmlGenerator=!0,opts.updateLayout=updateLayout===!0,this.buildHtml($$parent,controllerDao,opts),this.afterRender&&this.afterRender(opts),this.$$elmt},applyMetaData:function(metaData,buildOptions){},getDao:function(){return this.destroyed?null:(this._dao&&!this._dao.isValid()&&(this._dao=null),this._dao?this._dao:this.controller?this.controller.dao:null)},buildHtml:function($$parent,controllerDao,buildOptions){this._dao=controllerDao,this.isEmpty=!1,buildOptions&&buildOptions.isHtmlGenerator===!0&&(this._needReuse?this.initReuseProperties():this._needReuse=!0)},getMetaData:function(metaProp){return null},getAuthoring:function(path,defValue){var val=utils.getPropByPath(this.article,path);return val!=null?val:defValue},appendStyleAuthoring:function(classArray,pathOrData){classArray=classArray||[];if(!pathOrData)return classArray;if($.isPlainObject(pathOrData))var data=pathOrData;else var data=this.getAuthoring(pathOrData);if(!data)return classArray;for(var p in data)["$theme","$fontStyle","$fontSize"].indexOf(p)>=0&&classArray.push(data[p]);return classArray},empty:function(){this.children&&this.children.forEach(function(child){child&&child.empty()}),this.$$elmt&&this.$$elmt.empty()},isLayout:function(){return!1},isVignette:function(){return!1},isControl:function(){return!1},createId:function(typeName){return utils.readableuid(typeName)},appendStructElmt:function(c){if(!c)return;this.children||(this.children=[]),c.parent=this,this.children.push(c)},getNbChilds:function(){return this.children&&this.children.length>0},createRootElement:function(css,$$parent){var e=this.setRootElement(uiUtils.createDomElement("div",css,null,this.options.isHtmlGenerator===!0?null:{id:this.id}),$$parent);return e},setRootElement:function(e,$$parent){if(!e)return null;e.jquery||(e=$(e)),this.$$elmt=e,$$parent&&($$parent.jquery||($$parent=$($$parent)),e.appendTo($$parent));if(globals.isAutoUITestMode()){var i=this.getUnitTestId();i&&globals.getUnitTestMgr().addStructElmtId(this.$$elmt,i)}return e},getUnitTestId:function(){return null},isVisible:function(){return this.$$elmt&&this.$$elmt.is(":visible")},isHidden:function(){return!this.isVisible()},show:function(){this.$$elmt&&this.$$elmt.show()},hide:function(){this.$$elmt&&this.$$elmt.hide()},setFocus:function(){},getArticle:function(){return this.article},removeChild:function(structElmt){var _children=[];this.children.forEach(function(child){child&&child.id===structElmt.id?child.destroy():_children.push(child)}),this.children=_children},removeChildren:function(){this.children&&this.children.forEach(function(child){child.destroy()}),this.children=[]},getIndexOfChild:function(child){var idx=-1;return this.children&&this.children.some(function(c){return idx+=1,c===child?!0:!1}),idx},getChildByIndex:function(idx){return this.children&&this.children[idx]},addChildBefore:function(ctrl,nextChild){var added=!1,_children=[];this.children&&this.children.forEach(function(c){nextChild&&c.id===nextChild.id&&(_children.push(ctrl),added=!0),c.id!==ctrl.id&&_children.push(c)}),added||_children.push(ctrl),this.children=_children},removeChildRef:function(c){var _children=[];this.children&&this.children.forEach(function(child){child.id!==c.id&&_children.push(child)}),this.children=_children},getPathInTree:function(){var ctrl=this,parent,path=[];parent=this.parent;while(parent){var idx;if(jsutils.isInstanceOf(parent,"Page")){if(!parent.isVignette)break;var vgnt=parent.getParentVignette();idx=0,parent=vgnt.parent}else idx=parent.getIndexOfChild(ctrl);path.push(idx),ctrl=parent,parent=parent.parent}return path.reverse(),path},findChildByPath:function(path){if(!path)return;var node=this;return path.some(function(idx){if(jsutils.isInstanceOf(node,"VignetteBase")){if(!node.getPage())return node=null,!0;node=node.getPage().rootLayout}node=node.getChildByIndex(+idx)}),node},getAuthArticle:function(){var authArticle={},nodeArticle=this.getArticle();return Object.keys(nodeArticle).forEach(function(key){key!=="$items"&&(authArticle[key]=nodeArticle[key])}),authArticle},getAuthState:function(dirtyKeys){return null},setAuthState:function(state){},getArticleTextUUID:function(property){if(!this.article[property]||this.article[property].indexOf("{@")<0)return"";var uuid=this.article[property].match(/\{\@(\S+)\}/);return uuid&&uuid[1]},getArticleText:function(property){if(!this.article[property])return"";var self=this,text=self.article[property]&&self.article[property].replace(/\{\@(\S+)\}/g,function(m,g){var localization=self.options.$localization;return self.isVignette()&&!localization&&(localization=utils.getArticleLocalization(utils.getCurrentPage().article)),localization&&localization[g]||localization&&localization.$fallback&&localization.$fallback[g]||m});return text&&this.article[property]===text&&(text=this.controller.prototype.resolveExpression(text,null,!0)),text||""},addHtmlGeneratorContext:function(ctx){if(!ctx)return;this._htmlGeneratorContexts||(this._htmlGeneratorContexts=[]),this._htmlGeneratorContexts.push(ctx)},destroyHtmlGeneratorContexts:function(){if(!this._htmlGeneratorContexts)return;this._htmlGeneratorContexts.forEach(function(ctx){ctx.handler&&ctx.data&&ctx.handler(ctx.data)}),this._htmlGeneratorContexts=null},getUnitTestMsg:function(){return this.article&&this.article.$unitTest?this.article.$unitTest.message:null}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/ctrlBase",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/controls/structElmt"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/controls/structElmt").Klass,_genHtmlCtrlLink=function(proto,dao,options,cb){var self=this;options=options||{};var html=[],url=proto.data("$url"),tag=options.tag||"a",css=options.css||"a";if(url&&url.length)html.push("<"),html.push(tag),html.push(' href="'+url+'"'),css&&html.push(' class="'+css+'"'),html.push(">");else{var action=proto.data("$action")||self.prototype.data("$navigation");if(action){html.push("<"),html.push(tag),html.push(' href="#"');for(var p in action)html.push(" "+p+'="'+encodeURIComponent(dao?dao.parseExpression(action[p]):action[p])+'"');css&&html.push(' class="'+css+'"'),html.push(">")}}return cb&&cb(html),html.length>1&&(html.push("</"),html.push(tag),html.push(">")),html.join("")},_Klass=utils.defineClass(function CtrlBase(controller,article,prototype,options){var self=this;options=options||{},self.prototype=prototype,self.$bind=article.$bind,Base.call(self,controller,prototype.data("$type"),article,options),self.$isEditMode=controller.isEditMode(),options.displayCtx==="table"&&(self.$isEditMode=!1)},Base,{destroy:function(){var self=this;Base.prototype.destroy.call(self),self.prototype&&(self.prototype.destroy(),self.prototype=null)},createId:function(typeName){return utils.readableuid(this.$bind,typeName.substr(0,3))},isPageControl:function(){return this.$type.smStartsWith("tablet/x-page-")},buildHtml:function($$parent,controllerDao,buildOptions,classes){Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions);var css=["s-m-control"],$theme=this.getAuthoring("$theme");$theme&&$theme!=="none"&&css.push("s-m-theme-"+$theme),classes&&css.push(classes.join(" ")),this.createRootElement(css,$$parent),this._oldValue=this.getValue(),globals.isAutoUITestMode()&&globals.getUnitTestMgr().addBindAttribute(this)},getUnitTestId:function(){return this.$bind?utils.unitTestId(this.$bind):utils.unitTestId(this.typeName)},afterRender:function(buildOpts){this.applyMetaData(this.getMetaData(),buildOpts)},refresh:function(controllerDao,options){if(options&&options.refreshValue){var newValue=this.getValue();utils.areEqual(newValue,this._oldValue)||(this.refreshValue(newValue),this._oldValue=newValue)}this.applyMetaData(this.getMetaData(),options)},refreshValue:function(value){},getMetaData:function(metaProp){var dao=this.getDao(),meta=dao?dao.getMetaData("$properties",this.$bind):null;return metaProp?meta?meta[metaProp]:null:meta},getTitle:function(){var ttl=this.article&&this.article.$title||this.prototype.data("$title")||this.prototype.getPropTitle(this.$bind);return(!ttl||ttl.length===0)&&globals.isAuthoringActive()&&this.prototype.isFacet("details","edit")&&(ttl=this.$bind),ttl},applyMetaData:function(metaData,buildOptions){if(metaData==null)return;if(this.$isEditMode){var e=this.$$elmt.find(".s-m-meta");e.length>0&&(e.is("input")&&!e.is(".btn")?(e[metaData.$isReadOnly===!0?"attr":"removeAttr"]("readonly",""),e[metaData.$isDisabled===!0?"attr":"removeAttr"]("disabled","")):e[metaData.$isReadOnly===!0||metaData.$isDisabled===!0?"attr":"removeAttr"]("disabled",""))}(this.article.$isHidden!=null||metaData.$isHidden!=null)&&this.$$elmt.toggleClass("s-m-hidden",this.article.$isHidden===!0||metaData.$isHidden===!0)},getValue:function(){var dao=this.getDao();return dao?dao.getValue(this.$bind):null},setValue:function(value){this.getDao().setValue(this.$bind,value)},checkData:function(){return!0},setErrorStatus:function(yes){if(!this.$$elmt)return;this.$$elmt[yes===!0?"addClass":"removeClass"]("error")},hasError:function(){return this.$$elmt&&this.$$elmt.hasClass("error")},setFocus:function(){if(!this.controller)return;this.controller.makeVisible(this)},isControl:function(){return!0},isAuthoringPropAllowed:function(property,value){return!0}});exports.genHtmlCtrlLink=_genHtmlCtrlLink,exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/validator",["require","exports","module","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var locale=require("syracuse-tablet/html/js/helpers/locale"),_validator={validate:function(ctrl,value,errors,constraints){var proto=ctrl.prototype,ok=!0;for(var i=0;i<constraints.length;i++){var c=constraints[i],prop=null;ctrl&&ctrl.getMetaData&&(prop=ctrl.getMetaData(c)),prop==null&&(prop=proto&&proto.data(c));if(prop!=null){var fn=_validator[c];fn?ok=fn(value,errors,prop)&&ok:(errors.push(locale.text("field.unknownConstraint",[c])),ok=!1)}}return ok},$isMandatory:function(value,errors,constraint){return!constraint||value!=null&&value!==""?!0:(errors.push(locale.text("field.valMand")),!1)},$pattern:function(value,errors,constraint){var self=this;if(value&&constraint){var re=new RegExp(constraint);if(!re.test(value))return errors.push(locale.text("field.patternError",[constraint])),!1}return!0},$minimum:function(value,errors,constraint){var self=this;return value!=null&&value<constraint?(errors.push(locale.text("field.minimum",[constraint])),!1):!0},$maximum:function(value,errors,constraint){var self=this;return value!=null&&value>constraint?(errors.push(locale.text("field.maximum",[constraint])),!1):!0},$exclusiveMinimum:function(value,errors,constraint){var self=this;return value!=null&&value<=constraint?(errors.push(locale.text("field.exclusiveMinimum",[constraint])),!1):!0},$exclusiveMaximum:function(value,errors,constraint){var self=this;return value!=null&&value>=constraint?(errors.push(locale.text("field.exclusiveMaximum",[constraint])),!1):!0},$minLength:function(value,errors,constraint){var self=this;return!value||value.length<constraint?(errors.push(locale.text("field.minLength",[constraint])),!1):!0},$maxLength:function(value,errors,constraint){var self=this;return value&&value.length>constraint?(errors.push(locale.text("field.maxLength",[constraint])),!1):!0},$precision:function(value,errors,constraint){var self=this;if(value){var txt=(""+value).split(".").join("");if(txt.length>constraint)return errors.push(locale.text("field.precision",[constraint])),!1}return!0},$scale:function(value,errors,constraint){var self=this;if(value){var txt=(""+value).split(".");txt=txt&&txt[1]||"";if(txt.length>constraint)return errors.push(locale.text("field.scale",[constraint])),!1}return!0}};exports.Validator=_validator}),define("syracuse-tablet/html/js/controls/field/ctrlFieldBase",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/controls/ctrlBase","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/formatApi","syracuse-tablet/html/js/controls/validator","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/native/native"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),Base=require("syracuse-tablet/html/js/controls/ctrlBase").Klass,uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),formatApi=require("syracuse-tablet/html/js/helpers/formatApi"),validator=require("syracuse-tablet/html/js/controls/validator").Validator,fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),native=require("syracuse-tablet/html/js/helpers/native/native"),_label_pos=["top","left"],_texr_align=["right","left","center"],_nativeCapabilityAutoring={scanBarcode:"$scanBarcode",GPS:"$scanGPS"},_Klass=utils.defineClass(function CtrlFieldBase(controller,article,prototype,options){Base.call(this,controller,article,prototype,options),this.formatter=this.initFormatter(),this._nativeCapabilities=this._initNativeCapabilities(options),this.cssType=null},Base,{_initNativeCapabilities:function(options){if(!options||!options.nativeCapabilities)return null;var res={};for(var capability in options.nativeCapabilities)res[capability]=options.nativeCapabilities[capability]===!0&&native.hasCapability(capability)===!0;return res},initFormatter:function(forceType,forceFormat){return forceType==null&&(forceType=this.$type),forceFormat==undefined&&(forceFormat=this.prototype.data("$format")),formatApi.getFormatter(forceType,forceFormat)},isNativeCapabilityEnabled:function(capability,authoringOnly){if(authoringOnly===!0&&globals.isAuthoringActive()){var authoring=this.getNativeCapabilityAuthoring(capability);return authoring!=null&&this.article[authoring]===!0}if(this._nativeCapabilities==null||this._nativeCapabilities[capability]!==!0)return!1;var authoring=this.getNativeCapabilityAuthoring(capability);return authoring==null||this.article[authoring]===!0},getNativeCapabilityAuthoring:function(capability){return!this.options||this.options.nativeCapabilities==null||this.options.nativeCapabilities[capability]!==!0?null:_nativeCapabilityAutoring[capability]},initReuseProperties:function(){Base.prototype.initReuseProperties.call(this),this.$$input=null,this.$$message=null,this.$$value=null},destroy:function(){Base.prototype.destroy.call(this),this.formatter=null},buildHtml:function($$parent,controllerDao,buildOptions){var classes=["s-m-field"];this.cssType&&classes.push(this.cssType),this.getAuthoring("$value.$valueFirst",!1)&&classes.push("s-m-valueFirst"),Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions,classes);var fieldSlot=this.$$elmt.get(0);this.buildFieldTitle(fieldSlot,buildOptions),this.buildFieldValue(fieldSlot,buildOptions),this._applyLabelAuthoring(),this.checkDiagnoses(buildOptions),this.checkEmptyValue(),this._checkNumVisiblePickers()},refreshValue:function(buildOptions){if(!this.$$value)return;this.buildFieldValue(this.$$elmt.get(0),buildOptions),this.checkEmptyValue()},checkEmptyValue:function(forceEmpty){if(this.$isEditMode)return;this.$$elmt.css("display",""),this.isEmpty=forceEmpty===!0||this.$$value==null||this.$$value.is(":empty"),this.$$elmt.toggleClass("s-m-empty",this.isEmpty);if(!this.isEmpty)return;if(this.getAuthoring("$hideIfEmpty")===!0){this.$$elmt.css("display","none");return}this.getAuthoring("$labelPosition")==="top"&&(this.$$value||(this.$$value=this._create$$value()),this.$$value.html("&nbsp;"))},_applyLabelAuthoring:function(){var val=this.getAuthoring("$labelPosition");this.$$elmt.removeClass("s-m-top"),val=="top"&&this.$$elmt.addClass("s-m-top"),this.$$elmt.removeClass("s-m-left s-m-right s-m-center"),val==="top"&&(val=this.getAuthoring("$labelAlign"),val!=null&&_texr_align.indexOf(val)>=0&&this.$$elmt.addClass("s-m-"+val))},_getNativePicker:function(){return this._nativeCapabilities?this.isNativeCapabilityEnabled("scanBarcode")?"scanBarcode":this.isNativeCapabilityEnabled("GPS")?"GPS":this.isNativeCapabilityEnabled("penTextInput")?"penTextInput":null:null},_addNativePickers:function(){if(!this._nativeCapabilities)return;if(globals.isMobile()){var nativeCapability=this._getNativePicker();nativeCapability&&this.addNativePicker(nativeCapability);return}var self=this;["penTextInput","GPS","scanBarcode"].forEach(function(nativeCapability){self.addNativePicker(nativeCapability).toggle(self.isNativeCapabilityEnabled(nativeCapability,!0))}),notifications.subscribe(this,["sm.auth.close","sm.auth.set.page"])},createMainInput:function(parent,value,type,attrs){type=type||"text",this._addNativePickers();var checkBox="checkbox"===type,css=["s-m-meta"];attrs=attrs||{},attrs.type=type;var element="input";return"text"===type?(css.push("form-control"),css.push("ctrl-evt-blur"),attrs.value=value):"textplain"===type?(element="textarea",css.push("form-control"),css.push("ctrl-evt-blur")):checkBox&&css.push("ctrl-evt-click"),this.options.notifyFocus===!0&&css.push("ctrl-evt-focus"),this.$$input=$(uiUtils.createDomElement(element,css,null,attrs)).prependTo(this._$$inputGroup||this.$$value),checkBox&&this.$$input.prop("checked",value),this.$$input},notifAuthClose:function(){if(!this.$$elmt)return;for(var p in _nativeCapabilityAutoring)this.$$elmt.find('button[data-action="'+p+'Picker"]').toggle(this.isNativeCapabilityEnabled(p,!1));this._checkNumVisiblePickers()},notifAuthSetPage:function(){if(!this.$$elmt)return;for(var p in _nativeCapabilityAutoring)this.$$elmt.find('button[data-action="'+p+'Picker"]').toggle(this.isNativeCapabilityEnabled(p,!0));this._checkNumVisiblePickers()},_checkNumVisiblePickers:function(){if(!this._$$inputGroupBtn)return;var $$pickers=$("button",this._$$inputGroupBtn),count=0;$.each($$pickers,function(idx,picker){$(picker).css("display")!=="none"&&(count+=1)}),this._$$inputGroupBtn.toggle(count>0)},addNativePicker:function(nativeCapability){return this.addPicker(nativeCapability,fontUtils.getIconByName(nativeCapability+"Picker"))},addPicker:function(type,icon){this._pickers||(this._pickers={});if(this._pickers[type])return this._pickers[type];this._pickers=this._pickers||{};var $$input;this._$$inputGroup||($$input=this.$$input?this.$$input.detach():null,this._$$inputGroup=$('<div class="input-group"/>').appendTo(this.$$value)),this._$$inputGroupBtn||(this._$$inputGroupBtn=$('<span class="input-group-btn"/>').appendTo(this._$$inputGroup));var $$picker=this._pickers[type]=$('<button data-control-id="'+this.id+'" data-action="'+type+'Picker" class="btn btn-default s-m-meta"><span class="'+icon+'"></span></button>');return $$input&&$$input.prependTo(this._$$inputGroup),$$picker.appendTo(this._$$inputGroupBtn)},_actPenTextInputPicker:function(){var self=this;native.getModule("penTextInput").getPenTextInput({title:self.getTitle(),value:self.getValue()}).then(function(data){if(data.action==="ok"&&data.matches&&data.matches.length){var values=[];data.matches.forEach(function(val){val=self.parseValue(val),(val!=null||val!="")&&values.push(val)});if(values.length===0)return;values=self.typeName==="string"?values.join(" "):values[0],self.setFieldValue(values)}})},_actGPSPicker:function(){var self=this;globals.getApplication().currentPage.waitWheelStart(),native.getModule("GPS").getGPSCoordinates().then(function(data){data.succeeded===!0?self.setFieldValue(data.latitude+", "+data.longitude):globals.getModal().notify({severityClass:"error",title:locale.text("gps.error")}),globals.getApplication().currentPage.waitWheelStop()}).fail(function(){globals.getApplication().currentPage.waitWheelStop()})},_actScanBarcodePicker:function(){var self=this;globals.getApplication().currentPage.waitWheelStart(),native.getModule("scanBarcode").scanBarcode().then(function(data){data.action==="ok"?self.setFieldValue(data.content):data.action==="cancelled"?globals.getModal().notify({severityClass:"info",title:locale.text("barcode.cancelled")}):globals.getModal().notify({severityClass:"error",title:locale.text("barcode.error")}),globals.getApplication().currentPage.waitWheelStop()}).fail(function(){globals.getApplication().currentPage.waitWheelStop()})},onFocus:function(justCheck){notifications.publish("sm.field.focus",this)},buildFieldTitle:function(fieldSlot,buildOptions){this.$$elmt.removeClass("s-m-title-hidden");if(this.getAuthoring("$isTitleHidden")){this.$$elmt.addClass("s-m-title-hidden");return}if(buildOptions&&buildOptions.displayCtx==="table")return;var ttl=(this.getTitle()||"").trim();ttl.length>0&&(this.getMetaData("$isMandatory")===!0&&(ttl+="*"),this.$$title=$(uiUtils.createDomElement("div",["s-m-title"],ttl,null,fieldSlot))),ttl.length||this.$$elmt.addClass("s-m-title-hidden")},buildFieldValue:function(fieldSlot,buildOptions){return this.$$value?(this._clear$$value(),this.clearInputErrors(),this.$$message=null):this._create$$value(fieldSlot),this.$$value.get(0)},_create$$value:function(fieldSlot){return this.$$value?this._clear$$value():this.$$value=$(uiUtils.createDomElement("div",["s-m-value",this.$isEditMode?"edit":""],null,null,fieldSlot||this.$$elmt)),this.$$value},_clear$$value:function(){this.$$value&&this.$$value.empty(),this._pickers&&(this._pickers=null),this.$$input=null,this._$$inputGroup=null,this._$$inputGroupBtn=null},appendTextValue:function(valueSlot,value){if(valueSlot==null||value==null)return;typeof value!="string"&&(value=value.toString?value.toString():"??Can't display??"),value=value.trim(),value.length>0&&uiUtils.appendTextNode(valueSlot,value)},validateValue:function(value,errors){return validator.validate(this,value,errors,["$isMandatory"])},parseValue:function(value,errors){return this.formatter?this.formatter.parseValue(value,errors):value},applyMetaData:function(metaData,buildOptions){Base.prototype.applyMetaData.call(this,metaData,buildOptions);if(buildOptions&&buildOptions.displayCtx==="table")return;if(metaData&&metaData.$diagnoses){var errors=[];metaData.$diagnoses.forEach(function(d){errors.push(d.$message)}),this.showInputErrors(errors)}},showInputErrors:function(errors){if(!this.$$elmt)return;this.$$elmt.removeClass("error"),this.$$message&&this.$$message.empty(),typeof errors=="string"&&(errors=[errors]);if(!errors||errors.length===0)return;this.$$message||(this.$$message=$('<span class="s-m-error"/>').appendTo(this.$$elmt)),this.$$elmt.addClass("error");var self=this;errors.forEach(function(error){error!=null&&(error+"").trim().length>0&&self.$$message.append($("<p>").text(error))})},clearInputErrors:function(){this.showInputErrors(null)},getFormattedValue:function(value){if(!this.formatter)return value==null?"":new String(value);try{return this.$isEditMode===!0?this.formatter.formatValueEdit(value):this.formatter.formatValue(value)}catch(e){return this.showInputErrors([e.message]),""}},setValue:function(value){Base.prototype.setValue.call(this,value)},setFieldValue:function(value){this.setDisplayValue(this.getFormattedValue(value)),this.setValue(value)},setFieldValueFromSelector:function(value){this.setFieldValue(value)},onBlur:function(justCheck){this.clearInputErrors();if(!this.$$input)return!0;var value=this.$$input.val(),errors=[];return value=this.parseValue(value,errors),errors.length===0&&(this.validateValue(value,errors),justCheck!==!0&&(this.setDisplayValue(this.getFormattedValue(value)),errors.length===0&&this.setValue(value))),errors.length>0&&this.showInputErrors(errors),errors.length==0},setDisplayValue:function(value){this.$$input&&this.$$input.val(value),this.clearInputErrors(),this.removeDiagnoses()},refresh:function(controllerDao,options){Base.prototype.refresh.call(this,controllerDao,options)},checkDiagnoses:function(options){var errors=[],diags=this.getMetaData("$diagnoses");return diags&&diags.length>0&&diags.forEach(function(d){d.$severity==="error"&&errors.push(d.$message)}),errors.length>0&&(options&&options.displayCtx==="table"?this.$$elmt.addClass("error"):this.showInputErrors(errors)),errors.length===0},checkData:function(){this.clearInputErrors();var meta=this.getMetaData();if(!meta||meta.$isDisabled!==!0&&meta.$isReadOnly!==!0&&meta.$isHidden!==!0){if(!this.onBlur(!0))return!1;var errors=[],value=this.getValue();return this.validateValue(value,errors),errors.length>0&&this.showInputErrors(errors),errors.length===0}return!0},removeDiagnoses:function(){this.getDao()&&this.getDao().removeMetaDiagnoses(this.$bind)},setFocus:function(){Base.prototype.setFocus.call(this),this.acceptFocus()&&(this.getFocusElmt().is("input, select")?this.getFocusElmt().focus():notifications.publish("sm.field.focus",this))},getFocusElmt:function(){return this.$$input},acceptFocus:function(){return this.getFocusElmt()!=null}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/field/ctrlAlphanum",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/field/ctrlFieldBase","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/controls/validator","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),validator=require("syracuse-tablet/html/js/controls/validator").Validator,fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_AlphaNum=utils.defineClass(function CtrlAlphaNum(controller,article,prototype,options){options=options||{},options.nativeCapabilities={penTextInput:!0,GPS:!0,scanBarcode:!0},Base.call(this,controller,article,prototype,options)},Base,{validateValue:function(value,errors){var ok=Base.prototype.validateValue.call(this,value,errors);return ok&&validator.validate(this,value,errors,["$pattern","$minLength","$maxLength"])},buildFieldValue:function(fieldSlot,buildOptions){var valueSlot=Base.prototype.buildFieldValue.call(this,fieldSlot,buildOptions),value=this.getFormattedValue(this.getValue());return this.$isEditMode?this.createMainInput(valueSlot,value):this.appendTextValue(valueSlot,value),valueSlot}}),_PhoneField=utils.defineClass(function CtrlPhoneField(controller,article,prototype,options){_AlphaNum.call(this,controller,article,prototype,options),this.cssType="s-m-phone"},_AlphaNum,{buildFieldValue:function(fieldSlot,buildOptions){if(this.$isEditMode)_AlphaNum.prototype.buildFieldValue.call(this,fieldSlot,buildOptions);else{var value=this.getFormattedValue(this.getValue()),link=uiUtils.createDomElement("span",[],"",{"data-action":"externalLink","data-params":"tel:"+value});value&&(link.appendChild(uiUtils.createDomElement("span",fontUtils.phoneFieldIcon())),$(link).append(value)),fieldSlot.appendChild(link)}}}),_EmailField=utils.defineClass(function CtrlEmailField(controller,article,prototype,options){_AlphaNum.call(this,controller,article,prototype,options),this.cssType="s-m-email"},_AlphaNum,{buildFieldValue:function(fieldSlot,buildOptions){if(this.$isEditMode)_AlphaNum.prototype.buildFieldValue.call(this,fieldSlot,buildOptions);else{var value=this.getFormattedValue(this.getValue()),link=uiUtils.createDomElement("span",[],"",{"data-action":"externalLink","data-params":"mailto:"+value});value&&(link.appendChild(uiUtils.createDomElement("span",fontUtils.emailFieldIcon())),$(link).append(value)),fieldSlot.appendChild(link)}}}),_UrlField=utils.defineClass(function CtrlUrlField(controller,article,prototype,options){_AlphaNum.call(this,controller,article,prototype,options),this.cssType="s-m-url"},_AlphaNum,{buildFieldValue:function(fieldSlot,buildOptions){if(this.$isEditMode)_AlphaNum.prototype.buildFieldValue.call(this,fieldSlot,buildOptions);else{var value,link,asValue,$urlLink=this.prototype.getUrlLink(this.$bind),valueSlot;if($urlLink.$url){asValue=this.getValue()?!0:!1,asValue&&(valueSlot=_AlphaNum.prototype.buildFieldValue.call(this,fieldSlot,buildOptions));if($urlLink.$url.indexOf("{"+this.$bind+"}")<0||asValue)value=this.prototype.resolveExpression($urlLink.$url,this._dao.data,!0)}else value=this.getFormattedValue(this.getValue());link=value?uiUtils.createDomElement("span",[],"",{"class":"s-m-icon-link","data-action":"externalLink","data-params":value}):null,link&&(link.appendChild(uiUtils.createDomElement("span",[])),$(link).addClass(this._getDefaultIcon()),valueSlot?valueSlot.appendChild(link):fieldSlot.appendChild(link))}},_getDefaultIcon:function(){var css="s-m-icon-"+(this.article.$urlIconSize||"small")+" ";return css+(this.article.$urlIcon||fontUtils.getUrlDefIcon()).css}});exports.Klass=_AlphaNum,exports.PhoneField=_PhoneField,exports.EmailField=_EmailField,exports.UrlField=_UrlField}),define("syracuse-tablet/html/js/controls/field/ctrlFilter",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/field/ctrlFieldBase"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,_Filter=utils.defineClass(function CtrlFilter(controller,article,prototype,options){options=options||{},options.nativeCapabilities=null,Base.call(this,controller,article,prototype,options)},Base,{buildFieldValue:function(fieldSlot,buildOptions){var valueSlot=Base.prototype.buildFieldValue.call(this,fieldSlot,buildOptions);this.appendTextValue(valueSlot,this.getValue()||"")}});exports.Klass=_Filter}),define("syracuse-tablet/html/js/controls/field/ctrlProgress",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/controls/field/ctrlFieldBase"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,defaultValues={$valueMin:0,$valueMax:100},_Klass=utils.defineClass(function CtrlProgress(controller,article,prototype,options){options=options||{},options.nativeCapabilities=null,Base.call(this,controller,article,prototype)},Base,{buildFieldValue:function(fieldSlot,buildOptions){var valueSlot=Base.prototype.buildFieldValue.call(this,fieldSlot,buildOptions),value=this.getValue(),progressContainer=uiUtils.createDomElement("div",["progress"]),progressBar=uiUtils.createDomElement("div",["progress-bar"],value,{role:"progressbar","aria-valuenow":value,"aria-valuemin":this.article.$valueMin||defaultValues.$valueMin,"aria-valuemax":this.article.$valueMax||defaultValues.$valueMax,style:"width:"+value+"%;"})}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/field/ctrlNumeric",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/field/ctrlFieldBase","syracuse-tablet/html/js/controls/validator","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,validator=require("syracuse-tablet/html/js/controls/validator").Validator,locale=require("syracuse-tablet/html/js/helpers/locale"),_Klass=utils.defineClass(function CtrlNumeric(controller,article,prototype,options){options=options||{},options.nativeCapabilities={penTextInput:!0},Base.call(this,controller,article,prototype,options)},Base,{buildFieldValue:function(fieldSlot,buildOptions){var self=this,valueSlot=Base.prototype.buildFieldValue.call(self,fieldSlot,buildOptions);$(valueSlot).addClass("s-m-numeric");var value=self.getFormattedValue(self.getValue());self.$isEditMode?self.createMainInput(valueSlot,value):self.appendTextValue(valueSlot,value)},parseValue:function(value,errors){var self=this;if(self.formatter){var format=self.formatter.getFormat();if(format){var gs=locale.getNumberGroupSeparator(),ds=locale.getNumberDecimalSeparator();format.indexOf(",")<0&&gs&&gs.length>0&&(value=value.replace(new RegExp("\\"+gs,"g"),ds)),format.indexOf(",")>0&&format.indexOf(".")>0&&gs&&gs.length>0&&value.indexOf(gs)>-1&&value.indexOf(ds)<0&&(value=value.replace(new RegExp(gs,"g"),ds))}}return Base.prototype.parseValue.call(self,value,errors)},validateValue:function(value,errors){var self=this,ok=Base.prototype.validateValue.call(self,value,errors);return ok=validator.validate(self,value,errors,["$minimum","$maximum","$exclusiveMinimum","$exclusiveMaximum","$precision"])&&ok,self.$type!=="application/x-integer"&&(ok=validator.validate(self,value,errors,["$scale"])&&ok),ok}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/field/ctrlQuantity",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/field/ctrlFieldBase","syracuse-tablet/html/js/controls/ctrlFactory"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,ctrlFactory=require("syracuse-tablet/html/js/controls/ctrlFactory"),_Klass=utils.defineClass(function CtrlQuantity(controller,article,prototype,options){options=options||{},options.nativeCapabilities=null,Base.call(this,controller,article,prototype,options),this.unitFieldInfo=prototype.getUnitFieldInfo(),this.displayUnit=!1,this.unitFieldInfo&&this.unitFieldInfo.unitFieldProto&&!this.unitFieldInfo.unitFieldProto.data("$isExcluded")&&(this.displayUnit=options&&options.displayCtx!=="table"),this.unitCtrl=null},Base,{initFormatter:function(){var valueProto=this.prototype.data("$value");return!valueProto||!valueProto.$type?null:Base.prototype.initFormatter.call(this,valueProto.$type,valueProto.$format)},destroy:function(){Base.prototype.destroy.call(this),this.unitCtrl&&(this.unitCtrl.destroy(),this.unitCtrl=null)},buildHtml:function($$parent,controllerDao,buildOptions){Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions),this.$$elmt.addClass("s-m-qty"),this.displayUnit&&(this.unitCtrl=ctrlFactory.createControl(this.controller,this,{$bind:this.unitFieldInfo.unitBindName,$noAuthoring:!0},this.unitFieldInfo.unitFieldProto,{isUnit:!0}),this.unitCtrl.buildHtml(this.$$value,controllerDao,buildOptions))},buildFieldValue:function(fieldSlot,buildOptions){var valueSlot=Base.prototype.buildFieldValue.call(this,fieldSlot,buildOptions);$(valueSlot).addClass("s-m-numeric");var value=this.getFormattedValue(this.getValue());this.$isEditMode?this.createMainInput(valueSlot,value):this.appendTextValue(valueSlot,value)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/field/ctrlCheckbox",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/controls/field/ctrlFieldBase","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_Klass=utils.defineClass(function CtrlCheckbox(controller,article,prototype,options){options=options||{},options.nativeCapabilities=null,Base.call(this,controller,article,prototype,options)},Base,{buildFieldValue:function(fieldSlot,buildOptions){var valueSlot=Base.prototype.buildFieldValue.call(this,fieldSlot,buildOptions),val=this.getValue();if(val==null&&!this.$isEditMode)return;val=val===!0,this.$isEditMode?this.createMainInput(valueSlot,val,"checkbox"):this.getAuthoring("$displayAs")==="text"?this.$$value.text(locale.text(val===!0?"yes":"no")):valueSlot.appendChild(uiUtils.createDomElement("span",fontUtils.checkBoxIcon(val)))},onClick:function(evt){var self=this;setTimeout(function(){var checked=!self.$$input.prop("checked");self.$$input.prop("checked",checked),self.setValue(checked)},50)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/field/ctrlSwitch",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/field/ctrlFieldBase","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),locale=require("syracuse-tablet/html/js/helpers/locale"),_Klass=utils.defineClass(function CtrlSwitch(controller,article,prototype,options){options=options||{},options.nativeCapabilities=null,Base.call(this,controller,article,prototype,options)},Base,{destroy:function(){this.$$panel&&(this.$$panel.bootstrapSwitch("destroy"),this.$$panel=null),Base.prototype.destroy.call(this)},buildFieldValue:function(fieldSlot,buildOptions){var valueSlot=Base.prototype.buildFieldValue.call(this,fieldSlot,buildOptions),val=this.getValue();if(val==null)return;val=val===!0;if(this.$isEditMode){var attrs={type:"checkbox"};this.$$panel=$(uiUtils.createDomElement("input","",null,attrs,valueSlot)),this.$$panel.bootstrapSwitch("state",val===!0,!0),this.$$panel.bootstrapSwitch("onText",locale.text("auth.switcher.onText")),this.$$panel.bootstrapSwitch("offText",locale.text("auth.switcher.offText")),this.$$panel.bootstrapSwitch("size","small"),this.$$panel.bootstrapSwitch("onColor","default"),this.$$panel.bootstrapSwitch("offColor","default"),this.$$panel.bootstrapSwitch("onSwitchChange",jsutils.bindFn(this.onSwitchChange,this))}else valueSlot.appendChild(uiUtils.createDomElement("span",fontUtils.checkBoxIcon(val)))},onSwitchChange:function(){this.setValue(this.$$panel.bootstrapSwitch("state"))}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/field/ctrlCombo",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/controls/field/ctrlFieldBase"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,_compareEnum=function(enum1,enum2){if(!enum1||!enum2)return!1;if(enum1.length!=enum2.length)return!1;for(var i=0,l=enum1.length;i<l;i++){if(enum1.$value!=enum2.$value)return!1;if(enum1.$title!=enum2.$title)return!1}return!0},_Klass=utils.defineClass(function CtrlCombo(controller,article,prototype,options){options=options||{},options.nativeCapabilities=null,Base.call(this,controller,article,prototype,options)},Base,{initReuseProperties:function(){Base.prototype.initReuseProperties.call(this),this.radioItemList=null,this._choiceList=null,this.valueSlot=null},buildFieldValue:function(fieldSlot,buildOptions){this.valueSlot=Base.prototype.buildFieldValue.call(this,fieldSlot,buildOptions),this._updateList(this.getMetaData(),!1)},refreshValue:function(buildOptions){this._updateList(this.getMetaData(),!0)},_updateList:function(metaData,valueChanged){var self=this;if(!self.valueSlot)return;var newList=metaData&&metaData.$value?metaData.$value.$enum:null;if(valueChanged!==!0&&_compareEnum(newList,self._choiceList))return;$(self.valueSlot).empty(),self._choiceList=$.extend(!0,[],newList);if(self.$isEditMode){var $format=metaData?metaData.$format:null;$format||($format=self.prototype.data("$format")),$format&&$format!="$radios"&&$format!="$combo"&&($format="$combo");var value=self.currentValue=self.getValue(),domValue;if(self._choiceList.length>0)if($format=="$radios")self.radioItemList=[],$.each(self._choiceList,function(index,choiceItem){var choiceItemDom=uiUtils.createDomElement("div",["s-m-field-radio-item"]),inputDom=uiUtils.createDomElement("input",["s-m-field-choice-radio","ctrl-evt-click","s-m-meta"],null,{type:"radio",value:index,name:"s-m-radio-"+self.id});value&&choiceItem.$value==value&&inputDom.setAttribute("checked",!0);var titleDom=uiUtils.createDomElement("div",["s-m-field-choice-radio-title"],choiceItem.$title);self.radioItemList.push({inputDom:inputDom,titleDom:titleDom}),self.valueSlot.appendChild(inputDom),self.valueSlot.appendChild(titleDom)});else{var selectDom=uiUtils.createDomElement("select",["form-control ctrl-evt-change","s-m-meta"]),selected=!1,opts=[],optDom;$.each(self._choiceList,function(index,choiceItem){var parsedTitle=self.prototype.resolveExpression(choiceItem.$title);optDom=uiUtils.createDomElement("option",null,parsedTitle,{value:choiceItem.$value},null),choiceItem.$value==value&&(optDom.setAttribute("selected",!0),selected=!0),opts.push(optDom)}),self.valueSlot.appendChild(selectDom),metaData.$isReadOnly||metaData.$isDisabled?selectDom.setAttribute("disabled",!0):selectDom.removeAttribute("disabled"),selected||(opts.length>0&&(opts.push(uiUtils.createDomElement("option",["empty"],"",{value:"",selected:!0},null)),metaData&&metaData.$isMandatory&&$(selectDom).addClass("removeEmptyOption")),value!=null&&(this.showInputErrors(locale.text("unexpected.value",[" ("+value+")"])),$(selectDom).addClass("ctrl-evt-click",!0))),opts.forEach(function(opt){selectDom.appendChild(opt)})}}else if(self._choiceList.length>0){var value=self.currentValue=self.getValue();value=self._getChoiceTitle(value),value=self.prototype.resolveExpression(value),self.appendTextValue(self.valueSlot,value)}},_getChoiceTitle:function(value){var res;return $.each(this._choiceList,function(index,choice){res=choice.$value==value?choice.$title:res;if(res)return!1}),res},getChoiceTitles:function(){var res=[],self=this;return $.each(this._choiceList,function(index,choice){res.push({$value:choice.$value,title:self.prototype.resolveExpression(choice.$title)})}),res},_getChoiceValue:function(title){var res;return $.each(this._choiceList,function(index,choice){res=choice.$title==title?choice.$value:res;if(res)return!1}),res},setDisplayValue:function(value,index){var self=this;self.$isEditMode&&self.prototype.data("$format")=="$radios"&&value!=self.currentValue&&$.each(self.radioItemList,function(idx,radioItem){setTimeout(function(){index?radioItem.inputDom.checked=index==idx:radioItem.inputDom.checked=self._choiceList[idx].$value==value},5)})},setFieldValue:function(value,index){this.setDisplayValue(value,index),this.currentValue=value,this.setValue(value)},onClick:function(evt){var $$t=$(evt.target);this.prototype.data("$format")=="$radios"?this.setFieldValue(this._getChoiceValue(evt.target.nextElementSibling.textContent),$(evt.target.parentNode).index()):$$t.is("select")&&(this.clearInputErrors(),$$t.removeClass("ctrl-evt-click"))},onChange:function(evt){var $$t=$(evt.target);$$t.is("select")&&$$t.is(".removeEmptyOption")&&$$t.removeClass("removeEmptyOption").find("option.empty").remove(),this.setFieldValue(evt.target.value,evt.target.selectedIndex)},applyMetaData:function(metaData,buildOptions){Base.prototype.applyMetaData.call(this,metaData,buildOptions),this._updateList(metaData)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/ui/datetimeSelectors/monthChoice",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/types/date"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),_dateApi=require("syracuse-tablet/html/js/helpers/types/date"),_Klass=utils.defineClass(function(){},null,{create:function(parentSlot,dateValue,handler){this.parent=parentSlot,this.handler=handler,this.domItem=document.createElement("nav"),this.domItem.className="s-calendar-quick-list",this._dateValue=dateValue;var table=document.createElement("table");table.className="s-calendar-month-choice";var tbody=document.createElement("tbody");for(var ii=0;ii<6;ii++){var row=document.createElement("tr");row.appendChild(this.drawCell(ii+1,_dateApi.monthName(ii+1,!0),this._dateValue.month)),row.appendChild(this.drawCell(ii+7,_dateApi.monthName(ii+7,!0),this._dateValue.month)),tbody.appendChild(row)}table.appendChild(tbody),this.domItem.appendChild(table),this.parent.appendChild(this.domItem),this.bindEvents(!0)},drawCell:function(value,text,selValue){var td=document.createElement("td");return td.className="s-calendar-my-item",td.syraOnClick="onMonthClick",td.syraValue=value,td.textContent=text,value==selValue&&(td.className+=" s-calendar-select",this.selectedCell=td),td},toggle:function(show){show?this.domItem.style.display="":this.domItem.style.display="none"},onMonthClick:function(picker){this.selectedCell&&(this.selectedCell.className="s-calendar-my-item"),(this.selectedCell=picker).className="s-calendar-my-item s-calendar-select",this._selectedMonth=picker.syraValue;var month=this._selectedMonth?this._selectedMonth:this._dateValue.month;this._currentDate=this._dateValue=_dateApi.fromJsDate(new Date(this._dateValue.year,month-1,this._dateValue.day)),this.handler.onEvent("onCalendarUpdate",this)},bindEvents:function(bind){var self=this;bind?$(self.domItem).delegate("td","click",function(evt){self.onClick(evt),evt.preventDefault(),evt.stopPropagation()}):$(self.domItem).undelegate()},onClick:function(evt){var self=this;while(evt.target){if(evt.target.syraOnClick){this[evt.target.syraOnClick](evt.target,evt);return}evt.target=evt.target.parentNode}},destroy:function(){this.bindEvents(!1),this.domItem=this._dateValue=this.selectedCell=null}});exports.MonthChoice=_Klass}),define("syracuse-tablet/html/js/ui/datetimeSelectors/yearChoice",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/types/date"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),_dateApi=require("syracuse-tablet/html/js/helpers/types/date"),_Klass=utils.defineClass(function(){},null,{create:function(parentSlot,dateValue,handler){this.parent=parentSlot,this.domItem=document.createElement("nav"),this.domItem.className="s-calendar-quick-list",this.handler=handler,this._dateValue=dateValue,this._selectedYear=this._dateValue.year;var table=document.createElement("table");table.className="s-calendar-year-choice";var tbody=document.createElement("tbody");this.rows=[];for(var ii=0;ii<6;ii++){var row=document.createElement("tr");if(ii==0)this.addPrevNextCell(row,!0),this.addPrevNextCell(row,!1);else{var cuYear=this._dateValue.year+ii-4;row.appendChild(this.drawCell(cuYear,cuYear)),row.appendChild(this.drawCell(cuYear+5,cuYear+5))}tbody.appendChild(row),this.rows.push(row)}table.appendChild(tbody),this.domItem.appendChild(table),this.parent.appendChild(this.domItem),this.bindEvents(!0)},addPrevNextCell:function(row,isPrev){var td=document.createElement("td");td.className="s-calendar-my-link-cell";var link=document.createElement("a");link.className=(link.syraIsPrev=isPrev)?"s-calendar-prev-year":"s-calendar-next-year",link.textContent=(link.syraIsPrev=isPrev)?locale.text("date.month.label.prev"):locale.text("date.month.label.next"),link.syraOnClick="onChangeYear",td.appendChild(link),row.appendChild(td)},drawCell:function(value,text){var td=document.createElement("td");return td.className="s-calendar-my-item",td.syraOnClick="onSelectYear",td.syraValue=value,td.textContent=text,value==this._selectedYear&&(td.className+=" s-calendar-select",this.selectedCell=td),td},toggle:function(show){show?this.domItem.style.display="":this.domItem.style.display="none"},_refreshYearCell:function(td,step){td.syraValue+=step,td.textContent=td.syraValue,td.syraValue==this._selectedYear&&(td.className+=" s-calendar-select",this.selectedCell=td)},onChangeYear:function(picker){var step=picker.syraIsPrev?-10:10;for(var ii=1,jj=this.rows.length;ii<jj;ii++){var nodes=this.rows[ii].childNodes;this._refreshYearCell(nodes[0],step),this._refreshYearCell(nodes[1],step)}},onSelectYear:function(picker){this.selectedCell&&(this.selectedCell.className="s-calendar-my-item"),(this.selectedCell=picker).className="s-calendar-my-item s-calendar-select",this._selectedYear=picker.syraValue;var year=this._selectedYear?this._selectedYear:this._dateValue.year;this._currentDate=this._dateValue=_dateApi.fromJsDate(new Date(year,this._dateValue.month,this._dateValue.day)),this.handler.onEvent("onCalendarUpdate",this)},bindEvents:function(bind){var self=this;bind?$(self.domItem).delegate("td","click",function(evt){self.onClick(evt),evt.preventDefault(),evt.stopPropagation()}):$(self.domItem).undelegate()},onClick:function(evt){var self=this;while(evt.target){if(evt.target.syraOnClick){this[evt.target.syraOnClick](evt.target,evt);return}evt.target=evt.target.parentNode}},destroy:function(){this.bindEvents(!1),this.rows=this.domItem=this._dateValue=this.selectedCell=null}});exports.YearChoice=_Klass}),define("syracuse-tablet/html/js/ui/datetimeSelectors/dateSelector",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/types/date","syracuse-tablet/html/js/ui/datetimeSelectors/monthChoice","syracuse-tablet/html/js/ui/datetimeSelectors/yearChoice"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),locale=require("syracuse-tablet/html/js/helpers/locale"),_dateApi=require("syracuse-tablet/html/js/helpers/types/date"),MonthChoice=require("syracuse-tablet/html/js/ui/datetimeSelectors/monthChoice").MonthChoice,YearChoice=require("syracuse-tablet/html/js/ui/datetimeSelectors/yearChoice").YearChoice,_Klass=utils.defineClass(function(){},null,{onClick:function(evt){var self=this,close;while(evt.target&&evt.target!=self.handler.parentSlot){if(evt.target.getAttribute("data-s-syraOnClick")){close=this[evt.target.getAttribute("data-s-syraOnClick")](evt.target,evt),close&&this.handler.closeContainer();return}evt.target=evt.target.parentNode}},onTodayClick:function(){return this._currentDate=_dateApi.today(),this.field.setFieldValueFromSelector(_dateApi.fromInternalValue(this._currentDate._value).toString()),!0},onDayClick:function(picker){return this.field.setFieldValueFromSelector(_dateApi.fromInternalValue(picker.getAttribute("data-s-syraValue")).toString()),!0},onChangePeriode:function(picker){picker.getAttribute("data-s-syraPeriod")=="month"?this._currentDate=this._currentDate.addMonths(picker.getAttribute("data-s-syraIsPrev")?-1:1):picker.getAttribute("data-s-syraPeriod")=="year"?this._currentDate=this._currentDate.addYears(picker.getAttribute("data-s-syraIsPrev")?-1:1):this._currentDate=this._currentDate.addDays(picker.getAttribute("data-s-syraIsPrev")?-7:7),this.handler.onEvent("onCalendarUpdate",this)},onMonthClick:function(){this.handler.onEvent("onMonthClick",this)},onYearClick:function(){this.handler.onEvent("onYearClick",this)},getValueForSelector:function(field){return field.getValue()&&field.getValue().slice(0,10)},create:function(field,handler){this.domItem=document.createElement("div"),this.domItem.className="s-calendar";var value=this.getValueForSelector(field)||"";return this._selectedDate=value?_dateApi.parse(value):_dateApi.today(),this._selectedDate=this._selectedDate._value==0?_dateApi.today():this._selectedDate,this._currentDate=handler._currentDate||_dateApi.fromInternalValue(this._selectedDate._value),this.field=field,this.handler=handler,this._table=document.createElement("table"),this._table.setAttribute("cellspacing",0),this._table.className="s-calendar-content",this._table.appendChild(this._appendHead()),this._table.appendChild(this.body=document.createElement("tbody")),this._table.appendChild(this._appendFoot()),this.domItem.appendChild(this._table),this._drawBody(),this.domItem},_appendHead:function(){var head=document.createElement("thead"),row=document.createElement("tr"),cell=document.createElement("th");cell.setAttribute("colspan",8),cell.className="s-calendar-month-year";var slot=document.createElement("div");slot.className="s-calendar-month-year-slot",cell.appendChild(slot);var link=document.createElement("a");link.setAttribute("data-s-syraOnClick","onChangePeriode"),link.setAttribute("data-s-syraIsPrev",!0),link.setAttribute("data-s-syraPeriod","year"),link.className="s-calendar-prev s-calendar-prev-year glyphicon glyphicon-fast-backward",slot.appendChild(link),link=document.createElement("a"),link.setAttribute("data-s-syraOnClick","onChangePeriode"),link.setAttribute("data-s-syraIsPrev",!0),link.setAttribute("data-s-syraPeriod","month"),link.className="s-calendar-prev s-calendar-prev-month glyphicon glyphicon-step-backward",slot.appendChild(link),this._monthLink=document.createElement("a"),this._monthLink.className="s-month s-calendar-month-year-link",slot.appendChild(this._monthLink).setAttribute("data-s-syraOnClick","onMonthClick"),this._yearLink=document.createElement("a"),this._yearLink.className="s-year s-calendar-month-year-link",slot.appendChild(this._yearLink).setAttribute("data-s-syraOnClick","onYearClick"),link=document.createElement("a"),link.setAttribute("data-s-syraOnClick","onChangePeriode"),link.setAttribute("data-s-syraPeriod","month"),link.className="s-calendar-next s-calendar-next-month glyphicon glyphicon-step-forward",slot.appendChild(link),link=document.createElement("a"),link.setAttribute("data-s-syraOnClick","onChangePeriode"),link.setAttribute("data-s-syraPeriod","year"),link.className="s-calendar-next s-calendar-next-year glyphicon glyphicon-fast-forward",slot.appendChild(link),row.appendChild(cell),head.appendChild(row),row=document.createElement("tr");var cell=document.createElement("th");cell.className="s-calendar-week-day",row.appendChild(cell);var days=[1,2,3,4,5,6,0];for(var ii=0,jj=days.length;ii<jj;ii++){var cell=document.createElement("th");cell.className="s-calendar-week-day",cell.title=_dateApi.dayName(days[ii]),cell.textContent=_dateApi.dayName(days[ii],!0),row.appendChild(cell)}return head.appendChild(row),head},_appendFoot:function(){var row=document.createElement("tr"),cell=document.createElement("td");cell.setAttribute("colspan",3),cell.className="s-calendar-foot-week";var link=document.createElement("a");link.setAttribute("data-s-syraOnClick","onChangePeriode"),link.setAttribute("data-s-syraPeriod","week"),link.className="s-calendar-prev s-calendar-prev-week glyphicon glyphicon-chevron-left",link.setAttribute("data-s-syraIsPrev",!0),cell.appendChild(link);var label=document.createElement("label");label.className="s-calendar-foot-week-title",label.textContent=locale.text("date.label.week"),cell.appendChild(label),this._weekNumber=document.createElement("label"),this._weekNumber.className="s-calendar-foot-week-title-num",cell.appendChild(this._weekNumber),link=document.createElement("a"),link.setAttribute("data-s-syraOnClick","onChangePeriode"),link.setAttribute("data-s-syraPeriod","week"),link.className="s-calendar-next s-calendar-next-week glyphicon glyphicon-chevron-right",cell.appendChild(link),row.appendChild(cell),cell=document.createElement("td"),cell.setAttribute("colspan",3),cell.className="s-calendar-foot-today",link=document.createElement("a"),link.className="s-calendar-today-link",link.setAttribute("data-s-syraOnClick","onTodayClick"),link.textContent=locale.text("date.label.today"),cell.appendChild(link),row.appendChild(cell),cell=document.createElement("td"),cell.setAttribute("colspan",2),row.appendChild(cell);var foot=document.createElement("tfoot");return foot.appendChild(row),foot},_drawBody:function(){var curMonth=this._currentDate.month||9,month=_dateApi.monthName(curMonth);this._monthLink.textContent=month,this._yearLink.textContent=this._currentDate.year||2014,uiUtils.empty(this.body);var curDate=_dateApi.fromInternalValue(this._currentDate._value),begOfMonth=curDate=curDate.begOfMonth();curDate=curDate.begOfWeek(1);for(var weekRow=0;weekRow<6;weekRow++){var row=document.createElement("tr"),weekDay=weekRow==0?begOfMonth:curDate,cell=document.createElement("td");cell.className="s-calendar-week-num",row.appendChild(cell),cell.textContent=weekDay.week;for(var day=0;day<7;day++){var cell=document.createElement("td");cell.className="s-calendar-day-link",cell.setAttribute("data-s-syraOnClick","onDayClick"),cell.setAttribute("data-s-syraValue",curDate._value);var link=document.createElement("a");link.textContent=curDate.day,curMonth!=curDate.month&&(cell.className+=" s-calendar-other-month"),this._currentDate.equals(curDate)&&(cell.className+=" s-calendar-select",link.className="s-calendar-select"),cell.appendChild(link),row.appendChild(cell),curDate=curDate.addDays(1)}this.body.appendChild(row)}this._weekNumber.textContent=this._currentDate.week},bindEvents:function(bind){var self=this,parentSlot=self.handler.getParentSlot();bind?$(parentSlot).delegate("td, a","click",function(evt){self.onClick(evt),evt.preventDefault(),evt.stopPropagation()}):($(parentSlot).undelegate(),self._month&&self._month.bindEvents(!1),self._year&&self._year.bindEvents(!1))},destroy:function(){this.bindEvents(!1),this._currentDate=this.field=this._currentDate=this.quickList=this._month=this._year=this._selectedDate=this._monthLink=this._yearLink=this._weekNumber=this._quick=this.body=this.domItem=null}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/ui/datetimeSelectors/timeSelector",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/types/time","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),_timeApi=require("syracuse-tablet/html/js/helpers/types/time"),locale=require("syracuse-tablet/html/js/helpers/locale"),_Klass=utils.defineClass(function(){},null,{onClick:function(evt){var self=this,close;while(evt.target){if(evt.target.getAttribute("data-s-syraOnClick")){close=this[evt.target.getAttribute("data-s-syraOnClick")](evt.target,evt),close&&this.handler.closeContainer();return}evt.target=evt.target.parentNode}},setContainer:function($$modalElmt){this.$$modalElmt=$$modalElmt},create:function(field,handler,cb){this.domItem=document.createElement("div"),this.domItem.className="s-time-choice";var options=options||{};this.columns=options.columns||2,this.interval=options.interval||60,this.field=field,this.handler=handler,this.cb=cb,this.curTime=_timeApi.now();var cellCount=1440/this.interval,rowCount=cellCount/this.columns,table=document.createElement("table");table.className="s-time-choice-table",table.setAttribute("cellspacing","0"),table.setAttribute("cellpadding","0");var row,cell,cellIndex=0,timeHour=_timeApi.parse("00:00:00");for(var rr=0;rr<rowCount;rr++){row=document.createElement("tr");for(var col=0;col<this.columns;col++){cell=document.createElement("td"),cell.className="s-time-choice-td";if(cellIndex<cellCount){var link=document.createElement("a");link.className="s-time-choice-a",link.setAttribute("data-s-syraOnClick","onTimeClick"),timeHour.hour==this.curTime.hour&&(link.className+=" s-time-select"),link.textContent=timeHour.toString(locale.getTimeFormat()),cell.appendChild(link)}row.appendChild(cell),timeHour=timeHour.addMinutes(this.interval),cellIndex++}table.appendChild(row)}return this.domItem.appendChild(table),this.domItem},onTimeClick:function(picker){var self=this,fieldVal=_timeApi.parse(picker.textContent,locale.getTimeFormat()).toString();if(!this.cb)return self.field.setFieldValueFromSelector(fieldVal),!0;self.cb(fieldVal,self.handler)},bindEvents:function(bind){var self=this,parentSlot=self.handler.getParentSlot();bind?$(parentSlot).delegate("a","click",function(evt){self.onClick(evt),evt.preventDefault(),evt.stopPropagation()}):$(parentSlot).undelegate()},destroy:function(){this.bindEvents(!1),this.domItem=this.field=this.selectedLink=null}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/ui/datetimeSelectors/selectorSwitchHandler",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/ui/datetimeSelectors/monthChoice","syracuse-tablet/html/js/ui/datetimeSelectors/yearChoice","syracuse-tablet/html/js/ui/datetimeSelectors/dateSelector","syracuse-tablet/html/js/ui/datetimeSelectors/timeSelector"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),MonthChoice=require("syracuse-tablet/html/js/ui/datetimeSelectors/monthChoice").MonthChoice,YearChoice=require("syracuse-tablet/html/js/ui/datetimeSelectors/yearChoice").YearChoice,DateSelector=require("syracuse-tablet/html/js/ui/datetimeSelectors/dateSelector").Klass,TimeSelector=require("syracuse-tablet/html/js/ui/datetimeSelectors/timeSelector").Klass,_Klass=utils.defineClass(function(field){this.field=field},null,{onEvent:function(evt,selector){this[evt](selector)},setContainer:function($$container){this.$$container=$$container},setParentSlot:function(parentSlot){this.parentSlot=parentSlot},getParentSlot:function(){return this.parentSlot},onMonthClick:function(selector){var self=this,date=selector._currentDate;uiUtils.empty(self.parentSlot),selector.destroy();var monthChoice=new MonthChoice;monthChoice.create(this.parentSlot,date,self)},onYearClick:function(selector){var self=this,date=selector._currentDate;uiUtils.empty(self.parentSlot),selector.destroy();var yearChoice=new YearChoice;yearChoice.create(self.parentSlot,date,self)},onOpenTime:function(selector){var self=this;self.dateValue=selector.dateValue,uiUtils.empty(self.parentSlot),selector.destroy();var timeSelector=new TimeSelector,sDom=timeSelector.create(self.field,self,self.onSelectTime);self.parentSlot.appendChild(sDom),timeSelector.bindEvents(!0)},onCalendarUpdate:function(selector){var self=this;self._currentDate=selector._currentDate,uiUtils.empty(self.parentSlot),selector.destroy();var dateSelector=new DateSelector,sDom=dateSelector.create(self.field,self);self.parentSlot.appendChild(sDom),dateSelector.bindEvents(!0)},onSelectTime:function(timeVal,handler){var self=handler;self.field.setFieldValueFromSelector(self.dateValue+" "+timeVal),self.closeContainer()},closeContainer:function(){this.$$container.modal("hide")}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/ui/datetimeSelectors/datetimeSelector",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/types/date","syracuse-tablet/html/js/ui/datetimeSelectors/dateSelector"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),_dateApi=require("syracuse-tablet/html/js/helpers/types/date"),Base=require("syracuse-tablet/html/js/ui/datetimeSelectors/dateSelector").Klass,_Klass=utils.defineClass(function(){},Base,{onTodayClick:function(){this._currentDate=_dateApi.today(),this.dateValue=_dateApi.fromInternalValue(this._currentDate._value).toString(),this.handler.onEvent("onOpenTime",this)},onDayClick:function(picker){this.dateValue=_dateApi.fromInternalValue(picker.getAttribute("data-s-syraValue")).toString(),this.handler.onEvent("onOpenTime",this)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/ui/selectorFactory",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/ui/modals/modal","syracuse-tablet/html/js/ui/datetimeSelectors/dateSelector","syracuse-tablet/html/js/ui/datetimeSelectors/selectorSwitchHandler","syracuse-tablet/html/js/ui/datetimeSelectors/datetimeSelector","syracuse-tablet/html/js/ui/datetimeSelectors/selectorSwitchHandler","syracuse-tablet/html/js/ui/datetimeSelectors/timeSelector","syracuse-tablet/html/js/ui/datetimeSelectors/selectorSwitchHandler"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),_selectors={date:{windows:null,android:null,ios:null,"default":require("syracuse-tablet/html/js/ui/datetimeSelectors/dateSelector").Klass,handler:require("syracuse-tablet/html/js/ui/datetimeSelectors/selectorSwitchHandler").Klass},datetime:{windows:null,android:null,ios:null,"default":require("syracuse-tablet/html/js/ui/datetimeSelectors/datetimeSelector").Klass,handler:require("syracuse-tablet/html/js/ui/datetimeSelectors/selectorSwitchHandler").Klass},time:{windows:null,android:null,ios:null,"default":require("syracuse-tablet/html/js/ui/datetimeSelectors/timeSelector").Klass,handler:require("syracuse-tablet/html/js/ui/datetimeSelectors/selectorSwitchHandler").Klass}},getType=function(propertyType){var type;switch(propertyType){case"application/x-date":type="date";break;case"application/x-datetime":type="datetime";break;case"application/x-time":type="time";break;default:type=null}return type},getSelector=function(propertyType){var type=getType(propertyType);if(type===null)throw new Error("Expected date/time/datetime type. Got "+propertyType);var laf=globals.getLookAndFeel(),selector=_selectors[type];selector&&(selector=selector[laf]||selector["default"]);if(!selector)throw new Error("Expected type. Got "+propertyType);return new selector},getHandler=function(field){var type=getType(field.$type);if(type===null)throw new Error("Expected date/time/datetime type. Got "+field.$type);var selector=_selectors[type];if(selector)var handler=selector.handler;return handler?new handler(field):null},_createSelector=function(field){if(!field||!field.setFieldValueFromSelector)throw new Error("_createSelector - Field must implement setFieldValueFromSelector");var sHandler=getHandler(field),ctrlSelector=getSelector(field.$type),selectorDom=ctrlSelector.create(field,sHandler),$$selectorModal=modal.field(field.getTitle(),selectorDom.outerHTML,function(modalEvent,$$modalElmt){modalEvent=="shown.bs.modal"?(sHandler&&(sHandler.setContainer($$modalElmt),sHandler.setParentSlot($$modalElmt.find(".modal-body")[0])),ctrlSelector.bindEvents(!0)):ctrlSelector.destroy()})};exports.createSelector=_createSelector}),define("syracuse-tablet/html/js/controls/field/ctrlDate",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/field/ctrlFieldBase","syracuse-tablet/html/js/ui/selectorFactory","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,selectorFactory=require("syracuse-tablet/html/js/ui/selectorFactory"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_Klass=utils.defineClass(function CtrlBase(controller,article,prototype,options){options=options||{},options.nativeCapabilities=null,Base.call(this,controller,article,prototype,options)},Base,{initReuseProperties:function(){Base.prototype.initReuseProperties.call(this)},buildFieldValue:function(fieldSlot,buildOptions){var valueSlot=Base.prototype.buildFieldValue.call(this,fieldSlot,buildOptions),value=this.getFormattedValue(this.getValue());this.$isEditMode?(this.addPicker("date",fontUtils.getIconByName(this.$type==="application/x-date"?"datePicker":"timePicker")),this.createMainInput(valueSlot,value)):this.appendTextValue(valueSlot,value)},_actDatePicker:function(){selectorFactory.createSelector(this)},setFieldValue:function(value){this.$type.indexOf("datetime")>-1&&value.length<=10&&(value+="T00:00:00.0Z"),Base.prototype.setFieldValue.call(this,value)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/array/searchArray",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/formatApi","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/fieldOperators"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),formatApi=require("syracuse-tablet/html/js/helpers/formatApi"),locale=require("syracuse-tablet/html/js/helpers/locale"),fieldOperators=require("syracuse-tablet/html/js/helpers/fieldOperators"),_templates={basicSearch:'		<nav class="s-m-search">            <div class="input-group stylish-input-group">                <input type="text" class="form-control"  placeholder="Search"  value="{{searchValue}}" >                <span class="input-group-addon">                    <span style="visibility:{{visibleRemove}}" class="glyphicon glyphicon-remove" data-action="actionArray" data-params="removeSearch"></span>					<span class="glyphicon glyphicon-search" data-action="actionArray" data-params="search"></span>                </span>            </div>		</nav>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl(ctx)},_exclude=["application/x-boolean"],_Klass=utils.defineClass(function(savedContext){this.searchValue=savedContext?savedContext.searchValue||"":"",this.searchInfos=this.searchValue?savedContext.searchInfos||[]:[],this.maxCrit=13},null,{destroy:function(){this.searchValue=null,this.$$search=null,this.searchInfos=null},getHtml:function(){var self=this;return self.$$search=$(_getHtml("basicSearch",{searchValue:self.searchValue,visibleRemove:self.searchValue!==""?"visible":"hidden"})),self.$$search},removeSearch:function(ctrl){this.searchValue="",this.searchInfos=[]},search:function(ctrl){this.searchValue=$(":input",this.$$search).val(),this.searchInfos=this.searchValue!=""?this._filterInfosGet(ctrl):[]},_filterInfosGet:function(ctrl){var columnInfo=ctrl.builder.getColumnsInfo(!0),proto=ctrl.prototype.create(ctrl.prototype.getDataByPath("$item")),props=proto.data("$properties"),control,$bind,$type,$capabilities,self=this,formatter,criteria=[],errors,val,$isReference;return columnInfo.forEach(function(column){control=column.control,$bind=column.$bindValue,$type=column.$type!="application/x-choice"?column.$bindType:column.$type,$isReference=column.$type.indexOf("x-reference")>=0,$capabilities=column.$capabilities||"";if($capabilities.indexOf("filter")>=0&&criteria.length<self.maxCrit&&_exclude.indexOf($type)<0&&self._hackFormat(props[$bind]))if($type!=="application/x-choice")errors=[],val=null,formatter=formatApi.getFormatter($type,props[$bind].$format),formatter?(val=formatter.parseValue(self.searchValue,errors),formatter.validateValue&&formatter.validateValue(self.searchValue,errors)):val=self.searchValue,$isReference&&val&&(val=val.toUpperCase()),errors.length===0&&val!==undefined&&criteria.push({operator:fieldOperators.getDefaultOperator($type),id:$bind,value:val,prop:props[$bind],isReference:$isReference});else{var valueList=self._getChoiceTitles(column.$value,proto);valueList.forEach(function(val){val.title.indexOf(self.searchValue)>-1&&criteria.length<self.maxCrit&&criteria.push({operator:fieldOperators.getDefaultOperator($type),id:$bind,value:val.$value,prop:props[$bind],isReference:$isReference})})}}),criteria},_getChoiceTitles:function($value,proto){var res=[],self=this;return $.each($value.$enum,function(index,choice){res.push({$value:choice.$value,title:proto.resolveExpression(choice.$title)})}),res},_hackFormat:function(proto){var searchable=!0;switch(proto.$type){case"application/x-integer":var gs=locale.getNumberGroupSeparator(),ds=locale.getNumberDecimalSeparator();searchable=!isNaN(gs&&gs.length>0?this.searchValue.replace(new RegExp("\\"+gs+"|\\s","g"),""):this.searchValue),searchable=searchable&&(ds&&ds.length>0?this.searchValue.indexOf(ds)<0:!0);break;case"application/x-decimal":case"application/x-real":case"application/x-integer":case"application/x-quantity":searchable=!isNaN(this.searchValue.replace(new RegExp("\\.|,|\\s","g"),""));break;default:searchable=proto.$maxLength?this.searchValue.length<=proto.$maxLength:!0}return searchable},getSearchInfos:function(){return this.searchInfos},savedCtxCreate:function(type){return this.searchValue==null||this.searchValue.trim().length==0?null:{searchValue:this.searchValue,searchInfos:this.searchInfos}},savedCtxRestore:function(ctx){}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/array/builderBase",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/scroller/scrollerHelpers","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),scroller=require("syracuse-tablet/html/js/helpers/scroller/scrollerHelpers"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_filterSortPanelId=globals.PANELFILTERSORT,_templates={pagin:'			<nav class="s-m-pagin"> 				<ul class="pagination"> 					{{#each links}}						<li>							<a class="s-m-link {{css}}"								href = "#"								data-action="pagination"								data-params="{{type}}"								data-control-id="{{id}}"								draggable="false">							</a>						</li>					{{/each}}				</ul> 			</nav> 		',filterSort:'		<div class="s-m-filterSort" data-action="actionArray" data-params="{{panelId}}">			<i class="s-m-sorted" style="display:none"></i>			<i class="s-m-filtered '+fontUtils.filterIcon("filtered")+'" style="display:none"></i>			<i class="'+fontUtils.filterIcon("panel")+'"></i>		</div>',$filtersList:'		<nav class="s-m-filterslist">			<select	class="form-control" data-action="actionArray">				{{#each filters}}					<option value="filterSelected,{{id}}" {{#if $isDefault}}selected=""{{/if}}>{{$title}}</option>				{{/each}}			</select>		</nav>',$filterstabs:'		<nav class="s-m-filtertabs">			<ul class="nav nav-pills nav-justified">				{{#each filters}}					<li role="presentation" role="tab" data-toggle="tab" data-action="actionArray" data-params="filterSelected,{{id}}" class="{{#if $isDefault}}active{{/if}}"><a href="#">{{$title}}</a></li>				{{/each}}			</ul>		</nav>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl||alert("template "+name+" not found"),tmpl(ctx)},_isExcluded=["application/x-password"],_paginLinks=["$first","$previous","$next","$last"],_Klass=utils.defineClass(function(control,disp,options){this.$display=disp,this.options=options||{};if(control==null)throw new Error("Null control");this.control=control,this.$articleArray=control.article,this.$arrayOptions=this.$articleArray.$arrayOptions,this.$itemProto=control.prototype.getPrototype("$item"),this._gestureMgr=null,this._lastSelectedRow=null},null,{initReuseProperties:function(){this.destroyScroller(),this._$$stdHeader=null,this._lastSelectedRow=null},destroy:function(){this.control=null,this.$itemProto&&(this.$itemProto.destroy(),this.$itemProto=null),this.destroyScroller()},isDestroyed:function(){return this.control==null||this.control.destroyed},refresh:function(arrayData,buildOptions){buildOptions=buildOptions||{},buildOptions.refresh=!0,this.buildHtml(arrayData,buildOptions)},buildHtml:function(arrayData,buildOptions,classes){},isRefreshContext:function(buildOpts){return buildOpts&&(buildOpts.refresh===!0||buildOpts.cardDesign===!0)||this.options&&this.options.displayCtx==="card"},checkEmptyArray:function(){return this.control._displayArray()?!0:(this.control.$$value.empty(),this.control.isEmpty&&(this.refreshHeaderAndGesture(),this.control.setEmptyArrayMsg()),!1)},notifClearContent:function(refresh){},notifyArrayDataChanged:function(refresh,arrayData,isEmpty){this.destroyScroller()},onResize:function(context){this.refreshHeaderAndGesture(context)},doAfterBuild:function(resizeContext,refreshHeaderGesture){(refreshHeaderGesture||this._needToBuildHeader())&&this.refreshHeaderAndGesture(resizeContext),this.control.controller.prototype.isFacet("details","edit","create")&&notifications.notifyController("sm.scroller.update",this.control.controller)},_needToBuildHeader:function(){if(this._arrayHeaderWasCreated===!0)return!1;var $filtersAuth=null,headerOpts=this.getHeaderOptions();return headerOpts&&headerOpts.$filters&&headerOpts.$filters.length>1&&($filtersAuth=this.control.controller.$filtersGetAuthoring?this.control.controller.$filtersGetAuthoring():null),this._isHeaderVisible($filtersAuth)},refreshHeaderAndGesture:function(resizeContext){var scrollOnly=resizeContext!=null&&resizeContext.scrollOnly,preserveScroll=resizeContext!=null&&resizeContext.preserveScroll,justRefresh=resizeContext!=null&&resizeContext.resizeEvent&&resizeContext.resizeEvent.type==="resize";scrollOnly!==!0&&this._refreshHeader(justRefresh),this._initGestureMgr(preserveScroll),this._lastSelectedRow&&this.selectLastSelectedRow(this._lastSelectedRow,!0)},_initGestureMgr:function(preserveScroll){this._gestureMgr&&(this.isScrollable()?this._gestureMgr.checkViewRect(this.control.getScrollViewRect(),preserveScroll):this._gestureMgr.reset());if(this._restoreSelectedRowId){var $$row=this.selectLastSelectedRow(this._restoreSelectedRowId,!0);$$row&&this._gestureMgr&&this._gestureMgr.makeVisible($$row),this._restoreSelectedRowId=null}},isScrollable:function(){return this.control.getArrayData().$resources.length>0},insertError:function(html){$(['<span class="s-m-error">',html,"</span>"].join("")).prependTo(this.control.$$elmt)},getHeaderOptions:function(){var queryOrLookup=!this.control.isArrayField(),controller=this.control.controller,opts={};opts.filterEnabled=opts.sortEnabled=opts.searchEnabled=queryOrLookup,opts.paginEnabled=opts.searchEnabled=queryOrLookup||this.control.hasLocalPagination(),opts.searchEnabled=opts.searchEnabled&&!controller.offLine,opts.$filters=queryOrLookup&&controller.$filtersGet?controller.$filtersGet():null;if(controller.prototype.isRequest()||controller.prototype.isStatistics())opts.sortEnabled=opts.searchEnabled=opts.filterEnabled=!1,opts.$filters=null;return opts},_refreshHeader:function(justRefresh){var $filtersAuth=null,headerOpts=this.getHeaderOptions();headerOpts&&headerOpts.$filters&&headerOpts.$filters.length>1&&($filtersAuth=this.control.controller.$filtersGetAuthoring?this.control.controller.$filtersGetAuthoring():null),justRefresh!==!0&&this._isHeaderVisible($filtersAuth)&&(this.control.$$header.children(".s-m-stdheader").remove(),this._buildArrayHeader(this.control.getArrayData(),$filtersAuth)),$filtersAuth==="tabs"&&(this.control.$$header.find(".s-m-filtertabs").remove(),this._build$Filters(headerOpts.$filters,$filtersAuth))},_isHeaderVisible:function($filtersAuth){return this.$arrayOptions.showPagination||this.$arrayOptions.showSortFilter||this.$arrayOptions.showSearch||$filtersAuth==="list"},_buildArrayHeader:function(arrayData,$filtersAuth){var headerOpts=this.getHeaderOptions()||{},empty=!0;this._arrayHeaderWasCreated=!0,this._$$stdHeader=$('<nav class="s-m-stdheader"/>').prependTo(this.control.$$header),headerOpts.paginEnabled===!0&&this.$arrayOptions.showPagination===!0&&!this.control.isCarouselDisplay()&&((this.control.isEmpty!==!0||globals.isAuthoringActive())&&this._buildPagin(this._$$stdHeader,arrayData),empty=!1),headerOpts.searchEnabled===!0&&this.$arrayOptions.showSearch===!0&&(this._$$stdHeader.append(this.control.getSearcher().getHtml()),empty=!1),(headerOpts.filterEnabled===!0||headerOpts.sortEnabled===!0)&&this.$arrayOptions.showSortFilter===!0&&(this._buildSortFilter(this._$$stdHeader),empty=!1),$filtersAuth==="list"&&(this._build$Filters(headerOpts.$filters,$filtersAuth),empty=!1),this._$$stdHeader.toggle(!this._$$stdHeader.is(":empty"))},_build$Filters:function(filters,$filtersAuth){if(!$filtersAuth||$filtersAuth=="none")return;if($filtersAuth=="list"){$(_getHtml("$filtersList",{filters:filters})).appendTo(this._$$stdHeader);return}if($filtersAuth=="tabs"){var filtersWithoutAll=[];for(var i=1;i<filters.length;i++)filtersWithoutAll.push(filters[i]);filtersWithoutAll.length>1&&$(_getHtml("$filterstabs",{filters:filtersWithoutAll})).appendTo(this.control.$$header);return}},_buildPagin:function($$parent,arrayData){var self=this,ctxLinks={links:[]},designMode=globals.isAuthoringActive(),nbEnabled=0,noPagin=!1;if(designMode&&self.control.getLocalPaginator()!=null||self.control.hasLocalPagination()){noPagin=!self.control.hasLocalPagination();var paginator=self.control.getLocalPaginator();_paginLinks.forEach(function(linkName){var ctx={css:fontUtils.paginationIcon(linkName)};!noPagin&&paginator.isActionEnabled(linkName)?(ctx.type=linkName,ctx.id=self.control.id,nbEnabled++):ctx.css+=" disabled",ctxLinks.links.push(ctx)})}else if(designMode||arrayData.$links&&!$.isEmptyObject(arrayData.$links))noPagin=arrayData.$links==null||$.isEmptyObject(arrayData.$links),_paginLinks.forEach(function(linkName){var ctx={css:fontUtils.paginationIcon(linkName)};!noPagin&&arrayData.$links&&arrayData.$links[linkName]!=null?(ctx.type=linkName,ctx.id=self.control.id,nbEnabled++):ctx.css+=" disabled",ctxLinks.links.push(ctx)});nbEnabled>0&&ctxLinks.links.length>0&&$(_getHtml("pagin",ctxLinks)).prependTo($$parent)},_buildSortFilter:function($$parent){this._$$sortFilter=$(_getHtml("filterSort",{ctrlId:this.control.id,panelId:_filterSortPanelId})),$$parent.append(this._$$sortFilter);var sortOrder=null,sortField=null,hasFilter=!1,info=this.control.sortInfoGet();info&&info.some(function(i){if(i.sort!="none")return sortOrder=i.sort,sortField=i.id,!0});var info=this.control.filterInfoGet();hasFilter=info&&info.length>0,this.filterSortUpdate(sortOrder,sortField,hasFilter)},filterSortUpdate:function(sortOrder,sortField,hasFilter){if(!this._$$stdHeader)return;var $$icon=this._$$stdHeader.find(".s-m-sorted").toggle(sortOrder!=null).removeClass();sortOrder!=null&&$$icon.addClass("s-m-sorted "+fontUtils.sortIcon(sortOrder)),this._$$stdHeader.find(".s-m-filtered").toggle(hasFilter===!0)},buildRecordMainElmt:function(rowData,options,idx){if(!options||!options.tag)throw new Error("buildRecordMainElmt - Bad options");options.css=options.css||[],options.css.unshift(globals.RECORDCLASS);var rowId=rowData?rowData.getValue("$uuid"):null;rowId&&this.control.acceptRowSelection()===!0&&this._addRowSelAction(options,rowId);var elmt=uiUtils.createDomElement(options.tag,options.css,options.title,options.attrs,options.parent);return globals.isAutoUITestMode()&&globals.getUnitTestMgr().arrayAddRowIndex($(elmt),idx,rowData),elmt},_addRowSelAction:function(options,rowId){options.attrs=options.attrs||{},options.attrs["data-params"]=encodeURIComponent(rowId),this.control.controller.isEditMode()||(options.tag==="a"&&(options.attrs.href="#"),options.attrs["data-action"]=globals.ACTROWSEL)},isExcluded:function(proto){return proto==null||proto.$isExcluded===!0||_isExcluded.indexOf(proto.$type)>=0},getId:function(){var self=this;return arguments.length>0?self.control.id+" - "+Array.prototype.join.call(arguments,"-"):self.control.id},_getRowById:function(rowId){return this.control.$$elmt.find("tbody ."+globals.RECORDCLASS+'[data-params="'+rowId+'"]')},removeRowById:function(rowId){return this._getRowById(rowId).remove()},selectLastSelectedRow:function(rowId,show){this._lastSelectedRow=rowId?rowId:null;if(rowId!=null)return this._getRowById(rowId)[show?"addClass":"removeClass"]("s-m-last-selected");this.control.$$value.find(".s-m-last-selected").removeClass("s-m-last-selected")},getSelectedRowId:function(){return this.control.$$elmt.find("."+globals.RECORDCLASS+".s-m-last-selected").attr("data-params")},callGenerateHtml:function(ctrlToGenerate,$$parent,rowData,destroyAfter,buildOptions,idx){buildOptions=buildOptions||{};var htmlRootCtrl=buildOptions.htmlRootCtrl||this.control,$$elmt=ctrlToGenerate.generateHtml($$parent,rowData,htmlRootCtrl,buildOptions.updateLayout);if(this.control.prototype.isSingleArray()&&idx!=null){var meta=ctrlToGenerate.getMetaData(),d;ctrlToGenerate.$type==="application/x-reference"?d=rowData.getValue(globals.SINGLEARRAYPROP):rowData.parent&&rowData.parent.data.$properties&&(d=rowData.parent.data.$properties,d&&d[rowData.$bind]&&(d=d[rowData.$bind].$items[idx])),d&&(meta||(meta={}),["$isHidden","$isReadOnly","$isDisabled"].forEach(function(p){d[p]!=null&&(meta[p]=d[p])})),(meta.$isHidden===!0||meta.$isReadOnly)&&$$elmt.closest(".s-m-record").addClass(meta.$isHidden?"hidden":"readonly"),ctrlToGenerate.applyMetaData(meta,buildOptions)}return ctrlToGenerate.$$elmt=null,destroyAfter===!0&&ctrlToGenerate.destroy(),$$elmt},addEmptyCells:function(rootLayout,$$row,nb,buildOptions,$$wrapper){var self=this;if(nb<1)return;var dispEmpty=self.$articleArray.$emptycell;if(dispEmpty==="withtitle"||dispEmpty==="filled"){var $$td=$('<td class="s-m-empty s-m-'+dispEmpty+' nohover">');$$wrapper&&($$parent=$$wrapper.appendTo($$td));var $$parent;for(var i=0;i<nb;i++)$$parent=$$td.clone().appendTo($$row),$$wrapper&&($$parent=$$parent.children().first()),this.callGenerateHtml(rootLayout,$$parent,null,!1,buildOptions)}return $$row.children("td.s-m-empty")},savedCtxCreate:function(type){if(type==="link"||!this._gestureMgr)return null;var ctx={$display:this.$display,lastSelectedRow:this._lastSelectedRow};return ctx.gestureMgr=this._gestureMgr.savedCtxCreate(type),ctx},savedCtxRestore:function(ctx){ctx.gestureMgr!=null&&this.$display===ctx.$display&&(this._gestureMgr?this._gestureMgr.savedCtxRestore(ctx.gestureMgr,!0):this._restoreGestureMgr=ctx.gestureMgr),ctx.lastSelectedRow&&(this._restoreSelectedRowId=ctx.lastSelectedRow)},newScroller:function(type,$$elmt,options){return this.destroyScroller(),options=$.extend({direction:type,name:this.control.$bind,isPageScroller:!1},options),options.valMax==null&&(options.valMax=0),this._gestureMgr=scroller.newScroller($$elmt,options,globals.getMainPageGestureMgr()),this._restoreGestureMgr!=null&&(this._gestureMgr.savedCtxRestore(this._restoreGestureMgr,!1),this._restoreGestureMgr=null),this._gestureMgr},destroyScroller:function(){this._gestureMgr&&(this._gestureMgr.destroy(),this._gestureMgr=null)},hasScroller:function(){return this._gestureMgr!=null},isEmptySingleArray:function(){return!this.control||!this.control.getArrayData()?!1:this.control.getArrayData().length>0?!1:this.control.prototype.isSingleArray()&&this.control.$$value.find(".s-m-record.hidden").length===this.control.getArrayData().$resources.length},isColumnDisplayed:function($bind){var cols=this.getColumnsInfo(!0);return cols?cols.some(function(c){return c.$bind===$bind}):!1},getColumnsInfo:function(onlyVisible){throw new Error("Not implemented")}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/array/builderTable",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/controls/array/builderBase","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/helpers/prototype","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/controls/ctrlFactory"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),builderBase=require("syracuse-tablet/html/js/controls/array/builderBase"),locale=require("syracuse-tablet/html/js/helpers/locale"),Base=builderBase.Klass,uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),reqProto=require("syracuse-tablet/html/js/helpers/prototype"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),ctrlFactory=require("syracuse-tablet/html/js/controls/ctrlFactory"),_fixedSzInfo={},_getFixedSizeInfo=function($$table){var dev=globals.getSiteLayout().getDeviceType(),r=_fixedSzInfo[dev];if(r)return r;var $$body=$("<tbody></body>").appendTo($$table),$$tr=$('<tr class="s-m-record"><td><div class="s-m-control s-m-field" style="width:100%"><div class="s-m-value" style="width:100%" ><span style="width:100%" id="text">MMMMMMMMMM</span></div></div></td><td class="s-m-icon"><div class="s-m-control s-m-icon"><a href="#" class="a"><span class="fa fa-hand-o-right"></span></a></div></td></tr>');$$tr.appendTo($$body);var tdWidth=$$tr.find("td").outerWidth(),valWidth=$$tr.find(".s-m-value").outerWidth(),textWidth=$$tr.find("#toto").width();return r={cellPadding:tdWidth-valWidth,charWidth:Math.ceil($$tr.find("#text").width()/10),iconWidth:$$tr.find("td.s-m-icon").outerWidth()},$$body.remove(),_fixedSzInfo[dev]=r,r},_createCellControl=function(arrayCtrl,$$parent,colInfo,fieldProto){var article={$bind:colInfo.$bind};return ctrlFactory.createCellFieldCtrl($$parent,arrayCtrl.controller,colInfo.article||colInfo,fieldProto)},_isExcluded=["application/json","application/x-array","application/x-document","application/x-binary"],_ADDROW="$ADDROW",_addRowBtn={$activity:"create",$type:"tablet/x-button",$icon:"addrow",$bind:_ADDROW,$text:"grid.addrow.label",$action:"rowCreate",$capabilities:["append"]},_additionalCols=[{$type:"tablet/x-icon",css:["s-m-icon"],$activity:"edit",$icon:"editrow",$bind:"$EDITROW",$action:globals.ACTROWDETAIL},{$type:"tablet/x-icon",css:["s-m-icon"],$activity:"edit",$icon:"delrow",$bind:"$DELETEROW",$action:globals.ACTROWDEL,$capabilities:"delete"},{$type:"tablet/x-icon",css:["s-m-icon"],$activity:"read",$icon:"detailrow",$bind:"$DETAILROW",$action:globals.ACTROWDETAIL}],_templates={sortedHeader:'<div><span>{{title}}</span><i class="{{css}}"></i></div>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl(ctx)},_Klass=utils.defineClass(function(control,disp,options){Base.call(this,control,disp,options),this._columnInfo=null},Base,{destroy:function(){Base.prototype.destroy.call(this),this._columnInfo&&(this._columnInfo.forEach(function(col){col.control&&col.control.destroy()}),this._columnInfo=null)},buildHtml:function(arrayData,buildOpts){buildOpts=buildOpts||{},Base.prototype.buildHtml.call(this,arrayData,buildOpts),this._createColumnInfo(buildOpts).length>0?this.isRefreshContext(buildOpts)&&this._build(buildOpts):this.control.$$value.addClass("empty")},notifyArrayDataChanged:function(refresh,arrayData,isEmpty){Base.prototype.notifyArrayDataChanged.call(this,refresh,arrayData,isEmpty)},onResize:function(context){if(this.isDestroyed())return;var scrollOnly=context!=null&&context.scrollOnly===!0;if(scrollOnly!=1&&this._columnInfo&&this._columnInfo.length>0){var buildOpts={updateLayout:context&&context.updateLayout};this._build(buildOpts,context)}else Base.prototype.onResize.call(this,context)},_build:function(buildOpts,resizeContext){if(!this.checkEmptyArray())return;buildOpts=buildOpts||{};var self=this,initScroll=buildOpts.refresh===!0||resizeContext;self.control.$$value.empty();var arrayData=self.control.getArrayData();if(!arrayData)return;var scrollMax=0,$$table=$('<table class="table table-condensed"/>').appendTo(self.control.$$value);self._calulateWidths($$table,arrayData);var $$headerScroll=self._buildTableHead($$table,buildOpts);if(arrayData.$resources.length>0||self.control.controller.isEditMode){var scrollable=this.isScrollable();if(scrollable){$$table=$('<table class="table table-condensed"/>').appendTo(self.control.$$value),$$headerScroll.css({fontSize:"0px",visibility:"hidden"}).appendTo($$table);if(self.$$tabHead&&self.$$tabHead.length>0&&$$headerScroll!=self.$$tabHead){var top=-1*$$headerScroll.height();$$table.css("top",top+"px"),self.$$tabHead.css("z-index",5e5),globals.isNativeScrolling()||(scrollMax=top)}}var $$body=$(uiUtils.createDomElement("tbody",null,null,null,$$table)),size=_getFixedSizeInfo($$body);for(var i=0;i<arrayData.$resources.length;i++)self._buildTableRow($$body,arrayData.$resources[i],i,buildOpts);self._buildTableFoot($$table,arrayData,buildOpts),scrollable&&self.newScroller("v",$$table.addClass("s-m-scroll-elmt").wrap('<div class="s-m-scroll-wrapper"/>'),{nopadding:!0,valMax:scrollMax})}this.doAfterBuild(resizeContext,!0)},isScrollable:function(){return this.control.$type===ctrlFactory.type("arrayChart")||!this.control.isArrayField()&&!this.control.controller.isNestedInDashboard("stack")},_calulateWidths:function($$table,arrayData){var self=this,size=_getFixedSizeInfo($$table),maxWidth=self.control.$$value.width()-self._nbAdditionalCols*size.iconWidth,fixedWidth=0,width;self._columnInfo.forEach(function(i){var art=i.article;i.fixedWidth=0,art&&art.$widthType==="fixed"&&art.$widthVal>0&&(width=size.charWidth*art.$widthVal+size.cellPadding,width>0&&fixedWidth+width<maxWidth&&(i.fixedWidth=width,fixedWidth+=width))});var remainingWidth=maxWidth-fixedWidth,percentWidth=0;self._columnInfo.forEach(function(i){var art=i.article;art&&art.$widthType==="percent"&&art.$widthVal>0&&(width=art.$widthVal*remainingWidth/100+size.cellPadding,width>0&&percentWidth+width<remainingWidth&&(i.fixedWidth=width,percentWidth+=width))})},_createColumnInfo:function(buildOpts){var self=this;if(self._columnInfo)return self._columnInfo;self._nbAdditionalCols=0,self._columnInfo=[];var nonDataCol=0;self.$arrayOptions.rowIndex&&(self._columnInfo.push({$bind:globals.ROWIDXPROP,proto:reqProto.getRowIdxProto(),cssHeader:"s-m-rowidx"}),nonDataCol++),this._statusList=this.control.getRowStatusInfo(),this._statusList!=null&&(self._columnInfo.push({$bind:"$ROWSTATUS",css:"s-m-row-status",proto:reqProto.create({$type:"tablet/x-row-status"})}),nonDataCol++);var proto,unfound=[],col,items=self.$articleArray.$table,protocols=self.control.getColumnsInfo();items||(items=protocols);var dataProps=self.control.getArrayData();dataProps=dataProps?dataProps.$properties:null,items.forEach(function(item,idx){if(item.$isHidden||dataProps&&dataProps[item.$bind]&&dataProps[item.$bind].$isHidden)return;item.$widthType=item.$widthType?item.$widthType:"auto",item.$widthVal=parseInt(item.$widthType==="auto"?0:item.$widthVal,10),item.$imgHeight=item.$imgHeight||"small",isNaN(item.$widthVal)&&(item.$widthVal=0),proto=self.$itemProto.property(item.$bind),proto?self.isExcluded(item,proto)||(col={$bind:item.$bind,proto:self.$itemProto.create(proto),article:item},col.css=[self.$itemProto.getFieldNameForValue(item.$bind)],col.article.$isTitleHidden===!0?col.title="":col.article.$title!=null&&col.article.$title!=item.$bind&&col.article.$titleOrig.indexOf("{@")>=0?col.title=self.$itemProto.resolveExpression(col.article.$titleOrig||col.article.$title)||"":col.title=col.proto.data("$title")||"",self._columnInfo.push(col)):unfound.push(item)});var edit=self.control.controller.isEditMode(),overflow=!this.control.prototype.isSingleArray()&&self._columnInfo.length-nonDataCol!=protocols.length;this.$arrayOptions.showRowDetailLink===!1&&(overflow=!1);var c;_additionalCols.forEach(function(col){(edit&&col.$activity==="edit"||!edit&&overflow&&col.$activity==="read")&&self.control.checkCapabilities(col.$capabilities)&&(c=$.extend(!0,{},col),c.$widthType="auto",self._columnInfo.push(c),self._nbAdditionalCols++)});if(unfound.length>0&&globals.getDvlpOpt("showUnfoundFields")){var html=["Field(s) not found<ul>"];unfound.forEach(function(x){html.push("<li><b>"+x.$bind+"</b></li>")}),html.push("</ul>"),self.insertError(html.join(""))}return self._columnInfo},getColumnInfo:function(){return this._columnInfo},isExcluded:function(item,proto){var self=this;return Base.prototype.isExcluded.call(self,proto)?!0:_isExcluded.indexOf(proto.$type)>=0||item.$isAdvanced===!0},_buildTableHead:function($$table,buildOpts){var self=this,$$tabHead=$(uiUtils.createDomElement("thead",null,null,null)),tr=uiUtils.createDomElement("tr",null,null,null,$$tabHead),th;self._columnInfo.forEach(function(col){th=uiUtils.createDomElement("th",col.cssHeader||col.css,col.title,null,tr),col.fixedWidth!=null&&col.fixedWidth>0&&$(th).width(col.fixedWidth)});var $$headerScroll;return this.control.getAuthoring("$tableHeaderShow")!==!1?($$headerScroll=$$tabHead.clone(),this.$$tabHead=$$tabHead.appendTo($$table)):$$headerScroll=$$tabHead,$$headerScroll},_buildTableFoot:function($$table,arrayData,buildOpts){var self=this;if(self.control.controller.isEditMode()&&this.control.checkCapabilities(_addRowBtn.$capabilities)){var $$cell=$('<tfoot><tr><td colspan="'+self._columnInfo.length+'"></td></tr></tfoot>').appendTo($$table).find("td"),fieldProto=self._getOtherColProto(_addRowBtn,""),ctrl=_createCellControl(self.control,$$cell,_addRowBtn,fieldProto);self.callGenerateHtml(ctrl,$$cell,self.control.controller.getEmptyDao(fieldProto),!0,buildOpts)}},_buildTableRow:function($$body,rowData,idx,buildOpts){var self=this,cssRowIdx;self.$arrayOptions.rowIndex&&rowData.setRowIndex(idx+1);var css=[],error=rowData.data.$arrayUpdateError;error===!0&&css.push("error"),idx%2===0&&css.push("s-m-even");var tr=self.buildRecordMainElmt(rowData,{tag:"tr",parent:$$body,css:css},idx),$$cell,fieldProto;return self._columnInfo.forEach(function(col,idx){$$cell=$(uiUtils.createDomElement("td",col.css||"",null,null,tr)),fieldProto=col.$activity!=null?self._getOtherColProto(col,rowData.data.$uuid,rowData,buildOpts):col.proto,col.control||(col.control=_createCellControl(self.control,$$cell,col,fieldProto)),self.callGenerateHtml(col.control,$$cell,rowData,!1,buildOpts,idx)}),tr},_getOtherColProto:function(colInfo,rowId,rowData,buildOpts){var self=this,mainArrayCtrl=buildOpts&&buildOpts.htmlRootCtrl?buildOpts.htmlRootCtrl:self.control,action=colInfo.$action,rowInfo={pathBind:[],pathId:[],activity:colInfo.$activity},create=colInfo.$activity==="create";if(create)rowId=utils.UUID(),rowInfo.pathId.unshift(rowId),rowInfo.pathBind.unshift(self.control.$bind);else{if(!rowData)throw new Error("unexpected null row data");var rd=rowData;rowInfo.pathId.unshift(rowId),rowInfo.pathBind.unshift(rd.$bind);while(rd.$bind!==mainArrayCtrl.$bind)rowInfo.pathId.unshift(rd.parent.getValue("$uuid")),rowInfo.pathBind.unshift(rd.parent.$bind),rd=rd.parent}mainArrayCtrl.rowDetailAdd(rowId,rowInfo);var json={$action:{"data-action":action}};return create&&(json.$action["data-params"]=rowId),["$type","$icon","$text"].forEach(function(x){x!=null&&x!="$activity"&&(json[x]=colInfo[x],x==="$text"&&(json[x]=locale.text(json[x])))}),reqProto.create(json)},filterSortUpdate:function(sortOrder,sortField,hasFilters){Base.prototype.filterSortUpdate.call(this,sortOrder,sortField,hasFilters);if(sortOrder&&sortField&&this.$$tabHead){var $$th=this.$$tabHead.find(".s-m-sorted");if($$th.length>1){var text=$$th.find("div > span")[0].text();$$th.removeClass()}$$th=this.$$tabHead.find("."+sortField);if($$th.length>0){var title=$$th.text();$$th.html(_getHtml("sortedHeader",{title:title,css:fontUtils.sortIcon(sortOrder)})),$$th.addClass("s-m-sorted "+sortOrder)}}this.searchUpdate()},searchUpdate:function(){var $$th,searcher=this.control.getSearcher(),self=this;self.$$tabHead&&(self.$$tabHead.find(".s-m-search").removeClass("s-m-search"),searcher&&searcher.searchInfos.forEach(function(column){$$th=self.$$tabHead.find("."+column.id),$$th.addClass("s-m-search ")}))},getColumnsInfo:function(onlyVisible){var cols;if(!this.control.prototype.isSingleArray()&&onlyVisible===!0){var ci=this._createColumnInfo();if(ci&&ci.length>0){var cols=[];ci.forEach(function(c){c.$action!==!0&&cols.push(c.$bind)})}}var protoCols=this.control.getColumnsInfo();if(cols==null)return protoCols;var res=[];return protoCols.forEach(function(c){cols.indexOf(c.$bind)>=0&&res.push(c)}),res}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/layout/layoutBase",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/structElmt","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/structElmt").Klass,fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_Klass=utils.defineClass(function LayoutBase(controller,type,article,opts){Base.call(this,controller,type,article,opts),this.title=article.$title},Base,{initReuseProperties:function(){Base.prototype.initReuseProperties.call(this),this.$$header=null},destroy:function(){Base.prototype.destroy.call(this)},createId:function(typeName){return utils.readableuid(typeName)},buildHtml:function($$parent,controllerDao,buildOptions){Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions),this.createRootElement(["s-m-layout"],$$parent),this.article.$title&&(buildOptions==null||buildOptions.noTitle!==!0)&&this.buildTitle(),this.article.$icon&&(buildOptions==null||buildOptions.noIcon!==!0)&&this.buildIcon()},getUnitTestId:function(){if(this.options.index==null)return;return utils.unitTestId(this.typeName.toLowerCase(),this.options.index)},buildChildrenHtml:function($parent,controllerDao,buildOptions){this.isEmpty=!0;if(this.children){var self=this;$.each(self.children,function(index,child){child.buildHtml($parent,controllerDao,buildOptions),child.afterRender&&buildOptions&&(buildOptions.isHtmlGenerator===!0||buildOptions.afterRender===!0)&&child.afterRender(buildOptions),self.isEmpty=self.isEmpty&&child.isEmpty})}buildOptions&&buildOptions.hideEmptyRows===!0&&this.$$elmt.toggleClass("s-m-empty",this.isEmpty)},onResize:function(context){if(!this.children)return;this.children.forEach(function(child){child.onResize&&child.onResize(context)})},_ensureHeader:function($$root){return this.$$header||(this.$$header=$("<header>").prependTo($$root||this.$$elmt)),this.$$header},buildIcon:function($$rootLyt,$$parent,controllerDao,destroyAfter){this._ensureHeader();var icon=fontUtils.getIconByName(this.article.$icon);icon&&this.$$header.addClass("s-m-has-ttl-icon").prepend('<i class="s-m-ttl-icon '+icon+'">')},buildTitle:function($$rootLyt,$$parent,controllerDao,destroyAfter){this._ensureHeader();var value=this.getArticleText("$title");if(this.isEditable){var uuid=this.getArticleTextUUID("$title");this.$$header.find("input.title").remove(),this.$$header.prepend('<input readonly class="title" '+(uuid?' data-old-uuid="'+uuid+'" data-old-value="'+value+'"':"")+' value="'+value+'"/>')}else this.$$header.find("span.title").remove(),this.$$header.prepend('<span class="title">'+value+"</span>")},getGestureMgr:function(){return null},isLayout:function(){return!0}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/layout/layoutRow",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/layout/layoutBase"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/layout/layoutBase").Klass,_checkEmptyRow=function($$row){if(!$$row)return;var fullCellMinWidth=$$row.width();fullCellMinWidth-=fullCellMinWidth/12;var emptyNotfw=[];$$row.children().each(function(){var $$cell=$(this);$$cell.width()>fullCellMinWidth?$$cell.addClass("s-m-fullwidth"):($$cell.removeClass("s-m-fullwidth"),emptyNotfw&&$$cell.is(".s-m-empty")?emptyNotfw.push($$cell):emptyNotfw=null)}),emptyNotfw&&emptyNotfw.forEach(function($$cell){$$cell.addClass("s-m-fullwidth")})},_checkEmptyRows=function($$rows){if(!$$rows)return;$$rows.each(function(){_checkEmptyRow($(this))})},_Klass=utils.defineClass(function LayoutRow(controller,type,article,opts){var self=this;Base.call(self,controller,type,article,opts)},Base,{buildHtml:function($$parent,controllerDao,buildOptions){Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions),this.$$elmt.addClass("s-m-row row"),this._setRowColorClass(),this.buildChildrenHtml(this.$$elmt,controllerDao,buildOptions),this.$$elmt.is(":empty")&&this.$$elmt.hide()},_setRowColorClass:function(){var self=this,color=self.article.$bgColor;color&&self.$$elmt.addClass("s-m-bg s-m-color-"+color)}});exports.Klass=_Klass,exports.checkEmptyRows=_checkEmptyRows}),define("syracuse-tablet/html/js/controls/array/builderCardBase",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/array/builderBase","syracuse-tablet/html/js/helpers/articleParser","syracuse-tablet/html/js/authoring/authoringArticleGen","syracuse-tablet/html/js/helpers/fieldOperators","syracuse-tablet/html/js/controls/layout/layoutRow"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/array/builderBase").Klass,articleParser=require("syracuse-tablet/html/js/helpers/articleParser"),articleGen=require("syracuse-tablet/html/js/authoring/authoringArticleGen"),fieldOperators=require("syracuse-tablet/html/js/helpers/fieldOperators"),layoutRow=require("syracuse-tablet/html/js/controls/layout/layoutRow"),_Klass=utils.defineClass(function(control,disp,options){Base.call(this,control,disp,options),this._layoutRoot=null,this._$$cellTmpl=$('<section class="s-m-card"/>')},Base,{initReuseProperties:function(){Base.prototype.initReuseProperties.call(this),this._$$body=null,this._$$rows=null,this._statusInfo=null},destroy:function(){Base.prototype.destroy.call(this),this._layoutRoot&&(this._layoutRoot.destroy(),this._layoutRoot=null),this._$$body&&(this._$$body.find(".carousel").remove(),this._$$body.remove(),this._$$body=null),this._$$cellTmpl=null,this._$$rows||(this._$$rows=null)},buildHtml:function(arrayData,buildOpts){Base.prototype.buildHtml.call(this,arrayData,buildOpts);if(this._layoutRoot==null){var cardArticle=this.$articleArray.$card;cardArticle||(cardArticle=articleGen.genNewArticle({page:{prototype:this.control.prototype}},!0));var options={displayCtx:"card",displayAsCarousel:buildOpts.htmlRootCtrl!==null,hideEmptyRows:this.$arrayOptions.hideEmptyRows===!0};this._layoutRoot=articleParser.article2Controls(this.control.controller,cardArticle,this.$itemProto,options)}this._statusInfo=this.control.getRowStatusInfo(),this.isRefreshContext(buildOpts)&&this._callBuildCards(buildOpts)},createCard:function($$parent,idx,rowData,buildOpts){var $$card=this._$$cellTmpl.clone().appendTo($$parent);return this.$arrayOptions.rowIndex===!0&&$('<span class="badge index">'+(idx+1)+"</span>").appendTo($$card),this._statusInfo&&this.checkStatusManagement($$parent,this._statusInfo,$$card,rowData),this.callGenerateHtml(this._layoutRoot,$$card,rowData,!1,buildOpts,idx),$$card},checkStatusManagement:function($$parent,statusInfo,$$cell,rowData){if(!statusInfo)return;var $$rootIcon=$$cell.find(".s-m-status");$$rootIcon.length===0&&($$rootIcon=$('<div class="s-m-status"/>').appendTo($$cell));var nbBckg=0;statusInfo.list.some(function(s){if(s.color&&fieldOperators.evaluateOperator(s.$type,rowData.getValue(s.field),s.operator,s.value))return s.icon?($('<div class="s-m-status-icon '+s.icon.css+'" style="color:'+s.color.bgColor+'"/>').appendTo($$rootIcon),statusInfo.type==="mono"):(s.color.css&&nbBckg===0&&($$parent.addClass("s-m-status-color "+s.color.css),nbBckg++),statusInfo.type==="mono")})},onResize:function(context){if(this.destroyed)return;var scrollOnly=context!=null&&context.scrollOnly===!0;if(scrollOnly!==!0){var buildOpts={updateLayout:context&&context.updateLayout};this._callBuildCards(buildOpts,context)}else Base.prototype.onResize.call(this,context)},_callBuildCards:function(buildOpts,context){if(!this.checkEmptyArray())return;this.buildCards(buildOpts,context)},buildCards:function(buildOpts,resizeContext){throw new Error("Not implemented")},authMinSize2Pixels:function(val){var max=700,min=100;return val=parseInt(val,10),val==null||isNaN(val)?200:val>20?max:val<1?min:min+val*(max-min)/20},checkEmptyRows:function(){if(!this._$$body)return;this._$$rows||(this._$$rows=this._$$body.find(".s-m-row")),layoutRow.checkEmptyRows(this._$$rows)},getColumnsInfo:function(onlyVisible){var cols=null;if(!this.control.prototype.isSingleArray()&&onlyVisible===!0&&this._layoutRoot){cols=[];var _scan=function(node){if(!node||!node.children)return;node.children.forEach(function(c){c.isControl()&&c.$bind?cols.push(c.$bind):_scan(c)})};_scan(this._layoutRoot)}var protoCols=this.control.getColumnsInfo();if(cols==null)return protoCols;var res=[];return protoCols.forEach(function(c){cols.indexOf(c.$bind)>=0&&res.push(c)}),res}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/array/builderCard",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/controls/array/builderCardBase"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/controls/array/builderCardBase").Klass,_Klass=utils.defineClass(function(control,disp,options){Base.call(this,control,disp,options)},Base,{initReuseProperties:function(){Base.prototype.initReuseProperties.call(this),this.resetProps(!1)},destroy:function(){Base.prototype.destroy.call(this),this.resetProps(!0)},resetProps:function(remove){this._tds=null,this._dirArray=null,this._$$body&&(remove&&(this._$$body.length&&this._$$body.remove(),this.destroyScroller()),this._$$body=null)},buildHtml:function(arrayData,buildOpts){this.$articleArray.$minWidth=this.$articleArray.$minWidth||6,Base.prototype.buildHtml.call(this,arrayData,buildOpts)},notifyArrayDataChanged:function(refresh,arrayData,isEmpty){Base.prototype.notifyArrayDataChanged.call(this,refresh,arrayData,isEmpty),this.resetProps(!0)},buildCards:function(buildOpts,resizeContext){buildOpts=buildOpts||{};if(!this._$$body){this.destroyScroller(),this._$$body=$("<tbody>").appendTo($("<table/>").appendTo(this.control.$$value));var $$td;this._tds=[];var self=this;this.control.getArrayData().$resources.forEach(function(rowData,idx){$$td=$(self.buildRecordMainElmt(rowData,{tag:"td",parent:null},idx)),self._tds.push({$$td:$$td,rowData:rowData})})}var dirArray,initScroll=!1;dirArray=globals.getScrollingDirection()||"v",initScroll=buildOpts.refresh===!0||resizeContext,dirArray=this.control.isArrayField()?"h":dirArray==="h"?"v":"v",buildOpts.cardAuthoring={$emptycell:this.$articleArray.$emptycell||"nodisplay",$minWidth:this.authMinSize2Pixels(this.$articleArray.$minWidth),$cardsPerRow:parseInt(this.$articleArray.$cardsPerRow,10)||2};var sz=this.control.getAvailableSize(),parentH=sz.height,parentW=sz.width,bs=this._$$body.parent().css("border-spacing");bs&&(bs=bs.split("px"),bs=bs&&bs.length>0?parseInt(bs[0],10):0);var $$hiddenRow,visibleTds=[];this._tds.forEach(function(o,idx){o.$$card&&o.$$card.css({height:"",width:""}),o.$$td.detach(),o.$$td.css("display")!="none"?visibleTds.push(o):($$hiddenRow||($$hiddenRow=$("<tr>").hide()),o.$$td.appendTo($$hiddenRow))}),this._$$body.empty(),$$hiddenRow&&$$hiddenRow.appendTo(this._$$body);if(visibleTds.length===0)return;dirArray==="h"?this.buildCardH(visibleTds,bs,parentH,parentW,buildOpts):this.buildCardV(visibleTds,bs,parentH,parentW,buildOpts);if(!this.control.isArrayField()&&!this.control.controller.isNestedInDashboard("stack")){var top=Math.max(0,(parentH-this._$$body.parent().outerHeight())/2);this._$$body.parent().css({top:top+"px"})}(this._dirArray==null||this._dirArray!=dirArray)&&(dirArray==="h"||dirArray==="v"&&!this.control.controller.isNestedInDashboard("stack"))&&(this._dirArray=dirArray,this.newScroller(dirArray,this._$$body.parent()),initScroll=!0),this.doAfterBuild(resizeContext,initScroll)},buildCardV:function(visibleTds,bs,parentH,parentW,buildOpts){this._$$body.parent().width("100%");var $$row,realW,nbCardPerRow,minWidth=buildOpts.cardAuthoring.$minWidth,remaining=0,self=this;visibleTds.some(function(o,idx){if(idx===0||nbCardPerRow==1||nbCardPerRow>1&&idx%nbCardPerRow===0)$$row=$("<tr>").appendTo(self._$$body),remaining=nbCardPerRow;remaining--,o.$$td.appendTo($$row),o.$$card||(o.$$card=self.createCard(o.$$td,idx,o.rowData,buildOpts));if(idx===0){var padding=o.$$card.outerWidth()-o.$$card.width();nbCardPerRow=buildOpts.cardAuthoring.$cardsPerRow;while(nbCardPerRow>1){realW=Math.round((parentW-(nbCardPerRow+1)*bs)/nbCardPerRow)-padding;if(realW>=minWidth)break;nbCardPerRow--}nbCardPerRow>1&&(realW=Math.min(Math.max(minWidth,realW)))}nbCardPerRow>1?o.$$card.width(realW):o.$$card.css({width:"100%"})}),remaining&&buildOpts.cardAuthoring.$emptyCell!=="nodisplay"&&this.addEmptyCells(this._layoutRoot,$$row,remaining,buildOpts,this._$$cellTmpl),this.$arrayOptions.hideEmptyRows===!0&&this.checkEmptyRows()},buildCardH:function(visibleTds,bs,parentH,parentW,buildOpts){var $$row,realH,realW,nbCardPerRow,numberOfRows,nbVisiblecardsPerRow=buildOpts.cardAuthoring.$cardsPerRow,minWidth=buildOpts.cardAuthoring.$minWidth;parentH-=bs;var remaining=0,self=this,maxHeight=0,h,heightChanged;visibleTds.some(function(o,idx){if(idx==0||nbCardPerRow==1||nbCardPerRow>1&&idx%nbCardPerRow===0)$$row=$("<tr>").appendTo(self._$$body),remaining=nbCardPerRow;o.$$td.appendTo($$row),o.$$card||(o.$$card=self.createCard(o.$$td,idx,o.rowData,buildOpts));if(idx===0){realH=o.$$td.height()+bs,parentW-=(nbVisiblecardsPerRow+1)*bs;var padding=o.$$card.outerWidth()-o.$$card.width();realW=Math.round(parentW/nbVisiblecardsPerRow)-padding,self.control.isArrayField()||visibleTds.length*realW<parentW?(numberOfRows=1,nbCardPerRow=visibleTds.length):(numberOfRows=Math.max(1,Math.floor(parentH/realH)),nbCardPerRow=Math.ceil(visibleTds.length/numberOfRows),visibleTds.length<=numberOfRows*nbVisiblecardsPerRow&&(nbCardPerRow=nbVisiblecardsPerRow)),remaining=nbCardPerRow}o.$$card.width(Math.min(parentW,Math.max(minWidth,realW)));var h=o.$$card.height();maxHeight===0?maxHeight=h:maxHeight!=h&&(heightChanged=!0,maxHeight=Math.max(maxHeight,h)),remaining--}),heightChanged&&visibleTds.forEach(function(o){o.$$card.height(maxHeight)});if(remaining&&buildOpts.cardAuthoring.$emptyCell!=="nodisplay"){var $$emptyCells=this.addEmptyCells(this._layoutRoot,$$row,remaining,buildOpts,this._$$cellTmpl);heightChanged&&$$emptyCells.height(maxHeight)}this.$arrayOptions.hideEmptyRows===!0&&this.checkEmptyRows()}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/array/builderCarousel",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/array/builderCardBase","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/scroller/hammerScroller"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/array/builderCardBase").Klass,jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),hammerScroller=require("syracuse-tablet/html/js/helpers/scroller/hammerScroller"),_templates={main:'<div id="{{id}}" class="carousel slide">					<div class="carousel-inner" role="listbox">					</div>					<footer>						<ul class="s-m-carousel-indicators">							<span class="first active"></span>							{{#if middle}}								<span class="middle"></span>							{{/if}}							{{#if last}}								<span class="last"></span>							{{/if}}						</ul>						<span class="left carousel-control {{leftIcon}}" aria-hidden="true"  href="#{{id}}" role="button" data-slide="prev"></span>						<span class="right carousel-control {{rightIcon}}" aria-hidden="true" href="#{{id}}" role="button" data-slide="next"></span>					</footer>			</div>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl(ctx)},_createHtmlGeneratorContext=function(carousel){return{handler:_destroyHtmlGeneratorContext,data:{$$body:carousel._$$body,swiper:carousel._swiper}}},_destroyHtmlGeneratorContext=function(data){if(!data)return;data.$$body&&data.$$body.length&&(data.$$body.remove(),data.$$body=null),data.swiper&&(data.swiper.destroy(),data.swiper=null)},_getInterval=function(period){return period==="slow"?6e3:period==="normal"?3e3:period==="fast"?1e3:-1},_Klass=utils.defineClass(function(control,disp,options){Base.call(this,control,disp,options)},Base,{initReuseProperties:function(){Base.prototype.initReuseProperties.call(this),this.resetProps(!1)},destroy:function(){Base.prototype.destroy.call(this),this.resetProps(!0)},resetProps:function(remove){remove&&this._destroySwiper(),remove&&this._$$body&&this._$$body.length&&this._$$body.remove(),this._$$body=null,this._cards=null},notifyArrayDataChanged:function(arrayData){Base.prototype.notifyArrayDataChanged.call(this,arrayData),this.resetProps(!0)},getHeaderOptions:function(){return{filterEnabled:!1,sortEnabled:!1,searchEnabled:!1,paginEnabled:!1,$filters:null}},buildCards:function(buildOpts,resizeContext){if(!this.checkEmptyArray())return;buildOpts=buildOpts||{};var interval=_getInterval(this.$articleArray.$carouselPeriod);if(!this._$$body){var ctx={id:"carousel"+this.control.id,leftIcon:fontUtils.getCarouselIcon("left"),rightIcon:fontUtils.getCarouselIcon("right")};this.control.getNbRecords()>0&&(ctx.last=this.control.getNbRecords()-1),this.control.getNbRecords()>1&&(ctx.middle=!0),this._$$body=$(_getHtml("main",ctx)).appendTo(this.control.$$value);var $$root=this._$$body.find(".carousel-inner");this._cards=[];var baseItm=$('<div class="item">'),$$item,$$record,self=this;this.control.getArrayData().$resources.forEach(function(rowData,idx){$$item=baseItm.clone().attr("data-idx",idx).appendTo($$root),idx===0&&$$item.addClass("active"),$$record=$(self.buildRecordMainElmt(rowData,{tag:"div",parent:$$item},idx)),self._cards.push(self.createCard($$record,idx,rowData,buildOpts))}),buildOpts.isHtmlGenerator===!0&&buildOpts.htmlRootCtrl&&buildOpts.htmlRootCtrl.addHtmlGeneratorContext(_createHtmlGeneratorContext(this))}var hasNextPrev=!isNaN(interval)&&interval<=0;this._$$body.find("footer").toggle(hasNextPrev),this._destroySwiper(),this._$$body.off("slid.bs.carousel"),hasNextPrev?(this._$$body.carousel("pause"),this._$$body.on("slid.bs.carousel",jsutils.bindFn(this._onEndSlide,this,this._$$body,this.control.getNbRecords()-1)),buildOpts.isHtmlGenerator!==!0&&this._initSwiper(this._$$body)):(this._$$body.carousel({interval:interval}),this._$$body.carousel("cycle"));var maxHeight=0,h,heightChanged;this._cards.forEach(function($$card,idx){$$card.css({height:"",width:""}),h=$$card.height(),maxHeight===0?maxHeight=h:maxHeight!=h&&(heightChanged=!0,maxHeight=Math.max(maxHeight,h))}),heightChanged===!0&&this._cards.forEach(function($$card){$$card.css("height",maxHeight+"px")}),this.$arrayOptions.hideEmptyRows===!0&&this.checkEmptyRows(),this.control.$$value.height(this._$$body.height()+"px"),this.doAfterBuild(resizeContext,!1)},_onEndSlide:function(evt,$$body,maxIdx){var $$active=$(evt.relatedTarget),idx=parseInt($$active.attr("data-idx"),10);idx!==maxIdx&&idx!==0&&(evt.direction==="right"?idx=idx===0?maxIdx:idx-1:idx=idx===maxIdx?0:idx+1),$$body.find("span.middle").toggleClass("active",idx>0&&idx<maxIdx),$$body.find("span.first").toggleClass("active",idx===0),$$body.find("span.last").toggleClass("active",idx===maxIdx)},_onSwipe:function(evt,$$body){if(evt.type!=="swipeleft"&&evt.type!=="swiperight"||hammerScroller.isEvtDirection(evt,"v"))return;$$body.carousel(evt.type==="swipeleft"?"next":"prev")},_destroySwiper:function(){this._swiper&&(this._swiper.destroy(),this._swiper=null)},_initSwiper:function($$parent){this._destroySwiper(),this._swiper=new hammerScroller.Hammer($$parent.get(0)),this._swiper.get("swipe").set({direction:hammerScroller.Hammer.DIRECTION_HORIZONTAL}),this._swiper.on("swipeleft swiperight",jsutils.bindFn(this._onSwipe,this,$$parent))}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/array/builderSeparator",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/array/builderBase","syracuse-tablet/html/js/controls/ctrlFactory"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/array/builderBase").Klass,ctrlFactory=require("syracuse-tablet/html/js/controls/ctrlFactory"),_createCellControl=function(arrayCtrl,$$parent,colInfo,fieldProto){var article={$bind:colInfo.$bind};return ctrlFactory.createCellFieldCtrl($$parent,arrayCtrl.controller,colInfo.article||colInfo,fieldProto)},_seps={semicolon:",",colon:":",blank:" ",dash:"-"},_Klass=utils.defineClass(function(control,disp,options){Base.call(this,control,disp,options)},Base,{destroy:function(){Base.prototype.destroy.call(this),this._columnInfo&&(this._columnInfo.forEach(function(col){col.control&&col.control.destroy()}),this._columnInfo=null)},buildHtml:function(arrayData,buildOpts){buildOpts=buildOpts||{},Base.prototype.buildHtml.call(this,arrayData,buildOpts),this._createColumnInfo(),this._build(arrayData,buildOpts)},notifyArrayDataChanged:function(refresh,arrayData,isEmpty){Base.prototype.notifyArrayDataChanged.call(this,refresh,arrayData,isEmpty)},_createColumnInfo:function(){if(this._columnInfo)return this._columnInfo;this._columnInfo=[];var items=this.control.getColumnsInfo(),self=this,proto,col;return items.forEach(function(item,idx){if(item.$isHidden)return;proto=self.$itemProto.property(item.$bind);if(!proto)return;self.isExcluded(item,proto)||(col={$bind:item.$bind,proto:self.$itemProto.create(proto),article:item},col.css=[self.$itemProto.getFieldNameForValue(item.$bind)],col.title="",self._columnInfo.push(col))}),this._columnInfo},_isHeaderVisible:function(){return!1},_getSep:function(){return _seps[this.control.article.$separator||"blank"]||" "},_build:function(arrayData,buildOpts){this.control.$$value.empty();var $$section=$("<section/>").appendTo(this.control.$$value),self=this,sep=this._getSep(),$$sep;arrayData.$resources.forEach(function(data,idx){idx>0&&($$sep=$('<span class="s-m-separator"/>').appendTo($$section).text(sep),sep===","&&$$sep.css("text-align","left")),self._buildCell($$section,data,idx,buildOpts)})},_buildCell:function($$parent,rowData,idx,buildOpts){var self=this;self._columnInfo.forEach(function(col,idx){col.control||(col.control=_createCellControl(self.control,$$parent,col,col.proto)),self.callGenerateHtml(col.control,$$parent,rowData,!1,buildOpts,idx)})}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/array/ctrlArray",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/controls/ctrlBase","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/ui/modals/modal","syracuse-tablet/html/js/application/eventListener","syracuse-tablet/html/js/sdata/sdataUtils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/fieldOperators","syracuse-tablet/html/js/controls/array/searchArray","syracuse-tablet/html/js/application/appFactory","syracuse-tablet/html/js/controls/array/builderTable","syracuse-tablet/html/js/controls/array/builderCard","syracuse-tablet/html/js/controls/array/builderCarousel","syracuse-tablet/html/js/controls/array/builderSeparator"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/controls/ctrlBase").Klass,uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),eventListener=require("syracuse-tablet/html/js/application/eventListener"),sdataUtils=require("syracuse-tablet/html/js/sdata/sdataUtils"),locale=require("syracuse-tablet/html/js/helpers/locale"),fieldOperators=require("syracuse-tablet/html/js/helpers/fieldOperators"),SearchArray=require("syracuse-tablet/html/js/controls/array/searchArray").Klass,factory=require("syracuse-tablet/html/js/application/appFactory"),_typeDefValue=function(prop){switch(prop.$type){case"application/x-password":case"application/x-string":return"";case"application/x-quantity":return 0;case"application/x-decimal":case"application/x-real":return 0;case"application/x-integer":return 0;case"application/x-boolean":return!1;case"application/x-date":return"";case"application/x-datetime":return"";case"application/x-time":return"";case"application/x-choice":return prop.$value.$enum[0].$value;case"application/x-reference":return{$value:"",$description:"",$title:""};case"application/x-array":return[];default:return null}},_dataProps=["$isMandatory","$isReadOnly","$isHidden","$isExcluded","$isDisabled","$actions","$format"],_proto2Instance=function(protoArray){var res;if(protoArray.isSingleArray())res={$properties:{"~data~":""}};else{res={$properties:{}};var props=protoArray.getDataByPath("$item.$properties");for(var propName in props)if(!propName.smStartsWith("$")){var prop=props[propName];res[propName]=_typeDefValue(prop);var $properties=res.$properties[propName]={};_dataProps.forEach(function(p){prop[p]!=null&&($properties[p]=prop[p])})}}return res},_LocalPaginator=utils.defineClass(function(arrayCtrl,options){options=options||{},this._length=options.length,this.count=options.count||10,this._arrayCtrl=arrayCtrl,this._nbPagin=Math.floor(this._length/this.count),this._lastIdx=this.count*(this._length%this.count===0?this._nbPagin-1:this._nbPagin),this._lastIdx<this.count&&(this._lastIdx=0),this.first()},null,{destroy:function(destroyProto){this._arrayCtrl=null},first:function(){return this.currentIdx=0,this.currentIdx},last:function(){return this.currentIdx=this._lastIdx,this._lastIdx},next:function(){return this.currentIdx=Math.min(this._lastIdx,this.currentIdx+this.count),this.currentIdx},prev:function(){return this.currentIdx=Math.max(0,this.currentIdx-this.count),this.currentIdx},isActionEnabled:function(act){switch(act){case"$last":case"$next":return this.currentIdx<this._lastIdx;case"$first":case"$previous":return this.currentIdx>0}},isEnabled:function(){return this._length>this.count},doAction:function(act){switch(act){case"$next":return this.next();case"$previous":return this.prev();case"$first":return this.first();case"$last":return this.last()}}}),_sortFilterExclude=["application/x-array","image","application/x-document","application/x-binary","application/x-object","text/rtf","text/html","text/plain"],_notImplemented=function(text){throw new Error("The following feature in not implemented -> "+text)},Builders={table:require("syracuse-tablet/html/js/controls/array/builderTable").Klass,card:require("syracuse-tablet/html/js/controls/array/builderCard").Klass,carousel:require("syracuse-tablet/html/js/controls/array/builderCarousel").Klass,separator:require("syracuse-tablet/html/js/controls/array/builderSeparator").Klass},_destroyArrayData=function(a){return!a||!a.$resources?null:(a.$resources.forEach(function(r){r&&r.destroy()}),null)},_Klass=utils.defineClass(function CtrlArray(controller,article,prototype,options){Base.call(this,controller,article,prototype,options),this._initArrayAuththoring(),this._newBuilder(options),this._arrayData=null;var savedContext=controller.getCtrlSavedContext(this.$bind);this._search=new SearchArray(savedContext?savedContext.$search:null),this._rowDetailCache={},this._rowDetailInfo=null,article.$arrayBgColor==null&&(article.$arrayBgColor=globals.CARDARRAYDEFCOLOR)},Base,{_initArrayAuththoring:function(){this.$display=this.controller.isEditMode()||!this.article.$display?"table":this.article.$display;var defaults;this.controller.isVignette?defaults={showPagination:!1,showSortFilter:!1}:this.controller.state.type==="chartdetail"?defaults={showPagination:!1,showSortFilter:!1,showSearch:!1}:defaults={showPagination:!0,showSortFilter:!0,showSearch:!0},defaults.rowIndex=this.$display==="card",this.article.$arrayOptions=$.extend(defaults,this.article.$arrayOptions||{}),this.controller.state.type==="chartdetail"?this.article.$arrayOptions.showRowDetailLink=!1:this.controller.state.type==="rowdetail"?this.article.$arrayOptions.showRowDetailLink=!0:this.article.$arrayOptions.showRowDetailLink==null&&(this.article.$arrayOptions.showRowDetailLink=!1)},_newBuilder:function(options){this.$display==="carousel"&&(this.$display="card",options.displayAsCarousel=!0);var BuilderClass=Builders[this.$display=="card"?options.displayAsCarousel?"carousel":"card":this.$display];BuilderClass||(this.$display="table",BuilderClass=Builders.table),this.builder=new BuilderClass(this,this.$display,options)},isCarouselDisplay:function(){return this.$display==="card"&&this.options.displayAsCarousel===!0},getMode:function(){return this.builder&&this.builder.$display},initReuseProperties:function(){Base.prototype.initReuseProperties.call(this),this._arrayData&&(this._arrayData=_destroyArrayData(this._arrayData)),this.builder&&this.builder.initReuseProperties(),this.$$ttl=null},destroy:function(){this._multiSelStop(),this._rowDetailInfo=null,this._rowDetailCache=null,this._localPaginator&&(this._localPaginator.destroy(),this._localPaginator=null),Base.prototype.destroy.call(this),this.prototype=null,this.builder&&(this.builder.destroy(),this.builder=null),this._arrayData&&(this._arrayData=_destroyArrayData(this._arrayData),this._arrayData=null),this._waiting&&(uiUtils.waitWheelDestroy(this._waiting),this._waiting=null),this._filterSortPanel&&(this._filterSortPanel.destroy(),this._filterSortPanel=null),this._search&&(this._search.destroy(),this._search=null)},isArrayField:function(){return this.controller?!this.controller.prototype.isQueryLikeFacet():!1},isArrayChart:function(){return!1},buildHtml:function($$parent,controllerDao,buildOptions){if(this.builder==null)throw new Error("Null builder");if(this.builder.$display!==this.$display)throw new Error("Unexpected display type","Current display",this.builder.$display,"New display",this.$display);var css="s-m-"+this.$display;Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions,["s-m-array",css]),this._setArrayData(controllerDao,!1);var hasFilerSort=!this.isArrayField();hasFilerSort&&(this._filterSortPanel=this.controller.panelCreate(globals.PANELFILTERSORT,{parentArray:this,filter:!0,sort:!0})),this.builder.buildHtml(this._arrayData,buildOptions),this.prototype.isSingleArray()&&this.builder.isEmptySingleArray()&&(this.isEmpty=!0),this.isArrayField()&&!this._displayArray()&&(this.$$ttl==null||this.$$ttl.empty())&&this.$$elmt.hide()},refresh:function(controllerDao,options){this._rowDetailInfo=null,this._capabilities=null;if(this.builder==null)throw new Error("Null builder");this.builder.refresh(this._setArrayData(controllerDao,!0),options)},onResize:function(context){if(!this.$$elmt||!this.$$elmt.is(":visible")){this._subscribedExpand||(this._subscribedExpand=!0,notifications.subscribe(this,["sm.layout.expanded"]));return}this._subscribedExpand&&(notifications.unsubscribe(this,["sm.layout.expanded"]),this._subscribedExpand=!1),this.builder.onResize(context),this.notifyVignetteArrayHosted()},_notifSelectedRow:function(rowId,rowData){notifications.notifyController("synch.sm.select.row",this.controller,this.id,rowId,rowData)},_actRowSelect:function(rowId,$$target){if(this._multiSelSelect($$target))return;var rowData=this.getRowById(rowId);if(!rowData)return;rowData=rowData.row;if(this.controller.isLookup()){var proto=$.extend(!0,{},this.prototype.getDataByPath("$item")),data=$.extend(!0,{},rowData.data);this._notifSelectedRow(rowId,{data:data,proto:proto})}else{var links=this.builder.$itemProto.data("$links"),forceLink=this.getAuthoring("$detailsLink"),link;forceLink==null&&(forceLink=this.controller.isVignette?"$queryfullpage":"$details");if(forceLink==="$queryfullpage"){if(!this.controller.isVignette)throw new Error("Vignette context expected");link={page:this.controller.state.name},this._forceArticle=this.article?this.article.$queryLinkArticle:null}else{var linkProto=links[forceLink]?links[forceLink]:links.$details;link=linkProto?sdataUtils.getLinkInfo(linkProto.$url,rowData):null,this._notifSelectedRow(rowId,rowData),this._forceArticle=this.article?this.article.$detailLinkArticle:null}if(link){var attrs={};attrs["data-nav"]=link.page,attrs["data-nav-target"]=this.controller.openLinkInVignette()?"vignette":"application",link.sDataUrl&&(attrs["data-sdata-url"]=link.sDataUrl);if(link.parameters){var params=utils.parseExpression(link.parameters,rowData);attrs["data-sdata-parameters"]=params}this._forceArticle&&(attrs["data-link-article"]=this.id),eventListener.triggerNavigation(this.$$elmt,attrs)}}},_openDetailRow:function(rowInfofId,activity){var self=this;try{var info=self._rowDetailCache[rowInfofId];if(!info)throw new Error("rowDetailGetDao - Unexpected null row info");var isRowCreation=activity==="create",pathBind=info.pathBind;isRowCreation&&pathBind.length>1&&_notImplemented("Creating row in an array embedded inside a card");var pathId=info.pathId,proto=self.prototype.parent,protoPath=["$properties"],dao=self.getDao();for(var i=0;i<pathBind.length;i++){protoPath.push(pathBind[i]),proto=proto.getPrototype(protoPath.join("."));var arrayData;if(self.$bind===pathBind[i])arrayData=self._arrayData;else{if(!dao)throw new Error("Unexpected null dao");arrayData=dao.getArrayData(pathBind[i],proto)}var res=self.getRowById(pathId[i],arrayData);if(!res){if(!isRowCreation)throw new Error("Unexpected empty row");res={row:self.getArrayEmptyRow(this.controller,proto,pathBind[i],dao)}}dao=res.row,protoPath=["$item.$properties"]}if(!dao||dao===self.getDao())return;var rowDetailDao=factory.createDaoRowDetail(dao,self.controller,self._getProtoRowDetail(proto));isRowCreation&&rowDetailDao.initParentBasedDefaultValues(),pathBind=info.pathBind.join("."),self._rowDetailInfo={pathBind:pathBind,dao:rowDetailDao,activity:activity};var attrs={"data-control-id":self.id,"data-parent-id":self.controller.id,"data-nav":"rowdetail","data-params":dao.getValue("$uuid")};self.controller.isVignette&&(attrs["data-nav-target"]="vignette"),isRowCreation||notifications.notifyController("synch.sm.select.row",self.controller,self.id,dao.getValue("$uuid"),null),eventListener.triggerNavigation(self.$$elmt,attrs)}catch(e){globals.getModal().error("Error loading row detail page",e)}},_getProtoRowDetail:function(proto){var protoJson={$url:"",$typ:"rowdetail",$links:{}};this.controller.isEditMode()&&(protoJson.$links.$save={$title:locale.text("array.links.save")},protoJson.$links.$delete={$title:locale.text("array.links.delete"),$confirm:locale.text("actions.del.confirm")}),protoJson.$title=proto.data("$title");if(proto.isSingleArray()){var p=$.extend({},proto.getDataByPath("$item"));return p.$isMandatory=!0,p.$isReadOnly=p.$isHidden=p.$isDisabled=!1,protoJson.$properties={"~data~":p},proto.create(protoJson)}return proto.getPrototype("$item",protoJson,this.controller.$activity==="read"?"details":"edit")},getArrayEmptyRow:function(controller,proto,bind,parentDao){var rsrc=_proto2Instance(proto);return rsrc.$uuid=utils.UUID(),factory.createDaoSdata(rsrc,this._getProtoRowDetail(proto),{parent:parentDao,$bind:bind,enableWorkingCopy:parentDao.enableWorkingCopy})},_actRowDetail:function(rowInfofId,target,event){this._openDetailRow(rowInfofId,this.controller.isEditMode()?"edit":"read"),event&&event.stopPropagation()},_actRowCreate:function(rowInfofId){this._openDetailRow(rowInfofId,"create")},_actRowDelete:function(rowId){var self=this,info=self._rowDetailCache[rowId];if(!info)return;modal.simpleConfirm(locale.text("actions.del.confirm"),function(confirmed){if(confirmed){var pathBind=info.pathBind,pathId=info.pathId;while(pathBind.length!=0&&pathBind[0]!=self.$bind)pathBind.shift(),pathId.shift();if(pathBind.length==0)throw new Error("Unexpected null pathBind");var field=pathBind.pop();(pathBind.length>1||field!==self.$bind)&&_notImplemented("Deleting row in an array embedded inside a card"),self.removeRow(rowId)}})},removeRow:function(rowId){var array=this._arrayData;if(!array||!array.$resources||array.$resources.length==0)return;var idx=-1;array.$resources.some(function(r,i){if(r.getValue("$uuid")===rowId)return idx=i,!0});if(idx<0||idx>=array.$resources.length)return;array.$resources.splice(idx,1),this.builder.removeRowById(rowId),this.getDao().deleteRow(this.$bind,this.prototype.isSingleArray()?idx:rowId)},rowDetailAdd:function(id,data){this._rowDetailCache[id+""]=data},rowDetailGetInfo:function(create){return this._rowDetailInfo},childPageGetPageInfo:function(typePage){var pageInfo={home:!1,type:typePage,cached:!1,refreshed:!1};if(typePage==="rowdetail"){if(!this._rowDetailInfo)throw new Error("childPageGetPageInfo - Null details row data");pageInfo.prototype=this._rowDetailInfo.dao.prototype,pageInfo.subtype=this.controller.isEditMode()?"edit":"details",pageInfo.article=null,pageInfo.name=this.controller.state.name+"."+this._rowDetailInfo.pathBind}else typePage==="carddesign"&&(pageInfo.prototype=this._getProtoCardDesign(),pageInfo.subtype="details",pageInfo.article=this.article.$card?this.article.$card:null,pageInfo.name=this.controller.state.name+"."+this.$bind+"."+typePage);return pageInfo},selectLastSelectedRow:function(rowId,show){this.builder.selectLastSelectedRow(rowId,show)},readArrayData:function(controllerDao){this.options.localPagination===!0&&this._localPaginator==null&&(this._localPaginator=this.createLocalPaginator(controllerDao),this._localPaginator==null&&(this.options.localPagination=!1));var res;this.prototype.isQuery()?res=controllerDao.getQueryData(this.prototype,this._localPaginator):this.prototype.isLookup()?res=controllerDao.getLookupData(this.prototype,this._localPaginator):this.prototype.isCube()?res=controllerDao.getCubeData(this.$bind,this.prototype,this._localPaginator):res=controllerDao.getArrayData(this.$bind,this.prototype,this._localPaginator);if(!res||!res.$resources)res={$resources:[]};return res},hasLocalPagination:function(){return this._localPaginator!=null&&this._localPaginator.isEnabled()},createLocalPaginator:function(controllerDao){throw new Error("Not implemented")},getLocalPaginator:function(){return this._localPaginator},_actPagination:function(linkName,target,event){if(this._localPaginator)this._localPaginator.doAction(linkName),this.refresh(this.controller.dao);else{var attrs={"data-nav-refresh":!0,"data-nav-type":linkName,"data-sdata-url":this.prototype.resolveExpression(this.getArrayData().$links[linkName].$url),"data-control-id":this.id,"data-nav-target":this.controller.isVignette?"vignette":"application"};eventListener.triggerNavigation(this.$$elmt,attrs)}},_setArrayData:function(controllerDao,refresh){this._multiSelReset(),this.isEmpty=!0,this.hasLocalPagination()||_destroyArrayData(this._arrayData),this._arrayData=this.readArrayData(controllerDao),this.isEmpty=this._arrayData.$resources.length===0,this.$$elmt.toggleClass("empty",this.isEmpty),this.builder&&this.builder.notifyArrayDataChanged(refresh,this._arrayData,this.isEmpty),this.clearContent(refresh);if(!refresh){var title=this.getTitle();this._displayTitle(title)?(this.$$ttl||(this.$$ttl=$(uiUtils.createDomElement("div",["s-m-title"])).appendTo(this.$$elmt)),this.$$ttl.text(title)):this.$$ttl&&this.$$ttl.empty(),this.$$value=$(uiUtils.createDomElement("div",["s-m-value"],null,null,this.$$elmt)),this.$$value.before(this.$$header=$("<header/>"));if(this.$display==="card"){var bgColor=(this.article.$arrayBgColor||"").toLowerCase();bgColor.length>0&&(bgColor="s-m-color-"+bgColor),bgColor&&this.$$value.addClass("s-m-bg "+bgColor)}}return this._arrayData},clearContent:function(refresh){this.builder&&this.builder.notifClearContent(refresh),refresh?this.$$value.empty():this.$$elmt.empty()},_displayTitle:function(title){return title==null||title.trim().length===0?!1:this.getAuthoring("$isTitleHidden")===!0?!1:this._displayArray()},_displayArray:function(){return this.controller.isEditMode()===!0||this.isEmpty!==!0||this.getAuthoring("$displayIfEmpty")===!0},getArrayData:function(){return this._arrayData},getNbRecords:function(){return this._arrayData?this._arrayData.$resources.length:0},waitWheelStart:function(){this._waiting||(this._waiting=uiUtils.waitWheelCreate(this.$$elmt.parent()),this._waiting.$$bckg.css({position:"absolute"}),this._waiting.$$wheel.css({position:"absolute"})),uiUtils.waitWheelStart(this._waiting)},waitWheelStop:function(){this._waiting&&uiUtils.waitWheelStop(this._waiting)},getRowById:function(rowId,arrayData){var self=this;arrayData=arrayData||self._arrayData;if(!arrayData||!arrayData.$resources||arrayData.$resources.length==0)return null;var idx=0,result=null;return arrayData.$resources.some(function(r){if(r.getValue("$uuid")===rowId)return result=r,!0;idx++}),result?{row:result,idx:idx}:null},_getRowByIdx:function(idx,arrayData){return arrayData=arrayData||this._arrayData,idx=parseInt(idx,10),!arrayData||!arrayData.$resources||arrayData.$resources.length<=idx?null:{row:arrayData.$resources[idx],idx:idx}},savedCtxCreate:function(type){if(!this.builder)return;var res={},subCtx=this.builder.savedCtxCreate(type);return subCtx&&(res.$builder=subCtx),subCtx=this._search?this._search.savedCtxCreate(type):null,subCtx&&(res.$search=subCtx),$.isEmptyObject(res)?null:res},savedCtxRestore:function(ctx){ctx&&ctx.$builder&&this.builder.savedCtxRestore(ctx.$builder)},getScrollViewRect:function(){if(this.controller.isVignette){var v=this.controller.getParentVignette();return v?v.getScrollViewRect():null}return this.controller.getMainContentRect()},rowId2Idx:function(uuid){if(!this._arrayData||!this._arrayData.$resources)return-1;var rowIdx=-1;return this._arrayData.$resources.some(function(r,idx){if(r.getValue("$uuid")===uuid)return rowIdx=idx,!0}),rowIdx},_actActionArray:function(id,param){if(id===globals.PANELFILTERSORT){this.controller.panelAttach("right",this._filterSortPanel,"toggle"),notifications.publish("sm.click.icon.filterSort",param.context);return}if(id==="filterSelected"){this.controller.$filtersSelect(param);return}if(id==="search"){this.getSearcher().search(this),this.controller.searchRefresh();return}if(id==="removeSearch"){this.getSearcher().removeSearch(this),this.controller.searchRefresh();return}},sortInfoGet:function(){var info=this.controller.getPageSort();if(info==null||info.length===0){var cols=this.builder.getColumnsInfo(!0);cols&&(info=[],cols.forEach(function(c){_sortFilterExclude.indexOf(c.$type)===-1&&c.$capabilities&&c.$capabilities.indexOf("sort")>=0&&info.push({name:c.$title,id:c.$bindValue,sort:"none"})})),this.sortInfoSet(info,!1)}return info},sortInfoSet:function(info,refresh){this.controller.setPageSort(info),refresh&&this.controller.refreshPageFilterAndSort()},filterInfoGet:function(){var info=this.controller.getPageFilter();return info},filterInfoSet:function(info,refresh){this.controller.setPageFilter(info),refresh&&this.controller.refreshPageFilterAndSort()},searchInfoGet:function(){return this.getSearcher().getSearchInfos()},filterMapGet:function(){var self=this,map=[],props=this.builder.getColumnsInfo(!1);return props&&props.forEach(function(prop){_sortFilterExclude.indexOf(prop.$type)===-1&&prop.$capabilities&&prop.$capabilities.indexOf("filter")>=0&&map.push({fieldName:prop.$title,operators:fieldOperators.getOperators(prop.$type),id:prop.$bindValue,prop:prop,isReference:prop.$type.indexOf("x-reference")>=0})}),map},getHeaderOptions:function(){var queryOrLookup=!this.isArrayField(),opts={};opts.filterEnabled=opts.sortEnabled=opts.paginEnabled=opts.searchEnabled=queryOrLookup,opts.searchEnabled=opts.searchEnabled&&!this.controller.offLine,opts.$filters=queryOrLookup&&this.controller.$filtersGet?this.controller.$filtersGet():null;if(this.controller.prototype.isRequest()||this.controller.prototype.isStatistics())opts.sortEnabled=opts.searchEnabled=opts.filterEnabled=!1,opts.$filters=null;return opts},$filtersGetAuthoring:function(){var auth=this.getAuthoring("$filters",this.controller.isVignette?"none":"list");return auth!=="none"&&globals.getSiteLayout().getDeviceType()==="smartphone"&&(auth="tabs"),auth},multiSelSetMgr:function(mgr){this._multiselHandler&&(this._multiselHandler=null),mgr&&(this._multiselHandler=jsutils.bindFn(mgr.callbackArray,mgr))},_multiSelStop:function(){this._multiselHandler&&this._multiselHandler(this,"$stopmultisel",null)},_multiSelReset:function(){this._multiselHandler&&this._multiselHandler(this,"$reset",null)},_multiSelSelect:function($$target){return this._multiselHandler?(this._multiselHandler(this,"$selectmultisel",$$target),!0):!1},_actMultiSelectionAction:function(params,$target){if(!this._multiselHandler)return;this._multiselHandler(this,params,$target)},authOnSlideMinSize:function(size,action){if(!this.builder.authMinSize2Pixels)return;if(this.builder.$display!="card"||!this._arrayData||this._arrayData.length>0)return;var value=this.builder.authMinSize2Pixels(size),left=(this.$$value.width()-value)/2+"px";value+="px";if(action=="start"){var height=this.$$value.find(this.$$value.find('[data-params="'+this._arrayData.$resources[0].getValue("$uuid")+'"]')).height();this.$$value.css({opacity:"0.3"}),this._$$cardSize=$('<div class="s-m-auth-minsize"><span>Min size'+value+"</span></div>").appendTo(this.$$elmt),this._$$cardSize.css({height:height+"px",width:value,top:(this.$$value.height()-height)/2+"px",left:left});return}if(action=="stop"){this.$$value.css({opacity:"inherit"}),this._$$cardSize.remove(),this._$$cardSize=null;return}if(action=="slide")return this._$$cardSize&&(this._$$cardSize.css({width:value,left:left}),this._minCardText||(this._minCardText=locale.text("array.minCardWidth")+" ",this._minCardSpan=this._$$cardSize.children("span")),this._minCardSpan.text(this._minCardText+value)),value},setCardAuthoring:function(article){this.article.$card=article,notifications.publish("sm.auth.change.item.prop.ui")},getLinkedPageArticle:function(){return this._forceArticle},notifLayoutExpanded:function(){var self=this;setTimeout(function(){self.onResize({scrollOnly:!1,layoutExpanded:!0});var controller=self.controller;if(controller.isVignette){var dashBoard=controller.getVignettePageDashboard();dashBoard.isDashboard("stack")&&(controller=dashBoard)}notifications.notifyController("sm.scroller.update",controller)})},getSearcher:function(){return this._search},checkCapabilities:function(value){if(value==null)return!0;if(!this._capabilities){this._capabilities={};var self=this;(this.getMetaData("$capabilities")||"").split(",").forEach(function(c){c=c.trim(),c.length>0&&(self._capabilities[c.trim()]=!0)})}return this._capabilities[value]===!0},getRowStatusInfo:function(){var type=this.getAuthoring("$statusEnabled");if(type==="mono"||type==="multi"){var status=this.getAuthoring("$status");return!status||status.length===0?null:{type:type,list:status}}return null},toggleCardStatusColor:function(disable){if(this.$display==="table")return;if(!this.getRowStatusInfo())return;var style=disable?"inherit":"";this.$$value.find(".s-m-status-color").css({"background-color":style,color:style})},getAvailableSize:function(){return{height:this.$$elmt.height()-this.$$header.height(),width:this.$$value.width()}},_actExternalLink:function(param){this.controller.externalLink(param)},setEmptyArrayMsg:function(){if(!this.isArrayField()){var title=this.getTitle();title&&$('<div class="s-m-no-data-title"/>').appendTo(this.$$value).text(title),$('<div class="s-m-no-data-label"/>').appendTo(this.$$value).text(locale.text("array.empty"))}},notifyVignetteArrayHosted:function(){if(this.isArrayField()||this.prototype.isLookup()||!this.controller.isVignette||!this.controller.getParentVignette())return;var parent=this.controller.getParentVignette().parent;if(parent&&parent.notifSpecialArrayHosted){var typeArray=this.isCarouselDisplay()?"carousel":this.$display;parent.notifSpecialArrayHosted(typeArray)}},_getProtoCardDesign:function(){var proto=this.prototype,protoJson={$url:"",$typ:"carddesign",$title:this.$bind,$links:{}};if(proto.isSingleArray())throw new Error("No card design for single array");proto=proto.getPrototype("$item",protoJson,"details");var props=proto.data("$properties");return Object.keys(props).forEach(function(key){props[key].$isHidden=!1}),proto},isAuthoringPropAllowed:function(property,value){if(property!=="arrayDisplay")return Base.prototype.isAuthoringPropAllowed.call(this,property,value);switch(value){case"table":return!0;case"separator":return this.prototype.isSingleArray();case"card":case"carousel":return!this.prototype.isSingleArray();default:return!1}},getColumnsInfo:function(onlyVisible){var protoInfo=this.prototype.arrayTableGetColInfo();if(onlyVisible!==!0||this._arrayData==null||this._arrayData.$properties==null)return protoInfo;var res=[],dataProps=this._arrayData.$properties;return protoInfo.forEach(function(prop){(dataProps[prop.$bind]==null||dataProps[prop.$bind].$isHidden!==!0)&&res.push(prop)}),res},acceptRowSelection:function(){if(this.controller.isEditMode())return!0;if(this.article.$arrayOptions.showRowDetailLink===!0)return!0;if(this.prototype.isLookup())return!0;var links=this.builder.$itemProto.data("$links");if(!links)return!1;var forceLink=this.getAuthoring("$detailsLink");return forceLink&&links[forceLink]!=null||links.$details!=null}});exports.Klass=_Klass,exports.LocalPaginator=_LocalPaginator}),define("syracuse-tablet/html/js/controls/chart/cubeChartsTheme",["require","exports","module"],function(require,exports,module){var theme={colors:["#BF7070","#BFB730","#7ABF30","#7373FF","#BF7730","#BF3080","#30BF9F","#FF7373","#FFF773","#85FF00","#3030BF","#FF9F40","#FF40BC","#1699A6","#FF0000","#FFF100","#00FF00","#0000FF","#FF7F00","#FF00A6","#00FFC6","#A60000","#A69C00","#56A600","#90B2FF","#A65200","#A6006C","#00A681","#FF4040","#FFF440","#A3FF40","#3673FF","#FFB873","#FF76CE","#73FFED"],chart:{borderRadius:"0",spacingTop:10,backgroundColor:"#fff",borderColor:"#ccc",borderWidth:1,className:"dark-container",resetZoomButton:{theme:{fill:"white",stroke:"#dddddd",r:0,states:{hover:{fill:"#00a1de",style:{color:"white"}}}},position:{x:-50,y:5},relativeTo:"chart"}},title:{style:{color:"#464646",font:'bold 16px "Trebuchet MS", Verdana, sans-serif'}},subtitle:{style:{color:"#464646",font:'bold 12px "Trebuchet MS", Verdana, sans-serif'}},xAxis:{gridLineColor:"rgba(0, 0, 0, 0.05)",gridLineDashStyle:"longdash",gridLineWidth:1,labels:{style:{color:"#A0A0A0"}},lineColor:"rgba(0, 0, 0, 0.2)",tickColor:"rgba(0, 0, 0, 0.2)",title:{style:{color:"#464646",fontWeight:"bold",fontSize:"15px",fontFamily:"arial"}}},yAxis:{minorGridLineColor:"rgba(0, 0, 0, 0.05)",minorTickInterval:"auto",gridLineWidth:2,gridLineColor:"rgba(0, 0, 0, 0.07)",labels:{align:"left",x:0,y:12,style:{color:"#A0A0A0"}},lineColor:"rgba(0, 0, 0, 0.07)",title:{style:{color:"#CCC",fontSize:"16px",fontFamily:"Georgia, Verdana, sans-serif",fontStyle:"italic"}}},tooltip:{backgroundColor:"#464646",borderRadius:"0",style:{color:"#fff",fontSize:"12px",padding:"5px",whiteSpace:"nowrap"}},toolbar:{itemStyle:{color:"silver"}},plotOptions:{series:{marker:{lineWidth:2,lineColor:null,radius:4,states:{hover:{radius:8,lineColor:null}}}},area:{fillOpacity:.15},areaspline:{fillOpacity:.15},line:{dataLabels:{color:"#CCC"},marker:{lineColor:"#FFFFFF"}},spline:{marker:{lineColor:"#FFFFFF"}},scatter:{marker:{lineColor:"#FFFFFF"}},candlestick:{lineColor:"#FFFFFF",animation:{duration:2e3,easing:"easeOutBounce"}},pie:{allowPointSelect:!0,cursor:"pointer",borderColor:"rgba(250,250,250,0.3)",borderWidth:.5,dataLabels:{enabled:!0,connectorWidth:2,color:"#464646",style:{fontWeight:"bold"}}}},legend:{borderRadius:0,borderWidth:1,backgroundColor:"white",itemMarginTop:8,itemStyle:{color:"#464646",fontFamily:'"arial"',fontWeight:"bold",fontSize:"8pt "},itemHoverStyle:{color:"#00a1de"},itemHiddenStyle:{color:"#555"},title:{style:{color:"#464646",fontWeight:"bold",fontSize:"8pt",fontFamily:"arial"}}},credits:{enabled:!1,style:{color:"#666"}},labels:{style:{color:"#CCC"}},exporting:{buttons:{drillUp:{symbolStroke:"#fff",symbolFill:"rgba(250,250,250,0.5)",hoverSymbolStroke:"#fff",hoverSymbolFill:"rgba(250,250,250,0.5)"},exportButton:{symbolStroke:"#fff",symbolFill:"rgba(250,250,250,0.5)",hoverSymbolStroke:"#fff",hoverSymbolFill:"rgba(250,250,250,0.5)"},printButton:{symbolStroke:"#fff",symbolFill:"rgba(250,250,250,0.5)",hoverSymbolStroke:"#fff",hoverSymbolFill:"rgba(250,250,250,0.5)"}}},rangeSelector:{buttonTheme:{fill:{linearGradient:[0,0,0,20],stops:[[.4,"#888"],[.6,"#555"]]},stroke:"#000000",style:{color:"#CCC",fontWeight:"bold"},states:{hover:{fill:{linearGradient:[0,0,0,20],stops:[[.4,"#BBB"],[.6,"#888"]]},stroke:"#000000",style:{color:"white"}},select:{fill:{linearGradient:[0,0,0,20],stops:[[.1,"#000"],[.3,"#333"]]},stroke:"#000000",style:{color:"yellow"}}}},inputStyle:{backgroundColor:"#333",color:"silver"},labelStyle:{color:"silver"}},navigator:{handles:{backgroundColor:"#666",borderColor:"#AAA"},outlineColor:"#CCC",maskFill:"rgba(16, 16, 16, 0.5)",series:{color:"#7798BF",lineColor:"#A6C7ED"}},scrollbar:{barBackgroundColor:{linearGradient:[0,0,0,20],stops:[[.4,"#888"],[.6,"#555"]]},barBorderColor:"#CCC",buttonArrowColor:"#CCC",buttonBackgroundColor:{linearGradient:[0,0,0,20],stops:[[.4,"#888"],[.6,"#555"]]},buttonBorderColor:"#CCC",rifleColor:"#FFF",trackBackgroundColor:{linearGradient:[0,0,0,10],stops:[[0,"#000"],[1,"#333"]]},trackBorderColor:"#666"},legendBackgroundColor:"rgba(0, 0, 0, 0.5)",legendBackgroundColorSolid:"rgb(35, 35, 70)",dataLabelsColor:"#444",textColor:"#C0C0C0",maskColor:"rgba(255,255,255,0.3)"},colors=theme.colors;theme.orgChart={node:{textColor:"black ",borderColor:colors[1],borderWidth:2,backgroundColor:"white ",fontWeight:"normal ",hover:{backgroundColor:colors[3],textColor:"white "}},junction:{lineColor:colors[3],lineWidth:2},dropMarker:{borderColor:colors[1],borderWidth:0,backgroundColor:colors[4],backgroundOpacity:1},tooltip:{backgroundColor:colors[1],backgroundOpacity:1,borderWidth:2,borderRadius:0,borderColor:colors[2],style:{color:"#fff",fontSize:"12px",padding:"5px",whiteSpace:"nowrap"}}},theme.version=Highcharts.version.split(".").map(function(e){return parseInt(e,10)}),theme.version[0]!==2&&theme.version[0]===3&&(theme.navigation={buttonOptions:{symbolStroke:"#DDDDDD",hoverSymbolStroke:"#FFFFFF",theme:{fill:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[.4,"#606060"],[.6,"#333333"]]},stroke:"#000000"}}},delete theme.exporting),exports.theme=theme}),define("syracuse-tablet/html/js/controls/array/builderChartBase",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/array/builderBase","syracuse-tablet/html/js/helpers/formatApi","syracuse-tablet/html/js/controls/chart/cubeChartsTheme","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/globals"],function(require,exports,module){function _isCubeValid(cube,proto){return!!(cube&&cube.$hierarchies&&proto.$axes&&proto.$axes.length>0&&proto.$axes[0].$hierarchies&&proto.$axes[0].$hierarchies.length>0)}var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/array/builderBase").Klass,formatApi=require("syracuse-tablet/html/js/helpers/formatApi"),theme=require("syracuse-tablet/html/js/controls/chart/cubeChartsTheme").theme,locale=require("syracuse-tablet/html/js/helpers/locale"),globals=require("syracuse-tablet/html/js/helpers/globals"),_merge=Highcharts.merge,objectClone=function(o){return $.extend({},o)};Highcharts.theme=theme,Highcharts.setOptions(Highcharts.theme);var colors=Highcharts.theme.colors,_style=function($style){var map={xy:"line",point:"scatter",stick:"column",radar:"spiderweb"};return $style&&(map[$style]||$style)},_Klass=utils.defineClass(function(control,disp,options){Base.call(this,control,disp,options),this.$prototype=control.prototype.json,this.$prototype.$properties=this.$prototype.$item.$properties,this._localize={highCharts_showHideLegend:locale.text("highCharts_showHideLegend"),highCharts_seriesTitle:locale.text("highCharts_seriesTitle")},this._initializeMeta()},Base,{destroy:function(){Base.prototype.destroy.call(this),this.clearChart(),this._localize=this._meta=this._dataset=this.$prototype=this.currentMetaData=null},clearChart:function(){this.highchartObject&&this.highchartObject.destroy(),this.highchartObject=null},_mergeMetaData:function(metadata){var m={};return metadata&&metadata.$chartOptions&&(metadata.$isXLabelsHidden=metadata.$chartOptions.isXLabelsHidden||!1,metadata.$isYLabelsHidden=metadata.$chartOptions.isYLabelsHidden||!1,metadata.$isXLabelHidden=metadata.$chartOptions.isXLabelHidden||!1,metadata.$isYLabelHidden=metadata.$chartOptions.isYLabelHidden||!1,metadata.$isLegendHidden=metadata.$chartOptions.isLegendHidden||!1,metadata.$isGridLineHidden=metadata.$chartOptions.isGridLineHidden||!1,metadata.$isTitleHidden=metadata.$chartOptions.isTitleHidden||!1,metadata.$isLabelsHidden=metadata.$chartOptions.isLabelsHidden||!1),metadata&&metadata.$axisLabels&&(m.$axisLabels=metadata.$axisLabels),metadata&&metadata.$cube&&(m.$cube=metadata.$cube),metadata&&metadata.$axes&&(m.$axes=metadata.$axes),metadata&&metadata.$style&&(m.$style=metadata.$style),metadata&&metadata.$color&&(m.$color=metadata.$color),metadata&&metadata.$isLegendHidden&&(m.$isLegendHidden=metadata.$isLegendHidden),metadata&&metadata.$isXLabelHidden&&(m.$isXLabelHidden=metadata.$isXLabelHidden),metadata&&metadata.$isYLabelHidden&&(m.$isYLabelHidden=metadata.$isYLabelHidden),metadata&&metadata.$isXLabelsHidden&&(m.$isXLabelsHidden=metadata.$isXLabelsHidden),metadata&&metadata.$isYLabelsHidden&&(m.$isYLabelsHidden=metadata.$isYLabelsHidden),metadata&&metadata.$isGridLineHidden&&(m.$isGridLineHidden=metadata.$isGridLineHidden),metadata&&metadata.$isTitleHidden&&(m.$isTitleHidden=metadata.$isTitleHidden),metadata&&metadata.$isLabelsHidden&&(m.$isLabelsHidden=metadata.$isLabelsHidden),metadata&&metadata.$inverted&&(m.$inverted=metadata.$inverted),metadata&&metadata.$seriesOptions&&(m.$cube=m.$cube||{},m.$cube.$measures=m.$cube.$measures||{},Object.keys(metadata.$seriesOptions).forEach(function(key){metadata.$seriesOptions[key]&&(m.$cube.$measures[key]=m.$cube.$measures[key]||{},metadata.$seriesOptions[key].color&&(m.$cube.$measures[key].$color=metadata.$seriesOptions[key].color.bgColor),m.$cube.$measures[key].$isHidden=metadata.$seriesOptions[key].isHidden)})),this.currentMetaData=_merge(this.currentMetaData||{},m),metadata&&metadata.$item&&metadata.$item.$properties&&this.currentMetaData&&this.currentMetaData.$cube&&this.currentMetaData.$cube.$measures&&$.smForEachKey(this.currentMetaData.$cube.$measures,function(key,m){metadata.$item.$properties[key]&&metadata.$item.$properties[key].$title?m.$title=metadata.$item.$properties[key].$title:m.$title=key}),this.currentMetaData},getDataSet:function(){return this._dataset||[]},_ensureFormatter:function(measure){measure.formatApi={format:function(val,localFormat){return val}}},_localizedText:function(key){return key},_getFieldEvalTitle:function(){return[]},notifyArrayDataChanged:function(refresh,arrayData,isEmpty){var self=this;Base.prototype.notifyArrayDataChanged.call(self,refresh,arrayData,isEmpty);var chartDataset=[];arrayData&&arrayData.$resources&&arrayData.$resources.forEach(function(dao){chartDataset.push(dao.data)}),self._dataset=chartDataset,self._links=null,arrayData&&arrayData.$links&&(self._links={},Object.keys(arrayData.$links).forEach(function(key){arrayData.$links[key].$isHidden||(self._links[key]=arrayData.$links[key])}))},_settingsFromValue:function(){var self=this,$cube=this.currentMetaData.$cube,icolor=0,settings,dataset=self.getDataSet();return $cube&&$cube.$style==="spiderweb"?(settings={},settings.categories=Object.keys(self._meta.series).map(function(key){return self._meta.series[key].options.name}),settings.series={},dataset&&dataset.reduce(function(res,current){var serie={name:self._getMeasureLabel(current,self._meta.xAxis[0].code),color:colors[icolor++],data:[],pointPlacement:"on"};return serie.name&&(serie.id="#s-"+serie.name,$.smForEachKey(self._meta.series,function(key,s){s.isHidden||self._pushData(serie,key,key,current)}),res.series[serie.name]=serie),res},settings)):(settings={categories:[],series:{}},dataset&&dataset.reduce(function(res,current){var categoryName=self._getMeasureLabel(current,self._meta.xAxis[0].code);return categoryName!=null&&(res.categories.push(categoryName),$.smForEachKey(self._meta.series,function(key,s){var serie=res.series[key];serie||(serie=objectClone(s.options),serie.data=[],res.series[key]=serie),self._pushData(serie,categoryName,key,current)})),res},settings)),settings},_pushData:function(serie,categoryName,key,data){var val=parseFloat(data.$rawV&&data.$rawV[key]&&data.$rawV[key].v||data[key])||0;this.useLogarithmicAxis&&(this.maxValue=Math.max(this.maxValue||-Infinity,val),this.minValue=Math.min(this.maxValue||Infinity,val)),serie.data.push({name:categoryName,y:val,rowId:data.$uuid})},createChart:function(settings,$$parent,options){var self=this,options=_merge(self._getPref(),self._getOptions(self.$prototype,$$parent,options));self.highchartObject&&self.clearChart(),settings?(options.xAxis[0].categories=settings.categories,$.smForEachKey(settings.series,function(key,s){var serie=objectClone(s),serieMeta=self._meta.series[key];options.chart.polar&&serie&&serie.type&&delete serie.type,(!serieMeta||!serieMeta.isHidden)&&!(serieMeta&&serieMeta.options&&serieMeta.options.isHidden)&&options.series.push(serie)})):$.smForEachKey(self._meta.series,function(key,s){var serie=objectClone(s.options);options.chart.polar&&serie&&serie.type&&delete serie.type,serie.data=[0],s.isHidden||options.series.push(serie)}),(!self.$prototype.$cube||self.$prototype.$cube.$style!="spiderweb")&&options.series.reverse(),this.useLogarithmicAxis&&(this.maxValue||0)/(this.minValue||1)>10&&(options.yAxis.type="logarithmic"),self.highchartObject=new Highcharts.Chart(options);var legend=this.highchartObject.legend;self.displayLegend=legend&&legend.display;var chartSeries=self.highchartObject.series,serie,serieMeta;for(var j=chartSeries.length-1;j>=0;j--)serie=chartSeries[j],serieMeta=serie&&serie.options.id&&self._meta.series[serie.options.id.slice(3)],serieMeta&&serieMeta.measure&&(serieMeta.measure.$color=serieMeta.options.color=serie.color)},_getOptions:function(proto,$$parent,options){options=options||{};var self=this,$cube=this.currentMetaData.$cube,defOptions=Highcharts.getOptions(),buttons=defOptions.exporting.buttons,enuml,$style=this.currentMetaData.$style||$cube&&$cube.$style||proto.$cube&&proto.$cube.$style,axe=proto.$axes&&proto.$axes[0]||{},titleCode=this._getMeasureCode(axe.$hierarchies[0][0]),hierarchy=$cube.$hierarchies&&$cube.$hierarchies[titleCode],axeTitle=hierarchy?hierarchy.$title:null;axeTitle===null&&proto.$properties&&proto.$properties[titleCode]&&(axeTitle=proto.$properties[titleCode].$title||"");var margin={top:this.currentMetaData.$isTitleHidden&&$style!=="bar"?0:null,bottom:this.currentMetaData.$isXLabelsHidden&&$style!=="bar"?0:null,left:this.currentMetaData.$isYLabelsHidden&&$style!=="bar"?2:null},legend={};globals.getSiteLayout().getDeviceType()==="smartphone"&&(legend.layout="horizontal",legend.align="center",legend.verticalAlign="bottom",legend.floating="bottom",legend.notitle=!0);var options={chart:{renderTo:$$parent.get(0),reflow:!1,zoomType:options.zoomType||"x",ignoreHiddenSeries:!1,width:options.width,height:options.height,inverted:this.currentMetaData.$inverted,marginTop:margin.top,marginBottom:this.currentMetaData.$inverted?margin.left:margin.bottom,marginLeft:this.currentMetaData.$inverted?margin.bottom:margin.left,marginRight:this.currentMetaData.$inverted?margin.bottom:margin.left,events:{load:options.onComplete}},lang:{showHideLegend:self._localize.highCharts_showHideLegend},legend:{layout:legend.layout?legend.layout:"vertical",align:legend.align?legend.align:"right",verticalAlign:legend.verticalAlign?legend.verticalAlign:"top",y:legend.notitle?0:60,x:legend.notitle?0:-10,title:{text:legend.notitle?"":":::: "+self._localize.highCharts_seriesTitle},borderWidth:legend.notitle?0:1,floating:legend.notitle?!1:!0,draggable:legend.notitle?!1:!0,zIndex:20,enabled:this.currentMetaData.$isLegendHidden!==!0&&$style!=="pie"},title:{text:!this.currentMetaData.$isTitleHidden&&$cube&&self._localizedText($cube.$title)||null},subtitle:{text:null},xAxis:[{categories:[],title:{text:!this.currentMetaData.$isXLabelHidden&&self._localizedText(axeTitle)||null},labels:{rotation:-45,align:"right",enabled:this.currentMetaData.$isXLabelsHidden!==!0},gridLineWidth:this.currentMetaData.$isGridLineHidden?0:1,minorGridLineWidth:this.currentMetaData.$isGridLineHidden?0:1,lineWidth:this.currentMetaData.$isGridLineHidden?0:1,tickWidth:this.currentMetaData.$isXLabelsHidden?0:1}],yAxis:[{title:{text:null},labels:{align:"right",enabled:this.currentMetaData.$isYLabelsHidden!==!0},gridLineWidth:this.currentMetaData.$isGridLineHidden?0:1,minorGridLineWidth:this.currentMetaData.$isGridLineHidden?0:1,lineWidth:this.currentMetaData.$isGridLineHidden?0:1,tickWidth:this.currentMetaData.$isYLabelsHidden?0:1}],plotOptions:{series:{pointPadding:0,groupPadding:.1,cursor:"pointer",events:{},point:{events:{click:self.control?self.control.getChartClickHandler():null}},stacking:self._meta.stacking,animation:!1}},tooltip:{formatter:function(){var seriesMeta=self._meta.series,serie=this.key&&seriesMeta[this.key]||seriesMeta[this.series.options.id.slice(3)],measure=serie&&serie.measure,data=this.series.processedYData,y=this.y;measure&&self._ensureFormatter(measure);var label=this.series.name||measure&&measure.$title,mformat=measure&&measure.formatter;label=(label?label+"<br>":"")+(this.x||this.key)+": <b> "+(mformat?mformat.format(y):y)+"</b>";if(measure&&measure.$isNormalized&&data.length>0){var sum=data.reduce(function(a,b){return a+b});label+=" ("+(mformat?mformat.formatValue(y/sum*100):y/sum*100)+"%)"}return label}},series:[]};$style==="pie"&&(options.plotOptions.pie=options.plotOptions.pie||{},options.plotOptions.pie.dataLabels=options.plotOptions.pie.datalabels||{},options.plotOptions.pie.dataLabels.enabled=this.currentMetaData.$isLabelsHidden?!1:!0);if(Highcharts.theme.version[0]===3){options.exporting={type:"image/png",url:"http://export.highcharts.com/",buttons:{contextButton:{symbol:"menu",enabled:!1,_titleKey:"contextButtonTitle",menuItems:[{textKey:"showHideLegend",onclick:function(){setTimeout(function(){self._toggleLegendDisplay()},100)}}]},legendButton:{enabled:!1,textKey:"showHideLegend",symbol:"menu",onclick:function(){setTimeout(function(){self._toggleLegendDisplay()},100)}}}};var menuItems=options.exporting.buttons.contextButton.menuItems||[];this._printSupported()&&menuItems.push({text:"Print chart",onclick:function(){this.print(self)}}),this._exportSupported()&&(menuItems.push({separator:!0}),menuItems.push({textKey:"downloadPNG",onclick:function(){this.exportChart()}}),menuItems.push({textKey:"downloadJPEG",onclick:function(){this.exportChart({type:"image/jpeg"})}}),menuItems.push({textKey:"downloadPDF",onclick:function(){this.exportChart({type:"application/pdf"})}}),menuItems.push({textKey:"downloadSVG",onclick:function(){this.exportChart({type:"image/svg+xml"})}}))}return options.xAxis[0].title.text!==options.title.text&&(options.xAxis[0].title.text=options.xAxis[0].title.text?options.xAxis[0].title.text:options.title.text),options.chart.type=self._meta.defaultStyle,options},_initializeMeta:function(){this._mergeMetaData(this.$prototype),this._mergeMetaData(this.$articleArray);var proto=this.$prototype,cube=this.currentMetaData;this._meta={xAxis:[{}],series:{},displaysOneMeasure:cube&&cube.$displaysOneMeasure,hasMeasureSelector:cube&&cube.$hasMeasureSelector,hasStyleSelector:cube&&cube.$hasStyleSelector,defaultStyle:_style(cube.$style)||"column",drill:{minLevel:1,maxLevel:0,currLevel:1,currAxisHier:0,levelsProperties:[],members:[],stack:[{$axes:proto.$axes,$item:proto.$item,$slicer:proto.$slicer}]}},this.__processMeta(proto,!0)},_exportSupported:function(){return!0},_printSupported:function(){return!0},__processMeta:function(metaData,init){this._processMeasures(metaData,init),this._processAxes(metaData,init)},_processMeasures:function(metaData,init){this._mergeMetaData(metaData);var self=this,items=this.$prototype.$properties,measures=this._getRestraintMeasures(),icolor=0;measures&&$.smForEachKey(measures,function(key,m){var code=m.$property||key,measure=_merge(items[code],m);metaData&&metaData.$item&&metaData.$item.$properties&&(measure=_merge(measure,metaData.$item.$properties[code]));if(!measure.$title||measure.$title==="")measure.$title=key;var serie=self._meta.series[code];init&&(self._ensureFormatter(measure),serie=self._meta.series[code]={options:{id:"#s-"+code,name:self._localizedText(measure.$title)||String.fromCharCode(160)},measure:measure}),serie&&(serie.isHidden=measure.$title==="",serie.options.type=_style(measure.$style),serie.options.color=measure.$color||colors[icolor++],serie.options.name=self._localizedText(measure.$title)||String.fromCharCode(160),serie.options.visible=measure.$title!==""&&(!self._meta.displaysOneMeasure||!!measure.$isDefault),serie.options.isHidden=measure.$isHidden);if(measure.$isStacked||measure.$stackingGroup)serie.options.stack=measure.$stackingGroup||0,self._meta.stacking=measure.$isNormalized?"percent":self._meta.stacking||"normal"})},_getRestraintMeasures:function(){var proto=this.currentMetaData,$cube=proto.$cube,measures=$cube&&$cube.$measures,restraintMeasures=measures;return measures&&proto.$axes&&proto.$axes.length>1&&proto.$axes[1].$members&&proto.$axes[1].$members[0][0].length>0&&(restraintMeasures={},$.smForEach(proto.$axes[1].$members[0][0],function(measureCode){restraintMeasures[measureCode]=measures[measureCode]})),restraintMeasures},_processAxes:function(proto,init){var cube=this.$prototype.$cube;if(!_isCubeValid(cube,proto))return!1;var self=this,currAxisHier=0,axis0=proto.$axes&&proto.$axes[0],mainHLevelsTab=null;if(axis0){$.smForEachKey(axis0.$hierarchies,function(idx,hierarchy){!mainHLevelsTab&&hierarchy.length>1&&hierarchy[1]==1&&(mainHLevelsTab=cube.$hierarchies[hierarchy[0]].$properties,mainHLevelsTab&&(self._meta.xAxis[0].code=mainHLevelsTab[hierarchy.length>2?hierarchy[2]:0],currAxisHier=idx))}),!mainHLevelsTab&&axis0.$hierarchies[0].length>0&&(mainHLevelsTab=cube.$hierarchies[axis0.$hierarchies[0][0]].$properties,mainHLevelsTab&&mainHLevelsTab.length>0&&(self._meta.xAxis[0].code=mainHLevelsTab[0]));var properties;$.smForEach(axis0.$hierarchies,function(hierarchie){properties=cube.$hierarchies[hierarchie[0]].$properties,$.smForEach(properties,function(property){this.levelsProperties[this.maxLevel++]=property},self._meta.drill)}),axis0.$members&&$.smForEach(axis0.$members,function(tuple){$.smForEach(tuple,function(value){value.length>0&&(this.members[this.currLevel++ -1]=value[0])},this)},self._meta.drill)}self._meta.drill.code=proto.$codeStat||"UNKNOWN",self._meta.drill.axis0FieldCode=self._meta.xAxis[0].code||"",self._meta.drill.maxLevel=Math.max(self._meta.drill.maxLevel,self._meta.drill.minLevel)},_getPref:function(){return Highcharts.getOptions()},_getMeasureCode:function(code){var level=this.control.level,measureCode=level>1&&this.$prototype.$axes[0].$hierarchies.length>=level?this.$prototype.$axes[0].$hierarchies[level-1][0]:null;return measureCode=this.currentMetaData.$axisLabels?this.currentMetaData.$axisLabels[1]:measureCode,measureCode||code},_getMeasureLabel:function(measure,code){var self=this,label=this._localizedText(measure.$title);if(label)return label;code=this._getMeasureCode(code);if(!measure[code])return"";var item=self.$prototype.$properties[code];if(!item)return null;switch(item.$type){case"application/x-choice":label=measure[code],item.$value.$enum.some(function(element,i,array){return element.$value===label?(label=self._localizedText(element.$title),!0):!1});break;case"application/x-date":item.formatter=formatApi.getFormatter(item.$type,locale.getDateFormat(item.$type)),label=item.formatter.formatValue(measure[code]);break;case"application/x-integer":case"application/x-decimal":item.formatter=formatApi.getFormatter(item.$type,locale.getNumberFormat(item.$type)),label=item.formatter.formatValue(measure[code]);break;default:label=""+measure[code]}return label},_toggleLegendDisplay:function(){var legend=this.highchartObject.legend;legend&&this._displayLegend(!legend.display)},_displayLegend:function(display){var legend=this.highchartObject.legend;if(!legend)return;display?(legend.group.show(),legend.box.show()):(legend.group.hide(),legend.box.hide()),this.displayLegend=legend.display=display}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/array/builderChart",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/controls/array/builderChartBase","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),locale=require("syracuse-tablet/html/js/helpers/locale"),Base=require("syracuse-tablet/html/js/controls/array/builderChartBase").Klass,notifications=require("syracuse-tablet/html/js/helpers/notifications"),_getHeight=function(h){return h==="xsmall"?50:h==="small"?100:h==="medium"?200:h==="large"?400:h==="xlarge"?700:200},_Klass=utils.defineClass(function(control,disp,options){Base.call(this,control,disp,options)},Base,{initReuseProperties:function(){Base.prototype.initReuseProperties.call(this),this.resetProps(!1)},destroy:function(){Base.prototype.destroy.call(this),this._$$chartSlot=this._$$catchEvt=null},buildHtml:function(arrayData,buildOpts){Base.prototype.buildHtml.call(this,arrayData,buildOpts);var article=this.$articleArray;this._height=_getHeight(article.$chartHeight),this._$$chartSlot=$('<div class="s-m-slot"/>').appendTo(this.control.$$value);if(this.getDataSet().length>0){if(globals.isAuthoringActive()||this.control.isOpenDetailEnabled())this._$$catchEvt=$('<div class="s-m-catchevt"/>').appendTo(this.control.$$value),this.control.isOpenDetailEnabled()&&this.control.addChartDetailLink(this._$$catchEvt)}else{var title=this.control.prototype.getDataByPath("$cube.$title");title&&$('<div class="s-m-no-data-title"/>').appendTo(this._$$chartSlot).text(title),$('<div class="s-m-no-data-label"/>').appendTo(this._$$chartSlot).text(locale.text("label.chart.nodata")),this._$$chartSlot.css("position","relative")}this.refreshHeaderAndGesture(),this.isRefreshContext(buildOpts)&&this._displayChart(!1,!0)},onResize:function(context){if(this.isDestroyed())return;var dataset=this.getDataSet();if(dataset==null||dataset.length===0){this._notifyChartCounter();return}if(!this.control.$$value||!this.control.$$value.is(":visible"))this._subscribedExpand||(this._subscribedExpand=!0,notifications.subscribe(this,["sm.layout.expanded"]));this._layouytType==null&&(this.control.isDisplayedInDetailPage()?this._layouytType="stack":this._layouytType=this.control.controller.getParentDashboardType()),this._displayChart(!0,!1)},_checkHeaderHeight:function(height){if(this.control.$$header.is(":visible")){var hh=this.control.$$header.height(),phh=this.control.parent.$$header?this.control.parent.$$header.height()+2:0;if(height==null){var css={top:hh+"px",height:this.control.$$value.height()-hh-phh+"px"};this._$$chartSlot.css(css),this._$$catchEvt&&this._$$catchEvt.css(css)}else height=height-hh-phh}return height},_displayChart:function(updtScroller,isRefresh){var self=this;if(self.isDestroyed()||!self._$$chartSlot)return;setTimeout(function(){if(self.isDestroyed())return;var stackController,height;if(self._layouytType==="stack"){self._$$chartSlot.css("position","relative");if(self.control.isDisplayedInDetailPage())stackController=self.control.controller,height=stackController.getMainContentRect().height-10;else{if(!self.control.controller.isVignette)throw new Error("Unexpected chart page context");stackController=self.control.controller.getParentVignette().controller,height=Math.min(self._height,stackController.getMainContentRect().height-10)}}else height=null;height=self._checkHeaderHeight(height),self.createChart(self._settingsFromValue(),self._$$chartSlot,{height:height,width:null,onComplete:function(){isRefresh||self._notifyChartCounter()}}),updtScroller&&stackController&&notifications.notifyController("sm.scroller.update",stackController)},10)},notifClearContent:function(refresh){this.clearChart()},notifLayoutExpanded:function(){this._displayChart(!1,!1)},_notifyChartCounter:function(){globals.getCurrentPage().countChartLoaded&&globals.getCurrentPage().countChartLoaded(this)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/array/ctrlArrayChart",["require","exports","module","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/controls/array/ctrlArray","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/controls/array/builderChart","syracuse-tablet/html/js/controls/chart/chartsUtils","syracuse-tablet/html/js/application/eventListener","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),array=require("syracuse-tablet/html/js/controls/array/ctrlArray"),Base=array.Klass,locale=require("syracuse-tablet/html/js/helpers/locale"),BuiderCart=require("syracuse-tablet/html/js/controls/array/builderChart").Klass,chartsUtils=require("syracuse-tablet/html/js/controls/chart/chartsUtils"),eventListener=require("syracuse-tablet/html/js/application/eventListener"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_checkChartArticle=function(article,$bind){if(!article)return;var arrayArticle=_traverseArticleNodes(article,function(node){return node.$bind===$bind&&node.$forceArray===!0});return arrayArticle?article:(arrayArticle=_traverseArticleNodes(article,function(node){return node.$bind!=$bind||node.$display=="chart"||node.$seriesOptions!=null?!1:node.$display!=null?!0:node.$table||node.$card!=null||node.$separator!==null?!0:node.arrayOptions&&node.rowIndex?!0:!1}),arrayArticle&&(arrayArticle.$forceArray=!0),article)},_findChartArticle=function(article,$bind){var self=this,chartNode=_traverseArticleNodes(article,function(node){if(node.$bind===$bind&&node.$forceArray!==!0)return!0});return chartNode},_findArrayArticle=function(article,$bind){var arrayNode=_traverseArticleNodes(article,function(node){if(node.$bind===$bind&&node.$forceArray===!0)return!0});return arrayNode},_traverseArticleNodes=function(node,matcher){if(matcher(node)===!0)return node;if(node.$items&&node.$items.length>0){var i,match;for(i=0;i<node.$items.length;i++){match=_traverseArticleNodes(node.$items[i],matcher);if(match)return match}}return null},_Klass=utils.defineClass(function CtrlArrayChart(controller,article,prototype,options){options=options||{},options.localPagination=prototype.isCube(),article.$arrayOptions=article.$arrayOptions||{},article.$arrayOptions.showSortFilter=!1,article.$arrayOptions.showSearch=!1,article.$display||(article.$display="chart"),this.level=controller.state.level==null?0:controller.state.level,Base.call(this,controller,article,prototype,options)},Base,{destroy:function(){Base.prototype.destroy.call(this),this._paginSynchro=null},isArrayChart:function(){return!0},buildHtml:function($$parent,controllerDao,buildOptions){Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions),this.isHighChart()?this.$$elmt.addClass("s-m-chart"):(this.isOpenDetailEnabled()&&this.addChartDetailLink(this.$$value),this.$$elmt.addClass("s-m-chart-array"))},isOpenDetailEnabled:function(){return this.isChartDetailPage()?!1:this.isCarouselDisplay()?!1:this.controller.isVignette?this.article.$openDetail!==!1:!0},addChartDetailLink:function($$elmt){$$elmt.attr("data-control-id",this.id).attr("data-action",globals.ACTCHARTDETAIL)},isDisplayedInDetailPage:function(){return this.isChartDetailPage()||!this.controller.isVignette},isChartDetailPage:function(){return this.controller.state.type==="chartdetail"},isHighChart:function(){return this.$display==="chart"},_newBuilder:function(options){this.isHighChart()?(this.$$value&&this.$$value.empty(),this.builder=new BuiderCart(this,this.$display,options)):Base.prototype._newBuilder.call(this,options)},_actRowSelect:function(rowId,$$target){var opt=this.drillDownOpt(rowId);opt.action="$drillDown",this.triggerOpenChartDetail(opt)},drillDownOpt:function(rowId){var self=this,opt={rowId:rowId,controlOriginId:self.controller.state.options.controlOriginId||self.id,forceDetailTitle:self._getCurrentMeasureLabel(rowId)};return self._dataProperties&&Object.keys(self._dataProperties).forEach(function(propertyName){opt[propertyName]=self._dataProperties[propertyName]}),opt},_getCurrentMeasureLabel:function(rowId){var hierarchieIndex=this.level===0?0:this.level-1;if(hierarchieIndex<0)return;var code=this.prototype.getDataByPath("$axes.0.$hierarchies."+hierarchieIndex+".0");if(!code)return;var dataRow=this.getRowById(rowId,this._arrayData);if(!dataRow||!dataRow.row)return;var $item=this.prototype.getPrototype("$item"),item=$item?$item.property(code):null;if(!item)return"";var label=dataRow.row.getValue(code);return item.$type==="application/x-choice"&&item.$value.$enum.some(function(element,i,array){return element.$value===label?(label=element.$title,!0):!1}),label},_actChartDetail:function(){if(this.isEmpty)return;this.triggerOpenChartDetail()},_setDataProperties:function(data){var self=this;if(data){var properties=["ifCube","level_c","level_m","level_p",,"recordsPerPage","refreshLink","req_id","displayLineNum"];self._dataProperties={},properties.forEach(function(propertyName){data[propertyName]!==undefined&&(self._dataProperties[propertyName]=data[propertyName])})}},_setArrayData:function(controllerDao,refresh){var res=Base.prototype._setArrayData.call(this,controllerDao,refresh);return this.$$ttl&&this.$$ttl.removeClass("s-m-no-data-title"),this._setDataProperties(controllerDao.data),res},getTitle:function(){return this.isHighChart()?Base.prototype.getTitle.call(this):this._findTitle()},_findTitle:function(proto){proto=proto||this.prototype;var $title=proto.data("$title");if($title)return $title;var $cube=proto.data("$cube");return $title=$cube&&$cube.$title,$title?$title:proto.parent?this._findTitle(proto.parent):""},_displayTitle:function(title){return title==null||title.trim&&title.trim().length===0||this.getAuthoring("$isTitleHidden")===!0?!1:!0},setEmptyArrayMsg:function(){this.isArrayField()||(this.$$ttl&&this.$$ttl.addClass("s-m-no-data-title"),$('<div class="s-m-no-data-label"/>').appendTo(this.$$value).text(locale.text("label.chart.nodata")))},createLocalPaginator:function(controllerDao){if(!this.prototype.isCube())return null;var gadget=this.controller.state.type=="chartdetail"?this.controller.parentPage.gadget:this.controller.gadget;if(!gadget)return null;var rsrcs=controllerDao.getValue(this.$bind);if(!rsrcs)return null;var count=gadget.parameters&&gadget.parameters.count!=null?gadget.parameters.count:10;return rsrcs.length<=count?null:new array.LocalPaginator(this,{count:count,length:rsrcs.length})},triggerOpenChartDetail:function(opt){this.forceDetailTitle=opt&&opt.forceDetailTitle?opt.forceDetailTitle:null;if(!this.$$elmt)return;var attrs={"data-control-id":this.id,"data-origin-id":opt&&opt.controlOriginId?opt.controlOriginId:this.id,"data-parent-id":this.controller.id,"data-nav":"chartdetail","data-nav-target":"application","data-sdata-url":this._getSdataUrl(opt)};eventListener.triggerNavigation(this.$$elmt,attrs)},_getMainController:function(controller){return controller.parentPage?this._getMainController(controller.parentPage):controller},setChartDetailAuthoring:function(article,level){level=level==null?0:level,this.article[chartsUtils.getChartDetailArticlePropertyName(level)]=article,notifications.publish("sm.auth.change.item.prop.ui")},childPageGetPageInfo:function(typePage){return typePage==="chartdetail"?this._getChartDetailPageInfo(typePage):Base.prototype.childPageGetPageInfo.call(this,typePage)},_getChartDetailPageInfo:function(typePage){var level=this.level+1,article=level>1?this._getMainController(this.controller).getControl(this.controller.state.options.controlOriginId).article:this.article;article=_checkChartArticle(article[chartsUtils.getChartDetailArticlePropertyName(level)],this.$bind);var chartArticle=article&&_findChartArticle(article,this.$bind),arrayArticle=article&&_findArrayArticle(article,this.$bind),opt={display:article?article.$display:null},prefs={};globals.isAuthoringActive()||(prefs=this._getChartDetailSettings(level)),opt=$.extend(!0,opt,prefs);var pageInfo={home:!1,type:typePage,cached:!1,refreshed:!1,subtype:"details",article:chartsUtils.getChartDetailArticle(opt,this.$bind,chartArticle,arrayArticle),level:level},parentVignette=this.controller.getParentVignette(),protoJson=$.extend(!0,{},this.controller.prototype.json);return parentVignette?(pageInfo.name=parentVignette.controller.prototype.getDataByPath("$dashboardName"),pageInfo.name+="_"+parentVignette.$bind+".$"+typePage,protoJson.$title=this.prototype.getDataByPath("$cube.$title")||locale.text("chartdetail.page.name")):(pageInfo.name=this.controller.state.name,protoJson.$title=this.forceDetailTitle||locale.text("chartdetail.page.level")+" "+pageInfo.level),pageInfo.prototype=this.prototype.create(protoJson,!0),pageInfo},_findMainPage:function(){var parent=this.controller;while(jsutils.isInstanceOf(parent,"ChartDetailPage"))parent=parent.parentPage;return parent},_getChartDetailSettings:function(level){var mainPage=this._findMainPage();if(mainPage){var settings=mainPage.getPageSettings(),levelSettings=settings.chartDetail&&settings.chartDetail[level];return levelSettings||{}}return{}},chartNeedsHeight:function(){return this.$display==="chart"&&this._layouytType==="stack"&&!this.isDisplayedInDetailPage()},_actPagination:function(linkName){Base.prototype._actPagination.call(this,linkName),this._paginSynchro&&this._paginSynchro.forEach(function(ctrl){setTimeout(function(){ctrl._actPagination(linkName)})})},paginAddSynchro:function(ctrl){if(!ctrl||!ctrl.paginAddSynchro)return;this._paginSynchro||(this._paginSynchro=[]);if(this._paginSynchro.indexOf(ctrl)>=0)return;this._paginSynchro.push(ctrl)},paginGetInfo:function(){return this._localPaginator?{local:!0,currentIdx:this._localPaginator.currentIdx}:null},paginSetInfo:function(paginInfo){if(!paginInfo||!paginInfo.local||!this._localPaginator)return null;this._localPaginator.currentIdx=paginInfo.currentIdx,this.refresh(this.controller.dao)},isAuthoringPropAllowed:function(property,value){return property!=="arrayDisplay"?Base.prototype.isAuthoringPropAllowed.call(this,property,value):value==="separator"?!1:this.isChartDetailPage()?this.article.$forceArray===!0?value!=="chart":value==="chart":!0},hasSublevel:function(){return this._arrayData.$links==null||this._arrayData.$links.$drillDown==null?!1:this._arrayData.$links.$drillDown.$isHidden!==!0},acceptRowSelection:function(){return this.hasSublevel()&&!this.controller.isVignette},getChartClickHandler:function(rowId){if(!this.acceptRowSelection())return null;var self=this;return function(){return self._actRowSelect(this.rowId,null),!0}},rowIdx2Id:function(idx){if(!this._arrayData||!this._arrayData.$resources)return-1;var rowId=-1;return rowId=this._arrayData.$resources[idx].getValue("$uuid"),rowId},_getSdataUrl:function(opt){if(!opt||!opt.action)return this._getMainController(this.controller).getOriginalSdataUrl();var row=this.getRowById(opt.rowId,this._arrayData);return Object.keys(row.row.data).forEach(function(key){opt[key]=row.row.data[key]}),this.prototype.resolveExpression(this._arrayData.$links[opt.action].$url,opt,!0)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/field/ctrlReference",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/sdata/sdataUtils","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/controls/field/ctrlFieldBase","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/application/eventListener","syracuse-tablet/html/js/helpers/globals"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),sdataUtils=require("syracuse-tablet/html/js/sdata/sdataUtils"),uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),eventListener=require("syracuse-tablet/html/js/application/eventListener"),globals=require("syracuse-tablet/html/js/helpers/globals"),_Klass=utils.defineClass(function CtrlReference(controller,article,prototype,options){options=options||{},this.isUnit=options.isUnit===!0,options.nativeCapabilities={scanBarcode:!this.isUnit},Base.call(this,controller,article,prototype,options),this.isUnit?(this.$isEditMode=!1,this.cssType="s-m-unit"):this.cssType="s-m-ref",this._isNumeric=!1},Base,{initFormatter:function(){var type=this.prototype.getFieldTypeForValue(this.$bind);return type==null||type.length===0?null:Base.prototype.initFormatter.call(this,type,null)},initReuseProperties:function(){Base.prototype.initReuseProperties.call(this),this.picker=null},getValue:function(prop){var val=this.getObjectValue()[prop||"$value"];return val==null?"":val},getObjectValue:function(){var val=Base.prototype.getValue.call(this);if(val===null||typeof val!="object")val={$value:val};return val.$description||(val.$description=""),val.$title||(val.$title=""),val},buildFieldTitle:function(fieldSlot,buildOptions){if(this.isUnit)return;Base.prototype.buildFieldTitle.call(this,fieldSlot,buildOptions)},buildFieldValue:function(fieldSlot,buildOptions){var self=this,parentElmt=Base.prototype.buildFieldValue.call(self,fieldSlot);self.formatter&&self.formatter.$type==="application/x-integer"&&$(parentElmt).addClass("s-m-numeric");if(self.$isEditMode)self.buildEditValue(parentElmt,self.getValue());else{var val=self.getObjectValue();self.isUnit?self.buildUnitValue(parentElmt,val.$value,val.$description,val.$title):self.buildDetailValue(parentElmt,self.getFormattedValue(val.$value),val.$description,val.$title,buildOptions)}},buildEditValue:function(parentElmt,value){var $lookuplink=this.getMetaData("$isReadOnly")!==!0&&this.getMetaData("$isDisabled")!==!0?this.prototype.getDataByPath("$item.$links.$lookup"):null;$lookuplink&&this.addPicker("lookup",fontUtils.getIconByName("lookupPicker")),this.createMainInput(parentElmt,this.getFormattedValue(value))},buildDetailValue:function(parentElmt,value,descr,title,buildOptions){var self=this,container=buildOptions&&buildOptions.displayCtx==="table"?parentElmt:self.addDetailLink(parentElmt);if(value.length>0){var descContent,$refDescFormat=self.getAuthoring("$refDescFormat");switch($refDescFormat){case"title":descContent=title;break;case"desctitle":descContent=self._combineTexts(descr,title);break;case"titledesc":descContent=self._combineTexts(title,descr);break;default:descContent=descr}var $refDescPosition=self.getAuthoring("$refDescPosition");if($refDescPosition==null||$refDescPosition.length===0)$refDescPosition=self.options.displayCtx==="table"?globals.XREF_DESCRPOS_TABLE:"right";var $$value=$("<div>").addClass("s-m-ref-val").text(value),$$desc=$("<div>").addClass("s-m-descr").text(descContent),arr;switch($refDescPosition){case"bottom":$(container).append($$value).append($$desc);break;case"left":$(container).append($$desc).append($$value),arr=[$$value,$$desc],$.each(arr,function(index,$$ee){$$ee.css("display","inline-block")}),$$desc.css("padding-right","5px");break;case"top":$(container).append($$desc).append($$value);break;case"none":$(container).append($$value);break;case"right":default:arr=[$$value,$$desc],$(container).append($$value).append($$desc),$.each(arr,function(index,$$ee){$$ee.css("display","inline-block")}),$$desc.css("padding-left","5px")}}},buildUnitValue:function(parentElmt,value,descr,title){var self=this,label=descr.length>0?descr:title.length>0?title:value;label=value||"",label&&label.toLowerCase&&(label=label.toLowerCase().smCapitalize()),uiUtils.createDomElement("span",["s-m-descr"],label,null,self.addDetailLink(parentElmt))},addDetailLink:function(parentElmt){var self=this;return self.options.displayCtx==="card"?parentElmt:self.prototype.getDataByPath("$item.$links.$details")?uiUtils.createDomElement("span",null,null,self._getLinkAttrs("$details"),parentElmt):parentElmt},setLookupValue:function(lookupData){if(!lookupData){console.log("setLookupValue Error - bind",this.$bind,"No lookupData");return}if(!lookupData.data){console.log("setLookupValue Error - bind",this.$bind,"No data");return}var field=(this.prototype.getDataByPath("$item")||{}).$lookupValue;if(!field){console.log("setLookupValue Error - bind",this.$bind,"No $lookupValue");return}var proto=lookupData.proto;proto;var value=lookupData.data[field];value==null&&(value="",console.log("setLookupValue Error - bind",this.$bind,"No field value",field)),this.setFieldValueFromSelector(value)},setDisplayValue:function(value){var strData;$.isPlainObject(value)?strData=value.$value||"":strData=value||"",Base.prototype.setDisplayValue.call(this,strData)},_getLinkAttrs:function(type){return{href:"#","data-action":"ctrlRefLink","data-params":type,"data-control-id":this.id}},_actLookupPicker:function(type){this._actCtrlRefLink("$lookup")},_actCtrlRefLink:function(type){var self=this,$url;$url=(this.prototype.getDataByPath("$item.$links."+type)||{}).$url;if(type==="$lookup"&&$url){var $lookupWhere=this.prototype.getDataByPath("$item.$autoLookWhere"),whereElements;$lookupWhere&&$.each($lookupWhere,function(property,valueProperty){var fieldValue=self._dao&&self._dao.getValue(valueProperty);fieldValue!=null&&(whereElements=whereElements||[],whereElements.push("("+property+" eq '{"+valueProperty+"}')"))});var autoLookupWhere=whereElements&&whereElements.join(" and ");autoLookupWhere&&$url.indexOf("where=")<0&&($url.indexOf("?")<0?$url=$url+"?where="+autoLookupWhere:$url=$url+"&where="+autoLookupWhere)}var link=$url?sdataUtils.getLinkInfo($url,this.controller.dao):null;if(!link)return;var attrs={"data-nav":link.page,"data-sdata-url":link.sDataUrl};type==="$lookup"&&(attrs["data-parent-id"]=this.controller.id,attrs["data-control-id"]=this.id),this.controller.isVignette&&(attrs["data-nav-target"]="application"),eventListener.triggerNavigation(this.$$elmt,attrs)},_combineTexts:function(el1,el2){var res;return res=el1&&el2?el1===el2?el1:el1+"-"+el2:el1||el2||"",res}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/layout/layoutStack",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/controls/layout/layoutBase","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/controls/layout/layoutBase").Klass,notifications=require("syracuse-tablet/html/js/helpers/notifications"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_Klass=utils.defineClass(function LayoutStack(controller,type,article,opts){var self=this;Base.call(self,controller,type,article,opts)},Base,{destroy:function(){Base.prototype.destroy.call(this),this.$$btnCollapse&&(this.$$btnCollapse.off(),this.$$btnCollapse=null)},buildHtml:function($$parent,controllerDao,buildOptions){var self=this;Base.prototype.buildHtml.call(self,$$parent,controllerDao,buildOptions),self.$$elmt.addClass("s-m-stack"),buildOptions&&buildOptions.makeFullHeight===!0&&self.$$elmt.height("100%");var css=[],level=$$parent.parents(".s-m-stack").length;if(level){var $theme=self.article&&self.article.$theme||String.fromCharCode(96+Math.min(level,3));css.push("s-m-theme-"+$theme)}this.isAdvanced=$theme==="advanced";var $collapsible=self.article&&self.article.$collapsible||"notcollapsible",$title=(this.getArticleText("$title")||"").trim();$collapsible!=="notcollapsible"&&css.push("s-m-collapsible"),$title.length&&css.push("s-m-title"),css.length&&self.$$elmt.addClass(css.join(" ")),($collapsible!=="notcollapsible"||$title.length>0)&&self._addHeader($collapsible,$title),self.$$content=$("<content>"),self._setStackColorClass(),self.$$elmt.append(self.$$content),self.buildChildrenHtml(self.$$content,controllerDao,buildOptions),self._updateCollapseState()},_setStackColorClass:function(){var self=this,color=self.article.$bgColor;color&&self.$$content.addClass("s-m-bg s-m-color-"+color)},buildTitle:function($$rootLyt,$$parent,controllerDao,destroyAfter){},_addHeader:function(state,title){var self=this;self.$$header=$("<header>"),state!=="notcollapsible"&&(self.$$btnCollapse=$('<btn class="'+state+" "+fontUtils.layoutExpandCollapseIcon(state==="collapsed",this.isAdvanced)+'">').appendTo(self.$$header),self.$$header.on("click",jsutils.bindFn(this._actCollapse,this)));var $$title=$('<div class="s-m-title">');$$title.append(title),self.$$elmt.append(self.$$header),self.$$header.append($$title)},_actCollapse:function(events,setCollapse){events&&!globals.isAuthoringActive()&&events.stopPropagation();if(!this.$$btnCollapse)return;setCollapse===!0?this.$$btnCollapse.removeClass("expanded "+fontUtils.layoutExpandCollapseIcon(setCollapse,this.isAdvanced)).addClass("collapsed "+fontUtils.layoutExpandCollapseIcon(!setCollapse,this.isAdvanced)):setCollapse===!1?this.$$btnCollapse.removeClass("collapsed "+fontUtils.layoutExpandCollapseIcon(!setCollapse,this.isAdvanced)).addClass("expanded "+fontUtils.layoutExpandCollapseIcon(setCollapse,this.isAdvanced)):this.$$btnCollapse.toggleClass("collapsed "+fontUtils.layoutExpandCollapseIcon(setCollapse,this.isAdvanced)).toggleClass("expanded "+fontUtils.layoutExpandCollapseIcon(!setCollapse,this.isAdvanced)),this._updateCollapseState(),this.$$btnCollapse.hasClass("collapsed")||notifications.publish("sm.layout.expanded"),notifications.notifyController("sm.scroller.update",this.controller)},_updateCollapseState:function(){var self=this;if(!self.$$btnCollapse||!self.$$content)return;var collapse=self.$$btnCollapse.hasClass("expanded");self.$$content.toggle(collapse)},getAuthState:function(dirtyKeys){var self=this;return dirtyKeys.$collapsible?null:{collapsed:self.$$btnCollapse?self.$$btnCollapse.hasClass("collapsed"):!1}},setAuthState:function(state){state&&state.collapsed!=null&&this._actCollapse(null,state.collapsed)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/layout/layoutTab",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/layout/layoutBase","syracuse-tablet/html/js/ui/uiUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/layout/layoutBase").Klass,uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),_Klass=utils.defineClass(function LayoutTab(controller,type,article,opts){var self=this;Base.call(self,controller,type,article,opts)},Base,{buildHtml:function($$parent,controllerDao,buildOptions){var self=this;Base.prototype.buildHtml.call(self,$$parent,controllerDao,buildOptions),self.$$elmt.addClass("s-m-tabs");var slot=uiUtils.createDomElement("div",[self.article.$layoutType]);$.each(self.children,function(index,layout){layout.isTabSection=!0;var item=uiUtils.createDomElement("div",["s-m-layout-cell"],null,{style:"display:"+(index!=0?"none":"")},slot);layout.buildHtml($(item),controllerDao,buildOptions)})},buildTitle:function(){}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/layout/layoutHub",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/layout/layoutBase","syracuse-tablet/html/js/ui/rect","syracuse-tablet/html/js/helpers/scroller/scrollerHelpers","syracuse-tablet/html/js/helpers/uiSettings"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/layout/layoutBase").Klass,uiRect=require("syracuse-tablet/html/js/ui/rect"),scroller=require("syracuse-tablet/html/js/helpers/scroller/scrollerHelpers"),uiSettings=require("syracuse-tablet/html/js/helpers/uiSettings"),_Klass=utils.defineClass(function LayoutHub(controller,type,article,opts){var self=this;Base.call(self,controller,type,article,opts),this._gestureMgr=null,this._tilesGroupSpacing=uiSettings.getProp("hubLayout.groupSpacing"),this._minLandscapeHeigth=uiSettings.getProp("hubLayout.landscapeMinHeigth")},Base,{destroy:function(){Base.prototype.destroy.call(this),this._gestureMgr&&(this._gestureMgr.destroy(),this._gestureMgr=null)},buildHtml:function($$parent,controllerDao,buildOptions){var self=this;buildOptions=buildOptions||{},Base.prototype.buildHtml.call(self,$$parent,controllerDao,buildOptions),self.$$elmt.addClass("s-m-hub"),self.$$scrollElmt=$('<div class="s-m-scroll-elmt">').appendTo(self.$$elmt),self.buildChildrenHtml(self.$$scrollElmt,controllerDao,buildOptions),self._gestureMgr&&self._gestureMgr.destroy(),self._gestureMgr=scroller.newScroller(self.$$scrollElmt,{isPageScroller:!0})},onResize:function(context){var self=this,parentRect=self.controller.getMainContentRect(),pos=self.$$elmt.position(),w=parentRect.width,h=parentRect.height-pos.top,rel=w/h,posX=0,posY=0,opts;self.scrollDirection=rel>1.2&&h>=this._minLandscapeHeigth?"h":"v",self.scrollDirection==="h"?self.$$elmt.css({width:"100%",height:h+"px"}):self.$$elmt.css({width:w+"px",height:"100%"});if(self.children){var last=self.children.length-1;self.children.forEach(function(child,idx){opts={posX:posX,posY:posY,maxHeight:h,maxWidth:w,scrollDirection:self.scrollDirection,allowSmallTiles:rel>1.2},child.onResize(context,opts),self.scrollDirection==="h"?posX+=child.getWidth()+(idx<last?self._tilesGroupSpacing:0):posY+=child.getHeight()+(idx<last?self._tilesGroupSpacing:0)})}var width,height;self.scrollDirection==="h"?(width=posX,height=h):(width=w,height=posY);var oldScroll=null;context&&context.preserveScroll===!0&&(oldScroll=self._gestureMgr.getScroll()),self._gestureMgr.reset(),self.$$scrollElmt.width(width),self.$$scrollElmt.height(height);var scrollRect=uiRect.elmtRect(self.$$scrollElmt,"outer"),viewRect=parentRect.intersectRect(scrollRect);viewRect!=null&&!viewRect.contains(scrollRect)?viewRect:null;if(!viewRect)return;self._gestureMgr.init(viewRect,self.scrollDirection,0),oldScroll!=null&&self._gestureMgr.autoScroll(oldScroll)},getGestureMgr:function(){return this._gestureMgr},savedCtxCreate:function(type){return type==="link"?null:this._gestureMgr?{hubScroll:this._gestureMgr.savedCtxCreate()}:null},savedCtxRestore:function(ctx){ctx!=null&&this._gestureMgr&&this._gestureMgr.savedCtxRestore(ctx.hubScroll)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/layout/layoutHubGroup",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/layout/layoutBase","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/helpers/uiSettings","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/layout/layoutBase").Klass,uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),uiSettings=require("syracuse-tablet/html/js/helpers/uiSettings"),locale=require("syracuse-tablet/html/js/helpers/locale"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_validSizes=["small","medium","wide","large","full","all"],_Klass=utils.defineClass(function LayoutHubGroup(controller,type,article,opts){var self=this;Base.call(self,controller,type,article,opts),self._settings=uiSettings.getProp("hubGroup"),self.isEditable=self._getCapability("edit"),self.isDeletable=self._getCapability("delete"),self.isDraggable=self._getCapability("draggable")},Base,{buildHtml:function($$parent,controllerDao,buildOptions){var self=this;Base.prototype.buildHtml.call(self,$$parent,controllerDao,buildOptions),self.$$elmt.addClass("s-m-hub-group"),self.$$separator=$(uiUtils.createDomElement("div",null,null,null,self.$$elmt)),self.$$separator.addClass("s-m-hub-group-separator"),self._buildCellStructure(controllerDao,buildOptions)},_buildCellStructure:function(controllerDao,buildOptions){var self=this;self.cells=[];var cell=null,notLinksCpt=0,index=0;self.children?self.children.forEach(function(layout){(layout.isLinkVignette==null||layout.isLinkVignette()!==!0)&&notLinksCpt++;var size=layout.article&&layout.article.$size||"medium";_validSizes.indexOf(size)<0&&(size=_validSizes[1],layout.article=layout.article||{},layout.article.$size=size),cell||(cell=self._createCell(size),cell.domItem=uiUtils.createDomElement("div",null,null,null,self.$$elmt),self.cells.push(cell)),size==="small"?(layout.buildHtml($(cell.domItem),controllerDao,buildOptions),cell.children.push(layout),cell.children.length===4&&(cell=null)):(cell.children.length>0&&(cell=self._createCell(size),cell.domItem=uiUtils.createDomElement("div",null,null,null,self.$$elmt),self.cells.push(cell)),layout.buildHtml($(cell.domItem),controllerDao,buildOptions),cell.children.push(layout),cell=null),index++}):self.$$elmt.addClass("empty");if(buildOptions.showAddTiles){var cell=self._createCell("medium"),opts={icon:fontUtils.dashboardIcon("addHiddenTile"),title:locale.text("welcome.dashboard.add.hiddenTile"),action:"addHiddenTile",css:"s-m-tile-action s-m-color-tile-action medium",params:self.id};self._addActionTile(cell,opts),self.cells.push(cell)}self._linksOnly=notLinksCpt===0},_addActionTile:function(cell,opts){var self=this,optsAction={"data-action":opts.action,"data-params":opts.params};cell.domItem=uiUtils.createDomElement("div",null,null,optsAction,self.$$elmt);var addTile=uiUtils.createDomElement("div",opts.css,null,null,cell.domItem);$(addTile).append('<section class="s-m-icon"><div><div class="s-m-sage-app-icon '+opts.icon+'"></div></div></section>'),$(addTile).append('<section class="s-m-title"><div>'+opts.title+"</div></section>")},_createCell:function(size){var self=this;size=size==="small"?"medium":size;var cell={size:size,children:[]};return cell},onResize:function(context,options){this.calculateLayout(options),Base.prototype.onResize.call(this,context)},calculateLayout:function(options){var self=this,size,index=0;self._headerSpace=self.$$header?self.$$header.height():0,self._width=0,self._height=0,self.hubGroupOptions=options||self.hubGroupOptions,self.$$elmt.removeClass("s-m-hub-group-v s-m-hub-group-h"),self.$$elmt.addClass("s-m-hub-group-"+self.hubGroupOptions.scrollDirection),self.hubGroupOptions.scrollDirection==="h"?self._calculateLayoutHorizontal():self._calculateLayoutVertical(),self._width=4*self.hubGroupOptions.baseSize+6,self._height=2*self.hubGroupOptions.baseSize,self.cells.forEach(function(cell){size=cell.size,cell.domItem.style.left=cell.x+"px",cell.domItem.style.top=cell.y+self._headerSpace+"px",cell.domItem.style.width=self._sizes[size].width+2+"px",cell.domItem.style.height=self._sizes[size].height+2+"px",cell.domItem.style.position="absolute",$(cell.domItem).attr("data-cellIndex",index),$(cell.domItem).attr("coord",cell.abs+","+cell.ord),$(cell.domItem).attr("silo",cell.silo),$(cell.domItem).attr("size",cell.size),cell.x+self._sizes[size].width>self._width&&(self._width=cell.x+self._sizes[size].width),cell.y+self._sizes[size].height>self._height&&(self._height=cell.y+self._sizes[size].height);var x=0,y=0;cell.children.forEach(function(tileLayout){size=tileLayout.getAuthoringSize(),tileLayout.calculateLayout(x,y,size,self._sizes[size]),x!==0?(x=0,y+=self._sizes[size].height+self.hubGroupOptions.padY):x+=self._sizes[size].width+self.hubGroupOptions.padX}),index++});var style=self.$$elmt.get(0).style;self.hubGroupOptions.scrollDirection==="h"?(self.cells.length<1&&globals.isAuthoringActive()&&(self._width=self.hubGroupOptions.maxGroupWidth),style.top="0px",style.left=self.hubGroupOptions.posX+"px",style.width=6+self._width+"px",style.height=self.hubGroupOptions.maxHeight-6+"px"):(self.cells.length<1&&globals.isAuthoringActive()&&(self._height=self.hubGroupOptions.baseSize),style.top=self.hubGroupOptions.posY+"px",style.left="0px",self._width=self.hubGroupOptions.maxGroupWidth,style.width=self.hubGroupOptions.maxGroupWidth+"px",self._height+=self._headerSpace+self._settings.portraitPadY,style.height=self._height+"px",self.cells.length<1&&globals.isAuthoringActive())},_calculateLayoutHorizontal:function(){var self=this,padSilo=0;self.hubGroupOptions.baseSize=self._settings.landscapeBaseSize,self.hubGroupOptions.padX=self._settings.landscapePadX,self.hubGroupOptions.padY=self._settings.landscapePadY,self.hubGroupOptions.maxGroupHeight=self.hubGroupOptions.maxHeight-self._headerSpace;var maxTiles=self.hubGroupOptions.maxGroupHeight/(self.hubGroupOptions.baseSize+self.hubGroupOptions.padY),remainPixels=self.hubGroupOptions.maxGroupHeight-Math.floor(maxTiles)*(self.hubGroupOptions.baseSize+self.hubGroupOptions.padY),remainPerTile=Math.floor(remainPixels/maxTiles),paddingPerTile=Math.floor(remainPixels/maxTiles/2);self.hubGroupOptions.baseSize+=remainPerTile,self.hubGroupOptions.paddingPerTile=paddingPerTile,self.hubGroupOptions.maxGroupWidth=4*self.hubGroupOptions.baseSize+3*self.hubGroupOptions.padX,self.hubGroupOptions.maxFullTileHeight=Math.floor((self.hubGroupOptions.maxGroupHeight+self.hubGroupOptions.padY)/(self.hubGroupOptions.baseSize+self.hubGroupOptions.padY)/2)*(self.hubGroupOptions.baseSize+self.hubGroupOptions.padY)*2-self.hubGroupOptions.padY,self.hubGroupOptions.maxAllTileHeight=self.hubGroupOptions.maxFullTileHeight,self.hubGroupOptions.maxAllTileWidth=self.hubGroupOptions.maxWidth,self._sizes={small:{width:self.hubGroupOptions.baseSize,height:self.hubGroupOptions.baseSize,paddingX:self.hubGroupOptions.paddingPerTile,paddingY:self.hubGroupOptions.paddingPerTile},medium:{width:self.hubGroupOptions.baseSize*2+self.hubGroupOptions.padX,height:self.hubGroupOptions.baseSize*2+self.hubGroupOptions.padY,paddingX:self.hubGroupOptions.paddingPerTile,paddingY:self.hubGroupOptions.paddingPerTile},wide:{width:self.hubGroupOptions.baseSize*4+self.hubGroupOptions.padX*3,height:self.hubGroupOptions.baseSize*2+self.hubGroupOptions.padY,paddingX:self.hubGroupOptions.paddingPerTile,paddingY:self.hubGroupOptions.paddingPerTile},large:{width:self.hubGroupOptions.baseSize*4+self.hubGroupOptions.padX*3,height:self.hubGroupOptions.baseSize*4+self.hubGroupOptions.padY*3,paddingX:self.hubGroupOptions.paddingPerTile,paddingY:self.hubGroupOptions.paddingPerTile},full:{width:self.hubGroupOptions.baseSize*4+self.hubGroupOptions.padX*3,height:self.hubGroupOptions.maxFullTileHeight,paddingX:self.hubGroupOptions.paddingPerTile,paddingY:self.hubGroupOptions.paddingPerTile},all:{height:self.hubGroupOptions.maxAllTileHeight,width:self.hubGroupOptions.maxAllTileWidth,paddingX:self.hubGroupOptions.paddingPerTile,paddingY:self.hubGroupOptions.paddingPerTile}};var relX=0,relY=0,x=0,y=0,prevOrd=0,silo=0;self.cells.forEach(function(cell){cell.w=self._sizes[cell.size].width,cell.h=self._sizes[cell.size].height;if(y+cell.h>self.hubGroupOptions.maxGroupHeight||y!==0&&(cell.size==="full"||cell.size==="all"))y=0,relX+=self.hubGroupOptions.maxGroupWidth+self.hubGroupOptions.padX+padSilo,x=relX;cell.size==="medium"?(x-relX+cell.w>self.hubGroupOptions.maxGroupWidth&&(x=relX,y+=cell.h+self.hubGroupOptions.padY),y+cell.h>self.hubGroupOptions.maxGroupHeight&&(y=0,relX+=self.hubGroupOptions.maxGroupWidth+self.hubGroupOptions.padX+padSilo,x=relX),cell.x=x,cell.y=y,x+=cell.w+self.hubGroupOptions.padX):(x!==relX&&(x=relX,y+=self._sizes.medium.height+self.hubGroupOptions.padY),y+cell.h>self.hubGroupOptions.maxGroupHeight&&(y=0,relX+=self.hubGroupOptions.maxGroupWidth+self.hubGroupOptions.padX+padSilo,x=relX),cell.x=x,cell.y=y,y+=cell.h+self.hubGroupOptions.padY,cell.size==="all"&&(y=0,relX+=cell.w+self.hubGroupOptions.padX,x=relX)),cell.abs=Math.round(cell.x/(self.hubGroupOptions.baseSize*2+self.hubGroupOptions.padX)),cell.ord=Math.round(cell.y/(self.hubGroupOptions.baseSize*2+self.hubGroupOptions.padY)),cell.ord===0&&cell.ord!==prevOrd&&silo++,cell.silo=silo,prevOrd=cell.ord})},_calculateLayoutVertical:function(){var self=this,centerPadX;self.hubGroupOptions.paddingPerTile=0,self.hubGroupOptions.maxGroupHeight=self.hubGroupOptions.maxHeight-self._headerSpace,self.hubGroupOptions.padX=self._settings.portraitPadX,self.hubGroupOptions.padY=self._settings.portraitPadY,self.hubGroupOptions.maxFullTileHeight=self.hubGroupOptions.maxGroupHeight-self.hubGroupOptions.padY;var small=!1;self.hubGroupOptions.maxWidth>=self._settings.portraitWideMinWidth||self.hubGroupOptions.allowSmallTiles===!0&&self._linksOnly===!0?(self.hubGroupOptions.baseSize=Math.floor((self.hubGroupOptions.maxWidth-7*self.hubGroupOptions.padX)/8),self.hubGroupOptions.maxGroupWidth=8*self.hubGroupOptions.baseSize+7*self.hubGroupOptions.padX):(self.hubGroupOptions.baseSize=Math.floor((self.hubGroupOptions.maxWidth-3*self.hubGroupOptions.padX)/4),self.hubGroupOptions.maxGroupWidth=4*self.hubGroupOptions.baseSize+3*self.hubGroupOptions.padX),self.hubGroupOptions.maxAllTileHeight=self.hubGroupOptions.maxFullTileHeight,self.hubGroupOptions.maxAllTileWidth=self.hubGroupOptions.maxWidth,centerPadX=(self.hubGroupOptions.maxWidth-self.hubGroupOptions.maxGroupWidth)/2,self.hubGroupOptions.maxGroupWidth+=centerPadX,self._sizes={small:{width:self.hubGroupOptions.baseSize,height:self.hubGroupOptions.baseSize,paddingX:self.hubGroupOptions.paddingPerTile,paddingY:self.hubGroupOptions.paddingPerTile},medium:{width:self.hubGroupOptions.baseSize*2+self.hubGroupOptions.padX,height:self.hubGroupOptions.baseSize*2+self.hubGroupOptions.padY,paddingX:self.hubGroupOptions.paddingPerTile,paddingY:self.hubGroupOptions.paddingPerTile},wide:{width:self.hubGroupOptions.baseSize*4+self.hubGroupOptions.padX*3,height:self.hubGroupOptions.baseSize*2+self.hubGroupOptions.padY,paddingX:self.hubGroupOptions.paddingPerTile,paddingY:self.hubGroupOptions.paddingPerTile},large:{width:self.hubGroupOptions.baseSize*4+self.hubGroupOptions.padX*3,height:self.hubGroupOptions.baseSize*4+self.hubGroupOptions.padY*3,paddingX:self.hubGroupOptions.paddingPerTile,paddingY:self.hubGroupOptions.paddingPerTile},full:{width:self.hubGroupOptions.baseSize*4+self.hubGroupOptions.padX*3,height:self.hubGroupOptions.maxFullTileHeight,paddingX:self.hubGroupOptions.paddingPerTile,paddingY:self.hubGroupOptions.paddingPerTile},all:{width:self.hubGroupOptions.maxAllTileWidth,height:self.hubGroupOptions.maxAllTileHeight,paddingX:self.hubGroupOptions.paddingPerTile,paddingY:self.hubGroupOptions.paddingPerTile}};var x=centerPadX,y=0,yInc=0;self.cells.forEach(function(cell){cell.w=self._sizes[cell.size].width,cell.h=self._sizes[cell.size].height,cell.x=x,cell.y=y,x+cell.w>self.hubGroupOptions.maxGroupWidth?(x=centerPadX,y+=yInc+self.hubGroupOptions.padY,cell.x=x,cell.y=y,yInc=cell.h,x+=cell.w+self.hubGroupOptions.padX):(x+=cell.w+self.hubGroupOptions.padX,yInc=cell.h>yInc?cell.h:yInc),cell.abs=Math.round(cell.x/(self.hubGroupOptions.baseSize*2+self.hubGroupOptions.padX)),cell.ord=Math.round(cell.y/(self.hubGroupOptions.baseSize*2+self.hubGroupOptions.padY)),cell.silo=0})},getTitle:function(){return this.getArticleText("$title")},_getCapability:function(capability){return this.article.$capabilities&&this.article.$capabilities.indexOf(capability)>-1},getWidth:function(){return this._width},getHeight:function(){return this._height}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/layout/layoutTile",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/controls/layout/layoutBase","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/controls/layout/layoutBase").Klass,locale=require("syracuse-tablet/html/js/helpers/locale"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_Klass=utils.defineClass(function LayoutTile(controller,type,article,opts){Base.call(this,controller,type,article,opts),article.$bgColor==null&&(article.$bgColor=globals.TILEDEFCOLOR),article.$bgColor=article.$bgColor.toLowerCase()},Base,{initReuseProperties:function(){Base.prototype.initReuseProperties.call(this)},buildHtml:function($$parent,controllerDao,buildOptions){var self=this;Base.prototype.buildHtml.call(self,$$parent,controllerDao,buildOptions),self.$$elmt.addClass("s-m-tile"),self.$$elmt.attr("data-empty-tile",self.article.$items[0].$bind),self.$$body=self.$$elmt,self._setCellColorClass(),self.buildChildrenHtml(self.$$body,controllerDao,buildOptions),self.isEmpty&&self._buildEmptyTile(self.$$body,buildOptions)},_buildEmptyTile:function($parent,buildOptions){$parent.append('<section class="s-m-icon"><div><div class="s-m-sage-app-icon '+fontUtils.dashboardIcon("emptyTile")+'"></div></div></section>'),$parent.append('<section class="s-m-title"><div>'+locale.text("welcome.dashboard.emptyTile")+"</div></section>")},_setCellColorClass:function(){var bg=(this.article.$bgColor||"").toLowerCase();if(bg==="transparent"||bg.length===0)return;bg="s-m-color-"+bg,this.$$elmt.addClass("s-m-bg "+bg)},calculateLayout:function(x,y,authSize,sizeInfo){var css={left:x+"px",top:y+"px",width:sizeInfo.width+"px",height:sizeInfo.height+"px",position:"absolute","padding-left":sizeInfo.paddingX+"px","padding-right":sizeInfo.paddingX+"px","padding-bottom":sizeInfo.paddingY+"px","padding-top":(this.$$header?this.$$header.height():0)+sizeInfo.paddingY+"px"};this.$$elmt.css(css),this.$$elmt.addClass(authSize)},getAuthoringSize:function(){return this.article&&this.article.$size||"medium"},notifSpecialArrayHosted:function(typeArray){if(!this.$$elmt)return;this.$$elmt.removeClass("s-m-carousel s-m-chart"),typeArray==="carousel"?this.$$elmt.addClass("s-m-carousel"):typeArray==="chart"&&this.$$elmt.removeClass("s-m-bg s-m-color-"+this.article.$bgColor).addClass("s-m-chart")},isLinkVignette:function(){var child=this.children?this.children[0]:null;return!child||child.$type!=="tablet/x-vignette"?!1:child.isLinkVignette()}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/layout/layoutCell",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/controls/layout/layoutBase","syracuse-tablet/html/js/ui/uiUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/controls/layout/layoutBase").Klass,uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),_sizes=[{$prop:"$widthXs",$prefix:"col-xs-",$def:12},{$prop:"$widthSm",$prefix:"col-sm-",$def:6},{$prop:"$widthMd",$prefix:"col-md-",$def:4},{$prop:"$widthLg",$prefix:"col-lg-",$def:3}],_Klass=utils.defineClass(function LayoutCell(controller,type,article,opts){Base.call(this,controller,type,article,opts),article.$bgColor==null&&(article.$bgColor=globals.CELLDEFCOLOR),article.$bgColor=article.$bgColor.toLowerCase()},Base,{initReuseProperties:function(){Base.prototype.initReuseProperties.call(this),this.$$cell=null},buildHtml:function($$parent,controllerDao,buildOptions){Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions),this.$$elmt.addClass("s-m-cell"),this.controller.isDashboard()&&this.$$elmt.addClass("dashboard"),this.$$cell=$(uiUtils.createDomElement("div",["cell"],null,null,this.$$elmt)),this._setCellColorClass(),this._setCellSizeClasses(),this.buildChildrenHtml(this.$$cell,controllerDao,buildOptions)},_setCellColorClass:function(){var bg=this.article.$bgColor;if(bg==="transparent"||bg.length===0)return;this.$$cell.addClass("s-m-bg s-m-color-"+bg)},_setCellSizeClasses:function(){var self=this;if(self.article.$sameSize!==!0){var widthFound=!1,sizes=[],sz;_sizes.forEach(function(size){sz=self.article[size.$prop],sz!=null&&sz>=1&&sz<=12&&sizes.push(size.$prefix+sz)}),sizes.length==0&&(self.article.$sameSize=!0,self.article.$widthAll=12)}self.article.$sameSize===!0&&(self.article.$widthAll==null&&(self.article.$widthAll=12),sizes=["col-xs-"+Math.min(12,Math.max(1,self.article.$widthAll),self.article.$widthAll)]),self.$$elmt.addClass(sizes.join(" "))},_ensureHeader:function(){return Base.prototype._ensureHeader.call(this,this.$$cell)},notifSpecialArrayHosted:function(typeArray){if(!this.$$cell)return;typeArray==="chart"?(this.$$cell.removeClass("s-m-bg s-m-color-"+this.article.$bgColor),this.$$elmt.addClass("s-m-chart")):typeArray==="carousel"&&this.$$elmt.addClass("s-m-carousel")}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/vignetteBase",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/ui/rect","syracuse-tablet/html/js/controls/ctrlBase","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/application/pageLoader","syracuse-tablet/html/js/application/pageRegistry","syracuse-tablet/html/js/ui/modals/modal","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/controls/ctrlFactory","syracuse-tablet/html/js/application/gadget","syracuse-tablet/html/js/helpers/dashboardWelcomeUtils","syracuse-tablet/html/deps/hammerjs-2.0.4/hammer"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),uiRect=require("syracuse-tablet/html/js/ui/rect"),Base=require("syracuse-tablet/html/js/controls/ctrlBase").Klass,uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),PageLoader=require("syracuse-tablet/html/js/application/pageLoader").Klass,pageRegistry=require("syracuse-tablet/html/js/application/pageRegistry"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("app"),locale=require("syracuse-tablet/html/js/helpers/locale"),ctrlFactory=require("syracuse-tablet/html/js/controls/ctrlFactory"),Gadget=require("syracuse-tablet/html/js/application/gadget").Klass,dashboardWelcomeUtils=require("syracuse-tablet/html/js/helpers/dashboardWelcomeUtils"),Hammer=require("syracuse-tablet/html/deps/hammerjs-2.0.4/hammer"),_actionTitleMgr={action:"togglePinVignette",iconActionAdd:function(vignetteCtrl){if(vignetteCtrl._$$actionIcon)return!0;var icon=fontUtils.getPinVignetteIcon("off")||"",iconBarCtrl=_actionTitleMgr.getIconBarCtrl(vignetteCtrl);return!iconBarCtrl||icon.length===0?!1:(iconBarCtrl.$$header.addClass("s-m-has-act-icon").attr({"data-action":_actionTitleMgr.action,"data-control-id":vignetteCtrl.id}).append($('<i class="s-m-tile-act '+icon+'" style="float:right"/>')),vignetteCtrl.controller.isDashboard("hub")&&iconBarCtrl.$$elmt.css("padding-top",iconBarCtrl.$$header.height()+"px"),vignetteCtrl._$$actionIcon=_actionTitleMgr.iconActionToggleStatus(vignetteCtrl,"off"),!0)},iconActionToggleStatus:function(vignetteCtrl,status){status=status||"off";var iconBarCtrl=_actionTitleMgr.getIconBarCtrl(vignetteCtrl);if(!iconBarCtrl)return;iconBarCtrl.$$header.toggleClass("s-m-color-"+globals.CELLENABLEDCOLOR,status==="on");var $$res=iconBarCtrl.$$header.find("i.s-m-tile-act");return $$res.removeClass(fontUtils.getPinVignetteIcon("all")).addClass(fontUtils.getPinVignetteIcon(status)),$$res},getIconBarCtrl:function(vignetteCtrl){var ctrl=vignetteCtrl.parent;return!ctrl||!ctrl._ensureHeader||!ctrl.$$elmt?null:(ctrl._ensureHeader(),ctrl)}},_waitConfig={className:"waiting-blocks",elements:5,auto:!0,speed:200},_templates={main:'		<section/>		<footer style="display:none"/> 		<div class="s-m-waiting bckg" style="display:none"/> 		<div class="s-m-waiting wheel" style="display:none"/> 	',iframe:'		<br><iframe src="{{url}}" style="position: absolute; top: 0px; left: 0px; height: 100vh; width: 100vh;"/>	',navbtns:'		<span data-action="vignetteBack" class="'+fontUtils.vignetteIcons("back")+'" style="display:none"></span>		<span  data-action="vignetteHome" class="'+fontUtils.vignetteIcons("home")+'" style="display:none"></span>	',vignetteError:'		<a draggable="false" href="#" data-action="vignetteError">{{text}}</a>	',linkPage:'		<div draggable="false" href="{{href}}"			class="s-m-link-page">				{{#if icon}}					<section class="s-m-icon">						<div>							<div class="{{icon}}"></div>						</div>					</section>				{{/if}}				<section class="s-m-title">					<div>{{title}}</div>				</section>		</div>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl(ctx)},_Klass=utils.defineClass(function VignetteBase(controller,article,prototype,opts){article.$article=article.$article||{},Base.call(this,controller,article,prototype,opts),this._currentPage=null,this._pageLoader=null,this._$$wait=null,this._stateStack=[],this._error=null,this.displayStyle=prototype.data("$displayStyle"),this.openLinkInVignette=globals.$config("openLinkInVignette"),this._actionsEnabled=!1,this._gadget=new Gadget(this.prototype.getVignetteGadget()),this._gadget.isValid()||(this._badGadgetReason=this._gadget.getInvalidReason(),this._gadget=null)},Base,{destroy:function(){this.destroyActionControls(),this._error=null,this.clearContent(),this._$$wait&&uiUtils.waitPluginDestroy(this._$$wait),this._pageLoader&&(this._pageLoader.destroy(),this._pageLoader=null),this._gadget&&(this._gadget.destroy(),this._gadget=null),this.hammer&&(this.hammer.destroy(),this.hammer=null),this._$$actionIcon=null,Base.prototype.destroy.call(this)},clearContent:function(){this._currentPage&&(this._currentPage.destroy(),this._currentPage=null),this._$$content&&(globals.getApplication().removeAllChildPages(this._$$content),this._$$content.empty()),this._stateStack=[]},getPageControl:function(ctrlId){return this._currentPage&&this._currentPage.getControl&&this._currentPage.getControl(ctrlId)},getPageLayout:function(id){return this._currentPage&&this._currentPage.getLayout&&this._currentPage.getLayout(id)},getPageStructElmt:function(id){return this.getPageControl(id)||this.getPageLayout(id)},getPage:function(){return this._currentPage},onMainPageResize:function(info,orientation,deviceType){this._actionsEnabled&&info.deviceChanged&&(this._doTogglePinVignette(!1),this.destroyActionControls());if(this._currentPage==null||this._currentPage.state.options.$displayStyle!=="$full")return;this._currentPage.onMainPageResize(info,orientation,deviceType)},changePage:function(state,options){options=options||{},options.openLinkInVignette=this._openLinkInsideVignette(),options.$displayStyle="$full",this._loadPage("openNewPage",state,options)},refreshPage:function(options){var self=this;if(!self._currentPage)throw new Error("No current page");self._error&&this._removeError(),self._currentPage.refresh(options,{waitWheelStart:function(controlId){self.waitWheelStart()},waitWheelStop:function(controlId){self.waitWheelStop()}}).then(function(){}).fail(function(e){modal.error(locale.text("err.load.main"),e)})},hasBtnsBar:function(){return this._openLinkInsideVignette()},_openLinkInsideVignette:function(state){if(this.openLinkInVignette===!0)return!0;var name;return state==null?name=this._currentPage?this._currentPage.state.name:null:$.isPlainObject(state)?name=state.name:name=state,typeof name=="string"&&(name==="rowdetail"||name==="carddesign"||name.smEndsWith("$lookup"))&&(this.openLinkInVignette=!0),this._currentPage&&this._currentPage.isChild&&(this.openLinkInVignette=!0),this.openLinkInVignette},reloadPage:function(loadOptions){if(!this.$displayStyle==="$full"||!this._currentPage)return $.smResolve();this._reloadSavedCtx=null,loadOptions&&loadOptions.authoringUpdate===!0&&this.getPage()&&(this._reloadSavedCtx=this.getPage().savedCtxCreate());var pageInfo=$.extend(!0,{},this._currentPage.state);this.clearContent(),this._pageLoader||this._initPageLoader();var self=this;return $.smResolve().then(function(){return self._pageLoader.load(pageInfo,!1,loadOptions)}).fail(function(e){self._displayError(locale.text("error.page.loading"),e)})},_loadPage:function(action,state,pageOptions,loadOptions){var self=this;self._error=null,self._pageLoader||self._initPageLoader();var step;if(action==="back"||action==="home"||action==="openNewPage"&&typeof state=="object")step=$.smResolve(state);else{if(action!=="openNewPage"||typeof state!="string")throw new Error("Unexpected object state");pageOptions=pageOptions||{},pageOptions.vignette=!0;var articleCopy=pageOptions.vignetteArticle;step=pageRegistry.getPageInfo(state,pageOptions,self._currentPage).then(function(pageInfo){return pageInfo.options=pageInfo.options||{},articleCopy&&(pageInfo.options.vignetteArticle=articleCopy),pageInfo.options.parentVignette=self,pageInfo})}return step.then(function(pageInfo){if(pageInfo.options&&pageInfo.options.$displayStyle==="$full")return self._pageLoader.load(pageInfo,action==="back",loadOptions);if(pageOptions.gadget){self._gadget&&self._gadget.destroy(),self._gadget=new Gadget(pageOptions.gadget);var icon=self._getCssIcon("s-m-sage-gadget-icon"),attrs={"data-nav":pageInfo.name,"data-gadget-id":self._gadget.data("$uuid"),"data-application-name":self._gadget.data("applicationName"),title:self._getTitle(),icon:icon};return pageInfo.options.$displayStyle==="$link"&&self.article&&self.article.$linkArticle&&(attrs["data-link-article"]=self.id),self._addPicker(attrs),$.smResolve()}throw new Error("Unexpected vignette page")}).fail(function(e){self._displayError(locale.text("error.page.loading"),e)})},_initPageLoader:function(){var self=this;self._pageLoader=new PageLoader({waitWheelStop:function(){self.waitWheelStop()},waitWheelStart:function(){self.waitWheelStart()},getRootElmt:function(){return self._$$content},getCurrentPage:function(){return self._currentPage},setCurrentPage:function(page){self._currentPage=page,page!=null?notifications.subscribe(self,["sm.field.focus"]):notifications.unsubscribe(self,["sm.field.focus"])},historyPush:function(state){self._stateStack.push(state)},succeeded:function(dstPage,pageToClose,parentNotifInfo,back,loadOptions){globals.isAutoUITestMode()&&globals.getUnitTestMgr().notifPageLoaded("after",dstPage);if(!self.controller)return;self.hasBtnsBar()&&self.refreshBtnsBar(),parentNotifInfo&&parentNotifInfo.notifId&&(dstPage.id===parentNotifInfo.parentId?notifications.notifyController(parentNotifInfo.notifId,self._currentPage,parentNotifInfo.notifData,parentNotifInfo.controlId):modal.error("Child page notification warning","Parent page is not the current page")),log&&log("vignette loaded"+self.id),dstPage.state.options.$displayStyle==="$full"&&(self._initActionDashboard(dstPage),setTimeout(function(){var info=$.extend(!0,{},loadOptions);info.updateLayout=back===!0||loadOptions&&loadOptions.updateLayout,dstPage.onMainPageResize(info)}))},loadingError:function(deferred,state,e){self._displayError(locale.text("error.page.loading"),e),deferred.resolve(null,e)},getSavedCtxVignette:function(){if(self._reloadSavedCtx!=null){var ctx=self._reloadSavedCtx;return self._reloadSavedCtx=null,ctx}if(!self.controller)return;return self.controller.getSavedCtxVignette(self)}})},_initActionDashboard:function(dstPage){if(!dstPage)return;if(dstPage.isChild)this._updateActionControl();else{this._typeAction=dstPage.isMultiSelectionEnabled()?globals.ACTMULTISEL:dstPage.hasFooterHeaderActions(!0)?"footerHeader":null;if(this._typeAction==null)return;this.openLinkInVignette=this._typeAction==="footerHeader",this._actionsEnabled=_actionTitleMgr.iconActionAdd(this),notifications[this._actionsEnabled?"subscribe":"unsubscribe"](this,["sm.vignette.pinned","sm.multisel.stopped"])}},notifMultiselStopped:function(pageId){if(this._currentPage==null||this._currentPage.id!==pageId)return;if(!this._actionsEnabled||!this._actionControl)return;this._doTogglePinVignette(!1)},_actTogglePinVignette:function(){this._actionControl||notifications.publish("synch.sm.vignette.pinned",this.id),this._doTogglePinVignette()},notifVignettePinned:function(skipThisId){if(this.id==skipThisId)return;if(!this._actionsEnabled||!this._actionControl)return;this._doTogglePinVignette(!1)},notifFieldFocus:function(control){if(!control||!control.controller.isVignette)return;var enable=control.controller.getParentVignette()===this;if(enable&&this._actionControl||!enable&&!this._actionControl)return;this._doTogglePinVignette()},_doTogglePinVignette:function(show){if(!this._actionsEnabled||!this._currentPage)return;var status=show===!1?"off":show===!0?"on":this._actionControl?"off":"on",controlToggle,type=this.getTypeActionControl();if(status==="on")this._actionControl=this._getActionControl(!0),type=this.getTypeActionControl(),controlToggle=this._actionControl;else{if(!this._actionControl)return;controlToggle=this._actionControl,type=controlToggle.getPageControlType(),this._actionControl=null}this.controller.toggleHeaderFooter(type,controlToggle,status==="on"),_actionTitleMgr.iconActionToggleStatus(this,status)},_updateActionControl:function(){if(!this._actionsEnabled)return;this._actionControl=this._getActionControl(!0),this._doTogglePinVignette(!0)},_getActionControl:function(create){this._actionControlsCache||(this._actionControlsCache={});var ctrl=this._actionControlsCache[this._currentPage.id];return!ctrl&&create&&(ctrl=ctrlFactory.createActionControl(this.getTypeActionControl(),this,{multiSelectionOnly:this._typeAction===globals.ACTMULTISEL,buildOpts:$.extend(!0,{},(this.controller.buildOpts||{}).toolBars)}),this._actionControlsCache[this._currentPage.id]=ctrl),ctrl},destroyActionControls:function(){if(!this._actionControlsCache||!this.controller)return;this._actionControl&&this.controller.toggleHeaderFooter(this._actionControl.getPageControlType(),null);var ctrl;for(var p in this._actionControlsCache)ctrl=this._actionControlsCache[p],ctrl&&(this.controller.removeControl(ctrl),ctrl.destroy());this._actionControl=this._actionControlsCache=null},getTypeActionControl:function(){return globals.getSiteLayout().getDeviceType()==="smartphone"?"header":"footer"},_loadRepresentation:function(pageOptions,loadOptions){var name=this._gadget.getPageName();return pageOptions=$.extend({},pageOptions),pageOptions.openLinkInVignette=this._openLinkInsideVignette(name),pageOptions.$displayStyle=this.displayStyle,pageOptions.gadget=this._gadget.getJSON(),pageOptions.vignetteArticle=this.article.$article,pageOptions.vignetteAuthPageProps={},utils.authCopyPageProperties(this.article,pageOptions.vignetteAuthPageProps),this._loadPage("openNewPage",name,pageOptions,loadOptions)},_displayError:function(msg,detail){this._error={message:msg,detail:detail},this.$$elmt?(this._$$content.hide(),this.$$elmt.addClass("s-m-error"),this.$$elmt.prepend(_getHtml("vignetteError",{text:locale.text("vignette.load.failed")})),this.refreshBtnsBar()):globals.getModal().actionResult(locale.text("error.page.loading"),this._error,!0)},_removeError:function(){this.$$elmt.children('a[data-action="vignetteError"]').remove(),this.$$elmt.removeClass("s-m-error"),this._$$content.show(),this._error=null},buildHtml:function($$parent,controllerDao,buildOptions){if(!(this._stateStack.length>0)){var css=["s-m-vignette"];$$parent.removeAttr("data-empty-tile"),Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions,css),this.hammer&&this.hammer.destroy(),this.hammer=new Hammer(this.$$elmt.get(0)),this.hammer.get("press").set({time:500}),this.hammer.on("press",Hammer.bindFn(this._onPress,this)),this.$$elmt.html(_getHtml("main",{})),this._$$content=this.$$elmt.children("section"),this.$$footer=this.$$elmt.children("footer"),this._$$waitBckg=this.$$elmt.children(".s-m-waiting.bckg")}},_onPress:function(evt){var self=this;if(self.controller.state.isWelcomePage)return notifications.publish("sm.vignette.pressed",self.id),!0;dashboardWelcomeUtils.isPinnedTile(self.$bind).then(function(pinned){if(pinned){globals.getModal().info("",locale.text("pin.tile.pinned"));return}globals.getModal().simpleConfirmPromise({message:locale.text("pin.tile.add.confirm")}).then(function(result){if(result.action!=="yes")return;var localization=self._getLocalization(self.parent.article);dashboardWelcomeUtils.addPinnedTile(self.parent.article,self.prototype,localization).then(function(){var notify={severityClass:"success",title:"",body:locale.text("pin.tile.add.ok"),onlyWebapp:!0};globals.getModal().notify(notify)})})})},_getLocalization:function(article){var pageLocalization=$.extend(!0,{},this.controller.article.$localization),localization={};return article.$title&&Object.keys(pageLocalization).forEach(function(lang){Object.keys(pageLocalization[lang]).forEach(function(key){"{@"+key+"}"===article.$title&&(localization[lang]=localization[lang]||{},localization[lang][key]=pageLocalization[lang][key])})}),localization},load:function(vignetteId,pageOptions,loadOptions){var self=this;self.vignetteId=vignetteId,pageOptions=pageOptions||{};var deferred=$.Deferred(),_finalize=function(page,error){deferred.resolve(page,error),page!=null&&notifications.notifyController("sm.scroller.update",self.controller,self.id,page,error)},_fail=function(e){self._displayError(locale.text("error.page.loading"),e),_finalize()};try{if(this._gadget){pageOptions.resize===!0&&this.clearContent();switch(this._gadget.data("$type")){case"$representation":case"$stats":case"$request":self._loadRepresentation(pageOptions,loadOptions).then(function(page,error){_finalize(page,error)}).fail(function(e){_fail(e)});break;case"$dashboard":self._loadDashboard(),_finalize();break;case"$application":self._loadApplication(),_finalize();break;case"$external":self._loadExternal(),_finalize();break;case"$gadgetMissing":self._displayError(locale.text("vignette.load.gadget.missing",[this._gadget.data("$uuid")])),_finalize();break;default:self._displayError(locale.text("vignette.load.gadget.unsupported",[this._gadget.data("$type")])),_finalize()}}else self._displayError(locale.text("vignette.load.gadget.invalid",[this._badGadgetReason||"Unknown reason"])),_finalize()}catch(e){_fail(e)}finally{return deferred.promise()}},_getCssIcon:function(sageBaseCss){var icon=this.article&&this.article.$icon||this._gadget.data("icon");return icon&&(icon.smStartsWith("s-m-")?icon=sageBaseCss+" "+icon:icon=fontUtils.getIconByName(icon)),icon||""},_getTitle:function(){return this.article&&this.article.$title?this.getArticleText("$title"):this._gadget.data("$title")},_loadDashboard:function(){this._addPicker({"data-nav":globals.getMetaData().getDashboardPageName(this._gadget.data("dashboardName")),"data-application-name":this._gadget.data("applicationName"),"data-gadget-id":this._gadget.data("$uuid"),"data-sdata-parameters":this._gadget.data("sdataParameters"),title:this._getTitle(),icon:this._getCssIcon("s-m-sage-gadget-icon")})},_loadApplication:function(){this._addPicker({"data-application-name":this._gadget.data("applicationName"),title:this._getTitle(),icon:this._getCssIcon("s-m-sage-app-icon")})},_loadExternal:function(){var self=this,url=this._gadget.data("externalUrl");self._addPicker({"data-external-link":url,title:this._getTitle()});if(self.displayStyle!=="$link"){var iFrame=_getHtml("iframe",{url:url});$(iFrame).appendTo(self._$$content)}},_addPicker:function(context){var linkAttrs={"data-nav-target":"application"},vignetteCtx={};for(var p in context)p.smStartsWith("data-")?linkAttrs[p]=context[p]:vignetteCtx[p]=context[p];$(_getHtml("linkPage",vignetteCtx)).appendTo(this._$$content),(this.parent.$$elmt||this.$$elmt).attr(linkAttrs)},waitWheelStart:function(){var self=this;self._$$wait||(self._$$wait=uiUtils.waitPluginCreate(self.$$elmt.children(".s-m-waiting.wheel"),_waitConfig).wrap('<div class="s-m-wait-root"/>')),uiUtils.waitPluginEnable(this._$$wait),this._$$waitBckg.show()},waitWheelStop:function(){this._$$wait&&uiUtils.waitPluginDisable(this._$$wait),this._$$waitBckg.hide()},refreshBtnsBar:function(){if(this._openLinkInsideVignette()){var show=!1;this.$$icnBack||(this.$$footer.prepend(_getHtml("navbtns")),this.$$icnBack=this.$$footer.children("[data-action=vignetteBack]"),this.$$icnHome=this.$$footer.children("[data-action=vignetteHome]"));var l=this._stateStack.length;this.$$icnBack.toggle(l>1),this.$$icnHome.toggle(l>2&&!this._currentPage.prototype.isLookup()),show=this._stateStack.length>1,this.$$footer.toggle(show),this.$$elmt.toggleClass("footer",show)}},_actVignetteHome:function(){var self=this;if(self._stateStack.length==0)return $.smResolve(this._currentPage);var state=self._stateStack[0];return self._stateStack=[],self._loadPage("home",state).then(function(page,error){return self._updateActionControl(),$.smResolve(page)})},_actVignetteBack:function(){var self=this;return self._stateStack.length<=1?$.smResolve(this._currentPage):(self._stateStack.pop(),self._loadPage("back",self._stateStack[self._stateStack.length-1]).then(function(page,error){return self._updateActionControl(),$.smResolve(page)}))},goBack:function(){return this._actVignetteBack()},goHome:function(){return this._actVignetteHome()},_actVignetteError:function(){var self=this;self._error.detail?modal.error(self._error.message,self._error.detail):modal.error("Vignette load error",self._error)},_actVignetteRefresh:function(){this.refreshPage({})},isOverflow:function(){if(!this._currentPage)return;return this._currentPage.$$elmt.height()-this.$$elmt.height()>0},getScrollViewRect:function(){return uiRect.elmtRect(this._$$content,"inner")},isVignette:function(){return!0},getLinkedPageArticle:function(){return this.article?this.article.$linkArticle:null},isLinkVignette:function(){switch(this._gadget.data("$type")){case"$representation":case"$stats":case"$request":return this.displayStyle==="$link";case"$dashboard":case"$application":case"$external":return!0;default:return!1}},getLayoutSize:function(){return this.parent&&this.parent.article&&this.parent.article.$size||"medium"}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/ctrlBreadCrumbs",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/ctrlBase","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/prototype","syracuse-tablet/html/js/helpers/uiSettings","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/ctrlBase").Klass,globals=require("syracuse-tablet/html/js/helpers/globals"),prototype=require("syracuse-tablet/html/js/helpers/prototype"),uiSettings=require("syracuse-tablet/html/js/helpers/uiSettings"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_templates={items:'		<div class="s-m-items">		{{#each items}}{{{html}}}{{/each}}		</ul>		',item:'<a draggable="false" href="#" data-action="breadcrumb-click" data-control-id="{{ctrlId}}" data-params="{{data}}"><div class="s-m-item"><div class="s-m-text">{{text}}</div>{{#if notLast}}<div class="fa fa-caret-right s-m-icon-small"></div>{{/if}}</div></a>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[name],tmpl=_templates[key]=Handlebars.compile(tmpl)),tmpl(ctx)},_Klass=utils.defineClass(function CtrlBreadCrumbs($type,controller,options){Base.call(this,controller,{$bind:"breadcrumbs"},prototype.create({$type:$type}),options),notifications.subscribe(this,["sm.mainpage.loaded"])},Base,{destroy:function(){Base.prototype.destroy.call(this),this._pageStates=[]},buildHtml:function($$parent,controllerDao,buildOptions){this._height=uiSettings.getProp("breadcrumbs.height"),Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions,[this.typeName]),this.$$elmt.css("height",this._height)},onMainPageResize:function(info,orientation){var deviceType=globals.getSiteLayout().getDeviceType();this.$$elmt.parent().toggle(deviceType==="tablet")},afterRender:function(updateLayout,buildOpts){},applyMetaData:function(metaData,buildOptions){return},getHeight:function(){return this.$$elmt.is(":visible")?this._height:0},refresh:function(){this._buildBreadcrumbs()},notifMainpageLoaded:function(){this._buildBreadcrumbs()},_buildBreadcrumbs:function(){var history=globals.getApplication().history,self=this;if(!self.$$elmt)return;var items=this._getItems(history),crumbs=[];self._pageStates=[],$.each(items,function(idx,state){var uuid=utils.UUID();self._pageStates[uuid]=$.extend(!0,{},state,{stackNum:idx}),crumbs.push({html:_getHtml("item",{text:state.$title,notLast:idx+1<items.length,ctrlId:self.id,data:uuid})})});var html=_getHtml("items",{items:crumbs});this.$$elmt.empty(),this.$$elmt.append(html)},_getItems:function(history){history=history||[],history=history.slice(0),history=history.reverse();var stackToHome=[];return history.some(function(state){return stackToHome.push(state),state.isWelcomePage?!0:!1}),stackToHome},_actBreadcrumbClick:function(uuid){var self=this,state=self._pageStates[uuid];if(!state)return;var num=state.stackNum;if(num<=0)return;globals.getApplication().goBack(function PageFilter(histState){if(num===0)return!0;num--})}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/application/actionManager",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/sdata/sdataDispatcher","syracuse-tablet/html/js/sdata/sdataUtils","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/jsutils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),globals=require("syracuse-tablet/html/js/helpers/globals"),dispatcher=require("syracuse-tablet/html/js/sdata/sdataDispatcher"),sdataUtils=require("syracuse-tablet/html/js/sdata/sdataUtils"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),_parseParameters=function(params){var p=params.split("&"),res={};for(var i=0;i<p.length;i++){var v=p[i].split("=");res[v[0]]=v[1]}return res},_preserveScrolling=function(page,link,pageOpts){if(!page||!link||!pageOpts)return;var val=page.getScrollValue();!isNaN(val)&&val!==0&&(pageOpts["auto-scroll"]=page.getScrollValue()*1.2)},_displayMessage=function(title,data,cb){data===null&&(data="");if(jsutils.isError(data))data=data.message;else if(typeof data!="string"){var diags=sdataUtils.scanDiagnoses(data);if(diags.length>0){var msg=[];diags.forEach(function(d){msg.push(d.$message)}),data=msg.join("\n")}else data=JSON.stringify(data,null,2)}globals.getModal().info(title,data,cb)},_Klass=utils.defineClass(function(controller,toolbar,options){this.options=options||{},this.toolbar=toolbar,this.controller=controller,this._initLinks(),this.uuid=utils.UUID()},null,{destroy:function(){this.options=null,this.controller=null},_initLinks:function(){var self=this,deviceType=globals.getSiteLayout().getDeviceType(),beginLinks=[];self.options.addMultiSelection&&!self.controller.isEditMode()&&beginLinks.push(self.getMultiSelectionLink());if(self.options.multiSelectionOnly!=1){var toolBarLinks=self.controller.getToolbarLinks(self.toolbar)||[],endLinks=[];self.controller.isEditMode()&&(self.options.addCancelEditAction&&endLinks.push(self.getCancelEditAction(self.options.addCancelEditAction)),self.options.addShowTemplatesAction&&!self.controller.isChild&&endLinks.push(self.getEditTemplatesAction(self.options.addCancelEditAction)))}self.links=jsutils.concatArrays(beginLinks,toolBarLinks,endLinks),globals.isAutoUITestMode()&&self.links.forEach(function(l){l.x3LinkName=l.name})},addLink:function(lnk){return!lnk||this.findLink(lnk.$uuid)!=null?lnk:(this.links||(this.links=[]),this.links.push(lnk),globals.isAutoUITestMode()&&(lnk.x3LinkName=lnk.name),lnk)},getCancelEditAction:function(actionName){return{name:"$canceledit",icon:fontUtils.getIconByName("$cancelEdit"),isClientAction:!0,action:actionName||"cancelEdit",title:locale.text("action.cancelEdit"),$uuid:utils.UUID()}},getEditTemplatesAction:function(actionName){return{name:"$showtemplates",icon:fontUtils.getIconByName("$showtemplates"),isClientAction:!0,action:actionName||"showtemplates",title:locale.text("action.showtemplates"),$uuid:utils.UUID()}},getMultiSelectionLink:function(){return{name:"$multiSelection",icon:fontUtils.getIconByName("$multiSelection"),isClientAction:!0,action:globals.ACTMULTISEL,css:["s-m-ismultisel"],title:locale.text("action.multiselect"),$uuid:utils.UUID()}},getLinks:function(exclude,filter){exclude&&typeof exclude=="string"&&(exclude=[exclude]);if(this.links==null||exclude==null||exclude.length==0||!filter)return this.links;filter=filter||[];var lnks=[];return this.links.forEach(function(l){exclude.some(function($uuid){return l.$uuid===$uuid})||filter.some(function(props){var found=!0;return Object.keys(props).forEach(function(key){if(l[key]&&props[key]!=l[key]||l[key]==null&&props[key]!=0)found=!1}),found})&&lnks.push(l)}),lnks},hasLinks:function(){return this.links&&this.links.length>0},findLink:function(uuid){if(!this.links)return null;var lnk;return this.links.some(function(l){if(l.$uuid===uuid)return lnk=l,!0}),lnk},triggerLink:function(uuid,page){var deferred=$.Deferred();try{var self=this,link=this.findLink(uuid);if(!link)return;if(link.$confirm){globals.getModal().simpleConfirm(link.$confirm,function(confirmed){confirmed==="yes"&&self._execLink(deferred,page,link)});return}self._execLink(deferred,page,link)}catch(e){deferred.reject(e)}finally{return deferred.promise()}},_execLink:function(deferred,page,link){var self=this;if(link.isClientAction){if(!page)throw new Error("triggerLink - Page is expected");self._notifyAndResolve(page,deferred,!0,link);return}if(link.$isAction||link.$method==="DELETE"){self._doLinkAction(deferred,page,link);return}if(link.page){var pageOpts={"sdata-url":link.sDataUrl,"sdata-method":link.$method,"sdata-parameter":link.parameters};pageOpts["sdata-parameter"]&&(pageOpts.sdataParameters=_parseParameters(pageOpts["sdata-parameter"])),page&&page.state.name.replace(".$details",".$edit")===link.page&&_preserveScrolling(page,link,pageOpts);if(self.options.noRedirection===!0)self._notifyAndResolve(page,deferred,!0,link,{gotoPage:{name:link.page,options:pageOpts}},self.options);else{var opts={callerhandlesErrors:!0};globals.getApplication().changePage(link.page,pageOpts,opts).then(function(){deferred.resolve()}).fail(function(e){if(e){var diags;e.responseJSON&&e.responseJSON.$diagnoses?diags=e.responseJSON.$diagnoses:e.$diagnoses&&(diags=e.$diagnoses);if(diags&&diags.length>0)e={$diagnoses:diags};else{var msg="";e.status!=null&&(msg+="httpStatus="+e.status),e.message!=null&&(msg+=" - "+e.message),e={$diagnoses:[{$severity:"error",$message:msg}]}}}globals.getModal().actionResult(locale.text("error.page.loading"),e),deferred.resolve()})}return}if(link.externalUrl){var url=utils.parseExpression(link.externalUrl,page.dao,page.prototype);window.open(url);return}_displayMessage("Unexpected link type",link,function(){self._notifyAndResolve(page,deferred,!1,link,null,self.options)})},_doLinkAction:function(deferred,page,link){var self=this,_end=function(success,data){self._notifyAndResolve(page,deferred,success,link,data)};try{if(page&&page.validateBeforeActionLink&&page.validateBeforeActionLink(link)===!1){deferred.resolve(!1);return}if(link.sDataUrl){page&&page.waitWheelStart();var payload=page.dao.getActionPayload(link,page.isEditMode());dispatcher.dispatch({$url:link.sDataUrl,$method:link.$method||"GET"},payload).then(function(result){page&&page.waitWheelStop(),result||(result={isSuccess:!0,status:200,responseJSON:{}});if(result&&result.status===500){result.responseJSON=globals.getModal().createGeneralErrorDiag(result),_end(!1,result);return}if(result&&!result.isSuccess){_end(!1,result);return}_end(!0,result)}).fail(function(e){page&&page.waitWheelStop(),_displayMessage("Action '"+link.title+"' failed",e,function(){deferred.reject(e)})})}else _end(!0)}catch(e){_displayMessage("Action '"+link.title+"' javascript exception",e,function(){deferred.reject(e)})}},_notifyAndResolve:function(page,deferred,success,link,result){if(page){var opts=$.extend({},this.options);opts.fromActionMgrUUID=this.uuid,notifications.notifyController("sm.action.link",page,success,link,result,opts)}deferred&&deferred.resolve(success,link,result,this.options)}});exports.Klass=_Klass,exports.create=function(controller,toolbar,opts){return new _Klass(controller,toolbar,opts||{})}}),define("syracuse-tablet/html/js/sdata/sdataSyncUtils",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/prototype"],function(require,exports,module){function _resolvePrototype(opts,node,urlList){node.uuid=utils.UUID(),node.$children=[];if(opts.level>=opts.maxLevels)return $.smResolve(node);var $links;if(opts.prototype.getFacet()==="query"){var $resources=opts.prototype.property("$resources");$resources&&$resources.$item&&$resources.$item.$links&&$resources.$item.$links.$details&&($links={$details:$resources.$item.$links.$details})}else{if(opts.prototype.getFacet()!=="details")return $.smResolve(node);$links=opts.prototype.data("$links"),$links&&$links.$edit&&(node.$canEdit=!0)}return $links?$.smForEachPromise(Object.keys($links),function(name){var link=$links[name];if(_isCacheableLink(link,name,urlList)){var repr=_getRepresentation(link);if(repr){urlList.push(link.$url);var child={$name:name,$title:utils.parseExpression(link.$title,null,opts.prototype,!0),$link:link,$representation:repr};return node.$children.push(child),_processNode(child,opts,urlList)}}return $.smResolve(node)}).then(function(){if(node.$canEdit){node.$editLink=$links.$edit;var repr=_getRepresentation(node.$editLink),protoName=_getProtoName({$representation:repr},{prototype:opts.prototype}),meta=globals.getMetaData();return meta.getPrototype(protoName).then(function(proto){node.$editPrototype=prototypeModule.create(proto)})}}).then(function(){return node}):$.smResolve(node)}function _isCacheableLink(link,name,urlList){if(urlList.indexOf(link.$url)>-1)return!1;if(name.indexOf("$")===0&&name!=="$details")return!1;if(link.$method!=="GET")return!1;if(link.$url.indexOf("/$services/")>-1)return!1;if(link.$url.indexOf("representation=")<0)return!1;var repr=_getRepresentation(link);return!repr||repr.indexOf(".$details")<0&&repr.indexOf(".$query")<0?!1:!0}function _getRepresentation(link){var repr=/[\?\&]representation=(\S+?)(&|$)/.exec(link.$url);return repr&&repr[1]}function _processNode(node,opts,urlList){var meta=globals.getMetaData(),protoName=_getProtoName(node,opts);return meta.getPrototype(protoName).then(function(proto){if(proto)return proto=prototypeModule.create(proto),node.$prototype=proto,node.$name==="$details"&&(node.$title=proto.data("$title"),node.$isDetails=!0),_resolvePrototype({prototype:proto,level:opts.level+1,maxLevels:opts.maxLevels},node,urlList)})}function _getProtoName(node,opts){var endpoint=opts.prototype.data("$baseUrl");return endpoint=endpoint.split("/"),endpoint=endpoint.slice(endpoint.length-3,endpoint.length).join("."),endpoint+"."+node.$representation}var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),prototypeModule=require("syracuse-tablet/html/js/helpers/prototype"),_syncMaxLevels=6;exports.getSyncStructure=function(prototype){var node={$title:prototype.data("$title")},urlList=[];return _resolvePrototype({prototype:prototype,level:1,maxLevels:_syncMaxLevels},node,urlList)}}),define("syracuse-tablet/html/js/ui/modals/modalSyncOffline",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalDialog","syracuse-tablet/html/js/sdata/sdataDispatcher","syracuse-tablet/html/js/sdata/sdataSyncUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalDialog=require("syracuse-tablet/html/js/ui/modals/modalDialog"),sdataDispatcher=require("syracuse-tablet/html/js/sdata/sdataDispatcher"),sdataSyncUtils=require("syracuse-tablet/html/js/sdata/sdataSyncUtils"),_templateAll={header:'			<buttons class="pull-right"> 				<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 			</buttons> 			<div class="modal-title">{{title}}</div> 			',content:' 			<div class="s-m-scroll-wrapper s-m-scroll-wrapper-v">			<div class="s-m-scroll-element"> 				<div class="form-group" id="s-m-sync-no-data-id"> 					<div class="panel s-m-panel-diag-error"><div class="panel-heading">{{label_errors}}</div><ul></ul></div> 					<center>{{label_no_data}}</center>				</div> 				<div class="form-group" id="s-m-sync-actions-id"> 					<center> 						<button type="button" class="btn btn-default s-m-modal-btn-sync" data-action="modal-sync">{{label_sync}}</button> 						<button type="button" class="btn btn-default s-m-modal-btn-sync-stop hidden" data-action="modal-sync-stop">{{label_sync_stop}}<div class="s-m-sync-total"><span class="label label-success ok"></span><span class="label label-danger error"></span></div></button> 					</center> 				</div> 				<div class="form-group" id="s-m-sync-tree-id"> 					<label>{{label_tree}}</label> 					<div id="s-m-sync-tree-id"></div> 				</div> 			</div> 			</div>',footer:""},_Klass=utils.defineClass(function ModalSyncOffline(syncRootData){var self=this;modalDialog.ModalBase.call(self),self.syncRootData=syncRootData},modalDialog.ModalBase,{_getTemplates:function(){var self=this;return{std:_templateAll}},getDisplayFlags:function(){var self=this,displayFlags=self.displayFlags||{};return self.deviceType==="tablet"?displayFlags.modalClass="sync-offline half_right":displayFlags.modalClass="sync-offline full",displayFlags},_getDataContext:function(){var self=this,data={title:locale.text("modal.sync.title"),label_tree:locale.text("modal.sync.header.tree"),label_sync:locale.text("modal.sync.label_sync"),label_sync_stop:locale.text("modal.sync.label_sync_stop"),label_no_data:locale.text("modal.sync.nodata"),label_errors:locale.text("modal.sync.errors")};return data},_onShow:function(){var self=this;modalDialog.ModalBase.prototype._onShow.call(self),sdataSyncUtils.getSyncStructure(self.syncRootData.pageProto).then(function(tree){self.syncTreeRoot=tree,self.syncTreeRoot?self._buildStructHtml(tree):self._noData()}).fail(function(e){self._noData(e)})},_noData:function(e){var self=this;$("#s-m-sync-no-data-id").show(),$("#s-m-sync-actions-id").hide(),$("#s-m-sync-tree-id").hide();var $$ul=$("#s-m-sync-no-data-id ul");$$ul.empty(),e=e&&e.$diagnoses;if(e&&e.length){$("#s-m-sync-no-data-id .panel").show();var i;for(i=0;i<e.length;i++){var msg=e[i]&&e[i].$message;if(msg){var $$li=$("<li>");$$li.text(msg),$$ul.append($$li)}}}else $("#s-m-sync-no-data-id .panel").hide()},_buildStructHtml:function(node){var self=this;$("#s-m-sync-no-data-id").hide(),$("#s-m-sync-actions-id").show(),$("#s-m-sync-tree-id").show();var $$sync=$("#s-m-sync-tree-id"),$$ul=$("<ul>");self._addNode($$ul,node,0),$$sync.append($$ul)},_addNode:function($$parent,node,level){var self=this,cls=level>0?"collapsed":"expanded";cls+=level<1?" selected":"";var $$li=$('				<li class="s-m-sync-tree-item '+cls+'" data-params="'+node.uuid+'"> 					<div class="s-m-tree-icon-expand" data-action="tree-click-expand" data-params="'+node.uuid+'"></div> 					<div class="s-m-tree-label" data-action="tree-click-select" data-params="'+node.uuid+'"></div> 					<div class="s-m-sync-count hidden"><div>"				</li>');$("div.s-m-tree-label",$$li).text(node.$title),$$parent.append($$li);if(node.$children.length>0){var $$ul=$("<ul>");if(node.$isDetails!==!0){var child=node.$children[0];child&&child.$children&&child.$children.length>0&&($$li.append($$ul),child.$children.forEach(function(child){self._addNode($$ul,child)}))}else node.$children&&node.$children.length>0&&($$li.append($$ul),node.$children.forEach(function(child){self._addNode($$ul,child)}))}if($("ul",$$li).length<1){var $$expand=$(">.s-m-tree-icon-expand",$$li);$$expand.removeClass("s-m-tree-icon-expand"),$$expand.addClass("s-m-tree-icon-leaf"),$$expand.attr("data-action",null)}},_onAction:function(action,param){var self=this;return action==="tree-click-expand"?self._onTreeClickExpand(param):action==="tree-click-select"?self._onTreeClickSelect(param):action==="modal-sync"?self._syncData():action==="modal-sync-stop"&&(self.stopSync=!0),!1},_onValidate:function(){},_onCancel:function(){},_getResult:function(){return"done"},_onTreeClickExpand:function(param){var self=this,$$li=$('li[data-params="'+param+'"]');$$li.hasClass("expanded")?($$li.removeClass("expanded"),$$li.addClass("collapsed")):($$li.addClass("expanded"),$$li.removeClass("collapsed"))},_onTreeClickSelect:function(param){var self=this,$$li=$('li[data-params="'+param+'"]');$$li.hasClass("selected")?($$li=$$li.add("li",$$li),$$li.removeClass("selected")):($$li=$$li.add("li",$$li),$$li.addClass("selected"))},_syncData:function(){var self=this;self.stopSync=!1;var $$li=$('li[data-params="'+self.syncTreeRoot.uuid+'"]');$('button[data-action="modal-sync"]',self.$$elmt).addClass("hidden"),$('button[data-action="modal-sync-stop"]',self.$$elmt).removeClass("hidden"),self.syncCount=0,self.errorCount=0,self._updateErrorCount(),$.smForEachPromise(self.syncRootData.rowsData,function(row,idx,cnt){return self.stopSync?$.smResolve():(self._updateSyncCount($$li,idx,cnt),self._syncNodeData(self.syncTreeRoot,row.rowData.data))}).always(function(e){$('button[data-action="modal-sync"]',self.$$elmt).removeClass("hidden"),$('button[data-action="modal-sync-stop"]',self.$$elmt).addClass("hidden")})},_updateSyncCount:function($$li,idx,cnt){var self=this,$$state=$(">div.s-m-sync-count",$$li);$$state.removeClass("hidden"),$$state.text(idx+1+" / "+cnt);var $$states=$("li>div.s-m-sync-count",$$li);$$states.addClass("hidden")},_updateErrorCount:function(){var self=this,$$total=$('button[data-action="modal-sync-stop"]>.s-m-sync-total',self.$$elmt),$$ok=$(">.ok",$$total),$$error=$(">.error",$$total);$$ok.text(self.syncCount),$$error.text(self.errorCount)},_syncNodeData:function(node,parentData){var self=this,$$li;if(self.stopSync)return $.smResolve();if(node.$isDetails!==!0){$$li=$('li[data-params="'+node.uuid+'"]');if($$li.length<1)return $.smResolve();if(!$$li.hasClass("selected"))return $.smResolve();node.$$listItem=$$li}node.$$listItem.addClass("sync-progress");var nodeData;return node.$link?nodeData=self._readNodeData(node,parentData):nodeData=$.smResolve(parentData),nodeData.then(function(nodeData){var dataItems=nodeData&&nodeData.$resources;return!dataItems&&nodeData&&(dataItems=[nodeData]),dataItems?$.smForEachPromise(dataItems,function(dataItem,idx,cnt){return self.stopSync?$.smResolve():(nodeData.$resources&&self._updateSyncCount($$li,idx,cnt),$.smForEachPromise(node.$children,function(child){return self.stopSync?$.smResolve():(child.$$listItem=$$li,self._syncNodeData(child,dataItem))}).then(function(){node.$$listItem.addClass("sync-progress")}))}):$.smResolve(null)}).then(function(){node.$$listItem.removeClass("sync-progress")})},_readNodeData:function(node,parentData){var self=this,deferred=$.Deferred(),linkUrl=utils.parseExpression(node.$link.$url,parentData,node.$prototype);return linkUrl+="&nocache=true",sdataDispatcher.dispatch({$url:linkUrl,$method:"GET"}).then(function(data){return node.$editLink?self._readEditNodeData(node,data).then(function(){return self.syncCount++,self._updateErrorCount(),deferred.resolve(data),data}):(self.syncCount++,self._updateErrorCount(),deferred.resolve(data),data)}).fail(function(){self.errorCount++,self._updateErrorCount(),deferred.resolve(null)}),deferred.promise()},_readEditNodeData:function(node,parentData){var self=this,deferred=$.Deferred(),linkUrl=utils.parseExpression(node.$editLink.$url,parentData,node.$editPrototype);return linkUrl+="&nocache=true",sdataDispatcher.dispatch({$url:linkUrl,$method:"GET"}).then(function(data){return deferred.resolve(data),data}).fail(function(){deferred.resolve(null)}),deferred.promise()}});exports.Modal=_Klass}),define("syracuse-tablet/html/js/application/multiSelectionMgr",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/sdata/sdataUtils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/sdata/sdataDispatcher","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/modals/modalSyncOffline"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),sdataUtils=require("syracuse-tablet/html/js/sdata/sdataUtils"),globals=require("syracuse-tablet/html/js/helpers/globals"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),dispatcher=require("syracuse-tablet/html/js/sdata/sdataDispatcher"),locale=require("syracuse-tablet/html/js/helpers/locale"),modalSyncOffline=require("syracuse-tablet/html/js/ui/modals/modalSyncOffline"),_actionMenuId="multiSelMenuActions",_selectedClass="s-m-multi-selected",_templates={buttonLinks:'		{{#each links}}			<a draggable="false"  href="#" class="s-m-link {{css}}" data-action="multiSelectionAction" data-params="{{$uuid}}" data-control-id="{{../ctrlId}}">				<i class="{{icon}}"/>				<span>{{{title}}}</>			</a>		{{/each}}',menuActions:'		<div id="{{id}}" class="btn-group s-m-link s-m-ismultisel">			<div class="{{dropDirection}}">				<button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-expanded="false">					<span class="badge"></span><span class="title">{{title}}</span><span class="caret"></span>				</button>				<ul class="dropdown-menu dropdown-menu-{{dropPosition}}" role="menu">					{{#each links}}						<li><a  {{#if style}}style="{{style}}"{{/if}} draggable="false"  data-action="multiSelectionAction" data-params="{{params}}" data-control-id="{{../ctrlId}}" href="#">{{title}}</a></li>					{{/each}}				</ul>			</div>		</div>',menuLinks:'		<div  class="btn-group s-m-ismultisel s-m-link">			<div class="{{dropDirection}}">				<button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-expanded="false">				{{title}}<span class="caret"></span>				</button>				<ul class="dropdown-menu dropdown-menu-{{dropPosition}}" role="menu">					{{#each links}}						<li>							<a draggable="false"  href="#" class="s-m-link {{css}}" data-action="multiSelectionAction" data-params="{{$uuid}}" data-control-id="{{../ctrlId}}">								{{title}}							</a>						</li>					{{/each}}				</ul>			</div>		</div>',processMenu:'		<a draggable="false"  href="#" class="s-m-link s-m-ismultisel" data-action="multiSelectionAction" data-params="$exitrun" data-control-id="{{ctrlId}}">			<i class="{{icon}}"/>		</a>'},_actionsList=["download","unselectall","selectall","invert","hideunselected","showunselected"],_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[name],tmpl=_templates[key]=Handlebars.compile(tmpl)),tmpl||alert(locale.text("multiselect.gethtml.alert",name)),tmpl(ctx)},_Klass=utils.defineClass(function(controller,cssToToggle){this.controller=controller,this.cssToToggle=cssToToggle},null,{destroy:function(){this.disable(),this.controller=null,this._$$ownerParent=null,this._ctrlOwner=null},getLinks:function(){return this._multiSelLinks?this._multiSelLinks:this._multiSelLinks=this.controller.getMultiSelectionLinks()||[]},isEnabled:function(){return this._$$ownerParent!=null},disable:function(){this.isEnabled()&&this._stopMultiSel(this._getArray())},_getArray:function(){var array=this.controller.getControlByBind("$resources");if(!array)throw new Error(locale.text("multiselect.getArray.error"));return array},toggle:function(ctrlOwner,$$parent,dropDirection,dropPosition){this._ctrlOwner=ctrlOwner;var array=this._getArray();return this._$$ownerParent?this._stopMultiSel(array):this._startMultiSel($$parent,array,dropDirection,dropPosition),this._$$ownerParent!=null},callbackArray:function(ctrlArray,params,$target){if(params=="$selectmultisel"){this._toggleSelectStatus(ctrlArray,$target.closest(".s-m-record"));return}if(params=="$showdiagnoses"){this._showDiagnoses($target);return}if(params=="$exitrun"){this._processExit(ctrlArray);return}if(params=="$stopmultisel"){this._stopMultiSel(ctrlArray);return}if(params=="$download"){this._startDownloadAction(ctrlArray);return}if(params=="$unselectall"||params=="$reset"){this._toggleUnselected(ctrlArray,!0),this._toggleSelectStatus(ctrlArray,this._$$Selected(ctrlArray),!1),params=="$reset"&&this._processExit(ctrlArray);return}if(params=="$selectall"){this._toggleUnselected(ctrlArray,!0),this._toggleSelectStatus(ctrlArray,this._$$Unselected(ctrlArray),!0),this._updateUI(ctrlArray,ctrlArray.getNbRecords());return}if(params=="$invert"){var unSelected=this._$$Unselected(ctrlArray),selected=this._$$Selected(ctrlArray);this._toggleSelectStatus(ctrlArray,unSelected,!0),this._toggleSelectStatus(ctrlArray,selected,!1);return}if(params==="$hideunselected"||params==="$showunselected"){this._toggleUnselected(ctrlArray,params==="$showunselected"),this._$$action("$hideunselected").toggle(params==="$showunselected"),this._$$action("$showunselected").toggle(params==="$hideunselected"),this._updateUI(ctrlArray,null);return}if(this.nbSelected>0){var self=this;setTimeout(function(){self._processAll(ctrlArray,params)})}},_toggleSelectStatus:function(ctrlArray,elmtList,select){var selected=elmtList.toggleClass(_selectedClass,select).hasClass(_selectedClass);if(ctrlArray.$display==="card"){var $$card=elmtList.find(".s-m-card");selected?$$card.append('<span class="badge checked fa fa-check">&nbsp;</span>'):$$card.find(".badge.checked").remove()}this._updateUI(ctrlArray,this._$$Selected(ctrlArray).length)},_toggleOwnerActions:function(show){var selector="a:not(.s-m-ismultisel)";this.cssToToggle&&(selector+=", "+this.cssToToggle),this._$$ownerParent.closest(".s-m-control").find(selector).toggle(show)},_startMultiSel:function($$parent,array,dropDirection,dropPosition){this._$$ownerParent=$$parent,this._$$ownerAction().addClass("enabled"),array.multiSelSetMgr(this),$$parent.append(this._$$linksMenuHtml(array,dropDirection)),$$parent.append(this._$$actionMenuHtml(array,dropDirection,dropPosition)),this._toggleOwnerActions(!1),array.selectLastSelectedRow(null),array.toggleCardStatusColor(!0);var self=this;setTimeout(function(){self._updateUI(array,0)})},_stopMultiSel:function(array){if(!this._$$ownerParent)return;this._processExit(array),array.multiSelSetMgr(null),this._toggleSelectStatus(array,this._$$Selected(array),!1),this._$$ownerParent.find('.s-m-ismultisel.s-m-link:not([data-action="'+globals.ACTMULTISEL+'"])').remove(),this._$$menu(_actionMenuId).remove(),this._$$ownerAction().removeClass("enabled"),array.toggleCardStatusColor(!1),this._toggleOwnerActions(!0),this._resizeArray(array),this._$$ownerParent.find('.s-m-ismultisel[data-action="'+globals.ACTMULTISEL+'"]').hide(),notifications.publish("sm.multisel.stopped",this.controller.id),this._ctrlOwner&&this._ctrlOwner.refresh(),this._$$ownerParent=null,this._ctrlOwner=null},_$$linksMenuHtml:function(array,dropDirection){var self=this,links=this.getLinks(),menuLinks=[],footerHeaderLinks=[],settings;links.forEach(function(l){settings=self.controller.actionGetSettings(l.name),settings.options==null||settings.options.footerHeader!==!0?menuLinks.push(l):footerHeaderLinks.push(l)});var html=[];return menuLinks.length>0&&html.push(_getHtml("menuLinks",{links:menuLinks,ctrlId:array.id,title:locale.text("actions"),dropDirection:dropDirection||"dropdown",dropPosition:"right"})),footerHeaderLinks.length>0&&html.push(_getHtml("buttonLinks",{links:footerHeaderLinks,ctrlId:array.id})),html.join("")},_$$actionMenuHtml:function(array,dropDirection,dropPosition){var links=[];return _actionsList.forEach(function(id){links.push({title:locale.text("multiselect.action."+id),params:"$"+id,style:"display:none"})}),_getHtml("menuActions",{id:_actionMenuId,links:links,ctrlId:array.id,title:locale.text("multiselect.selected"),dropDirection:dropDirection||"dropdown",dropPosition:dropPosition||"right"})},_resizeArray:function(array){array.onResize({scrollOnly:!0})},_getSelectedData:function(array){var selected=this._$$Selected(array),data=[];return selected.each(function(idx,record){var $$record=$(record);$$record.attr("data-disabled","true");var rowId=$$record.attr("data-params"),rowdata=array.getRowById(rowId);rowdata&&data.push({rowData:rowdata.row,rowId:rowId,$$record:$$record,idx:idx,status:"init"})}),data},_processStart:function(array,uuid){var deferred=$.Deferred();try{array.waitWheelStart(),this._toggleUnselected(array,!1),this._$$ownerParent.find(".s-m-ismultisel").hide(),this._resizeArray(array),this._$$ownerParent.prepend(_getHtml("processMenu",{title:"Exit",ctrlId:array.id,icon:fontUtils.getIconByName("$cancelMultiSel")}));var data=this._getSelectedData(array),link=null,self=this;this.getLinks().some(function(l){if(l.$uuid===uuid)return link=l,!0}),deferred.resolve(link,data)}catch(e){deferred.reject(e)}finally{return deferred.promise()}},_processAll:function(array,uuid){var self=this,_data;self._processStart(array,uuid).then(function(link,data){_data=data;var deferred=$.Deferred(),_run=function(idx){idx>=data.length?deferred.resolve(link,data):self._processOne(array,link,data[idx],idx).then(function(ok){_run(idx+1)})};return _run(0),deferred.promise()}).then(function(link,data){self._processEnd(data,array)}).fail(function(e){globals.getModal().error(locale.text("multiselect.processAll.fail"),e,function(){self._processEnd(_data,array)})})},_toggleUnselected:function(array,show){this._$$Unselected(array).toggle(show),array.$display=="card"&&array.$$elmt.find("tr").each(function(){var e=$(this);e.toggle(show?show:e.find("td").length!=e.find("td.s-m-record:not(:visible)").length)})},_processEnd:function(data,array){var res={ok:0,ko:0,init:0};data.forEach(function(d){res[d.status]++}),this._$$ownerParent.prepend('<span class="s-m-multiselmsg">'+res.ok+" successes - "+res.ko+" failures</span>"),this._resizeArray(array),array.waitWheelStop()},_processExit:function(array){if(!this._$$ownerParent)return;this._toggleUnselected(array,!0),this._toggleSelectStatus(array,this._$$Selected(array),!1),this._$$All(array).show().removeClass("error success").removeAttr("data-disabled"),this._$$ownerParent.find('[data-params="$exitrun"], .s-m-multiselmsg').remove(),this._$$ownerParent.find(".s-m-ismultisel").show(),array.$$value.find(".s-m-multisel-diag").smRemoveData("diagnoses").remove(),this._resizeArray(array)},_processOne:function(array,link,data,idx){var self=this,deferred=$.Deferred(),_end=function(success,result){try{var diagsMsg=[],diagsErr=[];if($.isPlainObject(result)){var diags=sdataUtils.scanDiagnoses(result);diags&&diags.forEach(function(d){d.$severity==="error"?diagsErr.push(d):diagsMsg.push(d)})}success=success&&diagsErr.length==0,success?data.$diagnoses=diagsMsg:jsutils.isError(result)?data.$diagnoses=[{$message:result.message,$stackTrace:result.stack}]:data.$diagnoses=diagsErr}catch(e){success=!1,data.$diagnoses=[{$message:e.message,$stackTrace:e.stack}]}finally{data.status=success?"ok":"ko",data.$$record.addClass(success?"success":"error"),self._addDiagnoses(array,data),deferred.resolve(success)}};try{if(link.$url){var sdataUrl;if(data&&data.rowData){var urlTmp=data.rowData.parseExpression(link.$url);link.$parameters&&$.each(link.$parameters,function(paramName,paramValue){if(paramValue.indexOf("{")>-1){var pv2=encodeURIComponent(paramValue),finalValue=encodeURIComponent(data.rowData.parseExpression(paramValue));urlTmp=urlTmp.replace(pv2,finalValue)}}),sdataUrl=urlTmp}else sdataUrl=data&&data.rowData?data.rowData.parseExpression(link.$url):link.sDataUrl;var payload=data&&data.rowData?data.rowData.getActionPayload(link,self.controller.isEditMode()):null;dispatcher.dispatch({$url:sdataUrl,$method:link.$method||"GET"},payload).then(function(data){_end(!0,data)}).fail(function(e){_end(!1,e)})}else _end(!0)}catch(e){_end(!1,e)}finally{return deferred.promise()}},_addDiagnoses:function(array,data){var $$root=null,colSpan,$$diag,isTable=array.getMode()==="table";isTable?colSpan=data.$$record.children("td").length:($$root=$('<section data-action="multiSelectionAction" data-params="$showdiagnoses"/>').addClass("s-m-multisel-diag").prependTo(data.$$record),$$root.width(data.$$record.width()),$$root.smData("diagnoses",data.$diagnoses)),data.$diagnoses.forEach(function(d,idx){$$diag=$('<div data-idx="'+idx+'" class="alert alert-'+(d.$severity==="error"?"danger":"success")+'" role="alert">'+d.$message+"</div>"),isTable&&($$root=$('<tr  data-action="multiSelectionAction"  data-params="$showdiagnoses"><td colspan="'+colSpan+'"/></tr>').addClass("s-m-multisel-diag"),$$root.smData("diagnoses",data.$diagnoses),data.$$record.after($$root),$$root=$$root.children()[0]),$$diag.appendTo($$root)})},_showDiagnoses:function($$elmt){$$elmt=$$elmt.closest(".s-m-multisel-diag");var diags=$$elmt.smData("diagnoses");if(diags==null||diags.length==0)return;globals.getModal().error("",{$diagnoses:diags})},_$$ownerAction:function(){return this._$$ownerParent.find('[data-action="'+globals.ACTMULTISEL+'"]')},_$$Unselected:function(array){return array.$$value.find(".s-m-record:not(."+_selectedClass+")")},_$$Selected:function(array){return array.$$value.find(".s-m-record."+_selectedClass)},_$$All:function(array){return array.$$value.find(".s-m-record")},_$$action:function(id){return this._$$ownerParent.find('[data-params="'+id+'"]')},_$$menu:function(id){return this._$$ownerParent.find("#"+id)},_updateUI:function(array,nb){if(!this._$$ownerParent)return;if(nb!=null){this.nbSelected=Math.max(0,nb);var $$e=this._$$menu(_actionMenuId);$$e.find(".badge").text(this.nbSelected),$$e.find(".title").text(locale.text(this.nbSelected>1?"multiselect.selected.plural":"multiselect.selected"))}var noSel=this.nbSelected==0,allSel=this.nbSelected===array.getNbRecords();this._$$ownerParent.find('.s-m-ismultisel.s-m-link:not([data-action="'+globals.ACTMULTISEL+'"])').toggleClass("disabled",noSel),noSel||allSel?(this._$$action("$hideunselected").hide(),this._$$action("$showunselected").hide()):this.nbSelected>0&&!this._$$action("$showunselected").is(":visible")&&this._$$action("$hideunselected").show(),this._$$action("$unselectall").toggle(this.nbSelected>0),this._$$action("$selectall").toggle(!0),this._$$action("$invert").toggle(this.nbSelected>0),this._$$action("$download").toggle(this.nbSelected>0)},_startDownloadAction:function(ctrlArray){var self=this,data=self._getSelectedData(ctrlArray),pageProto=ctrlArray.prototype;while(pageProto.parent)pageProto=pageProto.parent;var syncRootData={pageProto:pageProto,rowsData:[]};data.forEach(function(rowData){syncRootData.rowsData.push(rowData)});var modal=new modalSyncOffline.Modal(syncRootData);modal.show().then(function(result){result==="done"})}});exports.create=function(controller,cssToToggle){return controller.isMultiSelectionEnabled()?new _Klass(controller,cssToToggle):null}}),define("syracuse-tablet/html/js/controls/ctrlHelpers",["require","exports","module","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var notifications=require("syracuse-tablet/html/js/helpers/notifications"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_toggleAttr=function($$e,attr,toggle){if(!$$e)return;return $$e.toggleClass("disabled",toggle),$$e.is("["+attr+"]")?toggle===!0?$$e:$$e.removeAttr(attr):toggle===!1?$$e.removeAttr(attr):$$e.attr(attr,"")},_notifDraftsChanged=function(ctrl,count){if(!ctrl||!ctrl.$$elmt)return;var $$e=ctrl.$$elmt.find('[data-nav="pageDrafts"]');_toggleAttr($$e,"data-disabled",count<=0),$$e=$$e.find(".isLabel");var $b=$$e.find("span.badge");$b.length===0&&($b=$('<span class="badge"/>').appendTo($$e)),$b.text(count)},_notifDaoDirty=function(ctrl,isDirty,uuid){if(!ctrl||!ctrl.$$elmt||!ctrl._saveLinkId)return;var actController=ctrl.getActionController();if(!actController.isEditMode()||actController.dao.data.$uuid!=uuid)return;var $$e=ctrl.$$elmt.find('[data-params="'+ctrl._saveLinkId+'"]');$$e&&$$e.length>0&&$$e.toggleClass("disabled",isDirty!==!0)},_notifEditTemplatesChanged=function(ctrl,count){if(!ctrl||!ctrl.$$elmt||!ctrl._showtemplatesId)return;var actController=ctrl.getActionController();if(!actController.isEditMode())return;var $$e=ctrl.$$elmt.find('[data-params="'+ctrl._showtemplatesId+'"]');$$e&&$$e.length>0&&($$e.is(".disabled")&&$$e.removeClass("disabled"),$$e=$$e.children("i"),$$e.removeClass(fontUtils.getIconByName(count===0?"$showtemplates":"$showtemplatesEmpty")),$$e.addClass(fontUtils.getIconByName(count===0?"$showtemplatesEmpty":"$showtemplates")))},_checkLinkSubscriptions=function(control,link){var actController=control.getActionController();if(!actController||!actController.isEditMode())return;if(link.name==="$save"){control._saveLinkId=link.$uuid,link.$isDisabled=!0,notifications.subscribe(control,["sm.dao.dirty"]);return}if(link.name==="$showtemplates"){control._showtemplatesId=link.$uuid,link.$isDisabled=!0,notifications.subscribe(control,["sm.edit.templates.changed"]);return}},_checkLinkInitStatus=function(ctrl){var actController=ctrl?ctrl.getActionController():null;if(!actController||!actController.getLinksInitStatus||!actController.isEditMode())return;actController.getLinksInitStatus().then(function(data){if(!data)return;data.dirtyDao!=null&&_notifDaoDirty(ctrl,data.dirtyDao.isDirty,data.dirtyDao.$uuid),data.editTemplates!==null&&_notifEditTemplatesChanged(ctrl,data.editTemplates.count)})};exports.notifEditTemplatesChanged=_notifEditTemplatesChanged,exports.checkLinkSubscriptions=_checkLinkSubscriptions,exports.checkLinkInitStatus=_checkLinkInitStatus,exports.notifDaoDirty=_notifDaoDirty,exports.notifDraftsChanged=_notifDraftsChanged,exports.toggleAttr=_toggleAttr}),define("syracuse-tablet/html/js/controls/page/ctrlHeaderBase",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/uiSettings","syracuse-tablet/html/js/controls/ctrlBase","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/application/eventListener","syracuse-tablet/html/js/helpers/prototype","syracuse-tablet/html/js/application/actionManager","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/application/multiSelectionMgr","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/native/native","syracuse-tablet/html/js/helpers/formatApi","syracuse-tablet/html/js/controls/ctrlHelpers","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),uiSettings=require("syracuse-tablet/html/js/helpers/uiSettings"),Base=require("syracuse-tablet/html/js/controls/ctrlBase").Klass,globals=require("syracuse-tablet/html/js/helpers/globals"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),locale=require("syracuse-tablet/html/js/helpers/locale"),eventListener=require("syracuse-tablet/html/js/application/eventListener"),prototype=require("syracuse-tablet/html/js/helpers/prototype"),actionManager=require("syracuse-tablet/html/js/application/actionManager"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),multiSelectionMgr=require("syracuse-tablet/html/js/application/multiSelectionMgr"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),native=require("syracuse-tablet/html/js/helpers/native/native"),formatApi=require("syracuse-tablet/html/js/helpers/formatApi"),ctrlHelpers=require("syracuse-tablet/html/js/controls/ctrlHelpers"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_userPanelId=globals.PANELUSERSMARTPHONE,_actionPanelId=globals.PANELACTIONSREGULAR,_templates={main:'		<div class="s-m-header {{deviceType}}">			{{{contentHtml}}}		</div>',freshness:'		<div class="s-m-freshness s-m-fresh" data-action="showFreshness" data-control-id="{{ctrlId}}">			<i class="'+fontUtils.pageIcon("freshness")+'"></i>		</div>',tablet:{main:'			<div class="s-m-header-nav">				{{#if showBack}} 					<a href="#" draggable="false" data-action="historyBack">						<i class="'+fontUtils.pageIcon("back")+'" />						</a>				{{/if}} 			</div>			<div class="s-m-header-labels">				{{#if showBrand}}					<div class="s-m-header-brand">						<span class="s-m-brand">{{labelBrand}}</span>						<span class="s-m-product">{{labelProduct}}</span>					</div>				{{/if}}				<span class="s-m-header-label">{{headerLabel}}</span>			</div>			<div class="s-m-header-links">				{{{userContent}}}			</div>',userInfo:'			<div>				<span class="s-m-nav-text username">{{username}}</span>				<span class="s-m-nav-text userrole">{{userrole}}</span>			</div>			<span class="usericon '+fontUtils.pageIcon("switchContext")+'" />			',infoOnly:"			<div>{{{userInfo}}}</div>",dropDown:'			<div class="s-m-header-user-info dropdown">				<a href="#" draggable="false" data-toggle="dropdown" role="button" id="{{dropdownId}}" aria-haspopup="true" aria-expanded="false">					{{{userInfo}}}				</a>				{{{dropDownMenu}}}			</div>',dropDownMenu:'			<ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="{{dropdownId}}">				{{#each links}}					{{#if dividerTop}} 						<li role="presentation" class="divider"></li>					{{/if}} 					<li>						<a href="#" {{#if data-nav}}data-nav="{{data-nav}}"{{else}}data-action="linkClicked"{{/if}}draggable="false" data-params="{{data-params}}" data-control-id="{{ctrlId}}" class="list-group-item {{css}}">							<span class="{{icon}}" />							<span class="isLabel">{{label}}</span>						</a>					</li>					{{#if dividerBottom}} 						<li role="presentation" class="divider"></li>					{{/if}} 				{{/each}}			</ul>'},smartphone:{main:'			<div class="s-m-header-nav">				{{#if showUserpanel}}					<a href="#" draggable="false" data-action="headerAction" data-params="{{panelId}}" data-control-id="{{ctrlId}}">						<span class="'+fontUtils.pageIcon("bars")+'" />					</a>				{{/if}}			</div>			<div class="s-m-header-labels">				{{{labelContent}}}			</div>			<div class="s-m-header-links">				{{{linksContent}}}			</div>',brandDom:'			<div class="s-m-header-brand">				<span class="s-m-brand">{{labelBrand}}</span>				<span class="s-m-product">{{labelProduct}}</span>			</div>',labelDom:'			<span class="s-m-header-label">{{label}}</span>',actionLink:'			<a href="#" draggable="false" class="s-m-link {{css}}{{#if $isDisabled}} disabled{{/if}}"				{{#if $isHidden}}style="display:none"{{/if}}				data-action="{{#if action}}{{action}}{{else}}headerLink{{/if}}"				data-params="{{$uuid}}"				{{#if x3LinkName}} data-s-ut-link-x3name="{{x3LinkName}}"{{/if}}				data-control-id="{{ctrlId}}">				<i class="{{icon}}"></i>			</a>',actionPanelToggle:'			<a href="#" class="s-m-link" 			data-action="headerAction" 			draggable="false" 			data-params="{{panelId}}" 			data-s-ut-x3-link-name="$$openRightPanel" 			data-control-id="{{ctrlId}}">				<i class="'+fontUtils.pageIcon("sidePanelR")+'" />				<span>{{{title}}}</span>			</a>'}},_linksCtx={showAuthoring:{dividerBottom:!0,items:[{"data-params":"designPage",icon:"designPage",label:"header.links.designPage"}]},showPageMailto:{items:[{"data-params":"pageMailto",icon:"mailto",label:"header.links.page.mailto"}]},showPageShare:{items:[{"data-params":"pageShare",icon:"nativeShare",label:"header.links.page.share"}]},showUserMenuLinks:{items:[{"data-params":"switchContext",icon:"switchContext",label:"header.links.switchContext"},{"data-params":"settings",icon:"settings",label:"header.links.settings"},{"data-params":"about",icon:"about",label:"header.sm.links.about"}]},showDevelopment:{dividerTop:!0,items:[{"data-params":"developmentPage",icon:"developmentPage",label:"header.links.development"}]},showDrafts:{dividerTop:!0,items:[{"data-nav":"pageDrafts",icon:"drafts",label:"header.links.page.drafts"}]}},_getHtml=function(type,name,ctx){type=type||"";var key=type+name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=type.length==0?_templates[name]:_templates[type][name],tmpl=_templates[key]=Handlebars.compile(tmpl)),tmpl(ctx)},_hideSoftwareBackButton,_mustHideSoftwareBackButton=function(){return _hideSoftwareBackButton==null&&(_hideSoftwareBackButton=native.hasCapability("hardwareBackButton")==1),_hideSoftwareBackButton},_Klass=utils.defineClass(function CtrlHeaderBase($type,controller,options){Base.call(this,controller,{$bind:"header"},prototype.create({$type:$type}),options),options.freshness!==!1&&notifications.subscribe(this,["sm.data.freshness.change"])},Base,{destroy:function(){this.resetSmartphonePanels(),this._actionManager&&(this._actionManager.destroy(),this._actionManager=null),this._multiSelManager&&(this._multiSelManager.destroy(),this._multiSelManager=null),this._dataFreshness=null,this._$$freshness=null,Base.prototype.destroy.call(this)},refresh:function(controllerDao,options){Base.prototype.refresh.call(this,controllerDao,options),this._updateWidth()},getPageControlType:function(){return"header"},resetSmartphonePanels:function(){this.controller&&(this.controller.panelDetach("right"),this.controller.panelDetach("left")),this._smphUserpanel&&(this._smphUserpanel.destroy(),this._smphUserpanel=null),this._smphPageactionpanel&&(this._smphPageactionpanel.destroy(),this._smphPageactionpanel=null)},buildHtml:function($$parent,controllerDao,buildOptions){buildOptions=buildOptions||{},Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions,[this.typeName]),this.headerOptions=this.getHeaderOptions(buildOptions),(buildOptions.refresh===!0||this.headerOptions.forceRefresh)&&this._build()},getHeaderOptions:function(buildOptions){var opts=$.extend({},buildOptions.footer,buildOptions.toolBars);return opts.showDevelopment=globals.isDevelopmentModeAllowed(),opts.showAuthoring=globals.isAuthoringModeAllowed()&&opts.showAuthoring===!0,opts},applyMetaData:function(metaData,buildOptions){return},onMainPageResize:function(info,orientation){this.$$elmt.parent().css({width:info.contentWidth+"px"}),this._build(),this._updateHeaderStyle(this._deviceType)},_updateHeaderStyle:function(deviceType){return;var self,$$header,$$links,$$nav,$$label,offset},getHeight:function(){return this.$$elmt.is(":visible")?this._height:0},_updateWidth:function(){if(!this.$$header||this.destroyed)return;var freshVisible=this._$$freshness&&this._$$freshness.is(":visible");freshVisible&&this._$$freshness.hide();var $$label,width,$$nav,maxWidth=this.$$elmt.width(),fullWidth=0;this.$$header.children().each(function(){$$nav=$(this),$$nav.is(".s-m-header-labels")?$$label=$$nav:(width=0,$$nav.children().each(function(idx){width+=$(this).outerWidth()+1}),fullWidth+width>maxWidth&&(width=Math.max(maxWidth-fullWidth,0)),fullWidth+=width,$$nav.width(width))}),$$label.width("auto"),freshVisible&&this._$$freshness.show()},_build:function(){var deviceType=globals.getSiteLayout().getDeviceType();if(this._deviceType!=null&&this._deviceType===deviceType){this._updateWidth();return}this._multiSelManager&&(this._multiSelManager.destroy(),this._multiSelManager=null),this._actionManager&&(this._actionManager.destroy(),this._actionManager=null),this._deviceType=deviceType,this._height=uiSettings.getProp("header.height"),this.$$elmt.css({height:this._height+"px"});var $$parent=this.$$elmt.parent();$$parent.css({left:"0px",height:this._height+"px"});var opts=this.headerOptions,labels=locale.getProductLabels();opts.labelBrand=labels.brand,opts.labelProduct=labels.product;var actionController=this.getActionController(),displayController=this.controller,contentHtml;deviceType==="smartphone"?(contentHtml=this._smartPhoneHtml(opts,displayController,actionController),notifications.unsubscribe(this,"sm.drafts.changed")):(contentHtml=this._tabletHtml(opts,displayController,actionController),notifications.subscribe(this,"sm.drafts.changed")),this.$$header&&this.$$header.remove(),this.$$header=$(_getHtml(null,"main",{contentHtml:contentHtml,deviceType:deviceType})),native&&native.isTestMode()&&native.appendHeaderTestCmds(this.$$header.find(".s-m-header-nav")),this.$$header.appendTo(this.$$elmt);var freshWasVisible=!1;this._$$freshness&&(freshWasVisible=this._$$freshness.is(":visible"),this._$$freshness.remove()),this.options.freshness!==!1&&(this._$$freshness=$(_getHtml(null,"freshness",{ctrlId:this.id})).appendTo(this.$$elmt).toggle(freshWasVisible)),ctrlHelpers.checkLinkInitStatus(this),this.headerOptions.showDashboardList&&notifications.subscribe(this,["sm.view.change"]),this._updateWidth()},getActionController:function(){return this.controller},_tabletHtml:function(){var self=this,lknCtx={dropdownId:utils.UUID(),links:[]},opts=self.headerOptions,linksCpt=0;for(var p in _linksCtx)if(opts[p]===!0){var l=_linksCtx[p];l.items.forEach(function(x,idx){x=$.extend({},x),x.label=locale.text(x.label),x.ctrlId=self.id,x.icon=fontUtils.pageIcon(x.icon),idx===0&&lknCtx.links.length>1&&(x.dividerTop=l.dividerTop),x.dividerBottom=l.dividerBottom,lknCtx.links.push(x)})}var _mainCtx={showBack:_mustHideSoftwareBackButton()===!1?opts.showHome||opts.showBack===!0:!1,showHome:opts.showHome,showBrand:self.controller.state.isWelcomePage,labelBrand:opts.labelBrand||"Sage",labelProduct:opts.labelProduct||"ERP X3",headerLabel:self.headerOptions.title||self.getProtoTitle(),ctrlId:self.id},htmlUserInfo=_getHtml("tablet","userInfo",{username:globals.getUserName(),userrole:globals.getUserRole()});return lknCtx.links.length===0?_mainCtx.userContent=_getHtml("tablet","infoOnly",{userInfo:htmlUserInfo}):(_mainCtx.userContent=_getHtml("tablet","dropDown",{userInfo:htmlUserInfo,dropDownMenu:_getHtml("tablet","dropDownMenu",lknCtx)}),self.$$elmt.css({overflow:"visible"})),_getHtml("tablet","main",_mainCtx)},_smartPhoneHtml:function(opts,displayController,actionController){var self=this;this.resetSmartphonePanels(),opts.showUserpanel&&(self._smphUserpanel=actionController.panelCreate(_userPanelId,opts));var showActions=opts.showActions!==!1;showActions&&opts.showActionpanel&&(self._smphPageactionpanel=actionController.panelCreate(_actionPanelId,opts));var labelContent="",linksContent="";labelContent=self.headerOptions.title||self._getLabelContent(opts);var hasPanelLinks=self._smphPageactionpanel&&self._smphPageactionpanel.hasLinks();linksContent=self._getSmartphoneLinksContent(displayController,actionController,hasPanelLinks,showActions);var ctx={labelContent:labelContent,linksContent:linksContent,panelId:_userPanelId,ctrlId:self.id,showUserpanel:opts.showUserpanel===!0};return _getHtml("smartphone","main",ctx)},_getLabelContent:function(opts){function getContent(isLabelDom,labelVal,opts){return isLabelDom?_getHtml("smartphone","labelDom",{label:labelVal}):_getHtml("smartphone","brandDom",{labelBrand:opts.labelBrand||"Sage",labelProduct:opts.labelProduct||"ERP X3"})}var self=this,labelContent;return this.controller.state.isWelcomePage?labelContent=getContent(!1,null,opts):(labelContent=getContent(!0,self.getProtoTitle()),labelContent||(labelContent=getContent(!1,null,opts))),labelContent},getProtoTitle:function(){return this.controller.prototype.data("$title")},_getSmartphoneLinksContent:function(displayController,actionController,hasPanelLinks,showActions){var self=this,linksContent="";self._multiSelManager=multiSelectionMgr.create(actionController,".s-m-header-nav, .s-m-header-labels, a:not(.s-m-ismultisel)"),notifications.subscribe(self,["sm.panel.multiselection.toggle"]),self._actionManager=actionManager.create(actionController,"header",{addCancelEditAction:"headerLink",addShowTemplatesAction:"headerLink",addMultiSelection:self._multiSelManager&&!self.headerOptions.multiSelectionOnly&&actionController.isMultiSelectionEnabled(),multiSelectionOnly:self.headerOptions.multiSelectionOnly});var linksArr=self._actionManager.getLinks(),cc=[];return hasPanelLinks&&cc.push(_getHtml("smartphone","actionPanelToggle",{panelId:_actionPanelId,ctrlId:self.id})),showActions&&linksArr&&linksArr.length>0&&linksArr.forEach(function(ll,idx){cc.push(_getHtml("smartphone","actionLink",$.extend(ll,{ctrlId:self.id,$isHidden:ll.action===globals.ACTMULTISEL||ll.$isHidden===!0}))),ctrlHelpers.checkLinkSubscriptions(self,ll)}),linksContent=cc.join(""),linksContent},_actHeaderLink:function(uuid){this._actionManager.triggerLink(uuid,this.getActionController()).then(function(success,link,data,options){}).fail(function(e){jsutils.isError(e)&&globals.getModal().error("Header action error (smartphone)",e)})},_actHeaderAction:function(id){var panel=id===_actionPanelId?this._smphPageactionpanel:this._smphUserpanel,side=id===_actionPanelId?"right":"left";this.controller.panelAttach(side,panel,"toggle")},_actLinkClicked:function(actionName){eventListener.triggerAction(this.$$elmt,actionName)},notifPanelMultiselectionToggle:function(uuid,$$target){this.toggleMultiSelection()},toggleMultiSelection:function(){this._actMultiSelection()},_actMultiSelection:function(uuid,$$target){var $$hLinks=this.$$elmt.find(".s-m-header-links"),enabled=this._multiSelManager.toggle(this,$$hLinks,"dropdown","left");$$hLinks.width(enabled?"100%":"initial"),this.$$elmt.find(".s-m-header-nav, .s-m-header-labels, a:not(.s-m-ismultisel)").toggle(!enabled),this.$$elmt.find('[data-action="'+globals.ACTMULTISEL+'"]').toggle(enabled),this._updateWidth()},notifToggled:function(shown){if(shown===!1){this._multiSelManager&&this._multiSelManager.disable(),this._updateWidth();return}this._updateWidth()},notifDataFreshnessChange:function(data){this._dataFreshness=this._dataFreshness||{oldest:data.dateTime,recent:0},this._dataFreshness.oldest=Math.min(this._dataFreshness.oldest,data.dateTime),this._dataFreshness.recent=Math.max(this._dataFreshness.recent,data.dateTime);if(!this._$$freshness)return;var diffDays=Math.round(((new Date).getTime()-this._dataFreshness.oldest)/864e5),freshness="verytainted";diffDays<=7&&(freshness="tainted"),diffDays<=1&&(freshness="fresh"),this._dataFreshness.value=freshness,this._$$freshness.removeClass("s-m-fresh s-m-tainted s-m-verytainted"),this._$$freshness.addClass("s-m-"+freshness),this._$$freshness.show()},_actShowFreshness:function(){if(!this._dataFreshness)return;var formatter=formatApi.getFormatter("application/x-datetime"),dateTime=formatter.formatValue(utils.getCurISODateTime(new Date(this._dataFreshness.oldest)),!1),notify={severityClass:this._dataFreshness.value,title:locale.text("page.data.freshness.last")+" : "+dateTime,body:locale.text("page.data.freshness."+this._dataFreshness.value),onlyWebapp:!0};globals.getModal().notify(notify)},detach:function(){this.notifToggled(!1),this.$$elmt&&this.$$elmt.detach()},notifDraftsChanged:function(count){ctrlHelpers.notifDraftsChanged(this,count)},notifDaoDirty:function(isDirty,uuid){ctrlHelpers.notifDaoDirty(this,isDirty,uuid)},notifEditTemplatesChanged:function(fromActionMgrUUID,count){if(!this._actionManager||this._actionManager.uuid!=fromActionMgrUUID)return;ctrlHelpers.notifEditTemplatesChanged(this,count)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/ctrlPageHeader",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/page/ctrlHeaderBase","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/page/ctrlHeaderBase").Klass,locale=require("syracuse-tablet/html/js/helpers/locale"),_Klass=utils.defineClass(function CtrlPageHeader($type,controller,options){Base.call(this,$type,controller,options)},Base,{destroy:function(){Base.prototype.destroy.call(this)},getHeaderOptions:function(buildOptions,device){var stdOpts=Base.prototype.getHeaderOptions.call(this,buildOptions);return stdOpts.showUserpanel=!0,stdOpts.showActionpanel=!0,stdOpts},notifViewChange:function(view){$(".s-m-header-label").text(view.$isPersonal?locale.text("welcome.title.home"):view.$description)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/ctrlFooterBase",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/uiSettings","syracuse-tablet/html/js/controls/ctrlBase","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/application/actionManager","syracuse-tablet/html/js/application/multiSelectionMgr","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/prototype","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/controls/ctrlHelpers"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),uiSettings=require("syracuse-tablet/html/js/helpers/uiSettings"),Base=require("syracuse-tablet/html/js/controls/ctrlBase").Klass,globals=require("syracuse-tablet/html/js/helpers/globals"),actionManager=require("syracuse-tablet/html/js/application/actionManager"),multiSelectionMgr=require("syracuse-tablet/html/js/application/multiSelectionMgr"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),prototype=require("syracuse-tablet/html/js/helpers/prototype"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),locale=require("syracuse-tablet/html/js/helpers/locale"),ctrlHelpers=require("syracuse-tablet/html/js/controls/ctrlHelpers"),_actionPanelId=globals.PANELACTIONSREGULAR,_templates={main:'		<div class="s-m-footer s-m-opened container-fluid {{deviceType}}">			{{{contentHtml}}}		</div>',tablet:{main:'			<div class="s-m-footer-left">				{{#if homeLink}}{{{homeLink}}}{{/if}}				{{#if configLink}}{{{configLink}}}{{/if}}				{{#if templateLink}}{{{templateLink}}}{{/if}}				{{#if mydashboard}}{{{mydashboard}}}{{/if}}				{{#if pinPage}}{{{pinPage}}}{{/if}}			</div>			<div class="s-m-footer-right">				{{#if rightLinks}}{{{rightLinks}}}{{/if}}			</div>		',rightLinks:'			{{#each links}}				<a draggable="false" {{#if $isHidden}}style="display:none"{{/if}} href="#" class="s-m-link {{css}} {{#if $isDisabled}} disabled{{/if}}"						data-action="{{#if action}}{{action}}{{else}}footerLink{{/if}}"						data-params="{{$uuid}}"						data-control-id="{{../ctrlId}}"						{{#if x3LinkName}} data-s-ut-link-x3name="{{x3LinkName}}"{{/if}}>					<i class="{{icon}}"/>					<span>{{{title}}}</>				</a>			{{/each}}		',action:'			<a href="#" class="s-m-link" data-action="{{action}}">				<i class="{{icon}}"/>				<span>{{{title}}}</span>			</a>'},smartphone:{main:""}},_getHtml=function(type,name,ctx){type=type||"";var key=type+name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=type.length==0?_templates[name]:_templates[type][name],tmpl=_templates[key]=Handlebars.compile(tmpl)),tmpl||alert("footer template "+name+" not found"),tmpl(ctx)},_Klass=utils.defineClass(function CtrlFooterBase($type,controller,options){Base.call(this,controller,{$bind:"footer"},prototype.create({$type:$type}),options),this._actionManager=null,this._multiSelManager=null,this._actionPanel=null},Base,{destroy:function(){this._actionManager&&(this._actionManager.destroy(),this._actionManager=null),this._multiSelManager&&(this._multiSelManager.destroy(),this._multiSelManager=null),this.resetActionPanel(),Base.prototype.destroy.call(this),notifications.unsubscribe(this)},getPageControlType:function(){return"footer"},getActionController:function(){return this.controller},resetActionPanel:function(){this._actionPanel&&(this._actionPanel.destroy(),this._actionPanel=null)},buildHtml:function($$parent,controllerDao,buildOptions){buildOptions=buildOptions||{},Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions,[this.typeName]),this.footerOptions=this.getFooterOptions(buildOptions),this._$$parent=this.$$elmt.closest("footer"),(buildOptions.refresh===!0||this.footerOptions.forceRefresh)&&this._build()},getFooterOptions:function(buildOptions){return $.extend({},buildOptions.footer,buildOptions.toolBars)},applyMetaData:function(metaData,buildOptions){return},_actFooterLink:function(uuid){this._actionManager.triggerLink(uuid,this.getActionController()).then(function(success,link,data,options){}).fail(function(e){jsutils.isError(e)&&globals.getModal().error("Footer action error",e)})},_actMultiSelection:function(uuid,$$target){this.toggleMultiSelection()},toggleMultiSelection:function(){this._multiSelManager&&this._multiSelManager.toggle(this,this.$$elmt.find(".s-m-footer-right"),"dropup","right")},_actFooterAction:function(id){id===_actionPanelId&&this.controller.panelAttach("right",this._actionPanel,"toggle")},onMainPageResize:function(info,orientation){var deviceType=globals.getSiteLayout().getDeviceType();this._build(deviceType),this.$$footer?(this._$$parent.css({top:info.contentHeight-this._height+"px",width:info.contentWidth+"px"}),this._$$parent.show()):this.resetActionPanel()},getHeight:function(){return this._height},_build:function(deviceType){deviceType=deviceType||globals.getSiteLayout().getDeviceType();if(this._deviceType!=null&&this._deviceType===deviceType)return;this._deviceType=deviceType,this.$$footer&&(this.$$footer.remove(),this.$$footer=null);if(deviceType==="smartphone"){this.$$elmt.hide();return}this._height=uiSettings.getProp("footer.height",deviceType),this._$$parent.css({left:"0px",height:this._height+"px"});var htmlCtx={},actionController=this.getActionController(),displayController=this.controller;this._multiSelManager||(this._multiSelManager=multiSelectionMgr.create(actionController));var contentHtml;this._actionManager=actionManager.create(actionController,"footer",{addCancelEditAction:"footerLink",addShowTemplatesAction:"footerLink",addMultiSelection:!this.footerOptions.multiSelectionOnly&&actionController.isMultiSelectionEnabled(),multiSelectionOnly:this.footerOptions.multiSelectionOnly}),this._addActionMgrHtmlCtx(htmlCtx,actionController,displayController),this.$$footer=$(_getHtml(null,"main",{contentHtml:_getHtml("tablet","main",htmlCtx),deviceType:deviceType})),this.footerOptions.showDashboardList&&notifications.subscribe(this,["sm.view.change"]),this.$$footer.appendTo(this.$$elmt.show()),ctrlHelpers.checkLinkInitStatus(this)},_addActionMgrHtmlCtx:function(ctx,actionController,displayController){if(!this._actionManager)return;var showActions=this.footerOptions.showActions!==!1,rightLinks;showActions&&this._actionManager.hasLinks()&&(rightLinks=this._actionManager.getLinks()),showActions&&!this._actionPanel&&actionController.state.type==="regular"&&(this._actionPanel=actionController.panelCreate(_actionPanelId)),this._actionPanel&&this._actionPanel.hasLinks()&&(rightLinks||(rightLinks=[]),rightLinks.push({action:"footerAction",icon:fontUtils.pageIcon("sidePanelR"),$uuid:_actionPanelId,title:"&nbsp;",x3LinkName:"$$openRightPanel"}));if(rightLinks){var self=this;rightLinks.forEach(function(rlnk){ctrlHelpers.checkLinkSubscriptions(self,rlnk)}),ctx.rightLinks=_getHtml("tablet","rightLinks",{ctrlId:this.id,links:rightLinks.reverse()})}this.footerOptions.showHome&&(ctx.homeLink=_getHtml("tablet","action",{action:"home",icon:fontUtils.pageIcon("home"),title:locale.text("action.home")})),this.footerOptions.showPageConfig&&(ctx.configLink=_getHtml("tablet","action",{action:"pageConfig",icon:fontUtils.pageIcon("pageConfig"),title:locale.text("action.pageConfig")})),this.footerOptions.showDashboardList&&(ctx.templateLink=_getHtml("tablet","action",{action:"dashboardList",icon:fontUtils.pageIcon("dashboardList"),title:locale.text("action.dashboardList")})),this.footerOptions.showMyDashboard&&(ctx.mydashboard=_getHtml("tablet","action",{action:"myDashboard",icon:fontUtils.pageIcon("mydashboard"),title:locale.text("action.mydashboard")})),this.footerOptions.statusPinPage>0&&(ctx.pinPage=_getHtml("tablet","action",{action:"pinPage",icon:fontUtils.pageIcon("pinPage_"+this.footerOptions.statusPinPage),title:locale.text(this.footerOptions.statusPinPage===1?"action.pin":"action.unpin")}))},notifToggled:function(shown){if(shown===!1){this._multiSelManager&&this._multiSelManager.disable();return}},detach:function(){this.notifToggled(!1),this.$$elmt&&this.$$elmt.detach()},notifDaoDirty:function(isDirty,uuid){ctrlHelpers.notifDaoDirty(this,isDirty,uuid)},notifEditTemplatesChanged:function(fromActionMgrUUID,count){if(!this._actionManager||this._actionManager.uuid!=fromActionMgrUUID)return;ctrlHelpers.notifEditTemplatesChanged(this,count)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/ctrlPageFooter",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/controls/page/ctrlFooterBase","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),Base=require("syracuse-tablet/html/js/controls/page/ctrlFooterBase").Klass,fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),locale=require("syracuse-tablet/html/js/helpers/locale"),_Klass=utils.defineClass(function CtrlPageFooter($type,controller,options){Base.call(this,$type,controller,options),notifications.subscribe(this,["sm.page.pin.state.change"])},Base,{notifPagePinStateChange:function(newState){var $$root=this.$$elmt.find("[data-action=pinPage]"),$$icon=$$root.find("i");$$icon.length>0&&($$icon.attr("class",fontUtils.pageIcon("pinPage_"+newState)),$$root.find("span").text(locale.text(newState===1?"action.pin":"action.unpin")))},notifViewChange:function(view){if(view.$isPersonal){var $$elmt=this.$$elmt.find("[data-action=myDashboard]");$$elmt.remove()}}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/ctrlVignetteFooter",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/page/ctrlFooterBase"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/page/ctrlFooterBase").Klass,_Klass=utils.defineClass(function CtrlVignetteFooter($type,vignette,options){Base.call(this,$type,vignette.controller,options),this._vignette=vignette},Base,{destroy:function(){Base.prototype.destroy.call(this),this._vignette=null},getFooterOptions:function(buildOptions){return{showHome:!1,showPageConfig:!1,showTemplateList:!1,statusPinPage:!1,multiSelectionOnly:this.options.multiSelectionOnly===!0,forceRefresh:!0}},getActionController:function(){return this._vignette?this._vignette.getPage():null},notifToggled:function(shown){Base.prototype.notifToggled.call(this,shown);if(shown!==!0)return;this._multiSelManager&&this.toggleMultiSelection()}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/ctrlVignetteHeader",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/controls/page/ctrlHeaderBase","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/controls/page/ctrlHeaderBase").Klass,notifications=require("syracuse-tablet/html/js/helpers/notifications"),_Klass=utils.defineClass(function CtrlVignetteHeader($type,vignette,options){options=options||{},this._vignette=vignette,options.freshness=this._vignette.getPage()!=null&&this._vignette.getPage().dao!=null,Base.call(this,$type,vignette.controller,options)},Base,{destroy:function(){Base.prototype.destroy.call(this),this._vignette=null},buildHtml:function($$parent,controllerDao,buildOptions){Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions),globals.getStorage().draftOperation("draftNotifyChanged")},getHeaderOptions:function(buildOptions){var opts=$.extend(!0,{},this.options.buildOpts);return opts.forceRefresh=!0,opts.multiSelectionOnly=this.options.multiSelectionOnly===!0,opts.showUserpanel=!0,opts.showDrafts=!0,opts},getActionController:function(){return this._vignette.getPage()},notifToggled:function(shown){Base.prototype.notifToggled.call(this,shown);if(shown!==!0)return;this._multiSelManager&&this.toggleMultiSelection(),this.options.freshness==1&&notifications.publish("sm.data.freshness.change",this._vignette.getPage().dao.dataFreshness())}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/sidePanel",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/controls/ctrlBase","syracuse-tablet/html/js/helpers/prototype","syracuse-tablet/html/js/application/eventListener","syracuse-tablet/html/js/helpers/scroller/scrollerHelpers","syracuse-tablet/html/js/ui/rect"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/controls/ctrlBase").Klass,prototype=require("syracuse-tablet/html/js/helpers/prototype"),eventListener=require("syracuse-tablet/html/js/application/eventListener"),scroller=require("syracuse-tablet/html/js/helpers/scroller/scrollerHelpers"),uiRect=require("syracuse-tablet/html/js/ui/rect"),_Klass=utils.defineClass(function SidePanel(controller,$type,panelId,options){this.panelId=panelId,this.actionManager=null,this.closeBox=options.closeBox===!0,this.overlap=options.overlap!==!1,this.enableGesture=options.enableGesture===!0,Base.call(this,controller,{$bind:this.panelId+"panel"},prototype.create({$type:$type}),options),this._gestureMgr=null},Base,{destroy:function(){this.actionManager&&(this.actionManager.destroy(),this.actionManager=null),this._gestureMgr&&(this._gestureMgr.destroy(),this._gestureMgr=null),this._$$scrollElmt=null,this._$$scrollWrapper=null,this.detach(),Base.prototype.destroy.call(this)},buildHtml:function(side){this.side=side,Base.prototype.buildHtml.call(this,null,this.controller.dao,{},[this.typeName]),this._gestureMgr&&(this._gestureMgr.destroy(),this._gestureMgr=null)},attach:function($$parent,side){this.$$elmt&&this.side!=null&&side!=this.side&&(this.$$elmt.remove(),this.$$elmt=null),this.$$elmt||this.buildHtml(side),this.isAttached()&&(console.log("sidePanel.attach - Unexpected attached $$elmt"),this.detach());if(!$$parent)return;$$parent.append(this.$$elmt)},isAttached:function(side){return this.$$elmt!=null&&this.$$elmt.closest(".s-m-panel").length>0&&this.side==side},detach:function(){if(!this.$$elmt)return;this.$$elmt.detach()},isEnabled:function(){return!0},notifyToggled:function(side,action,visible){if(!visible)return;this._updateGesture()},applyMetaData:function(metaData,buildOptions){return},onClick:function(evt){this.close()},close:function(){eventListener.triggerAction(this.$$elmt,"toggleSidePanel","close,"+this.side)},setActionManager:function(amgr){this.actionManager&&this.actionManager.destroy(),this.actionManager=amgr},_actActionLink:function(uuid){if(!this.actionManager)return;this.actionManager.triggerLink(uuid,this.controller)},hasLinks:function(){throw new Error("Not implemented")},onResize:function(context){this._gestureMgr&&this._updateGesture()},_updateGesture:function(){if(this.enableGesture!==!0)return;if(!this.$$elmt||!this.$$elmt.is(":visible")){this._gestureMgr&&this._gestureMgr.reset();return}if(!this._gestureMgr){this.$$scrollElmt=this.$$elmt.find(".s-m-scroll-elmt");if(this.$$scrollElmt.length===0){globals.isDvlpMode()&&globals.getModal().notify({severityClass:"error",body:"Panel scrolling - Unexpected empty .s-m-scroll-elmt dom element"}),this.enableGesture=!1;return}this.$$scrollWrapper=this.$$elmt.find(".s-m-scroll-wrapper"),this.$$scrollWrapper.length===0&&(this.$$scrollWrapper=this.$$elmt),this._gestureMgr=scroller.newScroller(this.$$scrollElmt,{direction:"v",valMax:0,name:this.$bind,isPageScroller:!1})}this._gestureMgr.reset();var scrollRect=uiRect.elmtRect(this.$$scrollElmt.css({top:"0px"}),"outer"),wrapperRect=uiRect.elmtRect(this.$$scrollWrapper,"outer"),viewRect=wrapperRect.intersectRect(scrollRect);viewRect&&!viewRect.contains(scrollRect)&&this._gestureMgr.init(viewRect,null,null,!0)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/actionPanel",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/page/panels/sidePanel"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/page/panels/sidePanel").Klass,_templates={main:'			<nav class="navbar s-m-side-panel {{side}} navbar-inverse ctrl-evt-click" role="navigation">				<div class="s-m-panel-content s-m-scroll-elmt">					{{#each items}}						{{#if html}}							{{#if title}}								<div class="container-fluid">									<div class="navbar-header">										<span class="navbar-brand" href="#"><span>{{title}}</span></a>									</div>								</div>							{{/if}}							<ul class="nav navbar-nav">								{{{html}}}							</ul>						{{/if}}					{{/each}}				</div>			</nav>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl||alert("template "+name+" not found"),tmpl(ctx)},_Klass=utils.defineClass(function(controller,$type,panelId,options){options=options||{},this.enableTwoColumns=options.enableTwoColumns===!0,options.enableGesture=this.enableTwoColumns!==!0,Base.call(this,controller,$type,panelId,options)},Base,{buildHtml:function(side){Base.prototype.buildHtml.call(this,side),this.$$elmt.addClass(this.typeName);var context={ctrlId:this.id,side:side};this.$$panel&&this.$$panel.remove(),this.$$panel=this.buildPanel(context,side),this.$$panel&&this.$$panel.length&&this.$$elmt.append(this.$$panel),this.$$panelContent=this.$$panel.find(".s-m-panel-content")},buildPanel:function(context,side){return $(_getHtml("main",context))},isEnabled:function(){return!0},notifyToggled:function(side,action,visible){Base.prototype.notifyToggled.call(this,side,action,visible),this.enableTwoColumns&&this._toggleTwoColumns(visible!==!0)},onResize:function(context){Base.prototype.onResize.call(this,context),this.enableTwoColumns&&(context.deviceChanged||context.orientationChanged)&&this._toggleTwoColumns()},_toggleTwoColumns:function(disable){this.$$elmt.parent().removeClass("s-m-two-columns");if(disable!==!0&&this.$$panelContent.height()>this.$$elmt.height()){this.$$elmt.parent().addClass("s-m-two-columns");return}}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/pageActionPanelRegular",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/controls/page/panels/actionPanel","syracuse-tablet/html/js/application/actionManager","syracuse-tablet/html/js/application/multiSelectionMgr","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/controls/page/panels/actionPanel").Klass,actionManager=require("syracuse-tablet/html/js/application/actionManager"),multiSelectionMgr=require("syracuse-tablet/html/js/application/multiSelectionMgr"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_templates={actionLink:'	{{#each links}}		<li class="s-m-link">			<a draggable="false" href="#" class="{{css}}" 				data-action="actionLink" 				data-params="{{$uuid}}" 				{{#if x3LinkName}} data-s-ut-link-x3name="{{x3LinkName}}"{{/if}}				data-control-id="{{../ctrlId}}">				<i style="font-size: large" class="{{icon}}"/>				<span>{{title}}</span>			</a>		</li>	{{/each}}	{{#if links}}		{{#if actions}}			<li class="s-m-separator">&nbsp;</li>		{{/if}}	{{/if}}	{{#each actions}}		<li class="s-m-action">			<a draggable="false" href="#" class="{{css}}" 				data-action="actionLink" 				data-params="{{$uuid}}" 				{{#if x3LinkName}} data-s-ut-link-x3name="{{x3LinkName}}"{{/if}}				data-control-id="{{../ctrlId}}">				<i style="font-size: large" class="{{icon}}"/>				<span>{{title}}</span>			</a>		</li>	{{/each}}'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl(ctx)},_Klass=utils.defineClass(function(controller,$type,panelId,options){Base.call(this,controller,$type,panelId,options)},Base,{destroy:function(){this._multiSelManager&&(this._multiSelManager.destroy(),this._multiSelManager=null),Base.prototype.destroy.call(this)},buildPanel:function(context,side){this.actionManager||this._createActionManager(),context.items=[];if(this._smartPhoneMultiselLink()){this._multiSelManager=multiSelectionMgr.create(this.controller);var info=this.actionManager.getMultiSelectionLink();info.$isAction=!0,info.$uuid="togglemultiselection",context.items.push({title:null,html:_getHtml("actionLink",{ctrlId:this.id,links:[info]})})}var backToList;this._smartPhoneBackToQueryLink()&&(backToList=this.controller.getProtoLinks("$query").$query,this.actionManager.addLink(backToList),context.items.push({title:locale.text("actionpanel.label.links"),html:_getHtml("actionLink",{ctrlId:this.id,links:[backToList]})}));if(this._hasActionLinks()){var exclude=[backToList?backToList.$uuid:null];context.items.push({title:locale.text("actions"),html:_getHtml("actionLink",{ctrlId:this.id,links:this.actionManager.getLinks(exclude,[{$isAction:!1}]),actions:this.actionManager.getLinks(exclude,[{$isAction:!0}])})})}return Base.prototype.buildPanel.call(this,context)},_smartPhoneMultiselLink:function(){return globals.isSmartphone()&&this.controller.isMultiSelectionEnabled()},_smartPhoneBackToQueryLink:function(){return globals.isSmartphone()&&this.controller.prototype.isDetails()&&this.controller.getProtoLinks("$query")!=null},_hasActionLinks:function(){return this._createActionManager().hasLinks()},_actActionLink:function(uuid,$$target,evt){evt&&evt.stopPropagation(),this.close("close");if(uuid==="togglemultiselection"){notifications.publish("sm.panel.multiselection.toggle");return}Base.prototype._actActionLink.call(this,uuid)},_createActionManager:function(){return this.actionManager?this.actionManager:(this.setActionManager(actionManager.create(this.controller,"actionpanel")),this.actionManager)},hasLinks:function(){return this._hasActionLinks()||this._smartPhoneBackToQueryLink()||this._smartPhoneMultiselLink()},_actActionNavigation:function(uuid,$$target,evt){evt&&evt.stopPropagation(),this.actionManager&&this.actionManager.triggerLink(uuid,this.controller)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/sortfilter/tabBase",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/ui/rect","syracuse-tablet/html/js/helpers/scroller/scrollerHelpers"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),uiRect=require("syracuse-tablet/html/js/ui/rect"),scroller=require("syracuse-tablet/html/js/helpers/scroller/scrollerHelpers"),_Klass=utils.defineClass(function(panel,id,options){this.id=id,this.options=options||{},this.panel=panel,this.$$tab=this.panel.$$panel.find('[href="#'+id+'"]'),this.$$tab.on("shown.bs.tab",jsutils.bindFn(this._onTabShown,this)),this.$$content=this.panel.$$panel.find("#"+this.id),this.$$content.on("click","[data-params]",jsutils.bindFn(this.onTabContentClick,this)),this._gestureMgr&&(this._gestureMgr.destroy(),this._gestureMgr=null),this.buildHtml(),this.$$scrollWrapper=this.$$content.find(".s-m-scroll-wrapper"),this.$$scrollElmt=this.$$content.find(".s-m-scroll-elmt"),this.$$scrollElmt.length>0&&this.$$scrollWrapper.length>0&&(this._gestureMgr=scroller.newScroller(this.$$scrollElmt,{direction:"v",valMax:0,isPageScroller:!1}))},null,{destroy:function(){this.panel=null,this.$$tab&&(this.$$tab.unbind(),this.$$tab.remove(),this.$$tab=null),this.$$content&&(this.$$content.unbind(),this.$$content.remove(),this.$$content=null),this._gestureMgr&&(this._gestureMgr.destroy(),this._gestureMgr=null),this.$$scrollElmt=null,this.$$scrollWrapper=null},hide:function(){this.$$tab.parent().hide(),this.$$content.hide()},setWidth:function(w){this.$$tab.parent().width(w)},triggerActivate:function(){var self=this;self.$$tab.parent().hasClass("active")?self._onTabShown():window.setTimeout(function(){self.$$tab.tab("show")})},_onTabShown:function(event){this.panel.notifyActiveTab(this),this.doTabShow(),this.updateGesture()},doTabShow:function(){},buildHtml:function(){},onTabContentClick:function(evt){evt.preventDefault(),evt.stopPropagation(),this.doContentAction(evt,$(evt.target),$(evt.target).attr("data-params"))},doContentAction:function(evt,$$target,params){},doActionApply:function(){return $.smResolve(!0)},onResize:function(context){this._gestureMgr&&this.$$content.is(":visible")&&this.updateGesture(context)},notifyOpenPanel:function(){},notifyClosePanel:function(){},updateGesture:function(context){if(!this._gestureMgr)return;this._gestureMgr.reset();var viewRect=uiRect.elmtRect(this.$$scrollWrapper).intersectRect(uiRect.elmtRect(this.panel.$$elmt));viewRect.height<this.$$scrollElmt.height()&&this._gestureMgr.init(viewRect)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/sortfilter/tabSort",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/page/panels/sortfilter/tabBase","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/page/panels/sortfilter/tabBase").Klass,fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_templates={main:'		<div id="sorttabroot" class="s-m-scroll-wrapper">			<ul class="list-group s-m-scroll-elmt"/>		</div>',items:'		{{#each items}}			<li class="list-group-item" data-params="{{id}}">				<span>{{name}}</span>				<span class="s-m-order '+fontUtils.sortIcon("desc")+'  {{#smCompare sort "desc"}}enabled{{/smCompare}}" data-params="desc"></span>				<span class="s-m-order '+fontUtils.sortIcon("asc")+'  {{#smCompare sort "asc"}}enabled{{/smCompare}}" data-params="asc"></span>			</li>		{{/each}}'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl(ctx)},_Klass=utils.defineClass(function(panel,id,options){options=options||{},options.hidden=options.hidden===!0||panel.getParentArray().sortInfoGet(!1).length===0,Base.call(this,panel,id,options)},Base,{destroy:function(){Base.prototype.destroy.call(this),this.$$list=null},buildHtml:function(){this.$$content.append($(_getHtml("main",{}))),this.$$list=this.$$content.find("ul.list-group")},doActionApply:function(){return this.panel.getParentArray().sortInfoSet($.extend(!0,[],this.sortInfo),!0),this.panel.savePagePrefs().then(function(){return!0})},_buildSortInfo:function(){var status={};this.$$content.find(".s-m-order.enabled").each(function(idx,$$e){$$e=$($$e),status[$$e.parent().attr("data-params")]=$$e.attr("data-params")}),this.sortInfo=this.sortInfo||[],this.sortInfo.forEach(function(i){i.sort=status[i.id]||"none"})},getFavoritesData:function(){return this._buildSortInfo(),$.extend(!0,[],this.sortInfo)},doContentAction:function(evt,$$target,dataParams){$$target.hasClass("enabled")?$$target.removeClass("enabled"):((this.options.singleCriteria===!0?this.$$content:$$target.parent()).find(".s-m-order.enabled").removeClass("enabled"),$$target.addClass("enabled")),this._buildSortInfo()},notifyClosePanel:function(){Base.prototype.notifyClosePanel.call(this),this.$$items&&(this.$$items.remove(),this.$$items=null),this.sortInfo=null},doTabShow:function(){Base.prototype.doTabShow.call(this),this.$$items&&this.$$items.remove(),this.sortInfo=this.sortInfo||$.extend(!0,[],this.panel.getParentArray().sortInfoGet()),this.$$items=$(_getHtml("items",{items:this.sortInfo})),this.$$list.append(this.$$items)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/helpers/formController",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/prototype","syracuse-tablet/html/js/helpers/controller"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),reqProto=require("syracuse-tablet/html/js/helpers/prototype"),Base=require("syracuse-tablet/html/js/helpers/controller").Klass,_createProto=function(protoJson,protoParent,baseUrl){return!protoParent&&baseUrl&&(protoJson.$baseUrl=baseUrl),reqProto.create(protoJson,protoParent)},_createArticle=function(proto){var article={$layoutType:"stack",$items:[]},protoJson=proto.data("$properties");return Object.keys(protoJson).forEach(function(key){protoJson[key].$isExcluded||article.$items.push({$bind:key})}),article},_Klass=utils.defineClass(function(id,proto,article,dao,options){article==null&&(article=_createArticle(proto)),Base.call(this,id,proto,article,options),this.setActivity(this.options.$activity),this.setDao(dao)},Base,{destroy:function(){Base.prototype.destroy.call(this)},render:function($$parent,opts){this.rootLayout==null&&this.buildControlsTree();var opts=$.extend(opts,{afterRender:!0});Base.prototype.render.call(this,$$parent,opts)},makeVisible:function(c){}});exports.createProto=_createProto,exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/sortfilter/tabFilterEdit",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/formController","syracuse-tablet/html/js/helpers/prototype","syracuse-tablet/html/js/application/daoSdata","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/fieldOperators"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),formController=require("syracuse-tablet/html/js/helpers/formController"),prototype=require("syracuse-tablet/html/js/helpers/prototype"),daoSdata=require("syracuse-tablet/html/js/application/daoSdata"),locale=require("syracuse-tablet/html/js/helpers/locale"),fieldOperators=require("syracuse-tablet/html/js/helpers/fieldOperators"),_templates={main:'		<section id="formtabroot">			<div class="s-m-scroll-wrapper">				<div id="formtabform"/>			</div>			<div class="btn-group btn-group-justified" role="group">				<a type="button" class="btn btn-default" data-params="cancelFilterEdit">					<i class="fa fa-times" data-params="cancelFilterEdit"></i>				</a>				<a type="button" class="btn btn-default disabled" data-params="submitFilterEdit">					<i class="fa fa-check" data-params="submitFilterEdit"></i>				</a>			</div>		</section>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl(ctx)},_buildOperatorsEnum=function(operators){var res=[];return $.each(operators,function(idx,op){res.push({$value:op,$title:locale.text("field.operator."+op)})}),res},FormKlass=utils.defineClass(function(proto,dao,filtersMap,$$formParent){formController.Klass.call(this,utils.readableuid("FILTERFORM"),proto,null,dao,{$activity:"edit"}),this.$$formParent=$$formParent,this.filtersMap=filtersMap,this.addEventListener("change",this.onEvtChange),this.addEventListener("blur",this.onEvtBlur)},formController.Klass,{destroy:function(){formController.Klass.prototype.destroy.call(this)},onEvtChange:function(when,ctrl,$$target,event){var self=this;if(when==="before"){var res=!1;switch(ctrl.$bind){case"FIELDS":if($$target.val()==0){this._toggleSave(!1);return}this._toggleSave(!0);var fm=self.filtersMap[$$target.val()-1],operators=fm.operators,$newEnum=_buildOperatorsEnum(operators),newData={$properties:{OPERATORS:{$value:{$enum:$newEnum},$isReadOnly:!1}},OPERATORS:$newEnum[0].$value};self.keyToHide&&(newData.$properties[self.keyToHide]={$isHidden:!0});var keyToShow=fm.isReference?fm.id:"VALUE-"+fm.id;newData.$properties[keyToShow]={$isHidden:!1},self.keyToHide=keyToShow,window.setTimeout(function(){self.applyChange($.extend(!0,{},newData))});break;case"OPERATORS":}return res}},onEvtBlur:function(when,ctrl,$$target,event){},validateForm:function(){var self=this,res=!0;return this.forEachControl(function(id,ctrl){var bind=ctrl.$bind;ctrl.prototype.isReference(bind)&&(bind=ctrl.prototype.getFieldNameForValue(bind)),res=bind==="OPERATORS"||bind!=="FIELDS"||bind!==self.keyToHide?res:ctrl.checkData()?res:!1}),res},applyChange:function(newData){formController.Klass.prototype.applyChange.call(this,newData),this._toggleSave(newData!=null&&!$.isEmptyObject(newData))},render:function($$parent,buildOpts){formController.Klass.prototype.render.call(this,$$parent,buildOpts),this._toggleSave(!1)},_toggleSave:function(enable){$("a[data-params='submitFilterEdit']",this.$$formParent).toggleClass("disabled",!enable)}}),_Klass=utils.defineClass(function(parentTab){this.controller=null,this.$$content=$(_getHtml("main",{})),this.$$formtabform=this.$$content.find("#formtabform"),this.parentTab=parentTab,this.panel=parentTab.panel},null,{destroy:function(){this.controller&&(this.controller.destroy(),this.controller=null),this.$$content=null,this.$$formtabform=null,this.parentTab=null,this.panel=null,this.panel=null},create:function($$container){var self=this;self.$$content.parent().length==0&&$$container.append(self.$$content),self.$$formtabform.empty();var array=self.panel.getParentArray(),protoJson,dataJson,res=self._buildProtoJson();protoJson=res.protoJson,dataJson=res.dataJson;var proto=formController.createProto(protoJson,null,array.prototype.data("$baseUrl")),dao=new daoSdata.Dao($.extend(!0,{},dataJson),proto);self.controller=new FormKlass(proto,dao,self.filtersMap,self.$$content),self.controller.render(self.$$formtabform,{}),self.updateGesture(),self.initData&&window.setTimeout(function(){self.controller.applyChange($.extend(!0,{},self.initData),!0),self.controller.keyToHide=self.initKeyToHide})},updateGesture:function(){this.parentTab.updateGesture()},_getFiltersMap:function(){var self=this;return self.filtersMap=self.filtersMap||self.panel.getParentArray().filterMapGet(),self.filtersMap},_buildProtoJson:function(){var self=this,choiceData={};self.filtersMap=self._getFiltersMap();var protoJson={$properties:{FIELDS:{$title:locale.text("panels.array.filterForm.field"),$type:"application/x-choice",$capabilities:"sort,filter",$value:{$type:"application/x-integer",$enum:[]},$isMandatory:!0},OPERATORS:{$title:locale.text("panels.array.filterForm.operator"),$type:"application/x-choice",$capabilities:"sort,filter",$value:{$type:"application/x-string",$enum:[]},$isReadOnly:!0}},$localization:self.panel.getParentArray().prototype.data("$localization")};for(var ii=0,jj=self.filtersMap.length;ii<jj;ii++){var ff=self.filtersMap[ii],key="VALUE-"+ff.id;protoJson.$properties[key]={$title:locale.text("panels.array.filterForm.value"),$type:ff.prop.$type,$isHidden:!0,$item:ff.prop.$item,$value:ff.prop.$value},ff.isReference&&(protoJson.$properties[ff.prop.$bindValue]={$type:protoJson.$properties[ff.prop.$bindType],$isHidden:!0,$isExcluded:!0}),ff.prop.$type.indexOf("choice")>=0?choiceData[key]=ff.prop.$value.$enum[0].$value:ff.prop.$type.indexOf("boolean")>=0&&(choiceData[key]=!0,protoJson.$properties[key].$format="$switch")}var $fieldEnum=[];$fieldEnum.push({$value:0,$title:locale.text("panels.array.filterForm.fieldDefault")}),$.each(self.filtersMap,function(idx,ff){$fieldEnum.push({$value:idx+1,$title:ff.fieldName})}),protoJson.$properties.FIELDS.$value.$enum=$fieldEnum;var $operatorDefEnum=[],operators=fieldOperators.getOperators();protoJson.$properties.OPERATORS.$value.$enum=_buildOperatorsEnum(operators);var result={protoJson:protoJson,dataJson:choiceData};return result},doActionApply:function(){return this.controller?(this.controller.checkControlsData()?globals.getModal().info("Data are valid"):globals.getModal().error("Data are invalid"),$.smResolve(!1)):$.smResolve(!0)},doContentAction:function(evt,$$target,params){var self=this;switch(params){case"submitFilterEdit":self.onFilterEditSubmit();break;case"cancelFilterEdit":self.onCancelEdit()}},onFilterEditSubmit:function(){var self=this;if(self.controller.validateForm()){self.filtersMap=self._getFiltersMap();var dao=self.controller.dao.data,filterMapIdx=parseInt(dao.FIELDS,10)-1,operator=dao.OPERATORS,value=dao["VALUE-"+self.filtersMap[filterMapIdx].id],prop=self.filtersMap[filterMapIdx].prop,info={filterMapIdx:filterMapIdx,fieldName:self.filtersMap[filterMapIdx].fieldName,operatorLabel:locale.text("field.operator."+operator),value:self._getValue(prop,value),operator:operator,id:self.filtersMap[filterMapIdx].id,prop:prop,originalValue:value,isReference:self.filtersMap[filterMapIdx].isReference};self.filterTab=self.filterTab||self.panel.getTabs().filter,self.filterTab.onFilterUpdate(info,!isNaN(parseInt(self.initIdx,10))&&self.initIdx>=0?self.initIdx:null),self._onTabClose()}},_getValue:function(prop,value){var self=this,vv;return typeof value=="object"?vv=value.$value||value.$description||value.$title:prop.$type.indexOf("choice")>=0?vv=prop.$value.$type.indexOf("integer")>=0?self.controller.prototype.resolveExpression(prop.$value.$enum[parseInt(value-1,10)].$title):value:vv=value,vv},onCancelEdit:function(){var self=this;self._onTabClose(),self.parentTab.toggleList(!0)},setInitData:function(info,initIdx){var self=this;self.filtersMap=self._getFiltersMap();var filterMapIdx=info.filterMapIdx,ff=self.filtersMap[filterMapIdx];self.initData={$properties:{OPERATORS:{$value:{$enum:_buildOperatorsEnum(ff.operators)},$isReadOnly:!1}},FIELDS:filterMapIdx+1,OPERATORS:info.operator},self.initData["VALUE-"+ff.id]=info.originalValue;var bind=ff.isReference?ff.id:"VALUE-"+ff.id;self.initData.$properties[bind]={$isHidden:!1},self.initIdx=initIdx,self.initKeyToHide=bind},_onTabClose:function(){var self=this;self.controller.destroy(),self.controller=null,self.initData=null,self.initIdx=null}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/sortfilter/tabFilter",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/page/panels/sortfilter/tabBase","syracuse-tablet/html/js/controls/page/panels/sortfilter/tabFilterEdit","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/page/panels/sortfilter/tabBase").Klass,FilterEdit=require("syracuse-tablet/html/js/controls/page/panels/sortfilter/tabFilterEdit").Klass,fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),locale=require("syracuse-tablet/html/js/helpers/locale"),_templates={main:'		<div class="s-m-scroll-wrapper" style="height:100%">			<div  class="s-m-scroll-elmt">				<section id="filterlist">				</section>				<section id="filteredit">				</section>			</div>		</div>',filterList:'		<div id="filterListEmpty" style="display:none">			{{emptyList}}		</div>		<ul class="list-group"/>		<div class="btn-group btn-group-justified" role="group">			<a type="button" class="btn btn-default" data-params="addFilter">				<i class="fa fa-plus" data-params="addFilter"></i>			</a>		</div>',items:'		{{#each items}}			{{#unless  @first }}			<span class="s-m-filter-separator '+fontUtils.filterIcon("separator")+'" ></span>			{{/unless}}			<li class="list-group-item" data-params="{{id}}">				<span class="s-m-filter-info"> 					<span class="s-m-filter-field">{{fieldName}}</span>					<span class="s-m-filter-operator">{{operatorLabel}}</span>					<span class="s-m-filter-value">{{value}}</span>				</span>				<span class="s-m-filter '+fontUtils.filterIcon("edit")+'" data-params="edit,{{@index}}"></span>				<span class="s-m-filter '+fontUtils.filterIcon("delete")+'" data-params="delete,{{@index}}"></span>			</li>		{{/each}}'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl(ctx)},_Klass=utils.defineClass(function(panel,id,options){Base.call(this,panel,id,options)},Base,{destroy:function(){Base.prototype.destroy.call(this),this.filterEdit&&(this.filterEdit.destroy(),this.filterEdit=null),this.filterInfo=null,this.$$listSectio=null,this.$$list=null,this.$$editSection=null},buildHtml:function(){this.$$content.append($(_getHtml("main",{}))),this.$$editSection=this.$$content.find("#filteredit"),this.$$listSection=this.$$content.find("#filterlist"),$(_getHtml("filterList",{addFilter:locale.text("panels.array.addFilter"),emptyList:locale.text("panels.array.emptyList")})).appendTo(this.$$listSection),this.$$list=this.$$listSection.find(".list-group"),this.$$emptyList=this.$$content.find("#filterListEmpty")},doTabShow:function(){if(this.initOpened)return;this.updateFilterList(),this.initOpened=!0},updateFilterList:function(list){this.filterInfo=list||this.filterInfo&&this.filterInfo.length>0?this.filterInfo:$.extend(!0,[],this.panel.getParentArray().filterInfoGet()),this.$$emptyList.toggle(!1),this.$$list.empty();if(this.filterInfo&&this.filterInfo.length>0){var $$items=$(_getHtml("items",{items:this.filterInfo}));this.$$list.append($$items)}else this.$$emptyList.toggle(!0);this.updateGesture()},doActionApply:function(){return this.panel.getParentArray().filterInfoSet($.extend(!0,[],this.filterInfo),!0),this.panel.savePagePrefs().then(function(){return!0})},getFavoritesData:function(){return $.extend(!0,[],this.filterInfo)},doContentAction:function(evt,$$target,dataParams){if(!dataParams)return;var params=dataParams.split(",");switch(params[0]){case"addFilter":this._openFilterEdit();break;case"cancelFilterEdit":this.filterEdit.onCancelEdit();break;case"submitFilterEdit":this.filterEdit.onFilterEditSubmit();break;case"delete":var idx=params[1];this._onFilterDelete(idx);break;case"edit":var idx=params[1];this._openFilterEdit(idx);break;default:return}},_onFilterDelete:function(idx){this._isIndexValid(idx)&&(this._removeFilter(idx),this.updateFilterList(this.filterInfo))},_addFilter:function(newFilterInfo){this.filterInfo.push(newFilterInfo)},_removeFilter:function(idx){this._isIndexValid(idx)&&this.filterInfo.splice(idx,1)},_updateFilter:function(idx,updateFilterInfo){this._isIndexValid(idx)&&this.filterInfo.splice(idx,1,updateFilterInfo)},_onCancelEdit:function(){this.$$editSection.empty(),this.$$listSection.toggle(!0)},_openFilterEdit:function(filterIdx){this.filterEdit=this.filterEdit||new FilterEdit(this),this._isIndexValid(filterIdx)&&this.filterEdit.setInitData(this.filterInfo[filterIdx],filterIdx),this.filterEdit.create(this.$$editSection),this.toggleList(!1)},_isIndexValid:function(idx){return!isNaN(parseInt(idx,10))&&idx>=0},onFilterUpdate:function(filterInfo,filterIdx){this._isIndexValid(filterIdx)?this._updateFilter(filterIdx,filterInfo):this._addFilter(filterInfo),this.updateFilterList(),this.toggleList(!0)},toggleList:function(show){this.$$listSection.toggle(show),this.filterEdit&&this.filterEdit.$$content.toggle(!show)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/sortfilter/tabMemo",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/controls/page/panels/sortfilter/tabBase","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),Base=require("syracuse-tablet/html/js/controls/page/panels/sortfilter/tabBase").Klass,fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),globals=require("syracuse-tablet/html/js/helpers/globals"),locale=require("syracuse-tablet/html/js/helpers/locale"),_templates={main:'		<div id="memotabroot" class="s-m-scroll-wrapper" style="height:100%">			<div  class="s-m-scroll-elmt">				<ul class="list-group"/>			</div>		</div>',items:'		{{#each items}}			<li class="list-group-item" data-params="{{@index}}">				<span class="s-m-memo-info"><a draggable="false" href="#" data-params="click">{{title}}</a>				<div style="display:none" class="s-m-value edit"><input class="s-m-meta form-control" type="text" value="{{title}}"></div>				</span>				<span class="s-m-memo '+fontUtils.filterIcon("edit")+'" data-params="edit"></span>				<span class="s-m-memo '+fontUtils.filterIcon("delete")+'" data-params="delete"></span>			</li>		{{/each}}'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl(ctx)},_Klass=utils.defineClass(function(panel,id,options){options=options||{},options.hidden=!1,Base.call(this,panel,id,options),this.currentSelection=null;var prefs=this.panel.getPagePrefs();this.favorites=prefs.favorites||[]},Base,{destroy:function(){Base.prototype.destroy.call(this),this.$$edit=null,this.$$display=null,this.currentSelection=null},buildHtml:function(){this.$$content.append($(_getHtml("main",{}))),this.$$list=this.$$content.find("ul.list-group"),this.$$list.css({height:"auto",position:"relative"}),this.$$list.on("blur","input",jsutils.bindFn(this.onBlur,this))},notifyClosePanel:function(){Base.prototype.notifyClosePanel.call(this),this.$$items&&(this.$$items.remove(),this.$$items=null)},doTabShow:function(){Base.prototype.doTabShow.call(this),this._render(),this._setButtonsState()},_setButtonsState:function(){this.panel.setButtonsState(!1,this.currentSelection!=null)},_render:function(){this.$$items&&this.$$items.remove(),this.$$items=$(_getHtml("items",{items:this.favorites})),this.$$list.append(this.$$items),this.currentSelection!=null&&this._selectCurrent(this.currentSelection),this.updateGesture()},doContentAction:function(evt,$$target,dataParams){if(!dataParams)return;switch(dataParams){case"delete":var idx=$$target.closest("li").index();this._onMemoDelete(idx);break;case"edit":this._openMemoEdit($$target.closest("li"));break;case"click":var idx=$$target.closest("li").index();this._onMemoClick(idx);break;default:return}},_onMemoDelete:function(idx){this._unSelectCurrent(),this.favorites.splice(idx,1),this.saveFavorites(),this._render()},_openMemoEdit:function(li){this.$$edit=$(li).find(".s-m-value.edit"),this.$$display=$(li).find("a"),this._setEditMode()},_onMemoClick:function(idx){idx!=this.currentSelection&&this._unSelectCurrent(),this._selectCurrent(idx)},_unSelectCurrent:function(){this.$$list.find(".selected").toggleClass("selected"),this.currentSelection=null,this._setButtonsState()},_selectCurrent:function(idx){this.currentSelection=idx,this.$$list.find("[data-params='"+this.currentSelection+"']").toggleClass("selected"),this._setButtonsState()},onBlur:function(){this._updateValue(),this._setDisplayMode()},_setDisplayMode:function(){this.$$edit.toggle(!1),this.$$display.toggle(!0),this.$$edit=null,this.$$display=null},_setEditMode:function(){this._unSelectCurrent(),this.$$edit.toggle(!0),this.$$display.toggle(!1),this.$$edit.children().focus(),this.$$edit.children().select()},_updateValue:function(){var idx=this.$$display.closest("li").index(),value=this.$$edit.children().val();this.$$display.text(value),this.favorites[idx].title=value,this.saveFavorites()},doActionApply:function(){if(this.currentSelection!==null){var fav=this.favorites[this.currentSelection];fav&&(this.panel.getParentArray().sortInfoSet($.extend(!0,[],fav.sort),!1),this.panel.getParentArray().filterInfoSet($.extend(!0,[],fav.filter),!0))}return $.smResolve(!0)},addFavorite:function(favData){return favData?(this.favorites.push(favData),this.saveFavorites().then(function(){var notify={severityClass:"success",title:favData.title,body:locale.text("panels.array.memo.created"),onlyWebapp:!0};globals.getModal().notify(notify)})):$.smResolve()},saveFavorites:function(){var prefs=this.panel.getPagePrefs();return prefs.favorites=this.favorites,prefs.isDirty=!0,this.panel.savePagePrefs()}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/sortfilter/filterSortPanel",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/controls/page/panels/sidePanel","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/controls/page/panels/sortfilter/tabSort","syracuse-tablet/html/js/controls/page/panels/sortfilter/tabFilter","syracuse-tablet/html/js/controls/page/panels/sortfilter/tabMemo"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),Base=require("syracuse-tablet/html/js/controls/page/panels/sidePanel").Klass,locale=require("syracuse-tablet/html/js/helpers/locale"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_Sort=require("syracuse-tablet/html/js/controls/page/panels/sortfilter/tabSort").Klass,_Filter=require("syracuse-tablet/html/js/controls/page/panels/sortfilter/tabFilter").Klass,_Memo=require("syracuse-tablet/html/js/controls/page/panels/sortfilter/tabMemo").Klass,_templates={main:'		<section class="s-m-side-panel {{side}}">			<nav class="nav-header">				<nav class="title">					<div >{{title}}</div>				</nav>				<div class="btn-group header-btn" role="group">					<a type="button" class="btn btn-default '+fontUtils.sortFilterTab("memo")+'" data-params="memo"></a>					<a type="button" class="btn btn-default '+fontUtils.sortFilterTab("apply")+'" data-params="apply"></a>				</div>			</nav>			<ul class="nav nav-pills" role="tablist"> 				{{#each tabs}}					<li><a href="#{{id}}" class="" role="tab" data-toggle="tab">{{title}}</a></li> 				{{/each}}			</ul> 			<div class="tab-content">				{{#each tabs}}					<div id="{{id}}" role="tabpanel" class="tab-pane {{type}}">					</div>				{{/each}}			</div> 		</section>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl(ctx)},_tabDescr=[{klass:_Sort,options:{name:"sort",isActive:!0,singleCriteria:!0}},{klass:_Filter,options:{name:"filter",isActive:!1}},{klass:_Memo,options:{name:"memo",isActive:!1}}],_Klass=utils.defineClass(function(controller,$type,panelId,options){options=options||{},options.enableGesture=!1,this._tabs={},Base.call(this,controller,$type,panelId,options)},Base,{destroy:function(){Base.prototype.destroy.call(this),this._activeTab=null,this.options.parentArray=null;var self=this;notifications.unsubscribe(self,["sm.click.icon.filterSort"]),this._tabs&&($.each(this._tabs,function(key,value){value.destroy()}),this._tabs=null),this.$$btnBar&&(this.$$btnBar.unbind(),this.$$btnBar.remove(),this.$$btnBar=null)},getParentArray:function(){return this.options.parentArray},buildHtml:function(side){var self=this;notifications.subscribe(self,["sm.click.icon.filterSort"]),Base.prototype.buildHtml.call(this,side),self.$$elmt.addClass(self.typeName),self.$$panel&&self.$$panel.remove();var ctx={title:locale.text("panels.array.title"),ctrlId:self.id,side:side,apply:locale.text("panels.array.apply"),close:locale.text("panels.array.close"),tabs:[]},descriptions=[];_tabDescr.forEach(function(descr){descr=$.extend({},descr),descr.options.hidden=self.options[descr.options.name]===!1,descriptions.push(descr)});var ids={};descriptions.forEach(function(descr){ids[descr.options.name]=utils.readableuid("array"+descr.options.name),ctx.tabs.push({id:ids[descr.options.name],icon:fontUtils.sortFilterTab(descr.options.name),type:descr.options.name,buttons:descr.options.buttons,title:locale.text("panels.array."+descr.options.name)})}),self.$$panel=$(_getHtml("main",ctx));if(self.$$panel&&self.$$panel.length){self.$$elmt.append(self.$$panel);var visibleTabs=[],activeIdx=-1;descriptions.forEach(function(descr,idx){var t=new descr.klass(self,ids[descr.options.name],descr.options);descr.options.hidden?t.hide():(visibleTabs.push(t),descr.options.isActive&&(activeIdx=idx)),self._tabs[descr.options.name]=t});if(visibleTabs.length>0){this._activeTab=visibleTabs[activeIdx===-1?0:activeIdx];var width=visibleTabs.length===1?"100%":Math.round(1e5/visibleTabs.length)/1e3+"%";visibleTabs.forEach(function(t){t.setWidth(width)}),self.$$btnBar=self.$$panel.find(".nav-header>.btn-group.header-btn"),self.$$btnBar.on("click","[data-params]",jsutils.bindFn(self.onBtnBarClick,this))}else this.close()}},notifyToggled:function(side,action,visible){Base.prototype.notifyToggled.call(this,side,action,visible),$.each(this._tabs,function(id,tab){tab[visible?"notifyOpenPanel":"notifyClosePanel"]()}),visible&&this._activeTab&&this._activeTab.triggerActivate()},onResize:function(context){Base.prototype.onResize.call(this,context);if(this.destoyed||!this._tabs)return;$.each(this._tabs,function(id,tab){tab.onResize(context)})},onBtnBarClick:function(evt){evt.preventDefault(),evt.stopPropagation();var $$target=$(evt.target),params=$$target.attr("data-params");switch(params){case"apply":this.applyTabSettings();break;case"memo":this.addFavorite()}},applyTabSettings:function(){var self=this;if(!this._activeTab)return;this._activeTab.doActionApply().then(function(close){close&&self.close()})},addFavorite:function(){if(!this._activeTab)return;var favData=null;$.each(this._tabs,function(key,tab){tab.getFavoritesData&&(favData=favData||{},favData[key]=tab.getFavoritesData())});if(favData){favData.title=locale.text("panels.array.memo")+" "+utils.getCurISODateTime();var memoTab=this._tabs.memo;memoTab.addFavorite(favData)}},notifyActiveTab:function(tab){this._activeTab=tab,this.setButtonsState(!0,!0)},getTabs:function(){return this._tabs},notifClickIconFilterSort:function(context){context&&context.className&&(context.className.indexOf("sorted")>=0?this.getTabs().sort.triggerActivate():context.className.indexOf("filtered")>=0&&this.getTabs().filter.triggerActivate())},setButtonsState:function(memo,apply){this.$$btnBar.find("[data-params='memo']").toggleClass("disabled",!memo),this.$$btnBar.find("[data-params='apply']").toggleClass("disabled",!apply)},getPagePrefs:function(){var array=this.getParentArray(),controller=array.controller;return controller.getPageSettings()},savePagePrefs:function(){var array=this.getParentArray(),controller=array.controller;return controller.writePageSettings()}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/dialogPanel",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/page/panels/sidePanel"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/page/panels/sidePanel").Klass,_templates={header:'		<div class="header">		<buttons class="pull-right"> 			<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-control-id="{{ctrlId}}" data-action="cancel"></button>		</buttons> 		<div class="modal-title">{{title}}</div> 		</div>		'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl||alert("template "+name+" not found"),tmpl(ctx)},_Klass=utils.defineClass(function(controller,$type,panelId,options){options=options||{},options.enableGesture=!0,Base.call(this,controller,$type,panelId,options)},Base,{buildHtml:function(side,title){Base.prototype.buildHtml.call(this,side),this.$$elmt.addClass("s-m-dialogPanel"),this.$$header&&this.$$header.remove();var ctx={side:side,ctrlId:this.id,title:title};this.$$header=this.buildHeader(ctx),this.$$header&&this.$$header.length&&this.$$elmt.append(this.$$header)},buildHeader:function(ctx){return $(_getHtml("header",ctx))},isEnabled:function(){return!0},_actCancel:function(){this.close()},_actValidate:function(){this.close()},onClick:function(evt){return!0},hasLinks:function(){return!0},attach:function($$parent,side){Base.prototype.attach.call(this,$$parent,side),$$parent.addClass("dialogpanel")},detach:function(){this.$$elmt&&this.$$elmt.parent().removeClass("dialogpanel"),Base.prototype.detach.call(this)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/pageSharePanel",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/page/panels/dialogPanel","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/selectorFactory","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/authoring/authoringPropertiesGeneral","syracuse-tablet/html/js/authoring/authoringComponents","syracuse-tablet/html/js/helpers/formatApi","syracuse-tablet/html/js/helpers/locale"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/page/panels/dialogPanel").Klass,fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),locale=require("syracuse-tablet/html/js/helpers/locale"),selectorFactory=require("syracuse-tablet/html/js/ui/selectorFactory"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),authPropsGeneral=require("syracuse-tablet/html/js/authoring/authoringPropertiesGeneral"),authComponents=require("syracuse-tablet/html/js/authoring/authoringComponents"),formatApi=require("syracuse-tablet/html/js/helpers/formatApi"),locale=require("syracuse-tablet/html/js/helpers/locale"),_templates={main:'			<nav class="navbar s-m-side-panel {{side}} navbar-inverse" role="navigation">				<div class="s-m-scroll-elmt">				{{#if liveTile}}					<div class="modal-subtitle">{{liveTile.title}}</div> 					<div class=""> 						<div class="form-group"> 							<table class="s-m-livetile">							{{#each liveTile.items}}							{{# unless this.disabled}}							<tr>							<td>{{this.label}}</td>							<td>							{{#if this.picker }}								<div  class="input-group" id="{{this.id}}" style="width:100%">								<div>							{{else}}								<input type="text" 								{{#if this.mandatory}}									mandatory="mandatory"								{{/if}}								class="form-control" size="{{this.size}}" id="{{this.id}}" value="{{defaultValue}}">							{{/if}}							</td>							</tr> 							{{/unless}}							{{/each}}							</table> 							<div class="btn-group btn-group-justified" role="group">								<a type="button" class="btn btn-default" data-action="liveTileCreate" data-control-id="{{ctrlId}}" disabled>{{liveTile.btnApply}}</a>							</div>						</div> 					</div>				{{/if}}				{{#if vignette.liveTile}}					<div class="modal-subtitle">{{vignette.liveTile.title}}</div> 					<div class=""> 						<div class="form-group"> 							<table class="s-m-livetile">							{{#each vignette.liveTile.items}}							{{# unless this.disabled}}							<tr>							{{#if this.picker }}								<td>{{this.label}}</td>								<td>								<div  class="input-group" id="{{this.id}}" style="width:100%">								<div>								</td>							{{else}}								{{#if this.select}}									{{#if ../../../../singleVignette}}										<input type="hidden" id="{{this.id}}" value="{{../../../../../singleVignette}}">									{{else}}									<td>{{this.label}}</td>									<td>									<select class="form-control"  id="{{this.id}}" data-action="{{this.dataAction}}" data-control-id="{{../../../../../ctrlId}}">										<option value="">{{this.emptyOptionLabel}}</option>									{{#each ../../../../../vignette.items}}										<option value="{{this.id}}">{{this.title}}</option>									{{/each}}									</select>									</td>									{{/if}}								{{else}}									<td>{{this.label}}</td>									<td>									<input type="text"  										{{#if this.mandatory}}										mandatory="mandatory"										{{/if}}										class="form-control" size="{{this.size}}" id="{{this.id}}" value="">									</td>								{{/if}}							{{/if}}							</tr> 							{{/unless}}							{{/each}}							</table> 							<div class="btn-group btn-group-justified" role="group">								<a type="button" class="btn btn-default" data-action="liveTileCreate" data-control-id="{{ctrlId}}">{{vignette.liveTile.btnApply}}</a>							</div>						</div> 					</div>				{{/if}}				{{#if scheduleMessage}}					<div class="modal-subtitle">{{scheduleMessage.title}}</div> 					<div class=""> 						<div class="form-group"> 							<table class="s-m-schedulemsg">							{{#each scheduleMessage.items}}							<tr>							<td>{{this.label}}</td>							<td>							{{#if this.picker }}								<div  class="input-group">									<input type="text" readonly="true" class="form-control" size="{{this.size}}" id="{{this.id}}" value="">									<span class="input-group-btn">										<button data-control-id="{{../../ctrlId}}" data-action="{{this.dataAction}}" data-params="{{this.id}} "class="btn btn-default">										<span class="{{this.icon}}"></span>									<span>								<div>							{{else}}								<input type="text"  								{{#if this.mandatory}}									mandatory="mandatory"								{{/if}}								class="form-control" size="{{this.size}}" id="{{this.id}}" value="">							{{/if}}							</td>							</tr>							{{/each}}							</table> 							<div class="btn-group btn-group-justified" role="group">								<a type="button" class="btn btn-default" data-action="reminderCreate" data-control-id="{{ctrlId}}">{{scheduleMessage.btnApply}}</a>							</div>						</div> 					</div>				{{/if}}				{{#if share}}					<div class="modal-subtitle" >{{share.title}}</div> 					<div class="btn-group btn-group-justified" role="group">						<a type="button" href="#" class="btn btn-default" data-control-id="{{ctrlId}}" data-action="sharePageLink">							<i class="{{share.icon}}"/>						<span>{{{share.label}}}</span>						</a>					</div> 				{{/if}}				<div>			</nav>'},_liveTile=[{disabled:!0,id:"vignette",select:!0,dataAction:"choice",mandatory:!0},{disabled:!1,id:"backgroundColor",size:10,picker:!0,component:"colorPalettePicker"},{disabled:!1,id:"description",size:50,type:"application/x-string",defaultValue:"",mandatory:!0}],_scheduleMsgItems=[{id:"date",size:10,type:"application/x-date",icon:fontUtils.getIconByName("datePicker"),picker:!0,dataAction:"datePicker",mandatory:!0},{id:"time",size:10,type:"application/x-time",icon:fontUtils.getIconByName("timePicker"),picker:!0,dataAction:"timePicker",mandatory:!0},{id:"description",size:50,type:"application/x-string",mandatory:!0}],_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl||alert("template "+name+" not found"),tmpl(ctx)},_getDateTimeInfo=function(date,time){if(!date)return null;date=date.split("-");if(date.length!==3)return null;var res={};return res.year=date[0],res.month=date[1],res.day=date[2],time=time?time.split(":"):[],time.length==3&&(res.hours=time[0],res.minutes=time[1],res.seconds=time[2]),res},_Klass=utils.defineClass(function(controller,$type,panelId,options){Base.call(this,controller,$type,panelId,options)},Base,{buildHtml:function(side){var self=this;this._context=this._getContext(),Base.prototype.buildHtml.call(this,side,this._context.title),this.$$panel&&this.$$panel.remove(),this.$$panel=this.buildPanel(this._context);if(this.$$panel&&this.$$panel.length){this.$$elmt.append(this.$$panel);var component;_liveTile.forEach(function(item){if(item.component){self.components=self.components||{};var $$item=self.$$elmt.find(".s-m-livetile #"+item.id),opts={};switch(item.component){case"colorPalettePicker":opts={id:item.id,palette:authPropsGeneral.getColorPalette(),dropUp:!1,onSelectColor:jsutils.bindFn(self._colorChange,self)}}self.components[item.id]=authComponents.newComponent(item.component,opts),self.components[item.id].createMarkup($$item)}})}this.$$panel.on("input","[mandatory]",jsutils.bindFn(this._setButtonsStat,this))},_colorChange:function(value){this.liveTile.backgroundColor=value?value.hex:null,this.liveTile.color=value?value.hex:null},buildPanel:function(context){return $(_getHtml("main",context))},hasLinks:function(){return!0},_getContext:function(){var pageContext=this.controller.getPageShareContext(),ctx={ctrlId:this.id,side:this.side},buildCtxLiveTile=function(ctx){var ctx;return _liveTile.forEach(function(item){item.label=locale.text("liveTile."+item.id+".label"),item.select&&(item.emptyOptionLabel=locale.text("liveTile."+item.id+".label.emptychoice")),item.defaultValue!==undefined&&(item.defaultValue=ctx.title)}),ctx={title:locale.text("liveTile.page.subtitle"),btnApply:locale.text("liveTile.apply.label"),items:_liveTile},ctx},buildCtxScheduleMessage=function(){var ctx;return _scheduleMsgItems.forEach(function(item){item.label=locale.text("schedule.message."+item.id+".label")}),ctx={title:locale.text("schedule.message.page.subtitle"),btnApply:locale.text("schedule.message.apply.label"),items:_scheduleMsgItems},ctx},builCtxShare=function(){var ctx;return ctx={title:locale.text("share.page.subtitle"),icon:fontUtils.pageIcon("nativeShare"),label:locale.text("action.nativeShare")},ctx};return ctx.title=pageContext.ctx.pageTitle||"",pageContext.opt.liveTile&&(ctx.liveTile=buildCtxLiveTile(ctx)),pageContext.opt.scheduleMessage&&(ctx.scheduleMessage=buildCtxScheduleMessage()),pageContext.opt.share&&(ctx.share=builCtxShare()),pageContext.vignettes.forEach(function(vignette){ctx.vignette=ctx.vignette||{},ctx.vignette.items=ctx.vignette.items||[],ctx.vignette.items.push({opt:vignette.opt,title:vignette.ctx.pageTitle,id:vignette.id}),Object.keys(vignette.opt).forEach(function(key){ctx.vignette[key]=ctx.vignette[key]||vignette.opt[key]||!1})}),ctx.singleVignette=pageContext.vignettes.length===1?ctx.vignette.items[0].id:!1,ctx.vignette&&ctx.vignette.liveTile?(this._getItemLiveTile("vignette").disabled=!1,ctx.vignette.liveTile=buildCtxLiveTile(ctx)):this._getItemLiveTile("vignette").disabled=!0,ctx},_setData:function(){var self=this;if(!self._context)return;this.liveTile={},self._context.scheduleMessage&&_scheduleMsgItems.forEach(function(item){var $$item=self.$$elmt.find(".s-m-schedulemsg #"+item.id);$$item.val(""),$$item.attr("isoValue","")}),self._context.vignette&&(self._context.singleVignette?self.$$elmt.find(".s-m-livetile #description").val(self._context.vignette.items[0].title):_liveTile.forEach(function(item){item.disabled||item.component||self.$$panel.find(".s-m-livetile #"+item.id).val("")})),self.components&&Object.keys(self.components).forEach(function(key){self.components[key].setValue("")}),this._setButtonsStat()},_setButtonsStat:function(){var self=this,btnCreate=self.$$elmt.find("a[data-action='liveTileCreate']"),disable=!1,val="";_liveTile.forEach(function(item){!item.disabled&&item.mandatory&&(disable=disable||self.$$panel.find(".s-m-livetile #"+item.id).val()=="")}),disable?btnCreate.attr("disabled","disabled"):btnCreate.removeAttr("disabled"),btnCreate=self.$$elmt.find("a[data-action='reminderCreate']"),disable=!1,val="",_scheduleMsgItems.forEach(function(item){!item.disabled&&item.mandatory&&(disable=disable||self.$$panel.find(".s-m-schedulemsg #"+item.id).val()=="")}),disable?btnCreate.attr("disabled","disabled"):btnCreate.removeAttr("disabled")},onValueChange:function(){this._setButtonsStat()},notifyToggled:function(side,action,visible){Base.prototype.notifyToggled.call(this,side,action,visible),visible&&this._setData()},_getItemLiveTile:function(id){var found;return _liveTile.some(function(item){if(item.id===id)return found=item,!0}),found},_actChoice:function(id){var btnCreate=this.$$elmt.find("a[data-action='liveTileCreate']"),value=this.$$elmt.find(".s-m-livetile #vignette").val(),itemDescription=this._getItemLiveTile("description");itemDescription&&!itemDescription.disabled&&itemDescription.defaultValue!==undefined&&this.$$elmt.find(".s-m-livetile #description").val(value?this.$$elmt.find(".s-m-livetile #vignette option:selected").text():""),this._setButtonsStat()},_actDatePicker:function(id){selectorFactory.createSelector(new _Field("application/x-date",this.$$panel.find(".s-m-schedulemsg #"+id),locale.text("schedule.message."+id+".label"),this))},_actTimePicker:function(id){selectorFactory.createSelector(new _Field("application/x-time",this.$$panel.find(".s-m-schedulemsg #"+id),locale.text("schedule.message."+id+".label"),this))},_actReminderCreate:function(){var schedule={},self=this;_scheduleMsgItems.forEach(function(item){var val=self.$$panel.find(".s-m-schedulemsg #"+item.id).attr("isoValue");val&&(schedule[item.id]=schedule[item.id]||{},schedule[item.id].$type=item.$type,schedule[item.id].value=val)});if(schedule.date&&schedule.time){var content={Severity:"reminder",Text1:self._context.title,Text2:schedule.description?schedule.description.value:"",ScheduleTime:schedule.date.value+" "+schedule.time.value,ScheduleTimeJSON:_getDateTimeInfo(schedule.date.value,schedule.time.value)};notifications.notifyController("sm.page.share",this.controller,"schedule",content),_scheduleMsgItems.forEach(function(item){self.$$panel.find(".s-m-schedulemsg #"+item.id).val("")})}self.close("close")},_actSharePageLink:function(){notifications.notifyController("sm.page.share",this.controller,"link"),this.close("close")},_actLiveTileCreate:function(){var self=this,content={},val;_liveTile.forEach(function(item){item.disabled||(self.liveTile&&self.liveTile[item.id]?content[item.id]=self.liveTile[item.id]:content[item.id]=self.$$panel.find(".s-m-livetile #"+item.id).val())}),content&&(self.liveTile.color&&(content.color=self.liveTile.color),content.title=content.description,delete content.description,notifications.notifyController("sm.page.share",this.controller,"liveTile",content)),this.close("close")}}),_Field=utils.defineClass(function(type,item,title,panel){this.$type=type,this.$title=title,this.$$item=item,this.panel=panel},null,{setFieldValueFromSelector:function(value){this.$$item.attr("isoValue",value),this.$$item.val(this._getFormattedValue(value)),this.panel.onValueChange&&this.panel.onValueChange(),this.destroy()},_getFormattedValue:function(value){var formatter=formatApi.getFormatter(this.$type);return formatter.formatValue(value,!1)},getValue:function(){return this.$$item.attr("isoValue")},getTitle:function(){return this.$title},destroy:function(){this.$$item=this.panel=null}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/pageDashboardTemplatePanel",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/page/panels/dialogPanel","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/ui/modals/modalConfirm"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/page/panels/dialogPanel").Klass,fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),locale=require("syracuse-tablet/html/js/helpers/locale"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),modalConfirm=require("syracuse-tablet/html/js/ui/modals/modalConfirm"),_templateAll={header:' 				<buttons class="pull-right"> 					<button type="button" class="btn btn-default s-m-modal-btn-cancel" data-action="$cancel"></button> 				</buttons> 				<div class="modal-title">{{title}}</div> 				',content:' 			<article style="height:100%">				<section class="panel panel-default list">					<div class="s-m-list-wrapper">					</div>				</section>			{{#if createLabel}}				<section class="panel panel-default action">					<button type="button" class="btn btn-default" data-action="createTemplate"  data-control-id="{{ctrlId}}"> {{createLabel}}</button>				</section>			{{/if}}			</article>		',list:' 		<ul class="list-group s-m-scroll-elmt">		{{#each views}} 		<li class="list-group-item {{selected}}" data-action="clickView" data-params="{{uuid}}" data-control-id="{{../ctrlId}}">			<table>				<tr>				<td>					<h4 class="list-group-item-heading">{{description}}</h4>					<p class="list-group-item-text">{{factoryOwner}}</p>				</td>				<td>					{{#if deletable}}					<span  class="btn btn-default s-m-delete-template" data-action="deleteTemplate" data-params="{{uuid}}"  data-control-id="{{../../ctrlId}}">					<i class="{{../../deleteicon}}"></i>					</span>					{{/if}}			    </td>				</tr>			</table>		</li>		{{/each}}		</ul>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templateAll[key];return tmpl||(tmpl=_templateAll[key]=Handlebars.compile(_templateAll[name])),tmpl||alert("template "+name+" not found"),tmpl(ctx)},_Klass=utils.defineClass(function(controller,$type,panelId,options){options=options||{},Base.call(this,controller,$type,panelId,options),this._viewList(options.views),notifications.subscribe(this,["sm.dashboard.list.views.change"])},Base,{buildHtml:function(side){Base.prototype.buildHtml.call(this,side,this.options.title),this.$$content=this._buildContent().appendTo(this.$$elmt),this._buildList().appendTo($(".s-m-list-wrapper",this.$$content))},destroy:function(){},notifyToggled:function(side,action,visible){Base.prototype.notifyToggled.call(this,side,action,visible),visible&&this._replaceList()},_setData:function(){},_getContext:function(){return null},_buildContent:function(){var opt={ctrlId:this.id};return this.options.showCreateTemplate&&(opt.createLabel=locale.text("dashboard.welcome.create.template")),$(_getHtml("content",opt))},_buildList:function(){var opts={deleteicon:fontUtils.getIconByName("$delete"),ctrlId:this.id,views:this.views};return $(_getHtml("list",opts))},_viewList:function(views){var self=this;self.views=[],views.forEach(function(view){self.views.push({description:view.$description,personal:view.$isPersonal,selected:view.$selected?"active":"",uuid:view.$uuid,factoryOwner:view.$factoryOwner,deletable:self.options.showCreateTemplate&&!view.$isPersonal})})},notifDashboardListViewsChange:function(opts){this._viewList(opts.views),this._replaceList()},_replaceList:function(){$(".s-m-list-wrapper").empty(),this._buildList().appendTo($(".s-m-list-wrapper",this.$$content))},_actCreateTemplate:function(){this.close(),notifications.publish(["sm.dashboard.create.template"])},_actDeleteTemplate:function(uuid){var modal=new modalConfirm.Modal(locale.text("modal.confirm.delete.template"),null,!0);return modal.show().then(function(result){result==="yes"&&notifications.publish(["sm.dashboard.delete.template"],uuid)})},_actClickView:function(uuid){this.close(),notifications.publish(["sm.dashboard.select.template"],uuid)}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/pageTemplatePanel",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/controls/page/panels/dialogPanel","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/formatApi","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),Base=require("syracuse-tablet/html/js/controls/page/panels/dialogPanel").Klass,locale=require("syracuse-tablet/html/js/helpers/locale"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),formatApi=require("syracuse-tablet/html/js/helpers/formatApi"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),CREATE_BTN="tmpl-panel-create-btn",CREATE_BTN_ADDON="tmpl-panel-create-btn-clear-addon",ITEM_TTL="s-m-tmpl-itm-ttl",ITEM_INFO="s-m-tmpl-itm-info",ITEM_TABLE="s-m-tmpl-itm",ITEM_ACT="s-m-tmpl-itm-act",LST_WRAP="s-m-list-wrapper",LST_SCROLL="s-m-scroll-elmt",ITEM_INPUT_TTL="tmpl-panel-item-input-ttl",ITEM_INPUT_TTL_ADDON="tmpl-panel-item-input-ttl-addon",FILTER_MENU="tmpl-panel-filter",_txt=function(id){return locale.text("edit.templates.dlog."+id)},_templates={error:'<section class="draft-error"><h1>{{error}}<h1><h2>{{contact}}<h2></section>',main:'		<article style="height:100%">			<section class="panel panel-default create">				<div class="panel-heading">{{createSection}}</div>				<div class="panel-body">					<table style="width:100%"><tr>						<td>{{name}}</td>						<td>							<div class="input-group {{#if smartphone}}input-group-sm{{/if}}">								<input id="{{CREATE_BTN}}" class="ctrl-evt-input form-control" aria-describedby="create-clear-addon" type="text"/>								<span  data-action="clearname" data-control-id="{{ctrlId}}" class="input-group-addon" id="{{CREATE_BTN_ADDON}}">X</span>							</div>						</td>						<td>							<span class="btn btn-default disabled" data-action="create" data-control-id="{{ctrlId}}">								<i class="{{createicn}}"></i>								<span>{{create}}</span>							</span>						</td>					</tr></table>				</div>			</section>			<section class="panel panel-default avail">				<div class="panel-heading">					<span>{{availSection}}</span>				</div>				<div class="{{LST_WRAP}}">					<ul class="list-group {{LST_SCROLL}}">					</ul>				</div>			</section>		</article>',items:'		{{#each items}}			<li class="list-group-item" data-params="{{tmplId}}">				<table class="{{../ITEM_TABLE}}"><tr>					<td>						<div class="{{../ITEM_TTL}}" data-action="changeItemTitle" data-control-id="{{../ctrlId}}">{{title}}</div>						<div class="{{../ITEM_INFO}}"style="overflow: hidden">							<span>{{date}}</span>							<span>{{representation}}</span>						</div>					</td>					<td>						<table class="{{../ITEM_ACT}}">							<tr>								<td>									<span  class="btn btn-default {{#unless applicable}}disabled{{/unless}}" data-action="apply" data-control-id="{{../ctrlId}}">										<i class="{{../applyicn}}"></i>										<span>{{../apply}}</span>									</span>								</td>								<td>									<span  class="btn btn-default {{#unless applicable}}disabled{{/unless}}" data-action="update" data-control-id="{{../ctrlId}}">										<i class="{{../updateicn}}"></i>									</span>								</td>								<td>									<span  class="btn btn-default" data-action="delete" data-control-id="{{../ctrlId}}">										<i class="{{../deleteicn}}"></i>									</span>								</td>							</tr>						</table>					</td>				</tr></table>			</li>		{{/each}}',noitems:'		<div class="s-m-noitem"><b>{{text}}</b></div>		',changeItemTitle:'		<div>			<div class="input-group {{#if smartphone}}input-group-sm{{/if}}">				<input id="{{ITEM_INPUT_TTL}}" style="font-weight:bold;" class="ctrl-evt-input form-control" type="text" aria-describedby="{{ITEM_INPUT_TTL_ADDON}}" >				<span data-action="saveItemTitle" data-control-id="{{ctrlId}}" class="btn input-group-addon" id="{{ITEM_INPUT_TTL_ADDON}}" style="background-color:inherit">					<i class="{{icon}}"/>				</span>			</div>		</div>',filtersMenu:'		<select id="{{FILTER_MENU}}" data-action="filter" data-control-id="{{ctrlId}}">			{{#each filterOptions}}				<option value="{{value}}" {{#if selected}}selected{{/if}}>{{title}}</option>			{{/each}}		<select>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl||alert("template "+name+" not found"),tmpl(ctx)},_Klass=utils.defineClass(function(controller,$type,panelId,options){options=options||{},options.enableGesture=!0,this.fromActionMgrUUID=options.fromActionMgrUUID,Base.call(this,controller,$type,panelId,options),this.representation=controller.representation,this.dateFormatter=formatApi.getFormatter("application/x-datetime"),this._initLabels()},Base,{_initLabels:function(){this._selectedFilter="current",this._filterOptions=[{value:"current",title:_txt("currendpoint")},{value:"all",title:_txt("allendpoint")}]},destroy:function(){Base.prototype.destroy.call(this),this.dateFormatter=null,this.$$content=null,this.$$list=null},buildHtml:function(side){this.$$content&&this.$$content.remove(),Base.prototype.buildHtml.call(this,side,_txt("title")),this.$$content=this._buildContent().appendTo(this.$$elmt),this.$$list=this.$$content.find(".panel.avail ul"),this.$$elmt.off().on("click",jsutils.bindFn(this.onMainClick,this))},_buildContent:function(){var context={createSection:_txt("createSection"),availSection:_txt("availSection"),name:_txt("name"),create:_txt("create"),createicn:fontUtils.getIconByName("$apply"),ctrlId:this.id,CREATE_BTN:CREATE_BTN,CREATE_BTN_ADDON:CREATE_BTN_ADDON,LST_WRAP:LST_WRAP,LST_SCROLL:LST_SCROLL,smartphone:globals.getSiteLayout().getDeviceType()==="smartphone"};return $(_getHtml("main",context))},_buildItems:function(){var self=this;self.$$list.off().empty();var context={ctrlId:self.id,updateicn:fontUtils.getIconByName("$refresh"),deleteicn:fontUtils.getIconByName("$delete"),applyicn:fontUtils.getIconByName("$apply"),apply:_txt("apply"),ITEM_TTL:ITEM_TTL,ITEM_INFO:ITEM_INFO,ITEM_TABLE:ITEM_TABLE,ITEM_ACT:ITEM_ACT,items:[]};globals.getStorage().templateOperation("count").then(function(count){var deferred=$.Deferred(),queryRep=self._selectedFilter==="all"?null:self.representation,queryEp=self._selectedFilter==="all"?null:globals.getEndpoint();return globals.getStorage().templateOperation("query",queryRep,queryEp,!0).then(function(templates){deferred.resolve(count,templates)}).fail(function(e){deferred.reject(e)}),deferred.promise()}).then(function(count,templates){templates=templates||[],templates.sort(function(a,b){return b.endpoint===a.endpoint?b.creation_date>a.creation_date:b.endpoint>a.endpoint});if(templates.length>0){var ep=globals.getEndpoint();templates.forEach(function(tmpl,idx){context.items.push({title:tmpl.title,date:self.dateFormatter.formatValue(tmpl.creation_date),tmplId:tmpl.id,applicable:tmpl.representation===self.representation,representation:self._selectedFilter==="all"?tmpl.representation||"":null})}),$(_getHtml("items",context)).appendTo(self.$$list)}else $(_getHtml("noitems",{text:_txt("noitem")})).appendTo(self.$$list);self._$$filter||(self._$$filter=$(self._buildFilterMenu()).appendTo(self.$$content.find(".panel.avail > .panel-heading"))),self._$$filter.val(self._selectedFilter).toggle(self._selectedFilter==="all"||count>templates.length),self._updateGesture()}).fail(function(e){globals.getModal().error(_txt("readallerr"),e,function(){self.$$content.html($(_getHtml("error",{error:locale.text("error"),contact:locale.text("contact.admin")})))})})},_buildFilterMenu:function(){var self=this;self._selectedFilter=self._selectedFilter||"current";var opts=[];return self._filterOptions.forEach(function(item){item=$.extend({},item),item.selected=item.value===self._selectedFilter,opts.push(item)}),_getHtml("filtersMenu",{filterOptions:opts,ctrlId:self.id,FILTER_MENU:FILTER_MENU})},_actFilter:function(){var f=this._$$filter.val();if(f===this._selectedFilter)return;this._selectedFilter=f,this._buildItems()},refresh:function(){this._buildItems(),this._actClearname()},_notify:function(text){var notify={severityClass:"success",body:text,onlyWebapp:!0,delay:"short"};globals.getModal().notify(notify)},_getTmplId:function($$target,event,propagate){return propagate!==!0&&event.stopPropagation(),$$target.closest("li[data-params]").attr("data-params")},_actApply:function(param,$$target,event){var self=this,tmplId=self._getTmplId($$target,event);if(!tmplId)return;globals.getStorage().templateOperation("read",tmplId).then(function(data){self.close(),data&&(self.controller.dao.setTemplateData(data.dataSet),self.controller.refresh({refreshValue:!0}))}).fail(function(e){globals.getModal().error("Error deleting template",e)})},_actUpdate:function(param,$$target,event){var self=this,tmplId=self._getTmplId($$target,event);if(!tmplId)return;globals.getStorage().templateOperation("update",tmplId,{dataSet:self.controller.dao.getTemplateData()},!1).then(function(){self.close(),self._notify(_txt("updt.success"))}).fail(function(e){globals.getModal().error("Error updating template",e)})},_actDelete:function(param,$$target,event){var self=this,tmplId=self._getTmplId($$target,event);if(!tmplId)return;globals.getStorage().templateOperation("delete",tmplId).then(function(){self.refresh()}).fail(function(e){globals.getModal().error("Error deleting template",e)})},_actCreate:function(param,$$target,event){var self=this,ctx={id:utils.UUID(),endpoint:globals.getEndpoint(),representation:self.representation,title:self.$$content.find("#"+CREATE_BTN).val(),dataSet:self.controller.dao.getTemplateData()};globals.getStorage().templateOperation("save",ctx).then(function(){self.close(),self._notify("Template has been created successfully")}).fail(function(e){globals.getModal().error("Error saving template",e)})},_actClearname:function(param,$$target,event){this.refreshCreateBtn("")},_actChangeItemTitle:function(param,$$target,event){var tmplId=this._getTmplId($$target,event);if(!tmplId)return;this._$$changeItemTitle||(this._$$changeItemTitle=$(_getHtml("changeItemTitle",{ctrlId:this.id,icon:fontUtils.getIconByName("$refresh"),ITEM_INPUT_TTL:ITEM_INPUT_TTL,ITEM_INPUT_TTL_ADDON:ITEM_INPUT_TTL_ADDON,smartphone:globals.getSiteLayout().getDeviceType()==="smartphone"})),this._$$changeItemTitle.find("span").on("click",jsutils.bindFn(this.onClickSaveItemTitle,this))),$$target.before(this._$$changeItemTitle.detach().css({position:"relative",left:""})).hide(),this.refreshSaveItemTitleBtn(this._$$changeItemTitle.find("#"+ITEM_INPUT_TTL).val($$target.text()))},onClickSaveItemTitle:function(event){var self=this,tmplId=self._getTmplId($(event.target),event,!0);if(!tmplId)return;var $$display=self._$$changeItemTitle.parent().find("."+ITEM_TTL),title=self._$$changeItemTitle.find("#"+ITEM_INPUT_TTL).val();if($$display.text()===title)return;$$display.text(title).show(),globals.getStorage().templateOperation("update",tmplId,{title:title},!0).fail(function(e){globals.getModal().error("Error saving template title",e)})},onMainClick:function(evt){this._$$changeItemTitle&&this._$$changeItemTitle.is(":visible")&&(this.$$content.find("."+ITEM_TTL).show(),this._$$changeItemTitle.detach())},onInput:function(evt){var $$target=$(evt.target);if($$target.is("#"+CREATE_BTN)){this.refreshCreateBtn();return}if($$target.is("#"+ITEM_INPUT_TTL)){this.refreshSaveItemTitleBtn($$target);return}},refreshSaveItemTitleBtn:function($$input){$$input.focus().parent().find("#"+ITEM_INPUT_TTL_ADDON).toggleClass("disabled",$$input.val().trim().length===0)},refreshCreateBtn:function(val){this._$$create||(this._$$create=this.$$content.find('.panel.create .btn[data-action="create"]'),this._$$input=this.$$content.find('.panel.create input[type="text"]')),val!=null&&this._$$input.val(val),this._$$create.toggleClass("disabled",this._$$input.val().trim().length<=0),this._$$input.focus()},notifyToggled:function(side,action,visible){if(visible===!0){this.refresh();return}var self=this;globals.getStorage().templateOperation("count").then(function(count){notifications.publish("sm.edit.templates.changed",self.fromActionMgrUUID,count)});return}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/panels/userPanelSmartphone",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/controls/page/panels/actionPanel","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/application/eventListener","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/controls/ctrlHelpers","syracuse-tablet/html/js/helpers/native/native"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),Base=require("syracuse-tablet/html/js/controls/page/panels/actionPanel").Klass,globals=require("syracuse-tablet/html/js/helpers/globals"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),locale=require("syracuse-tablet/html/js/helpers/locale"),eventListener=require("syracuse-tablet/html/js/application/eventListener"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),ctrlHelpers=require("syracuse-tablet/html/js/controls/ctrlHelpers"),native=require("syracuse-tablet/html/js/helpers/native/native"),_hideDevFeatures,_mustHideDevFeatures=function(){if(_hideDevFeatures!=null)return _hideDevFeatures;_hideDevFeatures=!native.isTestMode()&&native.hasCapability("nativeApp")},_templates={navigLink:'<li class="">		<a draggable="false"  href="#" {{#if openPage}}data-nav="{{openPage}}"{{else}}data-action="{{action}}" data-params="{{params}}"{{/if}} data-control-id="{{ctrlId}}">			<i class="{{icon}}"></i>			&nbsp;			<span class="isLabel">{{title}}</span>		</a>	</li>'},_panelLinks={home:{label:"header.sm.links.home",icon:"home",action:"gotoWelcomeApplication",target:"application"},switchContext:{label:"header.sm.links.switchContext",icon:"switchContext",params:"switchContext",action:"linkClicked",target:"panel"},pageShare:{label:"header.links.page.share",icon:"nativeShare",params:"pageShare",action:"linkClicked",target:"panel"},pageMailTo:{label:"header.links.page.mailto",icon:"mailto",action:"pageMailto",target:"application"},clearCache:{label:"header.sm.links.settings",icon:"settings",action:"linkClicked",params:"settings",target:"panel"},about:{label:"header.sm.links.about",icon:"about",action:"linkClicked",params:"about",target:"panel"},logout:{label:"header.sm.links.logout",icon:"logout",action:"logout",target:"application"},development:{label:"header.links.development",icon:"developmentPage",action:"developmentPage",target:"application"},pinPage:{label:"",icon:"",action:"pinPage",target:"application"},pageConfig:{label:"page.configure.btn",icon:"pageConfig",action:"pageConfig",target:"application"},showDashboardList:{label:"page.dashboardlList.btn",icon:"dashboardList",action:"dashboardList",target:"application"},showMyDashboard:{label:"page.mydashboard.btn",icon:"mydashboard",action:"myDashboard",target:"application"},drafts:{label:"header.links.page.drafts",icon:"drafts",openPage:"pageDrafts",target:"application"}},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl(ctx)},_Klass=utils.defineClass(function(controller,$type,panelId,options){options=options||{},options.overlap=!1,options.enableGesture=!1,options.enableTwoColumns=!0,Base.call(this,controller,$type,panelId,options),notifications.subscribe(this,["sm.page.pin.state.change","sm.drafts.changed"]),this._initPanelItems(controller,options)},Base,{destroy:function(){Base.prototype.destroy.call(this),this._doAfterBuildHandlers=null},buildPanel:function(context,side){var self=this,actionsHtml=[],keys=Object.keys(self._panelLinks);return keys.forEach(function(kk,idx){var link=self._panelLinks[kk];link.hidden!==!0&&actionsHtml.push(_getHtml("navigLink",{title:locale.text(link.label),action:link.action||"",openPage:link.openPage||"",params:link.params||"",icon:fontUtils.pageIcon(link.icon),ctrlId:link.target==="panel"?self.id:null}))}),context.items=[{title:globals.getUserName(),html:actionsHtml.join("")}],Base.prototype.buildPanel.call(self,context,side)},attach:function($$parent,side){Base.prototype.attach.call(this,$$parent,side),this._doAfterBuildHandlers&&(this._doAfterBuildHandlers.forEach(function(handler){handler()}),this._doAfterBuildHandlers=null)},_initPanelItems:function(page,options){var toolBars=options||{};this._panelLinks=$.extend(!0,{},_panelLinks),this._panelLinks.development.hidden=_mustHideDevFeatures()===!0||globals.isMobile()?!0:!toolBars.showDevelopment,this._panelLinks.home.hidden=!toolBars.showHome,this._panelLinks.pageConfig.hidden=!toolBars.showPageConfig,this._panelLinks.showDashboardList.hidden=!toolBars.showDashboardList,this._panelLinks.showMyDashboard.hidden=!toolBars.showMyDashboard,this._panelLinks.pageShare.hidden=!page.showPageShare(),this._panelLinks.pageMailTo.hidden=toolBars.showPageMailto!==!0,this._panelLinks.drafts.hidden=!toolBars.showDrafts;var pinPage=this._panelLinks.pinPage;switch(toolBars.statusPinPage){case 1:pinPage.label="pin.page.panel.label.pin",pinPage.hidden=!1,pinPage.icon="pinPage_1";break;case 2:pinPage.label="pin.page.panel.label.unpin",pinPage.hidden=!1,pinPage.icon="pinPage_2";break;default:pinPage.hidden=!0}},_actLinkClicked:function(actionName){eventListener.triggerAction(this.$$elmt,actionName)},notifPagePinStateChange:function(newState){var $$icon=this.$$elmt.find("[data-action=pinPage] i");$$icon.length>0&&$$icon.attr("class",fontUtils.pageIcon("pinPage_"+newState));var $$text=this.$$elmt.find("[data-action=pinPage] span");if($$text.length>0){var text;newState!=2?text=locale.text("pin.page.panel.label.pin"):text=locale.text("pin.page.panel.label.unpin"),$$text.text(text)}},hasLinks:function(){return!0},_afterBuildPush:function(handler){this._doAfterBuildHandlers==null&&(this._doAfterBuildHandlers=[]);if(this._doAfterBuildHandlers.indexOf(handler)>=0)return;this._doAfterBuildHandlers.push(handler)},notifDraftsChanged:function(count){this.$$elmt?ctrlHelpers.notifDraftsChanged(this,count):this._afterBuildPush(jsutils.bindFn(this.notifDraftsChanged,this,count))}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/ctrlTypeUnknown",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/ctrlBase"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/ctrlBase").Klass,_Klass=utils.defineClass(function CtrlTypeUnknown(controller,article,prototype){Base.call(this,controller,article,prototype)},Base,{buildHtml:function($$parent,controllerDao,buildOptions){Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions,["s-m-unknown"]),this.$$elmt.html('<div class="s-m-value">Field '+this.$bind+" - Unknown type: "+this.$type+"</div>")}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/ctrlUnfound",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/ctrlBase"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/ctrlBase").Klass,_Klass=utils.defineClass(function CtrlUnfound(controller,article,prototype){Base.call(this,controller,article,prototype)},Base,{buildHtml:function($$parent,controllerDao,buildOptions){var self=this;Base.prototype.buildHtml.call(self,$$parent,controllerDao,buildOptions,["s-m-unfound"]),self.$$elmt.html('<div class="s-m-value">Field <b>'+self.$bind+"</b> unfound</div>")}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/field/ctrlImage",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/controls/field/ctrlFieldBase","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/helpers/native/native"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),locale=require("syracuse-tablet/html/js/helpers/locale"),clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),native=require("syracuse-tablet/html/js/helpers/native/native"),_handlersMap={$delete:"_onClearClick",$edit:"_onEditClick",$sign:"_onSignClick",$camera:"_onCameraClick",$select:"_onUploadClick"},_scaleMap={small:{width:640,height:480},medium:{width:1024,height:768},large:{width:1920,height:1440}},_templates={footer:'			<footer> 					{{#each actions}}						{{#if active}}							<a class="ctrl-evt-click"								href = "#"								draggable="false"								action="{{id}}">								<span 								{{#if css}}									class="{{css}}"								{{/if}}								>								{{#if text}}									{{text}}								{{/if}}								</span>							</a>						{{/if}}					{{/each}}			</footer> 		'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl||alert("template "+name+" not found"),tmpl(ctx)},_Klass=utils.defineClass(function CtrlImage(controller,article,prototype,options){options=options||{},options.nativeCapabilities={penAnnotatedImage:!0,penSignatureImage:!0,camera:!0},Base.call(this,controller,article,prototype,options),this.cssType="s-m-img"},Base,{initReuseProperties:function(){Base.prototype.initReuseProperties.call(this),this.$$layout=null},applyMetaData:function(metaData,buildOptions){Base.prototype.applyMetaData.call(this,metaData,buildOptions);if(this.$isEditMode&&this.$$layout){var disabled=metaData?metaData.$isReadOnly||metaData.$isDisabled:!1;this.$$layout.children("footer").toggle(disabled!==!0)}},buildFieldValue:function(parentSlot,buildOptions){var diplayInACell=buildOptions&&(buildOptions.displayCtx==="table"||buildOptions.displayCtx==="card");this.article.$imgHeight||(this.article.$imgHeight=diplayInACell?"small":"medium");var value=this.getFormattedValue(this.getValue()),imgParent=Base.prototype.buildFieldValue.call(this,parentSlot,buildOptions),docUrl=this._getLocalUrlValue();docUrl||(docUrl=this.prototype.data("$url",this.getDao())||"",clientContract.isLocalEntityUrl(docUrl)?docUrl=clientContract.callLocalEntityUrl(docUrl):buildOptions.updateLayout!==!0&&(docUrl+="?salt="+(new Date).getTime()));var empty=value==null||value===""||!docUrl||docUrl.length===0;empty&&$(imgParent).addClass("s-m-empty");if(this.$isEditMode&&typeof FileReader!="undefined")this._buildEditImageField(imgParent,docUrl,empty);else{if(this.article.$imgDisplayIcon===!0){var css;return empty?css=fontUtils.getColImageDefIcon(!0).css:css=(this.article.$imgIcon||fontUtils.getColImageDefIcon(!1)).css,$(imgParent).addClass(css)}if(empty)buildOptions&&buildOptions.displayCtx==="card"?this._defaultImg(imgParent,null):$(imgParent).addClass(this._getDefaultIcon());else{var css=["img-responsive"];diplayInACell||css.push("ctrl-evt-click");var e=uiUtils.createDomElement("a",css,null,{href:"#"},imgParent);e=this._newImg(e,docUrl)}}},_isBtnActive:function(btnId){var isSignature=this.article.$isSignature?!0:!1,isActive=!1;switch(btnId){case"$select":isActive=!isSignature&&!this.isNativeCapabilityEnabled("camera");break;case"$edit":isActive=!isSignature&&this.isNativeCapabilityEnabled("penAnnotatedImage");break;case"$camera":isActive=!isSignature&&this.isNativeCapabilityEnabled("camera");break;case"$sign":isActive=isSignature&&this.isNativeCapabilityEnabled("penSignatureImage");break;case"$delete":isActive=!0;break;default:isActive=!1}return isActive},_buildEditImageField:function(parentSlot,docUrl,empty){this.$$layout=$('<div class="s-m-img-layout">');var core=uiUtils.createDomElement("a",["img-responsive","s-m-field-img","ctrl-evt-click"],null,{href:"#"},$("<section>").appendTo(this.$$layout)),actions=[{id:"$select",active:this._isBtnActive("$select"),css:"s-m-select",text:locale.text("image.label.selectimage")},{id:"$edit",active:this._isBtnActive("$edit"),css:"s-m-edit "+fontUtils.getIconByName("$image-ink")},{id:"$sign",active:this._isBtnActive("$sign"),css:"s-m-sign "+fontUtils.getIconByName("$image-sign")},{id:"$camera",active:this._isBtnActive("$camera"),css:"s-m-camera "+fontUtils.getIconByName("$image-camera")},{id:"$delete",active:this._isBtnActive("$delete"),css:"s-m-delete "+fontUtils.getIconByName("$delete")}];$(_getHtml("footer",{actions:actions})).appendTo(this.$$layout),empty?core=uiUtils.createDomElement("span",[this._getDefaultIcon(),"s-m-empty","img-responsive"],null,null,core):(core=this._newImg(core,docUrl),this.img=core),parentSlot.appendChild(this.$$layout[0]);var inputDom=uiUtils.createDomElement("input",["ctrl-evt-change"],null,{type:"file",accept:"image/*"},parentSlot);this.$$elmt.find(".s-m-img-layout > footer > a[action='$delete']").toggle(!empty),this.$$elmt.find(".s-m-img-layout > footer > a[action='$edit']").toggle(!empty)},onClick:function(evt){var dom=evt.target.nodeName.toLowerCase()==="span"?evt.target.parentNode:evt.target,parentDom;!this.$isEditMode&&dom.nodeName.toLowerCase()==="a"?parentDom=dom:parentDom=dom.parentNode;if(!parentDom)return;var hdl=_handlersMap[$(dom).attr("action")||parentDom.nodeName.toLowerCase()];if(!hdl)return;this[hdl](evt,dom)},_getBinaryContent:function(){var binary=this.getDao().getValue(this.$bind+"-LOCALURL");if(!binary&&this.img){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");ctx.canvas.width=this.img.naturalWidth,ctx.canvas.height=this.img.naturalHeight,ctx.drawImage(this.img,0,0,this.img.naturalWidth,this.img.naturalHeight),binary=canvas.toDataURL()}return binary},_onClearClick:function(evt,dom){var clearBtn=dom,core=this.$$elmt.find(".s-m-img-layout > section > a")[0];uiUtils.empty(core),core=uiUtils.createDomElement("span",[this._getDefaultIcon(),"s-m-empty"],null,null,core),this.setValue(null);var element=this.$$elmt.find(".s-m-value > input");element.replaceWith(element=element.clone(!0)),$(clearBtn).toggle();if(this._isBtnActive("$edit")){var editBtn=this.$$elmt.find(".s-m-img-layout > footer > a[action='$edit']")[0];$(editBtn).toggle()}this._setLocalUrlValue(null)},_onEditClick:function(evt,dom){var self=this,editBtn=this.$$elmt.find(".s-m-img-layout > footer > a[action='$edit']")[0],data;try{data=self._getBinaryContent()}catch(e){$(editBtn).hide();return}$(editBtn).toggle(),native.getModule("penAnnotatedImage").getAnnotatedImage({title:self.getTitle(),imageData:data}).then(function(data){data&&data.action==="ok"?data.imageData&&data.imageData.length&&(self.setValue(self._getImageDataValue(data.imageData)),self._setImage(data.imageData)):$(editBtn).toggle()})},_onSignClick:function(evt,dom){var self=this,signBtn=this.$$elmt.find(".s-m-img-layout > footer > a[action='$sign']")[0];$(signBtn).toggle(),native.getModule("penAnnotatedImage").getSignatureImage({title:self.getTitle(),watermark:""}).then(function(data){data&&data.action==="ok"&&data.imageData&&data.imageData.length&&(self.setValue(self._getImageDataValue(data.imageData)),self._setImage(data.imageData)),$(signBtn).toggle()})},_onCameraClick:function(evt,dom){var self=this,signBtn=this.$$elmt.find(".s-m-img-layout > footer > a[action='$camera']")[0];$(signBtn).toggle(),native.getModule("camera").getPictureFromCamera({resizeOptions:self._getResizeOptions()}).then(function(data){return data&&data.action==="ok"&&data.imageData&&data.imageData.length>0?self._checkScale(data.imageData):null}).then(function(imageData){imageData&&(self.setValue(self._getImageDataValue(imageData)),self._setImage(imageData))}).always(function(){$(signBtn).toggle()})},_onUploadClick:function(evt,dom){var $$inputDom=this.$$elmt.find(".s-m-value > input");try{$$inputDom.trigger("click")}catch(e){jQuery.event.triggered=undefined}},onChange:function(evt){var self=this;if(evt.target.nodeName.toLowerCase()==="input"){var files=evt.target.files,res={};if(files&&files.length){var f=files[0];if(!f.type.match("image.*"))return;res.$contentType=f.type,res.$fileName=f.name,res.$type="image";var reader=new FileReader;reader.onload=function(theFile,cont){return function(e){self._checkScale(e.target.result).then(function(src){cont.$value=self._getImageDataValue(src),delete cont.$url,self.setValue(cont.$value),self.setFocus(),self._setImage(src)})}}(f,res),reader.readAsDataURL(f)}}},_getImageDataValue:function(content){var i=content.indexOf("base64,");return i>0?content.substring(i+7):content.result},_setLocalUrlValue:function(src){this.getDao().setValue(this.$bind+"-LOCALURL",src)},_getLocalUrlValue:function(){return this.getDao().getValue(this.$bind+"-LOCALURL")},_setImage:function(src){this._setLocalUrlValue(src);var core=this.$$elmt.find(".s-m-img-layout > section > a")[0];uiUtils.empty(core),core=this._newImg(core,src),this.$$elmt.find(".s-m-img-layout > footer > a[action='$delete']").toggle(!0),this._isBtnActive("$edit")&&this.$$elmt.find(".s-m-img-layout > footer > a[action='$edit']").toggle(!0)},_getResizeOptions:function(){var scale=_scaleMap[this.getAuthoring("$imgScale")||"medium"];return scale==null?null:{width:scale.width,height:scale.height,mode:"LIMIT_MAX_WIDTH_AND_HEIGHT"}},_checkScale:function(src){if(!src)return $.smResolve(src);var self=this,scaler=native.getModule("imageScale");if(!scaler)return $.smResolve(src);var opts=self._getResizeOptions();return opts?(opts.imageData=src,scaler.getScaledImage(opts).then(function(result){return result.action==="ok"?result.imageData:result.action==="nochange"?src:src})):$.smResolve(src)},_newImg:function(parent,src){return this._setImgHeight(uiUtils.createDomElement("img",["img-responsive"],null,{src:src},parent))},_defaultImg:function(parent,css){return this._setImgHeight(uiUtils.createDomElement("span",this._getDefaultIcon()+(" "+(css||"")),null,null,parent))},_setImgHeight:function(i){return $(i).height(uiUtils.imgHeight2px(this.getAuthoring("$imgHeight")||"small")).get(0)},_getDefaultIcon:function(){var css="s-m-icon-"+(this.article.$emptyIconSize||"small")+" ";return css+(this.article.$emptyImageIcon||fontUtils.getEmptyImageDefIcon()).css}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/field/ctrlDocument",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/field/ctrlFieldBase","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_Document=utils.defineClass(function CtrlDocument(controller,article,prototype,options){options=options||{},options.nativeCapabilities=null,Base.call(this,controller,article,prototype,options),this.cssType="s-m-document"},Base,{initReuseProperties:function(){Base.prototype.initReuseProperties.call(this),this.$$layout=null},applyMetaData:function(metaData,buildOptions){Base.prototype.applyMetaData.call(this,metaData,buildOptions);if(this.$isEditMode&&this.$$layout)var disabled=metaData?metaData.$isReadOnly||metaData.$isDisabled:!1},buildFieldValue:function(parentSlot,buildOptions){var self=this,value=self.getFormattedValue(self.getValue()),imgParent=Base.prototype.buildFieldValue.call(self,parentSlot,buildOptions),docUrl=self._getLocalUrlValue();docUrl||(docUrl=self.prototype.data("$url",self.getDao())||"",buildOptions.updateLayout!==!0&&(docUrl+="?salt="+(new Date).getTime()));var empty=value==null||value===""||docUrl.length===0;empty&&$(imgParent).addClass("s-m-empty");if(!empty){var classcss=["img-responsive ctrl-evt-click"];classcss.push(this._getIcon());var e=uiUtils.createDomElement("span",classcss,null,{href:"#"},imgParent)}},_getIcon:function(){return fontUtils.documentFieldIcon()},onClick:function(evt){var dom=evt.target.parentNode,parentDom;if(this.$isEditMode)return;this._onDocumentClick(evt,dom)},_onDocumentClick:function(evt,dom){var self=this,value=self.getFormattedValue(self.getValue()),docUrl=self.prototype.data("$url",self.getDao())||"",empty=value==null||value===""||docUrl.length===0;empty||window.open(docUrl,"_blank")},_getLocalUrlValue:function(){return this.getDao().getValue(this.$bind+"-LOCALURL")}}),_Binary=utils.defineClass(function CtrlBinaryd(controller,article,prototype,options){var self=this;_Document.call(self,controller,article,prototype,options),self.cssType="s-m-binary"},_Document,{_getIcon:function(){return fontUtils.binaryFieldIcon()}});exports.Klass=_Document,exports.Binary=_Binary}),define("syracuse-tablet/html/js/helpers/html-escape/lib/escape",["require","exports","module"],function(require,exports,module){function fixOptions(options){return options=options||{},options.allowedTags=(options.allowedTags||[]).concat(["h1","h2","h3","h4","h5","h6","blockquote","p","a","ul","ol","nl","li","b","i","strong","em","strike","code","hr","br","div","pre","table","thead","caption","tbody","tr","th","td","pre"]),options.allowedAttributes=(options.allowedAttributes||[]).concat(["class","href","src","name","target"]),options.allowedSchemes=(options.allowedSchemes||[]).concat(["http","https","mailto"]),options}function map(array){return array.reduce(function(map,key){return map[key]=!0,map},{})}function escapeText(str){return str.replace(/>/g,"&gt;")}function escapeComment(str){return str.replace(/-->/g,"__>")}function escapeStyle(str){return str.replace(/\/\*.*?\*\//g,"").replace(/(\\|\b)(j\\?a\\?v\\?a\\?s\\?c\\?r\\?i\\?p\\?t|e\\?x\\?p\\?r\\?e\\?s\\?s\\?i\\?o\\?n|u\\?r\\?l)\b/ig,"disabled-$1$2")}function escapeType(str){return str.replace(/javascript/i,"disabled-javascript")}exports.escaper=function(options){function checkChange(oldVal,newVal,prefix){return warn&&newVal!==oldVal&&warn(prefix+": "+oldVal+" -> "+newVal),newVal}function escapeValue(key,val){return key==="style"?checkChange(val,escapeStyle(val),"sanitized style"):key==="type"?checkChange(val,escapeType(val),"sanitized type attribute"):val}function create(){function skipTillMarker(frag,marker,repl){var i=frag.indexOf(marker);return i>=0?(preserve&&(result+=escapeComment(frag.substring(0,i))+repl+"-->"),result+=escapeText(frag.substring(i+marker.length)),inside="text"):preserve&&(result+=escapeComment(frag)),result}function skipTillClosing(frag,tag,allowed){var re=new RegExp("^/"+tag+">","i"),m=re.exec(frag);return m?(allowed?result+="</"+tag+">":preserve&&(result+="</"+tag+">-->"),result+=escapeText(frag.substring(m[0].length)),inside="text"):allowed?result+=escapeValue(tag,"<"+frag):preserve&&(result+=escapeComment("<"+frag)),result}function reject(frag,warn){return warn&&warn("malformed element: "+frag),preserve&&(result+="<!--<"+escapeComment(frag)+"-->"),result}function allowedValue(atb,val){if(urlAttributes.test(atb)){var colon=val.indexOf(":");if(colon<0||!allowedSchemes[val.substring(0,colon)])return!1}return!0}function escapeTag(tag,closing,atbs,autoClosed){if(closing){result+="</"+tag+">",atbs=atbs.trim(),preserve&&atbs&&(result+="<!--@"+escapeComment(atbs)+"-->");return}result+="<"+tag;var end=0,re=/^\s*(\w+)(?:\s*=\s*(?:(["'])(.*?)\2|()([\w_-]+)))?/,m;while(m=re.exec(atbs)){atbs=atbs.substring(m[0].length);var atb=m[1].toLowerCase(),quote=m[2]||'"',val=m[3]||m[5];if(!allowedAttributes[atb]||!allowedValue(atb,val)){warn&&warn("forbidden attribute: "+atb);if(!preserve)continue;atb="disabled-"+atb}result+=" "+atb+(val===undefined?"":"="+quote+escapeValue(atb,val)+quote)}autoClosed?result+="/>":result+=">",atbs=atbs.trim(),warn&&atbs&&warn("malformed attribute: "+atbs),preserve&&atbs&&(result+="<!--@"+escapeComment(atbs)+"-->")}var result="",inside="text";return function(frag){result="";if(inside==="comment")return skipTillMarker("<"+frag,"-->","");if(inside==="cdata")return skipTillMarker("<"+frag,"]]>","]]");if(inside==="script")return skipTillClosing(frag,"script");if(inside==="style")return skipTillClosing(frag,"style",allowedTags.style);if(/^!--/.test(frag))return inside="comment",preserve&&(result+="<!-- "),skipTillMarker(frag.substring(3),"-->","");if(/^!\[CDATA\[/.test(frag))return inside="cdata",warn&&warn("forbidden CDATA"),preserve&&(result+="<!--"),skipTillMarker(frag.substring(1),"]]>","]]");if(/^script\b/i.test(frag))return inside="script",warn&&warn("forbidden *** SCRIPT *** element"),preserve&&(result+="<!--"),skipTillClosing(frag,"script");if(/^style\b/i.test(frag))return inside="style",!allowedTags.style&&warn&&warn("forbidden STYLE element"),preserve&&!allowedTags.style&&(result+="<!--"),skipTillClosing(frag,"style",allowedTags.style);var end=frag.indexOf(">");if(end<0)return reject(frag,warn);var m=/^(\/?)(\w+)/.exec(frag);if(!m)return reject(frag,warn);var tag=m[2].toLowerCase();if(!allowedTags[tag])warn&&!m[1]&&warn("forbidden "+tag.toUpperCase()+" element"),preserve&&reject(frag.substring(0,end+1)),escapeText(frag.substring(0,end+1));else{var autoClosed=frag[end-1]==="/";escapeTag(tag,m[1],frag.substring(m[1].length+tag.length,autoClosed?end-1:end),autoClosed)}return result+=escapeText(frag.substring(end+1)),result}}options=fixOptions(options);var allowedTags=map(options.allowedTags),allowedAttributes=map(options.allowedAttributes),allowedSchemes=map(options.allowedSchemes),urlAttributes=/^(href|src|dynsrc|lowsrc|background)$/i,preserve=options.preserve,warn=options.warn;return options.streaming?function(){var process;return function(text){if(text.indexOf("<")>=0)throw new Error("internal error: bad HTML fragment");return process?process(text):(process=create(),escapeText(text))}}():function(text){var process=create(),frags=text.split("<"),result=escapeText(frags[0]);return frags.slice(1).reduce(function(r,frag){return r+process(frag)},result)}}}),define("syracuse-tablet/html/js/helpers/html-escape/lib/unescape",["require","exports","module"],function(require,exports,module){exports.unescaper=function(options){function uncomment(str){return str.replace(/__>/g,"-->")}function process(str){return str.replace(/disabled-(\w+=?)/g,"$1").replace(/(.?)<!--(.*?)-->/g,function(all,ch,commented){if(commented[0]===" ")return ch+"<!--"+commented.substring(1)+"-->";if(commented[0]==="[")return ch+"<!"+uncomment(commented)+">";if(commented[0]==="<")return ch+uncomment(commented);if(commented[0]==="@")return uncomment(commented.substring(1))+ch;throw new Error("cannot unescape: "+commented)})}options=options||{};if(options.streaming){var buf="";return function(str){if(str===undefined)return process(buf);var start=Math.max(0,buf.length-2);buf+=str;var end=buf.indexOf("-->",start);if(end<0)return"";var r=process(buf.substring(0,end+3));return buf=buf.substring(end+3),r}}return process}}),define("syracuse-tablet/html/js/helpers/html-escape/index",["require","exports","module","./lib/escape","./lib/unescape"],function(require,exports,module){exports.escaper=require("./lib/escape").escaper,exports.unescaper=require("./lib/unescape").unescaper}),define("syracuse-tablet/html/js/helpers/syracuse-rtf/lib/rtfparse",["require","exports","module"],function(require,exports,module){function builder(error){var group=[],stack=[group];return{open:function(){var g=[];group.push(g),stack.push(g),group=g},close:function(){stack.length<=1&&error("too many }"),group=stack.pop(),group=stack[stack.length-1]},text:function(str){group.push(str)},control:function(word,arg){var obj={word:word};arg!=null&&(obj.arg=arg),group.push(obj)},getResult:function(){return stack.length!==1&&error("missing }"),stack[0][0]}}}var lowerLetter={},digit={},LF="\n".charCodeAt(0),SP=" ".charCodeAt(0),BSLASH="\\".charCodeAt(0),OPEN="{".charCodeAt(0),CLOSE="}".charCodeAt(0),DASH="-".charCodeAt(0),QUOTE="'".charCodeAt(0),STAR="*".charCodeAt(0);(function(){function add(clas,chs,i){chs.split("").forEach(function(ch){clas[ch.charCodeAt(0)+(i||0)]=!0})}for(var i=0;i<=9;i++)add(digit,"0",i);for(var i=0;i<26;i++)add(lowerLetter,"a",i)})(),exports.parse=function(str){function error(msg){var end=str.indexOf(/[\n>]/,pos);return end<0&&(end=str.length),new Error("Invalid RTF: "+msg+" at line "+line+" near "+str.substring(pos,end))}function flush(){pos>begText&&bld.text(str.substring(begText,pos))}str=str.replace(/\r\n/g,"\n");var pos=0,begText=0,len=str.length,line=1,bld=builder(error);while(pos<len){var ch=str.charCodeAt(pos);switch(ch){case BSLASH:flush();var beg=++pos;while(lowerLetter[ch=str.charCodeAt(pos)])pos++;if(pos>beg){var word=str.substring(beg,pos),arg=undefined;if(ch===DASH||digit[ch]){beg=pos,pos++;while(digit[ch=str.charCodeAt(pos)])pos++;arg=parseInt(str.substring(beg,pos),10)}(ch===SP||ch===LF||word==="u"&&ch!==BSLASH&&ch!==OPEN&&ch!==CLOSE)&&pos++,bld.control(word,arg)}else if(ch===QUOTE){var symb=String.fromCharCode(parseInt(str.substring(pos+1,pos+3),16));bld.text(symb),pos+=3}else ch===STAR&&(bld.control("*"),pos++);begText=pos;break;case OPEN:flush(),bld.open(),begText=++pos;break;case CLOSE:flush(),bld.close(),begText=++pos;break;case LF:flush(),line++,begText=++pos;break;default:pos++}}return flush(),bld.getResult()}}),define("syracuse-tablet/html/js/helpers/syracuse-rtf/lib/rtfinterpret",["require","exports","module"],function(require,exports,module){exports.interpret=function(root){function interpretFont(features,index,fonts){var fname=features[0].word+features[0].arg,font=documentModel.fonts[fname]={};for(var i=1;i<features.length;i++)interpretFontFeature(features[i],font)}function interpretFontFeature(feature,font){var sep;typeof feature=="string"&&(sep=feature.indexOf(";"))>0&&(font.name=feature.substring(0,sep))}function interpretStylesheet(features,index,styles){var fname,style;if(features[0].word){fname=features[0].word+features[0].arg,style=documentModel.styles[fname]={};for(var i=1;i<features.length;i++)interpretStyleFeature(features[i],style)}}function interpretStyleFeature(feature,style){var sep;typeof feature=="string"&&(sep=feature.indexOf(";"))>0&&(style.name=feature.substring(0,sep))}function interpretControl(node,parent,index){switch(node.word){case"rtf":case"ansi":case"ansicpg":break;case"stylesheet":parent.slice(1).filter(function(item){return Array.isArray(item)}).forEach(interpretStylesheet);break;case"deff":documentModel.deffont="f"+node.arg;break;case"fonttbl":parent.slice(1).filter(function(item){return Array.isArray(item)}).forEach(interpretFont);break;case"colortbl":var i=1;parent[i]===";"&&(documentModel.colors.push([0,0,0]),i++);while(i<parent.length)documentModel.colors.push([parent[i].arg,parent[i+1].arg,parent[i+2].arg]),i+=4;break;case"*":supported.indexOf(parent[index+1].word)==-1&&parent.splice(index,parent.length-index)}}function interpretNode(node,index,array){Array.isArray(node)?node.forEach(interpretNode):typeof node=="object"&&interpretControl(node,array,index)}var group,documentModel={deffont:"",fonts:{},colors:[],styles:{}},fontfamgroups={fnil:"Sans-serif",froman:"Sans-serif",fswiss:"Serif",fmodern:"Monospace",fscript:"Cursive",fdecor:"Cursive"},supported=["rtf","ansi","ansicpg","deff","fonttbl","colortbl","stylesheet","fs","f","cf","highlight","i","b","ul","strike","plain","qc","ql","qr","qj","par","pard","pn"];return interpretNode(root),documentModel}}),define("syracuse-tablet/html/js/helpers/syracuse-rtf/lib/buildhtml",["require","exports","module"],function(require,exports,module){function rgbToHex(rgb){return rgb?toHex(rgb[0])+toHex(rgb[1])+toHex(rgb[2]):"000000"}function toHex(n){return("00"+n.toString(16)).slice(-2)}function twipsToPoint(t){return t/20}function indentCount(t){return t/600}function indentBulletCount(t){return t/420}function twipsToPixel(t){return t/15}function builder(documentModel){function newWorker(){return $current=$worker=$("<div>").addClass("s-rtf-worker").addClass("s-rtf-clean"),$worker.appendTo($section)}function newSection(){return $section=$("<div>").addClass("s-rtf-section").addClass("s-rtf-clean"),newWorker(),$section.appendTo($rootdiv)}function characterFormatting(node){switch(node.word){case"f":var fontface=rtffonts[node.word+node.arg].name;return $("<font face='"+fontface+"'>");case"fs":return $("<span style='font-size: "+node.arg/2+"pt;'>");case"tab":return $("<blockquote>");case"cf":case"highlight":return $("<span style='"+styleName[node.word]+": #"+rgbToHex(colors[node.arg])+";'>");case"b":return $("<b>");case"i":return $("<i>");case"ul":return $("<u>");case"strike":return $("<s>");default:}}function paragraphFormatting(elt,node){elt.addClass("s-rtf-format"),dirty();switch(node.word){case"ql":return elt.attr("align","left");case"qc":return elt.attr("align","center");case"qr":return elt.attr("align","right");case"qj":return elt.attr("align","justify");case"li":return node.arg>0?elt.css("margin-left",twipsToPoint(node.arg)+"pt"):elt;case"ri":return node.arg>0?elt.css("margin-right",twipsToPoint(node.arg)+"pt"):elt;default:return elt}}function dirty(){$worker&&$worker.removeClass("s-rtf-clean"),$section&&$section.removeClass("s-rtf-clean")}function append(elt){dirty(),$current.append(elt)}function wrapIn(elt){dirty(),$current=elt.appendTo($current)}var rtffonts=documentModel.fonts,deffont=documentModel.deffont,colors=documentModel.colors,styles=documentModel.styles,htmltext="",$rootdiv=$("<div>").addClass("s-rtf-root"),$current=null,$section=null,$worker=null,context;return newSection(),context=function(){function flattenFormat(){var f,fmt={};return stack.forEach(function(ctx){f=ctx.format,Object.keys(f).forEach(function(key){typeof fmt[key]=="undefined"&&(fmt[key]=f[key])})}),fmt}var stack=[{format:{}}],current=stack[0];return{open:function(){stack.push(current={format:{}})},close:function(idx,parent){stack.pop(),current=stack[stack.length-1],idx<parent.length-1&&(this.pending=!0)},update:function(prop,el){el===null?delete current.format[prop]:current.format[prop]=el},startOver:function(){if(!this.pending)return;var fmt=flattenFormat();Object.keys(fmt).forEach(function(key){$current=fmt[key].clone().appendTo($current)}),this.pending=!1}}}(),{text:function(str){dirty(),context&&context.startOver();var content=$current.html();$current.html(content+str)},open:function(){context.open()},close:function(idx,parent){$current=$worker,$current.length===0&&($current=$rootdiv),context.close(idx,parent)},control:function(node){switch(node.word){case"par":dirty(),$worker.removeClass("s-rtf-worker").addClass("s-rtf-paragraph"),$current=$worker=newWorker(),context&&(context.pending=!0);break;case"pard":$section.hasClass("s-rtf-clean")||($section=newSection(),context&&(context.pending=!0));break;case"pn":$section.addClass("s-rtf-list");break;case"u":this.unicodechar(node.arg);break;case"qc":case"ql":case"qr":case"qj":case"ri":paragraphFormatting($section,node);break;case"li":$section.hasClass("s-rtf-list")?$section.attr("indent",indentBulletCount(node.arg)):(!$section.hasClass("s-rtf-clean")&&!$section.hasClass("s-rtf-format")&&($section=newSection(),context&&(context.pending=!0)),$section.addClass("s-rtf-left-indent"),$section.attr("indent",indentCount(node.arg)));break;case"lquote":case"rquote":this.text("'");break;case"line":append("<br>");break;case"bullet":break;case"i":case"b":case"strike":case"ulnone":case"ul":if(node.arg===0||node.word==="ulnone"){var tagname;node.word==="strike"?tagname="s":node.word==="ulnone"?tagname="u":tagname=node.word;if($current.is(tagname))$current=$current.parent();else if($current.html()!==""){var tag=$current.closest(tagname);$current=tag.parent()}context.update(node.word,null);break};default:var el=characterFormatting(node);el&&(context.update(node.word,el.clone()),!context.pending&&wrapIn(el))}},unicodechar:function(code){dirty();var content=$current.html();$current.html(content+String.fromCharCode(code))},getHtml:function(){$rootdiv.find(".s-rtf-clean").remove();var sections=$rootdiv.find(".s-rtf-section.s-rtf-list");sections.map(function(i,e){var $e=$(e),i=parseInt($e.attr("indent"),10),w=[];while(w.length<i)w.push("<ul>");$e.wrap(w.join("")).contents()});var workers=sections.find(".s-rtf-paragraph");workers.wrap("<li>").contents().unwrap();var indent=$rootdiv.find(".s-rtf-section.s-rtf-left-indent").removeClass("s-rtf-left-indent");indent.map(function(i,e){var $e=$(e),i=parseInt($e.attr("indent"),10),w=[];while(w.length<i)w.push("<blockquote>");$e.wrap(w.join("")).contents(),$e.removeAttr("indent")}),sections=$rootdiv.find(".s-rtf-section"),sections.find(".s-rtf-paragraph").removeAttr("class").wrap("<p>").contents().unwrap(),sections.find("div:empty").remove(),sections.find(".s-rtf-worker:empty").remove(),sections.filter(":not(.s-rtf-format)").contents().unwrap();while($rootdiv.find("span:empty").length)$rootdiv.find("span:empty").remove();return $rootdiv.find(".s-rtf-worker").removeAttr("class").contents().unwrap(),$rootdiv.find(".s-rtf-format").removeAttr("class"),$rootdiv.html()}}}var styleName={cf:"color",highlight:"background-color"};exports.buildHtml=function(root,documentModel){function interpretNode(node,index,array){if(typeof node=="string"){bld.text(node);return}if(Array.isArray(node)&&node.length>0){if(node[0])switch(node[0].word){case"fonttbl":case"colortbl":case"stylesheet":case"pntxtb":case"pntext":case"pict":return}bld.open(),node.forEach(interpretNode),bld.close(index,array);return}typeof node=="object"&&bld.control(node)}var bld=builder(documentModel);return interpretNode(root,0,[]),root?bld.getHtml():"<div></div>"}}),define("syracuse-tablet/html/js/helpers/syracuse-rtf/lib/buildrtf",["require","exports","module"],function(require,exports,module){function colourNameToHex(color){return colors[color.toLowerCase()]}function rtfContext(){return{open:function(key){this[key]||(this[key]={},this[key].current=0),this[key].current++,this[key].pending=!0,this[key].value&&this[key].value[this[key].current-1]&&this[key].value.pop()},close:function(key){this[key].current--,this[key].current?this[key].pending=!0:this[key].pending=!1},current:function(key){return this[key]?this[key].current:0},pending:function(key,val){return val!==undefined&&(this[key]||(this[key]={}),this[key].pending=val),this[key]?this[key].pending:!1},value:function(key,val){return this[key]?(val!==undefined&&(val=parseInt(val,10),this[key].value===undefined&&(this[key].value=[]),this[key].value.push(this[key].current-1?this[key].value[this[key].current-2]+val:val)),this[key]&&this[key].value?this[key].value[this[key].current-1]:0):0},nl:!1,par:!1,ulindent:0}}function builder(documentModel){function has(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}function isEmpty(obj){if(obj==null)return!0;for(var key in obj)if(has(obj,key))return!1;return!0}function fromHtmlTag(tag){tag=tag.toLowerCase();switch(tag){case"p":return"\\par";case"b":return"\\b";case"i":return"\\i";case"u":return"\\ul";case"s":return"\\strike";case"br":return"\\par";case"blockquote":return"";default:return""}}var rtffonts=documentModel.fonts,colors=documentModel.colors,rtftext="",needSpace=!1,ctx=rtfContext();return isEmpty(rtffonts)||(rtftext+="{\\fonttbl",Object.keys(rtffonts).forEach(function(key){rtftext+="{\\"+key+" "+rtffonts[key].name+";}"}),rtftext+="}"),colors.length>1&&(rtftext+="{\\colortbl",colors.forEach(function(e){e[0]===0&&e[1]===0&&e[2]===0?rtftext+=";":rtftext+="\\red"+e[0]+"\\green"+e[1]+"\\blue"+e[2]+";"}),rtftext+="}"),rtftext+="\\uc0\\pard",{open:function(){rtftext+="{",needSpace=!1},text:function(str){var pos=0,beg=pos,c;while(pos<str.length){while(str.charCodeAt(pos)<=128&&str.charCodeAt(pos)!=10)pos++;pos>beg?rtftext+=(needSpace?" ":"")+str.substring(beg,pos):str.charCodeAt(pos)==10&&(rtftext+=needSpace?" ":""),needSpace=!1,pos<str.length&&(c=str.charCodeAt(pos),c===160||c===10?rtftext+=" ":this.controlarg("u",str.charCodeAt(pos)),pos++),beg=pos}},fragment:function(str){rtftext+=str,needSpace=!1},font:function(fid){fid!==""&&(rtftext+="\\"+fid,needSpace=!0)},controlarg:function(word,arg){rtftext+="\\"+word+arg,needSpace=!0},control:function(word){ctx.par=word=="par",rtftext+="\\"+word,needSpace=!0},htmltag:function(word){var rtf=fromHtmlTag(word);rtf&&(ctx.par=rtf=="\\par"),rtftext+=rtf,needSpace=!0},star:function(){rtftext+="\\*",needSpace=!1},close:function(){ctx.par||(rtftext+="\\par"),rtftext="{\\rtf1\\ansi"+rtftext+"}",needSpace=!1},getRtf:function(){return rtftext},context:ctx}}var colors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",window:"#ffffff",windowframe:"#000000",windowtext:"#000000"},tagMap={"margin-left":"li","margin-right":"ri","margin-top":"sb","margin-bottom":"sa"},toTwips=function(unit,v){var ratio={pt:20,px:15,mm:56.7,cm:567,"in":1440.18};return function(unit,v){return v*(ratio[unit]||ratio.px)}}();exports.buildRtf=function(html){function findColor(arr,obj){if(!obj)return-1;for(var i=0;i<arr.length;i++)if(arr[i][0]==obj[0]&&arr[i][1]==obj[1]&&arr[i][2]==obj[2])return i;return-1}function isLeftIndent(n){return $(n).is("div[style]")?$(n).attr("style").search("margin-left")>-1:!1}function addFont(face){rtffonts.indexOf(face)<0&&rtffonts.push(face)}function findFont(fontname){var fonts=documentModel.fonts,keys=Object.keys(fonts);for(var i=0;i<keys.length;i++)if(fonts[keys[i]].name===fontname)return keys[i];return""}function isList(n){return $(n).is("ul")||$(n).is("li")||n.childElementCount>0&&n.firstChild.nodeName==="UL"}function processNode(n,i){var clr,idx,colorid;bld.context.pending("blockquote")&&!bld.context.current("list")&&!$(n).is("blockquote")&&!$(n).is("div")&&!bld.context.current("list")&&!isList(n)&&(bld.control("li"+bld.context.current("blockquote")*600),bld.context.pending("blockquote",!1));if(n.nodeType===3)bld.text(n.nodeValue),bld.context.par=!1,n.nextSibling&&$(n.nextSibling).is("blockquote")&&bld.control("par");else if($(n).is("*[style]")&&!$(n).is("blockquote")){var rules=$(n).attr("style").split(";"),drill=!($(n).attr("style").search("text-align")>-1&&$(n).attr("style").search("margin-left")>-1),tal=null;n.nodeName=="B"&&bld.htmltag(n.nodeName),rules.forEach(function(e){var stylerule=e.split(":");stylerule[0]!=null&&(stylerule[0]=stylerule[0].replace(/^\s*/,"").replace(/\s*$/,"")),stylerule[1]!=null&&(stylerule[1]=stylerule[1].replace(/^\s*/,"").replace(/\s*$/,""));switch(stylerule[0]){case"color":stylerule[1].substring(0,3)==="rgb"?(clr=rgbColor(stylerule[1]),idx=findColor(documentModel.colors,clr)):idx=findColorInColortbl(stylerule[1]),colorid="cf",bld.controlarg(colorid,idx);break;case"background-color":stylerule[1].substring(0,3)==="rgb"?(clr=rgbColor(stylerule[1]),idx=findColor(documentModel.colors,clr)):idx=findColorInColortbl(stylerule[1]),colorid="highlight",bld.controlarg(colorid,idx);break;case"text-decoration":stylerule[1]==="underline"?bld.control("ul"):stylerule[1]==="line-through"&&bld.control("strike");break;case"font-style":stylerule[1]==="italic"&&bld.control("i");break;case"font-weight":stylerule[1]==="bold"&&bld.control("b");break;case"font-size":var tmp=$(n).attr("style"),m=/([0-9\.\-]+)([A-Za-z]*)/g.exec(stylerule[1]),unit=m[2]&&m[2].toLowerCase();if(unit!="em"){var points=parseFloat(stylerule[1]),halfpoints=Math.round(points*2);bld.controlarg("fs",halfpoints),bld.context.fs=!0}break;case"margin-left":var m=/([0-9\.\-]+)([A-Za-z]*)/g.exec(stylerule[1]),unit=m[2]&&m[2].toLowerCase()||"px",val=parseInt(m[1],10);if($(n).is("ul"))bld.context.ulindent=val/40,bld.context.open("list");else if($(n).is("div")||$(n).is("p"))bld.context.open("lindent"),bld.context.value("lindent",val),bld.controlarg(tagMap[stylerule[0]],toTwips(unit,bld.context.value("lindent"))),tal&&bld.control(align[tal]);drill&&($(n).contents().each(visit),n.nodeName==="P"?(bld.context.close("lindent"),bld.control("par")):n.nodeName==="DIV"&&bld.context.close("lindent"),bld.context.current("lindent")?bld.controlarg(tagMap[stylerule[0]],toTwips(unit,bld.context.value("lindent"))):bld.control("pard")),drill=!0;break;case"margin-right":case"margin-top":case"margin-bottom":var m=/([0-9\.\-]+)([A-Za-z]*)/g.exec(stylerule[1]),unit=m[2]&&m[2].toLowerCase()||"px",val=parseInt(m[1],10);bld.controlarg(tagMap[stylerule[0]],toTwips(unit,val)),$(n).contents().each(visit),n.nodeName==="P"&&bld.control("par"),bld.control("pard");break;case"margin":$(n).contents().each(visit),n.nodeName==="P"&&bld.control("par");break;case"text-align":if(drill){bld.control("pard");var alignment=stylerule[1];bld.control(align[alignment]),$(n).contents().each(visit),bld.control("par"),bld.control("pard")}else tal=stylerule[1];drill=!0}})}else if($(n).is("font")){if($(n).is("font[face]")){var face=$(n).attr("face");bld.font(findFont(face))}$(n).is("font[color]")&&(idx=findColorInColortbl($(n).attr("color")),colorid="cf",bld.controlarg(colorid,idx)),$(n).is("font[bgcolor]")&&(idx=findColorInColortbl($(n).attr("bgcolor")),colorid="highlight",bld.controlarg(colorid,idx)),$(n).is("font[size]")&&(idx=findFontSize($(n).attr("size")),bld.controlarg("fs",idx))}else if($(n).is("div[align]")){var alignment=$(n).attr("align");bld.control("pard"),bld.control(align[alignment]),$(n).contents().each(visit),n.childElementCount>0&&n.firstChild.nodeName==="P"||bld.control("par"),bld.control("pard")}else if(n.nodeName==="UL")bld.control("pard"),bld.context.open("list");else if(n.nodeName==="LI"){bld.fragment("{\\pntext"),bld.font(findFont("Symbol")),bld.fragment("\\'B7\\tab}");if(bld.context.pending("list")){var uls=bld.context.current("list")+bld.context.current("blockquote")+bld.context.ulindent;uls+=bld.context.current("lindent"),bld.fragment("{\\*\\pn\\pnlvlblt\\pnf1\\pnindent0{\\pntxtb\\'B7}}\\f0\\li"+uls*420),bld.context.ulindent=0,bld.context.pending("list",!1)}}else n.nodeName==="P"?bld.control("par"):bld.htmltag(n.nodeName)}function parseColor(color){var match=/#(..)(..)(..)/.exec(color)||/#(..)(..)(..)/.exec(colourNameToHex(color));return match&&match.slice(1).map(function(v){return parseInt(v,16)})}function findColorInColortbl(colorstr){var parsedclr=parseColor(colorstr),idx=findColor(documentModel.colors,parsedclr);return idx==-1?-1:idx}function findFontSize(size){return size=parseInt(size,10),size<0||size>7?0:[0,18,20,24,28,36,48,72][size]}function scan(n){if(!n)return;n.each(visit)}function processColor(coln,atb){coln.each(function(i,e){var tmp=$(e).attr(atb),rgb=parseColor(tmp);rgb&&findColor(documentModel.colors,rgb)==-1&&documentModel.colors.push(rgb)})}function processColorStyle(coln){var clr,idx;coln.each(function(i,e){var s=$(e).attr("style"),styles=s&&s.replace(/[\n\r]*\s*/g,"").split(";"),colorstyles=styles&&styles.filter(function(e){var rule=e.split(":");return rule[0]=rule[0].replace(/^\s*/,"").replace(/\s*$/,""),["color","background-color","background"].indexOf(rule[0])!=-1}),stylerule=colorstyles&&colorstyles[0]&&colorstyles[0].split(":");stylerule&&stylerule[1]&&(stylerule[1]=stylerule[1].replace(/^\s*/,"").replace(/\s*$/,""),stylerule[1].substring(0,3)==="rgb"?(clr=rgbColor(stylerule[1]),idx=findColor(documentModel.colors,clr)):(idx=findColorInColortbl(stylerule[1]),clr=parseColor(stylerule[1])),idx==-1&&clr&&documentModel.colors.push(clr))})}function extractFontsAndColors(){var fnts=$root.find("font[face]"),clrs=$root.find("font[color]"),bgclrs=$root.find("font[bgcolor]"),stylebgclrs=$root.find('*[style*="background-color"]'),styleclrs=$root.find('*[style*="color"]');addFont("MS Sans Serif"),fnts.each(function(i,e){addFont($(e).attr("face"))}),$root.find("ul").length>0&&addFont("Symbol"),processColor(clrs,"color"),processColor(bgclrs,"bgcolor"),processColorStyle(stylebgclrs),processColorStyle(styleclrs)}function rgbColor(colorString){var match=/\s*rgb\(\s*(\d+),\s*(\d+),\s*(\d+)\s*\);*/.exec(colorString);return match?match.slice(1).map(function(elt){return parseInt(elt,10)}):[]}function visit(i,e){var $e=$(e),$contents;if($e.is("blockquote"))bld.context.open("blockquote");else if($e.is("div[align]")||$e.is("*[style*=text-align]")||$e.is("*[style*=margin]")){processNode(e,i),e.nodeName==="UL"&&bld.control("pard");return}var grp,nl,sibling=e.nextSibling,crlf=e.nodeName==="P"&&e.childElementCount===1&&e.firstChild.nodeName==="BR";$contents=$e.contents(),!$e.is("blockquote")&&sibling&&sibling.nodeName==="DIV"&&!isLeftIndent(e)&&!isLeftIndent(sibling)?(!(sibling.childElementCount>0)||sibling.firstChild.nodeName!=="BR"&&sibling.firstChild.nodeName!=="P")&&!crlf&&(nl=!0):$contents.length>0&&sibling&&!$e.is("ul")&&!$e.is("li")&&!$e.is("blockquote")&&!$e.is("p")&&(grp=!0,bld.fragment("{"));if($e.is("p[align]")){var alignment=$e.attr("align");bld.control("pard"),bld.control(align[alignment])}$e.is("p")||processNode(e,i),$contents.each(visit),e.nodeName==="P"&&!nl&&!crlf&&processNode(e,i),(e.nodeName==="B"||$e.is("*[style*=font-weight]"))&&bld.control("b0"),(e.nodeName==="U"||$e.is("*[style*=text-decoration]"))&&bld.control("ul0"),$e.is("*[style*=font-size]")&&bld.context.fs&&(bld.context.fs=!1,grp||bld.control("fs16")),(e.nodeName==="I"||$e.is("*[style*=font-style]"))&&bld.control("i0"),$e.is("*[style*=color]")&&!$e.is("*[style*=background-color]")&&!grp&&bld.control("cf0"),e.nodeName==="UL"?(bld.context.close("list"),bld.control("pard"),bld.context.par=!0,bld.context.current("blockquote")&&bld.context.pending("blockquote",!0),bld.context.current("lindent")&&e.nextSibling&&e.nextSibling.nodeType===3&&bld.control("li"+toTwips("px",bld.context.value("lindent")))):$e.is("li")&&bld.control("par"),grp&&bld.fragment("}"),$e.is("blockquote")&&bld.context.current("blockquote")&&(bld.context.pending("blockquote")?(bld.context.close("blockquote"),!bld.context.current("blockquote")&&sibling&&!$(sibling).html()&&(bld.context.nl=!0)):(bld.context.par||bld.control("par"),bld.control("pard"),bld.context.close("blockquote")));if(nl||bld.context.nl)bld.context.nl=!1,bld.control("par")}function createFontTable(){var fname;for(var i=0;i<rtffonts.length;i++)fname="f"+i,documentModel.fonts[fname]={name:rtffonts[i]}}var documentModel={};documentModel.deffont="",documentModel.fonts={},documentModel.colors=[],documentModel.styles={};var fontfamgroups={fnil:"Sans-serif",froman:"Sans-serif",fswiss:"Serif",fmodern:"Monospace",fscript:"Cursive",fdecor:"Cursive"},align={left:"ql",center:"qc",right:"qr",justify:"qj"},pointPxTable=[{pt:6,px:7},{pt:7,px:9},{pt:40,px:50}],bld,$root=$("<div>").append(html),rtffonts=[];documentModel.colors.push([0,0,0]),extractFontsAndColors(),createFontTable(),bld=builder(documentModel),scan($root),bld.close();var rtftxt=bld.getRtf();return rtftxt}}),define("syracuse-tablet/html/js/helpers/syracuse-rtf/lib/index",["require","exports","module","./rtfparse","./rtfinterpret","./buildhtml","./buildrtf"],function(require,exports,module){var rtfParser=require("./rtfparse"),rtfInterpreter=require("./rtfinterpret"),htmlBuilder=require("./buildhtml"),rtfBuilder=require("./buildrtf");module.exports={toHtml:function(rtf,options){rtf=rtf||"";var root=rtfParser.parse(rtf),model=rtfInterpreter.interpret(root);return htmlBuilder.buildHtml(root,model)},fromHtml:function(html,options){return rtfBuilder.buildRtf(html)}}}),define("syracuse-tablet/html/js/helpers/syracuse-rtf/index",["require","exports","module","./lib/index"],function(require,exports,module){module.exports=require("./lib/index")}),define("syracuse-tablet/html/js/controls/field/ctrlText",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/controls/field/ctrlFieldBase","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/html-escape/index","syracuse-tablet/html/js/ajax/ajax","syracuse-tablet/html/js/helpers/syracuse-rtf/index","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/sdata/entities/clientContract"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),uiUtils=require("syracuse-tablet/html/js/ui/uiUtils"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),escaper=require("syracuse-tablet/html/js/helpers/html-escape/index").escaper({warn:console.warn.bind(console),allowedAttributes:["style"],allowedTags:["span"]}),ajax=require("syracuse-tablet/html/js/ajax/ajax").getAjax().ajax,rtf=require("syracuse-tablet/html/js/helpers/syracuse-rtf/index"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),_baseHeight=34,_Klass=utils.defineClass(function CtrlText(controller,article,prototype,options){options=options||{},options.nativeCapabilities=null,article&&!article.$labelPosition&&(article.$labelPosition="top"),Base.call(this,controller,article,prototype,options),this.cssType="s-m-clob s-m-"+this.$type.replace("/","-")},Base,{destroy:function(){$(this.$$input).off("keyup input"),Base.prototype.destroy.call(this)},_getHeightPixelValue:function(authH){switch(authH){case"medium":return 2*_baseHeight;case"large":return 4*_baseHeight;case"xlarge":return 8*_baseHeight;default:return _baseHeight}},buildFieldValue:function(parentSlot,buildOptions){var self=this;self.$$elmt.css("display","");var parent=Base.prototype.buildFieldValue.call(self,parentSlot,buildOptions),$$container=$('<section><div class="s-m-enriched-text"></div></section>').appendTo(parent).children(":first-child"),$$textContent=$(uiUtils.createDomElement("div",["s-m-enriched-text-content"],null,null,$$container));self.authH=self.getAuthoring("$textHeight","medium"),self.authH=self._getHeightPixelValue(self.authH);if(this.controller.$facet==="create"){$$textContent.html("&nbsp");return}var docUrl=self.prototype.data("$url",self.getDao())||"",deferred;clientContract.isLocalEntityUrl(docUrl)?deferred=$.smResolve(clientContract.callLocalEntityUrl(docUrl)):deferred=ajax("GET",docUrl,null,null,{noJsonParsing:!0}),deferred.then(function(result){if(self.destroyed)return;var responseText=result?result.responseText||"":"",empty=(responseText==null||responseText.length===0)&&!self.$isEditMode;self.$$elmt.toggleClass("s-m-empty",empty),self.asynchCheckEmptyValue(empty);if(empty){$$container.remove();return}var $$dataArr=[];switch(self.$type){case"text/plain":self.buildFieldFromPlain(responseText,$$textContent);break;case"text/html":self.buildFieldFromHtml(responseText,$$textContent);break;case"text/rtf":self.buildFieldFromRtf(responseText,$$textContent)}var lineheight=parseInt($$textContent.css("line-height").replace("px",""),10),multiplier=Math.floor(self.authH/lineheight);self.computedHeight=lineheight*multiplier,$$textContent.css({height:self.computedHeight+"px"}),self.appendExpander($$textContent)}).fail(function(e){self.insertError(e.message)})},onBlur:function(justCheck){var res=Base.prototype.onBlur.call(this,justCheck);return this.controller._gestureMgr&&!this.controller._gestureMgr.isNative()&&(this.controller._gestureMgr.$$elmt.parent().scrollTop(0),notifications.notifyController("sm.scroller.update",this.controller,!0)),res},checkEmptyValue:function(forceEmpty){return},asynchCheckEmptyValue:function(forceEmpty){Base.prototype.checkEmptyValue.call(this,forceEmpty)},appendExpander:function($$container){var self=this,scrollHeight=self.$$input?self.$$input.scrollHeight:$$container.get(0).scrollHeight;if(scrollHeight>self.computedHeight&&scrollHeight-self.computedHeight>5){var buttonTmpl='<a href="#" class="'+fontUtils.getIconByName("expand")+'" data-action="toggleText"				data-control-id="'+self.id+'" data-params="more"></a>',$$expander=self.$$expander=$(buttonTmpl);$$expander.insertBefore($$container),$$expander.css("float","right"),$$expander.wrap("<div class='s-m-enriched-text-expander'></div>"),$$expander.parent().height($$expander.outerHeight())}},insertError:function(msg){var err=['<span class="s-m-error"><p>'];err.push(msg),err.push("<p></span>"),$(err.join("")).appendTo(this.$$elmt)},buildFieldFromPlain:function(data,$$parent){var self=this;this.$isEditMode?(self.createMainInput($$parent,data,"textplain",{wrap:"soft",spellcheck:!1,autocorrect:"off",autocomplete:"off",style:"overflow-y:hidden;box-size:border-box;resize:none;width:100%;height:100%",row:"2"}),this.$$input.val(data),this.$$input.on("keyup input",function(){self._triggerResizeInput()})):$$parent.append($.parseHTML(escaper(data.replace(/\n/g,"<BR/>"))))},_triggerResizeInput:function(){var triggerResize=!1;this.$$expander&&this.$$expander.attr("data-params")==="more"&&(this._expandText(this.$$input.parent()),triggerResize=!0),this._resizeInput(),triggerResize&&uiUtils.triggerResizeInternal({preserveScroll:!0})},_resizeInput:function(options){if(!this.$$input)return!1;this.$$input.parent().css("height","auto"),this.$$input.css("height","auto");var domElmt=this.$$input.get(0),height=options&&options.height!=null?options.height:domElmt.scrollHeight+(domElmt.offsetHeight-domElmt.clientHeight);return this.$$input.css("height",height),!1},_expandText:function($textContent){$textContent.css({height:"auto"}),this.$$expander.toggleClass(fontUtils.getIconByName("expand"),!1),this.$$expander.toggleClass(fontUtils.getIconByName("compress"),!0),this.$$expander.attr("data-params","less")},_compressText:function($textContent){$textContent.css({height:this.computedHeight+"px"}),this.$$expander.toggleClass(fontUtils.getIconByName("compress"),!1),this.$$expander.toggleClass(fontUtils.getIconByName("expand"),!0),this.$$expander.attr("data-params","more")},_actToggleText:function(param){var $textContent=this.$$input?this.$$input.parent():this.$$elmt.find(".s-m-enriched-text-content");param==="more"?(this.currentHeight=null,this._expandText($textContent),this._resizeInput()):(this._compressText($textContent),this._resizeInput({height:"100%"})),uiUtils.triggerResizeInternal({preserveScroll:!0})},buildFieldFromRtf:function(data,$$parent){this.buildFieldFromHtml(rtf.toHtml(data),$$parent)},buildFieldFromHtml:function(data,$$parent){$$parent.append($.parseHTML(escaper(data)))}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/ctrlIcon",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/controls/ctrlBase"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),ctrlBase=require("syracuse-tablet/html/js/controls/ctrlBase"),Base=ctrlBase.Klass,_Klass=utils.defineClass(function CtrlIcon(controller,article,prototype){Base.call(this,controller,article,prototype)},Base,{buildHtml:function($$parent,controllerDao,buildOptions){var self=this;Base.prototype.buildHtml.call(self,$$parent,controllerDao,buildOptions,["s-m-icon"]),self.$$elmt.html(ctrlBase.genHtmlCtrlLink(self.prototype,controllerDao,{tag:"a",css:""},function(html){html.push('<span class="'),html.push(fontUtils.ctrlIcon(self.prototype.data("$icon"))),html.push('"></span>')}))}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/ctrlButton",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/controls/ctrlBase"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),ctrlBase=require("syracuse-tablet/html/js/controls/ctrlBase"),Base=ctrlBase.Klass,_Klass=utils.defineClass(function CtrlButton(controller,article,prototype){Base.call(this,controller,article,prototype)},Base,{buildHtml:function($$parent,controllerDao,buildOptions){var self=this;Base.prototype.buildHtml.call(self,$$parent,controllerDao,buildOptions,["s-m-btn"]),self.$$elmt.html(ctrlBase.genHtmlCtrlLink(self.prototype,controllerDao,{tag:"button",css:"btn btn-info btn-large"},function(html){var param=self.prototype.data("$icon")||"";param.length>0&&html.push('<i class="'+fontUtils.ctrlIcon(self.prototype.data("$icon"))+'"></i>'),param=self.prototype.data("$text")||"",param.length>0&&html.push(param)}))}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/chart/gaugeChartstheme",["require","exports","module"],function(require,exports,module){exports.ChartsTheme={colors:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:!0,canvasToolsURL:"http://code.highcharts.com/3.0.2/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/3.0.2/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:5,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacingTop:10,spacingRight:10,spacingBottom:15,spacingLeft:10,style:{fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif',fontSize:"12px"},backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",y:15,style:{color:"#666",fontSize:"16px"}},subtitle:{text:"",align:"center",y:30,style:{color:"#4d759e"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:{enabled:!0,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{enabled:!1,align:"center",x:0,y:0,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:"bottom"},cropThreshold:300,pointRange:0,showInLegend:!0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!0},area:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:{enabled:!0,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{enabled:!1,align:"center",x:0,y:0,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:"bottom"},cropThreshold:300,pointRange:0,showInLegend:!0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!0,threshold:0},spline:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:{enabled:!0,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{enabled:!1,align:"center",x:0,y:0,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:"bottom"},cropThreshold:300,pointRange:0,showInLegend:!0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!0},areaspline:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:{enabled:!0,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{enabled:!1,align:"center",x:0,y:0,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:"bottom"},cropThreshold:300,pointRange:0,showInLegend:!0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!0,threshold:0},column:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:null,point:{events:{}},dataLabels:{enabled:!1,align:null,x:0,y:null,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:null},cropThreshold:50,pointRange:null,showInLegend:!0,states:{hover:{marker:{},brightness:.1,shadow:!1},select:{marker:{},color:"#C0C0C0",borderColor:"#000000",shadow:!1}},stickyTracking:!1,borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:.2,pointPadding:.1,minPointLength:0,threshold:0},bar:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:null,point:{events:{}},dataLabels:{enabled:!1,align:null,x:0,y:null,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:null},cropThreshold:50,pointRange:null,showInLegend:!0,states:{hover:{marker:{},brightness:.1,shadow:!1},select:{marker:{},color:"#C0C0C0",borderColor:"#000000",shadow:!1}},stickyTracking:!1,borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:.2,pointPadding:.1,minPointLength:0,threshold:0},scatter:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:0,marker:{enabled:!0,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{enabled:!1,align:"center",x:0,y:0,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:"bottom"},cropThreshold:300,pointRange:0,showInLegend:!0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!1,tooltip:{headerFormat:'<span style="font-size: 10px; color:{series.color}">{series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>",followPointer:!0}},pie:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:null,point:{events:{}},dataLabels:{enabled:!0,align:"center",x:0,y:0,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:"bottom",distance:30},cropThreshold:300,pointRange:0,showInLegend:!1,states:{hover:{marker:{},brightness:.1,shadow:!1},select:{marker:{}}},stickyTracking:!1,borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,ignoreHiddenPoint:!0,legendType:"point",size:null,slicedOffset:10,tooltip:{followPointer:!0}},arearange:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:1,marker:null,point:{events:{}},dataLabels:{enabled:!1,align:"center",x:0,y:0,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0},cropThreshold:300,pointRange:0,showInLegend:!0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!0,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.low}</b> - <b>{point.high}</b><br/>'},trackByArea:!0},areasplinerange:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:1,marker:null,point:{events:{}},dataLabels:{enabled:!1,align:"center",x:0,y:0,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0},cropThreshold:300,pointRange:0,showInLegend:!0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!0,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.low}</b> - <b>{point.high}</b><br/>'},trackByArea:!0},columnrange:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:1,marker:null,point:{events:{}},dataLabels:{enabled:!1,align:"center",x:0,y:0,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0},cropThreshold:300,pointRange:null,showInLegend:!0,states:{hover:{marker:{},brightness:.1,shadow:!1},select:{marker:{},color:"#C0C0C0",borderColor:"#000000",shadow:!1}},stickyTracking:!0,borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:.2,pointPadding:.1,minPointLength:0,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.low}</b> - <b>{point.high}</b><br/>'},trackByArea:!0},gauge:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:{enabled:!0,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{enabled:!0,align:"center",x:0,y:5,style:{color:"#666",cursor:"default",fontSize:"16px",lineHeight:"24px",fontWeight:"normal"},verticalAlign:"top",borderWidth:0,borderColor:null,borderRadius:3,zIndex:2},cropThreshold:300,pointRange:0,showInLegend:!1,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!0,dial:{},pivot:{},tooltip:{style:{color:"#666"},headerFormat:""}},boxplot:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:1,marker:null,point:{events:{}},dataLabels:{enabled:!1,align:null,x:0,y:null,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:null},cropThreshold:50,pointRange:null,showInLegend:!0,states:{hover:{marker:{},brightness:-0.3,shadow:!1},select:{marker:{},color:"#C0C0C0",borderColor:"#000000",shadow:!1}},stickyTracking:!1,borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:.2,pointPadding:.1,minPointLength:0,threshold:null,fillColor:"#FFFFFF",medianWidth:2,tooltip:{pointFormat:'<span style="color:{series.color};font-weight:bold">{series.name}</span><br/>Minimum: {point.low}<br/>Lower quartile: {point.q1}<br/>Median: {point.median}<br/>Higher quartile: {point.q3}<br/>Maximum: {point.high}<br/>'},whiskerLength:"50%",whiskerWidth:2},errorbar:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:1,marker:null,point:{events:{}},dataLabels:{enabled:!1,align:null,x:0,y:null,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:null},cropThreshold:50,pointRange:null,showInLegend:!0,states:{hover:{marker:{},brightness:-0.3,shadow:!1},select:{marker:{},color:"#C0C0C0",borderColor:"#000000",shadow:!1}},stickyTracking:!1,borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:.2,pointPadding:.1,minPointLength:0,threshold:null,fillColor:"#FFFFFF",medianWidth:2,tooltip:{pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.low}</b> - <b>{point.high}</b><br/>'},whiskerLength:"50%",whiskerWidth:null,color:"#000000",grouping:!1,linkedTo:":previous"},waterfall:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:1,marker:null,point:{events:{}},dataLabels:{enabled:!1,align:null,x:0,y:null,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"},verticalAlign:null},cropThreshold:50,pointRange:null,showInLegend:!0,states:{hover:{marker:{},brightness:.1,shadow:!1},select:{marker:{},color:"#C0C0C0",borderColor:"#000000",shadow:!1}},stickyTracking:!1,borderColor:"#333",borderWidth:1,borderRadius:0,groupPadding:.2,pointPadding:.1,minPointLength:0,threshold:0,lineColor:"#333",dashStyle:"dot"},bubble:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:0,marker:{enabled:!0,lineWidth:1,radius:4,lineColor:null,states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{enabled:!1,align:"center",x:0,y:0,style:{color:"white",cursor:"default",fontSize:"11px",lineHeight:"14px",textShadow:"0px 0px 3px black"},verticalAlign:"middle",inside:!0},cropThreshold:300,pointRange:0,showInLegend:!0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!1,tooltip:{headerFormat:'<span style="font-size: 10px; color:{series.color}">{series.name}</span><br/>',pointFormat:"({point.x}, {point.y}), Size: {point.z}",followPointer:!0},minSize:8,maxSize:"20%",zThreshold:0}},labels:{style:{position:"absolute",color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",borderWidth:1,borderColor:"#909090",borderRadius:5,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{cursor:"pointer",color:"#274b6d",fontSize:"12px"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},symbolWidth:16,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"1em"},style:{position:"absolute",backgroundColor:"white",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:!0,backgroundColor:"rgba(255, 255, 255, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b><br/>',shadow:!0,snap:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",whiteSpace:"nowrap"}},credits:{enabled:!1,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}}}),define("syracuse-tablet/html/js/controls/field/ctrlGaugeChart",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/controls/field/ctrlFieldBase","syracuse-tablet/html/js/controls/chart/gaugeChartstheme"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),Base=require("syracuse-tablet/html/js/controls/field/ctrlFieldBase").Klass,chartsTheme=require("syracuse-tablet/html/js/controls/chart/gaugeChartstheme").ChartsTheme,_Klass=utils.defineClass(function CtrlGaugeChart(controller,article,prototype,options){options=options||{},options.nativeCapabilities=null,Base.call(this,controller,article,prototype,options)},Base,{_defaultGaugeSegments:[{propStart:0,propEnd:.25,valStart:null,valEnd:null,color:"#41A940"},{propStart:.25,propEnd:.75,valStart:null,valEnd:null,color:"#FF5800"},{propStart:.75,propEnd:1,valStart:null,valEnd:null,color:"#CB3500"}],buildFieldValue:function(fieldSlot,buildOptions){var self=this,localeDecimalSep=locale.getNumberDecimalSeparator(),localeThousandSep=locale.getNumberGroupSeparator();self.chartsTheme||(self.chartsTheme=chartsTheme);if(!self.chartsTheme.themeWasSet||self.chartsTheme.decimalPoint!==localeDecimalSep||self.chartsTheme.thousandsSep!==localeThousandSep)self.chartsTheme.decimalPoint=localeDecimalSep,self.chartsTheme.thousandsSep=localeThousandSep,Highcharts.setOptions(self.chartsTheme),self.chartsTheme.themeWasSet=!0;self._renderGauge()},checkEmptyValue:function(){return},buildFieldTitle:function(fieldSlot,buildOptions){},_resolveExpr:function(expr,data,cp){return typeof expr!="string"?expr:expr.replace(/\{(\w+)\}/g,function(d0,d1){return data[d1]!=null?data[d1]:cp[d1]!=null?cp[d1]:d0})},_mergeAuthoringAndDefaults:function(){var self=this,$gauge=self.article.$gauge;if(!$gauge.segments)return self._defaultGaugeSegments;if($gauge.segments.length===0)return self._defaultGaugeSegments;var s,def,auth,res=[];for(s=0;s<$gauge.segments.length;s++)def=self._defaultGaugeSegments[Math.min(s,self._defaultGaugeSegments.length-1)],auth=$gauge.segments[s],auth?((auth.propStart==null||auth.propEnd==null)&&(auth.valStart==null||auth.valEnd==null)&&(auth.propStart=def.propStart,auth.propEnd=def.propEnd,auth.valStart=def.valStart,auth.valEnd=def.valEnd),auth.color==null&&(auth.color=def.color),res.push(auth)):res.push(def);return res},_createBands:function(cp,valMin,valMax){var self=this,bands=[];bands.push({from:valMin,to:valMax,color:"#ccc",innerRadius:"79%",outerRadius:"101%"});var data=self.getValue(),bandsDef=self._mergeAuthoringAndDefaults(),seg,s,band,range=valMax-valMin;for(s=0;s<bandsDef.length;s++)seg=bandsDef[s],band={innerRadius:"79%",outerRadius:"101%",color:seg.color},seg.valStart!=null&&seg.valEnd!=null?(band.from=self._resolveExpr(seg.valStart,data,cp),band.to=self._resolveExpr(seg.valEnd,data,cp)):seg.propStart!=null&&seg.propEnd!=null&&(band.from=valMin+range*self._resolveExpr(seg.propStart,data,cp),band.to=valMin+range*self._resolveExpr(seg.propEnd,data,cp)),bands.push(band);return bands},_getScale:function(){function getScaleFromFormat($format){var match=$format.match(/\.(.*)/g);return match.length>=1?match.length:0}var self=this;return self.article.$scale?self.article.$scale:self.article.$format?getScaleFromFormat(self.article.$format):0},_renderGauge:function(){var self=this,$$chartSlot=$(".s-m-gauge-container",self.$$elmt);$$chartSlot&&$$chartSlot.length>0&&$$chartSlot.remove(),$$chartSlot=$("<div>").addClass("s-m-gauge-container"),self.$$elmt.append($$chartSlot);var gauge=self.article.$gauge,labelColor=self.$isEditMode?"#666":"#34B233",val=self.getValue(),valMin=0,valMax=100;gauge.$bindMin!=null&&gauge.$bindMax!=null&&(isNaN(gauge.$bindMin)?valMin=self.getDao().getValue(gauge.$bindMin):valMin=gauge.$bindMin,isNaN(gauge.$bindMax)?valMax=self.getDao().getValue(gauge.$bindMax):valMax=gauge.$bindMax);try{typeof val=="string"&&(val=parseFloat(val))}catch(e){}try{typeof valMin=="string"&&(valMin=parseFloat(valMin))}catch(e){}try{typeof valMax=="string"&&(valMax=parseFloat(valMax))}catch(e){}var cp=self.prototype.json,uom="";cp.$unit&&cp.$properties&&cp.$properties[cp.$unit]&&val&&val[cp.$unit]&&val[cp.$unit].$symbol&&(uom=val[cp.$unit].$symbol);var label=self.getTitle(),decimals=self._getScale(),plotBands=self._createBands(cp,valMin,valMax);self._calcDesiredHeight();var spacingBottom=35,height=self.desiredHeight,centerA="50%",centerB=(height-20)/height*100+"%",size=height-30;$$chartSlot.highcharts({chart:{type:"gauge",plotBackgroundColor:null,plotBackgroundImage:null,plotBorderWidth:0,plotShadow:!1,backgroundColor:null,height:height,borderWidth:0,spacingBottom:spacingBottom},title:{text:label,style:{color:labelColor,fontWeight:"normal",textTransform:"uppercase"},verticalAlign:"bottom",y:27},pane:{startAngle:-90,endAngle:90,center:[centerA,centerB],size:size,background:[{backgroundColor:"#FFF",borderWidth:0}]},yAxis:{min:valMin,max:valMax,minorTickWidth:1,minorTickInterval:"auto",minorTickLength:20,minorTickPosition:"inside",minorTickColor:"#fff",tickPixelInterval:30,tickWidth:0,tickPosition:"inside",tickLength:15,tickColor:"#FFF",labels:{step:1,rotation:"auto",style:{color:"#666",cursor:"default",fontSize:"0.9em",fontFamily:"Arial",lineHeight:"14px"},distance:10,y:0,verticalAlign:"center",align:"center"},title:{text:uom,style:{color:"#666"}},plotBands:plotBands},plotOptions:{gauge:{dataLabels:{enabled:!0,format:"{point.y:,."+decimals+"f}",style:{fontFamily:"Arial"}}}},exporting:{buttons:null},series:[{name:label,data:[val],tooltip:{valueSuffix:" "+uom}}]},function(){})},onResize:function(){var self=this;self._renderGauge()},_calcDesiredHeight:function(){var self=this,$$pscroll=self.$$elmt.closest(".s-m-scroll-wrapper"),isSingleChild=$(".s-m-control",$$pscroll).length<2,isInTile=$$pscroll.closest(".s-m-tile").length>0;if(isInTile&&isSingleChild){var $$tile=$$pscroll.parent();self.desiredHeight=$$tile.height()-20}else self.desiredHeight=200},destroy:function(){var self=this;Base.prototype.destroy.call(self);var $$chartSlot=$(".s-m-gauge-container",self.$$elmt);$$chartSlot&&$$chartSlot.length>0&&$$chartSlot.remove()}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/array/ctrlRowStatus",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/ctrlBase","syracuse-tablet/html/js/helpers/fieldOperators","syracuse-tablet/html/js/ui/fontUtils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/ctrlBase").Klass,fieldOperators=require("syracuse-tablet/html/js/helpers/fieldOperators"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),_Klass=utils.defineClass(function CtrlRowStatus(controller,article,prototype){Base.call(this,controller,article,prototype)},Base,{buildHtml:function($$parent,rowData,buildOptions){var self=this,ctrlArray=buildOptions.htmlRootCtrl;if(!ctrlArray)return;var statusInfo=ctrlArray.getRowStatusInfo();if(!statusInfo)return;Base.prototype.buildHtml.call(self,$$parent,rowData,buildOptions,["s-m-row-status"]);var h,defIcon=fontUtils.getArrayStatusDefIcon(),icon;statusInfo.list.some(function(s){if(s.color&&fieldOperators.evaluateOperator(s.$type,rowData.getValue(s.field),s.operator,s.value))return icon=s.icon||defIcon,self.$$elmt.html('<div class="'+icon.css+'" style="color:'+s.color.bgColor+'"/>'),!0})}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/array/ctrlRowIndex",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/controls/ctrlBase"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),Base=require("syracuse-tablet/html/js/controls/ctrlBase").Klass,_Klass=utils.defineClass(function CtrlRowStatus(controller,article,prototype){Base.call(this,controller,article,prototype)},Base,{buildHtml:function($$parent,rowData,buildOptions){Base.prototype.buildHtml.call(this,$$parent,rowData,buildOptions,["s-m-row-index"]),this.$$elmt.append('<span class="badge">'+this.getValue()+"</span>")}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/ctrlChartDetailToolbar",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/prototype","syracuse-tablet/html/js/controls/ctrlBase","syracuse-tablet/html/js/helpers/uiSettings","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),globals=require("syracuse-tablet/html/js/helpers/globals"),prototype=require("syracuse-tablet/html/js/helpers/prototype"),ctrlBase=require("syracuse-tablet/html/js/controls/ctrlBase"),uiSettings=require("syracuse-tablet/html/js/helpers/uiSettings"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),Base=ctrlBase.Klass,_actions=[{params:"arrayOnly",icon:"fa fa-table"},{params:"chartOnly",icon:"fa fa-bar-chart"},{params:"bothSideToSide",icon:"fa fa-columns"}],_chartStyle=[{params:"column",icon:"fa fa-bar-chart",enabled:!0},{params:"bar",icon:"fa fa-bar-chart fa-rotate-90",enabled:!0},{params:"area",icon:"fa fa-area-chart",enabled:!0},{params:"line",icon:"fa fa-line-chart",enabled:!0},{params:"pie",icon:"fa fa-pie-chart",enabled:!0}],_templates={toolbar:'		<div class="btn-toolbar" role="toolbar">			<div class="btn-group">				{{#each actions}}					<button type="button" class="btn btn-default" data-action="toolbar" data-control-id="{{../ctrlId}}" data-params="{{params}}"><span class="{{icon}}"></span></button>				{{/each}}		    </div>			<div class="btn-group chartstyles">				{{#each chartStyle}}					{{#if enabled}}					<button type="button" class="btn btn-default" data-action="chartstyle" data-control-id="{{../../ctrlId}}" data-params="{{params}}"><span class="{{icon}}"></span></button>					{{/if}}				{{/each}}		    </div>	    </div>'},_getHtml=function(name,ctx){var key=name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=_templates[key]=Handlebars.compile(_templates[name])),tmpl||alert("template "+name+" not found"),tmpl(ctx)},_Klass=utils.defineClass(function CtrlChartDetailToolbar($type,controller,options){Base.call(this,controller,{$bind:"chartDetailToolbar"},prototype.create({$type:$type}),options),notifications.subscribe(this,"sm.chartdetail.updt.toolbar")},Base,{buildHtml:function($$parent,controllerDao,buildOptions){this._height=uiSettings.getProp("chartDetailToolbar.height");var measureCount=this._getChartMeasureCount();_chartStyle.forEach(function(itm){itm.params=="pie"&&(itm.enabled=measureCount==1)}),Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions,[this.typeName]),this.$$elmt.html(_getHtml("toolbar",{ctrlId:this.id,actions:_actions,chartStyle:_chartStyle})),this.$$elmt.css("height",this._height)},_getChartMeasureCount:function(){var chart=this.controller.getChart();if(!chart)return 0;var count=chart.prototype.chartGetNbMeasures(),$seriesOptions=chart.article.$seriesOptions;return $seriesOptions?(Object.keys($seriesOptions).forEach(function(key){$seriesOptions[key].isHidden&&count--}),count):count},getHeight:function(){return this.$$elmt.is(":visible")?this._height:0},_actToolbar:function(display,$$target){if($$target.closest(".btn").is(".s-m-selected"))return;this.controller.actToolbarSetDisplay({display:display})},_actChartstyle:function(chartType,$$target){if($$target.closest(".btn").is(".s-m-selected"))return;this.controller.actToolbarSetDisplay({style:chartType,display:"bothSideToSide"})},notifChartdetailUpdtToolbar:function(opts){if(!opts)return;opts.display&&this._updateDisplay(opts.display,"toolbar"),opts.display&&this._updateDisplay(opts.style,"chartstyle")},_updateDisplay:function(display,dataAction){if(globals.isAuthoringActive())this.$$elmt.find(".btn").prop("disabled",!1);else{this.$$elmt.find('.btn[data-action="'+dataAction+'"]').removeClass("s-m-selected"),this.$$elmt.find('[data-params="'+display+'"][data-action="'+dataAction+'"]').addClass("s-m-selected");if(dataAction==="toolbar"){var $$chartStyles=this.$$elmt.find(".btn-group.chartstyles");display==="arrayOnly"?$$chartStyles.hide():$$chartStyles.show()}}}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/ctrlDashboardConfigHeader",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/controls/ctrlBase","syracuse-tablet/html/js/helpers/prototype","syracuse-tablet/html/js/helpers/uiSettings","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),locale=require("syracuse-tablet/html/js/helpers/locale"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),globals=require("syracuse-tablet/html/js/helpers/globals"),Base=require("syracuse-tablet/html/js/controls/ctrlBase").Klass,prototype=require("syracuse-tablet/html/js/helpers/prototype"),uiSettings=require("syracuse-tablet/html/js/helpers/uiSettings"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_templates={main:'			<div class="s-m-header {{deviceType}} s-m-dasboard-config">				<div class="s-m-header-title">					<input class="s-m-header-label" value="{{description}}">					{{#if template}}						<div class="s-m-dashboard-header-role-number">{{roleCount}}</div>					 <btn class="s-m-dashboard-header-btn-role fa fa-users" data-action="roleList">					{{/if}} 				</div>				<buttons class="pull-right dashboard-header-btn" style="width:{{rightBtnWidth}}px">					<button type="button" class="btn btn-default" style="display:{{displaySaveButton}}" data-action="{{buttonSaveAction}}" data-params="{{description}}">						<i class="fa fa-check"></i>					</button>					<button type="button" style="float:right" class="btn btn-danger" data-action="closeDashboardConfig">						<i class="fa fa-close"></i>					</button>				</buttons>			</div>'},_getHtml=function(type,name,ctx){type=type||"";var key=type+name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=type.length==0?_templates[name]:_templates[type][name],tmpl=_templates[key]=Handlebars.compile(tmpl)),tmpl(ctx)},_Klass=utils.defineClass(function ctrlDashboardConfigHeader($type,controller,options){options=options||{},Base.call(this,controller,{$bind:"header"},prototype.create({$type:$type}),options),notifications.subscribe(this,["sm.dashboard.state.change"]),notifications.subscribe(this,["sm.dashboard.roles.change"])},Base,{destroy:function(){$("input.s-m-header-label").off("change"),Base.prototype.destroy.call(this)},buildHtml:function($$parent,controllerDao,buildOptions){var self=this;buildOptions=buildOptions||{},Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions,[this.typeName]),this._$$parent=this.$$elmt.closest("header"),this._height=uiSettings.getProp("header.height"),this.$$elmt.css({height:this._height+"px"});var deviceType=globals.getSiteLayout().getDeviceType();this.$$header&&this.$$header.remove();var views=[],options=self.options;options.leftBtnWidth=this._height,options.rightBtnWidth=2*this._height,options.description=self.options.currentView.length>0?self.options.currentView[0].$description:"",options.deviceType=deviceType,options.buttonSaveAction=options.personal?"savePersonalDashboard":"saveTemplateDashboard",options.template=!options.personal,options.roleCount=options.roles.length,options.displaySaveButton="none",options.description=options.description||locale.text("welcome.mydashboard"),this.$$header=$(_getHtml(null,"main",options)),this.$$header.appendTo(this.$$elmt),$("input.s-m-header-label",this.$$elmt).on("change",jsutils.bindFn(this._titleChange,this))},_titleChange:function(){notifications.publish(["sm.dashboard.title.change"],$("input.s-m-header-label",this.$$elmt).val())},onMainPageResize:function(info,orientation){this._$$parent.css({width:info.contentWidth+"px"})},notifToggled:function(shown){},notifDashboardStateChange:function(data){data.dirty?$("[data-action='savePersonalDashboard'],[data-action='saveTemplateDashboard']",this.$$elmt).show():$("[data-action='savePersonalDashboard'],[data-action='saveTemplateDashboard']",this.$$elmt).hide()},notifDashboardRolesChange:function(roles){$(".s-m-dashboard-header-role-number",this.$$elmt).text(roles.length)},detach:function(){this.notifToggled(!1),this.$$elmt&&this.$$elmt.detach()},getHeight:function(){return this.$$elmt.is(":visible")?this._height:0}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/page/ctrlDashboardConfigFooter",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/uiSettings","syracuse-tablet/html/js/controls/ctrlBase","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/ui/fontUtils","syracuse-tablet/html/js/helpers/prototype","syracuse-tablet/html/js/helpers/notifications","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/controls/ctrlHelpers"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),uiSettings=require("syracuse-tablet/html/js/helpers/uiSettings"),Base=require("syracuse-tablet/html/js/controls/ctrlBase").Klass,globals=require("syracuse-tablet/html/js/helpers/globals"),fontUtils=require("syracuse-tablet/html/js/ui/fontUtils"),prototype=require("syracuse-tablet/html/js/helpers/prototype"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),locale=require("syracuse-tablet/html/js/helpers/locale"),ctrlHelpers=require("syracuse-tablet/html/js/controls/ctrlHelpers"),_templates={main:'		<div class="s-m-footer s-m-opened container-fluid {{deviceType}}">			{{{contentHtml}}}		</div>',tablet:{main:'			<div class="s-m-footer-left">				{{#if addGroup}}{{{addGroup}}}{{/if}}				{{#if dashboardList}}{{{dashboardList}}}{{/if}}			</div>		',action:'			<a href="#" class="s-m-link" style="display:{{display}}" data-action="{{action}}">				<i class="{{icon}}"/>				<span>{{{title}}}</span>			</a>'},smartphone:{main:'			<div class="s-m-footer-left">				{{#if addGroup}}{{{addGroup}}}{{/if}}				{{#if dashboardList}}{{{dashboardList}}}{{/if}}			</div>		',action:'			<a href="#" class="s-m-link" style="display:{{display}}" data-action="{{action}}">				<i class="{{icon}}"/>				<span>{{{title}}}</span>			</a>'}},_getHtml=function(type,name,ctx){type=type||"";var key=type+name+"compiled",tmpl=_templates[key];return tmpl||(tmpl=type.length==0?_templates[name]:_templates[type][name],tmpl=_templates[key]=Handlebars.compile(tmpl)),tmpl||alert("footer template "+name+" not found"),tmpl(ctx)},_Klass=utils.defineClass(function CtrlDashboardConfigFooter($type,controller,options){Base.call(this,controller,{$bind:"footer"},prototype.create({$type:$type}),options),notifications.subscribe(this,["sm.dashboard.state.change"])},Base,{destroy:function(){Base.prototype.destroy.call(this),notifications.unsubscribe(this)},getPageControlType:function(){return"footer"},buildHtml:function($$parent,controllerDao,buildOptions){buildOptions=buildOptions||{},Base.prototype.buildHtml.call(this,$$parent,controllerDao,buildOptions,[this.typeName]),this._$$parent=this.$$elmt.closest("footer"),this._build()},getActionController:function(){return this.controller},applyMetaData:function(metaData,buildOptions){return},onMainPageResize:function(info,orientation){var deviceType=globals.getSiteLayout().getDeviceType();this._build(deviceType),this.$$footer&&(this._$$parent.css({top:info.contentHeight-this._height+"px",width:info.contentWidth+"px"}),this._$$parent.show())},getHeight:function(){return this.$$elmt.is(":visible")?this._height:0},_build:function(deviceType){deviceType=deviceType||globals.getSiteLayout().getDeviceType();if(this._deviceType!=null&&this._deviceType===deviceType)return;this._deviceType=deviceType,this.$$footer&&(this.$$footer.remove(),this.$$footer=null),this._height=uiSettings.getProp("footer.height",deviceType),this._$$parent.css({left:"0px",height:this._height+"px",bottom:"0px",width:"100%"});var htmlCtx={};htmlCtx.addGroup=_getHtml(deviceType,"action",{action:"addGroup",icon:fontUtils.dashboardIcon("addGroup"),title:locale.text("welcome.dashboard.add.group"),display:""}),htmlCtx.dashboardList=_getHtml(deviceType,"action",{action:"templateList",icon:fontUtils.dashboardIcon("templateList"),title:locale.text("action.templateList"),display:this.options.views&&this.options.views.length>1?"":!1}),this.$$footer=$(_getHtml(null,"main",{contentHtml:_getHtml(deviceType,"main",htmlCtx),deviceType:deviceType})),this.$$footer.appendTo(this.$$elmt.show()),ctrlHelpers.checkLinkInitStatus(this)},notifDashboardStateChange:function(data){data.views&&data.views.length>1?$("[data-action='dashboardList']",this.$$elmt).show():$("[data-action='dashboardList']",this.$$elmt).hide()},notifToggled:function(shown){if(shown===!1){this._multiSelManager&&this._multiSelManager.disable();return}},detach:function(){this.notifToggled(!1),this.$$elmt&&this.$$elmt.detach()}});exports.Klass=_Klass}),define("syracuse-tablet/html/js/controls/ctrlFactoryDeps",["require","exports","module","syracuse-tablet/html/js/controls/field/ctrlAlphanum","syracuse-tablet/html/js/controls/field/ctrlAlphanum","syracuse-tablet/html/js/controls/field/ctrlFilter","syracuse-tablet/html/js/controls/field/ctrlAlphanum","syracuse-tablet/html/js/controls/field/ctrlAlphanum","syracuse-tablet/html/js/controls/field/ctrlProgress","syracuse-tablet/html/js/controls/field/ctrlNumeric","syracuse-tablet/html/js/controls/field/ctrlQuantity","syracuse-tablet/html/js/controls/field/ctrlCheckbox","syracuse-tablet/html/js/controls/field/ctrlSwitch","syracuse-tablet/html/js/controls/field/ctrlCombo","syracuse-tablet/html/js/controls/field/ctrlDate","syracuse-tablet/html/js/controls/array/ctrlArray","syracuse-tablet/html/js/controls/array/ctrlArrayChart","syracuse-tablet/html/js/controls/field/ctrlReference","syracuse-tablet/html/js/controls/layout/layoutRow","syracuse-tablet/html/js/controls/layout/layoutStack","syracuse-tablet/html/js/controls/layout/layoutTab","syracuse-tablet/html/js/controls/layout/layoutHub","syracuse-tablet/html/js/controls/layout/layoutHubGroup","syracuse-tablet/html/js/controls/layout/layoutTile","syracuse-tablet/html/js/controls/layout/layoutCell","syracuse-tablet/html/js/controls/vignetteBase","syracuse-tablet/html/js/controls/page/ctrlBreadCrumbs","syracuse-tablet/html/js/controls/page/ctrlPageHeader","syracuse-tablet/html/js/controls/page/ctrlPageFooter","syracuse-tablet/html/js/controls/page/ctrlVignetteFooter","syracuse-tablet/html/js/controls/page/ctrlVignetteHeader","syracuse-tablet/html/js/controls/page/panels/pageActionPanelRegular","syracuse-tablet/html/js/controls/page/panels/sortfilter/filterSortPanel","syracuse-tablet/html/js/controls/page/panels/pageSharePanel","syracuse-tablet/html/js/controls/page/panels/pageDashboardTemplatePanel","syracuse-tablet/html/js/controls/page/panels/pageTemplatePanel","syracuse-tablet/html/js/controls/page/panels/userPanelSmartphone","syracuse-tablet/html/js/controls/ctrlTypeUnknown","syracuse-tablet/html/js/controls/ctrlUnfound","syracuse-tablet/html/js/controls/field/ctrlImage","syracuse-tablet/html/js/controls/field/ctrlDocument","syracuse-tablet/html/js/controls/field/ctrlDocument","syracuse-tablet/html/js/controls/field/ctrlText","syracuse-tablet/html/js/controls/ctrlIcon","syracuse-tablet/html/js/controls/ctrlButton","syracuse-tablet/html/js/controls/field/ctrlGaugeChart","syracuse-tablet/html/js/controls/structElmt","syracuse-tablet/html/js/controls/array/ctrlRowStatus","syracuse-tablet/html/js/controls/array/ctrlRowIndex","syracuse-tablet/html/js/controls/page/ctrlChartDetailToolbar","syracuse-tablet/html/js/controls/ctrlFactory","syracuse-tablet/html/js/controls/page/ctrlDashboardConfigHeader","syracuse-tablet/html/js/controls/page/ctrlDashboardConfigFooter"],function(require,exports,module){var Alphanum=require("syracuse-tablet/html/js/controls/field/ctrlAlphanum").Klass,PhoneField=require("syracuse-tablet/html/js/controls/field/ctrlAlphanum").PhoneField,Filter=require("syracuse-tablet/html/js/controls/field/ctrlFilter").Klass,EmailField=require("syracuse-tablet/html/js/controls/field/ctrlAlphanum").EmailField,UrlField=require("syracuse-tablet/html/js/controls/field/ctrlAlphanum").UrlField,ProgressField=require("syracuse-tablet/html/js/controls/field/ctrlProgress").Klass,Numeric=require("syracuse-tablet/html/js/controls/field/ctrlNumeric").Klass,Quantity=require("syracuse-tablet/html/js/controls/field/ctrlQuantity").Klass,CheckBox=require("syracuse-tablet/html/js/controls/field/ctrlCheckbox").Klass,Switch=require("syracuse-tablet/html/js/controls/field/ctrlSwitch").Klass,Combo=require("syracuse-tablet/html/js/controls/field/ctrlCombo").Klass,Date=require("syracuse-tablet/html/js/controls/field/ctrlDate").Klass,Array=require("syracuse-tablet/html/js/controls/array/ctrlArray").Klass,ArrayChart=require("syracuse-tablet/html/js/controls/array/ctrlArrayChart").Klass,Reference=require("syracuse-tablet/html/js/controls/field/ctrlReference").Klass,LayoutRow=require("syracuse-tablet/html/js/controls/layout/layoutRow").Klass,LayoutStack=require("syracuse-tablet/html/js/controls/layout/layoutStack").Klass,LayoutTab=require("syracuse-tablet/html/js/controls/layout/layoutTab").Klass,LayoutHub=require("syracuse-tablet/html/js/controls/layout/layoutHub").Klass,LayoutHubGroup=require("syracuse-tablet/html/js/controls/layout/layoutHubGroup").Klass,LayoutTile=require("syracuse-tablet/html/js/controls/layout/layoutTile").Klass,LayoutCell=require("syracuse-tablet/html/js/controls/layout/layoutCell").Klass,Vignette=require("syracuse-tablet/html/js/controls/vignetteBase").Klass,BreadCrumbs=require("syracuse-tablet/html/js/controls/page/ctrlBreadCrumbs").Klass,PageHeader=require("syracuse-tablet/html/js/controls/page/ctrlPageHeader").Klass,PageFooter=require("syracuse-tablet/html/js/controls/page/ctrlPageFooter").Klass,VignetteFooter=require("syracuse-tablet/html/js/controls/page/ctrlVignetteFooter").Klass,VignetteHeader=require("syracuse-tablet/html/js/controls/page/ctrlVignetteHeader").Klass,PageActionPanelRegular=require("syracuse-tablet/html/js/controls/page/panels/pageActionPanelRegular").Klass,FilterSortPanel=require("syracuse-tablet/html/js/controls/page/panels/sortfilter/filterSortPanel").Klass,PageSharePanel=require("syracuse-tablet/html/js/controls/page/panels/pageSharePanel").Klass,PageDashboardTemplatePanel=require("syracuse-tablet/html/js/controls/page/panels/pageDashboardTemplatePanel").Klass,PageTemplatePanel=require("syracuse-tablet/html/js/controls/page/panels/pageTemplatePanel").Klass,UserPanelSmartphone=require("syracuse-tablet/html/js/controls/page/panels/userPanelSmartphone").Klass,TypeUnknown=require("syracuse-tablet/html/js/controls/ctrlTypeUnknown").Klass,FieldUnfound=require("syracuse-tablet/html/js/controls/ctrlUnfound").Klass,Image=require("syracuse-tablet/html/js/controls/field/ctrlImage").Klass,Document=require("syracuse-tablet/html/js/controls/field/ctrlDocument").Klass,Binary=require("syracuse-tablet/html/js/controls/field/ctrlDocument").Binary,EnrichedText=require("syracuse-tablet/html/js/controls/field/ctrlText").Klass,Icon=require("syracuse-tablet/html/js/controls/ctrlIcon").Klass,Button=require("syracuse-tablet/html/js/controls/ctrlButton").Klass,Gauge=require("syracuse-tablet/html/js/controls/field/ctrlGaugeChart").Klass,StructElmt=require("syracuse-tablet/html/js/controls/structElmt").Klass,FieldRowStatus=require("syracuse-tablet/html/js/controls/array/ctrlRowStatus").Klass,FieldRowIndex=require("syracuse-tablet/html/js/controls/array/ctrlRowIndex").Klass,ChartDetailToolbar=require("syracuse-tablet/html/js/controls/page/ctrlChartDetailToolbar").Klass,ctrlFactory=require("syracuse-tablet/html/js/controls/ctrlFactory"),DashboardConfigHeader=require("syracuse-tablet/html/js/controls/page/ctrlDashboardConfigHeader").Klass,DashboardConfigFooter=require("syracuse-tablet/html/js/controls/page/ctrlDashboardConfigFooter").Klass;exports.init=function(){ctrlFactory.setImpl("Alphanum",Alphanum),ctrlFactory.setImpl("PhoneField",PhoneField),ctrlFactory.setImpl("Filter",Filter),ctrlFactory.setImpl("EmailField",EmailField),ctrlFactory.setImpl("UrlField",UrlField),ctrlFactory.setImpl("ProgressField",EmailField),ctrlFactory.setImpl("Numeric",Numeric),ctrlFactory.setImpl("Quantity",Quantity),ctrlFactory.setImpl("CheckBox",CheckBox),ctrlFactory.setImpl("Switch",Switch),ctrlFactory.setImpl("Combo",Combo),ctrlFactory.setImpl("Date",Date),ctrlFactory.setImpl("Array",Array),ctrlFactory.setImpl("Reference",Reference),ctrlFactory.setImpl("LayoutRow",LayoutRow),ctrlFactory.setImpl("LayoutStack",LayoutStack),ctrlFactory.setImpl("LayoutTab",LayoutTab),ctrlFactory.setImpl("LayoutHub",LayoutHub),ctrlFactory.setImpl("LayoutHubGroup",LayoutHubGroup),ctrlFactory.setImpl("LayoutTile",LayoutTile),ctrlFactory.setImpl("LayoutCell",LayoutCell),ctrlFactory.setImpl("Vignette",Vignette),ctrlFactory.setImpl("BreadCrumbs",BreadCrumbs),ctrlFactory.setImpl("PageHeader",PageHeader),ctrlFactory.setImpl("PageFooter",PageFooter),ctrlFactory.setImpl("VignetteFooter",VignetteFooter),ctrlFactory.setImpl("VignetteHeader",VignetteHeader),ctrlFactory.setImpl("PageActionPanelRegular",PageActionPanelRegular),ctrlFactory.setImpl("UserPanelSmartphone",UserPanelSmartphone),ctrlFactory.setImpl("FilterSortPanel",FilterSortPanel),ctrlFactory.setImpl("PageSharePanel",PageSharePanel),ctrlFactory.setImpl("PageTemplatePanel",PageTemplatePanel),ctrlFactory.setImpl("PageDashboardTemplatePanel",PageDashboardTemplatePanel),ctrlFactory.setImpl("TypeUnknown",TypeUnknown),ctrlFactory.setImpl("FieldUnfound",FieldUnfound),ctrlFactory.setImpl("ArrayChart",ArrayChart),ctrlFactory.setImpl("Binary",Binary),ctrlFactory.setImpl("Image",Image),ctrlFactory.setImpl("Document",Document),ctrlFactory.setImpl("Text",EnrichedText),ctrlFactory.setImpl("Icon",Icon),ctrlFactory.setImpl("Gauge",Gauge),ctrlFactory.setImpl("Button",Button),ctrlFactory.setImpl("StructElmt",StructElmt),ctrlFactory.setImpl("FieldRowStatus",FieldRowStatus),ctrlFactory.setImpl("FieldRowIndex",FieldRowIndex),ctrlFactory.setImpl("ChartDetailToolbar",ChartDetailToolbar),ctrlFactory.setImpl("DashboardConfigHeader",DashboardConfigHeader),ctrlFactory.setImpl("DashboardConfigFooter",DashboardConfigFooter)}}),define("syracuse-tablet/html/js/sdata/sdataSort",["require","exports","module"],function(require,exports,module){function _sdataSortArray(data,proto,orderBy){var comparators=[],properties=proto.$properties.$resources&&proto.$properties.$resources.$item&&proto.$properties.$resources.$item.$properties||proto.$properties;orderBy.forEach(function(exp){var prop=exp.property,sort=exp.sort==="DESC"||exp.sort==="desc"?"DESC":"ASC",type=properties[prop]&&properties[prop].$type||"application/x-string";if(type==="application/x-decimal"){if(sort==="ASC"){try{comparators.push(function(a,b){var vala=a[prop],valb=b[prop];return+vala- +valb})}catch(e){}return 0}try{comparators.push(function(a,b){var vala=a[prop],valb=b[prop];return+valb- +vala})}catch(e){}return 0}sort==="ASC"?comparators.push(function(a,b){try{var vala=a[prop],valb=b[prop];if(vala>valb)return 1;if(vala<valb)return-1}catch(e){}return 0}):comparators.push(function(a,b){try{var vala=a[prop],valb=b[prop];if(vala>valb)return-1;if(vala<valb)return 1}catch(e){}return 0})}),data.sort(function(a,b){var c=0;for(var i=0;i<comparators.length;i++){c=comparators[i](a,b);if(c!==0)break}return c})}exports.sdataSortArray=_sdataSortArray}),define("syracuse-tablet/html/js/sdata/sdataCache",["require","exports","module","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/storage/storage","syracuse-tablet/html/js/sdata/sdatawhere/parser","syracuse-tablet/html/js/sdata/sdatawhere/whereUtils","syracuse-tablet/html/js/sdata/sdataSort","syracuse-tablet/html/js/storage/localStorage"],function(require,exports,module){function _SDataCache(storage){this.storage=storage,this.context=null}var log=require("syracuse-tablet/html/js/helpers/logger").getLogger("SDataCache"),globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),storageModule=require("syracuse-tablet/html/js/storage/storage"),parser=require("syracuse-tablet/html/js/sdata/sdatawhere/parser").Parser,whereUtils=require("syracuse-tablet/html/js/sdata/sdatawhere/whereUtils"),sdataSort=require("syracuse-tablet/html/js/sdata/sdataSort"),localStorage=require("syracuse-tablet/html/js/storage/localStorage"),_cachePrefix="$cache_",_keyRegExp=/\{(.*?)\}/g,_SDataCacheClass=utils.defineClass(_SDataCache,null,{setContext:function(context){log&&log("Changing cache context: "+JSON.stringify(context)),this.context=context},cachePrefix:_cachePrefix,put:function(data){var deferred=$.Deferred(),self=this;try{if(!data.$data)throw new Error("PUT: No data specified");var repr,key;if(data.$proto){var $proto=self._getProto(data.$proto);repr=self._getRepresentation($proto),key=self._getKeyValue(data.$data,$proto)}else{if(!data.$representation||!data.$key)throw new Error("PUT: Neither proto nor representation and key specified");repr=data.$representation,key=data.$key}self.storage.put({$context:self.context,$collection:_cachePrefix+repr,$endpoint:data.$endpoint,$key:key,$data:{$item:data.$data}}).then(function(result){deferred.resolve()}).fail(function(error){deferred.reject(error)})}catch(e){deferred.reject(e)}finally{return deferred.promise()}},query:function(data){var deferred=$.Deferred(),self=this;try{var repr;log&&log("Query by: "+JSON.stringify(data));if(data.$proto){var $proto=self._getProto(data.$proto);repr=self._getRepresentation($proto)}else{if(!data.$representation)throw new Error("QUERY: Neither proto nor representation specified");if(data.$where)throw new Error("QUERY: Where clause parsing requires prototype");if(data.$orderBy)throw new Error("QUERY: Order by requires prototype");repr=data.$representation}self.storage.query({$context:self.context,$endpoint:data.$endpoint,$collection:_cachePrefix+repr}).then(function(result){var res=[];if(data.$where){var exp=parser.parse(data.$where);result.$data.forEach(function(item,i){if(whereUtils.execWhere(item.$item,exp,$proto)){var d=item.$item,m=result.$metaData[i];d.$cache={$lastRead:m.$lastRead,$lastUpdated:m.$lastUpdated},res.push(d)}})}else result.$data.forEach(function(item,i){var d=item.$item,m=result.$metaData[i];d.$cache={$lastRead:m.$lastRead,$lastUpdated:m.$lastUpdated},res.push(d)});data.$orderBy&&sdataSort.sdataSortArray(res,$proto,data.$orderBy),deferred.resolve(res)}).fail(function(error){deferred.reject(error)})}catch(e){deferred.reject(e)}finally{return deferred.promise()}},read:function(data){var deferred=$.Deferred(),self=this;try{var repr;if(!data.$key)throw new Error("READ: No key specified");if(data.$proto){var $proto=self._getProto(data.$proto);repr=self._getRepresentation($proto)}else{if(!data.$representation)throw new Error("READ: Neither proto nor representation specified");repr=data.$representation}self.storage.read({$context:self.context,$collection:_cachePrefix+repr,$endpoint:data.$endpoint,$key:data.$key}).then(function(result){if(result.$status===storageModule.StatusCodes.OK){var res=result.$data.$item;res.$cache={$lastRead:result.$metaData.$lastRead,$lastUpdated:result.$metaData.$lastUpdated},deferred.resolve(res)}else deferred.resolve(null)}).fail(function(error){deferred.reject(error)})}catch(e){deferred.reject(e)}finally{return deferred.promise()}},remove:function(data){var deferred=$.Deferred(),self=this;try{var repr;if(!data.$key)throw new Error("REMOVE: No key specified");if(data.$proto){var $proto=self._getProto(data.$proto);repr=self._getRepresentation($proto)}else{if(!data.$representation)throw new Error("READ: Neither proto nor representation specified");repr=data.$representation}self.storage.remove({$context:self.context,$collection:_cachePrefix+repr,$endpoint:data.$endpoint,$key:data.$key}).then(function(){deferred.resolve()}).fail(function(error){deferred.reject(error)})}catch(e){deferred.reject(e)}finally{return deferred.promise()}},clearCache:function(options){var deferred=$.Deferred(),self=this,re=new RegExp(self.cachePrefix.replace(/([\$\_]+)/g,"\\$1")),opts={$context:self.context,$collection:re};options&&options.$not_read_since&&(opts.$not_read_since=options.$not_read_since);try{self.storage.clearCollection(opts).then(function(){deferred.resolve()}).fail(function(error){deferred.reject(error)})}catch(e){deferred.reject(e)}finally{return deferred.promise()}},computeCacheSize:function(options){var deferred=$.Deferred(),self=this,re=new RegExp(self.cachePrefix.replace(/([\$\_]+)/g,"\\$1")),opts={$context:self.context,$collection:re};options&&options.$not_read_since&&(opts.$not_read_since=options.$not_read_since);try{self.storage.computeCollectionSize(opts).then(function(result){deferred.resolve(result)}).fail(function(error){deferred.reject(error)})}catch(e){deferred.reject(e)}finally{return deferred.promise()}},_getProto:function(proto){var itemProto=proto.$properties.$resources&&proto.$properties.$resources.$item||proto;return itemProto.$type=proto.$type,itemProto},_getRepresentation:function(proto){return proto.$type.split(".").slice(1,3).join(".").replace("$queryItem","$query")},_getKeyValue:function(data,proto){return proto.$key.replace(_keyRegExp,function(m,p){return data[p]})},disableCache:function(isDisabled){globals.isDvlpMode()&&localStorage.setItem("s.m.cache.disabled",isDisabled),this._isDisabled=isDisabled},isDisabled:function(){return this._isDisabled==null&&(globals.isDvlpMode()?(this._isDisabled=localStorage.getItem("s.m.cache.disabled"),this._isDisabled=this._isDisabled===!0||this._isDisabled==="true"):this._isDisabled=!1),this._isDisabled}});exports.SDataCache=_SDataCacheClass}),define("syracuse-tablet/html/js/helpers/siteLayout",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/notifications"],function(require,exports,module){function _getWindowOrientation(){var width=$(window).width(),height=$(window).height(),ratio=width/height;return ratio<1?"portrait":"landscape"}function _layoutMainContainers(resizeEvt,opts){var firstCall=_lastUserAgent==null;_lastUserAgent==null&&(_lastUserAgent=navigator.userAgent.toLowerCase()),opts=opts||{},opts.resizeEvent=resizeEvt,opts.layout&&(_layoutParameters=$.extend(!0,{},_layoutParameters,opts.layout));var width=$(window).width(),height=$(window).height(),appClass=null,authPanelRightWidth=0,authPanelLeftWidth=0,authPanelHeaderHeight=0,authPanelFooterHeight=0,authPanelRightSplitterWidth=0,authPanelLeftSplitterWidth=0,$$authRight=$("#s-m-auth-panel-right-id"),$$authLeft=$("#s-m-auth-panel-left-id"),$$app=$("#s-m-app-id"),$$appContainer=$("#s-m-app-container-id");_internalParameters=$.extend(!0,{},_layoutParameters);var pageParams=_internalParameters.pageParameters;_internalParameters.authPanelRight.visible&&(authPanelRightWidth=_internalParameters.authPanelRight.width,authPanelRightSplitterWidth=_internalParameters.authPanelRight.splitterWidth,_layoutAuthPanelRight(width,height),pageParams.forcePreview=!0),_internalParameters.authPanelLeft.visible&&(authPanelLeftWidth=_internalParameters.authPanelLeft.width,authPanelLeftSplitterWidth=_internalParameters.authPanelLeft.splitterWidth,_layoutAuthPanelLeft(width,height),pageParams.forcePreview=!0),_internalParameters.authPanelHeader.visible&&(authPanelHeaderHeight=_internalParameters.authPanelHeader.height,_layoutAuthPanelHeader(width,height)),_internalParameters.authPanelFooter.visible&&(authPanelFooterHeight=_internalParameters.authPanelFooter.height,_layoutAuthPanelFooter(width,height));var applicationWidth=width-authPanelRightWidth-authPanelRightSplitterWidth-authPanelLeftWidth-authPanelLeftSplitterWidth,applicationHeight=height-authPanelHeaderHeight-authPanelFooterHeight,appView,forcePreview=pageParams.forcePreview===!0;$$app.parent().is(".s-m-device-wrapper")&&$$app.unwrap();if(forcePreview&&globals.isDesktop()){var template=pageParams.device?_deviceSizes[pageParams.device]:null;template||(template=_deviceSizes.nexus10);var wrapBorder=15;appView={left:0,top:0,width:pageParams.orientation==="landscape"?template.width:template.height,height:pageParams.orientation==="landscape"?template.height:template.width};var wrapH=appView.height+2*wrapBorder,wrapW=appView.width+2*wrapBorder;pageParams.forceAutoScale&&(pageParams.scale=Math.min(Math.min(applicationWidth/wrapW,applicationHeight/wrapH),1)),appView.left=Math.max((applicationWidth-wrapW*pageParams.scale)/2,0),appView.top=Math.max((applicationHeight-wrapH*pageParams.scale)/2,0),appClass=template.bootstrapTweakClass[pageParams.orientation];var $$wrapper=$('<section class="s-m-device-wrapper"></section>"'),wrapCss={top:appView.top+"px",left:appView.left+"px",width:wrapW+"px",height:wrapH+"px"};pageParams.scale!==1&&(wrapCss.transform="scale("+pageParams.scale+", "+pageParams.scale+")",wrapCss["transform-origin"]="left top"),$$wrapper.css(wrapCss),$$app.wrap($$wrapper),$$app.css({top:wrapBorder+"px",left:wrapBorder+"px",width:appView.width+"px",height:appView.height+"px",position:"absolute"})}else appView={left:0,top:0,width:applicationWidth,height:applicationHeight},pageParams.orientation=_currentOrientation,$$app.css({top:appView.top,left:appView.left,width:appView.width,height:appView.height});$$app.removeClass(_bootstrapTweakClasses.join(" ")),appClass&&$$app.addClass(appClass),$$appContainer.css({top:authPanelHeaderHeight,left:authPanelLeftWidth+authPanelLeftSplitterWidth,width:applicationWidth,height:applicationHeight}),$$appContainer.toggleClass("s-m-preview",forcePreview);var info={updateLayout:!0,application:appView,authoringUpdate:opts.authoringUpdate===!0,preserveScroll:opts.preserveScroll===!0||opts.authoringUpdate===!0,afterMainPageLoaded:opts.afterMainPageLoaded===!0};opts.resizeEvent&&(info.resizeEvent=opts.resizeEvent),info.orientationChanged=opts.orientationChanged,info.deviceChanged=opts.deviceChanged,globals.isAutoUITestMode()&&(firstCall||info.orientationChanged||info.deviceChanged)&&globals.getUnitTestMgr().notifDeviceChanged(_getDeviceType(),pageParams.orientation),notifications.publish("sm.main.layout.changed",info,pageParams.orientation,_getDeviceType())}function _layoutAuthPanelRight(width,height){var $$auth=$("#s-m-auth-panel-right-id"),$$splitter=$("#s-m-auth-splitter-right-id"),authPanelHeaderHeight=0,authPanelFooterHeight=0;_internalParameters.authPanelHeader.visible&&(authPanelHeaderHeight=_internalParameters.authPanelHeader.height),_internalParameters.authPanelFooter.visible&&(authPanelFooterHeight=_internalParameters.authPanelFooter.height),$$auth.css({left:width-_internalParameters.authPanelRight.width,top:authPanelHeaderHeight,width:_internalParameters.authPanelRight.width,height:height-authPanelHeaderHeight-authPanelFooterHeight}),$$splitter.css({left:width-_internalParameters.authPanelRight.width-_internalParameters.authPanelRight.splitterWidth,top:authPanelHeaderHeight,width:_internalParameters.authPanelRight.splitterWidth,height:height-authPanelHeaderHeight-authPanelFooterHeight})}function _layoutAuthPanelLeft(width,height){var $$auth=$("#s-m-auth-panel-left-id"),$$splitter=$("#s-m-auth-splitter-left-id"),authPanelHeaderHeight=0,authPanelFooterHeight=0;_internalParameters.authPanelHeader.visible&&(authPanelHeaderHeight=_internalParameters.authPanelHeader.height),_internalParameters.authPanelFooter.visible&&(authPanelFooterHeight=_internalParameters.authPanelFooter.height),$$auth.css({left:0,top:authPanelHeaderHeight,width:_internalParameters.authPanelLeft.width,height:height-authPanelHeaderHeight-authPanelFooterHeight}),$$splitter.css({left:_internalParameters.authPanelLeft.width,top:authPanelHeaderHeight,width:_internalParameters.authPanelLeft.splitterWidth,height:height-authPanelHeaderHeight-authPanelFooterHeight})}function _layoutAuthPanelHeader(width,height){var $$auth=$("#s-m-auth-panel-header-id");$$auth.css({left:0,top:0,width:width,height:_internalParameters.authPanelHeader.height,overflow:"hidden"})}function _layoutAuthPanelFooter(width,height){var $$auth=$("#s-m-auth-panel-footer-id");$$auth.css({left:0,top:height-_internalParameters.authPanelFooter.height,width:width,height:_internalParameters.authPanelFooter.height})}var globals=require("syracuse-tablet/html/js/helpers/globals"),notifications=require("syracuse-tablet/html/js/helpers/notifications"),_internalParameters,_lastWindowWidth,_lastWindowHeight;$(function(){_lastWindowWidth=$(window).width(),_lastWindowHeight=$(window).height()});var _getCurrentDeviceType=function(){var currentDeviceType,a=navigator.userAgent.toLowerCase();return a.indexOf("iphone")>=0?currentDeviceType="smartphone":a.indexOf("ipad")>=0?currentDeviceType="tablet":a.indexOf("mobile")>=0?currentDeviceType="smartphone":currentDeviceType="tablet",currentDeviceType},_deviceSizes={nexus5:{width:640,height:360,bootstrapTweakClass:{portrait:"s-m-auth-col-simulate-xs",landscape:"s-m-auth-col-simulate-sm"},deviceType:"smartphone",orientations:["portrait","landscape"]},nexus7:{width:960,height:600,bootstrapTweakClass:{portrait:"s-m-auth-col-simulate-sm",landscape:"s-m-auth-col-simulate-md"},deviceType:"tablet",orientations:["portrait","landscape"]},nexus10:{width:1280,height:800,bootstrapTweakClass:{portrait:"s-m-auth-col-simulate-sm",landscape:"s-m-auth-col-simulate-lg"},deviceType:"tablet",orientations:["portrait","landscape"]},ipad:{width:1024,height:768,bootstrapTweakClass:{portrait:"s-m-auth-col-simulate-sm",landscape:"s-m-auth-col-simulate-lg"},deviceType:"tablet",orientations:["portrait","landscape"]},iphone4:{width:480,height:320,bootstrapTweakClass:{portrait:"s-m-auth-col-simulate-xs",landscape:"s-m-auth-col-simulate-xs"},deviceType:"smartphone",orientations:["portrait","landscape"]},iphone5:{width:568,height:320,bootstrapTweakClass:{portrait:"s-m-auth-col-simulate-xs",landscape:"s-m-auth-col-simulate-xs"},deviceType:"smartphone",orientations:["portrait","landscape"]},iphone6:{width:667,height:375,bootstrapTweakClass:{portrait:"s-m-auth-col-simulate-xs",landscape:"s-m-auth-col-simulate-sm"},deviceType:"smartphone",orientations:["portrait","landscape"]},iphone6plus:{width:960,height:540,bootstrapTweakClass:{portrait:"s-m-auth-col-simulate-xs",landscape:"s-m-auth-col-simulate-md"},deviceType:"smartphone",orientations:["portrait","landscape"]}},_bootstrapTweakClasses=["s-m-auth-col-simulate-xs","s-m-auth-col-simulate-sm","s-m-auth-col-simulate-md","s-m-auth-col-simulate-lg"],_currentOrientation=_getWindowOrientation(),_splitterWidth=15,_layoutParameters={authPanelRight:{width:230,splitterWidth:_splitterWidth,visible:!1},authPanelLeft:{width:300,splitterWidth:_splitterWidth,visible:!1},authPanelHeader:{height:34},authPanelFooter:{height:34},pageParameters:{forcePreview:!1,forceAutoScale:!0,scale:1}};_layoutParameters.pageParameters.orientation=_currentOrientation,_layoutParameters.pageParameters.deviceType=_getCurrentDeviceType();var _heights={tablet:{header:50,footer:{opened:50,closed:20}},smartphone:{header:50,footer:{opened:0,closed:0}}};exports.onWindowOrientation=function(evt,opts){if(!evt||evt.orientation==null)return;opts=opts||{},opts.orientationChanged=evt.orientation!==_currentOrientation,opts.deviceChanged=!1,_currentOrientation=evt.orientation,setTimeout(function(){_layoutMainContainers(evt,opts)})};var _lastUserAgent=null;exports.onWindowResize=function(evt,opts){if(!evt)return;opts=opts||{},opts.orientationChanged=!1,opts.deviceChanged=!1;var userAgentChanged=_lastUserAgent==null||_lastUserAgent!==navigator.userAgent.toLowerCase();if(_internalParameters&&_internalParameters.pageParameters.forcePreview!==!0){if(globals.isDesktop()){var prev=_currentOrientation;_currentOrientation=_getWindowOrientation(),opts.orientationChanged=prev!==_currentOrientation}userAgentChanged&&(_lastUserAgent=navigator.userAgent.toLowerCase(),opts.deviceChanged=!0)}if(userAgentChanged){var wasMobile=globals.isMobile();globals.notifUserAgentChanged();if(wasMobile!==globals.isMobile()){document.location.reload();return}}globals.isDesktop()&&_layoutMainContainers(evt,opts);var width=$(window).width(),height=$(window).height();if(width===_lastWindowWidth&&height<=_lastWindowHeight){notifications.publish("sm.scroller.update",!0);return}if(width!==_lastWindowWidth||height>_lastWindowHeight)_lastWindowHeight=height;_lastWindowWidth=width,_layoutMainContainers(evt,opts)},exports.onWindowResizeInteral=function(evt,opts){if(!evt)return;opts=opts||{};var params=opts.layout?opts.layout.pageParameters:null;params&&params.orientation&&params.forcePreview&&(opts.orientationChanged=_currentOrientation!==params.orientation,_currentOrientation=params.orientation);if(params&&params.device&&params.forcePreview){var typ=_deviceSizes[params.device];typ=typ?typ.deviceType:"",opts.deviceChanged=typ!==_getDeviceType()}_layoutMainContainers(evt,opts)},exports.getDeviceTemplates=function(){return _deviceSizes};var _getDeviceType=function(){if(_internalParameters&&_internalParameters.pageParameters&&_internalParameters.pageParameters.forcePreview===!0){var device=_internalParameters.pageParameters.device;return device&&_deviceSizes[device]?_deviceSizes[device].deviceType:"tablet"}var settings=globals.getGlobalSettings();return settings==null||settings["device-type"]==="auto"?_getCurrentDeviceType():settings["device-type"]};exports.getDeviceType=_getDeviceType,exports.getPageOrientation=function(){return _internalParameters.pageParameters.orientation},exports.getCurrentLayoutSettings=function(){var o=$.extend(!0,{},_layoutParameters);return o},exports.getTransformScale=function(){var res=_internalParameters&&_internalParameters.pageParameters?_internalParameters.pageParameters.scale:null;return res==null||res<=0?1:res},exports.splitterWidth=_splitterWidth,exports.onWindoReisze=_splitterWidth}),define("syracuse-tablet/html/js/application/metaDataCache",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/storage/storage","syracuse-tablet/html/js/sdata/sdataCommonResources","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/ajax/ajax"],function(require,exports,module){function _startWait(){var app=globals.getApplication();app&&app.waitWheelStart()}function _stopWait(){var app=globals.getApplication();app&&app.waitWheelStop()}function _storeKnownApplications(apps,ctx){var storage=globals.getStorage();return storage.put({$context:ctx,$collection:"$metacache_$meta_apps",$endpoint:"$local",$key:"$applications",$data:apps}).then(function(result){return apps})}function _storeApplicationDetail(app,ctx,ep){var storage=globals.getStorage();return storage.put({$context:ctx,$collection:"$metacache_$meta_app",$endpoint:ep,$key:"$application_"+app.$application.applicationName,$data:app})}function _fetchRemotePrototype(name){var deferred=$.Deferred();try{var base=globals.baseLocation(),segs=name.split("."),ep=segs.slice(0,3).join("/"),repr=segs.slice(3,5).join("."),url=base.host+"/mobile1/"+ep+"/$prototypes('"+repr+"')",headers={"Accept-Language":locale.getCurrentLocale()};ajax("GET",url,null,headers).then(function(data){if(!data.isSuccess)return $.smReject(data.responseJSON);deferred.resolve(data.responseJSON)}).fail(function(e){deferred.reject(e)})}catch(e){deferred.reject(e)}finally{return deferred.promise()}}function _storePrototype(name,prototype,ctx){var storage=globals.getStorage();return storage.put({$context:ctx,$collection:"$metacache_$meta_proto",$endpoint:"$local",$key:"$prototype_"+name,$data:prototype})}var globals=require("syracuse-tablet/html/js/helpers/globals"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("metaData"),storageModule=require("syracuse-tablet/html/js/storage/storage"),sdataCommonRes=require("syracuse-tablet/html/js/sdata/sdataCommonResources"),locale=require("syracuse-tablet/html/js/helpers/locale"),ajax=require("syracuse-tablet/html/js/ajax/ajax").getAjax().ajax;exports.getKnownApplications=function(context,forceReadFromServer){var storage=globals.getStorage(),ctx={$user:"none",$role:"none",$lang:context.lang},readCache,cache=globals.getCache();cache.isDisabled()?readCache=$.smResolve({$status:storageModule.StatusCodes.NOT_FOUND}):readCache=storage.read({$context:ctx,$collection:"$metacache_$meta_apps",$endpoint:"$local",$key:"$applications"});var def=$.Deferred();return readCache.then(function(result){if(!forceReadFromServer&&result.$status===storageModule.StatusCodes.OK){var apps=result.$data;log&&log("Application list from cache"),def.resolve(apps);return}log&&log("Fetching remote application list"),sdataCommonRes.queryAllApplications().then(function(apps){return _storeKnownApplications(apps,ctx).then(function(){def.resolve(apps)})}).fail(function(e){e&&e.$noConnectionError===!0&&result&&result.$data&&def.resolve(result.$data),def.reject(e)})}),def.promise()},exports.getApplication=function(header,context,localOnly,forceUpdate){var storage=globals.getStorage(),ctx={$user:context.user,$role:context.role,$lang:context.lang},readCache;return forceUpdate===!0?readCache=$.smResolve({$status:storageModule.StatusCodes.NOT_FOUND}):readCache=storage.read({$context:ctx,$collection:"$metacache_$meta_app",$endpoint:context.endpoint,$key:"$application_"+header.applicationName}),readCache.then(function(result){return result.$status===storageModule.StatusCodes.OK?(log&&log("Application details from cache"),result.$data):localOnly===!0?null:(log&&log("Fetching remote application details"),_startWait(),sdataCommonRes.queryApplicationDetail(header,context.endpoint).then(function(app){return _storeApplicationDetail(app,ctx,context.endpoint).then(function(){return app})}).then(function(app){return _stopWait(),app}).fail(function(e){return _stopWait(),$.smReject(e)}))})},exports.removeApplications=function(context){var storage=globals.getStorage(),ctx={$user:context.user,$role:context.role,$lang:context.lang};return storage.query({$context:ctx,$collection:"$metacache_$meta_app",$endpoint:context.endpoint}).then(function(result){if(result.$status===storageModule.StatusCodes.OK)return $.smForEachPromise(result.$data,function(app){var key="$application_"+app.$application.applicationName;return storage.remove({$context:ctx,$collection:"$metacache_$meta_app",$endpoint:context.endpoint,$key:key}).always(function(){return $.smResolve()})})})},exports.updateApplicationDetail=function(app,ctx,ep){return _storeApplicationDetail(app,ctx,ep)},exports.getPrototype=function(name,context){var storage=globals.getStorage(),ctx={$user:context.user,$role:context.role,$lang:context.lang},readCache;return readCache=storage.read({$context:ctx,$collection:"$metacache_$meta_proto",$endpoint:"$local",$key:"$prototype_"+name}),readCache.then(function(result){if(result.$status===storageModule.StatusCodes.OK){var proto=result.$data;return log&&log("Prototype from cache"),proto}return log&&log("Fetching remote prototype"),_fetchRemotePrototype(name).then(function(prototype){return _storePrototype(name,prototype,ctx).then(function(){return prototype})})})}}),define("syracuse-tablet/html/js/application/metaData",["require","exports","module","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/application/metaDataCache","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/js/helpers/prototype","syracuse-tablet/html/js/authoring/authoringArticleGen","syracuse-tablet/html/js/helpers/dashboardWelcomeUtils"],function(require,exports,module){function _checkApplicationCtx(){var ctx=globals.getUserCtx(),endpoint=globals.getEndpoint();if(_currentApplicationContext.user!=ctx.$user||_currentApplicationContext.role!=ctx.$role||_currentApplicationContext.lang!=ctx.$lang||_currentApplicationContext.endpoint!=endpoint)_currentApplicationContext.user=ctx.$user,_currentApplicationContext.role=ctx.$role,_currentApplicationContext.lang=ctx.$lang,_currentApplicationContext.endpoint=endpoint,log&&log("Application context changed to: "+JSON.stringify(_currentApplicationContext)),_resetApplicationCache();return _currentApplicationContext}function _resetApplicationCache(){_applications=null,_applicationDetails={}}function _readApplications(forceReadFromServer){var deferred=$.Deferred();return forceReadFromServer=forceReadFromServer&&globals.isOnline(),metaDataCache.getKnownApplications(_currentApplicationContext,forceReadFromServer).then(function(apps){deferred.resolve(apps)}).fail(function(e){forceReadFromServer===!0&&e&&e.$noConnectionError===!0?metaDataCache.getKnownApplications(_currentApplicationContext,!1).then(function(apps){deferred.resolve(apps)}).fail(function(e){deferred.reject(e)}):deferred.reject(e)}),deferred.promise()}function _initApplications(forceReadFromServer){return log&&log("Reading applications"),_readApplications(forceReadFromServer).then(function(apps){var matchedApps=[];return apps.forEach(function(app){var epMatch=!0;app.endpoints&&app.endpoints.length>0&&(epMatch=epMatch&&app.endpoints.some(function(ep){return ep.application+"."+ep.contract+"."+ep.dataset===_currentApplicationContext.endpoint}));var roleMatch=!0;globals.isDvlpMode()?roleMatch=!0:app.roles&&app.roles.length>0&&epMatch&&(roleMatch=roleMatch&&app.roles.some(function(role){return role.code===_currentApplicationContext.role})),roleMatch&&epMatch&&matchedApps.push(app)}),Object.keys(_applicationsStatic).forEach(function(name){matchedApps.push(_applicationsStatic[name].$application)}),_applications=matchedApps,log&&log("Number of applications: "+_applications.length),$.smForEachPromise(_applications,function(app){return _getApplication(app.applicationName,!0).then(function(appData){appData?app.localVersionNumber=appData.$application.versionNumber:app.localVersionNumber=null})})})}function _initWelcomeApplication(){return _getWelcomeApplication().then(function(welcomeApp){_applicationDetails[welcomeApp.$application.applicationName]||(_applications.push(welcomeApp.$application),_applicationDetails[welcomeApp.$application.applicationName]=welcomeApp)})}function _getApplicationHeaderByName(name){var match=null;return $.smResolve().then(function(){if(!_applications)return _initApplications()}).then(function(){return _applications&&_applications.some(function(app){if(app.applicationName==name)return match=app,!0}),match})}function _getWelcomeApplication(switchContext){return _getApplication("$welcomeApplication",!0,!1).then(function(welcomeAppp){return welcomeAppp&&!switchContext?welcomeAppp:dashBoardWelcomeUtils.defaultWelcomeApplication()})}function _getApplication(name,localOnly,forceUpdate){var app=forceUpdate!==!0?_applicationsStatic[name]||_applicationDetails[name]:null;return app?(log&&log("Application from cache: "+name),$.smResolve(app)):_getApplicationHeaderByName(name).then(function(header){if(header){var ctx=_currentApplicationContext==null||$.isEmptyObject(_currentApplicationContext)?_checkApplicationCtx():_currentApplicationContext;return metaDataCache.getApplication(header,ctx,localOnly,forceUpdate).then(function(app){return app&&(_applicationDetails[name]=app),app}).then(function(app){return app&&!localOnly&&$.each(_applications,function(idx,app1){app1.applicationName===app.$application.applicationName&&(app1.localVersionNumber=app.$application.versionNumber,app1.versionNumber=app.$application.versionNumber)}),app})}return log&&log("Unknown application: "+name),null})}function _checkPrototypeCtx(){var ctx=globals.getUserCtx(),endpoint=globals.getEndpoint();if(_currentPrototypeContext.user!=ctx.$user||_currentPrototypeContext.role!=ctx.$role||_currentPrototypeContext.lang!=ctx.$lang||_currentPrototypeContext.endpoint!=endpoint)_currentPrototypeContext.user=ctx.$user,_currentPrototypeContext.role=ctx.$role,_currentPrototypeContext.lang=ctx.$lang,_currentPrototypeContext.endpoint=endpoint,log&&log("Prototype context changed to: "+JSON.stringify(_currentPrototypeContext)),_resetPrototypeCache()}function _resetPrototypeCache(){_prototypes={}}function _updateWelcomeDashboard(newDashboard){return newDashboard?$.smResolve().then(function(){var ctx=globals.getUserCtx(),endpoint=globals.getEndpoint(),cac=_currentApplicationContext;if(!cac||cac.user!=ctx.$user||cac.role!=ctx.$role||cac.lang!=ctx.$lang||cac.endpoint!=endpoint)throw new Error("unexpected bad context");var app=globals.getApplication(),appMetaData=app&&app.dao&&app.dao.appMetaData;if(!appMetaData)throw new Error("Unknown appMetaData "+newDashboard.$dashboardName);appMetaData=$.extend(!0,{},appMetaData);var pageInfo=_getDashboardByName(newDashboard.$dashboardName,appMetaData);if(!pageInfo)throw new Error("Unknown page "+newDashboard.$dashboardName);return pageInfo.$article=$.extend(!0,{},newDashboard.$article),pageInfo.$vignettes=$.extend(!0,{},newDashboard.$vignettes),pageInfo.$gadgets=$.extend(!0,{},newDashboard.$gadgets),pageInfo.$factoryOwner=newDashboard.$factoryOwner,pageInfo.$views=$.extend(!0,{},newDashboard.$views),pageInfo.appList=$.extend(!0,{},newDashboard.appList),pageInfo.description=newDashboard.description,pageInfo.roles=newDashboard.roles,pageInfo.user=newDashboard.user,pageInfo.voiceCommandContext=newDashboard.voiceCommandContext,pageInfo.$update=null,pageInfo.$title=newDashboard.$title,metaDataCache.updateApplicationDetail(appMetaData,ctx,endpoint).then(function(){return _applicationDetails[app.applicationName]&&(_applicationDetails[app.applicationName]=appMetaData),app.dao.setApplication(appMetaData),newDashboard})}):$.smResolve(!1)}function _getDashboardByName(name,appMetaData){appMetaData=appMetaData||globals.getApplication().dao.appMetaData;var $dashboards=appMetaData.$dashboards,dashboard;return Object.keys($dashboards).some(function(key){dashboard=$dashboards[key];if(dashboard.$dashboardName===name)return!0})||(dashboard=null),dashboard}function _getDashboardPageInfo(pageName){if(!pageName.smEndsWith(_mobileDashSuffix))return $.smResolve(null);var dashboardName=pageName.substring(0,pageName.length-17),dashboard=_getDashboardByName(dashboardName);if(!dashboard)return $.smResolve(null);var pageInfo=dashboard.$pageInfo||{};return pageInfo.name=pageName,pageInfo.type="dashboard",pageInfo.subtype=pageInfo.isWelcomePage?"welcome":"std",pageInfo.dashboardName=dashboard.$dashboardName,pageInfo.cached=!1,pageInfo.refreshed=!1,$.smResolve(pageInfo)}function _getRegularPageInfo(pageName){var appMetaData=globals.getApplication().dao.appMetaData,$pages=appMetaData&&appMetaData.$pages,page=$pages&&$pages[pageName];if(!page)return $.smResolve(null);var pageInfo={name:pageName,home:!1,type:"regular",subtype:"unknown",cached:!1,refreshed:!1};return $.smResolve(page.$page.$prototype).then(function(prototype){return prototype?prototype:exports.getPrototype(pageInfo.name)}).then(function(prototype){if(prototype)if(prototype.codeRequest!=null)pageInfo.subtype=_REQUEST_SUBTYPE;else if(prototype.codeStat!=null)pageInfo.subtype=_STAT_SUBTYPE;else{var facet=prototype.$type;facet||(facet=prototype.$url),pageInfo.subtype=facet.substring(facet.lastIndexOf(".$")+2);if(!pageInfo.subtype)throw new Error("Unexpected facet for page "+pageName+"\n$url="+prototype.$url)}}).then(function(){return pageInfo})}function _getRegularPageDetails(pageInfo){var pageDetails,appMetaData=globals.getApplication().dao.appMetaData,$pages=appMetaData&&appMetaData.$pages;return $.smResolve().then(function(){var page=$pages&&$pages[pageInfo.name];if(page)return{prototype:page.$page&&page.$page.$prototype,article:page.$page&&page.$page.$article,views:page.$page&&page.$page.$views}}).then(function(pageDetails){return pageDetails?pageDetails:clientContract.getRegularPageInfo(pageInfo.name).then(function(page){if(page)return{prototype:page.$page&&page.$page.$prototype,article:page.$page&&page.$page.$article}})}).then(function(pageDetails){return pageDetails?pageDetails.prototype?pageDetails:exports.getPrototype(pageInfo.name).then(function(proto){if(proto)return pageDetails.prototype=proto,pageDetails}):exports.getPrototype(pageInfo.name).then(function(proto){if(proto)return{prototype:proto}})}).then(function(pageDetails){return pageDetails&&(pageDetails.prototype=prototypeModule.create(pageDetails.prototype)),pageDetails}).then(function(pageDetails){return pageDetails?_ensureRegularPageDetailsArticle(pageInfo,pageDetails).then(function(){return pageDetails.prototype&&pageDetails.prototype.data("codeRequest")!=null&&(pageInfo.subtype=_REQUEST_SUBTYPE),pageDetails}):null})}function _getArrayChildPageDetails(pageInfo){return $.smResolve().then(function(){var pageDetails={prototype:pageInfo.prototype,article:pageInfo.article};return _ensureRegularPageDetailsArticle(pageInfo,pageDetails).then(function(){return pageDetails})})}function _ensureRegularPageDetailsArticle(pageInfo,pageDetails){var article,genArticle,vignetteArticle=pageInfo.options.vignetteArticle,emptyVignetteArticle=vignetteArticle&&$.isEmptyObject(vignetteArticle);return vignetteArticle&&!emptyVignetteArticle?article=vignetteArticle:article=pageDetails.article,article&&!$.isEmptyObject(article)?genArticle=$.smResolve(article):genArticle=$.smResolve().then(function(){return articleGen.genNewArticle({page:{prototype:pageDetails.prototype}}).then(function(protoArticle){article=protoArticle})}),genArticle.then(function(){if(emptyVignetteArticle){for(var p in article)vignetteArticle[p]=article[p];pageDetails.article=vignetteArticle}else pageDetails.article=article;var vignetteAuthPageProps=pageInfo.options.vignetteAuthPageProps;$.isEmptyObject(vignetteAuthPageProps)||utils.authCopyPageProperties(vignetteAuthPageProps,pageDetails.article)})}var globals=require("syracuse-tablet/html/js/helpers/globals"),utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),metaDataCache=require("syracuse-tablet/html/js/application/metaDataCache"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("metaData"),prototypeModule=require("syracuse-tablet/html/js/helpers/prototype"),articleGen=require("syracuse-tablet/html/js/authoring/authoringArticleGen"),dashBoardWelcomeUtils=require("syracuse-tablet/html/js/helpers/dashboardWelcomeUtils"),_REQUEST_SUBTYPE="query request",_STAT_SUBTYPE="stat",_mobileDashSuffix=".$mobileDashboard",_currentApplicationContext={},_currentPrototypeContext={},_applications=null,_applicationDetails={},_applicationsStatic={},_prototypes={};exports.checkApplicationUpdate=function(appName){var appHeader;return _getApplicationHeaderByName(appName).then(function(_appHeader){return appHeader=_appHeader,_getApplication(appName,!0)}).then(function(appDetails){return!appDetails||!appHeader?!1:appHeader.versionNumber===appDetails.$application.versionNumber?!1:!0})},exports.registerStaticApp=function(app){if(!app||!app.$application)return;log&&log("Register static application: "+app.$application.applicationName),app.isStaticApp=!0,_applicationsStatic[app.$application.applicationName]=app},exports.getApplications=function(forceReadFromServer){return _checkApplicationCtx(),_applications!=null&&forceReadFromServer!==!0?$.smResolve(_applications):_initApplications(forceReadFromServer).then(function(){return _applications})},exports.removeApplications=function(){return metaDataCache.removeApplications(_currentApplicationContext).then(function(){_resetApplicationCache()})},exports.getPrototype=function(name){log&&log("Getting prototype: "+name);var repr=name.split(".");if(repr.length<5)return proto=clientContract.getPrototype(repr[0],repr[1]),log&&log("Prototype (client side entitiy): "+name),$.smResolve(proto);_checkPrototypeCtx();var proto=_prototypes[name];if(proto)return $.smResolve(proto);var app=globals.getApplication(),appMetaData=app&&app.dao&&app.dao.appMetaData,page=appMetaData&&appMetaData.$pages&&appMetaData.$pages[name];return proto=page&&page.$page&&page.$page.$prototype,proto?(_prototypes[name]=proto,$.smResolve(proto)):metaDataCache.getPrototype(name,_currentPrototypeContext).then(function(proto){return log&&log("Got prototype: "+name),_prototypes[name]=proto,proto})},exports.updatePageAuthoring=function(pageName,opt){var $article=opt.articleParsed,view=opt.view;return!pageName||!$article||$.isEmptyObject($article)?$.smResolve(!1):$.smResolve().then(function(){var ctx=globals.getUserCtx(),endpoint=globals.getEndpoint(),cac=_currentApplicationContext;if(!cac||cac.user!=ctx.$user||cac.role!=ctx.$role||cac.lang!=ctx.$lang||cac.endpoint!=endpoint)throw new Error("unexpected bad context");var app=globals.getApplication(),isDashBoard=pageName.smEndsWith(_mobileDashSuffix);isDashBoard&&(pageName=pageName.split(_mobileDashSuffix)[0]);var appMetaData=app&&app.dao&&app.dao.appMetaData;if(!appMetaData)throw new Error("Unknown appMetaData "+pageName);appMetaData=$.extend(!0,{},appMetaData),appMetaData.$etag=utils.UUID();var pageInfo=isDashBoard?_getDashboardByName(pageName,appMetaData):jsutils.getPropByPath(appMetaData,["$pages",pageName,"$page"]);if(!pageInfo){if(appMetaData.isStaticApp)return;throw new Error("Unknown page "+pageName)}return pageInfo.$article=$.extend(!0,{},$article),pageInfo.$views=pageInfo.$views||[],pageInfo.$views.push(view),_applicationsStatic[app.applicationName]?(_applicationsStatic[app.applicationName]=appMetaData,$.smResolve(appMetaData)):metaDataCache.updateApplicationDetail(appMetaData,ctx,endpoint).then(function(){_applicationDetails[app.applicationName]&&(_applicationDetails[app.applicationName]=appMetaData),app.dao.setApplication(appMetaData)})})},exports.getWelcomeDashboard=function(){return _getWelcomeApplication().then(function(app){return app.$dashboards.$welcomeDashboard})},exports.getDashboard=function(name){var application=globals.getApplication(),appMetaData=application.dao.appMetaData,dashboard=_getDashboardByName(name,appMetaData);if(!dashboard)return $.smResolve(null);var step;return dashboard.$update?step=dashboard.$update(dashboard).then(function(newDashboard){return dashboard=newDashboard,_initWelcomeApplication()}).then(function(){return _updateWelcomeDashboard(dashboard)}):dashboard.$pageInfo&&dashboard.$pageInfo.isWelcomePage?step=dashBoardWelcomeUtils.checkTilesStatus(dashboard):step=$.smResolve(dashboard),step.then(function(dashboard){if(dashboard){dashboard.$gadgets=dashboard.$gadgets||{};if(appMetaData.$gadgets)for(var vignette in dashboard.$vignettes){var v=dashboard.$vignettes[vignette];appMetaData.$gadgets[v.$uuid]&&(dashboard.$gadgets[v.$uuid]=appMetaData.$gadgets[v.$uuid])}}return dashboard})},exports.getDashboardPageName=function(dashboardName){return dashboardName+_mobileDashSuffix},exports.getPageInfo=function(pageName){return _getDashboardPageInfo(pageName).then(function(pageInfo){return pageInfo?pageInfo:_getRegularPageInfo(pageName)})},exports.getPageDetails=function(pageInfo){var pageDetails;if(pageInfo.type==="regular")return _getRegularPageDetails(pageInfo);if(pageInfo.type==="rowdetail"||pageInfo.type==="carddesign"||pageInfo.type==="chartdetail")return _getArrayChildPageDetails(pageInfo);throw new Error("Unsupported page type: "+pageInfo.type)},exports.getDashboardByName=_getDashboardByName,exports.getApplication=_getApplication,exports.getWelcomeApplication=_getWelcomeApplication,exports.updateWelcomeDashboard=_updateWelcomeDashboard}),define("syracuse-tablet/html/js/helpers/offlineManager",["require","exports","module","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/helpers/globals"],function(require,exports,module){function _setAppOfflineState(offline){$("#s-m-app-id").toggleClass("offline",offline)}var locale=require("syracuse-tablet/html/js/helpers/locale"),globals=require("syracuse-tablet/html/js/helpers/globals"),_OffLineMgr=function(){this._offline=null,this.setOffline=function(offline,notif,byGlobalEvent){offline=offline||!1;var stateChange=this._offline==null?offline===!0:offline!==this._offline;this._offline=offline;if(stateChange||notif)notif=notif||{},notif=$.extend(!0,{severityClass:offline?"warning":"success",title:locale.text("info.network."+(offline?"offline":"online")+".title"),body:byGlobalEvent!=1?locale.text("info.network."+(offline?"offline.outdated":"online.uptodate")):""},notif),globals.getModal().notify(notif),_setAppOfflineState(offline)},this.setOfflineQuiet=function(offline){this._offline=offline,_setAppOfflineState(offline)},this.isOnline=function(){return!this._offline}};exports.init=function(){globals.setOfflineManager(new _OffLineMgr)}}),define("syracuse-tablet/html/js/demos/clientTestApp/example",["require","exports","module"],function(require,exports,module){var _data=[];for(var i=0;i<100;i++)_data.push({$uuid:""+i,name:"My name is: "+i,desc:"My desc is: "+i,desc2:"My desc2 is: "+i,amount:i*100});exports.entity={$entityName:"example",$value:"{name}",$properties:{name:{$type:"application/x-string",$title:"My name"},desc:{$type:"application/x-string",$title:"My description"},desc2:{$type:"application/x-string",$title:"My description 2"},amount:{$type:"application/x-integer",$title:"My amount",$isExcluded:!1,$isHidden:!1,$isMandatory:!1,$isReadOnly:!1,$isDisabled:!1}},$relations:{values:{$type:"exampleChild"}},$articles:{$details:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"name",$isTitleHidden:!1}]},{$bind:"desc",$isTitleHidden:!1}]},{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"desc2",$isTitleHidden:!1}]},{$bind:"amount",$isTitleHidden:!1}]}]},$edit:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"name",$isTitleHidden:!0}]},{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"desc",$isTitleHidden:!0}]}]},{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"desc2",$isTitleHidden:!1}]},{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"amount",$isTitleHidden:!1}]}]}]}},$services:{$new:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_data[op.$key]),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_data}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/exampleHubLayout",["require","exports","module"],function(require,exports,module){var _data=[];for(var i=0;i<100;i++)_data.push({$uuid:""+i,name:"My name is: "+i,desc:"My desc is: "+i,desc2:"My desc2 is: "+i,amount:i*100});exports.entity={$entityName:"exampleHubLayout",$value:"{name}",$properties:{name:{$type:"application/x-string",$title:"My name"},desc:{$type:"application/x-string",$title:"My description"},desc2:{$type:"application/x-string",$title:"My description 2"},amount:{$type:"application/x-integer",$title:"My amount",$isExcluded:!1,$isHidden:!1,$isMandatory:!1,$isReadOnly:!1,$isDisabled:!1}},$relations:{values:{$type:"exampleChild"}},$articles:{$details:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Layout group 1",$items:[{$layoutType:"tile",$bgColor:"darkgrey",$size:"full",$items:[{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"desc",$isTitleHidden:!1}]}]}]},{$layoutType:"tile",$bgColor:"darkgrey",$size:"medium",$items:[{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"desc",$isTitleHidden:!1}]}]}]},{$layoutType:"tile",$bgColor:"purple",$size:"medium",$items:[{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"desc",$isTitleHidden:!1}]}]}]},{$layoutType:"tile",$bgColor:"sagegreen",$size:"wide",$items:[{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"desc",$isTitleHidden:!1}]}]}]}]},{$layoutType:"hubGroup",$title:"Layout group 2",$items:[{$layoutType:"tile",$bgColor:"orange",$size:"large",$items:[{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"desc",$isTitleHidden:!1}]}]}]},{$layoutType:"tile",$bgColor:"darkgrey",$size:"medium",$items:[{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"desc",$isTitleHidden:!1}]}]}]},{$layoutType:"tile",$bgColor:"purple",$size:"green",$items:[{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"desc",$isTitleHidden:!1}]}]}]},{$layoutType:"tile",$bgColor:"sagegreen",$size:"wide",$items:[{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"name",$isTitleHidden:!1},{$bind:"desc",$isTitleHidden:!1}]}]}]}]}]},$edit:{$layoutType:"stack",$items:[{$layoutType:"row",$widthMd:"6,6",$items:[{$bind:"name",$isTitleHidden:!0},{$bind:"desc",$isTitleHidden:!0}]},{$layoutType:"row",$widthMd:"6,6",$items:[{$bind:"desc2",$isTitleHidden:!1},{$bind:"amount",$isTitleHidden:!1}]}]}},$services:{$new:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_data[op.$key]),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_data}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testDatatypes",["require","exports","module"],function(require,exports,module){var _data=[],_switch=!1;for(var i=0;i<10;i++)_data.push({$uuid:""+i,propString:"Simple String="+i,propDate:"2014-03-"+(i+20),propDateTime:"2014-06-"+(i+10)+"T12:45:"+(i+44)+".123Z",propTime:"15:45:"+(i+34),propTimeShort:"15:45:"+(i+34),propInt:i*1e3+i*10,propDecimal:Math.sqrt(i*1e3+i*10),propReal:Math.sqrt(i*1e3+i*30),propBoolean:_switch=!_switch,propChoice:"mr",propQuantity:i*123,propStringUnit:"EUR",propStringMandatory:"Mandatory",propDecimalMandatory:"",propStringMinMax:"",propStringMinMaxValue:"",propStringPattern:"",propPhone:"0402030506",propEmail:"laurent.varciat@sage.com"});var _$details={$layoutType:"stack",$items:[{$layoutType:"stack",$title:"String types",$collapsible:"expanded",$items:[{$bind:"propString",$scanGPS:!0},{$bind:"propStringMandatory"},{$bind:"propStringMinMax"},{$bind:"propStringPattern"},{$bind:"propStringM"}]},{$layoutType:"stack",$title:"Numerical",$collapsible:"collapsed",$items:[{$bind:"propTimeShort"},{$bind:"propDecimal"},{$bind:"propReal"},{$bind:"propIntM"},{$bind:"propDecimalMandatory"},{$bind:"propRealM"},{$bind:"propDecimalM"},{$bind:"propStringMinMaxValue"},{$bind:"propInt"}]},{$layoutType:"stack",$title:"Date and Time",$items:[{$bind:"propDateTime"},{$bind:"propDateTimeM"},{$bind:"propDateM"},{$bind:"propTime"},{$bind:"propDate"},{$bind:"propTimeM"}]},{$layoutType:"stack",$title:"Complex",$collapsible:"collapsed",$items:[{$bind:"propQuantity"},{$bind:"propBoolean"},{$bind:"propChoice"},{$bind:"propBooleanM"}]},{$layoutType:"stack",$title:"Divers",$collapsible:"expanded",$items:[{$bind:"propPhone"},{$bind:"propEmail"}]}]},_entity={$entityName:"testDataTypes",$properties:{propString:{$type:"application/x-string",$isMandatory:!1,$title:"My name (max len 25)",$maxLength:25},propStringMandatory:{$type:"application/x-string",$isMandatory:!0,$title:"String Madatory"},propStringMinMax:{$type:"application/x-string",$title:"String MinMaxLength(3-5)",$minLength:3,$maxLength:5},propStringMinMaxValue:{$type:"application/x-integer",$isMandatory:!1,$title:"Integer MinMaxValue(3-50)",$minimun:"3",$maximun:"50"},propStringPattern:{$type:"application/x-string",$title:"Pattern",$maxLength:40},propDate:{$type:"application/x-date",$isMandatory:!1,$title:"Date"},propDateTime:{$type:"application/x-datetime",$isMandatory:!1,$title:"Date+Time"},propTime:{$type:"application/x-time",$isMandatory:!1,$title:"Time long",$format:"TT"},propTimeShort:{$type:"application/x-time",$isMandatory:!1,$title:"Time"},propInt:{$type:"application/x-integer",$isMandatory:!1,$title:"Integer (1-7000 Max)",$minimun:"1",$maximun:"7000"},propDecimalMandatory:{$type:"application/x-decimal",$isMandatory:!0,$title:"Decimal mandatory(2.4)",$scale:2,$precision:4,$format:"0.00"},propDecimal:{$type:"application/x-decimal",$isMandatory:!1,$title:"Decimal(4.7)",$scale:4,$precision:7,$format:"0.0000"},propReal:{$type:"application/x-real",$isMandatory:!1,$title:"Real"},propBoolean:{$type:"application/x-boolean",$isMandatory:!1,$title:"Boolean"},propChoice:{$type:"application/x-choice",$isMandatory:!1,$title:"Choice",$value:{$enum:[{$title:"Mr.",$value:"mr"},{$title:"Mrs.",$value:"mrs"}],$type:"application/x-string"}},propQuantity:{$title:"Quantity",$type:"application/x-quantity",$value:{$title:"{$value} {$unit}",$type:"application/x-decimal",$scale:9,$precision:2,$format:"0.00"},$unit:"propStringUnit"},propStringUnit:{$type:"application/x-string",$isMandatory:!1,$isExcluded:!0,$title:"Unit for quantity"},propStringM:{$type:"application/x-string",$isMandatory:!0,$title:"My name"},propDateM:{$type:"application/x-date",$isMandatory:!0,$title:"Date (Mandatory)"},propDateTimeM:{$type:"application/x-datetime",$isMandatory:!0,$title:"Date+Time (Mandatory)"},propTimeM:{$type:"application/x-time",$isMandatory:!0,$title:"Time (Mandatory)"},propIntM:{$type:"application/x-integer",$isMandatory:!0,$title:"Integer (Mandatory)"},propDecimalM:{$type:"application/x-decimal",$isMandatory:!0,$title:"Decimal (Mandatory)"},propRealM:{$type:"application/x-real",$isMandatory:!0,$title:"Real (Mandatory)"},propBooleanM:{$type:"application/x-boolean",$isMandatory:!0,$title:"Boolean (Mandatory)"},propPhone:{$title:"Phone Number",$type:"application/x-string",$format:"$phone"},propEmail:{$title:"Email",$type:"application/x-string",$format:"$email"}},$relations:{},$articles:{$details:_$details,$edit:_$details},$services:{$new:function(op,data){var deferred=$.Deferred(),i=15,tpl={$uuid:""+i,propString:"Simple String="+i,propDate:"2014-03-"+i,propDateTime:"2014-06-"+i+"T12:45:"+(i+44)+".234Z",propTime:"15:45:"+(i+34),propInt:i*1e3+i*10,propDecimal:Math.sqrt(i*1e3+i*10),propReal:Math.sqrt(i*1e3+i*30),propBoolean:_switch=!_switch};return deferred.resolve(tpl),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_data[op.$key]),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_data}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}};exports.entity=_entity}),define("syracuse-tablet/html/js/demos/clientTestApp/testFormats",["require","exports","module"],function(require,exports,module){var _data=[],_switch=!1;for(var i=0;i<10;i++)_data.push({$uuid:""+i,propDate1:"2014-03-"+(i+20),propDateTime1:"2014-06-"+(i+10)+" 12:45:"+(i+44),propTime1:"15:45:"+(i+34),propInt1:i*1e3+i*10,propDecimal1:Math.sqrt(i*1e3+i*10),propReal1:Math.sqrt(i*1e3+i*30),propDate2:"2014-03-"+(i+20),propDateTime2:"2014-06-"+(i+10)+" 12:45:"+(i+44),propTime2:"15:45:"+(i+34),propInt2:i*1e3+i*10,propDecimal2:Math.sqrt(i*1e3+i*10),propReal2:Math.sqrt(i*1e3+i*30),propString:"Test"});exports.entity={$entityName:"testFormats",$properties:{propDate1:{$type:"application/x-date",$title:"Date"},propDateTime1:{$type:"application/x-datetime",$title:"Date+Time"},propTime1:{$type:"application/x-time",$title:"Time"},propInt1:{$type:"application/x-integer",$title:"Integer"},propDecimal1:{$type:"application/x-decimal",$title:"Decimal"},propReal1:{$type:"application/x-real",$title:"Real"},propDate2:{$type:"application/x-date",$title:"Date"},propDateTime2:{$type:"application/x-datetime",$title:"Date+Time"},propTime2:{$type:"application/x-time",$title:"Time"},propInt2:{$type:"application/x-integer",$title:"Integer"},propDecimal2:{$type:"application/x-decimal",$title:"Decimal"},propReal2:{$type:"application/x-real",$title:"Real"},propString:{$type:"application/x-string",$title:"String"}},$relations:{},$articles:{},$services:{$new:function(op,data){var deferred=$.Deferred();return deferred.resolve({}),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_data[op.$key]),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_data}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testFormatsReference",["require","exports","module"],function(require,exports,module){var $descriptionSamples=["Labe","Labuan","La Rochelle","Las Vegas","Las Palmas","Liege","Libreville","Lille","Liverpool","Leipzig","Lucknow","London"],$codeSamples=["LEK","LBU","LRH","LAS","LPA","LGG","LBV","LIL","LPL","LEJ","LKO","LON"],_data={SITE_REF:{$description:"Paris",FCY:"PAR"},SITE_REF_1:{$description:"Yaounde",FCY:"YDE"},SITE_REF_2:{$description:"London",FCY:"LON"},SITE_REF_3:{$description:"Lisbon",FCY:"LIS"}},_qData=[],j=-1,m=-1;for(var i=0;i<3;i++)_qData.push({$uuid:""+i,SITE_REF:{$description:$descriptionSamples[++j],FCY:$codeSamples[++m]},SITE_REF_1:{$description:$descriptionSamples[++j],FCY:$codeSamples[++m]},SITE_REF_2:{$description:$descriptionSamples[++j],FCY:$codeSamples[++m]},SITE_REF_3:{$description:$descriptionSamples[++j],FCY:$codeSamples[++m]}});exports.entity={$entityName:"testFormatsReference",$baseUrl:"http://localhost:8124/mobile1/x3/erp/SUPERV",$properties:{SITE:{$type:"application/x-string",$maxLength:5,$isExcluded:!0},SITE_REF:{$type:"application/x-reference",$title:"Reference",$shortTitle:"Reference",$capabilities:"sort,filter",$item:{$url:"{$baseUrl}/testFormatsReference('{$key}')?representation=testFormatsReference.$lookup",$value:"{FCY}",FCY:"{SITE}",$key:"{FCY}",$properties:{FCY:{$type:"application/x-string"}},$links:{$details:{$title:"details",$target:"",$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/testFormatsReference('{SITE}')?representation=testFormatsReference.$details",$method:"GET"},$lookup:{$title:"lookup",$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/testFormatsReference?representation=testFormatsReference.$lookup",$method:"GET"},$query:{$title:"query",$target:"",$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/testFormatsReference?representation=testFormatsReference.$query",$method:"GET"},SIT1:{$title:"SIT1",$target:"main",$type:"application/json;vnd.sage=syracuse",$url:"https://maps.google.de/maps?q={SITE}&t=Default",$method:"GET"}}}},SITE_REF_1:{$type:"application/x-reference",$title:"Reference 1",$shortTitle:"Reference 1",$capabilities:"sort,filter",$item:{$url:"{$baseUrl}/testFormatsReference('{$key}')?representation=testFormatsReference.$lookup",$value:"{FCY}",FCY:"{SITE}",$key:"{FCY}",$properties:{FCY:{$type:"application/x-string"}},$links:{$details:{$title:"details",$target:"",$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/testFormatsReference('{SITE}')?representation=testFormatsReference.$details",$method:"GET"},$lookup:{$title:"lookup",$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/testFormatsReference?representation=testFormatsReference.$lookup",$method:"GET"},$query:{$title:"query",$target:"",$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/testFormatsReference?representation=testFormatsReference.$query",$method:"GET"},SIT1:{$title:"SIT1",$target:"main",$type:"application/json;vnd.sage=syracuse",$url:"https://maps.google.de/maps?q={SITE}&t=Default",$method:"GET"}}}},SITE_REF_2:{$type:"application/x-reference",$title:"Reference 2",$shortTitle:"Reference 2",$capabilities:"sort,filter",$item:{$url:"{$baseUrl}/testFormatsReference('{$key}')?representation=testFormatsReference.$lookup",$value:"{FCY}",FCY:"{SITE}",$key:"{FCY}",$properties:{FCY:{$type:"application/x-string"}},$links:{$details:{$title:"details",$target:"",$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/testFormatsReference('{SITE}')?representation=testFormatsReference.$details",$method:"GET"},$lookup:{$title:"lookup",$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/testFormatsReference?representation=testFormatsReference.$lookup",$method:"GET"},$query:{$title:"query",$target:"",$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/testFormatsReference?representation=testFormatsReference.$query",$method:"GET"},SIT1:{$title:"SIT1",$target:"main",$type:"application/json;vnd.sage=syracuse",$url:"https://maps.google.de/maps?q={SITE}&t=Default",$method:"GET"}}}},SITE_REF_3:{$type:"application/x-reference",$title:"Reference 3",$shortTitle:"Reference 3",$capabilities:"sort,filter",$item:{$url:"{$baseUrl}/testFormatsReference('{$key}')?representation=testFormatsReference.$lookup",$value:"{FCY}",FCY:"{SITE}",$key:"{FCY}",$properties:{FCY:{$type:"application/x-string"}},$links:{$details:{$title:"details",$target:"",$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/testFormatsReference('{SITE}')?representation=testFormatsReference.$details",$method:"GET"},$lookup:{$title:"lookup",$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/testFormatsReference?representation=testFormatsReference.$lookup",$method:"GET"},$query:{$title:"query",$target:"",$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/testFormatsReference?representation=testFormatsReference.$query",$method:"GET"},SIT1:{$title:"SIT1",$target:"main",$type:"application/json;vnd.sage=syracuse",$url:"https://maps.google.de/maps?q={SITE}&t=Default",$method:"GET"}}}}},$relations:{},$articles:{$details:{$layoutType:"stack",$items:[{$bind:"SITE_REF",$title:"Ref field 1"},{$bind:"SITE_REF_1",$title:"Ref field 2"},{$bind:"SITE_REF_2",$title:"Ref field 3"},{$bind:"SITE_REF_3",$title:"Ref field 4"}]},$edit:{$layoutType:"stack",$items:[{$bind:"SITE_REF",$title:"Ref field 1"},{$bind:"SITE_REF_1",$title:"Ref field 2"},{$bind:"SITE_REF_2",$title:"Ref field 3"},{$bind:"SITE_REF_3",$title:"Ref field 4"}]}},$services:{$new:function(op,data){var deferred=$.Deferred();return deferred.resolve({}),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_data),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_qData}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testCharts",["require","exports","module"],function(require,exports,module){var _data=[{part:"Gear",value:50,revenue:40,margin:10},{part:"Motor",value:60,revenue:40,margin:20},{part:"Head drive",value:60,revenue:80,margin:-20},{part:"Handwheel",value:70,revenue:90,margin:10},{part:"Crank",value:70,revenue:70,margin:0},{part:"Saddle",value:80,revenue:30,margin:50},{part:"Base",value:20,revenue:40,margin:-20},{part:"Spindle",value:10,revenue:0,margin:10}];exports.entity={$entityName:"testCharts",$properties:{part:{$type:"application/x-string",$title:"Item"},value:{$type:"application/x-decimal",$title:"Value",$format:"0.0000"},revenue:{$type:"application/x-decimal",$title:"Revenue",$format:"0.0000"},margin:{$type:"application/x-decimal",$title:"Margin",$format:"0.0000"}},$prototype:function(proto){var res=proto.$properties&&proto.$properties.$resources;res&&(res.$axes=[{$title:"Item",$hierarchies:[["part"]]},{$hierarchies:[["$measures"]]}],res.$cube={$title:"Sales overview",$hierarchies:{part:{$properties:["part"]}},$measures:{value:{},revenue:{},margin:{}}})},$relations:{},$articles:{},$services:{$new:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_data[op.$key]),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_data}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testConstraints",["require","exports","module"],function(require,exports,module){var _data=[],_switch=!1;for(var i=0;i<10;i++)_data.push({$uuid:""+i,propString:"Test "+i,propString2:"Some text "+i,propString3:"Fill me "+i,propInt:i*1e3+i*10,propInt2:i*1e3+i*100,propDecimal:Math.sqrt(i*1e3+i*10),propDecimal2:Math.sqrt(i*1e3+i*100),propDecimal3:Math.sqrt(i*1e3+i*110),propDecimal4:Math.sqrt(i*1e3+i*120),propQuantity:i*123,propStringUnit:"EUR"});exports.entity={$entityName:"testConstraints",$properties:{propString:{$title:"Test: $pattern=Test.*\\d$",$type:"application/x-string",$isMandatory:!0,$pattern:"Test.*\\d$"},propString2:{$title:"Test: $minLength=5, $maxLength=15",$type:"application/x-string",$isMandatory:!0,$minLength:5,$maxLength:15},propString3:{$title:"Test: $minLength=5, $maxLength=15, $pattern=Fill me.*\\d$",$type:"application/x-string",$isMandatory:!0,$pattern:"Fill me.*\\d$",$minLength:5,$maxLength:15},propInt:{$title:"Test: $minimum=100, $maximum=200",$type:"application/x-integer",$isMandatory:!0,$minimum:100,$maximum:200},propInt2:{$title:"Test: $exclusiveMinimum=100, $exclusiveMaximum=200",$type:"application/x-integer",$isMandatory:!0,$exclusiveMinimum:100,$exclusiveMaximum:200},propDecimal:{$title:"Test: $format=0.0000",$type:"application/x-decimal",$isMandatory:!0,$format:"0.0000"},propDecimal2:{$title:"Test: $format=0.00",$type:"application/x-decimal",$isMandatory:!0,$format:"0.00"},propDecimal3:{$title:"Test: $precision=10",$type:"application/x-decimal",$isMandatory:!0,$precision:10},propDecimal4:{$title:"Test: $scale=3",$type:"application/x-decimal",$isMandatory:!0,$scale:3,$format:"0.00000"},propQuantity:{$title:"Test: $format=0.00",$isMandatory:!0,$type:"application/x-quantity",$value:{$title:"{$value} {$unit}",$type:"application/x-decimal",$scale:9,$precision:2,$format:"0.00"},$unit:"propStringUnit"},propStringUnit:{$title:"Unit for quantity",$type:"application/x-string",$isMandatory:!1,$isExcluded:!0}},$relations:{},$articles:{},$services:{$new:function(op,data){var deferred=$.Deferred(),i=15,tpl={$uuid:""+i,propString:"Simple String="+i,propInt:i*1e3+i*10,propDecimal:Math.sqrt(i*1e3+i*10)};return deferred.resolve(tpl),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_data[op.$key]),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_data}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testNavigateTo",["require","exports","module","syracuse-tablet/html/js/helpers/utils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),_data=[];for(var i=0;i<10;i++)_data.push({$uuid:""+i,name:"Customer group "+i,group:""+i});exports.entity={$entityName:"testNavigateTo",$properties:{name:{$title:"Customer group name",$type:"application/x-string"},group:{$title:"Customer group",$type:"application/x-string"}},$prototype:function(proto){var res=utils.getPropByPath(proto,"$properties.$resources.$item.$links")||{};res.DASHBOARD={$title:"Detail dashboard",$url:"{$baseUrl}/$mobileDashboards?dashboard=testContextDashboardChild&parameters=group%3D%7Bgroup%7D"}},$relations:{},$articles:{$query:{$layoutType:"stack",$items:[{$bind:"$resources",$detailsLink:"DASHBOARD",$isTitleHidden:!0,$article:{$items:[{$bind:"group"},{$bind:"name"}]},$display:"table"}]}},$services:{$new:function(op,data){var deferred=$.Deferred(),i=15,tpl={$uuid:""+i,propString:"Simple String="+i,propInt:i*1e3+i*10,propDecimal:Math.sqrt(i*1e3+i*10)};return deferred.resolve(tpl),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_data[op.$key]),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_data}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testNavigateToChild",["require","exports","module"],function(require,exports,module){var _data=[];for(var i=0;i<10;i++)for(var j=0;j<10;j++)_data.push({$uuid:""+(i*10+j),name:"Customer "+i*10+j,desc:"Belongs to group "+i,group:""+i});exports.entity={$entityName:"testNavigateToChild",$properties:{name:{$title:"Customer name",$type:"application/x-string"},desc:{$title:"Description",$type:"application/x-string"},group:{$title:"Customer group",$type:"application/x-string"}},$relations:{},$articles:{},$services:{$new:function(op,data){var deferred=$.Deferred(),i=15,tpl={$uuid:""+i,propString:"Simple String="+i,propInt:i*1e3+i*10,propDecimal:Math.sqrt(i*1e3+i*10)};return deferred.resolve(tpl),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_data[op.$key]),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_data}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testPropertyHideShow",["require","exports","module"],function(require,exports,module){var _data=[],_switch=!1;for(var i=0;i<10;i++)_data.push({$uuid:""+i,propStringShow:"Simple String="+i,propStringHide:"Simple String="+i,propStringReadOnly:"ReadOnly String="+i,propStringDisabled:"Disabled=true String="+i,propStringDisabledFalse:"Disabled=false String="+i,propDate:"2014-03-"+(i+20),propDateHide:"2014-03-"+(i+20),propDateDisabled:"2014-03-"+(i+20),propDateReadOnly:"2014-03-"+(i+20),propDateTime:"2014-06-"+(i+10)+"T12:45:"+(i+44)+".123Z",propDateTimeHide:"2014-06-"+(i+10)+"T12:45:"+(i+44)+".123Z",propDateTimeDisabled:"2014-06-"+(i+10)+"T12:45:"+(i+44)+".123Z",propTime:"15:45:"+(i+34),propTimeHide:"15:45:"+(i+34),propTimeDisabled:"15:45:"+(i+34),propInt:i*1e3+i*10,propIntHide:i*1e3+i*10,propIntDisabled:i*1e3+i*10,propIntReadOnly:i*1e3+i*10,propDecimal:Math.sqrt(i*1e3+i*10),propDecimalHide:Math.sqrt(i*1e3+i*10),propDecimalDisabled:Math.sqrt(i*1e3+i*10),propDecimalReadOnly:Math.sqrt(i*1e3+i*10),propReal:Math.sqrt(i*1e3+i*30),propBoolean:_switch=!_switch,propBooleanHidden:_switch=!_switch,propBooleanDisabled:_switch=!_switch,propChoice:"mr",propChoiceHidden:"mr",propChoiceDisabled:"mr",propQuantity:i*123,propStringUnit:"EUR",propQuantityExcluded:i*123,propStringUnitExcluded:"USD"});exports.entity={$entityName:"testPropertyHideShow",$properties:{propStringShow:{$type:"application/x-string",$isMandatory:!0,$title:"String Mandatory $isHidden: false",$isHidden:!1},propStringHide:{$type:"application/x-string",$isMandatory:!1,$title:"String $isHidden: true",$isHidden:!0},propStringReadOnly:{$type:"application/x-string",$title:"String $isReadOnly: true",$isReadOnly:!0},propStringDisabledFalse:{$type:"application/x-string",$title:"String $isDisabled: false",$isDisabled:!1},propStringDisabled:{$type:"application/x-string",$title:"String $isDisabled: true",$isDisabled:!0},propDate:{$type:"application/x-date",$isMandatory:!1,$title:"Date $isHidden: false",$isHidden:!1},propDateHide:{$type:"application/x-date",$isMandatory:!1,$title:"Date $isHidden: true",$isHidden:!0},propDateDisabled:{$type:"application/x-date",$isMandatory:!1,$title:"Date $isDisabled: true",$isDisabled:!0},propDateReadOnly:{$type:"application/x-date",$isMandatory:!1,$title:"Date $isReadOnly: true",$isReadOnly:!0},propDateTime:{$type:"application/x-datetime",$isMandatory:!1,$title:"Date+Time $isHidden: false",$isHidden:!1},propDateTimeHide:{$type:"application/x-datetime",$isMandatory:!1,$title:"Date+Time $isHidden: true",$isHidden:!0},propDateTimeDisabled:{$type:"application/x-datetime",$isMandatory:!1,$title:"Date+Time $isDisabled: true",$isDisabled:!0},propTime:{$type:"application/x-time",$isMandatory:!1,$title:"Time long",$format:"TT"},propTimeHide:{$type:"application/x-time",$isMandatory:!1,$title:"Time $isHidden: true",$isHidden:!0},propTimeDisabled:{$type:"application/x-time",$isMandatory:!1,$title:"Time $isDisabled: true",$isDisabled:!0},propInt:{$type:"application/x-integer",$isMandatory:!1,$title:"Integer ($isHidden: false)",$isHidden:!1},propIntHide:{$type:"application/x-integer",$isMandatory:!1,$title:"Integer ($isHidden: true)",$isHidden:!0},propIntDisabled:{$type:"application/x-integer",$isMandatory:!1,$title:"Integer ($isDisabled: true)",$isDisabled:!0},propIntReadOnly:{$type:"application/x-integer",$isMandatory:!1,$title:"Integer ($isReadOnly: true)",$isReadOnly:!0},propDecimal:{$type:"application/x-decimal",$isMandatory:!1,$title:"Decimal $isHidden: false",$isHidden:!1},propDecimalHide:{$type:"application/x-decimal",$isMandatory:!1,$title:"Decimal $isHidden: true",$isHidden:!0},propDecimalDisabled:{$type:"application/x-decimal",$isMandatory:!1,$title:"Decimal $isDisabled: true",$isDisabled:!0},propDecimalReadOnly:{$type:"application/x-decimal",$isMandatory:!1,$title:"Decimal $isReadOnly: true",$isReadOnly:!0},propReal:{$type:"application/x-real",$isMandatory:!1,$title:"Real"},propBoolean:{$type:"application/x-boolean",$isMandatory:!1,$title:"Boolean"},propBooleanHidden:{$type:"application/x-boolean",$isMandatory:!1,$title:"Boolean ($isHidden: true)",$isHidden:!0},propBooleanDisabled:{$type:"application/x-boolean",$isMandatory:!1,$title:"Boolean ($isDisabled: true)",$isDisabled:!0},propChoice:{$type:"application/x-choice",$isMandatory:!1,$title:"Choice",$value:{$enum:[{$title:"Mr.",$value:"mr"},{$title:"Mrs.",$value:"mrs"}],$type:"application/x-string"}},propChoiceHidden:{$type:"application/x-choice",$isMandatory:!1,$title:"Choice($isHidden: true)",$isHidden:!0,$value:{$enum:[{$title:"Mr.",$value:"mr"},{$title:"Mrs.",$value:"mrs"}],$type:"application/x-string"}},propChoiceDisabled:{$type:"application/x-choice",$isMandatory:!1,$title:"Choice ($isDisabled: true)",$isDisabled:!0,$value:{$enum:[{$title:"Mr.",$value:"mr"},{$title:"Mrs.",$value:"mrs"}],$type:"application/x-string"}},propQuantity:{$title:"Quantity ($unit $isExcluded: false)",$type:"application/x-quantity",$value:{$title:"{$value} {$unit}",$type:"application/x-decimal",$scale:9,$precision:2,$format:"0.00"},$unit:"propStringUnit"},propStringUnit:{$type:"application/x-string",$isMandatory:!1,$isExcluded:!1,$title:"Unit for quantity ($isExcluded: false)"},propQuantityExcluded:{$title:"Quantity($unit $isExcluded: true)",$type:"application/x-quantity",$value:{$title:"{$value} {$unit}",$type:"application/x-decimal",$scale:9,$precision:2,$format:"0.00"},$unit:"propStringUnitExcluded"},propStringUnitExcluded:{$type:"application/x-string",$isMandatory:!1,$isExcluded:!0,$title:"Unit for quantity ($isExcluded: true)"}},$relations:{},$articles:{},$services:{$new:function(op,data){var deferred=$.Deferred(),i=15,tpl={$uuid:""+i,propString:"Simple String="+i,propDate:"2014-03-"+i,propDateTime:"2014-06-"+i+"T12:45:"+(i+44)+".234Z",propTime:"15:45:"+(i+34),propInt:i*1e3+i*10,propDecimal:Math.sqrt(i*1e3+i*10),propReal:Math.sqrt(i*1e3+i*30),propBoolean:_switch=!_switch};return deferred.resolve(tpl),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_data[op.$key]),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_data}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testGaugeChart",["require","exports","module"],function(require,exports,module){var _data={salesOp:"75.0000000000",salesValue:"133000.0000000000",salesValueMin:"100000.0000000000",salesValueMax:"150000.0000000000"},_entity={$entityName:"testGaugeChart",$properties:{salesOp:{$title:"sale opportunity",$type:"application/x-decimal",$capabilities:"sort,filter"},salesValue:{$title:"sales value",$type:"application/x-decimal",$capabilities:"sort,filter"},salesValueMin:{$title:"sales value min",$type:"application/x-decimal",$capabilities:"sort,filter"},salesValueMax:{$title:"sales value max",$type:"application/x-decimal",$capabilities:"sort,filter"}},$relations:{},$articles:{},$services:{$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_data),deferred.promise()}}};exports.entity=_entity}),define("syracuse-tablet/html/js/demos/clientTestApp/testHomeDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testHomeDashboard:{$dashboardName:"testHomeDashboard",$title:"Main test dashboard",$description:"This dashboard links to different dashboards used for every kind of UI tests",$vignettes:{testLayoutsDashboard:{$uuid:"testLayoutsDashboard",$displayStyle:"$link"},testTypesDashboard:{$uuid:"testTypesDashboard",$displayStyle:"$link"},testTypesDashboard2:{$uuid:"testTypesDashboard2",$displayStyle:"$link"},testFormatsDashboard:{$uuid:"testFormatsDashboard",$displayStyle:"$link"},testGX3APPDashboard:{$uuid:"testGX3APPDashboard",$displayStyle:"$link"},testSUPERVDashboard:{$uuid:"testSUPERVDashboard",$displayStyle:"$link"},testChartsHubDashboard:{$uuid:"testChartsHubDashboard",$displayStyle:"$link"},testChartsStackDashboard:{$uuid:"testChartsStackDashboard",$displayStyle:"$link"},testSUPERVDashboard2:{$uuid:"testSUPERVDashboard2",$displayStyle:"$link"},testGX3APPDashboard2:{$uuid:"testGX3APPDashboard2",$displayStyle:"$link"},testConstraintsDashboard:{$uuid:"testConstraintsDashboard",$displayStyle:"$link"},testPropertyHideShowDashboard:{$uuid:"testPropertyHideShowDashboard",$displayStyle:"$link"},testAQTACTNPDashboard:{$uuid:"testAQTACTNPDashboard",$displayStyle:"$link"},testQAQTGRAPDashboard:{$uuid:"testQAQTGRAPDashboard",$displayStyle:"$link"},testSTATISTICDashboard:{$uuid:"testSTATISTICDashboard",$displayStyle:"$link"},testAQMPROJECTMDashboard:{$uuid:"testAQMPROJECTMDashboard",$displayStyle:"$link"},testAQMOPERATMDashboard:{$uuid:"testAQMOPERATMDashboard",$displayStyle:"$link"},testAQMINTIMESMDashboard:{$uuid:"testAQMINTIMESMDashboard",$displayStyle:"$link"},testGaugeChartDashboard:{$uuid:"testGaugeChartDashboard",$displayStyle:"$link"},testExternalLink:{$uuid:"testExternalLink",$displayStyle:"$link"},testGridDashboard:{$uuid:"testGridDashboard",$displayStyle:"$link"},testDefaultAQTCRUDM:{$uuid:"testDefaultAQTCRUDM",$displayStyle:"$link"},testDefaultAQMCRUDM:{$uuid:"testDefaultAQMCRUDM",$displayStyle:"$link"},testDefaultAQMFIELDSM:{$uuid:"testDefaultAQMFIELDSM",$displayStyle:"$link"},testDefaultAQMSEARCHM:{$uuid:"testDefaultAQMSEARCHM",$displayStyle:"$link"},unitTestsDashboard:{$uuid:"unitTestsDashboard",$displayStyle:"$link"},testAQMBLOBM:{$uuid:"testAQMBLOBM",$displayStyle:"$link"},testAQMCLOBM:{$uuid:"testAQMCLOBM",$displayStyle:"$link"},testAUTILISM:{$uuid:"testAUTILISM",$displayStyle:"$link"},testAutoUI_ContextDashboard:{$uuid:"testAutoUI_ContextDashboard",$displayStyle:"$link"},testAutoUI_AQMDEVICE_Query:{$uuid:"testAutoUI_AQMDEVICE_Query",$displayStyle:"$link"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Client only",$items:[{$layoutType:"tile",$bgColor:"purple",$items:[{$bind:"testLayoutsDashboard"}],$size:"small"},{$layoutType:"tile",$bgColor:"lightgreen",$items:[{$bind:"testFormatsDashboard"}],$size:"small"},{$layoutType:"tile",$bgColor:"lightgreen",$items:[{$bind:"testTypesDashboard"}],$size:"small"},{$layoutType:"tile",$bgColor:"medium-grey",$items:[{$bind:"testConstraintsDashboard"}],$size:"small"},{$layoutType:"tile",$bgColor:"darkgrey",$title:"Test title",$icon:"adjust",$items:[{$bind:"testChartsHubDashboard"}],$size:"medium"},{$layoutType:"tile",$bgColor:"darkgrey",$title:"Test title",$icon:"adjust",$items:[{$bind:"testChartsStackDashboard"}],$size:"medium"},{$layoutType:"tile",$bgColor:"darkgrey",$items:[{$bind:"testPropertyHideShowDashboard"}],$size:"small"},{$layoutType:"tile",$bgColor:"darkgrey",$items:[{$bind:"testGaugeChartDashboard"}],$size:"small"},{$layoutType:"tile",$bgColor:"darkgrey",$items:[{$bind:"testExternalLink"}],$size:"small"},{$layoutType:"tile",$bgColor:"alert",$items:[{$bind:"unitTestsDashboard"}],$size:"medium"}]},{$layoutType:"hubGroup",$title:"SUPERV endpoint",$items:[{$layoutType:"tile",$bgColor:"green",$items:[{$bind:"testSUPERVDashboard"}]},{$layoutType:"tile",$bgColor:"sagegreen",$items:[{$bind:"testGridDashboard"}]}]},{$layoutType:"hubGroup",$title:"GX3APP endpoint",$items:[{$layoutType:"tile",$bgColor:"blue",$items:[{$bind:"testGX3APPDashboard"}]},{$layoutType:"tile",$bgColor:"sagegreen",$items:[{$bind:"testGX3APPDashboard2"}]}]},{$layoutType:"hubGroup",$title:"Tests LAM",$items:[{$layoutType:"tile",$bgColor:"purple",$items:[{$bind:"testQAQTGRAPDashboard"}]},{$layoutType:"tile",$bgColor:"green",$items:[{$bind:"testAQMPROJECTMDashboard"}]},{$layoutType:"tile",$bgColor:"purple",$items:[{$bind:"testAQMOPERATMDashboard"}]},{$layoutType:"tile",$bgColor:"purple",$items:[{$bind:"testAQMINTIMESMDashboard"}]}]},{$layoutType:"hubGroup",$title:"Default endpoint",$items:[{$layoutType:"tile",$bgColor:"mediumgrey",$items:[{$bind:"testAQTACTNPDashboard"}]},{$layoutType:"tile",$bgColor:"lightgreen",$items:[{$bind:"testTypesDashboard2"}],$size:"medium"},{$layoutType:"tile",$bgColor:"sagegreen",$items:[{$bind:"testDefaultAQTCRUDM"}]},{$layoutType:"tile",$bgColor:"sagegreen",$items:[{$bind:"testDefaultAQMCRUDM"}]},{$layoutType:"tile",$bgColor:"sagegreen",$items:[{$bind:"testDefaultAQMFIELDSM"}]},{$layoutType:"tile",$bgColor:"sagegreen",$items:[{$bind:"testDefaultAQMSEARCHM"}]},{$layoutType:"tile",$bgColor:"sagegreen",$items:[{$bind:"testAQMBLOBM"}]},{$layoutType:"tile",$bgColor:"sagegreen",$items:[{$bind:"testAQMCLOBM"}]},{$layoutType:"tile",$bgColor:"sagegreen",$items:[{$bind:"testAUTILISM"}]}]},{$layoutType:"hubGroup",$title:"Automated tests",$items:[{$layoutType:"tile",$bgColor:"blue",$size:"small",$items:[{$bind:"testAutoUI_ContextDashboard"}]},{$layoutType:"tile",$bgColor:"blue",$size:"small",$items:[{$bind:"testAutoUI_AQMDEVICE_Query"}]}]}]}}},exports.gadgets={testLayoutsDashboard:{$type:"$dashboard",$title:"Layout tests",$description:"Layout tests",dashboardName:"testLayoutsDashboard"},testTypesDashboard:{$type:"$dashboard",$title:"Datatype tests",$description:"Datatype tests",dashboardName:"testTypesDashboard"},testTypesDashboard2:{$type:"$dashboard",$title:"Datatype AQTCRUD",$description:"Datatype AQTCRUD",dashboardName:"testTypesDashboard2"},testFormatsDashboard:{$type:"$dashboard",$title:"Formats tests",$description:"Formats tests",dashboardName:"testFormatsDashboard"},testGX3APPDashboard:{$type:"$dashboard",$title:"GX3APP tests",$description:"GX3APP tests",dashboardName:"testGX3APPDashboard"},testSUPERVDashboard:{$type:"$dashboard",$title:"SUPERV tests",$description:"SUPERV tests",dashboardName:"testSUPERVDashboard"},testChartsHubDashboard:{$type:"$dashboard",$title:"Charts tests (hub)",$description:"Charts tests (hub)",dashboardName:"testChartsHubDashboard"},testChartsStackDashboard:{$type:"$dashboard",$title:"Charts tests (stack)",$description:"Charts tests  (stack)",dashboardName:"testChartsStackDashboard"},testSUPERVDashboard2:{$type:"$dashboard",$title:"AQMCRUDM",$description:"AQMCRUDM default endpoint",dashboardName:"testSUPERVDashboard2"},testGX3APPDashboard2:{$type:"$dashboard",$title:"GX3APP Cost",$description:"GX3APP Cost",dashboardName:"testGX3APPDashboard2"},testConstraintsDashboard:{$type:"$dashboard",$title:"SData constraints",$description:"SData constraints",dashboardName:"testConstraintsDashboard"},testPropertyHideShowDashboard:{$type:"$dashboard",$title:"Property Hide Show",$description:"Dashboard PropertyHideShow",dashboardName:"testPropertyHideShowDashboard"},testAQTACTNPDashboard:{$type:"$dashboard",$title:"AQTACTNP Create facet",$description:"AQTACTNP Create facet",dashboardName:"testAQTACTNPDashboard"},testQAQTGRAPDashboard:{$type:"$dashboard",$title:"test QAQTGRAP",$description:"test QAQTGRAP ",dashboardName:"testQAQTGRAPDashboard"},testSTATISTICDashboard:{$type:"$dashboard",$title:"test STATISTIC",$description:"test STATISTIC",dashboardName:"testSTATISTICDashboard"},testAQMPROJECTMDashboard:{$type:"$dashboard",$title:"test AQMPROJECTM",$description:"test AQMPROJECTM",dashboardName:"testAQMPROJECTMDashboard"},testAQMOPERATMDashboard:{$type:"$dashboard",$title:"test AQMOPERATM",$description:"test AQMOPERATM",dashboardName:"testAQMOPERATMDashboard"},testAQMINTIMESMDashboard:{$type:"$dashboard",$title:"test AQMINTIMESM",$description:"test AQMINTIMESM",dashboardName:"testAQMINTIMESMDashboard"},testGaugeChartDashboard:{$type:"$dashboard",$title:"Test gauge chart",$description:"Test gauge chart",dashboardName:"testGaugeChartDashboard"},testExternalLink:{$type:"$external",$title:"Test external link",$description:"Test external link",externalUrl:"http://sage.com"},unitTestsDashboard:{$type:"$dashboard",$title:"Unit tests",$description:"Unit tests",dashboardName:"unitTestsDashboard"},testGridDashboard:{$type:"$dashboard",$title:"Test grid authoring",$description:"Test grid authoring",dashboardName:"testGridDashboard"},testDefaultAQTCRUDM:{$type:"$dashboard",$title:"AQTCRUDM",$description:"Test AQTCRUDM",dashboardName:"testDefaultAQTCRUDM"},testDefaultAQMCRUDM:{$type:"$dashboard",$title:"AQMCRUDM",$description:"Test AQMCRUDM",dashboardName:"testDefaultAQMCRUDM"},testDefaultAQMFIELDSM:{$type:"$dashboard",$title:"AQMFIELDSM",$description:"Test AQMFIELDSM",dashboardName:"testDefaultAQMFIELDSM"},testDefaultAQMSEARCHM:{$type:"$dashboard",$title:"AQMSEARCHM",$description:"Test AQMSEARCHM",dashboardName:"testDefaultAQMSEARCHM"},testAQMBLOBM:{$type:"$representation",$title:"AQMBLOBM",action:"$query",representation:"AQMBLOBM",facet:"$query"},testAQMCLOBM:{$type:"$representation",$title:"AQMCLOBM",action:"$query",representation:"AQMCLOBM",facet:"$query"},testAUTILISM:{$type:"$representation",$title:"AUTILISM",action:"$query",representation:"AUTILISM",facet:"$query"},testAutoUI_ContextDashboard:{$type:"$dashboard",$title:"Dashboard with context",$description:"Dashboard with context",dashboardName:"testContextDashboard"},testAutoUI_AQMDEVICE_Query:{$type:"$representation",$title:"AQMCRUDM",entity:"AQMDEVICE",action:"$query",representation:"AQMCRUDM",facet:"$query",endpoint:"x3.erp.UITEST"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testLayoutsDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testLayoutsDashboard:{$dashboardName:"testLayoutsDashboard",$title:"Layout test dashboard",$description:"Test different kinds of layouts",$vignettes:{testLayoutHubDashboard:{$uuid:"testLayoutHubDashboard",$displayStyle:"$link"},testLayoutRowsDashboard:{$uuid:"testLayoutRowsDashboard",$displayStyle:"$link"},testLongQuery:{$uuid:"testLongQuery",$displayStyle:"$link"},testHubLayoutEntity:{$uuid:"testHubLayoutEntity",$displayStyle:"$link"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testLayoutHubDashboard"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testLayoutRowsDashboard"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testLongQuery"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testHubLayoutEntity"}]}]}]}},testLayoutHubDashboard:{$dashboardName:"testLayoutHubDashboard",$title:"Hub dashboard (scroll horizontal)",$description:"Horizontal scrolling dashboard",$vignettes:{testDummyTile:{$uuid:"testDummyTile",$displayStyle:"$full"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Layout group 1",$items:[{$layoutType:"tile",$bgColor:"darkgrey",$items:[{$bind:"testDummyTile",$article:{$layoutType:"stack",$items:[{$bind:"name"},{$bind:"name",$labelPosition:"left"},{$bind:"desc",$labelPosition:"top"},{$bind:"desc2",$labelPosition:"right"},{$bind:"desc2",$labelAlign:"right"},{$bind:"amount",$labelPosition:"bottom"},{$bind:"amount",$isTitleHidden:!0}]}}],$size:"full"},{$layoutType:"tile",$bgColor:"darkgrey",$items:[{$bind:"testDummyTile"}],$size:"medium"},{$layoutType:"tile",$bgColor:"sagegreen",$items:[{$bind:"testDummyTile"}],$size:"small"},{$layoutType:"tile",$items:[{$bgColor:"darkgrey",$bind:"testDummyTile"}],$size:"small"},{$layoutType:"tile",$bgColor:"lightgreen",$items:[{$bind:"testDummyTile"}],$size:"small"},{$layoutType:"tile",$bgColor:"skyblue",$items:[{$bind:"testDummyTile"}],$size:"wide"},{$layoutType:"tile",$bgColor:"orange",$items:[{$bind:"testDummyTile"}],$size:"large"}]},{$layoutType:"hubGroup",$title:"Layout group 2",$items:[{$layoutType:"tile",$bgColor:"blue",$items:[{$bind:"testDummyTile"}],$size:"medium"},{$layoutType:"tile",$bgColor:"mediumgrey",$items:[{$bind:"testDummyTile"}],$size:"medium"},{$layoutType:"tile",$bgColor:"green",$items:[{$bind:"testDummyTile"}],$size:"medium"}]},{$layoutType:"hubGroup",$title:"Layout group 3",$items:[{$layoutType:"tile",$items:[{$bind:"testDummyTile"}],$size:"wide"},{$layoutType:"tile",$items:[{$bind:"testDummyTile"}],$size:"medium"},{$layoutType:"tile",$items:[{$bind:"testDummyTile"}],$size:"medium"}]},{$layoutType:"hubGroup",$title:"Layout group 4",$items:[{$layoutType:"tile",$items:[{$bind:"testDummyTile"}],$size:"large"},{$layoutType:"tile",$items:[{$bind:"testDummyTile"}],$size:"medium"},{$layoutType:"tile",$items:[{$bind:"testDummyTile"}],$size:"medium"}]},{$layoutType:"hubGroup",$title:"Layout group 5",$items:[{$layoutType:"tile",$items:[{$bind:"testDummyTile"}],$size:"wide"},{$layoutType:"tile",$items:[{$bind:"testDummyTile"}],$size:"full"},{$layoutType:"tile",$items:[{$bind:"testDummyTile"}],$size:"small"},{$layoutType:"tile",$items:[{$bind:"testDummyTile"}],$size:"small"},{$layoutType:"tile",$items:[{$bind:"testDummyTile"}],$size:"small"},{$layoutType:"tile",$items:[{$bind:"testDummyTile"}],$size:"small"},{$layoutType:"tile",$items:[{$bind:"testDummyTile"}],$size:"small"}]}]}},testLayoutRowsDashboard:{$dashboardName:"testLayoutRowsDashboard",$title:"Row layout dashboard (scroll vertical)",$description:"Vertical scrolling dashboard",$vignettes:{testDummyTile:{$uuid:"testDummyTile",$displayStyle:"$full"},testDummyTileLink:{$uuid:"testDummyTile",$displayStyle:"$link"}},$article:{$layoutType:"stack",$localization:{"en-US":{"67bfa0d4-958f-4929-9bd4-05a248e594c4":"On tablet portrait mode, this shows 4 cells in a line. On Mini-Tablet landscape (Nexus7) it shows three ons one cell per line. On Tablet landscape, it 2 per line. On phone or smaller its one per line"}},$items:[{$layoutType:"stack",$title:"{@67bfa0d4-958f-4929-9bd4-05a248e594c4}",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthLg:"3",$widthSm:"6",$widthXs:"12",$widthMd:"4",$items:[{$layoutType:"stack",$items:[{$bind:"testDummyTileLink",$article:{}}]}]},{$layoutType:"cell",$widthLg:"3",$widthSm:"6",$widthXs:"12",$widthMd:"4",$items:[{$layoutType:"stack",$items:[{$bind:"testDummyTileLink",$article:{}}]}]},{$layoutType:"cell",$widthLg:"3",$widthSm:"6",$widthXs:"12",$widthMd:"4",$items:[{$layoutType:"stack",$items:[{$bind:"testDummyTileLink",$article:{}}]}]},{$layoutType:"cell",$widthLg:"3",$widthSm:"6",$widthXs:"12",$widthMd:"12",$items:[{$layoutType:"stack",$items:[{$bind:"testDummyTileLink",$article:{}}]}]}]}]},{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthLg:"6",$widthSm:"6",$widthXs:"12",$items:[{$bind:"testDummyTile",$article:{$layoutType:"stack",$items:[{$bind:"name"},{$bind:"desc"},{$bind:"desc2"},{$bind:"amount"}]}}]},{$layoutType:"cell",$widthLg:"6",$widthSm:"6",$widthXs:"12",$items:[{$bind:"testDummyTile",$article:{$layoutType:"stack",$items:[{$bind:"name"},{$bind:"desc"},{$bind:"desc2"},{$bind:"amount"}]}}]},{$layoutType:"cell",$items:[{$widthLg:"3",$widthSm:"4",$widthXs:"12",$bind:"testDummyTile",$article:{$layoutType:"stack",$items:[{$bind:"name"},{$bind:"desc"},{$bind:"desc2"},{$bind:"amount"}]}}]},{$layoutType:"cell",$items:[{$widthLg:"3",$widthSm:"12",$widthXs:"12",$bind:"testDummyTile",$article:{$layoutType:"stack",$items:[{$bind:"name"},{$bind:"desc"},{$bind:"desc2"},{$bind:"amount"}]}}]}]}]}]}}},exports.gadgets={testLayoutHubDashboard:{$type:"$dashboard",$title:"Hub Layout tests",$description:"Hub Layout tests",dashboardName:"testLayoutHubDashboard"},testLayoutRowsDashboard:{$type:"$dashboard",$title:"Rows Layout tests",$description:"Rows Layout tests",dashboardName:"testLayoutRowsDashboard"},testDummyTile:{$type:"$representation",$title:"Dummy",$description:"Dummy",entity:"example",action:"$details",representation:"example",facet:"$details",keyParameter:"5"},testLongQuery:{$type:"$representation",$title:"Long query",$description:"Query",entity:"example",action:"$query",representation:"example",facet:"$query"},testHubLayoutEntity:{$type:"$representation",$title:"Hub Layout on Representation",$description:"Hub Layout on Representation",entity:"exampleHubLayout",action:"$details",representation:"exampleHubLayout",facet:"$details",keyParameter:"5"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testTypesDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testTypesDashboard:{$dashboardName:"testTypesDashboard",$title:"Datatypes test dashboard",$description:"Test different kinds of datatypes",$vignettes:{testLinkQueryRecord:{$uuid:"testDisplayQueryRecord",$displayStyle:"$link"},testLinkDetailsRecord:{$uuid:"testDisplayDetailsRecord",$displayStyle:"$link"},testLinkEditRecord:{$uuid:"testDisplayEditRecord",$displayStyle:"$link"},testLinkCreateRecord:{$uuid:"testDisplayCreateRecord",$displayStyle:"$link"},testDisplayQueryRecord:{$uuid:"testDisplayQueryRecord",$displayStyle:"$full"},testDisplayDetailsRecord:{$uuid:"testDisplayDetailsRecord",$displayStyle:"$full"},testDisplayEditRecord:{$uuid:"testDisplayEditRecord",$displayStyle:"$full"},testDisplayCreateRecord:{$uuid:"testDisplayCreateRecord",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testLinkQueryRecord"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testLinkDetailsRecord"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testLinkEditRecord"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testLinkCreateRecord"}]}]},{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testDisplayQueryRecord"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testDisplayDetailsRecord"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testDisplayEditRecord"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testDisplayCreateRecord"}]}]}]}}},exports.gadgets={testDisplayDetailsRecord:{$type:"$representation",$title:"Details facet",entity:"testDataTypes",action:"$details",representation:"testDataTypes",facet:"$details",keyParameter:"5"},testDisplayEditRecord:{$type:"$representation",$title:"Edit facet",entity:"testDataTypes",action:"$edit",representation:"testDataTypes",facet:"$edit",keyParameter:"5"},testDisplayCreateRecord:{$type:"$representation",$title:"Create facet",entity:"testDataTypes",action:"$create",representation:"testDataTypes",facet:"$create",keyParameter:"5"},testDisplayQueryRecord:{$type:"$representation",$title:"Query facet",entity:"testDataTypes",action:"$query",representation:"testDataTypes",facet:"$query",keyParameter:"5"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testFormatsDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testFormatsDashboard:{$dashboardName:"testFormatsDashboard",$title:"Formatting test dashboard",$description:"Test different kinds of formats",$vignettes:{testFormatEditRecord:{$uuid:"testFormatEditRecord",$displayStyle:"$full"},testFormatReferenceDetail:{$uuid:"testFormatReferenceDetail",$displayStyle:"$full"},testFormatReferenceEdit:{$uuid:"testFormatReferenceEdit",$displayStyle:"$full"},testFormatReferenceQuery:{$uuid:"testFormatReferenceQuery",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"4",$items:[{$bind:"testFormatEditRecord"}]},{$layoutType:"cell",$widthXs:"4",$items:[{$bind:"testFormatReferenceDetail"}]},{$layoutType:"cell",$widthXs:"4",$items:[{$bind:"testFormatReferenceEdit"}]}]},{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"4",$items:[{$bind:"testFormatReferenceQuery"}]}]}]}}},exports.gadgets={testFormatEditRecord:{$type:"$representation",$title:"Details facet",entity:"testFormats",action:"$edit",representation:"testFormats",facet:"$edit",keyParameter:"5"},testFormatReferenceDetail:{$type:"$representation",$title:"Details facet reference fields",entity:"testFormatsReference",action:"$details",representation:"testFormatsReference",facet:"$details",keyParameter:"5"},testFormatReferenceEdit:{$type:"$representation",$title:"Edit facet reference fields",entity:"testFormatsReference",action:"$edit",representation:"testFormatsReference",facet:"$edit",keyParameter:"5"},testFormatReferenceQuery:{$type:"$representation",$title:"Query facet reference fields",entity:"testFormatsReference",action:"$query",representation:"testFormatsReference",facet:"$query",keyParameter:"5"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testGX3APPDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testGX3APPDashboard:{$dashboardName:"testGX3APPDashboard",$title:"Display data from GX3APP",$description:"Test different representations on GX3APP",$vignettes:{testACTIVQuery:{$uuid:"testACTIVQuery",$displayStyle:"$full"},testRequestVEN085:{$uuid:"testRequestVEN085",$displayStyle:"$full"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Some data...",$items:[{$layoutType:"tile",$items:[{$bind:"testACTIVQuery"}],$size:"full"}]},{$layoutType:"hubGroup",$title:"Some fancy chart",$items:[{$layoutType:"tile",$items:[{$bind:"testRequestVEN085"}],$size:"large"}]}]}}},exports.gadgets={testACTIVQuery:{$type:"$representation",$title:"Query ACTIV",entity:"ACTIV",action:"$query",representation:"ACTIV",endpoint:"x3.erp.GX3APP",facet:"$query"},testRequestVEN085:{$type:"$request",$title:"Request VEN085",requestName:"VEN085",requestLevel:"1",action:"$query",endpoint:"x3.erp.GX3APP",facet:"$query"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testSUPERVDashboard",["require","exports","module"],function(require,exports,module){var _detailLinkArticle={$layoutType:"stack",$title:"Test collapsed",$collapsible:"collapsed",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"sagegreen",$items:[{$bind:"MODULE"},{$bind:"UPDUSR_REF"},{$bind:"CREUSR_REF"},{$bind:"UNIT_REF"},{$bind:"TDCB2"},{$bind:"SITE_REF"},{$bind:"QTY",$numDisplay:"normal"},{$bind:"WCUR_REF"},{$bind:"TEL"},{$bind:"TEXTAXX"},{$bind:"TDCB",$items:[{$bind:"WCUR_REF"}]},{$bind:"TEL"},{$bind:"TDATE"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"orange",$items:[{$bind:"CODE"},{$bind:"CODECHR"},{$bind:"TEXTDES0"},{$bind:"TEXTE"},{$bind:"CRY_REF"},{$bind:"CPY_REF"},{$bind:"CUR_REF"},{$bind:"TYPEATT"},{$bind:"HIDEWHOW"},{$bind:"EMAIL"},{$bind:"TEXTAXX"},{$bind:"TDCB3"},{$bind:"DIVERS0"},{$bind:"TPOSIF"}]}]},{$layoutType:"stack",$title:"Test collapsed",$collapsible:"collapsed",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"PBLOB"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"PBLOB2"}]}]}]},{$layoutType:"stack",$collapsible:"expanded",$title:"Test collapsible",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"ADEVCOLREF2",$article:{}},{$bind:"ADEVADEVCOL1",$article:{}},{$bind:"ADEVTABL",$article:{}}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"ADEVCOLREF1",$article:{}}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"ADEVCTINT",$article:{}}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"ADEVTABDATE",$article:{}}]}]}]},{$layoutType:"stack",$title:"Test collapsible",$collapsible:"expanded",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$items:[{$bind:"ADEVADEVICEL",$display:"card",$article:{}}]}]}]},{$layoutType:"stack",$collapsible:"expanded",$title:"Test collapsible",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"PCLOB"},{$bind:"TEXTHTML",$labelPosition:"top"},{$bind:"TYEPACD",$labelPosition:"top"},{$bind:"TYEPACB"},{$bind:"TEXTRTF",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"TEXTHTML",$labelPosition:"top"},{$bind:"TYEPACD",$labelPosition:"top"},{$bind:"TEXTPLAIN",$labelPosition:"top"}]}]}]}]},_queryLinkArticle={$layoutType:"stack",$items:[{$bind:"$resources",$display:"table",$detailLinkArticle:_detailLinkArticle,$table:[{$bind:"CODE",$title:"Code",$type:"application/x-integer",$titleOrig:"{@5296}",$widthType:"fixed",$widthVal:4},{$bind:"TEXTDES0",$title:"Description",$type:"application/x-string",$titleOrig:"{@282}",$widthType:"auto",$widthVal:0},{$bind:"CUR_REF",$title:"Currency",$type:"application/x-reference",$titleOrig:"{@323}",$widthType:"fixed",$widthVal:6,$refDescPosition:"bottom"},{$bind:"TDATE",$title:"Date",$type:"application/x-date",$titleOrig:"{@212}",$widthType:"fixed",$widthVal:6},{$bind:"CPY_REF",$title:"Company",$type:"application/x-reference",$titleOrig:"{@1343}",$widthType:"fixed",$widthVal:6,$refDescPosition:"bottom"},{$bind:"SITE_REF",$title:"Site",$type:"application/x-reference",$titleOrig:"{@1344}",$widthType:"fixed",$widthVal:6,$refDescPosition:"bottom"},{$bind:"CRY_REF",$title:"Country",$type:"application/x-reference",$titleOrig:"{@263}",$widthType:"fixed",$widthVal:6,$refDescPosition:"bottom"},{$bind:"TDCB2",$title:"4-décimal",$type:"application/x-decimal",$titleOrig:"{@28715}",$widthType:"fixed",$widthVal:6},{$bind:"UNIT_REF",$title:"Unit",$type:"application/x-reference",$titleOrig:"{@2685}",$widthType:"fixed",$widthVal:6}],$article:{}}]};exports.dashboards={testSUPERVDashboard:{$dashboardName:"testSUPERVDashboard",$title:"Display Query AQMCRUDM",$description:"",$vignettes:{testAQMDEVICEQuery:{$uuid:"testAQMDEVICEQuery",$displayStyle:"$full"},testAQMDEVICEQueryLink:{$uuid:"testAQMDEVICEQuery",$displayStyle:"$link"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$items:[{$layoutType:"tile",$title:"QUERY display in table mode 1",$size:"full",$items:[{$bind:"testAQMDEVICEQuery",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$arrayOptions:{showSortFilter:!0},$display:"table",$queryLinkArticle:_queryLinkArticle,$detailLinkArticle:_detailLinkArticle,$table:[{$bind:"CODE",$widthType:"fixed",$widthVal:"3"},{$bind:"TDATE",$widthType:"fixed",$widthVal:"4"},{$bind:"CUR_REF",$widthType:"fixed",$widthVal:"3",$refDescPosition:"bottom"},{$bind:"CPY_REF",$widthType:"fixed",$widthVal:"3",$refDescPosition:"none"}]}]}}]},{$layoutType:"tile",$title:"QUERY display in table mode 2",$size:"full",$items:[{$bind:"testAQMDEVICEQuery",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$arrayOptions:{showSortFilter:!0},$display:"table",$queryLinkArticle:_queryLinkArticle,$detailLinkArticle:_detailLinkArticle,$table:[{$bind:"CODE",$widthType:"fixed",$widthVal:"3"},{$bind:"TDATE",$widthType:"fixed",$widthVal:"4"},{$bind:"CUR_REF",$widthType:"fixed",$widthVal:"3",$refDescPosition:"bottom"},{$bind:"CPY_REF",$widthType:"fixed",$widthVal:"3",$refDescPosition:"none"}]}]}}]},{$layoutType:"tile",$title:"Open in card mode",$size:"medium",$items:[{$bind:"testAQMDEVICEQueryLink",$linkArticle:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$display:"card",$detailLinkArticle:_detailLinkArticle,$card:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"sagegreen",$items:[{$bind:"MODULE"},{$bind:"UPDUSR_REF"},{$bind:"CREUSR_REF"},{$bind:"UNIT_REF"},{$bind:"TDCB2"},{$bind:"SITE_REF"},{$bind:"TDATE"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"orange",$items:[{$bind:"CODE"},{$bind:"CODECHR"},{$bind:"TEXTDES0"},{$bind:"TEXTE"},{$bind:"CRY_REF"},{$bind:"CPY_REF"},{$bind:"CUR_REF"}]}]}]},$minWidth:4}]}}]},{$layoutType:"tile",$title:"Open in table mode",$size:"medium",$items:[{$bind:"testAQMDEVICEQueryLink",$linkArticle:{$layoutType:"stack",$items:[{$bind:"$resources",$display:"table",$detailLinkArticle:_detailLinkArticle,$table:[{$bind:"CODE",$widthType:"fixed",$widthVal:"5"},{$bind:"TDATE",$widthType:"fixed",$widthVal:"6"},{$bind:"CUR_REF",$widthType:"fixed",$widthVal:"3",$refDescPosition:"none"},{$bind:"CPY_REF",$widthType:"fixed",$widthVal:"6",$refDescPosition:"top"},{$bind:"SITE_REF",$widthType:"fixed",$widthVal:"10",$refDescFormat:"titledesc",$refDescPosition:"bottom"},{$bind:"TEXTDES0"}]}]}}]}]}]}}},exports.gadgets={testAQMDEVICEQuery:{$type:"$representation",$title:"Query AQMCRUDM",entity:"AQMDEVICE",action:"$query",representation:"AQMCRUDM",facet:"$query"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testChartsHubDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testChartsHubDashboard:{$dashboardName:"testChartsHubDashboard",$title:"Display charts (Hub)",$description:"Test different kind of charts",$vignettes:{testRequestChart:{$uuid:"testRequestChart",$displayStyle:"$full"},testRequestChart1:{$uuid:"testRequestChart",$displayStyle:"$full"},testRequestChart2:{$uuid:"testRequestChart",$displayStyle:"$full"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Big chart (!)",$items:[{$layoutType:"tile",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"bar"}]}}],$size:"full"},{$layoutType:"tile",$items:[{$bind:"testRequestChart1",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"bar"}]}}],$size:"large"}]},{$layoutType:"hubGroup",$title:"Bar charts",$items:[{$layoutType:"tile",$items:[{$bind:"testRequestChart2",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"stick"}]}}],$size:"large"},{$layoutType:"tile",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"bar"}]}}],$size:"large"}]},{$layoutType:"hubGroup",$title:"Line charts",$items:[{$layoutType:"tile",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"line"}]}}],$size:"large"},{$layoutType:"tile",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"area"}]}}],$size:"large"}]},{$layoutType:"hubGroup",$title:"Spline charts",$items:[{$layoutType:"tile",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"spline"}]}}],$size:"large"},{$layoutType:"tile",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"areaspline"}]}}],$size:"large"}]},{$layoutType:"hubGroup",$title:"Pie chart",$items:[{$layoutType:"tile",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"pie"}]}}],$size:"large"}]},{$layoutType:"hubGroup",$title:"Test different sizes/legends",$items:[{$layoutType:"tile",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$isLegendHidden:!1,$style:"line"}]}}],$size:"large"},{$layoutType:"tile",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$isLegendHidden:!0,$style:"line"}]}}],$size:"large"},{$layoutType:"tile",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$isLegendHidden:!0,$isXLabelHidden:!0,$isYLabelHidden:!0,$isXLabelsHidden:!0,$isYLabelsHidden:!0,$style:"line"}]}}],$size:"wide"},{$layoutType:"tile",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$isLegendHidden:!0,$isXLabelHidden:!0,$isYLabelHidden:!0,$isXLabelsHidden:!0,$isYLabelsHidden:!0,$style:"bar"}]}}],$size:"medium"}]}]}}},exports.gadgets={testRequestChart:{$type:"$request",$title:"Request test",requestName:"testCharts",requestLevel:"1",action:"$query",facet:"$query"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testChartsStackDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testChartsStackDashboard:{$dashboardName:"testChartsStackDashboard",$title:"Display charts (stack)",$description:"Test different kind of charts",$vignettes:{testRequestChart:{$uuid:"testRequestChart",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"12",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"bar"}]}}]},{$layoutType:"cell",$widthXs:"12",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"bar"}]}}]}]},{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"12",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"stick"}]}}]},{$layoutType:"cell",$widthXs:"12",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"bar"}]}}]}]},{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"12",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"line"}]}}]},{$layoutType:"cell",$widthXs:"12",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"area"}]}}]}]},{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"12",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"spline"}]}}]},{$layoutType:"cell",$widthXs:"12",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"areaspline"}]}}]}]},{$layoutType:"row",$title:"Pie chart",$items:[{$layoutType:"cell",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$style:"pie"}]}}]}]},{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"12",$widthSm:"6",$widthMd:"3",$widthLg:"3",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$isLegendHidden:!1,$style:"line"}]}}]},{$layoutType:"cell",$widthXs:"12",$widthSm:"6",$widthMd:"3",$widthLg:"3",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$isLegendHidden:!0,$style:"line"}]}}]},{$layoutType:"cell",$widthXs:"12",$widthSm:"6",$widthMd:"3",$widthLg:"3",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$isLegendHidden:!0,$isXLabelHidden:!0,$isYLabelHidden:!0,$isXLabelsHidden:!0,$isYLabelsHidden:!0,$style:"line"}]}}]},{$layoutType:"cell",$widthXs:"12",$widthSm:"6",$widthMd:"3",$widthLg:"3",$items:[{$bind:"testRequestChart",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!0,$isLegendHidden:!0,$isXLabelHidden:!0,$isYLabelHidden:!0,$isXLabelsHidden:!0,$isYLabelsHidden:!0,$style:"bar"}]}}]}]}]}}},exports.gadgets={}}),define("syracuse-tablet/html/js/demos/clientTestApp/testSUPERVDashboard2",["require","exports","module"],function(require,exports,module){exports.dashboards={testSUPERVDashboard2:{$dashboardName:"testSUPERVDashboard2",$title:"AQMCRUDM default endpoint",$description:"Test representation AQMCRUDM",$vignettes:{testAQTCRUDQuery:{$uuid:"testAQTCRUDQuery",$displayStyle:"$full"},testAQTCRUDQueryLink:{$uuid:"testAQTCRUDQuery",$displayStyle:"$link"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$widthXs:"6,1",$items:[{$bind:"testAQTCRUDQuery"},{$bind:"testAQTCRUDQueryLink"}]}]}}},exports.gadgets={testAQTCRUDQuery:{$type:"$representation",$title:"Query AQMCRUDM",entity:"AQMCRUDM",action:"$query",representation:"AQMCRUDM",facet:"$query"},testAQTCRUDQueryLink:{$type:"$representation",$title:"Query 10 AQMCRUDM",requestName:"10",requestLevel:"1",action:"$query",facet:"$query"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testGX3APPDashboard2",["require","exports","module"],function(require,exports,module){exports.dashboards={testGX3APPDashboard2:{$dashboardName:"testGX3APPDashboard2",$title:"Display data from GX3APP",$description:"Test PRPCOSTCTR representation on GX3APP",$vignettes:{testPRPCOSTCTRQuery:{$uuid:"testPRPCOSTCTRQuery",$displayStyle:"$full"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Some data Spending cost...",$items:[{$layoutType:"tile",$items:[{$bind:"testPRPCOSTCTRQuery"}],$size:"full"}]}]}}},exports.gadgets={testPRPCOSTCTRQuery:{$type:"$representation",$title:"Query PRPCOSTCTR",entity:"PRPCOSTCTR",action:"$query",representation:"PRPCOSTCTR",endpoint:"x3.erp.GX3APP",facet:"$query"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testConstraintsDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testConstraintsDashboard:{$dashboardName:"testConstraintsDashboard",$title:"Constraints test dashboard",$description:"Test SData constraints: https://github.com/Sage-ERP-X3/platform/wiki/Resource-Prototypes#type-constraints",$vignettes:{testConstraintsEditRecord:{$uuid:"testConstraintsEditRecord",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"12",$items:[{$bind:"testConstraintsEditRecord"}]}]}]}}},exports.gadgets={testConstraintsEditRecord:{$type:"$representation",$title:"Edit facet",entity:"testConstraints",action:"$edit",representation:"testConstraints",facet:"$edit",keyParameter:"5"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testNavigateToDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testContextDashboard:{$dashboardName:"testContextDashboard",$title:"Test dashboard parameters",$description:"Test navigation to a dashboard with parameters",$vignettes:{testRecordLinkToDashboard:{$uuid:"testRecordLinkToDashboard",$displayStyle:"$full"},testRecordLinkToDashboardLink:{$uuid:"testRecordLinkToDashboardLink",$displayStyle:"$full"},testRecordLinkToDashboardSUPERV:{$uuid:"testRecordLinkToDashboardSUPERV",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"4",$items:[{$bind:"testRecordLinkToDashboard"}]},{$layoutType:"cell",$widthXs:"4",$items:[{$bind:"testRecordLinkToDashboardLink"}]},{$layoutType:"cell",$widthXs:"4",$items:[{$bind:"testRecordLinkToDashboardSUPERV"}]}]}]}},testContextDashboardChild:{$dashboardName:"testContextDashboardChild",$title:"Child dashboard",$description:"Child dashboard getting parameters that are applied to the first to vignettes but not to the last one using the same representation to gather data",$vignettes:{testRecordWithContext1:{$uuid:"testRecordWithContext",$displayStyle:"$full"},testRecordWithContext2:{$uuid:"testRecordWithContext",$displayStyle:"$full"},testRecordWithoutContext:{$uuid:"testRecordWithoutContext",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"4",$items:[{$bind:"testRecordWithContext1"}]},{$layoutType:"cell",$widthXs:"4",$items:[{$bind:"testRecordWithContext2"}]},{$layoutType:"cell",$widthXs:"4",$items:[{$bind:"testRecordWithoutContext"}]}]}]}},testContextDashboardChildSUPERV:{$dashboardName:"testContextDashboardChildSUPERV",$title:"Child dashboard",$description:"Child dashboard getting parameters",$vignettes:{testRecordWithContextSUPERV:{$uuid:"testRecordWithContextSUPERV",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"12",$items:[{$bind:"testRecordWithContextSUPERV"}]}]}]}}},exports.gadgets={testRecordLinkToDashboard:{$type:"$representation",$title:"Click to navigate",entity:"testNavigateTo",action:"$query",representation:"testNavigateTo",facet:"$query"},testRecordWithContext:{$type:"$representation",$title:"Click to navigate",entity:"testNavigateToChild",action:"$query",representation:"testNavigateToChild",facet:"$query",parameters:{where:{value:"group eq '{group}'"}}},testRecordLinkToDashboardLink:{$type:"$dashboard",$title:"Open dashboard w/o params",dashboardName:"testContextDashboardChild"},testRecordWithoutContext:{$type:"$representation",$title:"Click to navigate",entity:"testNavigateToChild",action:"$query",representation:"testNavigateToChild",facet:"$query"},testRecordLinkToDashboardSUPERV:{$type:"$representation",$title:"Click to navigate",entity:"AQMDEVICEM",action:"$query",representation:"AQMDEVICEM",facet:"$query",endpoint:"x3.erp.UITEST"},testRecordWithContextSUPERV:{$type:"$representation",$title:"Click to navigate",entity:"AQMDEVICEM",action:"$query",representation:"AQMDEVICEM",facet:"$query",endpoint:"x3.erp.UITEST",parameters:{where:{value:"CODE eq {CODE}"}}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testPropertyHideShowDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testPropertyHideShowDashboard:{$dashboardName:"testPropertyHideShowDashboard",$title:"PropertyHideShow test dashboard",$description:"Test different kinds of PropertyHideShow",$vignettes:{testLinkQueryRecordHS:{$uuid:"testDisplayQueryRecordHS",$displayStyle:"$link"},testLinkDetailsRecordHS:{$uuid:"testDisplayDetailsRecordHS",$displayStyle:"$link"},testLinkEditRecordHS:{$uuid:"testDisplayEditRecordHS",$displayStyle:"$link"},testLinkCreateRecordHS:{$uuid:"testDisplayCreateRecordHS",$displayStyle:"$link"},testDisplayQueryRecordHS:{$uuid:"testDisplayQueryRecordHS",$displayStyle:"$full"},testDisplayDetailsRecordHS:{$uuid:"testDisplayDetailsRecordHS",$displayStyle:"$full"},testDisplayEditRecordHS:{$uuid:"testDisplayEditRecordHS",$displayStyle:"$full"},testDisplayCreateRecordHS:{$uuid:"testDisplayCreateRecordHS",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testLinkQueryRecordHS"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testLinkDetailsRecordHS"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testLinkEditRecordHS"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testLinkCreateRecordHS"}]}]},{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testDisplayQueryRecordHS"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testDisplayDetailsRecordHS"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testDisplayEditRecordHS"}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testDisplayCreateRecordHS"}]}]}]}}},exports.gadgets={testDisplayDetailsRecordHS:{$type:"$representation",$title:"Details facet",entity:"testPropertyHideShow",action:"$details",representation:"testPropertyHideShow",facet:"$details",keyParameter:"5"},testDisplayEditRecordHS:{$type:"$representation",$title:"Edit facet",entity:"testPropertyHideShow",action:"$edit",representation:"testPropertyHideShow",facet:"$edit",keyParameter:"5"},testDisplayCreateRecordHS:{$type:"$representation",$title:"Create facet",entity:"testPropertyHideShow",action:"$create",representation:"testPropertyHideShow",facet:"$create",keyParameter:"5"},testDisplayQueryRecordHS:{$type:"$representation",$title:"Query facet",entity:"testPropertyHideShow",action:"$query",representation:"testPropertyHideShow",facet:"$query",keyParameter:"5"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testAQTACTNPDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testAQTACTNPDashboard:{$dashboardName:"testAQTACTNPDashboard",$title:"AQTACTNP Facet Create",$description:"Test Facet Create AQTACTNP",$vignettes:{testAQTACTNPCreate:{$uuid:"testAQTACTNPCreate",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"testAQTACTNPCreate"}]}]}]}}},exports.gadgets={testAQTACTNPCreate:{$type:"$representation",$title:"Facet Create AQTACTNP",entity:"AQTACTNP",action:"$create",representation:"AQTACTNP",facet:"$create"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testQAQTGRAPDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testQAQTGRAPDashboard:{$dashboardName:"testQAQTGRAPDashboard",$title:"Display Query testQAQTGRAPDashboard",$description:"Test testQAQTGRAPDashboard SUPERV",$vignettes:{testQAQTGRAP_Request:{$uuid:"testQAQTGRAP_Request",$displayStyle:"$full"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$items:[{$layoutType:"tile",$items:[{$bind:"testQAQTGRAP_Request",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$display:"chart",$arrayOptions:{showPagination:!0,rowIndex:!0},$chartOptions:{isLegendHidden:!0}}]}}],$size:"all"}]}]}}},exports.gadgets={testQAQTGRAP_Request:{$type:"$request",$title:"Request QAQTGRAP",requestName:"QAQTGRA2",requestLevel:"99",action:"$query",endpoint:"",facet:"$query"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testSTATISTICDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testSTATISTICDashboard:{$dashboardName:"testSTATISTICDashboard",$title:"Display Query testSTATISTICDashboard",$description:"testSTATISTICDashboard SUPERV",$vignettes:{$testSTAT_Request:{$uuid:"$testSTAT_Request",$displayStyle:"$full"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$items:[{$layoutType:"tile",$items:[{$bind:"$testSTAT_Request",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$display:"chart",$arrayOptions:{showPagination:!0,rowIndex:!0},$chartOptions:{isLegendHidden:!0}}]}}],$size:"all"}]}]}}},exports.gadgets={$testSTAT_Request:{entity:"ZAQT",$type:"$stats",$title:"Stat ZAQT",statName:"ZAQT",action:"$query",representation:"STATS~ZAQT.$cube",facet:"$cube",endpoint:"",$uuid:"$testSTAT_Request"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testAQMPROJECTMDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testAQMPROJECTMDashboard:{$dashboardName:"testAQMPROJECTMDashboard",$title:"PROJECT Management",$description:"AQMPROJECTM Representation",$vignettes:{testDefaultAQMPROJECTM_QUERY:{$uuid:"testDefaultAQMPROJECTM_QUERY",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"testDefaultAQMPROJECTM_QUERY"}]},{}]}]}},LISTTASKBUD:{$dashboardName:"LISTTASKBUD",$title:"Budget-Task list",$description:"Budget Task List",$vignettes:{testDefaultAQMTASKM_QUERY:{$uuid:"testDefaultAQMTASKM_QUERY",$displayStyle:"$full"},testDefaultAQMBUDGETM_QUERY:{$uuid:"testDefaultAQMBUDGETM_QUERY",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$sameSize:!0,$widthAll:6,$items:[{$bind:"testDefaultAQMTASKM_QUERY"}]},{$layoutType:"cell",$sameSize:!0,$widthAll:6,$items:[{$bind:"testDefaultAQMBUDGETM_QUERY"}]}]}]}},LISTOPERAT:{$dashboardName:"LISTOPERAT",$title:"Operation list",$description:"Operation list",$vignettes:{testDefaultAQMOPERATM_QUERY:{$uuid:"testDefaultAQMOPERATM_QUERY",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$sameSize:!0,$widthAll:6,$items:[{$bind:"testDefaultAQMOPERATM_QUERY"}]}]}]}}},exports.gadgets={testDefaultAQMPROJECTM_QUERY:{$type:"$representation",$title:"Query facet",entity:"AQMPROJECT",action:"$query",representation:"AQMPROJECTM",facet:"$query"},testDefaultAQMTASKM_QUERY:{$type:"$representation",$title:"Query facet",entity:"AQMTASK",action:"$query",representation:"AQMTASKM",facet:"$query",parameters:{where:{value:"(PROJECT eq '{WCODE}')"}}},testDefaultAQMBUDGETM_QUERY:{$type:"$representation",$title:"Query facet",entity:"AQMBUDGET",action:"$query",representation:"AQMBUDGETM",facet:"$query",parameters:{where:{value:"(PROJECT eq '{WCODE}')"}}},testDefaultAQMOPERATM_QUERY:{$type:"$representation",$title:"Query facet",entity:"AQMOPERAT",action:"$query",representation:"AQMOPERATM",facet:"$query",parameters:{where:{value:"(PROJECT eq '{WCODE}' and TASKCODE eq '{WTASK}')"}}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testAQMOPERATMDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testAQMOPERATMDashboard:{$dashboardName:"testAQMOPERATMDashboard",$title:"AQMOPERATM default endpoint",$description:"AQMOPERATM Representation",$vignettes:{testDefaultAQMOPERATM_QUERY:{$uuid:"testDefaultAQMOPERATM_QUERY_2",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"testDefaultAQMOPERATM_QUERY"}]},{}]}]}},INPUTTIMES:{$dashboardName:"INPUTTIMES",$title:"Input times",$description:"Input times",$vignettes:{testDefaultAQMINTIMESM_QUERY:{$uuid:"testDefaultAQMINTIMESM_QUERY",$displayStyle:"$full"},testDefaultAQMINTIMESM_CREATE:{$uuid:"testDefaultAQMINTIMESM_CREATE",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$sameSize:!0,$widthAll:6,$items:[{$bind:"testDefaultAQMINTIMESM_QUERY"}]},{$layoutType:"cell",$sameSize:!0,$widthAll:6,$items:[{$bind:"testDefaultAQMINTIMESM_CREATE"}]}]}]}}},exports.gadgets={testDefaultAQMOPERATM_QUERY_2:{$type:"$representation",$title:"Query facet",entity:"AQMOPERATM",action:"$query",representation:"AQMOPERATM",facet:"$query",parameters:{where:{value:"(PROJECT eq '{WCODE}' and TASKCODE eq '{WTASK}')"}}},testDefaultAQMINTIMESM_CREATE:{$type:"$representation",$title:"Create facet",entity:"AQMINTIMES",action:"$create",representation:"AQMINTIMESM",facet:"$create",parameters:{context:{PROJECT:"{WPJM}",TASKCODE:"{WTASK}",OPERAT:"{WOPER}"}}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testAQMINTIMESMDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testAQMINTIMESMDashboard:{$dashboardName:"testAQMINTIMESMDashboard",$title:"AQMINTIMESM default endpoint",$description:"AQMINTIMESM Representation",$vignettes:{testDefaultAQMINTIMESM_QUERY:{$uuid:"testDefaultAQMINTIMESM_QUERY",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"testDefaultAQMINTIMESM_QUERY"}]},{}]}]}}},exports.gadgets={testDefaultAQMINTIMESM_QUERY:{$type:"$representation",$title:"Query facet",entity:"AQMINTIMESM",action:"$query",representation:"AQMINTIMESM",facet:"$query",parameters:{where:{value:"(PROJECT eq '{WPJM}' and TASKCODE eq '{WTASK}' and OPERAT eq {WOPER} )"}}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testGridDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testGridDashboard:{$dashboardName:"testGridDashboard",$title:"Arrays - Test dashboard",$description:"Arrays - Test dashboard",$vignettes:{testAQMDEVICEQueryGrid:{$uuid:"testAQMDEVICEQueryGrid",$displayStyle:"$full"},testAQMDEVICEDetailGrid:{$uuid:"testAQMDEVICEDetailGrid",$displayStyle:"$full"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"AQMCRUDM.$Query - Table Mode",$items:[{$layoutType:"tile",$size:"full",$items:[{$bind:"testAQMDEVICEQueryGrid",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$title:"QUERY - $display=table",$display:"table",$table:[{$bind:"CODE"},{$bind:"CODECHR"},{$bind:"TEXTDES0"},{$bind:"CUR_REF"}]}]}}]}]},{$layoutType:"hubGroup",$title:"AQMCRUDM.$Query - Vertical Cards - Multiple",$items:[{$layoutType:"tile",$size:"full",$items:[{$bind:"testAQMDEVICEQueryGrid",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$display:"card",$cardsPerRow:1,$emptycell:"filled",$article:{$items:[{$bind:"CODE"},{$bind:"CODECHR"},{$bind:"TEXTDES0"},{$bind:"CUR_REF"}]}}]}}]}]},{$layoutType:"hubGroup",$title:"AQMCRUDM.$Query - Vertical Cards - Single",$items:[{$layoutType:"tile",$size:"full",$items:[{$bind:"testAQMDEVICEQueryGrid",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$display:"card",$cardsPerRow:3,$emptycell:"filled",$article:{$items:[{$bind:"CODE"},{$bind:"CODECHR"},{$bind:"TEXTDES0"},{$bind:"CUR_REF"}]}}]}}]}]},{$layoutType:"hubGroup",$title:"$Details facet",$items:[{$layoutType:"tile",$size:"full",$items:[{$bind:"testAQMDEVICEDetailGrid"}]}]}]}}},exports.gadgets={testAQMDEVICEQueryGrid:{$type:"$representation",$title:"Query AQMCRUDM",entity:"AQMDEVICE",action:"$query",representation:"AQMCRUDM",facet:"$query"},testAQMDEVICEDetailGrid:{$type:"$representation",$title:"Detail AQMCRUDM",entity:"AQMDEVICE",action:"$details",representation:"AQMCRUDM",facet:"$details",keyParameter:"1"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testSUPERVAQTCRUDMDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testDefaultAQTCRUDM:{$dashboardName:"testDefaultAQTCRUDM",$title:"AQTCRUDM default endpoint",$description:"AQTCRUDM Representation",$vignettes:{testDefaultAQTCRUDM_AQTCRUDM_QUERY:{$uuid:"testDefaultAQTCRUDM_AQTCRUDM_QUERY",$displayStyle:"$full"},testDefaultAQTCRUDM_AQTCRUDM_DETAIL:{$uuid:"testDefaultAQTCRUDM_AQTCRUDM_DETAIL",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"testDefaultAQTCRUDM_AQTCRUDM_QUERY"}]},{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"testDefaultAQTCRUDM_AQTCRUDM_DETAIL"}]}]}]}}},exports.gadgets={testDefaultAQTCRUDM_AQTCRUDM_QUERY:{$type:"$representation",$title:"Query facet",entity:"AQTCRUDM",action:"$query",representation:"AQTCRUDM",facet:"$query"},testDefaultAQTCRUDM_AQTCRUDM_DETAIL:{$type:"$representation",$title:"Details facet",entity:"AQTCRUDM",action:"$details",representation:"AQTCRUDM",facet:"$details",keyParameter:"10"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testSUPERVAQMCRUDMDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testDefaultAQMCRUDM:{$dashboardName:"testDefaultAQMCRUDM",$title:"AQMCRUDM default endpoint",$description:"AQMCRUDM Representation",$vignettes:{testDefaultAQMCRUDM_AQMCRUDM_QUERY:{$uuid:"testDefaultAQMCRUDM_AQMCRUDM_QUERY",$displayStyle:"$full"},testDefaultAQMCRUDM_AQMCRUDM_DETAIL:{$uuid:"testDefaultAQMCRUDM_AQMCRUDM_DETAIL",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"testDefaultAQMCRUDM_AQMCRUDM_QUERY",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$display:"table",$table:[{$bind:"CODE"},{$bind:"CPY_REF"},{$bind:"CUR_REF"},{$bind:"I_do_not_exist"}]}]}}]},{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"testDefaultAQMCRUDM_AQMCRUDM_DETAIL"}]}]}]}},MobileDashboardOverview:{$dashboardName:"MobileDashboardOverview",$title:"MobileDashboardOverview",$description:"",$vignettes:{testDefaultAQTCRUDM_QUERY:{$uuid:"testDefaultAQTCRUDM_QUERY",$displayStyle:"$full"}}}},exports.gadgets={testDefaultAQMCRUDM_AQMCRUDM_QUERY:{$type:"$representation",$title:"Query facet",entity:"AQMCRUDM",action:"$query",representation:"AQMCRUDM",facet:"$query"},testDefaultAQMCRUDM_AQMCRUDM_DETAIL:{$type:"$representation",$title:"Details facet",entity:"AQMCRUDM",action:"$details",representation:"AQMCRUDM",facet:"$details",keyParameter:"10"},testDefaultAQTCRUDM_QUERY:{$type:"$representation",$title:"AQTCRUDM",action:"$query",representation:"AQTCRUDM",facet:"$query",parameters:{where:{value:"(CODE eq {WCODE})"}}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testSUPERVAQMTABLEMDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testDefaultAQMFIELDSM:{$dashboardName:"testDefaultAQMFIELDSM",$title:"AQMFIELDSM SUPERV endpoint",$description:"AQMFIELDSM Representation",$vignettes:{testDefaultAQMFIELDSM_AQMFIELDSM_QUERY:{$uuid:"testDefaultAQMFIELDSM_AQMFIELDSM_QUERY",$displayStyle:"$full"},testDefaultAQMFIELDSM_AQMFIELDSM_DETAIL:{$uuid:"testDefaultAQMFIELDSM_AQMFIELDSM_DETAIL",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"testDefaultAQMFIELDSM_AQMFIELDSM_QUERY"}]},{$layoutType:"cell",$widthXs:"6",$items:[{$bind:"testDefaultAQMFIELDSM_AQMFIELDSM_DETAIL"}]}]}]}}},exports.gadgets={testDefaultAQMFIELDSM_AQMFIELDSM_QUERY:{$type:"$representation",$title:"Query facet",entity:"AQMDEVICE",action:"$query",representation:"AQMFIELDSM",facet:"$query"},testDefaultAQMFIELDSM_AQMFIELDSM_DETAIL:{$type:"$representation",$title:"Details facet",entity:"AQMDEVICE",action:"$details",representation:"AQMFIELDSM",facet:"$details",keyParameter:"10"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testSUPERVAQMSEARCHMDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testDefaultAQMSEARCHM:{$dashboardName:"testDefaultAQMSEARCHM",$title:"AQMSEARCHM SUPERV",$description:"AQMSEARCHM Representation",$vignettes:{testDefaultAQMSEARCHM_AQMSEARCHM_QUERY:{$uuid:"testDefaultAQMSEARCHM_AQMSEARCHM_QUERY",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"12",$items:[{$bind:"testDefaultAQMSEARCHM_AQMSEARCHM_QUERY"}]}]}]}}},exports.gadgets={testDefaultAQMSEARCHM_AQMSEARCHM_QUERY:{$type:"$representation",$title:"Query facet",entity:"AQMSEARCH",action:"$query",representation:"AQMSEARCHM",facet:"$query"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/unitTests/entities/entityCtrlField",["require","exports","module","syracuse-tablet/html/js/sdata/entities/clientContract"],function(require,exports,module){var clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),_entityName="controlField",_details={decimalEmpty:null,decimalFilled:123456.789,integerEmpty:null,integerFilled:123456789,realEmpty:null,realFilled:123456.789,quantityEmpty:null,quantityFilled:123,quantityUnit:{$description:"EURO euro",$precision:11,$scale:2,$symbol:"€",$title:"Euro"},quantityUnitVal:"EUR",dateEmpty:"",dateFilled:"2015-01-23",timeEmpty:"",timeFilled:"11:12:13",datetimeEmpty:"",datetimeFilled:"2015-01-23T11:12:13Z",choiceEmpty:"",choiceFilled:"MYCHOICE",booleanFilled:!0,booleanEmpty:null,referenceEmptyVal:"",referenceFilledVal:"MYREF",referenceFilled:{$description:"My description",$title:"My title"},stringEmpty:"",stringFilled:"MY STRING",textRtfEmpty:"",textRtfFilled:"",textHtmlEmpty:"",textHtmlFilled:"<b>MY HTML</b>",textPlainEmpty:"",textPlainFilled:"MY TEXT",imageEmpty:"",imageFilled:{}},_fields=["decimal","integer","real","quantity","date","time","datetime","choice","boolean","reference","string","textPlain","textRtf","textHtml","image"],_unitTestCallBack=function(structElmt){},_buildDetailsLayout=function(){var _addUnitTestInfo=function(article,message){article.$unitTest={message:message}},rows=[];return _fields.forEach(function(field){var row={$layoutType:"row",$items:[]};rows.push(row);var cells=row.$items;["filled","empty"].forEach(function(type){var cell={$layoutType:"cell",$sameSize:!0,$widthAll:4,$items:[{$bind:field+type.smCapitalize()}]};type==="filled"?_addUnitTestInfo(cell.$items[0],"Title and value should be displayed"):(_addUnitTestInfo(cell.$items[0],field==="image"?"Only title and empty image icon should be displayed":"Only title should be displayed"),cells.push(cell),cell=$.extend(!0,{},cell),cell.$items[0].$hideIfEmpty=!0,_addUnitTestInfo(cell.$items[0],"No title and value should be displayed")),cells.push(cell)})}),{$layoutType:"stack",$items:rows}},_entity={$entityName:_entityName,$properties:{decimalEmpty:{$title:"decimalEmpty",$type:"application/x-decimal"},decimalFilled:{$title:"decimalFilled",$type:"application/x-decimal"},integerEmpty:{$title:"integerEmpty",$type:"application/x-integer"},integerFilled:{$title:"integerFilled",$type:"application/x-integer"},realEmpty:{$title:"realEmpty",$type:"application/x-real"},realFilled:{$title:"realFilled",$type:"application/x-real"},quantityEmpty:{$title:"quantityEmpty",$type:"application/x-quantity"},quantityFilled:{$title:"quantityFilled",$type:"application/x-quantity",$unit:"quantityUnit",$value:{$title:"{$value} {$unit}",$type:"application/x-decimal",$precision:9,$scale:2,$format:"0.00"}},quantityUnit:{$title:"quantityUnit",$type:"application/x-reference",$item:{$value:"{quantityUnitVal}"}},dateEmpty:{$title:"dateEmpty",$type:"application/x-date"},dateFilled:{$title:"dateFilled",$type:"application/x-date"},timeEmpty:{$title:"timeEmpty",$type:"application/x-time"},timeFilled:{$title:"timeFilled",$type:"application/x-time"},datetimeEmpty:{$title:"datetimeEmpty",$type:"application/x-datetime"},datetimeFilled:{$title:"datetimeFilled",$type:"application/x-datetime"},choiceEmpty:{$title:"choiceEmpty",$type:"application/x-choice"},choiceFilled:{$title:"choiceFilled",$type:"application/x-choice"},booleanFilled:{$title:"booleanFilled",$type:"application/x-boolean"},booleanEmpty:{$title:"booleanEmpty",$type:"application/x-boolean"},referenceEmpty:{$title:"referenceEmpty",$type:"application/x-reference",$item:{$value:"{VALUE}",$key:"{VALUE}",$properties:{VALUE:{$type:"application/x-string"}},VALUE:"{referenceEmptyVal}"}},referenceFilled:{$title:"referenceFilled",$type:"application/x-reference",$item:{$value:"{referenceFilledVal}"}},stringEmpty:{$title:"stringEmpty",$type:"application/x-string"},stringFilled:{$title:"stringFilled",$type:"application/x-string"},textRtfEmpty:{$title:"textRtfEmpty",$type:"text/rtf",$url:clientContract.getLocalEntityUrl(_entityName,"/textRtfEmpty")},textRtfFilled:{$title:"textRtfFilled",$type:"text/rtf",$acceptedTypes:["text/rtf"],$url:clientContract.getLocalEntityUrl(_entityName,"/textRtfFilled")},textHtmlEmpty:{$title:"textHtmlEmpty",$type:"text/html",$url:clientContract.getLocalEntityUrl(_entityName,"/textHtmlEmpty")},textHtmlFilled:{$title:"textHtmlFilled",$type:"text/html",$url:clientContract.getLocalEntityUrl(_entityName,"/textHtmlFilled")},textPlainEmpty:{$title:"textPlainEmpty",$type:"text/plain",$url:clientContract.getLocalEntityUrl(_entityName,"/textPlainEmpty")},textPlainFilled:{$title:"textPlainFilled",$type:"text/plain",$acceptedTypes:["text/plain"],$url:clientContract.getLocalEntityUrl(_entityName,"/textPlainFilled")},imageEmpty:{$title:"imageEmpty",$type:"image",$url:clientContract.getLocalEntityUrl(_entityName,"/imageEmpty")},imageFilled:{$title:"imageFilled",$type:"image",$url:clientContract.getLocalEntityUrl(_entityName,"/imageFilled")}},$relations:{},$articles:{$details:_buildDetailsLayout()},$services:{$read:function(op,data){var deferred=$.Deferred(),result=op.$representation&&op.$representation.endsWith("$details")?_details:null;return deferred.resolve($.extend({},result)),deferred.promise()}},$urlCall:function(sdataUrl,path){if(!path||path.length==0)return"";switch(path[0]){case"textRtfEmpty":return null;case"textRtfFilled":return{responseText:"{\\rtf1\\ansi{\\fonttbl{\\f0 MS Sans Serif;}}\\uc0\\pard MY RTF CONTENT\\par}"};case"textHtmlEmpty":return null;case"textHtmlFilled":return{responseText:'<span style="color:red"><b>MY HTML CONTENT</b></span>'};case"textPlainEmpty":return null;case"textPlainFilled":return{responseText:"MY TEXT PLAIN CONTENT"};case"imageEmpty":return null;case"imageFilled":return"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAUDBAQEAwUEBAQFBQUGBwwIBwcHBw8LCwkMEQ8SEhEPERETFhwXExQaFRERGCEYGh0dHx8fExciJCIeJBweHx7/2wBDAQUFBQcGBw4ICA4eFBEUHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh7/wAARCAAzAHEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD7Looqrqd5b6dp91qF3II7a2heaZiPuooyx/IUCbSV2Wsj1oyK+V9e+NHj7xRrR0/whbvZxO5EEFrbCe4kUd2JB57/ACgY9+8Vxqfx90qP7bN/wkQjQZJa3WYAepUKePwrT2TPBfENFt+zhKSXVLQ+rcj1or5hs/jd8RG8JXlz/YlvcG3kWKTVBbNshJ7Oo+Xd+QHAwcisq1vfjv4ij/tC0l8RtE4LK0a+RGw65UYUH2xR7N9QfEFF2VKEpN9kfWeR60ZHrXyZp/xW+JvgrV0sfEYuLpUwXtNSh2uy9Mq+N3Y4b5h7GrHjb45+LNe1EWnhZZNJtGKpGiRrJcyk9icHBz0C4PuaPZMX+seFUG5JqS6W1PqvI9aMj1FfKdr4x+NvhhF1jU7bWJrBfmlXULImPb/tHAKfXIrIi+NPjkeIUv5NWlewF2JmsdsYUxb8+Vu25xt+XPWn7JilxJh4WU4ST81+O59h5FGRXyna+PfjJ48vph4cNwsMZyY7GBEjiz0BkbnP1b8Kvjx/8Xvh/ewN4wsp7uwd9pW5RCreoWaPPze2T9D1pezZa4gov3uSXJ/NbQ+nciisTwb4j03xX4dttc0ty1vOM7WwGjYdVYA8EGtsdKzPbhONSKlF3TCiiigsKyfFmlrrvhnVNGaQR/bbWW3Dn+AspAb8Cc/hWtXPePfE9p4Q8NXWuXlvcXMcOAIoEJLMemT0UepPT3OAWt9DKu4KnJ1Phtr6HydpM3jT4R+LXvX0r7Pcqj27faYS8EyEg8MMZGQDlW9vau9tf2kdWX/j58M2EowOY7l05/EGuh8H/tCaJfI0HirT5dOkLHEsCGWErngEfeBxx0OcE8ZxWh4j+JfwYu9Pna5js9XYr/qRpT73OP7zoADwOcjHFbPV6o+Qw8YUoN4XFqMd7O36/wCRnW/7QPhN9CuJLnw7dRXrvlrJQjxyk9WLkD05JXPTg84x5P2lLouRH4RhC5woa/JP4/JXgxe3N6X8hlt/Mz5av8wXP3QcHnHfFfVvhXxp8FxpMMVk+jafGqD9xcWex145BJX5j6nJ+tOUYx6EYLMcXjG4uvGFvJa/f/XkeE/F34iv8QpdNmk0aPTnsVkXKTeYZA+08nAxgqcdeprq/wBkmwguPG+o30sSO1rY/uiRyjO4GR6HaCM+h96yP2hvEnhLxBrenx+E47cw2sbieeG28pZGYgccAnAXr78VlfBLxxD4G8WvfX0MsthdQGC4EWNyjIIcA4BIIxj0J9qpr3NDghWjTzRTrTUkmry6beXY+ypESSNo3VXUjDKwyCPevhHxxZW+m+Ndd060XZbWuo3EMK5zhFkZVH5AV9Q3nx1+HkGnm4h1G7uZdpP2eO0kD59MsAv618o63fNqes32pPGI2u7iScoDkKWYtj8M1NJNbnocS4rD1401Tkm1fbU9f+HHxr0vwf4QstCi8LSSvACZZUulXzXLEliNvuB16AelT+PPjjpnivwnf6DN4UlT7VEVjke7DeXIOVbG3sRV34P+PPhpH4Xs9H8U6Vp1nqFopQ3E+niVJxkkHcFJDeueOOD2Gx4u+J/wm0m226L4c0zXLo4+SPT0ijHP8TOnp6A/hSsr7FU61R4RJ4qKja1rK+21txv7H13K/h7XrJmJhhuo5VHoXQg/oi17wOlcl8MtV8N694bXWfDWmR2FvO+2WMWohO9eoOBhsZxkZH4giutHQVlN3Z9LllFUcLCClzK24UUUVJ3hUckayIyOisrAqVIyCD1BqSigDzfxJ8FfAOtzvcf2ZLpsz53NYSeWD9EIKj8AKxrb9njwPFOskl5rtwB1SS4jAb2O2MH8jXsNFVzy7nBPK8HOXM6av6HES/CrwFJoI0Y+G7VbdTuDqW84N6+Znd+ZxXHT/s6eDnn3RaprkUR6p5sZ/IlP8fxr2iihTkuo6mWYSpbmprTyPIdV+AXgy6tLS2tZtQsTBu3yo6tJOTjlywPTbwAABk8c1hX3gj4LQTWfgy/1tYdXtkfN2k6xyElydsj48veN2ACN2FA9K93kUOGRlypBByOteGeOP2ebC+vJb3wxqZ08yMWa0uVLxg/7Lj5gPYhqqMr7s87HZdGlHmw1CMn1T7abdPn+ZbX4V/CbwlbtrOs6jJd28A3qt9eIytjnAVFXefRec14x4EtovFXxrsnt7FFtbrV2vDbBBsWFXMpUjptCjGPw712Vl+zj4re4C3utaLFDnl4mlkbH0KL/ADr2f4XfDPQ/AUEj2bSXmozLsmvJlAYr12qB91c84yScDJOBV8yit7nmwy6ti6sL0VShF3fd/qY2ufAfwFqdwZ4YL/SyxJK2VwAh+gdWA+gwKNC+A/gLTLgTzQX+plSCq3twCoI9kVQfxzXqY6UVlzy7n0X9l4Pm5/Zq/oQWtvDa20dvbQRwwxqFSONAqqB2AHAFTjpRRUnclbYKKKKBhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf/9k=";default:return null}}};exports.entity=_entity}),define("syracuse-tablet/html/js/demos/clientTestApp/unitTests/entities/entityNativeFields",["require","exports","module"],function(require,exports,module){var _entityName="nativeFields",_unitTestCallBack=function(structElmt){},_entity={$entityName:_entityName,$title:"Test native fields",$properties:{barcode:{$title:"Barcode",$type:"application/x-string"},imageOriginal:{$title:"Image Original",$type:"image"},imageSmall:{$title:"Image Small",$type:"image"},imageMedium:{$title:"Image Medium",$type:"image"},imageLarge:{$title:"Image Large",$type:"image"}},$relations:{},$articles:{$edit:{$title:"Test barcode",$layoutType:"stack",$items:[{$bind:"barcode",$scanBarcode:!0},{$bind:"imageOriginal",$imgScale:"original"},{$bind:"imageSmall",$imgScale:"small"},{$bind:"imageMedium",$imgScale:"medium"},{$bind:"imageLarge",$imgScale:"large"}]}},$services:{$read:function(op,data){var deferred=$.Deferred(),result=null;return deferred.resolve($.extend({},result)),deferred.promise()}},$urlCall:function(sdataUrl,path){return""}};exports.entity=_entity}),define("syracuse-tablet/html/js/demos/clientTestApp/unitTests/unitTestCtrlField",["require","exports","module"],function(require,exports,module){exports.init=function(nameModule,dashboards,gadgets){gadgets[nameModule]={$type:"$representation",$title:"Control Field",entity:"controlField",action:"$details",representation:"controlField",facet:"$details",$article:{}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/unitTests/unitTestNativeFields",["require","exports","module"],function(require,exports,module){exports.init=function(nameModule,dashboards,gadgets){gadgets[nameModule]={$type:"$representation",$title:"Test native fields",entity:"nativeFields",action:"$edit",representation:"nativeFields",facet:"$edit",$article:{}}}}),define("syracuse-tablet/html/js/demos/clientTestApp/unitTestsDashboard",["require","exports","module","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/demos/clientTestApp/unitTests/entities/entityCtrlField","syracuse-tablet/html/js/demos/clientTestApp/unitTests/entities/entityNativeFields","syracuse-tablet/html/js/demos/clientTestApp/unitTests/unitTestCtrlField","syracuse-tablet/html/js/demos/clientTestApp/unitTests/unitTestNativeFields"],function(require,exports,module){var clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),entities=[require("syracuse-tablet/html/js/demos/clientTestApp/unitTests/entities/entityCtrlField"),require("syracuse-tablet/html/js/demos/clientTestApp/unitTests/entities/entityNativeFields")],modules={unitTestCtrlField:require("syracuse-tablet/html/js/demos/clientTestApp/unitTests/unitTestCtrlField"),unitTestNativeFields:require("syracuse-tablet/html/js/demos/clientTestApp/unitTests/unitTestNativeFields")},_initModules=function(){var vignettes=exports.dashboards.unitTestsDashboard.$vignettes,tiles=exports.dashboards.unitTestsDashboard.$article.$items[0].$items;for(var name in modules)vignettes[name]={$uuid:name,$displayStyle:"$link"},tiles.push({$layoutType:"tile",$bgColor:"lightgreen",$items:[{$bind:name}],$size:"medium"}),modules[name].init(name,exports.dashboards,exports.gadgets),entities.forEach(function(entity){entity.entity&&clientContract.registerEntity(entity.entity)})};exports.dashboards={unitTestsDashboard:{$dashboardName:"unitTestsDashboard",$title:"Unit Tests Dashboard",$description:"",$vignettes:{},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Unit Tests Group 1",$items:[]}]}}},exports.gadgets={},_initModules()}),define("syracuse-tablet/html/js/demos/clientTestApp/testGaugeChartDashboard",["require","exports","module"],function(require,exports,module){exports.dashboards={testGaugeChartDashboard:{$dashboardName:"testGaugeChartDashboard",$title:"Gauge chart test dashboard",$description:"Test different gauge charts authoring",$vignettes:{testGauge:{$uuid:"testGauge",$displayStyle:"$full"}},$article:{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testGauge",$article:{$layoutType:"stack",$items:[{$bind:"salesOp",$gauge:{}}]}}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testGauge",$article:{$layoutType:"stack",$items:[{$bind:"salesOp",$gauge:{segments:[{propStart:0,propEnd:.75},{propStart:.75,propEnd:.85},{propStart:.85,propEnd:1}]}}]}}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testGauge",$article:{$layoutType:"stack",$items:[{$bind:"salesValue",$gauge:{$bindMin:"salesValueMin",$bindMax:"salesValueMax",segments:[{propStart:0,propEnd:.75},{propStart:.75,propEnd:.85},{propStart:.85,propEnd:1}]}}]}}]},{$layoutType:"cell",$widthXs:"3",$items:[{$bind:"testGauge",$article:{$layoutType:"stack",$items:[{$bind:"salesValue",$gauge:{$bindMin:"salesValueMin",$bindMax:"salesValueMax",segments:[{valStart:1e5,valEnd:13e4,color:"#DF5353"},{valStart:13e4,valEnd:14e4},{valStart:14e4,valEnd:15e4,color:"#55BF3B"}]}}]}}]}]}]}}},exports.gadgets={testGauge:{$type:"$representation",$title:"Gauge 1",entity:"testGaugeChart",action:"$details",representation:"testGaugeChart",facet:"$details"}}}),define("syracuse-tablet/html/js/demos/clientTestApp/testApplication",["require","exports","module","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/demos/clientTestApp/example","syracuse-tablet/html/js/demos/clientTestApp/exampleHubLayout","syracuse-tablet/html/js/demos/clientTestApp/testDatatypes","syracuse-tablet/html/js/demos/clientTestApp/testFormats","syracuse-tablet/html/js/demos/clientTestApp/testFormatsReference","syracuse-tablet/html/js/demos/clientTestApp/testCharts","syracuse-tablet/html/js/demos/clientTestApp/testConstraints","syracuse-tablet/html/js/demos/clientTestApp/testNavigateTo","syracuse-tablet/html/js/demos/clientTestApp/testNavigateToChild","syracuse-tablet/html/js/demos/clientTestApp/testPropertyHideShow","syracuse-tablet/html/js/demos/clientTestApp/testGaugeChart","syracuse-tablet/html/js/demos/clientTestApp/testHomeDashboard","syracuse-tablet/html/js/demos/clientTestApp/testLayoutsDashboard","syracuse-tablet/html/js/demos/clientTestApp/testTypesDashboard","syracuse-tablet/html/js/demos/clientTestApp/testFormatsDashboard","syracuse-tablet/html/js/demos/clientTestApp/testGX3APPDashboard","syracuse-tablet/html/js/demos/clientTestApp/testSUPERVDashboard","syracuse-tablet/html/js/demos/clientTestApp/testChartsHubDashboard","syracuse-tablet/html/js/demos/clientTestApp/testChartsStackDashboard","syracuse-tablet/html/js/demos/clientTestApp/testSUPERVDashboard2","syracuse-tablet/html/js/demos/clientTestApp/testGX3APPDashboard2","syracuse-tablet/html/js/demos/clientTestApp/testConstraintsDashboard","syracuse-tablet/html/js/demos/clientTestApp/testNavigateToDashboard","syracuse-tablet/html/js/demos/clientTestApp/testPropertyHideShowDashboard","syracuse-tablet/html/js/demos/clientTestApp/testAQTACTNPDashboard","syracuse-tablet/html/js/demos/clientTestApp/testQAQTGRAPDashboard","syracuse-tablet/html/js/demos/clientTestApp/testSTATISTICDashboard","syracuse-tablet/html/js/demos/clientTestApp/testAQMPROJECTMDashboard","syracuse-tablet/html/js/demos/clientTestApp/testAQMOPERATMDashboard","syracuse-tablet/html/js/demos/clientTestApp/testAQMINTIMESMDashboard","syracuse-tablet/html/js/demos/clientTestApp/testGridDashboard","syracuse-tablet/html/js/demos/clientTestApp/testSUPERVAQTCRUDMDashboard","syracuse-tablet/html/js/demos/clientTestApp/testSUPERVAQMCRUDMDashboard","syracuse-tablet/html/js/demos/clientTestApp/testSUPERVAQMTABLEMDashboard","syracuse-tablet/html/js/demos/clientTestApp/testSUPERVAQMSEARCHMDashboard","syracuse-tablet/html/js/demos/clientTestApp/unitTestsDashboard","syracuse-tablet/html/js/demos/clientTestApp/testGaugeChartDashboard"],function(require,exports,module){function _addToApp(app){app.gadgets&&Object.keys(app.gadgets).forEach(function(key){_testApplication.$gadgets[key]&&console.log("Duplicate gadget name: "+key),_testApplication.$gadgets[key]=app.gadgets[key]}),app.dashboards&&Object.keys(app.dashboards).forEach(function(key){_testApplication.$dashboards[key]&&console.log("Duplicate dashboard name: "+key),_testApplication.$dashboards[key]=app.dashboards[key]})}var clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),_example=require("syracuse-tablet/html/js/demos/clientTestApp/example"),_exampleHubLayout=require("syracuse-tablet/html/js/demos/clientTestApp/exampleHubLayout"),_testDatatypes=require("syracuse-tablet/html/js/demos/clientTestApp/testDatatypes"),_testFormats=require("syracuse-tablet/html/js/demos/clientTestApp/testFormats"),_testFormatsReference=require("syracuse-tablet/html/js/demos/clientTestApp/testFormatsReference"),_testCharts=require("syracuse-tablet/html/js/demos/clientTestApp/testCharts"),_testConstraints=require("syracuse-tablet/html/js/demos/clientTestApp/testConstraints"),_testNavigateTo=require("syracuse-tablet/html/js/demos/clientTestApp/testNavigateTo"),_testNavigateToChild=require("syracuse-tablet/html/js/demos/clientTestApp/testNavigateToChild"),_testPropertyHideShow=require("syracuse-tablet/html/js/demos/clientTestApp/testPropertyHideShow"),_testGaugeChart=require("syracuse-tablet/html/js/demos/clientTestApp/testGaugeChart"),_testHomeDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testHomeDashboard"),_testLayoutsDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testLayoutsDashboard"),_testTypesDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testTypesDashboard"),_testFormatsDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testFormatsDashboard"),_testGX3APPDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testGX3APPDashboard"),_testSUPERVDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testSUPERVDashboard"),_testChartsHubDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testChartsHubDashboard"),_testChartsStackDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testChartsStackDashboard"),_testSUPERVDashboard2=require("syracuse-tablet/html/js/demos/clientTestApp/testSUPERVDashboard2"),_testGX3APPDashboard2=require("syracuse-tablet/html/js/demos/clientTestApp/testGX3APPDashboard2"),_testConstraintsDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testConstraintsDashboard"),_testNavigateToDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testNavigateToDashboard"),_testPropertyHideShowDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testPropertyHideShowDashboard"),_testAQTACTNPDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testAQTACTNPDashboard"),_testQAQTGRAPDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testQAQTGRAPDashboard"),_testSTATISTICDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testSTATISTICDashboard"),_testAQMPROJECTMDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testAQMPROJECTMDashboard"),_testAQMOPERATMDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testAQMOPERATMDashboard"),_testAQMINTIMESMDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testAQMINTIMESMDashboard"),_testGridDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testGridDashboard"),_testDefaultAQTCRUDM=require("syracuse-tablet/html/js/demos/clientTestApp/testSUPERVAQTCRUDMDashboard"),_testDefaultAQMCRUDM=require("syracuse-tablet/html/js/demos/clientTestApp/testSUPERVAQMCRUDMDashboard"),_testDefaultAQMFIELDSM=require("syracuse-tablet/html/js/demos/clientTestApp/testSUPERVAQMTABLEMDashboard"),_testDefaultAQMSEARCHM=require("syracuse-tablet/html/js/demos/clientTestApp/testSUPERVAQMSEARCHMDashboard"),_unitTestsDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/unitTestsDashboard"),_testGaugeChartDashboard=require("syracuse-tablet/html/js/demos/clientTestApp/testGaugeChartDashboard"),_testApplication={$application:{$uuid:"clientTestApplication",applicationName:"clientTestApplication",title:"Client test application",description:"Application for testing client features without server dependencies",iconName:"th",$homeDashboard:{$uuid:"testHomeDashboard",dashboardName:"testHomeDashboard"}},$dashboards:{},$gadgets:{},$pages:{"x3.erp.UITEST.AQMCRUDM.$details":{$page:{$article:{$layoutType:"stack",$items:[{$bind:"CODE"},{$bind:"PBLOB"},{$bind:"CODECHR"},{$bind:"WCUR_REF"},{$bind:"FLGTEST"},{$bind:"WMENU"},{$bind:"SIMUL1"},{$bind:"PCLOB"},{$bind:"TEXTAXX"},{$bind:"TEXTE"},{$bind:"TPOSIF"},{$bind:"CUR_REF"},{$bind:"SITE_REF"},{$bind:"TDCB2"},{$bind:"TDCB3",$gauge:{}},{$bind:"TDCB"},{$bind:"TDATE"},{$bind:"UNIT_REF"},{$bind:"CRY_REF"},{$bind:"TEL"},{$bind:"EMAIL"},{$bind:"TEXTPLAIN"},{$bind:"TEXTHTML"},{$bind:"TEXTRTF"},{$bind:"CREUSR_REF"},{$bind:"UPDUSR_REF"},{$bind:"ADEVCOLREF1"},{$bind:"ADEVCOLREF2"},{$bind:"ADEVCTINT"},{$bind:"ADEVADEVICEL"}]}}}}};exports.register=function(){clientContract.registerEntity(_example.entity),clientContract.registerEntity(_exampleHubLayout.entity),clientContract.registerEntity(_testDatatypes.entity),clientContract.registerEntity(_testFormats.entity),clientContract.registerEntity(_testFormatsReference.entity),clientContract.registerEntity(_testCharts.entity),clientContract.registerEntity(_testConstraints.entity),clientContract.registerEntity(_testNavigateTo.entity),clientContract.registerEntity(_testNavigateToChild.entity),clientContract.registerEntity(_testPropertyHideShow.entity),clientContract.registerEntity(_testGaugeChart.entity),_addToApp(_testHomeDashboard),_addToApp(_testLayoutsDashboard),_addToApp(_testTypesDashboard),_addToApp(_testFormatsDashboard),_addToApp(_testGX3APPDashboard),_addToApp(_testSUPERVDashboard),_addToApp(_testChartsHubDashboard),_addToApp(_testChartsStackDashboard),_addToApp(_testSUPERVDashboard2),_addToApp(_testGX3APPDashboard2),_addToApp(_testConstraintsDashboard),_addToApp(_testNavigateToDashboard),_addToApp(_testPropertyHideShowDashboard),_addToApp(_testAQTACTNPDashboard),_addToApp(_testQAQTGRAPDashboard),_addToApp(_testSTATISTICDashboard),_addToApp(_testAQMPROJECTMDashboard),_addToApp(_testAQMOPERATMDashboard),_addToApp(_testAQMINTIMESMDashboard),_addToApp(_testGaugeChartDashboard),_addToApp(_testGridDashboard),_addToApp(_testDefaultAQTCRUDM),_addToApp(_testDefaultAQMCRUDM),_addToApp(_testDefaultAQMFIELDSM),_addToApp(_testDefaultAQMSEARCHM),_addToApp(_unitTestsDashboard),clientContract.registerApp(_testApplication)}}),define("syracuse-tablet/html/js/demos/salesMyCustomers/dashCustomers",["require","exports","module"],function(require,exports,module){var _customerArticle={$layoutType:"stack",$localization:{"en-US":{"8124be4e-b79c-478e-93c0-14ffb0ed2fb7":"More","a9560852-5799-4a6f-8ab5-d74996f0ef2a":"Contact","4917745c-ce70-4c3a-b381-06491e1fe87a":"Address","d257c14a-c94f-40c1-98cd-313e81b7864b":"Management","948d336a-45c7-467e-be87-f1de6d6b4702":"Credit level","ae370435-b808-4b6d-b0de-c782f4292437":"In progress","849efb71-386e-4ac2-b37c-0e35f81499c8":"Credit level by company"}},$comment:"",$items:[{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$bgColor:"transparent",$widthXs:"12",$widthSm:"8",$widthMd:"8",$widthLg:"6",$items:[{$bind:"BPCBPRC_BPRNAM",$display:"table",$arrayOptions:{showPagination:!0,showSortFilter:!0,showSearch:!0,rowIndex:!1},$labelPosition:"top",$isTitleHidden:!0}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"6",$bgColor:"darkgrey",$items:[{$bind:"BPCNUM",$labelPosition:"top",$labelAlign:"left"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"6",$bgColor:"darkgrey",$items:[{$bind:"BPCSHO",$labelPosition:"top",$labelAlign:"left",$isTitleHidden:!1}]}]}]},{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"green",$items:[{$bind:"BPRLOG",$labelPosition:"top",$labelAlign:"left"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"green",$items:[{$bind:"BPCSTA",$labelPosition:"top",$labelAlign:"left",$isTitleHidden:!1}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"green",$items:[{$bind:"LEGETT",$labelPosition:"top",$labelAlign:"left"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"green",$items:[{$bind:"CRY_REF",$labelPosition:"top",$labelAlign:"left"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"green",$items:[{$bind:"LAN_REF",$labelPosition:"top",$labelAlign:"left",$refDescPosition:"right"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"green",$items:[{$bind:"BCGCOD",$labelPosition:"top",$labelAlign:"left"}]}]}]},{$layoutType:"stack",$collapsible:"collapsed",$title:"{@8124be4e-b79c-478e-93c0-14ffb0ed2fb7}",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"lightgreen",$items:[{$bind:"FCY_REF",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"lightgreen",$items:[{$bind:"BPCPYR_REF",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"lightgreen",$items:[{$bind:"EECNUM",$labelPosition:"top"}]}]},{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"lightgreen",$items:[{$bind:"BETFCY",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"lightgreen",$items:[{$bind:"CUR_REF",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"lightgreen",$items:[{$bind:"NAF",$labelPosition:"top"}]}]}]},{$layoutType:"stack",$collapsible:"collapsed",$title:"{@a9560852-5799-4a6f-8ab5-d74996f0ef2a}",$items:[{$bind:"BPCBPRBPA",$display:"card",$arrayOptions:{showPagination:!0,showSortFilter:!0,showSearch:!0,rowIndex:!1},$isTitleHidden:!0,$tableHeaderShow:!0,$minWidth:6,$card:{$layoutType:"stack",$localization:{},$items:[{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"12",$widthSm:"12",$widthMd:"12",$widthLg:"12",$bgColor:"sagegreen",$items:[{$bind:"BPABPAADDLIG1",$labelPosition:"top",$isTitleHidden:!0}]},{$layoutType:"cell",$bgColor:"sagegreen",$items:[{$bind:"BPABPAADDLIG2",$labelPosition:"top",$isTitleHidden:!0}]},{$layoutType:"cell",$bgColor:"sagegreen",$items:[{$bind:"BPABPAADDLIG3",$labelPosition:"top",$isTitleHidden:!0}]}]},{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"BPAPOSCOD",$labelPosition:"top",$isTitleHidden:!0}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"BPACTY",$labelPosition:"top",$isTitleHidden:!0}]},{$layoutType:"cell",$widthXs:"12",$widthSm:"12",$widthMd:"12",$widthLg:"12",$bgColor:"transparent",$items:[{$bind:"BPACRYNAM",$isTitleHidden:!0}]}]},{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"BPABPAADD",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"BPABPADES",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"BPADEFFLG",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"ADRVAL",$labelPosition:"top"}]}]}]},{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$bgColor:"transparent",$items:[{$bind:"FCYWEB",$labelPosition:"top"}]}]}]},{$bind:"BPCBPRBPACOLTEL",$display:"card",$arrayOptions:{showPagination:!0,showSortFilter:!0,showSearch:!0,rowIndex:!1},$minWidth:6},{$bind:"BPCBPRBPACOLWEB",$display:"card",$arrayOptions:{showPagination:!0,showSortFilter:!0,showSearch:!0,rowIndex:!1},$minWidth:6}]},$statusEnabled:"mono"}]},{$layoutType:"stack",$collapsible:"collapsed",$title:"{@4917745c-ce70-4c3a-b381-06491e1fe87a}",$items:[{$bind:"BPCBPRCNT",$display:"card",$arrayOptions:{showPagination:!0,showSortFilter:!0,showSearch:!0,rowIndex:!1},$isTitleHidden:!0,$minWidth:6,$card:{$layoutType:"stack",$localization:{},$items:[{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"2",$widthSm:"2",$widthMd:"2",$widthLg:"2",$bgColor:"transparent",$items:[{$bind:"CNTCNTTTL",$isTitleHidden:!0}]},{$layoutType:"cell",$widthXs:"4",$widthSm:"4",$widthMd:"4",$widthLg:"4",$bgColor:"transparent",$items:[{$bind:"CNTCNTFNA",$labelPosition:"top",$isTitleHidden:!0}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"CNTCNTLNA",$labelPosition:"top",$isTitleHidden:!0}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"CNTCNTFNC",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"CNTCNTSRV",$labelPosition:"top"}]}]}]},{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$bgColor:"transparent",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"CNTFAX",$labelPosition:"top"}]},{$layoutType:"cell",$bgColor:"transparent",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"CNTTEL",$labelPosition:"top"}]},{$layoutType:"cell",$bgColor:"transparent",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"CNTMOB",$labelPosition:"top"}]},{$layoutType:"cell",$bgColor:"transparent",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$items:[{$bind:"CNTWEB",$labelPosition:"top"}]}]}]},{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"CNTCNTBIR",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"CNTCNTMSS_REF",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"CNTTCDEFFLG",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"CNTCNTFBDMAG",$labelPosition:"top"}]}]}]}]}}]},{$layoutType:"stack",$collapsible:"collapsed",$title:"{@d257c14a-c94f-40c1-98cd-313e81b7864b}",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"green",$items:[{$bind:"BPCSNCDAT",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"green",$items:[{$bind:"PTE_REF",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"green",$items:[{$bind:"DEP",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"green",$items:[{$bind:"VACBPR_REF",$labelPosition:"top"}]}]},{$layoutType:"stack",$collapsible:"collapsed",$title:"{@8124be4e-b79c-478e-93c0-14ffb0ed2fb7}",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"lightgreen",$items:[{$bind:"FREINV",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"lightgreen",$items:[{$bind:"IME",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"lightgreen",$items:[{$bind:"INVPER",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"lightgreen",$items:[{$bind:"BPCINV",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"lightgreen",$items:[{$bind:"BPCRSK",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"4",$widthMd:"4",$widthLg:"3",$bgColor:"lightgreen",$items:[{$bind:"BPCGRU",$labelPosition:"top"}]}]}]},{$layoutType:"stack",$title:"{@948d336a-45c7-467e-be87-f1de6d6b4702}",$collapsible:"collapsed",$items:[{$layoutType:"stack",$title:"{@ae370435-b808-4b6d-b0de-c782f4292437}",$collapsible:"collapsed",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"ROSTCTL",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"ROSTCTLLEV",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"ROSTAUZ",$labelPosition:"top"}]},{$layoutType:"cell",$widthXs:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"ROST",$labelPosition:"top"}]}]}]},{$layoutType:"stack",$collapsible:"collapsed",$title:"{@849efb71-386e-4ac2-b37c-0e35f81499c8}",$items:[{$bind:"OSTCLTCPY",$display:"card",$arrayOptions:{showPagination:!0,showSortFilter:!0,showSearch:!0,rowIndex:!1},$isTitleHidden:!0,$minWidth:6,$card:{$layoutType:"stack",$localization:{},$items:[{$layoutType:"stack",$items:[{$layoutType:"row",$items:[{$layoutType:"cell",$bgColor:"transparent",$items:[{$bind:"ROSTCPY_REF",$labelPosition:"top"}]}]},{$layoutType:"row",$items:[{$layoutType:"cell",$widthXs:"12",$widthSm:"12",$widthMd:"12",$widthLg:"12",$bgColor:"transparent",$items:[{$bind:"ROSTCPYAUZ",$labelPosition:"top",$labelAlign:"left",$items:[{$bind:"ROSTCPYCUR_REF"}]}]}]}]}]}}]}]}]}]};exports.dashboards={$customersDashboard:{$dashboardName:"$customersDashboard",$title:"Customer Dashboard",$description:"",$vignettes:{$x3CustomersList:{$uuid:"$x3CustomersList",$displayStyle:"$full"},$x3CustomersListIco:{$uuid:"$x3CustomersList",$displayStyle:"$link"},$tasksList:{$uuid:"$tasksList",$displayStyle:"$full"},$localCustomerTotals:{$uuid:"$localCustomerTotals",$displayStyle:"$full"},$localOverviewSales_rev_perc:{$uuid:"$localOverviewSales_rev_perc",$displayStyle:"$full"},$localOverviewSalesLeads:{$uuid:"$localOverviewSalesLeads",$displayStyle:"$full"},$localStatVEN42:{$uuid:"$localStatVEN42",$displayStyle:"$full"},$localStatVEN420:{$uuid:"$localStatVEN420",$displayStyle:"$full"},CRM074:{$uuid:"CRM074",$displayStyle:"$full"},CRM075:{$uuid:"CRM075",$displayStyle:"$full"},VEN076:{$uuid:"VEN076",$displayStyle:"$full"},VEN007:{$uuid:"VEN007",$displayStyle:"$full"},VEN073:{$uuid:"VEN073",$displayStyle:"$full"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Dashboard",$items:[{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3CustomersListIco"}]},{$layoutType:"tile",$size:"medium",$bgColor:"skyblue",$title:"Quote values",$items:[{$bind:"$localCustomerTotals",$article:{$layoutType:"stack",$items:[{$bind:"quotesValue",$gauge:{$bindMin:"min",$bindMax:"quotesMax",segments:[{propStart:0,propEnd:.75,color:"#DF5353"},{propStart:.75,propEnd:.85},{propStart:.85,propEnd:1,color:"#55BF3B"}]}}]}}]},{$layoutType:"tile",$title:"Sales leads",$size:"large",$bgColor:"lightgreen",$items:[{$bind:"$localOverviewSalesLeads",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$isTitleHidden:!1,$style:"line",$display:"table",$article:{$items:[{$bind:"date"},{$bind:"numLeads"},{$bind:"numDeals"}]}}]}}]},{$layoutType:"tile",$title:"Test Stats VEN42",$size:"full",$bgColor:"lightgreen",$items:[{$bind:"$localStatVEN42"}]},{$layoutType:"tile",$title:"Test Stats VEN42",$size:"full",$bgColor:"lightgreen",$items:[{$bind:"$localStatVEN420"}]},{$layoutType:"tile",$size:"large",$bgColor:"skyblue",$title:"Monthly revenues",$items:[{$bind:"$localOverviewSales_rev_perc",$article:{$layoutType:"stack",$items:[{$bind:"revMonthly",$gauge:{$bindMin:"revMonthlyMin",$bindMax:"revMonthlyMax",segments:[{propStart:0,propEnd:.75,color:"#DF5353"},{propStart:.75,propEnd:.85,color:"#FF5800"},{propStart:.85,propEnd:1,color:"#55BF3B"}]}}]}}]}]},{$layoutType:"hubGroup",$title:"Requests",$items:[{$layoutType:"tile",$title:"CRM074",$size:"full",$bgColor:"lightgreen",$items:[{$bind:"CRM074",$article:{$layoutType:"stack",$items:[{$layoutType:"row"},{$bind:"$criteria",$isTitleHidden:!0},{$bind:"headerMessage",$isTitleHidden:!0},{$bind:"levelMessage",$isTitleHidden:!0},{$bind:"$resources",$isTitleHidden:!1,$seriesOptions:{COUNT:{isHidden:!1}},$style:"pie",$chartOptions:{isLegendHidden:!0},$isXLabelsHidden:!1,$isYLabelsHidden:!1,$isXLabelHidden:!1,$isYLabelHidden:!1,$isLegendHidden:!0,$isGridLineHidden:!1,$openDetail:!0,$isLabelsHidden:!1}]}}]},{$layoutType:"tile",$size:"large",$bgColor:"skyblue",$title:"CRM075",$items:[{$bind:"CRM075"}]},{$layoutType:"tile",$size:"large",$bgColor:"skyblue",$title:"VEN076",$items:[{$bind:"VEN076",$article:{$layoutType:"stack",$items:[{$bind:"$criteria",$isTitleHidden:!0},{$bind:"headerMessage",$isTitleHidden:!0},{$bind:"levelMessage",$isTitleHidden:!0},{$bind:"$resources",$isTitleHidden:!1,$style:"bar",$chartOptions:{isXLabelHidden:!1,isLegendHidden:!0},$isXLabelsHidden:!1,$isYLabelsHidden:!1,$isXLabelHidden:!1,$isYLabelHidden:!1,$isLegendHidden:!0,$isGridLineHidden:!1,$openDetail:!0,$isLabelsHidden:!1}]}}]},{$layoutType:"tile",$size:"large",$bgColor:"skyblue",$title:"VEN007",$items:[{$bind:"VEN007",$article:{$layoutType:"stack",$items:[{$bind:"$criteria",$isTitleHidden:!0},{$bind:"headerMessage",$isTitleHidden:!0},{$bind:"levelMessage",$isTitleHidden:!0},{$bind:"$resources",$isTitleHidden:!0,$display:"table",$arrayOptions:{showPagination:!0,showSortFilter:!0,rowIndex:!0,showSearch:!0},$tableHeaderShow:!0,$table:[{$bind:"BPCNAM",$title:"Company Name",$type:"application/x-string",$titleOrig:"Company Name",$widthType:"percent",$widthVal:65,$imgHeight:"small"},{$bind:"BCGCOD",$title:"Category",$type:"application/x-string",$titleOrig:"Category",$widthType:"percent",$widthVal:35,$imgHeight:"small"}]}]}}]},{$layoutType:"tile",$size:"large",$bgColor:"skyblue",$title:"VEN073",$items:[{$bind:"VEN073"}]}]},{$layoutType:"hubGroup",$title:"Customer List",$items:[{$layoutType:"tile",$title:"Customers list",$size:"all",$items:[{$bind:"$x3CustomersList",$article:{$pageActionSettings:[{name:"BPCLOCK",icon:{css:"fa fa-lock",name:"lock"},$title:"Bloquer",options:{footerHeader:!0,refreshPage:!1,multiselection:!0}},{name:"BPCUNLOCK",icon:{css:"fa fa-unlock-alt",name:"unlock-alt"},$title:"Débloquer",options:{footerHeader:!0,refreshPage:!1,multiselection:!0}}],$layoutType:"stack",$items:[{$bind:"$resources",$display:"card",$detailsLink:"$details",$detailLinkArticle:_customerArticle,$card:{$layoutType:"stack",$items:[{$bind:"BPCNUM"},{$bind:"BPCNAM"},{$bind:"TEXTDES0"},{$bind:"RPOSCOD"},{$bind:"BPCSTA"},{$bind:"BPCTYP"}]}}]}}]},{$layoutType:"tile",$title:"Some tasks",$size:"all",$items:[{$bind:"$tasksList"}]}]}]}},STD_X3_CUSTOMER_DETAILS_DASHBOARD:{$dashboardName:"STD_X3_CUSTOMER_DETAILS_DASHBOARD",$title:"STD_X3_CUSTOMER_DETAILS_DASHBOARD",$description:"",$vignettes:{$x3CustomersList:{$uuid:"$x3CustomersList",$displayStyle:"$full"}}}},exports.gadgets={$x3CustomersList:{$type:"$representation",$title:"Customers list",entity:"BPCUSTOMER",endpoint:"x3.erp.GX3APP",action:"$query",representation:"BPCUSTOMERM",facet:"$query",icon:"s-m-sales-customers-list"},$tasksList:{$type:"$representation",$title:"Query facet",entity:"$localTodo",action:"$query",representation:"$localTodo",facet:"$query"},$localCustomerTotals:{$type:"$representation",$title:"Totals",entity:"$localCustomer",action:"$details",representation:"$localCustomer",facet:"$details",keyParameter:"10"},$localOverviewSalesLeads:{$type:"$representation",$title:"Leads vs Deals",entity:"$localOverviewSalesLeads",action:"$query",representation:"$localOverviewSalesLeads",facet:"$query"},$localOverviewSales_rev_perc:{$type:"$representation",$title:"Overview",entity:"$localOverviewSales",action:"$details",representation:"$localOverviewSales",facet:"$details",keyParameter:"10"},$localStatVEN42:{entity:"$localVEN42",$type:"$stats",$title:"Test stats VEN42",$description:"Sales by Region",icon:"",parameters:{portview:{title:"portview",value:"TESTLOCAL"},count:{title:"count",value:"10"}},statName:"$localVEN42",action:"$query",representation:"STATS~$localVEN42.$cube",facet:"$cube",$uuid:"$uuidVEN42"},$localStatVEN420:{entity:"$localVEN42",$type:"$stats",$title:"Test stats VEN42",$description:"Sales by Region",icon:"",parameters:{portview:{title:"portview",value:"TESTLOCAL"},count:{title:"count",value:"10"}},statName:"$localVEN42",action:"$query",representation:"STATS~$localVEN42.$cube",facet:"$cubechart",$uuid:"$uuidVEN42"},VEN073:{$type:"$request",$title:"My customers without any orders (3 months)",$description:"My customers without any orders (3 months)",parameters:{forcedExecution:{title:"forcedExecution",value:"true"},frequency:{title:"frequency",value:"1"},level:{title:"level",value:"1"},displayLineNum:{title:"displayLineNum",value:"false"}},requestName:"VEN073",requestLevel:"99",action:"$query",representation:"QUERY~VEN073~99",facet:"$query",endpoint:"x3.erp.GX3APP",$uuid:"VEN073"},VEN007:{$type:"$request",$title:"Inactive Customers",$description:"Inactive Customers",parameters:{forcedExecution:{title:"forcedExecution",value:"true"},frequency:{title:"frequency",value:"1"},level:{title:"level",value:"1"},displayLineNum:{title:"displayLineNum",value:"false"}},requestName:"VEN007",requestLevel:"99",action:"$query",representation:"QUERY~VEN007~99",facet:"$query",endpoint:"x3.erp.GX3APP",$uuid:"VEN007"},VEN076:{$type:"$request",$title:"Annual ranking of customers margin",$description:"Annual ranking of customers margin",parameters:{forcedExecution:{title:"forcedExecution",value:"true"},frequency:{title:"frequency",value:"1"},displayLineNum:{title:"displayLineNum",value:"false"},level:{title:"level",value:"2"}},requestName:"VEN076",requestLevel:"99",action:"$query",representation:"QUERY~VEN076~99",facet:"$query",endpoint:"x3.erp.GX3APP",$uuid:"VEN076"},CRM075:{$type:"$request",$title:"Annual ranking of customers appointments",$description:"Annual ranking of customers appointments",parameters:{forcedExecution:{title:"forcedExecution",value:"true"},frequency:{title:"frequency",value:"1"},level:{title:"level",value:"2"},displayLineNum:{title:"displayLineNum",value:"false"}},requestName:"CRM075",requestLevel:"99",action:"$query",representation:"QUERY~CRM075~99",facet:"$query",endpoint:"x3.erp.GX3APP",$uuid:"CRM075"},CRM074:{$type:"$request",$title:"Annual ranking of customers calls",$description:"Annual ranking of customers calls",parameters:{forcedExecution:{title:"forcedExecution",value:"true"},frequency:{title:"frequency",value:"1"},level:{title:"level",value:"2"},displayLineNum:{title:"displayLineNum",value:"false"}},requestName:"CRM074",requestLevel:"99",action:"$query",representation:"QUERY~CRM074~99",facet:"$query",endpoint:"x3.erp.GX3APP",$uuid:"CRM074"}}}),define("syracuse-tablet/html/js/demos/utils",["require","exports","module"],function(require,exports,module){exports.addToApp=function(app,toAdd){toAdd.gadgets&&Object.keys(toAdd.gadgets).forEach(function(key){app.$gadgets[key]&&console.log("Duplicate gadget name: "+key),app.$gadgets[key]=toAdd.gadgets[key]}),toAdd.dashboards&&Object.keys(toAdd.dashboards).forEach(function(key){app.$dashboards[key]&&console.log("Duplicate dashboard name: "+key),app.$dashboards[key]=toAdd.dashboards[key]})}}),define("syracuse-tablet/html/js/demos/_entities/entTodos",["require","exports","module"],function(require,exports,module){var _todos=[{$uuid:"1",date:"2015-02-01 09:00:00",who:"Mr. Miller",desc:"Call",phone:"+771 896520 4183"},{$uuid:"2",date:"2015-02-09 10:00:00",who:"Mr. Miller",desc:"Meeting"},{$uuid:"3",date:"2015-03-04 09:00:00",who:"Mr. Heinz",desc:"Milestone definition"},{$uuid:"4",date:"2015-03-05 15:00:00",who:"Mr. Schmidt",desc:"Project review",phone:"+771 896520 4183"},{$uuid:"5",date:"2015-03-08 14:00:00",who:"Mr. Miller",desc:"Call"},{$uuid:"6",date:"2015-03-09 15:40:00",who:"Mr. Miller",desc:"Call"},{$uuid:"7",date:"2015-03-10 15:50:00",who:"Mr. Miller",desc:"Call"},{$uuid:"8",date:"2015-03-11 14:00:00",who:"Mr. Miller",desc:"Call"},{$uuid:"9",date:"2015-03-11 14:00:00",who:"Mr. Miller",desc:"Call"},{$uuid:"10",date:"2015-03-11 14:00:00",who:"Mr. Miller",desc:"Call"},{$uuid:"11",date:"2015-03-11 14:00:00",who:"Mr. Miller",desc:"Call"},{$uuid:"12",date:"2015-03-11 14:00:00",who:"Mr. Miller",desc:"Call"},{$uuid:"13",date:"2015-03-11 14:00:00",who:"Mr. Miller",desc:"Call"}];exports.entity={$entityName:"$localTodo",$value:"{desc}",$properties:{who:{$type:"application/x-string",$title:"Who"},desc:{$type:"application/x-string",$title:"Description"},phone:{$type:"application/x-string",$title:"Phone",$format:"$phone"},date:{$type:"application/x-datetime",$title:"Date"}},$articles:{},$services:{$new:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_todos[op.$key]),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_todos}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/_entities/entOverviewSales",["require","exports","module"],function(require,exports,module){var _data={$uuid:"1",revMonthlyMin:1e5,revMonthly:18e4,revMonthlyMax:2e5,revMonthlyPerc:92};exports.entity={$entityName:"$localOverviewSales",$value:"{revMonthly}",$properties:{revMonthlyMin:{$type:"application/x-decimal",$title:"Min"},revMonthlyMax:{$type:"application/x-decimal",$title:"Target"},revMonthly:{$type:"application/x-decimal",$title:"Revenue"},revMonthlyPerc:{$type:"application/x-decimal",$title:"Monthly Target"}},$articles:{},$services:{$new:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_data),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:[_data]}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/_entities/entOverviewSalesLeads",["require","exports","module"],function(require,exports,module){var _data=[{$uuid:"1",date:"2014-12-05",numLeads:50,numDeals:40},{$uuid:"1",date:"2014-12-12",numLeads:53,numDeals:45},{$uuid:"1",date:"2014-12-15",numLeads:54,numDeals:47},{$uuid:"1",date:"2014-12-22",numLeads:53,numDeals:49},{$uuid:"1",date:"2014-12-29",numLeads:52,numDeals:52}];exports.entity={$entityName:"$localOverviewSalesLeads",$value:"{date}",$properties:{date:{$type:"application/x-date",$title:"Date"},numLeads:{$type:"application/x-decimal",$title:"Leads"},numDeals:{$type:"application/x-decimal",$title:"Deals"}},$articles:{},$prototype:function(proto){var res=proto.$properties&&proto.$properties.$resources;res&&(res.$axes=[{$title:"Date",$hierarchies:[["date"]]},{$title:"Number",$hierarchies:[["$measures"]]}],res.$cube={$style:"column",$title:"Leads vs Deals",$hierarchies:{date:{$properties:["date"]}},$measures:{numLeads:{},numDeals:{}}})},$services:{$new:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_data[0]),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_data}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/_entities/entCustomers",["require","exports","module","syracuse-tablet/html/js/helpers/utils"],function(require,exports,module){var utils=require("syracuse-tablet/html/js/helpers/utils"),_names=["Acme, inc.","Widget Corp","123 Warehousing","Demo Company","Smith and Co.","Foo Bars","ABC Telecom","Fake Brothers","QWERTY Logistics","Demo, inc.","Sample Company","Sample, inc","Acme Corp","Allied Biscuit","Ankh-Sto Associates","Extensive Enterprise","Galaxy Corp","Globo-Chem","Mr. Sparkle","Globex Corporation","LexCorp","LuthorCorp","North Central Positronics","Omni Consimer Products","Praxis Corporation","Sombra Corporation","Sto Plains Holdings","Tessier-Ashpool","Wayne Enterprises","Wentworth Industries","ZiffCorp","Bluth Company","Strickland Propane","Thatherton Fuels","Three Waters","Water and Power","Western Gas & Electric","Mammoth Pictures","Mooby Corp","Gringotts","Thrift Bank","Flowers By Irene","The Legitimate Businessmens Club","Osato Chemicals","Transworld Consortium","Universal Export","United Fried Chicken","Virtucon","Kumatsu Motors","Keedsler Motors","Powell Motors","Industrial Automation","Sirius Cybernetics Corporation","U.S. Robotics and Mechanical Men","Colonial Movers","Corellian Engineering Corporation","Incom Corporation","General Products","Leeding Engines Ltd.","Blammo","Input, Inc.","Mainway Toys","Videlectrix","Zevo Toys","Ajax","Axis Chemical Co.","Barrytron","Carrys Candles","Cogswell Cogs","Spacely Sprockets","General Forge and Foundry","Duff Brewing Company","Dunder Mifflin","General Services Corporation","Monarch Playing Card Co.","Krustyco","Initech","Roboto Industries","Primatech","Sonky Rubber Goods","St. Anky Beer","Stay Puft Corporation","Vandelay Industries","Wernham Hogg","Gadgetron","Burleigh and Stronginthearm","BLAND Corporation","Nordyne Defense Dynamics","Petrox Oil Company","Roxxon","McMahon and Tate","Sixty Second Avenue","Charles Townsend Agency","Spade and Archer","Megadodo Publications","Rouster and Sideways","C.H. Lavatory and Sons","Globo Gym American Corp","The New Firm"],_customers=[];for(var c=1e4;c<10100;c++)_customers.push({$uuid:""+(c-1e4),bpcnum:""+c,name:_names[c-1e4],ordersValue:1e6+(c-1e4)*2e5%5e5,ordersMax:18e5,quotesValue:5e5+(c-1e4)*2e3%5e4,quotesMax:12e5,invoicesValue:1e4+(c-1e4)*2e3%5e4,invoicesMax:12e4,min:1e3,addr1:"Rue Fructidor",addr2:"75834 Paris Cedex 17"});exports.entity={$entityName:"$localCustomer",$value:"{name}",$properties:{bpcnum:{$type:"application/x-string",$title:"Customer"},name:{$type:"application/x-string",$title:"Name"},addr1:{$type:"application/x-string",$title:"Street"},addr2:{$type:"application/x-string",$title:"Address"},ordersValue:{$type:"application/x-decimal",$title:"Orders value"},min:{$type:"application/x-decimal",$title:"General min value"},quotesValue:{$type:"application/x-decimal",$title:"Quotes value"},invoicesValue:{$type:"application/x-decimal",$title:"Invoices value"},ordersMax:{$type:"application/x-decimal",$title:"Max"},quotesMax:{$type:"application/x-decimal",$title:"Max"},invoicesMax:{$type:"application/x-decimal",$title:"Max"}},$prototype:function(proto){var res=utils.getPropByPath(proto,"$properties.$resources.$item.$links")||{};res.DASHBOARD={$title:"Detail dashboard",$url:"{$baseUrl}/$mobileDashboards?dashboard=$localCustomerDashboard&parameters=bpcnum%3D%7Bbpcnum%7D"}},$articles:{$query:{$layoutType:"stack",$items:[{$bind:"$resources",$detailsLink:"DASHBOARD",$display:"card",$cardsPerLine:4,$article:{$items:[{$bind:"bpcnum"},{$bind:"name"},{$bind:"addr1"},{$bind:"addr2"}]}}]}},$services:{$new:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_customers[op.$key]),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_customers}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/_entities/entCustomerRevenues",["require","exports","module"],function(require,exports,module){var _months=["January","February","March","April","May","June","July","August","September","October","November","December"],_revs=[],_uuid=0;for(var c=1e4;c<10100;c++)for(var m=0;m<12;m++)_revs.push({$uuid:""+_uuid,bpcnum:""+c,month:_months[m],revenue:2e4+m*(12+c%12)%40*2e4}),_uuid++;exports.entity={$entityName:"$localCustomerRevenue",$value:"{name}",$properties:{bpcnum:{$type:"application/x-string",$title:"ID"},month:{$type:"application/x-string",$title:"Month"},revenue:{$type:"application/x-decimal",$title:"Revenue"}},$prototype:function(proto){var res=proto.$properties&&proto.$properties.$resources;res&&(res.$axes=[{$title:"Month",$hierarchies:[["month"]]},{$hierarchies:[["$measures"]]}],res.$cube={$title:"Revenue",$hierarchies:{month:{$properties:["month"]}},$measures:{revenue:{}}})},$articles:{},$services:{$new:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$read:function(op,data){var deferred=$.Deferred();return deferred.resolve(_revs[op.$key]),deferred.promise()},$query:function(op,data){var deferred=$.Deferred();return deferred.resolve({$resources:_revs}),deferred.promise()},$save:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()},$delete:function(op,data){var deferred=$.Deferred();return deferred.resolve(),deferred.promise()}}}}),define("syracuse-tablet/html/js/demos/_entities/entStatsVEN42",["require","exports","module"],function(require,exports,module){var _proto={$baseUrl:"/mobile1/x3/erp/SEEDTEST",$url:"{$baseUrl}/STATS('$localVEN42')?representation=STATS~$localVEN42.$cube&role={$role}",$title:"Sales by Region",$type:"application/json; vnd.sage=syracuse.presentation=x3.erp.superv/STATS('$localVEN42')",$methods:"GET",codeStat:"$localVEN42",$properties:{datstart1:{$type:"application/x-date",$title:"Period start 1",$isAdvanced:!0,$links:{$details:{$url:"{$baseUrl}/STATS('$localVEN42')?representation=STATS~$localVEN42.$cube&{linkstartP}",$type:"application/json;vnd.sage=syracuse"}},$isExcluded:!0},datstart2:{$type:"application/x-date",$title:"Period start 2",$isAdvanced:!0,$links:{$details:{$url:"{$baseUrl}/STATS('VEN42')?representation=STATS~VEN42.$cube&{linkstartP}",$type:"application/json;vnd.sage=syracuse"}},$isExcluded:!0},linkstartP:{$type:"application/x-string",$isExcluded:!0},datend1:{$type:"application/x-date",$title:"Period end 1",$isAdvanced:!0,$links:{$details:{$url:"{$baseUrl}/STATS('VEN42')?representation=STATS~VEN42.$cube&{linkendP}",$type:"application/json;vnd.sage=syracuse"}},$isExcluded:!0},datend2:{$type:"application/x-date",$title:"Period end 2",$isAdvanced:!0,$links:{$details:{$url:"{$baseUrl}/STATS('VEN42')?representation=STATS~VEN42.$cube&{linkendP}",$type:"application/json;vnd.sage=syracuse"}},$isExcluded:!0},linkendP:{$type:"application/x-string",$isExcluded:!0},def_company:{$type:"application/x-string",$title:"Company",$isAdvanced:!0,$links:{$details:{$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/COMPANY('{def_company}')?representation=COMPANY.$details&role={$role}"}},$isExcluded:!0},$resources:{$type:"application/x-array",$provType:"PORTALSTA",$criteria:{COMPANY:{$type:"application/x-string",$maxlength:5,$title:"Company",$links:{$details:{$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/COMPANY('{COMPANY}')?representation=COMPANY.$details&role={$role}",$target:"main"}}},DATBEG1:{$type:"application/x-date",$title:""},DATEND1:{$type:"application/x-date",$title:""},DATBEG2:{$type:"application/x-date",$title:""},DATEND2:{$type:"application/x-date",$title:""}},$item:{$type:"application/json",$url:"{$baseUrl}/stats('VEN42')?representation=$cube('VEN42')&role={$role}",$title:"Sales by Region",$properties:{linkDown:{$type:"application/x-string",$isExcluded:!0},dateStat:{$type:"application/x-date",$capabilities:"sort,filter",$isExcluded:!0},CRY:{$title:"Pays",$capabilities:"sort,filter",$type:"application/x-string",$links:{$details:{$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/TABCOUNTRY('{CRY}')?representation=TABCOUNTRY.$details&role={$role}",$target:"main"}}},C_CRY:{$capabilities:"sort,filter",$type:"application/x-string"},POSCOD:{$title:"Code postal",$capabilities:"sort,filter",$type:"application/x-string",$constraints:{$maxLength:3},$isHidden:!1,$isParameter:!0},C_POSCOD:{$capabilities:"sort,filter",$type:"application/x-string"},CTY:{$title:"Ville",$capabilities:"sort,filter",$type:"application/x-string",$constraints:{$maxLength:3},$isHidden:!1,$isParameter:!0},C_CTY:{$capabilities:"sort,filter",$type:"application/x-string"},BPCNUM:{$title:"Client",$capabilities:"sort,filter",$type:"application/x-string",$links:{$details:{$type:"application/json;vnd.sage=syracuse",$url:"{$baseUrl}/BPARTNER('{BPCNUM}')?representation=BPARTNER.$details&role={$role}",$target:"main"}}},C_BPCNUM:{$capabilities:"sort,filter",$type:"application/x-string"},amount1:{$type:"application/x-decimal",$precision:15,$scale:2,$format:"#,###.00",$title:"Actual Year N"},amount2:{$type:"application/x-decimal",$precision:15,$scale:2,$format:"#,###.00",$title:"Actual Year N-1"},amount3:{$type:"application/x-decimal",$precision:15,$scale:2,$format:"#,###.00",$title:"Actual variance N and N-1"},amount4:{$type:"application/x-decimal",$precision:15,$scale:2,$format:"#,###.00",$title:"Margin Year N"},amount5:{$type:"application/x-decimal",$precision:15,$scale:2,$format:"#,###.00",$title:"Résult"},amount6:{$type:"application/x-decimal",$precision:15,$scale:2,$format:"#,###.00",$title:"Actual Tax Incl. Year N"},amount7:{$type:"application/x-decimal",$precision:15,$scale:2,$format:"#,###.00",$title:"Quantity"},linkUp:{$type:"application/x-string",$isExcluded:!0}},$links:{}},$cube:{$mode:"table",$title:"Inv. / Zone",$displaysOneMeasure:!0,$hierarchies:{CRY:{$title:"Pays",$properties:["CRY"]},POSCOD:{$title:"Code postal",$properties:["POSCOD"]},CTY:{$title:"Ville",$properties:["CTY"]},BPCNUM:{$title:"Client",$properties:["BPCNUM"]},date:{properties:["dateStat"],periods:"YSQMD"}},$measures:{amount1:{$isDefault:!0},amount2:{},amount3:{},amount4:{},amount5:{},amount6:{},amount7:{}}},$axes:[{$title:"Pays",$hierarchies:[["CRY",1,0],["POSCOD",0,0],["CTY",0,0],["BPCNUM",0,0]]},{$title:"Measures",$hierarchies:[["$measures"]]}],$slicer:{$title:"CRY",$hierarchies:[["CRY",1,0]]},$isExcluded:!1}}},_countries=[{name:"Afghanistan",code:"AF"},{name:"Åland Islands",code:"AX"},{name:"Albania",code:"AL"},{name:"Algeria",code:"DZ"},{name:"American Samoa",code:"AS"},{name:"AndorrA",code:"AD"},{name:"Angola",code:"AO"},{name:"Anguilla",code:"AI"},{name:"Antarctica",code:"AQ"},{name:"Antigua and Barbuda",code:"AG"},{name:"Argentina",code:"AR"},{name:"Armenia",code:"AM"},{name:"Aruba",code:"AW"},{name:"Australia",code:"AU"},{name:"Austria",code:"AT"},{name:"Azerbaijan",code:"AZ"},{name:"Bahamas",code:"BS"},{name:"Bahrain",code:"BH"},{name:"Bangladesh",code:"BD"},{name:"Barbados",code:"BB"},{name:"Belarus",code:"BY"},{name:"Belgium",code:"BE"},{name:"Belize",code:"BZ"},{name:"Benin",code:"BJ"},{name:"Bermuda",code:"BM"},{name:"Bhutan",code:"BT"},{name:"Bolivia",code:"BO"},{name:"Bosnia and Herzegovina",code:"BA"},{name:"Botswana",code:"BW"},{name:"Bouvet Island",code:"BV"},{name:"Brazil",code:"BR"},{name:"British Indian Ocean Territory",code:"IO"},{name:"Brunei Darussalam",code:"BN"},{name:"Bulgaria",code:"BG"},{name:"Burkina Faso",code:"BF"},{name:"Burundi",code:"BI"},{name:"Cambodia",code:"KH"},{name:"Cameroon",code:"CM"},{name:"Canada",code:"CA"},{name:"Cape Verde",code:"CV"},{name:"Cayman Islands",code:"KY"},{name:"Central African Republic",code:"CF"},{name:"Chad",code:"TD"},{name:"Chile",code:"CL"},{name:"China",code:"CN"},{name:"Christmas Island",code:"CX"},{name:"Cocos (Keeling) Islands",code:"CC"},{name:"Colombia",code:"CO"},{name:"Comoros",code:"KM"},{name:"Congo",code:"CG"},{name:"Congo, The Democratic Republic of the",code:"CD"},{name:"Cook Islands",code:"CK"},{name:"Costa Rica",code:"CR"},{name:"Cote D'Ivoire",code:"CI"},{name:"Croatia",code:"HR"},{name:"Cuba",code:"CU"},{name:"Cyprus",code:"CY"},{name:"Czech Republic",code:"CZ"},{name:"Denmark",code:"DK"},{name:"Djibouti",code:"DJ"},{name:"Dominica",code:"DM"},{name:"Dominican Republic",code:"DO"},{name:"Ecuador",code:"EC"},{name:"Egypt",code:"EG"},{name:"El Salvador",code:"SV"},{name:"Equatorial Guinea",code:"GQ"},{name:"Eritrea",code:"ER"},{name:"Estonia",code:"EE"},{name:"Ethiopia",code:"ET"},{name:"Falkland Islands (Malvinas)",code:"FK"},{name:"Faroe Islands",code:"FO"},{name:"Fiji",code:"FJ"},{name:"Finland",code:"FI"},{name:"France",code:"FR"},{name:"French Guiana",code:"GF"},{name:"French Polynesia",code:"PF"},{name:"French Southern Territories",code:"TF"},{name:"Gabon",code:"GA"},{name:"Gambia",code:"GM"},{name:"Georgia",code:"GE"},{name:"Germany",code:"DE"},{name:"Ghana",code:"GH"},{name:"Gibraltar",code:"GI"},{name:"Greece",code:"GR"},{name:"Greenland",code:"GL"},{name:"Grenada",code:"GD"},{name:"Guadeloupe",code:"GP"},{name:"Guam",code:"GU"},{name:"Guatemala",code:"GT"},{name:"Guernsey",code:"GG"},{name:"Guinea",code:"GN"},{name:"Guinea-Bissau",code:"GW"},{name:"Guyana",code:"GY"},{name:"Haiti",code:"HT"},{name:"Heard Island and Mcdonald Islands",code:"HM"},{name:"Holy See (Vatican City State)",code:"VA"},{name:"Honduras",code:"HN"},{name:"Hong Kong",code:"HK"},{name:"Hungary",code:"HU"},{name:"Iceland",code:"IS"},{name:"India",code:"IN"},{name:"Indonesia",code:"ID"},{name:"Iran, Islamic Republic Of",code:"IR"},{name:"Iraq",code:"IQ"},{name:"Ireland",code:"IE"},{name:"Isle of Man",code:"IM"},{name:"Israel",code:"IL"},{name:"Italy",code:"IT"},{name:"Jamaica",code:"JM"},{name:"Japan",code:"JP"},{name:"Jersey",code:"JE"},{name:"Jordan",code:"JO"},{name:"Kazakhstan",code:"KZ"},{name:"Kenya",code:"KE"},{name:"Kiribati",code:"KI"},{name:"Korea, Democratic People'S Republic of",code:"KP"},{name:"Korea, Republic of",code:"KR"},{name:"Kuwait",code:"KW"},{name:"Kyrgyzstan",code:"KG"},{name:"Lao People'S Democratic Republic",code:"LA"},{name:"Latvia",code:"LV"},{name:"Lebanon",code:"LB"},{name:"Lesotho",code:"LS"},{name:"Liberia",code:"LR"},{name:"Libyan Arab Jamahiriya",code:"LY"},{name:"Liechtenstein",code:"LI"},{name:"Lithuania",code:"LT"},{name:"Luxembourg",code:"LU"},{name:"Macao",code:"MO"},{name:"Macedonia, The Former Yugoslav Republic of",code:"MK"},{name:"Madagascar",code:"MG"},{name:"Malawi",code:"MW"},{name:"Malaysia",code:"MY"},{name:"Maldives",code:"MV"},{name:"Mali",code:"ML"},{name:"Malta",code:"MT"},{name:"Marshall Islands",code:"MH"},{name:"Martinique",code:"MQ"},{name:"Mauritania",code:"MR"},{name:"Mauritius",code:"MU"},{name:"Mayotte",code:"YT"},{name:"Mexico",code:"MX"},{name:"Micronesia, Federated States of",code:"FM"},{name:"Moldova, Republic of",code:"MD"},{name:"Monaco",code:"MC"},{name:"Mongolia",code:"MN"},{name:"Montserrat",code:"MS"},{name:"Morocco",code:"MA"},{name:"Mozambique",code:"MZ"},{name:"Myanmar",code:"MM"},{name:"Namibia",code:"NA"},{name:"Nauru",code:"NR"},{name:"Nepal",code:"NP"},{name:"Netherlands",code:"NL"},{name:"Netherlands Antilles",code:"AN"},{name:"New Caledonia",code:"NC"},{name:"New Zealand",code:"NZ"},{name:"Nicaragua",code:"NI"},{name:"Niger",code:"NE"},{name:"Nigeria",code:"NG"},{name:"Niue",code:"NU"},{name:"Norfolk Island",code:"NF"},{name:"Northern Mariana Islands",code:"MP"},{name:"Norway",code:"NO"},{name:"Oman",code:"OM"},{name:"Pakistan",code:"PK"},{name:"Palau",code:"PW"},{name:"Palestinian Territory, Occupied",code:"PS"},{name:"Panama",code:"PA"},{name:"Papua New Guinea",code:"PG"},{name:"Paraguay",code:"PY"},{name:"Peru",code:"PE"},{name:"Philippines",code:"PH"},{name:"Pitcairn",code:"PN"},{name:"Poland",code:"PL"},{name:"Portugal",code:"PT"},{name:"Puerto Rico",code:"PR"},{name:"Qatar",code:"QA"},{name:"Reunion",code:"RE"},{name:"Romania",code:"RO"},{name:"Russian Federation",code:"RU"},{name:"RWANDA",code:"RW"},{name:"Saint Helena",code:"SH"},{name:"Saint Kitts and Nevis",code:"KN"},{name:"Saint Lucia",code:"LC"},{name:"Saint Pierre and Miquelon",code:"PM"},{name:"Saint Vincent and the Grenadines",code:"VC"},{name:"Samoa",code:"WS"},{name:"San Marino",code:"SM"},{name:"Sao Tome and Principe",code:"ST"},{name:"Saudi Arabia",code:"SA"},{name:"Senegal",code:"SN"},{name:"Serbia and Montenegro",code:"CS"},{name:"Seychelles",code:"SC"},{name:"Sierra Leone",code:"SL"},{name:"Singapore",code:"SG"},{name:"Slovakia",code:"SK"},{name:"Slovenia",code:"SI"},{name:"Solomon Islands",code:"SB"},{name:"Somalia",code:"SO"},{name:"South Africa",code:"ZA"},{name:"South Georgia and the South Sandwich Islands",code:"GS"},{name:"Spain",code:"ES"},{name:"Sri Lanka",code:"LK"},{name:"Sudan",code:"SD"},{name:"Suriname",code:"SR"},{name:"Svalbard and Jan Mayen",code:"SJ"},{name:"Swaziland",code:"SZ"},{name:"Sweden",code:"SE"},{name:"Switzerland",code:"CH"},{name:"Syrian Arab Republic",code:"SY"},{name:"Taiwan, Province of China",code:"TW"},{name:"Tajikistan",code:"TJ"},{name:"Tanzania, United Republic of",code:"TZ"},{name:"Thailand",code:"TH"},{name:"Timor-Leste",code:"TL"},{name:"Togo",code:"TG"},{name:"Tokelau",code:"TK"},{name:"Tonga",code:"TO"},{name:"Trinidad and Tobago",code:"TT"},{name:"Tunisia",code:"TN"},{name:"Turkey",code:"TR"},{name:"Turkmenistan",code:"TM"},{name:"Turks and Caicos Islands",code:"TC"},{name:"Tuvalu",code:"TV"},{name:"Uganda",code:"UG"},{name:"Ukraine",code:"UA"},{name:"United Arab Emirates",code:"AE"},{name:"United Kingdom",code:"GB"},{name:"United States",code:"US"},{name:"United States Minor Outlying Islands",code:"UM"},{name:"Uruguay",code:"UY"},{name:"Uzbekistan",code:"UZ"},{name:"Vanuatu",code:"VU"},{name:"Venezuela",code:"VE"},{name:"Viet Nam",code:"VN"},{name:"Virgin Islands, British",code:"VG"},{name:"Virgin Islands, U.S.",code:"VI"},{name:"Wallis and Futuna",code:"WF"},{name:"Western Sahara",code:"EH"},{name:"Yemen",code:"YE"},{name:"Zambia",code:"ZM"},{name:"Zimbabwe",code:"ZW"}],_resources=[];_countries.forEach(function(ctry,idx){_resources.push({level:1,CRY:ctry.code,$uuid:"uuid"+ctry.code,$title:ctry.name,linkUp:"DATBEG1=2015-01-01&DATEND1=2015-12-31&DATBEG2=2014-01-01&DATEND2=2014-12-31&COMPANY=&CRY="+ctry.code,linkDown:"DATBEG1=2015-01-01&DATEND1=2015-12-31&DATBEG2=2014-01-01&DATEND2=2014-12-31&COMPANY=",amount1:1e3+idx*10,amount2:2e3+idx*10,amount3:3e3+idx*10,amount4:4e3+idx*10,amount5:5e3+idx*10,amount6:6e3+idx*10,amount7:7e3+idx*10})});var _data={$properties:{$resources:{$item:{$properties:{CRY:{$isHidden:!1},POSCOD:{$isHidden:!0},CTY:{$isHidden:!0},BPCNUM:{$isHidden:!0}},$links:{}}}},linkstartP:"DATBEG1=2014-01-01&DATEND1=2014-12-31&DATBEG2=2013-01-01&DATEND2=2013-12-31&COMPANY=",linkendP:"DATBEG1=2016-01-01&DATEND1=2016-12-31&DATBEG2=2015-01-01&DATEND2=2015-12-31&COMPANY=",datstart1:"2015-01-01",datend1:"2015-12-31",datstart2:"2014-01-01",datend2:"2014-12-31",def_company:"",$resources:_resources},_chartDetail={$layoutType:"stack",$display:"bothSideToSide",$localization:{},$items:[{$layoutType:"row",$items:[{$layoutType:"cell",widthAll:"6",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"$resources",$isTitleHidden:!0,$display:"chart",$isHidden:!1,$style:"line",$arrayOptions:{showPagination:!1,showSortFilter:!1,showSearch:!1,rowIndex:!1},$arrayBgColor:"darkgrey"}]},{$layoutType:"cell",$widthXs:"12",$widthSm:"6",$widthMd:"6",$widthLg:"6",$bgColor:"transparent",$items:[{$bind:"$resources",$isTitleHidden:!0,$display:"table",$isHidden:!1,$arrayOptions:{showPagination:!0,showSortFilter:!1,showSearch:!1,rowIndex:!0,showRowDetailLink:!1},$arrayBgColor:"darkgrey",$table:[{$bind:"CRY",$title:"Pays",$type:"application/x-string",$titleOrig:"Pays",$widthType:"auto",$widthVal:0,$imgHeight:"small"},{$bind:"amount1",$title:"Actual Year N",$type:"application/x-decimal",$titleOrig:"Actual Year N",$widthType:"auto",$widthVal:0,$imgHeight:"small"},{$bind:"amount2",$title:"Actual Year N-1",$type:"application/x-decimal",$titleOrig:"Actual Year N-1",$widthType:"auto",$widthVal:0,$imgHeight:"small"},{$bind:"amount3",$title:"Actual variance N and N-1",$type:"application/x-decimal",$titleOrig:"Actual variance N and N-1",$widthType:"auto",$widthVal:0,$imgHeight:"small"},{$bind:"amount4",$title:"Margin Year N",$type:"application/x-decimal",$titleOrig:"Margin Year N",$widthType:"auto",$widthVal:0,$imgHeight:"small"}]}]}]}]};exports.entity={$entityName:"$localVEN42",$value:"{date}",$proto:_proto,$createProto:function(prototype){return $.extend(!0,{},exports.entity.$proto)},$properties:{},$articles:{$cube:{$layoutType:"stack",$items:[{$bind:"$resources",$display:"table",$arrayOptions:{showPagination:!0,rowIndex:!0},$table:[{$bind:"CRY"},{$bind:"amount1"},{$bind:"amount2"},{$bind:"amount3"}],$chartDetail:_chartDetail}]},$cubechart:{$layoutType:"stack",$items:[{$bind:"$resources",$display:"chart",$arrayOptions:{showPagination:!0,rowIndex:!0},$chartOptions:{isLegendHidden:!0},$table:[{$bind:"CRY"},{$bind:"amount1"},{$bind:"amount2"},{$bind:"amount3"}],$chartDetail:_chartDetail}]}},$services:{$query:function(op,data){return $.smResolve($.extend(!0,{},_data))}}}}),define("syracuse-tablet/html/js/demos/_entities/main",["require","exports","module","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/demos/_entities/entTodos","syracuse-tablet/html/js/demos/_entities/entOverviewSales","syracuse-tablet/html/js/demos/_entities/entOverviewSalesLeads","syracuse-tablet/html/js/demos/_entities/entCustomers","syracuse-tablet/html/js/demos/_entities/entCustomerRevenues","syracuse-tablet/html/js/demos/_entities/entStatsVEN42"],function(require,exports,module){var clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),entTodos=require("syracuse-tablet/html/js/demos/_entities/entTodos"),entOverviewSales=require("syracuse-tablet/html/js/demos/_entities/entOverviewSales"),entOverviewSalesLeads=require("syracuse-tablet/html/js/demos/_entities/entOverviewSalesLeads"),entCustomers=require("syracuse-tablet/html/js/demos/_entities/entCustomers"),entCustomerRevenues=require("syracuse-tablet/html/js/demos/_entities/entCustomerRevenues"),entStatsVEN42=require("syracuse-tablet/html/js/demos/_entities/entStatsVEN42");exports.registerAll=function(){clientContract.registerEntity(entTodos.entity),clientContract.registerEntity(entOverviewSales.entity),clientContract.registerEntity(entOverviewSalesLeads.entity),clientContract.registerEntity(entCustomers.entity),clientContract.registerEntity(entCustomerRevenues.entity),clientContract.registerEntity(entStatsVEN42.entity)}}),define("syracuse-tablet/html/js/demos/salesMyCustomers/main",["require","exports","module","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/demos/salesMyCustomers/dashCustomers","syracuse-tablet/html/js/demos/utils","syracuse-tablet/html/js/demos/_entities/main"],function(require,exports,module){var clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),dashCustomers=require("syracuse-tablet/html/js/demos/salesMyCustomers/dashCustomers"),demoUtils=require("syracuse-tablet/html/js/demos/utils"),entities=require("syracuse-tablet/html/js/demos/_entities/main"),_demoApp={$application:{$uuid:"$demoCustomers",applicationName:"sagesalescustomers",title:"Sales - My Customers",description:"",isSageApplication:!0,iconName:"s-m-sales-customers",$homeDashboard:{$uuid:"$customersDashboard",dashboardName:"$customersDashboard"}},$dashboards:{},$gadgets:{}};exports.register=function(){entities.registerAll(),demoUtils.addToApp(_demoApp,dashCustomers),clientContract.registerApp(_demoApp)}}),define("syracuse-tablet/html/js/demos/salesMyInquiries/dashSalesInquiries",["require","exports","module"],function(require,exports,module){exports.dashboards={$salesMyInquiriesDashboard:{$dashboardName:"$salesMyInquiriesDashboard",$title:"Sales - My Inquiries Dashboard",$description:"",$vignettes:{$x3PriceInquiries:{$uuid:"$x3PriceInquiries",$displayStyle:"$link"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Price Inquiry",$items:[{$layoutType:"tile",$title:"Sales Price Inquiry",$size:"medium",$items:[{$bind:"$x3PriceInquiries"}]}]}]}}},exports.gadgets={$x3PriceInquiries:{$type:"$representation",$title:"Price Inquiry",entity:"SPRICESEARCH",endpoint:"x3.erp.GX3APP",action:"$create",representation:"SPRICESEAM",facet:"$create",icon:"s-m-sales-priceinquiry"}}}),define("syracuse-tablet/html/js/demos/salesMyInquiries/main",["require","exports","module","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/demos/salesMyInquiries/dashSalesInquiries","syracuse-tablet/html/js/demos/utils"],function(require,exports,module){var clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),dashSalesInquiries=require("syracuse-tablet/html/js/demos/salesMyInquiries/dashSalesInquiries"),demoUtils=require("syracuse-tablet/html/js/demos/utils"),_demoApp={$application:{$uuid:"$demoSalesMyInquiries",applicationName:"sagesalesinquiries",title:"Sales - My Inquiries",description:"",isSageApplication:!0,iconName:"s-m-sales-inquiries",$homeDashboard:{$uuid:"$salesMyInquiriesDashboard",dashboardName:"$salesMyInquiriesDashboard"}},$dashboards:{},$gadgets:{}};exports.register=function(){demoUtils.addToApp(_demoApp,dashSalesInquiries),clientContract.registerApp(_demoApp)}}),define("syracuse-tablet/html/js/demos/salesMyActions/dashSalesMyActions",["require","exports","module"],function(require,exports,module){exports.dashboards={$salesMyActionsDashboard:{$dashboardName:"$salesMyActionsDashboard",$title:"Sales - My Actions Dashboard",$description:"",$vignettes:{$x3Orders2Sign:{$uuid:"$x3Orders2Sign",$displayStyle:"$full"},$x3Quotes2Sign:{$uuid:"$x3Quotes2Sign",$displayStyle:"$full"},$x3Orders2SignIco:{$uuid:"$x3Orders2Sign",$displayStyle:"$link"},$x3Quotes2SignIco:{$uuid:"$x3Quotes2Sign",$displayStyle:"$link"},$x3OpenOrders2Sign:{$uuid:"$x3OpenOrders2Sign",$displayStyle:"$link"},$x3QuotesSigned:{$uuid:"$x3QuotesSigned",$displayStyle:"$link"},$x3OrdersSigned:{$uuid:"$x3OrdersSigned",$displayStyle:"$link"},$x3OpenOrdersSigned:{$uuid:"$x3OpenOrdersSigned",$displayStyle:"$link"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Sales - my actions",$items:[{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3Quotes2SignIco"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3Orders2SignIco"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3OpenOrders2Sign"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3QuotesSigned"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3OrdersSigned"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3OpenOrdersSigned"}]}]},{$layoutType:"hubGroup",$title:"Orders to sign",$items:[{$layoutType:"tile",$title:"Orders to sign",$size:"full",$items:[{$bind:"$x3Orders2Sign"}]},{$layoutType:"tile",$title:"Quotes to sign",$size:"full",$items:[{$bind:"$x3Quotes2Sign",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$display:"card",$article:{$items:[{$bind:"DEST_REF"},{$bind:"RCLEDEC"},{$bind:"RVALCTX7"},{$bind:"RVALCTX2_REF"}]}}]}}]}]}]}}},exports.gadgets={$x3Orders2Sign:{$type:"$representation",$title:"Orders to sign",entity:"TCAWRKHISSUI",endpoint:"x3.erp.GX3APP",action:"$query",representation:"POHTOSIGM",facet:"$query",icon:"s-m-sales-orders2sign"},$x3Quotes2Sign:{$type:"$representation",$title:"Quotes to sign",entity:"TCAWRKHISSUI",endpoint:"x3.erp.GX3APP",action:"$query",representation:"SQHTOSIGM",facet:"$query",icon:"s-m-sales-quotes2sign"},$x3OpenOrders2Sign:{$type:"$representation",$title:"Open orders to sign",entity:"TCAWRKHISSUI",endpoint:"x3.erp.GX3APP",action:"$query",representation:"SOCTOSIGM",facet:"$query",icon:"s-m-sales-openorders2sign"},$x3QuotesSigned:{$type:"$representation",$title:"Quotes signed",entity:"TCAWRKHISSUI",endpoint:"x3.erp.GX3APP",action:"$query",representation:"SQHSIGM",facet:"$query",icon:"s-m-sales-quotessigned"},$x3OrdersSigned:{$type:"$representation",$title:"Quotes signed",entity:"TCAWRKHISSUI",endpoint:"x3.erp.GX3APP",action:"$query",representation:"SOHSIGM",facet:"$query",icon:"s-m-sales-orderssigned"},$x3OpenOrdersSigned:{$type:"$representation",$title:"Quotes signed",entity:"TCAWRKHISSUI",endpoint:"x3.erp.GX3APP",action:"$query",representation:"SOCSIGM",facet:"$query",icon:"s-m-sales-openorderssigned"}}}),define("syracuse-tablet/html/js/demos/salesMyActions/main",["require","exports","module","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/demos/salesMyActions/dashSalesMyActions","syracuse-tablet/html/js/demos/utils"],function(require,exports,module){var clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),dashSalesMyActions=require("syracuse-tablet/html/js/demos/salesMyActions/dashSalesMyActions"),demoUtils=require("syracuse-tablet/html/js/demos/utils"),_demoApp={$application:{$uuid:"$demoSalesMyActions",applicationName:"sagsalesactions",title:"Sales - My Actions",description:"",isSageApplication:!0,iconName:"s-m-sales-actions",$homeDashboard:{$uuid:"$salesMyActionsDashboard",dashboardName:"$salesMyActionsDashboard"}},$dashboards:{},$gadgets:{}};exports.register=function(){demoUtils.addToApp(_demoApp,dashSalesMyActions),clientContract.registerApp(_demoApp)}}),define("syracuse-tablet/html/js/demos/purchaseMyActions/dashPurchaseMyActions",["require","exports","module"],function(require,exports,module){exports.dashboards={$purchaseMyActionsDashboard:{$dashboardName:"$purchaseMyActionsDashboard",$title:"Purchase My Actions Dashboard",$description:"",$vignettes:{$x3Orders2Sign:{$uuid:"$x3Orders2Sign",$displayStyle:"$full"},$x3Purchases2Sign:{$uuid:"$x3Purchases2Sign",$displayStyle:"$full"},$x3Orders2SignIco:{$uuid:"$x3Orders2Sign",$displayStyle:"$link"},$x3Purchases2SignIco:{$uuid:"$x3Purchases2Sign",$displayStyle:"$link"},$x3OpenOrders2Sign:{$uuid:"$x3OpenOrders2Sign",$displayStyle:"$link"},$x3PurchasesSigned:{$uuid:"$x3PurchasesSigned",$displayStyle:"$link"},$x3OrdersSigned:{$uuid:"$x3OrdersSigned",$displayStyle:"$link"},$x3OpenOrdersSigned:{$uuid:"$x3OpenOrdersSigned",$displayStyle:"$link"},$x3PurchasePriceInquiry:{$uuid:"$x3PurchasePriceInquiry",$displayStyle:"$link"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Purchases - my actions",$items:[{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3Orders2SignIco"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3Purchases2SignIco"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3OpenOrders2Sign"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3PurchasesSigned"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3OrdersSigned"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3OpenOrdersSigned"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3PurchasePriceInquiry"}]}]},{$layoutType:"hubGroup",$title:"Purchase action",$items:[{$layoutType:"tile",$title:"Orders to sign",$size:"full",$items:[{$bind:"$x3Orders2Sign"}]},{$layoutType:"tile",$title:"Requests to sign",$size:"full",$items:[{$bind:"$x3Purchases2Sign"}]}]}]}}},exports.gadgets={$x3Orders2Sign:{$type:"$representation",$title:"Orders to sign",entity:"TCAWRKHISSUI",endpoint:"x3.erp.GX3APP",action:"$query",representation:"POHTOSIGM",facet:"$query",icon:"s-m-purchase-orders2sign"},$x3Purchases2Sign:{$type:"$representation",$title:"Purchases Requests to sign",entity:"TCAWRKHISSUI",endpoint:"x3.erp.GX3APP",action:"$query",representation:"PSHTOSIGM",facet:"$query",icon:"s-m-purchase-quotes2sign"},$x3OpenOrders2Sign:{$type:"$representation",$title:"Open Orders to sign",entity:"TCAWRKHISSUI",endpoint:"x3.erp.GX3APP",action:"$query",representation:"POCTOSIGM",facet:"$query",icon:"s-m-purchase-openorders2sign"},$x3PurchasesSigned:{$type:"$representation",$title:"Purchase Requests signed",entity:"TCAWRKHISSUI",endpoint:"x3.erp.GX3APP",action:"$query",representation:"PSHSIGM",facet:"$query",icon:"s-m-purchase-quotessigned"},$x3OrdersSigned:{$type:"$representation",$title:"Orders signed",entity:"TCAWRKHISSUI",endpoint:"x3.erp.GX3APP",action:"$query",representation:"POHSIGM",facet:"$query",icon:"s-m-purchase-orderssigned"},$x3OpenOrdersSigned:{$type:"$representation",$title:"Open Orders signed",entity:"TCAWRKHISSUI",endpoint:"x3.erp.GX3APP",action:"$query",representation:"POCSIGM",facet:"$query",icon:"s-m-purchase-openorderssigned"},$x3PurchasePriceInquiry:{$type:"$representation",$title:"Purchase price inquiry",entity:"PPRICESEARCH",endpoint:"x3.erp.GX3APP",action:"$query",representation:"PPRICSEARCHM",facet:"$query",icon:"s-m-purchase-priceinquiry"}}}),define("syracuse-tablet/html/js/demos/purchaseMyActions/main",["require","exports","module","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/demos/purchaseMyActions/dashPurchaseMyActions","syracuse-tablet/html/js/demos/utils"],function(require,exports,module){var clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),dashPurchaseMyActions=require("syracuse-tablet/html/js/demos/purchaseMyActions/dashPurchaseMyActions"),demoUtils=require("syracuse-tablet/html/js/demos/utils"),_demoApp={$application:{$uuid:"$demoPurchaseMyActions",applicationName:"sagepurchaseactions",title:"Purchase My Actions",description:"",isSageApplication:!0,iconName:"s-m-purchase-actions",$homeDashboard:{$uuid:"$purchaseMyActionsDashboard",dashboardName:"$purchaseMyActionsDashboard"}},$dashboards:{},$gadgets:{}};exports.register=function(){demoUtils.addToApp(_demoApp,dashPurchaseMyActions),clientContract.registerApp(_demoApp)}}),define("syracuse-tablet/html/js/demos/purchaseMyInquiries/dashPurchaseMyInquiries",["require","exports","module"],function(require,exports,module){exports.dashboards={$purchaseMyInquiriesDashboard:{$dashboardName:"$purchaseMyInquiriesDashboard",$title:"Purchase My Inquiries Dashboard",$description:"",$vignettes:{$x3PriceInquiry:{$uuid:"$x3PriceInquiry",$displayStyle:"$link"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Purchase My Inquiries",$items:[{$layoutType:"tile",$title:"Price Inquiriy",$size:"medium",$items:[{$bind:"$x3PriceInquiry"}]}]}]}}},exports.gadgets={$x3PriceInquiry:{$type:"$representation",$title:"Price inquiry",entity:"PPRICESEARCH",endpoint:"x3.erp.GX3APP",action:"$create",representation:"PPRICSEARCHM",facet:"$create",icon:"s-m-purchase-priceinquiry"}}}),define("syracuse-tablet/html/js/demos/purchaseMyInquiries/main",["require","exports","module","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/demos/purchaseMyInquiries/dashPurchaseMyInquiries","syracuse-tablet/html/js/demos/utils"],function(require,exports,module){var clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),dashPurchaseMyInquiries=require("syracuse-tablet/html/js/demos/purchaseMyInquiries/dashPurchaseMyInquiries"),demoUtils=require("syracuse-tablet/html/js/demos/utils"),_demoApp={$application:{$uuid:"$demoPurchaseMyInquiries",applicationName:"sagepurchaseinquiries",title:"Purchase - My Inquiries",description:"",isSageApplication:!0,iconName:"s-m-purchase-inquiries",$homeDashboard:{$uuid:"$purchaseMyInquiriesDashboard",dashboardName:"$purchaseMyInquiriesDashboard"}},$dashboards:{},$gadgets:{}};exports.register=function(){demoUtils.addToApp(_demoApp,dashPurchaseMyInquiries),clientContract.registerApp(_demoApp)}}),define("syracuse-tablet/html/js/demos/myExpenses/dashExpenses",["require","exports","module"],function(require,exports,module){var _$queryLinkArticle={$layoutType:"stack",$localization:{},$items:[{$bind:"$resources",$isTitleHidden:!0,$arrayOptions:{showPagination:!0,showSortFilter:!0,showSearch:!0,rowIndex:!1,showRowDetailLink:!1},$arrayBgColor:"darkgrey",$table:[{$bind:"DATEXS",$type:"application/x-date",$titleOrig:"{@212}",$widthType:"fixed",$widthVal:8,$imgHeight:"small",$title:"Date"},{$bind:"FCY_REF",$type:"application/x-reference",$titleOrig:"{@1344}",$widthType:"auto",$widthVal:0,$refDescPosition:"right",$imgHeight:"small",$title:"Site"},{$bind:"CODEXP_REF",$type:"application/x-reference",$titleOrig:"{@41193}",$widthType:"fixed",$widthVal:8,$refDescPosition:"none",$imgHeight:"small",$title:"Code frais"},{$bind:"QTY",$type:"application/x-integer",$titleOrig:"{@271}",$widthType:"fixed",$widthVal:5,$imgHeight:"small",$title:"Quantité"}]}]};exports.dashboards={$expensesDashboard:{$dashboardName:"$expensesDashboard",$title:"Expenses Dashboard",$description:"",$vignettes:{$x3expensesList:{$uuid:"$x3expensesList",$displayStyle:"$full"},$x3expensesList1:{$uuid:"$x3expensesList",$displayStyle:"$full"},$x3expensesNotApproved:{$uuid:"$x3expensesNotApproved",$displayStyle:"$full"},$x3expensesCreate:{$uuid:"$x3expensesCreate",$displayStyle:"$link"},$x3expensesCreateVignette:{$uuid:"$x3expensesCreate",$displayStyle:"$full"},$x3expensesNotApprovedIco:{$uuid:"$x3expensesNotApproved",$displayStyle:"$link"},$x3expensesListIco:{$uuid:"$x3expensesList",$displayStyle:"$link"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Expenses",$items:[{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3expensesCreate"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3expensesNotApprovedIco"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3expensesListIco"}]}]},{$layoutType:"hubGroup",$title:"Expenses Create",$items:[{$layoutType:"tile",$title:"Expenses Create",$size:"full",$items:[{$bind:"$x3expensesCreateVignette",$pageActionSettings:[{name:"$save",icon:{css:"fa fa-check",name:"check"},$title:"Enregistrer",options:{footerHeader:!0,refreshPage:!1,multiselection:!1}}],$article:{$layoutType:"stack",$items:[{$bind:"CLB_REF"},{$bind:"DATEXS"},{$bind:"FCY_REF"},{$bind:"CODEXP_REF"},{$bind:"NBREXS"},{$bind:"ACCNUM"},{$bind:"QTY"},{$bind:"AMTPAY"},{$bind:"CUR_REF"},{$bind:"AMTATI"},{$bind:"DES"},{$bind:"BEXS",$imgHeight:"medium"},{$bind:"EXSDIMCEN",$arrayOptions:{showPagination:!1,showSortFilter:!1,rowIndex:!1,showRowDetailLink:!1}}]}}]},{$layoutType:"tile",$title:"Expenses Create",$size:"full",$items:[{$bind:"$x3expensesCreateVignette",$pageActionSettings:[{name:"$save",icon:{css:"fa fa-check",name:"check"},$title:"Enregistrer",options:{footerHeader:!0,refreshPage:!1,multiselection:!1}}],$article:{$layoutType:"stack",$items:[{$bind:"CLB_REF"},{$bind:"DATEXS"},{$bind:"FCY_REF"},{$bind:"CODEXP_REF"},{$bind:"NBREXS"},{$bind:"ACCNUM"},{$bind:"QTY"},{$bind:"AMTPAY"},{$bind:"CUR_REF"},{$bind:"AMTATI"},{$bind:"DES"},{$bind:"BEXS",$imgHeight:"medium"},{$bind:"EXSDIMCEN",$arrayOptions:{showPagination:!1,showSortFilter:!1,rowIndex:!1,showRowDetailLink:!1}}]}}]}]},{$layoutType:"hubGroup",$title:"Expenses List",$items:[{$layoutType:"tile",$title:"Expenses list",$size:"full",$items:[{$bind:"$x3expensesList",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$display:"card",$article:{$queryLinkArticle:_$queryLinkArticle,$items:[{$bind:"CLB_REF"},{$bind:"DATEXS"},{$bind:"CODEXP_REF"},{$bind:"AMTPAY"},{$bind:"CUR_REF"}]}}]}}]},{$layoutType:"tile",$title:"Expenses list",$size:"full",$items:[{$bind:"$x3expensesList1",$article:{$layoutType:"stack",$items:[{$bind:"$resources"}]}}]}]},{$layoutType:"hubGroup",$title:"Expenses Not Approved",$items:[{$layoutType:"tile",$title:"Expenses Not Approved",$size:"all",$items:[{$bind:"$x3expensesNotApproved",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$queryLinkArticle:_$queryLinkArticle,$display:"table",$arrayOptions:{showPagination:!0,showSortFilter:!0,showSearch:!0,rowIndex:!1},$article:{$items:[{$bind:"CLB_REF"},{$bind:"DATEXS"},{$bind:"CODEXP_REF"},{$bind:"AMTPAY"},{$bind:"CUR_REF"}]}}]}}]}]}]}}},exports.gadgets={$x3expensesList:{$type:"$representation",$title:"All Expenses",entity:"EXPENSES",endpoint:"x3.erp.GX3APP",action:"$query",representation:"EXPENCNSM",facet:"$query",icon:"s-m-expenses-all"},$x3expensesNotApproved:{$type:"$representation",$title:"Expenses not approved",entity:"EXPENSES",endpoint:"x3.erp.GX3APP",action:"$query",representation:"EXPENENTM",facet:"$query",icon:"s-m-expenses-notapproved"},$x3expensesCreate:{$type:"$representation",$title:"Create expense",entity:"EXPENSES",endpoint:"x3.erp.GX3APP",action:"$create",representation:"EXPENENTM",facet:"$create",icon:"s-m-expenses-create"}}}),define("syracuse-tablet/html/js/demos/myExpenses/main",["require","exports","module","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/demos/myExpenses/dashExpenses","syracuse-tablet/html/js/demos/utils"],function(require,exports,module){var clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),dashExpenses=require("syracuse-tablet/html/js/demos/myExpenses/dashExpenses"),demoUtils=require("syracuse-tablet/html/js/demos/utils"),_demoApp={$application:{$uuid:"$demoExpenses",applicationName:"sageexpenses",title:"My Expenses",isSageApplication:!0,description:"",iconName:"s-m-expenses",$homeDashboard:{$uuid:"$expensesDashboard",dashboardName:"$expensesDashboard"}},$dashboards:{},$gadgets:{}};exports.register=function(){demoUtils.addToApp(_demoApp,dashExpenses),clientContract.registerApp(_demoApp)}}),define("syracuse-tablet/html/js/demos/fixedAssets/dashFixedAssets",["require","exports","module"],function(require,exports,module){var _queryLinkArticlePA={$layoutType:"stack",$items:[{$bind:"$resources",$display:"card",$cardsPerRow:3,$card:{$items:[{$bind:"LCTCOD_REF"},{$bind:"PHYDES1"},{$bind:"PHYREF"},{$bind:"BAC"},{$bind:"PHOTO"}]}}]},_queryLinkArticleLOC={$layoutType:"stack",$items:[{$bind:"$resources",$display:"card",$queryLinkArticle:_queryLinkArticleLOC,$cardsPerRow:3,$card:{$layoutType:"stack",$items:[{$bind:"BUICOD_REF"},{$bind:"LCTDES"},{$bind:"LCTCOD"},{$bind:"FLOOR"},{$bind:"BAC"},{$bind:"PHOTO"}]}}]};exports.dashboards={$fixedassetsDashboard:{$dashboardName:"$fixedassetsDashboard",$title:"Fixed Assets Dashboard",$description:"",$vignettes:{$x3fixedassetsList:{$uuid:"$x3fixedassetsList",$displayStyle:"$full"},$x3LocationList:{$uuid:"$x3LocationList",$displayStyle:"$full"},$x3LocationCreateLink:{$uuid:"$x3LocationCreate",$displayStyle:"$link"},$x3LocationListIco:{$uuid:"$x3LocationList",$displayStyle:"$link"},$x3FixedAssetCreateLink:{$uuid:"$x3FixedAssetCreate",$displayStyle:"$link"},$x3fixedassetsListIco:{$uuid:"$x3fixedassetsList",$displayStyle:"$link"},$x3FixedAssetCreate:{$uuid:"$x3FixedAssetCreate",$displayStyle:"$full"},$x3LocationCreate:{$uuid:"$x3LocationCreate",$displayStyle:"$full"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Create",$items:[{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3LocationCreateLink"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3LocationListIco"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3FixedAssetCreateLink"}]},{$layoutType:"tile",$title:"",$size:"medium",$items:[{$bind:"$x3fixedassetsListIco"}]}]},{$layoutType:"hubGroup",$title:"Queries",$items:[{$layoutType:"tile",$title:"Physical Assets - List",$size:"full",$items:[{$bind:"$x3fixedassetsList",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$display:"card",$queryLinkArticle:_queryLinkArticlePA,$cardsPerRow:3,$card:{$items:[{$bind:"LCTCOD_REF"},{$bind:"PHYDES1"},{$bind:"PHYREF"},{$bind:"BAC"},{$bind:"PHOTO"}]},$arrayOptions:{showSearch:!0}}]}}]},{$layoutType:"tile",$title:"Locations - List",$size:"full",$items:[{$bind:"$x3LocationList",$article:{$layoutType:"stack",$items:[{$bind:"$resources",$display:"card",$queryLinkArticle:_queryLinkArticleLOC,$cardsPerRow:3,$card:{$layoutType:"stack",$items:[{$bind:"BUICOD_REF"},{$bind:"LCTDES"},{$bind:"LCTCOD"},{$bind:"FLOOR"},{$bind:"BAC"},{$bind:"PHOTO"}]},$arrayOptions:{showSearch:!0}}]}}]}]},{$layoutType:"hubGroup",$title:"Creations",$items:[{$layoutType:"tile",$title:"Physical Assets - Create",$size:"full",$items:[{$bind:"$x3FixedAssetCreate",$pageActionSettings:[{name:"$save",icon:{css:"fa fa-check",name:"check"},$title:"Enregistrer",options:{footerHeader:!0,refreshPage:!1,multiselection:!1}}],$article:{$layoutType:"stack",$items:[{$bind:"LCTCOD_REF"},{$bind:"PHYDES1"},{$bind:"PHYREF"},{$bind:"BAC"}]}}]},{$layoutType:"tile",$title:"Locations - Create",$size:"full",$items:[{$bind:"$x3LocationCreate",$pageActionSettings:[{name:"$save",icon:{css:"fa fa-check",name:"check"},$title:"Enregistrer",options:{footerHeader:!0,refreshPage:!1,multiselection:!1}}],$article:{$layoutType:"stack",$items:[{$bind:"BUICOD_REF"},{$bind:"LCTDES"},{$bind:"LCTCOD"},{$bind:"FCY_REF"},{$bind:"BAC"},{$bind:"PHOTO"}]}}]}]}]}}},exports.gadgets={$x3fixedassetsList:{$type:"$representation",$title:"Query facet",entity:"PHYELT",endpoint:"x3.erp.GX3APP",action:"$query",representation:"PHYELTM",facet:"$query",icon:"s-m-physical-asset-query"},$x3LocationList:{$type:"$representation",$title:"Query facet",entity:"PHYLCT",endpoint:"x3.erp.GX3APP",action:"$query",representation:"PHYLCTM",facet:"$query",icon:"s-m-location-query"},$x3FixedAssetCreate:{$type:"$representation",$title:"Create Fixed Asset",entity:"PHYELT",endpoint:"x3.erp.GX3APP",action:"$create",representation:"PHYELTM",facet:"$create",icon:"s-m-physical-asset-create"},$x3LocationCreate:{$type:"$representation",$title:"Create Location",entity:"PHYLCT",endpoint:"x3.erp.GX3APP",action:"$create",representation:"PHYLCTM",facet:"$create",icon:"s-m-location-create"}}}),define("syracuse-tablet/html/js/demos/fixedAssets/main",["require","exports","module","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/demos/fixedAssets/dashFixedAssets","syracuse-tablet/html/js/demos/utils"],function(require,exports,module){var clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),dashFixedAssets=require("syracuse-tablet/html/js/demos/fixedAssets/dashFixedAssets"),demoUtils=require("syracuse-tablet/html/js/demos/utils"),_demoApp={$application:{$uuid:"$demoFixedassets",applicationName:"PHYELT_MOBILE",title:"Fixed Assets",isSageApplication:!0,description:"",iconName:"s-m-physical-assets",$homeDashboard:{$uuid:"$fixedassetsDashboard",dashboardName:"$fixedassetsDashboard"}},$dashboards:{},$gadgets:{}};exports.register=function(){demoUtils.addToApp(_demoApp,dashFixedAssets),clientContract.registerApp(_demoApp)}}),define("syracuse-tablet/html/js/demos/availableStock/dashStock",["require","exports","module"],function(require,exports,module){exports.dashboards={$stockDashboard:{$dashboardName:"$stockDashboard",$title:"Available Stock Dashboard",$description:"",$vignettes:{$x3stockInquiry:{$uuid:"$x3stockInquiry",$displayStyle:"$link"}},$article:{$layoutType:"hub",$items:[{$layoutType:"hubGroup",$title:"Available Stock",$items:[{$layoutType:"tile",$title:"Available Stock",$size:"medium",$items:[{$bind:"$x3stockInquiry"}]}]}]}}},exports.gadgets={$x3stockInquiry:{$type:"$representation",$title:"Stock inquiry",entity:"STKCNSSDI",endpoint:"x3.erp.GX3APP",action:"$create",representation:"STKCNSSDIM",facet:"$create",icon:"s-m-sales-stockinquiry"}}}),define("syracuse-tablet/html/js/demos/availableStock/main",["require","exports","module","syracuse-tablet/html/js/sdata/entities/clientContract","syracuse-tablet/html/js/demos/availableStock/dashStock","syracuse-tablet/html/js/demos/utils"],function(require,exports,module){var clientContract=require("syracuse-tablet/html/js/sdata/entities/clientContract"),dashStock=require("syracuse-tablet/html/js/demos/availableStock/dashStock"),demoUtils=require("syracuse-tablet/html/js/demos/utils"),_demoApp={$application:{$uuid:"$demoStock",applicationName:"sageavailablestock",title:"Available Stock",isSageApplication:!0,description:"",iconName:"s-m-stock-available",$homeDashboard:{$uuid:"$stockDashboard",dashboardName:"$stockDashboard"}},$dashboards:{},$gadgets:{}};exports.register=function(){demoUtils.addToApp(_demoApp,dashStock),clientContract.registerApp(_demoApp)}}),define("syracuse-tablet/html/js/demos/main",["require","exports","module","syracuse-tablet/html/js/demos/salesMyCustomers/main","syracuse-tablet/html/js/demos/salesMyInquiries/main","syracuse-tablet/html/js/demos/salesMyActions/main","syracuse-tablet/html/js/demos/purchaseMyActions/main","syracuse-tablet/html/js/demos/purchaseMyInquiries/main","syracuse-tablet/html/js/demos/myExpenses/main","syracuse-tablet/html/js/demos/fixedAssets/main","syracuse-tablet/html/js/demos/availableStock/main"],function(require,exports,module){var _demos={salesMyCustomers:require("syracuse-tablet/html/js/demos/salesMyCustomers/main"),salesMyInquiries:require("syracuse-tablet/html/js/demos/salesMyInquiries/main"),salesMyActions:require("syracuse-tablet/html/js/demos/salesMyActions/main"),purchaseMyActions:require("syracuse-tablet/html/js/demos/purchaseMyActions/main"),purchaseMyInquiries:require("syracuse-tablet/html/js/demos/purchaseMyInquiries/main"),myExpenses:require("syracuse-tablet/html/js/demos/myExpenses/main"),fixedAssets:require("syracuse-tablet/html/js/demos/fixedAssets/main"),availableStock:require("syracuse-tablet/html/js/demos/availableStock/main")};exports.init=function(){for(var p in _demos)try{_demos[p].register()}catch(e){console.error("!!Error registering demo["+p+"]",e.stack)}}}),define("syracuse-tablet/html/js/helpers/unitTestManager",["require","exports","module","syracuse-tablet/html/js/helpers/globals"],function(require,exports,module){var globals=require("syracuse-tablet/html/js/helpers/globals"),_application=globals.getApplication(),_notifPageLoaded=function(step,page){if(step=="before"){$("[data-s-ut-page-is-current]").removeAttr("data-s-ut-page-is-current");return}if(step=="after"){if(!page)return;page.$$elmt.attr("data-s-ut-page-name",page.state.name);if(page.isVignette)return;page.$$elmt.attr("data-s-ut-page-is-current",page.state.name);return}},_notifUserCtxChanged=function(ctx,endpoint){globals.getApplication().$$elmt.removeAttr("data-s-ut-user-ctx");if(ctx&&endpoint){var data=[ctx.$user||"",ctx.$role||"",ctx.$lang||"",endpoint||""];globals.getApplication().$$elmt.attr("data-s-ut-user-ctx",data.join(","))}},_notifDeviceChanged=function(device,orientation){globals.getApplication().$$elmt.attr("data-s-ut-device",device+","+orientation)},_arrayAddRowInfo=function($$elmt,idx,rowData){$$elmt.attr("data-s-ut-row-idx",idx)},_addStructElmtId=function($$elmt,info){$$elmt.attr("data-s-ut-elmt-id",info)},_authAddRightPanelId=function($$elmt,id){id?$$elmt.attr("data-s-ut-auth-selected-elmt",id):$$elmt.removeAttr("data-s-ut-auth-selected-elmt")},_addBindAttribute=function(ctrl){ctrl&&ctrl.$$elmt&&ctrl.$bind&&ctrl.$$elmt.attr("data-s-ut-field-x3name",ctrl.$bind)},_authAddTreeElmtId=function($$elmt,info){$$elmt.attr("data-s-ut-auth-elmt-id",info)},_init=function(){globals.setUnitTestMgr(exports)};exports.notifPageLoaded=_notifPageLoaded,exports.notifUserCtxChanged=_notifUserCtxChanged,exports.notifDeviceChanged=_notifDeviceChanged,exports.arrayAddRowIndex=_arrayAddRowInfo,exports.addStructElmtId=_addStructElmtId,exports.authAddRightPanelId=_authAddRightPanelId,exports.authAddTreeElmtId=_authAddTreeElmtId,exports.addBindAttribute=_addBindAttribute,exports.init=_init,window.$unitTestManager=exports,exports.blurFocusElmt=function(){$(":focus").blur()}}),define("syracuse-tablet/html/js/init/initModules",["require","exports","module","syracuse-tablet/html/js/helpers/utils","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/application/appFactory","syracuse-tablet/html/js/application/appFactoryDeps","syracuse-tablet/html/js/controls/ctrlFactoryDeps","syracuse-tablet/html/js/ajax/ajax","syracuse-tablet/html/js/storage/storage","syracuse-tablet/html/js/sdata/sdataCache","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/ui/modals/modal","syracuse-tablet/html/js/helpers/siteLayout","syracuse-tablet/html/js/application/metaData","syracuse-tablet/html/js/ui/developmentPage","syracuse-tablet/html/js/helpers/uiSettings","syracuse-tablet/html/js/helpers/offlineManager","syracuse-tablet/html/js/application/pageRegistry","syracuse-tablet/html/js/helpers/native/native","syracuse-tablet/html/js/demos/clientTestApp/testApplication","syracuse-tablet/html/js/demos/main","syracuse-tablet/html/js/helpers/unitTestManager"],function(require,exports,module){function _applyDevelopmentSettings(){globals.isDvlpMode()&&globals.isDesktop()&&developmentPage.wasActive()&&developmentPage.show()}var utils=require("syracuse-tablet/html/js/helpers/utils"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),globals=require("syracuse-tablet/html/js/helpers/globals"),locale=require("syracuse-tablet/html/js/helpers/locale"),factory=require("syracuse-tablet/html/js/application/appFactory"),appFactoryDeps=require("syracuse-tablet/html/js/application/appFactoryDeps"),ctrlFactoryDeps=require("syracuse-tablet/html/js/controls/ctrlFactoryDeps"),ajax=require("syracuse-tablet/html/js/ajax/ajax"),storage=require("syracuse-tablet/html/js/storage/storage"),sdataCache=require("syracuse-tablet/html/js/sdata/sdataCache"),uiutils=require("syracuse-tablet/html/js/ui/uiUtils"),modal=require("syracuse-tablet/html/js/ui/modals/modal"),siteLayout=require("syracuse-tablet/html/js/helpers/siteLayout"),metaData=require("syracuse-tablet/html/js/application/metaData"),developmentPage=require("syracuse-tablet/html/js/ui/developmentPage"),uiSettings=require("syracuse-tablet/html/js/helpers/uiSettings"),offlineManager=require("syracuse-tablet/html/js/helpers/offlineManager"),pageRegistry=require("syracuse-tablet/html/js/application/pageRegistry"),native=require("syracuse-tablet/html/js/helpers/native/native"),testApplication=require("syracuse-tablet/html/js/demos/clientTestApp/testApplication"),demos=require("syracuse-tablet/html/js/demos/main");exports.init=function(){return $.smResolve().then(function(){return native.getSupportedDB()}).then(function(supportedDB){var st,cache;return uiSettings.init(),offlineManager.init(),pageRegistry.init(),globals.setSiteLayout(siteLayout),storage.init(supportedDB).then(function(){cache=new sdataCache.SDataCache(storage.getStorage())}).then(function(){globals.init(jsutils.isDvlpVersion()||utils.forceDvlpMode(),storage.getStorage(),cache,utils),globals.setMetaData(metaData)}).then(function(){return appFactoryDeps.init()}).then(function(){return ctrlFactoryDeps.init()}).then(function(){ajax.init({},locale),utils.init(locale)}).then(function(){demos.init()}).then(function(){globals.isDvlpMode()&&testApplication.register(),globals.isAutoUITestMode()&&require("syracuse-tablet/html/js/helpers/unitTestManager").init()}).then(function(){var app=factory.createApplication($("#s-m-app-id"));globals.setTabletApplication(app),globals.setModal(modal)}).then(function(){_applyDevelopmentSettings()}).then(function(){uiutils.triggerResizeInternal()})})}}),function(root,factory){typeof define=="function"&&define.amd?define("syracuse-tablet/html/deps/handlebars-latest",[],factory):typeof exports=="object"?module.exports=factory():root.Handlebars=root.Handlebars||factory()}(this,function(){var __module4__=function(){function SafeString(string){this.string=string}var __exports__;return SafeString.prototype.toString=function(){return""+this.string},__exports__=SafeString,__exports__}(),__module3__=function(__dependency1__){function escapeChar(chr){return escape[chr]}function extend(obj){for(var i=1;i<arguments.length;i++)for(var key in arguments[i])Object.prototype.hasOwnProperty.call(arguments[i],key)&&(obj[key]=arguments[i][key]);return obj}function escapeExpression(string){return string instanceof SafeString?string.toString():string==null?"":string?(string=""+string,possible.test(string)?string.replace(badChars,escapeChar):string):string+""}function isEmpty(value){return!value&&value!==0?!0:isArray(value)&&value.length===0?!0:!1}function appendContextPath(contextPath,id){return(contextPath?contextPath+".":"")+id}var __exports__={},SafeString=__dependency1__,escape={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},badChars=/[&<>"'`]/g,possible=/[&<>"'`]/;__exports__.extend=extend;var toString=Object.prototype.toString;__exports__.toString=toString;var isFunction=function(value){return typeof value=="function"};isFunction(/x/)&&(isFunction=function(value){return typeof value=="function"&&toString.call(value)==="[object Function]"});var isFunction;__exports__.isFunction=isFunction;var isArray=Array.isArray||function(value){return value&&typeof value=="object"?toString.call(value)==="[object Array]":!1};return __exports__.isArray=isArray,__exports__.escapeExpression=escapeExpression,__exports__.isEmpty=isEmpty,__exports__.appendContextPath=appendContextPath,__exports__}(__module4__),__module5__=function(){function Exception(message,node){var line;node&&node.firstLine&&(line=node.firstLine,message+=" - "+line+":"+node.firstColumn);var tmp=Error.prototype.constructor.call(this,message);for(var idx=0;idx<errorProps.length;idx++)this[errorProps[idx]]=tmp[errorProps[idx]];line&&(this.lineNumber=line,this.column=node.firstColumn)}var __exports__,errorProps=["description","fileName","lineNumber","message","name","number","stack"];return Exception.prototype=new Error,__exports__=Exception,__exports__}(),__module2__=function(__dependency1__,__dependency2__){function HandlebarsEnvironment(helpers,partials){this.helpers=helpers||{},this.partials=partials||{},registerDefaultHelpers(this)}function registerDefaultHelpers(instance){instance.registerHelper("helperMissing",function(){if(arguments.length===1)return undefined;throw new Exception("Missing helper: '"+arguments[arguments.length-1].name+"'")}),instance.registerHelper("blockHelperMissing",function(context,options){var inverse=options.inverse,fn=options.fn;if(context===!0)return fn(this);if(context===!1||context==null)return inverse(this);if(isArray(context))return context.length>0?(options.ids&&(options.ids=[options.name]),instance.helpers.each(context,options)):inverse(this);if(options.data&&options.ids){var data=createFrame(options.data);data.contextPath=Utils.appendContextPath(options.data.contextPath,options.name),options={data:data}}return fn(context,options)}),instance.registerHelper("each",function(context,options){if(!options)throw new Exception("Must pass iterator to #each");var fn=options.fn,inverse=options.inverse,i=0,ret="",data,contextPath;options.data&&options.ids&&(contextPath=Utils.appendContextPath(options.data.contextPath,options.ids[0])+"."),isFunction(context)&&(context=context.call(this)),options.data&&(data=createFrame(options.data));if(context&&typeof context=="object")if(isArray(context))for(var j=context.length;i<j;i++)data&&(data.index=i,data.first=i===0,data.last=i===context.length-1,contextPath&&(data.contextPath=contextPath+i)),ret+=fn(context[i],{data:data});else for(var key in context)context.hasOwnProperty(key)&&(data&&(data.key=key,data.index=i,data.first=i===0,contextPath&&(data.contextPath=contextPath+key)),ret+=fn(context[key],{data:data}),i++);return i===0&&(ret=inverse(this)),ret}),instance.registerHelper("if",function(conditional,options){return isFunction(conditional)&&(conditional=conditional.call(this)),!options.hash.includeZero&&!conditional||Utils.isEmpty(conditional)?options.inverse(this):options.fn(this)}),instance.registerHelper("unless",function(conditional,options){return instance.helpers["if"].call(this,conditional,{fn:options.inverse,inverse:options.fn,hash:options.hash})}),instance.registerHelper("with",function(context,options){isFunction(context)&&(context=context.call(this));var fn=options.fn;if(!Utils.isEmpty(context)){if(options.data&&options.ids){var data=createFrame(options.data);data.contextPath=Utils.appendContextPath(options.data.contextPath,options.ids[0]),options={data:data}}return fn(context,options)}return options.inverse(this)}),instance.registerHelper("log",function(message,options){var level=options.data&&options.data.level!=null?parseInt(options.data.level,10):1;instance.log(level,message)}),instance.registerHelper("lookup",function(obj,field){return obj&&obj[field]})}var __exports__={},Utils=__dependency1__,Exception=__dependency2__,VERSION="2.0.0";__exports__.VERSION=VERSION;var COMPILER_REVISION=6;__exports__.COMPILER_REVISION=COMPILER_REVISION;var REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};__exports__.REVISION_CHANGES=REVISION_CHANGES;var isArray=Utils.isArray,isFunction=Utils.isFunction,toString=Utils.toString,objectType="[object Object]";__exports__.HandlebarsEnvironment=HandlebarsEnvironment,HandlebarsEnvironment.prototype={constructor:HandlebarsEnvironment,logger:logger,log:log,registerHelper:function(name,fn){if(toString.call(name)===objectType){if(fn)throw new Exception("Arg not supported with multiple helpers");Utils.extend(this.helpers,name)}else this.helpers[name]=fn},unregisterHelper:function(name){delete this.helpers[name]},registerPartial:function(name,partial){toString.call(name)===objectType?Utils.extend(this.partials,name):this.partials[name]=partial},unregisterPartial:function(name){delete this.partials[name]}};var logger={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(level,message){if(logger.level<=level){var method=logger.methodMap[level];typeof console!="undefined"&&console[method]&&console[method].call(console,message)}}};__exports__.logger=logger;var log=logger.log;__exports__.log=log;var createFrame=function(object){var frame=Utils.extend({},object);return frame._parent=object,frame};return __exports__.createFrame=createFrame,__exports__}(__module3__,__module5__),__module6__=function(__dependency1__,__dependency2__,__dependency3__){function checkRevision(compilerInfo){var compilerRevision=compilerInfo&&compilerInfo[0]||1,currentRevision=COMPILER_REVISION;if(compilerRevision!==currentRevision){if(compilerRevision<currentRevision){var runtimeVersions=REVISION_CHANGES[currentRevision],compilerVersions=REVISION_CHANGES[compilerRevision];throw new Exception("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+runtimeVersions+") or downgrade your runtime to an older version ("+compilerVersions+").")}throw new Exception("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+compilerInfo[1]+").")}}function template(templateSpec,env){if(!env)throw new Exception("No environment passed to template");if(!templateSpec||!templateSpec.main)throw new Exception("Unknown template object: "+typeof templateSpec);env.VM.checkRevision(templateSpec.compiler);var invokePartialWrapper=function(partial,indent,name,context,hash,helpers,partials,data,depths){hash&&(context=Utils.extend({},context,hash));var result=env.VM.invokePartial.call(this,partial,name,context,helpers,partials,data,depths);if(result==null&&env.compile){var options={helpers:helpers,partials:partials,data:data,depths:depths};partials[name]=env.compile(partial,{data:data!==undefined,compat:templateSpec.compat},env),result=partials[name](context,options)}if(result!=null){if(indent){var lines=result.split("\n");for(var i=0,l=lines.length;i<l;i++){if(!lines[i]&&i+1===l)break;lines[i]=indent+lines[i]}result=lines.join("\n")}return result}throw new Exception("The partial "+name+" could not be compiled when running in runtime-only mode")},container={lookup:function(depths,name){var len=depths.length;for(var i=0;i<len;i++)if(depths[i]&&depths[i][name]!=null)return depths[i][name]},lambda:function(current,context){return typeof current=="function"?current.call(context):current},escapeExpression:Utils.escapeExpression,invokePartial:invokePartialWrapper,fn:function(i){return templateSpec[i]},programs:[],program:function(i,data,depths){var programWrapper=this.programs[i],fn=this.fn(i);return data||depths?programWrapper=program(this,i,fn,data,depths):programWrapper||(programWrapper=this.programs[i]=program(this,i,fn)),programWrapper},data:function(data,depth){while(data&&depth--)data=data._parent;return data},merge:function(param,common){var ret=param||common;return param&&common&&param!==common&&(ret=Utils.extend({},common,param)),ret},noop:env.VM.noop,compilerInfo:templateSpec.compiler},ret=function(context,options){options=options||{};var data=options.data;ret._setup(options),!options.partial&&templateSpec.useData&&(data=initData(context,data));var depths;return templateSpec.useDepths&&(depths=options.depths?[context].concat(options.depths):[context]),templateSpec.main.call(container,context,container.helpers,container.partials,data,depths)};return ret.isTop=!0,ret._setup=function(options){options.partial?(container.helpers=options.helpers,container.partials=options.partials):(container.helpers=container.merge(options.helpers,env.helpers),templateSpec.usePartial&&(container.partials=container.merge(options.partials,env.partials)))},ret._child=function(i,data,depths){if(templateSpec.useDepths&&!depths)throw new Exception("must pass parent depths");return program(container,i,templateSpec[i],data,depths)},ret}function program(container,i,fn,data,depths){var prog=function(context,options){return options=options||{},fn.call(container,context,container.helpers,container.partials,options.data||data,depths&&[context].concat(depths))};return prog.program=i,prog.depth=depths?depths.length:0,prog}function invokePartial(partial,name,context,helpers,partials,data,depths){var options={partial:!0,helpers:helpers,partials:partials,data:data,depths:depths};if(partial===undefined)throw new Exception("The partial "+name+" could not be found");if(partial instanceof Function)return partial(context,options)}function noop(){return""}function initData(context,data){if(!data||!("root"in data))data=data?createFrame(data):{},data.root=context;return data}var __exports__={},Utils=__dependency1__,Exception=__dependency2__,COMPILER_REVISION=__dependency3__.COMPILER_REVISION,REVISION_CHANGES=__dependency3__.REVISION_CHANGES,createFrame=__dependency3__.createFrame;return __exports__.checkRevision=checkRevision,__exports__.template=template,__exports__.program=program,__exports__.invokePartial=invokePartial,__exports__.noop=noop,__exports__}(__module3__,__module5__,__module2__),__module1__=function(__dependency1__,__dependency2__,__dependency3__,__dependency4__,__dependency5__){var __exports__,base=__dependency1__,SafeString=__dependency2__,Exception=__dependency3__,Utils=__dependency4__,runtime=__dependency5__,create=function(){var hb=new base.HandlebarsEnvironment;return Utils.extend(hb,base),hb.SafeString=SafeString,hb.Exception=Exception,hb.Utils=Utils,hb.escapeExpression=Utils.escapeExpression,hb.VM=runtime,hb.template=function(spec){return runtime.template(spec,hb)},hb},Handlebars=create();return Handlebars.create=create,Handlebars["default"]=Handlebars,__exports__=Handlebars,__exports__}(__module2__,__module4__,__module5__,__module3__,__module6__),__module7__=function(__dependency1__){function LocationInfo(locInfo){locInfo=locInfo||{},this.firstLine=locInfo.first_line,this.firstColumn=locInfo.first_column,this.lastColumn=locInfo.last_column,this.lastLine=locInfo.last_line}var __exports__,Exception=__dependency1__,AST={ProgramNode:function(statements,strip,locInfo){LocationInfo.call(this,locInfo),this.type="program",this.statements=statements,this.strip=strip},MustacheNode:function(rawParams,hash,open,strip,locInfo){LocationInfo.call(this,locInfo),this.type="mustache",this.strip=strip;if(open!=null&&open.charAt){var escapeFlag=open.charAt(3)||open.charAt(2);this.escaped=escapeFlag!=="{"&&escapeFlag!=="&"}else this.escaped=!!open;rawParams instanceof AST.SexprNode?this.sexpr=rawParams:this.sexpr=new AST.SexprNode(rawParams,hash),this.id=this.sexpr.id,this.params=this.sexpr.params,this.hash=this.sexpr.hash,this.eligibleHelper=this.sexpr.eligibleHelper,this.isHelper=this.sexpr.isHelper},SexprNode:function(rawParams,hash,locInfo){LocationInfo.call(this,locInfo),this.type="sexpr",this.hash=hash;var id=this.id=rawParams[0],params=this.params=rawParams.slice(1);this.isHelper=!!params.length||!!hash,this.eligibleHelper=this.isHelper||id.isSimple},PartialNode:function(partialName,context,hash,strip,locInfo){LocationInfo.call(this,locInfo),this.type="partial",this.partialName=partialName,this.context=context,this.hash=hash,this.strip=strip,this.strip.inlineStandalone=!0},BlockNode:function(mustache,program,inverse,strip,locInfo){LocationInfo.call(this,locInfo),this.type="block",this.mustache=mustache,this.program=program,this.inverse=inverse,this.strip=strip,inverse&&!program&&(this.isInverse=!0)},RawBlockNode:function(mustache,content,close,locInfo){LocationInfo.call(this,locInfo);if(mustache.sexpr.id.original!==close)throw new Exception(mustache.sexpr.id.original+" doesn't match "+close,this);content=new AST.ContentNode(content,locInfo),this.type="block",this.mustache=mustache,this.program=new AST.ProgramNode([content],{},locInfo)},ContentNode:function(string,locInfo){LocationInfo.call(this,locInfo),this.type="content",this.original=this.string=string},HashNode:function(pairs,locInfo){LocationInfo.call(this,locInfo),this.type="hash",this.pairs=pairs},IdNode:function(parts,locInfo){LocationInfo.call(this,locInfo),this.type="ID";var original="",dig=[],depth=0,depthString="";for(var i=0,l=parts.length;i<l;i++){var part=parts[i].part;original+=(parts[i].separator||"")+part;if(part===".."||part==="."||part==="this"){if(dig.length>0)throw new Exception("Invalid path: "+original,this);part===".."?(depth++,depthString+="../"):this.isScoped=!0}else dig.push(part)}this.original=original,this.parts=dig,this.string=dig.join("."),this.depth=depth,this.idName=depthString+this.string,this.isSimple=parts.length===1&&!this.isScoped&&depth===0,this.stringModeValue=this.string},PartialNameNode:function(name,locInfo){LocationInfo.call(this,locInfo),this.type="PARTIAL_NAME",this.name=name.original},DataNode:function(id,locInfo){LocationInfo.call(this,locInfo),this.type="DATA",this.id=id,this.stringModeValue=id.stringModeValue,this.idName="@"+id.stringModeValue},StringNode:function(string,locInfo){LocationInfo.call(this,locInfo),this.type="STRING",this.original=this.string=this.stringModeValue=string},NumberNode:function(number,locInfo){LocationInfo.call(this,locInfo),this.type="NUMBER",this.original=this.number=number,this.stringModeValue=Number(number)},BooleanNode:function(bool,locInfo){LocationInfo.call(this,locInfo),this.type="BOOLEAN",this.bool=bool,this.stringModeValue=bool==="true"},CommentNode:function(comment,locInfo){LocationInfo.call(this,locInfo),this.type="comment",this.comment=comment,this.strip={inlineStandalone:!0}}};return __exports__=AST,__exports__}(__module5__),__module9__=function(){var __exports__,handlebars=function(){function Parser(){this.yy={}}var parser={trace:function trace(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,CONTENT:12,COMMENT:13,openRawBlock:14,END_RAW_BLOCK:15,OPEN_RAW_BLOCK:16,sexpr:17,CLOSE_RAW_BLOCK:18,openBlock:19,block_option0:20,closeBlock:21,openInverse:22,block_option1:23,OPEN_BLOCK:24,CLOSE:25,OPEN_INVERSE:26,inverseAndProgram:27,INVERSE:28,OPEN_ENDBLOCK:29,path:30,OPEN:31,OPEN_UNESCAPED:32,CLOSE_UNESCAPED:33,OPEN_PARTIAL:34,partialName:35,param:36,partial_option0:37,partial_option1:38,sexpr_repetition0:39,sexpr_option0:40,dataName:41,STRING:42,NUMBER:43,BOOLEAN:44,OPEN_SEXPR:45,CLOSE_SEXPR:46,hash:47,hash_repetition_plus0:48,hashSegment:49,ID:50,EQUALS:51,DATA:52,pathSegments:53,SEP:54,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",12:"CONTENT",13:"COMMENT",15:"END_RAW_BLOCK",16:"OPEN_RAW_BLOCK",18:"CLOSE_RAW_BLOCK",24:"OPEN_BLOCK",25:"CLOSE",26:"OPEN_INVERSE",28:"INVERSE",29:"OPEN_ENDBLOCK",31:"OPEN",32:"OPEN_UNESCAPED",33:"CLOSE_UNESCAPED",34:"OPEN_PARTIAL",42:"STRING",43:"NUMBER",44:"BOOLEAN",45:"OPEN_SEXPR",46:"CLOSE_SEXPR",50:"ID",51:"EQUALS",52:"DATA",54:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[10,3],[14,3],[9,4],[9,4],[19,3],[22,3],[27,2],[21,3],[8,3],[8,3],[11,5],[11,4],[17,3],[17,1],[36,1],[36,1],[36,1],[36,1],[36,1],[36,3],[47,1],[49,3],[35,1],[35,1],[35,1],[41,2],[30,1],[53,3],[53,1],[6,0],[6,2],[20,0],[20,1],[23,0],[23,1],[37,0],[37,1],[38,0],[38,1],[39,0],[39,2],[40,0],[40,1],[48,1],[48,2]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return yy.prepareProgram($$[$0-1].statements,!0),$$[$0-1];case 2:this.$=new yy.ProgramNode(yy.prepareProgram($$[$0]),{},this._$);break;case 3:this.$=$$[$0];break;case 4:this.$=$$[$0];break;case 5:this.$=$$[$0];break;case 6:this.$=$$[$0];break;case 7:this.$=new yy.ContentNode($$[$0],this._$);break;case 8:this.$=new yy.CommentNode($$[$0],this._$);break;case 9:this.$=new yy.RawBlockNode($$[$0-2],$$[$0-1],$$[$0],this._$);break;case 10:this.$=new yy.MustacheNode($$[$0-1],null,"","",this._$);break;case 11:this.$=yy.prepareBlock($$[$0-3],$$[$0-2],$$[$0-1],$$[$0],!1,this._$);break;case 12:this.$=yy.prepareBlock($$[$0-3],$$[$0-2],$$[$0-1],$$[$0],!0,this._$);break;case 13:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],yy.stripFlags($$[$0-2],$$[$0]),this._$);break;case 14:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],yy.stripFlags($$[$0-2],$$[$0]),this._$);break;case 15:this.$={strip:yy.stripFlags($$[$0-1],$$[$0-1]),program:$$[$0]};break;case 16:this.$={path:$$[$0-1],strip:yy.stripFlags($$[$0-2],$$[$0])};break;case 17:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],yy.stripFlags($$[$0-2],$$[$0]),this._$);break;case 18:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],yy.stripFlags($$[$0-2],$$[$0]),this._$);break;case 19:this.$=new yy.PartialNode($$[$0-3],$$[$0-2],$$[$0-1],yy.stripFlags($$[$0-4],$$[$0]),this._$);break;case 20:this.$=new yy.PartialNode($$[$0-2],undefined,$$[$0-1],yy.stripFlags($$[$0-3],$$[$0]),this._$);break;case 21:this.$=new yy.SexprNode([$$[$0-2]].concat($$[$0-1]),$$[$0],this._$);break;case 22:this.$=new yy.SexprNode([$$[$0]],null,this._$);break;case 23:this.$=$$[$0];break;case 24:this.$=new yy.StringNode($$[$0],this._$);break;case 25:this.$=new yy.NumberNode($$[$0],this._$);break;case 26:this.$=new yy.BooleanNode($$[$0],this._$);break;case 27:this.$=$$[$0];break;case 28:$$[$0-1].isHelper=!0,this.$=$$[$0-1];break;case 29:this.$=new yy.HashNode($$[$0],this._$);break;case 30:this.$=[$$[$0-2],$$[$0]];break;case 31:this.$=new yy.PartialNameNode($$[$0],this._$);break;case 32:this.$=new yy.PartialNameNode(new yy.StringNode($$[$0],this._$),this._$);break;case 33:this.$=new yy.PartialNameNode(new yy.NumberNode($$[$0],this._$));break;case 34:this.$=new yy.DataNode($$[$0],this._$);break;case 35:this.$=new yy.IdNode($$[$0],this._$);break;case 36:$$[$0-2].push({part:$$[$0],separator:$$[$0-1]}),this.$=$$[$0-2];break;case 37:this.$=[{part:$$[$0]}];break;case 38:this.$=[];break;case 39:$$[$0-1].push($$[$0]);break;case 48:this.$=[];break;case 49:$$[$0-1].push($$[$0]);break;case 52:this.$=[$$[$0]];break;case 53:$$[$0-1].push($$[$0])}},table:[{3:1,4:2,5:[2,38],6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],31:[2,38],32:[2,38],34:[2,38]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:[1,10],13:[1,11],14:16,16:[1,20],19:14,22:15,24:[1,18],26:[1,19],28:[2,2],29:[2,2],31:[1,12],32:[1,13],34:[1,17]},{1:[2,1]},{5:[2,39],12:[2,39],13:[2,39],16:[2,39],24:[2,39],26:[2,39],28:[2,39],29:[2,39],31:[2,39],32:[2,39],34:[2,39]},{5:[2,3],12:[2,3],13:[2,3],16:[2,3],24:[2,3],26:[2,3],28:[2,3],29:[2,3],31:[2,3],32:[2,3],34:[2,3]},{5:[2,4],12:[2,4],13:[2,4],16:[2,4],24:[2,4],26:[2,4],28:[2,4],29:[2,4],31:[2,4],32:[2,4],34:[2,4]},{5:[2,5],12:[2,5],13:[2,5],16:[2,5],24:[2,5],26:[2,5],28:[2,5],29:[2,5],31:[2,5],32:[2,5],34:[2,5]},{5:[2,6],12:[2,6],13:[2,6],16:[2,6],24:[2,6],26:[2,6],28:[2,6],29:[2,6],31:[2,6],32:[2,6],34:[2,6]},{5:[2,7],12:[2,7],13:[2,7],16:[2,7],24:[2,7],26:[2,7],28:[2,7],29:[2,7],31:[2,7],32:[2,7],34:[2,7]},{5:[2,8],12:[2,8],13:[2,8],16:[2,8],24:[2,8],26:[2,8],28:[2,8],29:[2,8],31:[2,8],32:[2,8],34:[2,8]},{17:21,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:27,30:22,41:23,50:[1,26],52:[1,25],53:24},{4:28,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{4:29,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{12:[1,30]},{30:32,35:31,42:[1,33],43:[1,34],50:[1,26],53:24},{17:35,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:36,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:37,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[1,38]},{18:[2,48],25:[2,48],33:[2,48],39:39,42:[2,48],43:[2,48],44:[2,48],45:[2,48],46:[2,48],50:[2,48],52:[2,48]},{18:[2,22],25:[2,22],33:[2,22],46:[2,22]},{18:[2,35],25:[2,35],33:[2,35],42:[2,35],43:[2,35],44:[2,35],45:[2,35],46:[2,35],50:[2,35],52:[2,35],54:[1,40]},{30:41,50:[1,26],53:24},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],52:[2,37],54:[2,37]},{33:[1,42]},{20:43,27:44,28:[1,45],29:[2,40]},{23:46,27:47,28:[1,45],29:[2,42]},{15:[1,48]},{25:[2,46],30:51,36:49,38:50,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],47:57,48:58,49:60,50:[1,59],52:[1,25],53:24},{25:[2,31],42:[2,31],43:[2,31],44:[2,31],45:[2,31],50:[2,31],52:[2,31]},{25:[2,32],42:[2,32],43:[2,32],44:[2,32],45:[2,32],50:[2,32],52:[2,32]},{25:[2,33],42:[2,33],43:[2,33],44:[2,33],45:[2,33],50:[2,33],52:[2,33]},{25:[1,61]},{25:[1,62]},{18:[1,63]},{5:[2,17],12:[2,17],13:[2,17],16:[2,17],24:[2,17],26:[2,17],28:[2,17],29:[2,17],31:[2,17],32:[2,17],34:[2,17]},{18:[2,50],25:[2,50],30:51,33:[2,50],36:65,40:64,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],46:[2,50],47:66,48:58,49:60,50:[1,59],52:[1,25],53:24},{50:[1,67]},{18:[2,34],25:[2,34],33:[2,34],42:[2,34],43:[2,34],44:[2,34],45:[2,34],46:[2,34],50:[2,34],52:[2,34]},{5:[2,18],12:[2,18],13:[2,18],16:[2,18],24:[2,18],26:[2,18],28:[2,18],29:[2,18],31:[2,18],32:[2,18],34:[2,18]},{21:68,29:[1,69]},{29:[2,41]},{4:70,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{21:71,29:[1,69]},{29:[2,43]},{5:[2,9],12:[2,9],13:[2,9],16:[2,9],24:[2,9],26:[2,9],28:[2,9],29:[2,9],31:[2,9],32:[2,9],34:[2,9]},{25:[2,44],37:72,47:73,48:58,49:60,50:[1,74]},{25:[1,75]},{18:[2,23],25:[2,23],33:[2,23],42:[2,23],43:[2,23],44:[2,23],45:[2,23],46:[2,23],50:[2,23],52:[2,23]},{18:[2,24],25:[2,24],33:[2,24],42:[2,24],43:[2,24],44:[2,24],45:[2,24],46:[2,24],50:[2,24],52:[2,24]},{18:[2,25],25:[2,25],33:[2,25],42:[2,25],43:[2,25],44:[2,25],45:[2,25],46:[2,25],50:[2,25],52:[2,25]},{18:[2,26],25:[2,26],33:[2,26],42:[2,26],43:[2,26],44:[2,26],45:[2,26],46:[2,26],50:[2,26],52:[2,26]},{18:[2,27],25:[2,27],33:[2,27],42:[2,27],43:[2,27],44:[2,27],45:[2,27],46:[2,27],50:[2,27],52:[2,27]},{17:76,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[2,47]},{18:[2,29],25:[2,29],33:[2,29],46:[2,29],49:77,50:[1,74]},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],51:[1,78],52:[2,37],54:[2,37]},{18:[2,52],25:[2,52],33:[2,52],46:[2,52],50:[2,52]},{12:[2,13],13:[2,13],16:[2,13],24:[2,13],26:[2,13],28:[2,13],29:[2,13],31:[2,13],32:[2,13],34:[2,13]},{12:[2,14],13:[2,14],16:[2,14],24:[2,14],26:[2,14],28:[2,14],29:[2,14],31:[2,14],32:[2,14],34:[2,14]},{12:[2,10]},{18:[2,21],25:[2,21],33:[2,21],46:[2,21]},{18:[2,49],25:[2,49],33:[2,49],42:[2,49],43:[2,49],44:[2,49],45:[2,49],46:[2,49],50:[2,49],52:[2,49]},{18:[2,51],25:[2,51],33:[2,51],46:[2,51]},{18:[2,36],25:[2,36],33:[2,36],42:[2,36],43:[2,36],44:[2,36],45:[2,36],46:[2,36],50:[2,36],52:[2,36],54:[2,36]},{5:[2,11],12:[2,11],13:[2,11],16:[2,11],24:[2,11],26:[2,11],28:[2,11],29:[2,11],31:[2,11],32:[2,11],34:[2,11]},{30:79,50:[1,26],53:24},{29:[2,15]},{5:[2,12],12:[2,12],13:[2,12],16:[2,12],24:[2,12],26:[2,12],28:[2,12],29:[2,12],31:[2,12],32:[2,12],34:[2,12]},{25:[1,80]},{25:[2,45]},{51:[1,78]},{5:[2,20],12:[2,20],13:[2,20],16:[2,20],24:[2,20],26:[2,20],28:[2,20],29:[2,20],31:[2,20],32:[2,20],34:[2,20]},{46:[1,81]},{18:[2,53],25:[2,53],33:[2,53],46:[2,53],50:[2,53]},{30:51,36:82,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],50:[1,26],52:[1,25],53:24},{25:[1,83]},{5:[2,19],12:[2,19],13:[2,19],16:[2,19],24:[2,19],26:[2,19],28:[2,19],29:[2,19],31:[2,19],32:[2,19],34:[2,19]},{18:[2,28],25:[2,28],33:[2,28],42:[2,28],43:[2,28],44:[2,28],45:[2,28],46:[2,28],50:[2,28],52:[2,28]},{18:[2,30],25:[2,30],33:[2,30],46:[2,30],50:[2,30]},{5:[2,16],12:[2,16],13:[2,16],16:[2,16],24:[2,16],26:[2,16],28:[2,16],29:[2,16],31:[2,16],32:[2,16],34:[2,16]}],defaultActions:{4:[2,1],44:[2,41],47:[2,43],57:[2,47],63:[2,10],70:[2,15],73:[2,45]},parseError:function parseError(str,hash){throw new Error(str)},parse:function parse(input){function popStack(n){stack.length=stack.length-2*n,vstack.length=vstack.length-n,lstack.length=lstack.length-n}function lex(){var token;return token=self.lexer.lex()||1,typeof token!="number"&&(token=self.symbols_[token]||token),token}var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext="",yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1;this.lexer.setInput(input),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var yyloc=this.lexer.yylloc;lstack.push(yyloc);var ranges=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var symbol,preErrorSymbol,state,action,a,r,yyval={},p,len,newState,expected;for(;;){state=stack[stack.length-1];if(this.defaultActions[state])action=this.defaultActions[state];else{if(symbol===null||typeof symbol=="undefined")symbol=lex();action=table[state]&&table[state][symbol]}if(typeof action=="undefined"||!action.length||!action[0]){var errStr="";if(!recovering){expected=[];for(p in table[state])this.terminals_[p]&&p>2&&expected.push("'"+this.terminals_[p]+"'");this.lexer.showPosition?errStr="Parse error on line "+(yylineno+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+expected.join(", ")+", got '"+(this.terminals_[symbol]||symbol)+"'":errStr="Parse error on line "+(yylineno+1)+": Unexpected "+(symbol==1?"end of input":"'"+(this.terminals_[symbol]||symbol)+"'"),this.parseError(errStr,{text:this.lexer.match,token:this.terminals_[symbol]||symbol,line:this.lexer.yylineno,loc:yyloc,expected:expected})}}if(action[0]instanceof Array&&action.length>1)throw new Error("Parse Error: multiple actions possible at state: "+state+", token: "+symbol);switch(action[0]){case 1:stack.push(symbol),vstack.push(this.lexer.yytext),lstack.push(this.lexer.yylloc),stack.push(action[1]),symbol=null,preErrorSymbol?(symbol=preErrorSymbol,preErrorSymbol=null):(yyleng=this.lexer.yyleng,yytext=this.lexer.yytext,yylineno=this.lexer.yylineno,yyloc=this.lexer.yylloc,recovering>0&&recovering--);break;case 2:len=this.productions_[action[1]][1],yyval.$=vstack[vstack.length-len],yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column},ranges&&(yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]),r=this.performAction.call(yyval,yytext,yyleng,yylineno,this.yy,action[1],vstack,lstack);if(typeof r!="undefined")return r;len&&(stack=stack.slice(0,-1*len*2),vstack=vstack.slice(0,-1*len),lstack=lstack.slice(0,-1*len)),stack.push(this.productions_[action[1]][0]),vstack.push(yyval.$),lstack.push(yyval._$),newState=table[stack[stack.length-2]][stack[stack.length-1]],stack.push(newState);break;case 3:return!0}}return!0}},lexer=function(){var lexer={EOF:1,parseError:function parseError(str,hash){if(!this.yy.parser)throw new Error(str);this.yy.parser.parseError(str,hash)},setInput:function(input){return this._input=input,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var ch=this._input[0];this.yytext+=ch,this.yyleng++,this.offset++,this.match+=ch,this.matched+=ch;var lines=ch.match(/(?:\r\n?|\n).*/g);return lines?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),ch},unput:function(ch){var len=ch.length,lines=ch.split(/(?:\r\n?|\n)/g);this._input=ch+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-len-1),this.offset-=len;var oldLines=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),lines.length-1&&(this.yylineno-=lines.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-len]),this},more:function(){return this._more=!0,this},less:function(n){this.unput(this.match.slice(n))},pastInput:function(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?"...":"")+past.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var next=this.match;return next.length<20&&(next+=this._input.substr(0,20-next.length)),(next.substr(0,20)+(next.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var pre=this.pastInput(),c=(new Array(pre.length+1)).join("-");return pre+this.upcomingInput()+"\n"+c+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var token,match,tempMatch,index,col,lines;this._more||(this.yytext="",this.match="");var rules=this._currentRules();for(var i=0;i<rules.length;i++){tempMatch=this._input.match(this.rules[rules[i]]);if(tempMatch&&(!match||tempMatch[0].length>match[0].length)){match=tempMatch,index=i;if(!this.options.flex)break}}if(match){lines=match[0].match(/(?:\r\n?|\n).*/g),lines&&(this.yylineno+=lines.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+match[0].length},this.yytext+=match[0],this.match+=match[0],this.matches=match,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(match[0].length),this.matched+=match[0],token=this.performAction.call(this,this.yy,this,rules[index],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1);if(token)return token;return}return this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function lex(){var r=this.next();return typeof r!="undefined"?r:this.lex()},begin:function begin(condition){this.conditionStack.push(condition)},popState:function popState(){return this.conditionStack.pop()},_currentRules:function _currentRules(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function begin(condition){this.begin(condition)}};return lexer.options={},lexer.performAction=function anonymous(yy,yy_,$avoiding_name_collisions,YY_START){function strip(start,end){return yy_.yytext=yy_.yytext.substr(start,yy_.yyleng-end)}var YYSTATE=YY_START;switch($avoiding_name_collisions){case 0:yy_.yytext.slice(-2)==="\\\\"?(strip(0,1),this.begin("mu")):yy_.yytext.slice(-1)==="\\"?(strip(0,1),this.begin("emu")):this.begin("mu");if(yy_.yytext)return 12;break;case 1:return 12;case 2:return this.popState(),12;case 3:return yy_.yytext=yy_.yytext.substr(5,yy_.yyleng-9),this.popState(),15;case 4:return 12;case 5:return strip(0,4),this.popState(),13;case 6:return 45;case 7:return 46;case 8:return 16;case 9:return this.popState(),this.begin("raw"),18;case 10:return 34;case 11:return 24;case 12:return 29;case 13:return this.popState(),28;case 14:return this.popState(),28;case 15:return 26;case 16:return 26;case 17:return 32;case 18:return 31;case 19:this.popState(),this.begin("com");break;case 20:return strip(3,5),this.popState(),13;case 21:return 31;case 22:return 51;case 23:return 50;case 24:return 50;case 25:return 54;case 26:break;case 27:return this.popState(),33;case 28:return this.popState(),25;case 29:return yy_.yytext=strip(1,2).replace(/\\"/g,'"'),42;case 30:return yy_.yytext=strip(1,2).replace(/\\'/g,"'"),42;case 31:return 52;case 32:return 44;case 33:return 44;case 34:return 43;case 35:return 50;case 36:return yy_.yytext=strip(1,2),50;case 37:return"INVALID";case 38:return 5}},lexer.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],lexer.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[5],inclusive:!1},raw:{rules:[3,4],inclusive:!1},INITIAL:{rules:[0,1,38],inclusive:!0}},lexer}();return parser.lexer=lexer,Parser.prototype=parser,parser.Parser=Parser,new Parser}();return __exports__=handlebars,__exports__}(),__module10__=function(__dependency1__){function stripFlags(open,close){return{left:open.charAt(2)==="~",right:close.charAt(close.length-3)==="~"}}function prepareBlock(mustache,program,inverseAndProgram,close,inverted,locInfo){if(mustache.sexpr.id.original!==close.path.original)throw new Exception(mustache.sexpr.id.original+" doesn't match "+close.path.original,mustache);var inverse=inverseAndProgram&&inverseAndProgram.program,strip={left:mustache.strip.left,right:close.strip.right,openStandalone:isNextWhitespace(program.statements),closeStandalone:isPrevWhitespace((inverse||program).statements)};mustache.strip.right&&omitRight(program.statements,null,!0);if(inverse){var inverseStrip=inverseAndProgram.strip;inverseStrip.left&&omitLeft(program.statements,null,!0),inverseStrip.right&&omitRight(inverse.statements,null,!0),close.strip.left&&omitLeft(inverse.statements,null,!0),isPrevWhitespace(program.statements)&&isNextWhitespace(inverse.statements)&&(omitLeft(program.statements),omitRight(inverse.statements))}else close.strip.left&&omitLeft(program.statements,null,!0);return inverted?new this.BlockNode(mustache,inverse,program,strip,locInfo):new this.BlockNode(mustache,program,inverse,strip,locInfo)}function prepareProgram(statements,isRoot){for(var i=0,l=statements.length;i<l;i++){var current=statements[i],strip=current.strip;if(!strip)continue;var _isPrevWhitespace=isPrevWhitespace(statements,i,isRoot,current.type==="partial"),_isNextWhitespace=isNextWhitespace(statements,i,isRoot),openStandalone=strip.openStandalone&&_isPrevWhitespace,closeStandalone=strip.closeStandalone&&_isNextWhitespace,inlineStandalone=strip.inlineStandalone&&_isPrevWhitespace&&_isNextWhitespace;strip.right&&omitRight(statements,i,!0),strip.left&&omitLeft(statements,i,!0),inlineStandalone&&(omitRight(statements,i),omitLeft(statements,i)&&current.type==="partial"&&(current.indent=/([ \t]+$)/.exec(statements[i-1].original)?RegExp.$1:"")),openStandalone&&(omitRight((current.program||current.inverse).statements),omitLeft(statements,i)),closeStandalone&&(omitRight(statements,i),omitLeft((current.inverse||current.program).statements))}return statements}function isPrevWhitespace(statements,i,isRoot){i===undefined&&(i=statements.length);var prev=statements[i-1],sibling=statements[i-2];if(!prev)return isRoot;if(prev.type==="content")return(sibling||!isRoot?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(prev.original)}function isNextWhitespace(statements,i,isRoot){i===undefined&&(i=-1);var next=statements[i+1],sibling=statements[i+2];if(!next)return isRoot;if(next.type==="content")return(sibling||!isRoot?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(next.original)}function omitRight(statements,i,multiple){var current=statements[i==null?0:i+1];if(!current||current.type!=="content"||!multiple&&current.rightStripped)return;var original=current.string;current.string=current.string.replace(multiple?/^\s+/:/^[ \t]*\r?\n?/,""),current.rightStripped=current.string!==original}function omitLeft(statements,i,multiple){var current=statements[i==null?statements.length-1:i-1];if(!current||current.type!=="content"||!multiple&&current.leftStripped)return;var original=current.string;return current.string=current.string.replace(multiple?/\s+$/:/[ \t]+$/,""),current.leftStripped=current.string!==original,current.leftStripped}var __exports__={},Exception=__dependency1__;return __exports__.stripFlags=stripFlags,__exports__.prepareBlock=prepareBlock,__exports__.prepareProgram=prepareProgram,__exports__}(__module5__),__module8__=function(__dependency1__,__dependency2__,__dependency3__,__dependency4__){function parse(input){return input.constructor===AST.ProgramNode?input:(parser.yy=yy,parser.parse(input))}var __exports__={},parser=__dependency1__,AST=__dependency2__,Helpers=__dependency3__,extend=__dependency4__.extend;__exports__.parser=parser;var yy={};return extend(yy,Helpers,AST),__exports__.parse=parse,__exports__}(__module9__,__module7__,__module10__,__module3__),__module11__=function(__dependency1__,__dependency2__){function Compiler(){}function precompile(input,options,env){if(input==null||typeof input!="string"&&input.constructor!==env.AST.ProgramNode)throw new Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+input);options=options||{},"data"in options||(options.data=!0),options.compat&&(options.useDepths=!0);var ast=env.parse(input),environment=(new env.Compiler).compile(ast,options);return(new env.JavaScriptCompiler).compile(environment,options)}function compile(input,options,env){function compileInput(){var ast=env.parse(input),environment=(new env.Compiler).compile(ast,options),templateSpec=(new env.JavaScriptCompiler).compile(environment,options,undefined,!0);return env.template(templateSpec)}if(input==null||typeof input!="string"&&input.constructor!==env.AST.ProgramNode)throw new Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+input);options=options||{},"data"in options||(options.data=!0),options.compat&&(options.useDepths=!0);var compiled,ret=function(context,options){return compiled||(compiled=compileInput()),compiled.call(this,context,options)};return ret._setup=function(options){return compiled||(compiled=compileInput()),compiled._setup(options)},ret._child=function(i,data,depths){return compiled||(compiled=compileInput()),compiled._child(i,data,depths)},ret}function argEquals(a,b){if(a===b)return!0;if(isArray(a)&&isArray(b)&&a.length===b.length){for(var i=0;i<a.length;i++)if(!argEquals(a[i],b[i]))return!1;return!0}}var __exports__={},Exception=__dependency1__,isArray=__dependency2__.isArray,slice=[].slice;return __exports__.Compiler=Compiler,Compiler.prototype={compiler:Compiler,equals:function(other){var len=this.opcodes.length;if(other.opcodes.length!==len)return!1;for(var i=0;i<len;i++){var opcode=this.opcodes[i],otherOpcode=other.opcodes[i];if(opcode.opcode!==otherOpcode.opcode||!argEquals(opcode.args,otherOpcode.args))return!1}len=this.children.length;for(i=0;i<len;i++)if(!this.children[i].equals(other.children[i]))return!1;return!0},guid:0,compile:function(program,options){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=options,this.stringParams=options.stringParams,this.trackIds=options.trackIds;var knownHelpers=this.options.knownHelpers;this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0,lookup:!0};if(knownHelpers)for(var name in knownHelpers)this.options.knownHelpers[name]=knownHelpers[name];return this.accept(program)},accept:function(node){return this[node.type](node)},program:function(program){var statements=program.statements;for(var i=0,l=statements.length;i<l;i++)this.accept(statements[i]);return this.isSimple=l===1,this.depths.list=this.depths.list.sort(function(a,b){return a-b}),this},compileProgram:function(program){var result=(new this.compiler).compile(program,this.options),guid=this.guid++,depth;this.usePartial=this.usePartial||result.usePartial,this.children[guid]=result;for(var i=0,l=result.depths.list.length;i<l;i++){depth=result.depths.list[i];if(depth<2)continue;this.addDepth(depth-1)}return guid},block:function(block){var mustache=block.mustache,program=block.program,inverse=block.inverse;program&&(program=this.compileProgram(program)),inverse&&(inverse=this.compileProgram(inverse));var sexpr=mustache.sexpr,type=this.classifySexpr(sexpr);type==="helper"?this.helperSexpr(sexpr,program,inverse):type==="simple"?(this.simpleSexpr(sexpr),this.opcode("pushProgram",program),this.opcode("pushProgram",inverse),this.opcode("emptyHash"),this.opcode("blockValue",sexpr.id.original)):(this.ambiguousSexpr(sexpr,program,inverse),this.opcode("pushProgram",program),this.opcode("pushProgram",inverse),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(hash){var pairs=hash.pairs,i,l;this.opcode("pushHash");for(i=0,l=pairs.length;i<l;i++)this.pushParam(pairs[i][1]);while(i--)this.opcode("assignToHash",pairs[i][0]);this.opcode("popHash")},partial:function(partial){var partialName=partial.partialName;this.usePartial=!0,partial.hash?this.accept(partial.hash):this.opcode("push","undefined"),partial.context?this.accept(partial.context):(this.opcode("getContext",0),this.opcode("pushContext")),this.opcode("invokePartial",partialName.name,partial.indent||""),this.opcode("append")},content:function(content){content.string&&this.opcode("appendContent",content.string)},mustache:function(mustache){this.sexpr(mustache.sexpr),mustache.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousSexpr:function(sexpr,program,inverse){var id=sexpr.id,name=id.parts[0],isBlock=program!=null||inverse!=null;this.opcode("getContext",id.depth),this.opcode("pushProgram",program),this.opcode("pushProgram",inverse),this.ID(id),this.opcode("invokeAmbiguous",name,isBlock)},simpleSexpr:function(sexpr){var id=sexpr.id;id.type==="DATA"?this.DATA(id):id.parts.length?this.ID(id):(this.addDepth(id.depth),this.opcode("getContext",id.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperSexpr:function(sexpr,program,inverse){var params=this.setupFullMustacheParams(sexpr,program,inverse),id=sexpr.id,name=id.parts[0];if(this.options.knownHelpers[name])this.opcode("invokeKnownHelper",params.length,name);else{if(this.options.knownHelpersOnly)throw new Exception("You specified knownHelpersOnly, but used the unknown helper "+name,sexpr);id.falsy=!0,this.ID(id),this.opcode("invokeHelper",params.length,id.original,id.isSimple)}},sexpr:function(sexpr){var type=this.classifySexpr(sexpr);type==="simple"?this.simpleSexpr(sexpr):type==="helper"?this.helperSexpr(sexpr):this.ambiguousSexpr(sexpr)},ID:function(id){this.addDepth(id.depth),this.opcode("getContext",id.depth);var name=id.parts[0];name?this.opcode("lookupOnContext",id.parts,id.falsy,id.isScoped):this.opcode("pushContext")},DATA:function(data){this.options.data=!0,this.opcode("lookupData",data.id.depth,data.id.parts)},STRING:function(string){this.opcode("pushString",string.string)},NUMBER:function(number){this.opcode("pushLiteral",number.number)},BOOLEAN:function(bool){this.opcode("pushLiteral",bool.bool)},comment:function(){},opcode:function(name){this.opcodes.push({opcode:name,args:slice.call(arguments,1)})},addDepth:function(depth){if(depth===0)return;this.depths[depth]||(this.depths[depth]=!0,this.depths.list.push(depth))},classifySexpr:function(sexpr){var isHelper=sexpr.isHelper,isEligible=sexpr.eligibleHelper,options=this.options;if(isEligible&&!isHelper){var name=sexpr.id.parts[0];options.knownHelpers[name]?isHelper=!0:options.knownHelpersOnly&&(isEligible=!1)}return isHelper?"helper":isEligible?"ambiguous":"simple"},pushParams:function(params){for(var i=0,l=params.length;i<l;i++)this.pushParam(params[i])},pushParam:function(val){this.stringParams?(val.depth&&this.addDepth(val.depth),this.opcode("getContext",val.depth||0),this.opcode("pushStringParam",val.stringModeValue,val.type),val.type==="sexpr"&&this.sexpr(val)):(this.trackIds&&this.opcode("pushId",val.type,val.idName||val.stringModeValue),this.accept(val))},setupFullMustacheParams:function(sexpr,program,inverse){var params=sexpr.params;return this.pushParams(params),this.opcode("pushProgram",program),this.opcode("pushProgram",inverse),sexpr.hash?this.hash(sexpr.hash):this.opcode("emptyHash"),params}},__exports__.precompile=precompile,__exports__.compile=compile,__exports__}(__module5__,__module3__),__module12__=function(__dependency1__,__dependency2__){function Literal(value){this.value=value}function JavaScriptCompiler(){}var __exports__,COMPILER_REVISION=__dependency1__.COMPILER_REVISION,REVISION_CHANGES=__dependency1__.REVISION_CHANGES,Exception=__dependency2__;JavaScriptCompiler.prototype={nameLookup:function(parent,name){return JavaScriptCompiler.isValidJavaScriptVariableName(name)?parent+"."+name:parent+"['"+name+"']"},depthedLookup:function(name){return this.aliases.lookup="this.lookup",'lookup(depths, "'+name+'")'},compilerInfo:function(){var revision=COMPILER_REVISION,versions=REVISION_CHANGES[revision];return[revision,versions]},appendToBuffer:function(string){return this.environment.isSimple?"return "+string+";":{appendToBuffer:!0,content:string,toString:function(){return"buffer += "+string+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(environment,options,context,asObject){this.environment=environment,this.options=options,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!asObject,this.name=this.environment.name,this.isChild=!!context,this.context=context||{programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.compileChildren(environment,options),this.useDepths=this.useDepths||environment.depths.list.length||this.options.compat;var opcodes=environment.opcodes,opcode,i,l;for(i=0,l=opcodes.length;i<l;i++)opcode=opcodes[i],this[opcode.opcode].apply(this,opcode.args);this.pushSource("");if(this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new Exception("Compile completed with content left on stack");var fn=this.createFunctionContext(asObject);if(!this.isChild){var ret={compiler:this.compilerInfo(),main:fn},programs=this.context.programs;for(i=0,l=programs.length;i<l;i++)programs[i]&&(ret[i]=programs[i]);return this.environment.usePartial&&(ret.usePartial=!0),this.options.data&&(ret.useData=!0),this.useDepths&&(ret.useDepths=!0),this.options.compat&&(ret.compat=!0),asObject||(ret.compiler=JSON.stringify(ret.compiler),ret=this.objectLiteral(ret)),ret}return fn},preamble:function(){this.lastContext=0,this.source=[]},createFunctionContext:function(asObject){var varDeclarations="",locals=this.stackVars.concat(this.registers.list);locals.length>0&&(varDeclarations+=", "+locals.join(", "));for(var alias in this.aliases)this.aliases.hasOwnProperty(alias)&&(varDeclarations+=", "+alias+"="+this.aliases[alias]);var params=["depth0","helpers","partials","data"];this.useDepths&&params.push("depths");var source=this.mergeSource(varDeclarations);return asObject?(params.push(source),Function.apply(this,params)):"function("+params.join(",")+") {\n  "+source+"}"},mergeSource:function(varDeclarations){var source="",buffer,appendOnly=!this.forceBuffer,appendFirst;for(var i=0,len=this.source.length;i<len;i++){var line=this.source[i];line.appendToBuffer?buffer?buffer=buffer+"\n    + "+line.content:buffer=line.content:(buffer&&(source?source+="buffer += "+buffer+";\n  ":(appendFirst=!0,source=buffer+";\n  "),buffer=undefined),source+=line+"\n  ",this.environment.isSimple||(appendOnly=!1))}if(appendOnly){if(buffer||!source)source+="return "+(buffer||'""')+";\n"}else varDeclarations+=", buffer = "+(appendFirst?"":this.initializeBuffer()),buffer?source+="return buffer + "+buffer+";\n":source+="return buffer;\n";return varDeclarations&&(source="var "+varDeclarations.substring(2)+(appendFirst?"":";\n  ")+source),source},blockValue:function(name){this.aliases.blockHelperMissing="helpers.blockHelperMissing";var params=[this.contextName(0)];this.setupParams(name,0,params);var blockName=this.popStack();params.splice(1,0,blockName),this.push("blockHelperMissing.call("+params.join(", ")+")")},ambiguousBlockValue:function(){this.aliases.blockHelperMissing="helpers.blockHelperMissing";var params=[this.contextName(0)];this.setupParams("",0,params,!0),this.flushInline();var current=this.topStack();params.splice(1,0,current),this.pushSource("if (!"+this.lastHelper+") { "+current+" = blockHelperMissing.call("+params.join(", ")+"); }")},appendContent:function(content){this.pendingContent&&(content=this.pendingContent+content),this.pendingContent=content},append:function(){this.flushInline();var local=this.popStack();this.pushSource("if ("+local+" != null) { "+this.appendToBuffer(local)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(depth){this.lastContext=depth},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(parts,falsy,scoped){var i=0,len=parts.length;!scoped&&this.options.compat&&!this.lastContext?this.push(this.depthedLookup(parts[i++])):this.pushContext();for(;i<len;i++)this.replaceStack(function(current){var lookup=this.nameLookup(current,parts[i],"context");return falsy?" && "+lookup:" != null ? "+lookup+" : "+current})},lookupData:function(depth,parts){depth?this.pushStackLiteral("this.data(data, "+depth+")"):this.pushStackLiteral("data");var len=parts.length;for(var i=0;i<len;i++)this.replaceStack(function(current){return" && "+this.nameLookup(current,parts[i],"data")})},resolvePossibleLambda:function(){this.aliases.lambda="this.lambda",this.push("lambda("+this.popStack()+", "+this.contextName(0)+")")},pushStringParam:function(string,type){this.pushContext(),this.pushString(type),type!=="sexpr"&&(typeof string=="string"?this.pushString(string):this.pushStackLiteral(string))},emptyHash:function(){this.pushStackLiteral("{}"),this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}"))},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var hash=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push("{"+hash.ids.join(",")+"}"),this.stringParams&&(this.push("{"+hash.contexts.join(",")+"}"),this.push("{"+hash.types.join(",")+"}")),this.push("{\n    "+hash.values.join(",\n    ")+"\n  }")},pushString:function(string){this.pushStackLiteral(this.quotedString(string))},push:function(expr){return this.inlineStack.push(expr),expr},pushLiteral:function(value){this.pushStackLiteral(value)},pushProgram:function(guid){guid!=null?this.pushStackLiteral(this.programExpression(guid)):this.pushStackLiteral(null)},invokeHelper:function(paramSize,name,isSimple){this.aliases.helperMissing="helpers.helperMissing";var nonHelper=this.popStack(),helper=this.setupHelper(paramSize,name),lookup=(isSimple?helper.name+" || ":"")+nonHelper+" || helperMissing";this.push("(("+lookup+").call("+helper.callParams+"))")},invokeKnownHelper:function(paramSize,name){var helper=this.setupHelper(paramSize,name);this.push(helper.name+".call("+helper.callParams+")")},invokeAmbiguous:function(name,helperCall){this.aliases.functionType='"function"',this.aliases.helperMissing="helpers.helperMissing",this.useRegister("helper");var nonHelper=this.popStack();this.emptyHash();var helper=this.setupHelper(0,name,helperCall),helperName=this.lastHelper=this.nameLookup("helpers",name,"helper");this.push("((helper = (helper = "+helperName+" || "+nonHelper+") != null ? helper : helperMissing"+(helper.paramsInit?"),("+helper.paramsInit:"")+"),"+"(typeof helper === functionType ? helper.call("+helper.callParams+") : helper))")},invokePartial:function(name,indent){var params=[this.nameLookup("partials",name,"partial"),"'"+indent+"'","'"+name+"'",this.popStack(),this.popStack(),"helpers","partials"];this.options.data?params.push("data"):this.options.compat&&params.push("undefined"),this.options.compat&&params.push("depths"),this.push("this.invokePartial("+params.join(", ")+")")},assignToHash:function(key){var value=this.popStack(),context,type,id;this.trackIds&&(id=this.popStack()),this.stringParams&&(type=this.popStack(),context=this.popStack());var hash=this.hash;context&&hash.contexts.push("'"+key+"': "+context),type&&hash.types.push("'"+key+"': "+type),id&&hash.ids.push("'"+key+"': "+id),hash.values.push("'"+key+"': ("+value+")")},pushId:function(type,name){type==="ID"||type==="DATA"?this.pushString(name):type==="sexpr"?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:JavaScriptCompiler,compileChildren:function(environment,options){var children=environment.children,child,compiler;for(var i=0,l=children.length;i<l;i++){child=children[i],compiler=new this.compiler;var index=this.matchExistingProgram(child);index==null?(this.context.programs.push(""),index=this.context.programs.length,child.index=index,child.name="program"+index,this.context.programs[index]=compiler.compile(child,options,this.context,!this.precompile),this.context.environments[index]=child,this.useDepths=this.useDepths||compiler.useDepths):(child.index=index,child.name="program"+index)}},matchExistingProgram:function(child){for(var i=0,len=this.context.environments.length;i<len;i++){var environment=this.context.environments[i];if(environment&&environment.equals(child))return i}},programExpression:function(guid){var child=this.environment.children[guid],depths=child.depths.list,useDepths=this.useDepths,depth,programParams=[child.index,"data"];return useDepths&&programParams.push("depths"),"this.program("+programParams.join(", ")+")"},useRegister:function(name){this.registers[name]||(this.registers[name]=!0,this.registers.list.push(name))},pushStackLiteral:function(item){return this.push(new Literal(item))},pushSource:function(source){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=undefined),source&&this.source.push(source)},pushStack:function(item){this.flushInline();var stack=this.incrStack();return this.pushSource(stack+" = "+item+";"),this.compileStack.push(stack),stack},replaceStack:function(callback){var prefix="",inline=this.isInline(),stack,createdStack,usedLiteral;if(!this.isInline())throw new Exception("replaceStack on non-inline");var top=this.popStack(!0);if(top instanceof Literal)prefix=stack=top.value,usedLiteral=!0;else{createdStack=!this.stackSlot;var name=createdStack?this.incrStack():this.topStackName();prefix="("+this.push(name)+" = "+top+")",stack=this.topStack()}var item=callback.call(this,stack);usedLiteral||this.popStack(),createdStack&&this.stackSlot--,this.push("("+prefix+item+")")},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var inlineStack=this.inlineStack;if(inlineStack.length){this.inlineStack=[];for(var i=0,len=inlineStack.length;i<len;i++){var entry=inlineStack[i];entry instanceof Literal?this.compileStack.push(entry):this.pushStack(entry)}}},isInline:function(){return this.inlineStack.length},popStack:function(wrapped){var inline=this.isInline(),item=(inline?this.inlineStack:this.compileStack).pop();if(!wrapped&&item instanceof Literal)return item.value;if(!inline){if(!this.stackSlot)throw new Exception("Invalid stack pop");this.stackSlot--}return item},topStack:function(){var stack=this.isInline()?this.inlineStack:this.compileStack,item=stack[stack.length-1];return item instanceof Literal?item.value:item},contextName:function(context){return this.useDepths&&context?"depths["+context+"]":"depth"+context},quotedString:function(str){return'"'+str.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(obj){var pairs=[];for(var key in obj)obj.hasOwnProperty(key)&&pairs.push(this.quotedString(key)+":"+obj[key]);return"{"+pairs.join(",")+"}"},setupHelper:function(paramSize,name,blockHelper){var params=[],paramsInit=this.setupParams(name,paramSize,params,blockHelper),foundHelper=this.nameLookup("helpers",name,"helper");return{params:params,paramsInit:paramsInit,name:foundHelper,callParams:[this.contextName(0)].concat(params).join(", ")}},setupOptions:function(helper,paramSize,params){var options={},contexts=[],types=[],ids=[],param,inverse,program;options.name=this.quotedString(helper),options.hash=this.popStack(),this.trackIds&&(options.hashIds=this.popStack()),this.stringParams&&(options.hashTypes=this.popStack(),options.hashContexts=this.popStack()),inverse=this.popStack(),program=this.popStack();if(program||inverse)program||(program="this.noop"),inverse||(inverse="this.noop"),options.fn=program,options.inverse=inverse;var i=paramSize;while(i--)param=this.popStack(),params[i]=param,this.trackIds&&(ids[i]=this.popStack()),this.stringParams&&(types[i]=this.popStack(),contexts[i]=this.popStack());return this.trackIds&&(options.ids="["+ids.join(",")+"]"),this.stringParams&&(options.types="["+types.join(",")+"]",options.contexts="["+contexts.join(",")+"]"),this.options.data&&(options.data="data"),options},setupParams:function(helperName,paramSize,params,useRegister){var options=this.objectLiteral(this.setupOptions(helperName,paramSize,params));return useRegister?(this.useRegister("options"),params.push("options"),"options="+options):(params.push(options),"")}};var reservedWords="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),compilerWords=JavaScriptCompiler.RESERVED_WORDS={};for(var i=0,l=reservedWords.length;i<l;i++)compilerWords[reservedWords[i]]=!0;return JavaScriptCompiler.isValidJavaScriptVariableName=function(name){return!JavaScriptCompiler.RESERVED_WORDS[name]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(name)},__exports__=JavaScriptCompiler,__exports__}(__module2__,__module5__),__module0__=function(__dependency1__,__dependency2__,__dependency3__,__dependency4__,__dependency5__){var __exports__,Handlebars=__dependency1__,AST=__dependency2__,Parser=__dependency3__.parser,parse=__dependency3__.parse,Compiler=__dependency4__.Compiler,compile=__dependency4__.compile,precompile=__dependency4__.precompile,JavaScriptCompiler=__dependency5__,_create=Handlebars.create,create=function(){var hb=_create();return hb.compile=function(input,options){return compile(input,options,hb)},hb.precompile=function(input,options){return precompile(input,options,hb)},hb.AST=AST,hb.Compiler=Compiler,hb.JavaScriptCompiler=JavaScriptCompiler,hb.Parser=Parser,hb.parse=parse,hb};return Handlebars=create(),Handlebars.create=create,Handlebars["default"]=Handlebars,__exports__=Handlebars,__exports__}(__module1__,__module7__,__module8__,__module11__,__module12__);return __module0__}),define("syracuse-tablet/html/js/helpers/handlebarsHelpers",["require","exports","module"],function(require,exports,module){exports.registerHelpers=function(Handlebars){Handlebars.registerHelper("smCompare",function(lvalue,operator,rvalue,options){var operators,result;if(arguments.length<3)throw new Error("Handlerbars Helper 'compare' needs 2 parameters");options===undefined&&(options=rvalue,rvalue=operator,operator="==="),operators={"==":function(l,r){return l==r},"===":function(l,r){return l===r},"!=":function(l,r){return l!=r},"!==":function(l,r){return l!==r},"<":function(l,r){return l<r},">":function(l,r){return l>r},"<=":function(l,r){return l<=r},">=":function(l,r){return l>=r},"typeof":function(l,r){return typeof l==r}};if(!operators[operator])throw new Error("Handlerbars Helper 'compare' doesn't know the operator "+operator);return result=operators[operator](lvalue,rvalue),result?options.fn(this):options.inverse(this)})}}),function(root,doc,factory){factory(root.jQuery,root,doc)}(this,document,function(jQuery,window,document,undefined){(function($,undefined){$.extend($.support,{orientation:"orientation"in window&&"onorientationchange"in window})})(jQuery),function($){$.event.special.throttledresize={setup:function(){$(this).bind("resize",handler)},teardown:function(){$(this).unbind("resize",handler)}};var throttle=250,handler=function(){curr=(new Date).getTime(),diff=curr-lastCall,diff>=throttle?(lastCall=curr,$(this).trigger("throttledresize")):(heldCall&&clearTimeout(heldCall),heldCall=setTimeout(handler,throttle-diff))},lastCall=0,heldCall,curr,diff}(jQuery),function($,window){function handler(){var orientation=get_orientation();orientation!==last_orientation&&(last_orientation=orientation,win.trigger(event_name))}var win=$(window),event_name="orientationchange",get_orientation,last_orientation,initial_orientation_is_landscape,initial_orientation_is_default,portrait_map={0:!0,180:!0},ww,wh,landscape_threshold;if($.support.orientation){ww=window.innerWidth||win.width(),wh=window.innerHeight||win.height(),landscape_threshold=50,initial_orientation_is_landscape=ww>wh&&ww-wh>landscape_threshold,initial_orientation_is_default=portrait_map[window.orientation];if(initial_orientation_is_landscape&&initial_orientation_is_default||!initial_orientation_is_landscape&&!initial_orientation_is_default)portrait_map={"-90":!0,90:!0}}$.event.special.orientationchange=$.extend({},$.event.special.orientationchange,{setup:function(){if($.support.orientation&&!$.event.special.orientationchange.disabled)return!1;last_orientation=get_orientation(),win.bind("throttledresize",handler)},teardown:function(){if($.support.orientation&&!$.event.special.orientationchange.disabled)return!1;win.unbind("throttledresize",handler)},add:function(handleObj){var old_handler=handleObj.handler;handleObj.handler=function(event){return event.orientation=get_orientation(),old_handler.apply(this,arguments)}}}),$.event.special.orientationchange.orientation=get_orientation=function(){var isPortrait=!0,elem=document.documentElement;return $.support.orientation?isPortrait=portrait_map[window.orientation]:isPortrait=elem&&elem.clientWidth/elem.clientHeight<1.1,isPortrait?"portrait":"landscape"},$.fn[event_name]=function(fn){return fn?this.bind(event_name,fn):this.trigger(event_name)},$.attrFn&&($.attrFn[event_name]=!0)}(jQuery,window)}),define("syracuse-tablet/html/deps/jqm-orientation",function(){}),function(factory){factory(jQuery)}(function($){function encode(s){return config.raw?s:encodeURIComponent(s)}function decode(s){return config.raw?s:decodeURIComponent(s)}function stringifyCookieValue(value){return encode(config.json?JSON.stringify(value):String(value))}function parseCookieValue(s){s.indexOf('"')===0&&(s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return s=decodeURIComponent(s.replace(pluses," ")),config.json?JSON.parse(s):s}catch(e){}}function read(s,converter){var value=config.raw?s:parseCookieValue(s);return $.isFunction(converter)?converter(value):value}var pluses=/\+/g,config=$.cookie=function(key,value,options){if(arguments.length>1&&!$.isFunction(value)){options=$.extend({},config.defaults,options);if(typeof options.expires=="number"){var days=options.expires,t=options.expires=new Date;t.setMilliseconds(t.getMilliseconds()+days*864e5)}return document.cookie=[encode(key),"=",stringifyCookieValue(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("")}var result=key?undefined:{},cookies=document.cookie?document.cookie.split("; "):[],i=0,l=cookies.length;for(;i<l;i++){var parts=cookies[i].split("="),name=decode(parts.shift()),cookie=parts.join("=");if(key===name){result=read(cookie,value);break}!key&&(cookie=read(cookie))!==undefined&&(result[name]=cookie)}return result};config.defaults={},$.removeCookie=function(key,options){return $.cookie(key,"",$.extend({},options,{expires:-1})),!$.cookie(key)}}),define("syracuse-tablet/html/deps/jquery.cookie",function(){}),define("syracuse-tablet/html/js/main",["require","exports","module","syracuse-tablet/html/js/ui/modals/modal","syracuse-tablet/html/js/ui/uiUtils","syracuse-tablet/html/js/helpers/globals","syracuse-tablet/html/js/helpers/jsutils","syracuse-tablet/html/js/init/initStyles","syracuse-tablet/html/js/init/initLocale","syracuse-tablet/html/js/init/initModules","syracuse-tablet/html/js/init/initLogin","syracuse-tablet/html/js/helpers/native/native","syracuse-tablet/html/js/helpers/scroller/scrollerHelpers","syracuse-tablet/html/js/helpers/logger","syracuse-tablet/html/deps/handlebars-latest","syracuse-tablet/html/js/helpers/handlebarsHelpers","syracuse-tablet/html/deps/jqm-orientation","syracuse-tablet/html/deps/jquery.cookie","syracuse-tablet/html/js/helpers/locale","syracuse-tablet/html/js/storage/storage"],function(require,exports,module){function _startup(){log&&log("main startup"),scroller.init();var nativeApp=null;return native.init().then(function(){return nativeApp=native.getModule("nativeApp"),log&&log("_startup nativeApp=",nativeApp!=null),initStyles.init()}).then(function(){return uiutils.waitWheelStart(),initLocale.init()}).then(function(){return initModules.init()}).then(function(){return initLogin.init()}).then(function(userLogedIn){uiutils.waitWheelStop(),log&&log("Main native app: "+(nativeApp!=null)),nativeApp&&nativeApp.notifLoaded(),userLogedIn||_forceLogin(_text("login.authentication"),!1)}).fail(function(e){var diags=jsutils.getPropByPath(jsutils.convertToDiagnoses(e,!1),"$diagnoses"),message=diags&&diags.length>0?diags[0].$message:null;log&&log("Main startup failed: "+(message||e&&JSON.stringify(e))),uiutils.waitWheelStop(),nativeApp&&e!=null&&e.$redirectPage==="login"?nativeApp.notifLoaded():nativeApp&&nativeApp.notifStartFail(""+message||"Startup error");var offlineHint;e&&e.$noConnectionError===!0&&(globals.setOfflineQuiet(!0),offlineHint=!0);if(globals.getApplication())_forceLogin(message,!0,offlineHint).then(function(){e!=null&&e.$redirectPage!=="login"&&(globals.getModal().error(_text("startup.error"),e),log&&log(JSON.stringify(e)))});else{$("#s-m-site-all").empty();var diags=jsutils.convertToDiagnoses(e,!0),st=globals.getStorage();st||(st=require("syracuse-tablet/html/js/storage/storage"),st=st?st.getStorage(!0):null),diags.clearLocalDb=JSON.stringify(diags).indexOf(_text("db.err.version"))>0&&st&&st.clearDatabaseSupported(),diags.clearLocalDb&&(window._sm_clearLocalDb=function(){st.clearDatabase().always(function(ok){alert(ok?"Local database has been deleted\nPlease reload the page":"Database can't be deleted.\nPlease contact the administrator")})}),$("#s-m-site-all").empty().html(Handlebars.compile(_fatalError)(diags))}})}var modal=require("syracuse-tablet/html/js/ui/modals/modal"),uiutils=require("syracuse-tablet/html/js/ui/uiUtils"),globals=require("syracuse-tablet/html/js/helpers/globals"),jsutils=require("syracuse-tablet/html/js/helpers/jsutils"),initStyles=require("syracuse-tablet/html/js/init/initStyles"),initLocale=require("syracuse-tablet/html/js/init/initLocale"),initModules=require("syracuse-tablet/html/js/init/initModules"),initLogin=require("syracuse-tablet/html/js/init/initLogin"),native=require("syracuse-tablet/html/js/helpers/native/native"),scroller=require("syracuse-tablet/html/js/helpers/scroller/scrollerHelpers"),log=require("syracuse-tablet/html/js/helpers/logger").getLogger("main",!1),_fatalError='	<article style="overflow-y:auto;padding:0 20px;font-family:Segoe UI Light,Segoe UI,Segoe WP,Helvetica Neue,sans-serif;font-size: 14px;height:100%;position:fixed;width:100%;z-index:100000;background-color:white;">		<H2 style="margin-top:10px;margin-bottom: 20px;font-size:20px;font-weight:bold">A fatal error occurred during initialization process</H2>		{{#each $diagnoses}}			<section style="border:red solid 1px;margin: 10px;padding: 10px;color: black;background-color: #FBE3E3;">				{{#if $message}}<b>{{{$message}}}</b>{{/if}}				{{#if $stackTrace}}<br><br>{{{$stackTrace}}}{{/if}}			</section>		{{/each}}		{{#if clearLocalDb}}<button onClick="window._sm_clearLocalDb();" >Clear Local DataBase</button>{{/if}}	</article>';window.Handlebars=require("syracuse-tablet/html/deps/handlebars-latest"),require("syracuse-tablet/html/js/helpers/handlebarsHelpers").registerHelpers(window.Handlebars),require("syracuse-tablet/html/deps/jqm-orientation"),require("syracuse-tablet/html/deps/jquery.cookie"),log&&log("main loaded"),window.onerror=function(errorMsg,url,lineNumber,error){globals.application?globals.application.waitWheelStop():uiutils.waitWheelStop();try{modal.error("Javascript error",{where:"window.onerror",exception:error,message:errorMsg+"\n"+(url?"Url : "+jsutils.cleanStack(url)+"\nLineNumber : "+lineNumber:"")})}catch(e){var msg=errorMsg+"\n"+(error?+JSON.stringify(error,null,2):url?"Url : "+url+"\nLineNumber : "+lineNumber:"");alert(msg)}};var _forceLogin=function(message,isError,offlineHint){var deferred=$.Deferred();return globals.getApplication().logout(message,isError,offlineHint).then(function(){deferred.resolve()}).fail(function(e){globals.getModal().error("Int process - logout error",e,function(){deferred.resolve()})}),deferred.promise()},_locale=null,_text=function(id){return _locale||(_locale=require("syracuse-tablet/html/js/helpers/locale")),_locale?_locale.text(id):id};$(document).ready(function(){log&&log("main document ready"),document.location.href.indexOf("?circular")>-1?xrayquire.showCycles(undefined,!0):_startup()})});