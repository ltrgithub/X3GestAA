"use strict";

//module
var parser = require('syracuse-tablet/html/js/sdata/parser').Parser;

// text areas variables
var input = document.getElementById("s-sdata-parse-input");
var output = document.getElementById("s-sdata-parse-output");
var errOutput = document.getElementById("s-sdata-parse-error");

var input2 = document.getElementById("s-sdata-parse-input-2");
var output2 = document.getElementById("s-sdata-parse-output-2");
var errOutput2 = document.getElementById("s-sdata-parse-error-2");

function clear(textarea) {
	textarea.value = "";
}

// clear all except input
function clearAll() {
	// clear text areas 
	clear(output);
	clear(errOutput);
}

exports.main = function() {

	clearAll();

	$("button").bind("click", function(event) {

		// clear text areas
		clearAll();

		// on click on trigger button
		if (event.target.getAttribute("id") == "s-sdata-parse-trigger") {

			// try catch on parse method
			// /!\ parse method works only directly with where parameter value. Error thrown otherwise /!\ 
			var inputVal = input.value;
			if (inputVal) {
				try {
					output.value = JSON.stringify(parser.parse(inputVal), null, 2);
				} catch (e) {

					errOutput.setAttribute("readonly", true);
					errOutput.style.color = "red";
					errOutput.value = e.message;
				}
			}
		} else {
			if (event.target.getAttribute("id") == "s-sdata-parse-trigger-2") {
				alert("coming soon !");
			}
		}

	});
};