"use strict";

var webdriver = require('selenium-webdriver');

var until = webdriver.until;
var By = webdriver.By;

//=============================================================================================
//======================= Run with Serer local Chrome driver                         ==========
// java -jar selenium-server-standalone-2.44.0.jar -Dwebdriver.chrome.driver=.\chromedriver.exe
//==============================================================================================
var expectedTitle = 'Sage X3 Mobile - Debug';

// --- connect to Server Local --------------------------------------------------
var browser = new webdriver.Builder().usingServer('http://localhost:4444/wd/hub').
withCapabilities(webdriver.Capabilities.chrome()).build();

browser.manage().timeouts().implicitlyWait(30);

browser.manage().window().maximize();
// ------ Mobile to test ---------------------------------------------------------------------
browser.get('http://localhost:8124/syracuse-tablet/html/index_debug.html?unitTestMode=true#');


// ====== log in ==============================================================================================
//==================================== It works well with css  IE =============================================
var login_user = browser.wait(until.elementLocated(By.css('input[id="login-user"]')), 10000);
login_user.sendKeys("admin");
var login_password = browser.wait(until.elementLocated(By.css('input[id="login-password"]')), 10000);
login_password.sendKeys("admin");
var login_login = browser.wait(until.elementLocated(By.css('button[id="login-login"]')), 10000);
login_login.click();

//================================== NO NEED with IE/Edge ============================ 
//--------------- first panel confirm by validate Chrome Only ------------------------
//(browser.wait(until.elementLocated(By.css('button[data-action="$validate"][class="btn btn-default s-m-modal-btn-validate"]')), 10000)).click();
//browser.sleep(1500);


//--- ok for Woco
(browser.wait(until.elementLocated(By.xpath('//div[@data-s-ut-elmt-id="vignette-client-test-app"]/section/div/section')), 10000)).click();
browser.sleep(3000);


// ================================= log out =======================================================
console.log('Before logout...., the Back button does not work...');
//-----------------------------
//----- menu quit panel ----------------------------------------------------------------------------


// ----Logout Version for Integration---------------------------------------------------------------
//(browser.wait(until.elementLocated(By.css('a[href="#"][role="button"]')), 10000)).click();
//browser.sleep(500);
//(browser.wait(until.elementLocated(By.css('a.list-group-item > span.fa.fa-user')), 10000)).click();
//browser.sleep(500);
//(browser.wait(until.elementLocated(By.xpath('//button[@type="button"]')), 10000)).click();
//browser.sleep(1500);
//------------------Logout for Woco branch ---------------------------------------------------------
(browser.wait(until.elementLocated(By.css('span.fa.fa-bars')), 10000)).click();
browser.sleep(1000);

//(browser.wait(until.elementLocated(By.css('a.list-group-item > span.fa.fa-user')), 10000)).click();
//browser.sleep(500);

(browser.wait(until.elementLocated(By.xpath('//a[@data-naction="logout"]')), 10000)).click();
browser.sleep(1500);

// --- get title ------------------------------------------------------------------------------------
browser.getTitle().then(function(title) {
	if (expectedTitle === title) {
		console.log("Chrome - Verification Successful - The correct title is displayed on Chrome page.=" + title);
	} else {
		console.log("Verification Failed - An incorrect title is displayed on the web page.");
	}
});
//--- Quit browser --
browser.quit();