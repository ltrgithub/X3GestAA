"use strict";

var webdriver = require('selenium-webdriver');

var until = webdriver.until;
var By = webdriver.By;

//=============================================================================================
//======================= Run with Serer local Chrome driver                         ==========
// java -jar selenium-server-standalone-2.44.0.jar -Dwebdriver.chrome.driver=.\chromedriver.exe
//==============================================================================================
var expectedTitle = 'Sage X3 Mobile - Debug';

// --- connect to Server Local --------------------------------------------------
var browser = new webdriver.Builder().usingServer('http://localhost:4444/wd/hub').
withCapabilities(webdriver.Capabilities.chrome()).build();


browser.manage().timeouts().implicitlyWait(30);

//-- browser.manage().window().maximize();
// ------ Mobile to test ---------------------------------------------------------------------
browser.get('http://localhost:8124/syracuse-tablet/html/index_debug.html?unitTestMode=true#');


// ====== log in ==============================================================================================
//==================================== It works well with css  IE =============================================
var login_user = browser.wait(until.elementLocated(By.css('input[id="login-user"]')), 10000);
login_user.sendKeys("admin");
var login_password = browser.wait(until.elementLocated(By.css('input[id="login-password"]')), 10000);
login_password.sendKeys("admin");
var login_login = browser.wait(until.elementLocated(By.css('button[id="login-login"]')), 10000);
login_login.click();

//================================== NO NEED with IE/Edge ============================ 
//--------------- first panel confirm by validate Chrome Only ------------------------
(browser.wait(until.elementLocated(By.css('button[data-action="$validate"][class="btn btn-default s-m-modal-btn-validate"]')), 10000)).click();
browser.sleep(500);

//----------------------------------- If you have this title ,then remove comments --------------------------------------
//(browser.wait(until.elementLocated(By.css('div[data-s-ut-field-x3name="$welcome_MOBILEMENUGENERAL"]')), 10000)).click();
//browser.sleep(2000);
//(browser.wait(until.elementLocated(By.css('div[data-gadget-id="2de96cd6-5294-4744-8a86-9d6b320c2f7b"]')), 30000)).click();
//browser.sleep(3000);
//--------------------------------------------------------------------------------
//-- Back button doesn t work --------
//---Because of the 'Back' button - Refresh page used
//browser.navigate().refresh(); browser.sleep(500);
//-------------------------------------------------end comment----------------------------------------------------------------------

//--------------------------------------Request Graphical --------------------------------------------
(browser.wait(until.elementLocated(By.css('div[data-s-ut-field-x3name="$welcome_MOBILE_APP_REQUEST"]')), 30000)).click();
(browser.wait(until.elementLocated(By.css('div[data-gadget-id="78a42ea8-1566-4ac6-9497-f9308b021110"]')), 30000)).click();

//-- detail ok 2  --
(browser.wait(until.elementLocated(By.css('div[data-action="chartDetail"]')), 30000)).click();
browser.sleep(1000);

//----------------------------- Back button doesn't work:not visible  : use refresh() ------------------------------------
//(browser.wait(until.elementLocated(By.xpath('//a[@data-params="20d44ff6-9a39-4d0a-8fbc-5a245ff4960b"]/div/div[@class="class="s-m-text"]')), 10000)).click();
//browser.sleep(500);
//(browser.wait(until.elementLocated(By.xpath('//a[@data-action="historyBack"][@href="#"]/i[@class="fa fa-arrow-circle-o-left"]')), 10000)).click();
//(browser.wait(until.elementLocated(By.xpath('//a[@data-action="historyBack"][@href="#"]/i[@class="fa fa-arrow-circle-o-left"]')), 10000)).click();
//---------------------------------------------------------------------------------------------------------
//-------------------- level select -----------------------------------------------------------------------
var detail = browser.wait(until.elementLocated(By.xpath('//tr[@data-s-ut-row-idx="1"][@data-action="rowSelect"]/td[2]/div[@data-s-ut-field-x3name="CODE"]')), 30000);
detail.click();
browser.sleep(2000);
//-----------------------------
//--- it works for Edge !!! :-)
browser.navigate().refresh();
browser.sleep(500);

//------------------------------------------------------design for -----------------------------------
(browser.wait(until.elementLocated(By.css('div[data-s-ut-field-x3name="$welcome_MOBILE_APP_REQUEST"]')), 30000)).click();
//-------------------------------------- Design page for MOBILE_APP_REQUEST --------------------------------------------------
browser.sleep(2000);
(browser.wait(until.elementLocated(By.css('span[class="s-m-nav-text userrole"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//a[@data-params="designPage"]/span[@class="fa fa-paint-brush"]')), 10000)).click();
browser.sleep(800);

//---- root ---
(browser.wait(until.elementLocated(By.xpath('//ul[@id="auth-structure-root-id"]/li/p[contains(text(),"US-Mobile Tablet  request graphical")]')), 10000)).click();
browser.sleep(800);
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="hubgroup-1"]/p[contains(text(),"Test Dashboard query (hubGroup)")]')), 10000)).click();
browser.sleep(800);
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="tile-2"]/p[contains(text(),"X3 query (tile)")]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="ed6f59a3-6442-4bf9-b433-59dc7f85dc21"]/p[contains(text(),"Query graphical")]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="hubgroup-3"]/p[contains(text(),"Statistical query (hubGroup)")]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="hubgroup-3"]/ul/li/p[contains(text(),"Statistical (tile)")]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="6c427cd9-e76b-4787-a383-75805875bad2"]/p[contains(text(),"Mobile statistic request")]')), 10000)).click();
browser.sleep(1000);
//------------------------------------- Close Design page ----------------------------------------
(browser.wait(until.elementLocated(By.xpath('//button[@id="auth-btn-close-id"]')), 10000)).click();

//======================================Second time --========================================================================
//============================================================================================================================
(browser.wait(until.elementLocated(By.xpath('//div[@data-gadget-id="78a42ea8-1566-4ac6-9497-f9308b021110"]')), 10000)).click();
browser.sleep(1000);
//------------------------------------- Design Page -------------------------------------------------------------------------
(browser.wait(until.elementLocated(By.css('span[class="s-m-nav-text userrole"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//a[@data-params="designPage"]/span[@class="fa fa-paint-brush"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//ul[@id="auth-structure-root-id"]/li/p[contains(text(),"Mobile query graphical")]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="hubgroup-1"]/p[contains(text(),"hubGroup")]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="tile-2"]/p[contains(text(),"Request Graph SUPERV (tile)")]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="tile-2"]/ul/li/p[contains(text(),"Request graphical 1")]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//button[@class="btn dropdown-toggle selectpicker btn-default"][@type="button"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//li[@data-original-index="1"]/a/span[contains(text(),"DEFAULT")]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//button[@class="btn dropdown-toggle selectpicker btn-default"][@type="button"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//li[@data-original-index="0"]/a/span[contains(text(),"PERSONAL")]')), 10000)).click();
browser.sleep(500);
//---- button Actions -----------------------
(browser.wait(until.elementLocated(By.xpath('//a[@href="#collapse_auth_prop_actionSettings"]/h4[contains(text(),"Actions")]')), 10000)).click();
browser.sleep(800);
//-- Graph stack verify ----
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="tile-2"]/ul/li/ul/li/p[contains(text(),"Request graph (stack)")]')), 10000)).click();
browser.sleep(500);
//--- $Resources ----------------------------
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="tile-2"]/ul/li[@data-s-ut-auth-elmt-id="27c2ba1e-c103-4fb9-8ceb-f7a6022ea6b0"]/ul/li[@data-s-ut-auth-elmt-id="stack-0"]/ul/li[@data-s-ut-auth-elmt-id="$resources"]/p[@title="$resources"]')), 10000)).click();
browser.sleep(500);
//--- arrayDisplay --------------------------
(browser.wait(until.elementLocated(By.xpath('//div[@id="heading_auth_prop_arrayDisplay"]/a[@href="#collapse_auth_prop_arrayDisplay"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_arrayDisplay_table"]/label[@id="auth_opt_arrayDisplay_table_lab"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_arrayDisplay_card"]/label[@id="auth_opt_arrayDisplay_card_lab"]')), 10000)).click();
browser.sleep(1000);
//--- carousel ------------------------------
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_arrayDisplay_carousel"]/label[@id="auth_opt_arrayDisplay_carousel_lab"]')), 10000)).click();
browser.sleep(1500);
//----- Chart -------------------------------
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_arrayDisplay_chart"]/label[@id="auth_opt_arrayDisplay_chart_lab"][@data-s-m-auth-value="chart"]')), 10000)).click();
browser.sleep(1500);
//----- Options ------------------------------
(browser.wait(until.elementLocated(By.xpath('//div[@id="heading_auth_prop_arrayOptions"]/a[@href="#collapse_auth_prop_arrayOptions"]')), 10000)).click();
browser.sleep(500);
//----- Chart style --------------------------
(browser.wait(until.elementLocated(By.xpath('//div[@id="heading_auth_prop_chartStyle"]/a[@href="#collapse_auth_prop_chartStyle"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="heading_auth_prop_chartOptions"]/a[@href="#collapse_auth_prop_chartOptions"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isTitleHidden"]/label[@data-s-m-auth-value="isTitleHidden"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isTitleHidden"]/label[@data-s-m-auth-value="isTitleHidden"]')), 10000)).click();
browser.sleep(500);
//---- Legend --------------------------------
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isLegendHidden"]/label[@data-s-m-auth-value="isLegendHidden"]')), 10000)).click();
browser.sleep(500);
//--- Cancel ---------------------------------
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isLegendHidden"]/label[@data-s-m-auth-value="isLegendHidden"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isGridLineHidden"]/label[@data-s-m-auth-value="isGridLineHidden"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isGridLineHidden"]/label[@data-s-m-auth-value="isGridLineHidden"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isXLabelHidden"]/label[@data-s-m-auth-value="isXLabelHidden"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isXLabelHidden"]/label[@data-s-m-auth-value="isXLabelHidden"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isXLabelsHidden"]/label[@data-s-m-auth-value="isXLabelsHidden"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isXLabelsHidden"]/label[@data-s-m-auth-value="isXLabelsHidden"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isYLabelHidden"]/label[@data-s-m-auth-value="isYLabelHidden"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isYLabelHidden"]/label[@data-s-m-auth-value="isYLabelHidden"]')), 10000)).click();
browser.sleep(500);


(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isYLabelsHidden"]/label[@data-s-m-auth-value="isYLabelsHidden"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="auth_opt_chartOptions_isYLabelsHidden"]/label[@data-s-m-auth-value="isYLabelsHidden"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="heading_auth_prop_seriesOptions"]/a[@href="#collapse_auth_prop_seriesOptions"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//div[@id="heading_auth_prop_axisLabels"]/a[@href="#collapse_auth_prop_axisLabels"]')), 10000)).click();
browser.sleep(500);
//------ select dropdwn ------
(browser.wait(until.elementLocated(By.xpath('//button[@class="btn dropdown-toggle selectpicker btn-default"][@type="button"]')), 10000)).click();
browser.sleep(500);

(browser.wait(until.elementLocated(By.xpath('//li[@data-original-index="1"]/a/span[@class="text"]')), 10000)).click();
browser.sleep(500);
//-- hub ----------
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="hubgroup-3"]/p[contains(text(),"hubGroup")]')), 10000)).click();
browser.sleep(500);
//--- $resources -----
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="tile-4"]/ul/li[@data-s-ut-auth-elmt-id="6cefa0fc-a0ab-470b-8f0e-9013311ff99a"]/ul/li[@data-s-ut-auth-elmt-id="stack-0"]/ul/li[@data-s-ut-auth-elmt-id="$resources"]/p[@title="$resources"]')), 10000)).click();
browser.sleep(500);

(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="hubgroup-5"]/p[contains(text(),"hubGroup")]')), 10000)).click();
browser.sleep(500);

//-- $resources ------
(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="tile-6"]/ul/li[@data-s-ut-auth-elmt-id="f57251d9-1eed-4c2c-9859-9270c1354434"]/ul/li[@data-s-ut-auth-elmt-id="stack-0"]/ul/li[@data-s-ut-auth-elmt-id="$resources"]/p[@title="$resources"]')), 10000)).click();
browser.sleep(500);

(browser.wait(until.elementLocated(By.xpath('//li[@data-s-ut-auth-elmt-id="tile-7"]/ul/li[@data-s-ut-auth-elmt-id="a17e1ca7-3d62-4e16-b978-186751dd2777"]/ul/li[@data-s-ut-auth-elmt-id="stack-0"]/ul/li[@data-s-ut-auth-elmt-id="$resources"]/p[@title="$resources"]')), 10000)).click();
browser.sleep(500);

(browser.wait(until.elementLocated(By.xpath('//button[@id="auth-btn-close-id"][@type="button"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//button[@data-action="yes"][@type="button"]')), 10000)).click();
browser.sleep(500);

// ================================= log out ====================================================
browser.sleep(500);
console.log('Before logout.the Back button does not work...');
//-----------------------------
//--- it works for Edge !!! :-)
browser.navigate().refresh();
//----- menu quit panel -------------------------------------------------------------------------
(browser.wait(until.elementLocated(By.css('a[href="#"][role="button"]')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.css('a.list-group-item > span.fa.fa-user')), 10000)).click();
browser.sleep(500);
(browser.wait(until.elementLocated(By.xpath('//button[@type="button"]')), 10000)).click();

// --- get title --------------------------------------------------------------------------------
browser.getTitle().then(function(title) {
	if (expectedTitle === title) {
		console.log("Chrome - Verification Successful - The correct title is displayed on Chrome page.=" + title);
	} else {
		console.log("Verification Failed - An incorrect title is displayed on the web page.");
	}
});

//--- browser.quit();