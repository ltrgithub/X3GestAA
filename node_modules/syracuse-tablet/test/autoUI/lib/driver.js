"use strict";

var _webdriver = require('selenium-webdriver');
var _by = _webdriver.By;
var _until = _webdriver.until;

// Can be used to delay closing during test development
var _waitBeforeQuit = 1500;

var _browsers = ["chrome", "MicrosoftEdge"];
var _browserName = process.env["BROWSER_ENV"];

if (!_browserName || _browsers.indexOf(_browserName) < 0) {
	throw new Error("Please set environment variable to one of the desired browsers: " + _browsers.join(","));
}

var _browser;

exports.By = _by;
exports.Until = _until;

exports.Browser = function() {
	if (!_browser) {
		_browser = new _webdriver.Builder().usingServer().withCapabilities({
			'browserName': _browserName
		}).build();
	}
	return _browser;
};

exports.quit = function() {
	if (_browser) {
		var b = _browser;
		_browser = null;
		return b.sleep(_waitBeforeQuit).then(function() {
			return b.quit();
		});
	}
};