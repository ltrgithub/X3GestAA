"use strict";

var UT = require("./../lib/ut");
//=========================================================================================
//============ Test using AQMCRUDM, Create Collection lines from Edit facet================
//========================================================================================= 
describe("AQMCRUDM Collection create", function() {
	UT.defaultBeforeAndAfter({
		testPageUrl: "{$hostPort}/mobile2/x3/erp/GX3APP/AQMDEVICE?representation=AQMCRUDM.$query"
	});

	it("Read detail page row number 7", function() {
		this.timeout(10000);
		return UT.Dom.find(UT.Sel.Row(7), UT.Sel.X3Field("$resources"))
			.then(function($$gridRow) {
				return UT.Dom.click($$gridRow, null, UT.App.waitPage$("AQMCRUDM.$details", 9000));
			})
	});

	it("Get some values of the record", function() {
		var TEXTDES;
		var TDATE;
		//var currentCyle;	     
		return UT.Dom.getValue(UT.Sel.X3Field("TDATE")).then(function(text) {
			TDATE = text;
			UT.log("TDATE: " + text);
			return UT.Dom.getValue(UT.Sel.X3Field("TEXTDES0")).then(function(textdes) {
				UT.log("TEXTDES: " + textdes);
				UT.assertEquals(true, (textdes || "").indexOf("Manhattan modif") > -1, "Word: 'Manhattan modif' not found");
			})
		})

	});

	// ---------------------------------------------------------------------
	//------ Edit mode  ---------------------
	// ---------------------------------------------------------------------
	it("Edit facet", function() {
		var $$$edit = UT.Sel.X3Link("$edit");
		return UT.Dom.waitLocated($$$edit, 800).then(function() {
			return UT.Dom.click($$$edit, null, UT.App.waitPage$("AQMCRUDM.$edit", 2000));
		});
	});


	// ---------------------------------------------------------------------
	//------ Logout with span.fa.fa-bars: Burger  icon ---------------------
	// ---------------------------------------------------------------------
	it("Logout of Edit facet", function() {
		return UT.App.logout();
	});

});