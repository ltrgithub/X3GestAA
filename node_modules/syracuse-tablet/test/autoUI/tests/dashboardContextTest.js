"use strict";

var UT = require("./../lib/ut");


describe("Check dashboard with context", function() {

	// Open browser, login, ensure browser is closed once all tests were executed
	UT.defaultBeforeAndAfter();

	it("Navigate to test page", function() {
		this.timeout(10000);
		return UT.App.navToTestPage("testContextDashboard.$mobileDashboard")
		// Find grid and open vignette in full screen
		.then(function() {
			return UT.Dom.find(UT.Sel.X3Field("$resources"));
		})
			.then(function($$grid) {
				return UT.Dom.click(UT.Sel.Row(4), $$grid, UT.App.waitPage$("testContextDashboardChild.$mobileDashboard"));
			});
	});
	it("Check result", function() {
		return UT.Dom.find(UT.Sel.Row(0), UT.Sel.X3Field("$resources"))
			.then(function($$row) {
				return UT.Dom.find(UT.Sel.X3Field("name"), $$row);
			})
			.then(function($$field) {
				return UT.Dom.getText($$field);
			})
			.then(function(text) {
				UT.assertEquals(text, "Customer 400");
			});
	});
});