"use strict";

var UT = require("../ut");

describe("Check dashboard with context", function() {
	before(function() {
		this.timeout(10000);
		return UT.login();
	});

	describe("Check dashboard with context", function() {

		it("Navigate to test page", function() {
			this.timeout(10000);
			return UT.App.navToTestPage("testContextDashboard.$mobileDashboard")
			// Find grid and open vignette in full screen
			.then(function() {
				return UT.DOM.find(UT.SEL.$$Field("$resources"));
			})
				.then(function(grid) {
					return UT.DOM.click(UT.SEL.$$Row(4), grid, UT.App.waitPage$("testContextDashboardChild.$mobileDashboard"));
				});
		});
		it("Check result", function() {
			return UT.DOM.find(UT.SEL.$$Row(0), UT.SEL.$$Field("$resources"))
				.then(function(row) {
					return UT.DOM.find(UT.SEL.$$Field("name"), row);
				})
				.then(function(field) {
					return UT.DOM.getText(field);
				})
				.then(function(text) {
					UT.assert(text).equals("Customer 400");
				});
		});

	});

	after(function() {
		return UT.Driver.quit();
	});
});