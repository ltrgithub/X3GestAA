"use strict";

var UT = require("./../lib/ut");

// Test using AQMCRUDM authoring Save button ---------------------------------------------------
describe("AQMCRUDM authoring table", function() {
	UT.defaultBeforeAndAfter({
		testPageUrl: "{$hostPort}/mobile2/x3/erp/GX3APP/AQMDEVICE?representation=AQMCRUDM.$query"
	});
	it("Temporisation", function() {
		return UT.App.waitPage("[To improve]", 2000);
	});


	it("Page design open", function() {
		return UT.App.openDesignPage2().then(function() {
			UT.log("==>Page design open. Found.");
		});
	});
	it("Panel left $resources click", function() {
		return UT.App.selectAuthTreeElement("$resources")
			.then(function() {});
	});
	//-- Authoring Save  button using PERSONAL -----------------------------------------------			
	it("Test Authoring Save button", function() {
		//-- Save button "auth-btn-save-id"  --   PERSONAL : personal_copy     global_variant
		return UT.Dom.click(UT.Sel.Id("auth-btn-save-id")).then(function() {
			return UT.Dom.waitLocated(UT.Sel.DataAction2("clickType", "personal_copy"), 3000)
				.then(function() {
					return UT.Dom.click(UT.Sel.DataAction2("clickType", "personal_copy"))
						.then(function() {
							//--- get value --
							return UT.Dom.getValue(UT.Sel.Id("authCode")).then(function(text) {
								UT.log("PERSONAL authCode: " + text);
							}).then(function() {
								//-- end get value -
								return UT.Dom.click(UT.Sel.DataAction2("$validate")).then(function() {
									//no need return UT.App.waitPage("[To improve]", 400);
								})
							});
						});

				})

		});
	});
	//-- id="global_variant"/"factory_variant"  to to  return UT.Dom.click(UT.Sel.DataAction2("clickType", "personal_copy"))
	//id="authCode"
	//id="authTitle"
	//id="authDescription"  it("Get some values of the record", function() {
	var TEXTDES;
	var TDATE;
	//var currentCyle;	     		

	it("Save ok - confirm close modal", function() {
		//--- Saved succes. icon close to quit
		return UT.Dom.waitLocated(UT.Sel.DataAction2("$cancel"), 3000).then(function() {
			return UT.Dom.click(UT.Sel.DataAction2("$cancel")).then(function() {
				//--Close button "auth-btn-close-id"  	        
				return UT.Dom.click(UT.Sel.Id("auth-btn-close-id")).then(function() {
					//- Wait for $query page to become visible again
					return UT.App.waitPage("AQMCRUDM.$query", 1000);
				})
			})
		});
	});

	// ---------------------------------------------------------------------
	//------ Logout with span.fa.fa-bars: BigMac  icon ---------------------
	// ---------------------------------------------------------------------
	it("Logout for authoring", function() {
		return UT.App.logout();
	});

});