"use strict";

var UT = require("./../lib/ut");

describe("Chart detail nav", function() {
	// Open browser, login, ensure browser is closed once all tests were executed
	UT.defaultBeforeAndAfter();

	it("Chart detail nav - Navigate to test page", function() {
		this.timeout(25000);
		return UT.Dom.click(
				UT.Sel.AppTile("MOBILE_APP_REQUEST"),
				null,
				UT.Dom.waitVisible$(UT.Sel.Page("MOBILE_DASHBOARD_REQUESTS.$mobileDashboard"), 5000))
			.then(function() {
				return UT.Dom.waitLocated(UT.Sel.PageTile("QA_TEST_QUERY.$mobileDashboard"), 5000);
			})
			.then(function($$tile) {
				return UT.Dom.click($$tile, null, UT.Dom.waitLocated$(UT.Sel.Page("QA_TEST_QUERY.$mobileDashboard"), 5000));
			});
	});

	it("Chart detail nav - Open chart detail", function() {
		this.timeout(7000);
		// Find vignette with given page
		return UT.Dom.find(UT.Sel.ChildPage("QUERY~QAQTGRAP~99.$query"))
			.then(function($$vignette) {
				// Find chartDetail action inside given vignette
				return UT.Dom.find(UT.Sel.DataAction("chartDetail"), $$vignette);
			})
			.then(function($$chart) {
				// Click chart
				return UT.Dom.click($$chart);
			})
			.then(function() {
				// Wait for the chart detail page toolbar to become visible
				return UT.Dom.waitLocated(UT.Sel.DataAction("toolbar", "arrayOnly"), 5000);
			});
	});
});