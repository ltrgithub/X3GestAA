"use strict";

var UT = require("./../lib/ut");

// Test if navigation from a query to a details facet works using AQMCRUDM
describe(
	"AQMCRUDM query row click test",
	function() {
		UT.defaultBeforeAndAfter({
			testPageUrl: "{$hostPort}/mobile2/x3/erp/GX3APP/AQMDEVICE?representation=AQMCRUDM.$query"
		});

		it("Test detail page navigation row 0", function() {
			this.timeout(10000);
			return UT.Dom.find(UT.Sel.Row(0), UT.Sel.X3Field("$resources"))
				.then(function($$gridRow) {
					return UT.Dom.click($$gridRow, null, UT.App
						.waitPage$("AQMCRUDM.$details", 9000));
				})
		});

		it("Test detail page navigation back button", function() {
			this.timeout(10000);
			return UT.Dom.click(UT.Sel.DataAction("historyBack"))
				.then(function() {
					// Wait for $query page to become visible again
					return UT.App.waitPage("AQMCRUDM.$query");
				});
		});

		it("Test detail page navigation key row 1", function() {
			this.timeout(10000);
			return UT.Dom.find(UT.Sel.Row(1), UT.Sel.X3Field("$resources"))
				.then(function($$gridRow) {
					return UT.Dom.click($$gridRow, null, UT.App
						.waitPage$("AQMCRUDM.$details", 9000));
				})
		});
		//-- Ltr 24/11/2016 ----- if not error on the next script --    
		it("Logout for query row click test", function() {
			this.timeout(12000);
			return UT.App.logout();
		});
	});