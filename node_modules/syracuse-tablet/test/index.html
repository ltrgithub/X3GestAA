<!DOCTYPE html>
<html dir="ltr">
<head>
<title>Syracuse Surface App Tests</title>
<meta content="text/html; charset=UTF-8" http-equiv="content-type">
<link
	href="/syracuse-tablet/html/deps/bootstrap-3.1.1/css/bootstrap.css"
	rel="stylesheet">
<link href="/syracuse-tablet/test/css/hackbootstrap.css"
	rel="stylesheet">
<script src="/syracuse-tablet/html/deps/requirejs/require.js"></script>

<script id="tmpltitle" type="text/x-handlebars-template">
	<span class="teststatus glyphicon glyphicon-ok">&nbsp;</span><span class="badge counts"></span>&nbsp;&nbsp;{{title}}<span class="pull-right"><span class="label label-success">Success</span>&nbsp;<span class="badge success"></span>&nbsp;&nbsp;<span class="label label-danger">Errors</span>&nbsp;<span class="badge error"></span>&nbsp;&nbsp;<span class="label label-warning">Warnings</span>&nbsp;<span class="badge warning"></span></span>
</script>

<script id="tmpltestroot" type="text/x-handlebars-template">
	<div class="panel panel-primary" id="testsets">
		<div class="panel-heading">
			<h4>{{{titleHtml}}}</h4> 
		</div><br>
	</div>
</script>

<script id="tmpltestset" type="text/x-handlebars-template">
		<div class="panel panel-success" id="testSet{{id}}"  style="display:none">
			<div class="panel-heading">
				<a data-toggle="collapse" data-target="#testSetBody{{id}}" >{{{titleHtml}}}</a>		
				<ul class="list-group" style="display:none"></ul>
			</div>
			<div id="testSetBody{{id}}" class="panel-body collapse ">
				<ul class="list-group"  style="display:none"></ul>
			</div>
		</div>
</script>

<script id="tmpltestcase" type="text/x-handlebars-template">
		<li class="list-group-item {{klass}}" id="testCase{{id}}"  style="display:none">
			<div class="panel panel-success">
				<div class="panel-heading">
					<a data-toggle="collapse" data-target="#testCaseBody{{id}}" >{{{titleHtml}}}</a>		
				</div>	
			</div>
			<div id="testCaseBody{{id}}" class="panel-body collapse">
				<ul class="list-group" style="display:none"></ul>
			</div>
		</li>
</script>

<script id="tmplteststatus" type="text/x-handlebars-template">
		<li class="list-group-item  sm-{{status}}" id="{{id}}" >
			<span class="teststatus glyphicon glyphicon-{{icon}}">&nbsp;</span> {{title}}
			{{#if messages}}
				{{#each messages}}
    				<br><i>{{this}}</i>
  				{{/each}} 
  			{{/if}} 
		</li>
</script>

<script id="modals_settings" type="text/x-handlebars-template">
<div class="modal fade">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Unit tests settings</h4>
			</div>
			<div class="modal-body">
				<div class="well">
					<div class="form-group">
						<label>X3 User</label>
						<input type="text" id="login-user" class="form-control" value="{{user}}">
					</div>
					<div class="form-group">
						<label>X3 Password</label>
						<input type="text"  id="login-password" class="form-control" value="{{password}}">
					</div>
					<div class="form-group">
						<label>Dvlp Endpoint</label>
						<input type="text" id="login-endpoint-dvlp" class="form-control" value="{{endpoint}}">
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" data-action="save" class="btn btn-primary">Save changes</button>
				<button type="button" data-action="close" class="btn btn-default" data-dismiss="modal">Cancel</button>
			</div>
		</div>
	</div>
</div>
</script>

<script>
	var _log = function() {
		var text;
		for (var i = 0; i < arguments.length; i++) {
			var a = arguments[i];
			if (a != null) {
				if (Error.prototype.toString === a.toString){
					console.log(a.message, "\n", a.stack);
				}else{
					if (!text) text = ["[index]: "];
					text.push(a);
				}
			}
		}
		console.log(text.join(text, " "));
	};

	require.config({
		'baseUrl' : "/requireJS",
		'paths' : {
			'textPlugin' : '/syracuse-tablet/html/deps/requirejs/text',
			
			'jquery' : '/syracuse-tablet/html/deps/jquery-2.1.1/jquery',
			'jquery-waiting' : '/syracuse-tablet/html/deps/jquery-waiting/waiting',
			
			'bootstrap' : '/syracuse-tablet/html/deps/bootstrap-3.1.1/js/bootstrap',
			'bootstrap-select' : '/syracuse-tablet/html/deps/bootstrap-select/bootstrap-select',
			
			'hammer' : '/syracuse-tablet/html/deps/hammerjs-1.1.3/hammer',
			'handlebars' : '/syracuse-tablet/html/deps/handlebars-latest',

			'nativePrototypes': '/syracuse-tablet/html/js/helpers/nativePrototypes',
			'jqueryPlugins': '/syracuse-tablet/html/js/helpers/jqueryPlugins',
			
			'main': 'syracuse-tablet/test/js/main'
		},
		'shim' : {
			'jquery-waiting': {
				'deps' : [ 'jquery' ]
			},
			'jqueryPlugins': {
				'deps' : [ 'jquery' ]
			},
			'bootstrap' : {
				'deps' : [ 'jquery' ]
			},
			'bootstrap-select': {
				'deps' : [ 'bootstrap' ]
			},
			'hammer' : {
				'deps' : [ 'bootstrap' ]
			},
			'main': { 
				'deps': [
				"jquery", 
				"hammer",
				"bootstrap", 
				"handlebars", 
				"bootstrap-select", 
				"jquery-waiting",
				"nativePrototypes",
				"jqueryPlugins"
				]
			}
		}
	});
	function loadMain(lang, rsrc){
		require.undef("textPlugin");
		require(["main"], 
			function(main) {
				main.main(lang, rsrc);
			}
		);
	}
	function loadRsrc (lang, success, fail) {
		_log && _log("Try to load ", lang, " resource");
		var path = "/syracuse-tablet/html/js/resources/strings-" + lang + ".json";
		require(["textPlugin!" + path], function(rsrc) {
			try {
				_log && _log("Resource ", lang, " loaded");
				success(lang, JSON.parse(rsrc));	
			}catch(e){
				_log && _log("Error parsing ", lang, " resource", e);
				if (fail) fail(lang); else success(lang , null);
			}
		}, function(err){
			_log && _log("Error loading ", err.requireModules[0]);
			if (fail) fail(lang); else success(lang , null);
		});
	};
	loadRsrc ("en"||window.navigator.language, loadMain, function(lang){
		if (lang === "en") loadMain();
		loadRsrc ("en", loadMain);
	});	
</script>
</head>
<body>
	<header id="testsheader">
		<nav class="navbar navbar-inverse" role="navigation">
			<div class="container-fluid">
				<!-- Brand and toggle get grouped for better mobile display -->
				<div class="navbar-header">
					<span class="navbar-brand" href="#">Tablet client unit tests</span>
				</div>
				<ul class="nav navbar-nav navbar-left">
					<li>
						<button type="button" id="testsrun"
							class="btn btn-default navbar-btn dropdown-toggle"
							data-toggle="dropdown">
							RUN <span class="caret"></span>
						</button>
						<ul id="run_dropdown" class="dropdown-menu" role="menu">
							<li><a data-action="run" data-param="all" href="#">All</a></li>
							<li class="divider"></li>
						</ul>
					</li>
					<li><a href="testWidgets.html" role="button"
						style="color: white">Widgets Test</a></li>
				</ul>
				<ul class="nav navbar-nav navbar-right">
					<p class="navbar-text" id="nav-login-info"></p>
					<li><a href="#" data-action="settings"><span
							class="glyphicon glyphicon-cog" /></a></li>
				</ul>
			</div>
		</nav>
	</header>
	<section id="testscontent"></section>
</body>
</html>
