"use strict";

var jsutils = require('syracuse-tablet/html/js/helpers/jsutils');

/*
 * Generator for articles of different page types and scrolling models
 *
 */

exports.genNewArticle = function(opts) {
	if (jsutils.isInstanceOf(opts.page, "DashboardPage")) {
		return exports.generateDashboardArticle(opts.page.prototype, opts.orientation);
	} else {
		return _generateRegularArticle(opts.page.prototype);
	}
};

exports.generateDashboardArticle = function(proto, orientation) {

	var article;
	var props;

	if (orientation === "horizontal") {
		article = {
			"$layoutType": "hub",
			"$items": [{
				"$layoutType": "hubGroup",
				"$title": "",
				"$items": []
			}]
		};

		props = proto.data("$properties");
		Object.keys(props).forEach(function(key) {
			var prop = props[key];
			article.$items[0].$items.push({
				"$layoutType": "tile",
				"$size": "medium",
				"$items": [{
					"$bind": key,
				}]
			});

		});
	} else {
		article = {
			"$layoutType": "stack",
			"$items": []
		};

		props = proto.data("$properties");
		var cellCount = 4;
		var row;
		Object.keys(props).forEach(function(key) {
			if (cellCount === 4) {
				cellCount = 0;
				row = {
					"$layoutType": "row",
					"$rowHeight": "200px",
					"$items": []
				};
				article.$items.push(row);
			}
			var prop = props[key];
			row.$items.push({
				"$layoutType": "cell",
				"$widthXs": 12,
				"$widthSm": 6,
				"$widthMd": 4,
				"$widthLg": 3,
				"$items": [{
					"$bind": key,
				}]
			});
		});
	}
	return $.smResolve(article);
};

function _generateRegularArticle(opts) {

}