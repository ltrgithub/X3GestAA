"use strict";

/*
 * Module to initialize CSS for used OS/Platform
 *
 */
var globals = require('syracuse-tablet/html/js/helpers/globals');
var jsutils = require('syracuse-tablet/html/js/helpers/jsutils');
var mobileDetect = require('syracuse-tablet/html/js/helpers/mobileDetect');

function _loadCss(file) {
	var ref = document.createElement("link");

	ref.setAttribute("rel", "stylesheet");
	ref.setAttribute("type", "text/css");
	ref.setAttribute("href", file);

	document.getElementsByTagName("head")[0].appendChild(ref);
}

function _isSurfaceTablet() {
	navigator.userAgent.toLowerCase().indexOf("tablet pc") > -1 && navigator.userAgent.toLowerCase().indexOf("windows") > -1;
}

exports.init = function() {
	var deferred = new $.Deferred();
	var os = mobileDetect.getStyleOS();
	var styles;
	//	if (_isSurfaceTablet()) {
	//		styles = "surface";
	//	} else {
	styles = os;
	//	}
	var cssPlatform = "./css/gen/" + styles + (jsutils.isReleaseVersion() ? ".min" : "") + ".css";
	_loadCss(cssPlatform);
	var cssGeneral = "./css/default" + (jsutils.isReleaseVersion() ? ".min" : "") + ".css";
	_loadCss(cssGeneral);
	deferred.resolve();
	globals.setLookAndFeel(styles);

	return deferred.promise();
};