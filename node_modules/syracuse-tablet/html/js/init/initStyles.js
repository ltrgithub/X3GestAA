"use strict";

/*
 * Module to initialize CSS for used OS/Platform
 *
 */
var environment = require('syracuse-tablet/html/js/helpers/environment');

/**
 * Load css according to detected platform
 * Returns name of the selected platform
 */
exports.init = function() {

	return $.smResolve()
		.then(function() {
			var os = environment.getStyleOS();
			var styles;
			styles = os;

			var cssPlatform = "./css/gen/" + styles + (_isReleaseVersion() ? ".min" : "") + ".css";
			_loadCss(cssPlatform);
			var cssGeneral = "./css/default" + (_isReleaseVersion() ? ".min" : "") + ".css";
			_loadCss(cssGeneral);

			return styles;
		});
};

function _isReleaseVersion() {
	return document.location.href.indexOf("/index_debug.html") < 0 && document.location.href.indexOf("/index_release.html") < 0;
};

function _loadCss(file) {
	var ref = document.createElement("link");

	ref.setAttribute("rel", "stylesheet");
	ref.setAttribute("type", "text/css");
	ref.setAttribute("href", file);

	document.getElementsByTagName("head")[0].appendChild(ref);
}

function _isSurfaceTablet() {
	navigator.userAgent.toLowerCase().indexOf("tablet pc") > -1 && navigator.userAgent.toLowerCase().indexOf("windows") > -1;
}