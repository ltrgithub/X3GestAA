"use strict";

var utils = require('syracuse-tablet/html/js/helpers/utils');
var Base = require('syracuse-tablet/html/js/pages/drafts/draftMgrBase').Klass;
var storageModule = require('syracuse-tablet/html/js/storage/storage');

/**
 * Base class to manage drafts for regular page needs (create/edit)
 */
var _Klass = utils.defineClass(
	function draftMgrPage(prototype, options) {
		Base.call(this, options);
		this._prototype = prototype;
	}, Base, {

		destroy: function() {
			this._prototype = null;
			Base.prototype.destroy.call(this);
		},

		createWorkingCopy: function(dataset) {
			return this.exec("wrkcpyCreate", dataset);
		},

		readWorkingCopy: function(id) {
			return this.exec("wrkcpyRead", id).then(function(result) {
				if (result && storageModule.StatusCodes.OK && result.$data) {
					return result.$data;
				}
				return null;
			});
		}
	});

exports.create = function(options) {
	return new _Klass(options);
};