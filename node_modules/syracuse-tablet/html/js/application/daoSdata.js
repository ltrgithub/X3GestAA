"use strict";

var utils = require('syracuse-tablet/html/js/helpers/utils');

var _Dao = utils.defineClass(function(data, prototype, parent, options) {
	this.parent = parent;
	this.options = options || {};
	this.data = data || {};
	this.prototype = prototype || {};
	this.$properties = this.prototype.$properties || {};
}, null, {

	destroy: function() {

	},

	value: function(prop, value) {
		if (!prop || prop.length == 0) return null;
		if (value != null) {
			// TODO - eventually check proto rules
			return this.data[prop] = value;
		}
		return this.data[prop] ? this.data[prop] : this.parent ? this.parent.value(prop) : null;
	},

	/* Resolve expression according to current dataset and prototype*/
	parseExpression: function(expression) {
		return utils.parseExpression(expression, this, this.prototype);
	}
});
// for override only
exports.Dao = _Dao;