"use strict";

var utils = require('syracuse-tablet/html/js/helpers/utils');
var fontUtils = require('syracuse-tablet/html/js/ui/fontUtils');
var uiUtils = require('syracuse-tablet/html/js/ui/uiUtils');
var fieldBase = require('syracuse-tablet/html/js/controls/field/ctrlFieldBase');
var Base = fieldBase.Klass;

/**
 * Icon used by arrays
 * Displays an icon according to the value of $icon in prototype
 * prototype properties
 * 		$url to attach a link to the icon
 * 		$action to attach an action/navigation to the icon
 * 			Contains all the parameters for the link (data-action, data-params...)
 */
var _Klass = utils.defineClass(

	function(controller, article, prototype) {
		self = this;
		Base.call(self, controller, article, prototype);
		self.cssType = "s-m-btn";
	}, Base, {

		buildFieldValue: function(parentSlot, buildOptions) {
			var self = this;
			var $$parent = $(Base.prototype.buildFieldValue.call(self, parentSlot, buildOptions));
			$$parent.html(fieldBase.genHtmlCtrlLink(self.prototype, {
				tag: 'button',
				css: 'btn btn-info btn-large'
			}, function(html) {
				var param = self.prototype.data('$icon') || "";
				if (param.length > 0) html.push('<i class="' + fontUtils.ctrlIcon(self.prototype.data('$icon')) + '"></i>');
				param = self.prototype.data('$text') || "";
				if (param.length > 0) html.push(param);
			}));
		}
	});

exports.Klass = _Klass;