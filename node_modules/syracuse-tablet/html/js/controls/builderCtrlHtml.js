"use strict";

var utils = require('syracuse-tablet/html/js/helpers/utils');
var globals = require('syracuse-tablet/html/js/helpers/globals');
var uiUtils = require('syracuse-tablet/html/js/ui/uiUtils');
var Base = require('syracuse-tablet/html/js/controls/builderBase').BuilderBase;
/**
 * BASE builder for CONTROLS
 * 	Just displays the title and value
 * 	If displayOptions.link != null put a link around the value
 */
var _BuilderCtrlHtml = utils.defineClass(
	function(ctrl) {
		var self = this;
		Base.call(self, ctrl);
	}, Base, {

		buildHtml: function(html, controllerDao, buildOptions) {
			var self = this;
			self.buildHtmlBefore(html, controllerDao, buildOptions);
			if (controllerDao) {
				if (!controllerDao.getDisplayValue) throw new Error("BuildHtml - dao is expected for data parameter");
				self.buildHtmlValue(html, controllerDao, buildOptions);
			}
			self.buildHtmlAfter(html, controllerDao, buildOptions);
		},
		buildHtmlValue: function(html, controllerDao, buildOptions) {
			var self = this;
			if (self.ctrl.article.$isTitleHidden !== true) {
				html.push(self.prototype.property(self.article.$bind, "$title") + " = ");
			}
			var v = controllerDao.getDisplayValue(self.article.$bind) || "";
			html.push(v.length === 0 ? "&nbsp" : v);
		},
		buildHtmlBefore: function(html, controllerDao, buildOptions) {
			var self = this;
			if (self.displayOptions.link) {
				html.push('<a href="#" ');
				html.push(uiUtils.getLinkAttrs(self.displayOptions.link));
				html.push('>');
			}
			html.push('<div class="');
			html.push(self.displayOptions.cssDefCtrl.join(' '));
			html.push('" id="');
			html.push(self.id);
			html.push('"');
			html.push(' title="');
			html.push(self.article.$bind);
			html.push('"');
			html.push('>');
		},
		buildHtmlAfter: function(html, controllerDao, buildOptions) {
			var self = this;
			html.push('</div>');
			if (self.displayOptions.link) {
				html.push('</a>');
			}
		}
	});

exports.BuilderCtrlHtml = _BuilderCtrlHtml;