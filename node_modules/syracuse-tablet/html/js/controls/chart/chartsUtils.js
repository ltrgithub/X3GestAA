"use strict";

var _getChartDetailArticle = function(opt, $bind, chartArticle, arrayArticle) {
	opt = opt || {};
	// !! set opts with the right values - used by caller
	opt.display = opt.display || "bothSideToSide";
	opt.style = opt.style || (chartArticle ? chartArticle.$style : "bar");
	if (!chartArticle) {
		chartArticle = {
			"$bind": $bind,
			"$isTitleHidden": true
		};
	} else {
		chartArticle = $.extend({}, true, chartArticle);
	}
	if (!chartArticle.$display) {
		// If no authoring
		chartArticle.$display = "chart";
	}
	if (!arrayArticle) {
		arrayArticle = {
			"$bind": $bind,
			"$isTitleHidden": true,
		};
	} else {
		arrayArticle = $.extend({}, true, arrayArticle);
	}
	if (!arrayArticle.$display) {
		// If no authoring
		arrayArticle.$display = "table";
	}
	var res;
	// $isHidden = false -> keeps the control in page to be able to preserve article
	chartArticle.$isHidden = arrayArticle.$isHidden = false;
	switch (opt.display) {
		case "chartOnly":
			arrayArticle.$isHidden = true;
			res = {
				"$layoutType": "stack",
				"$items": [{
					"$layoutType": "row",
					"$items": [chartArticle, arrayArticle]
				}]
			};
			break;
		case "arrayOnly":
			chartArticle.$isHidden = true;
			res = {
				"$layoutType": "stack",
				"$items": [{
					"$layoutType": "row",
					"$items": [arrayArticle, chartArticle]
				}]
			};
			break;
		case "bothStacked":
			res = {
				"$layoutType": "stack",
				"$items": [{
					"$layoutType": "row",
					"$items": [chartArticle, arrayArticle]
				}]
			};
			break;
		default:
			res = {
				"$layoutType": "stack",
				"$items": [{
					"$layoutType": "row",
					"$items": [{
						"$layoutType": "cell",
						"$widthXs": "12",
						"$widthSm": "6",
						"$widthMd": "6",
						"$widthLg": "6",
						"$bgColor": "transparent",
						"$items": [chartArticle]
					}, {
						"$layoutType": "cell",
						"$widthXs": "12",
						"$widthSm": "6",
						"$widthMd": "6",
						"$widthLg": "6",
						"$bgColor": "transparent",
						"$items": [arrayArticle]
					}]
				}]
			};
			break;
	}
	// Pass the display info to the page - needed to set the tool bar
	chartArticle.$style = opt.style;
	// Pass the display info to the page - needed to set the tool bar
	res.$display = opt.display;
	return res;
};


exports.getChartDetailArticle = _getChartDetailArticle;