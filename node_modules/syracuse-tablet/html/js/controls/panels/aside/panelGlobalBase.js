"use strict";

var Base = require('syracuse-tablet/html/js/controls/panels/aside/panelAside').PanelAside;
var utils = require('syracuse-tablet/html/js/helpers/utils');
var modules = require('syracuse-tablet/html/js/common/modules');

var _availableSlots = ["appl", "share", "tools", "draft", "logout", "unclassified"];
/**
 * 
 * Global panel showing stuff like design page, settings, ...
 */
exports.PanelGlobalBase = utils.defineClass(
	function PanelGlobalBase(controller, type, article, opts) {
		Base.call(this, controller, type, article, opts);
	}, Base, {
		_getItems: function() {
			return this.actionAdapter.getGlobalPanelItems();
		},
		_extendContext: function(ctx) {
			ctx.username = _getUserName();
			ctx.userrole = _getUserRole();
			ctx.header = true;
			return ctx
		},
		_getAvailableSlots: function() {
			return _availableSlots
		},
		_getAdditionnalCss: function() {
			return "";
		}
	});


function _getUserName() {
	var up = modules.get("appController").App.getCurrentUserProfile();
	if (!up) {
		return "";
	}
	var name = up.user.firstName || "";
	name = (name != "" ? name + " " : "") + up.user.lastName;
	return name;
}

function _getUserRole() {
	var up = modules.get("appController").App.getCurrentUserProfile();
	if (!up) {
		return "";
	}
	return up.selectedRole.code;
}