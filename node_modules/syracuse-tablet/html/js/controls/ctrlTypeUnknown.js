"use strict";

var utils = require('syracuse-tablet/html/js/helpers/utils');
var Base = require('syracuse-tablet/html/js/controls/structElmt').Klass;
var uiUtils = require('syracuse-tablet/html/js/ui/uiUtils');

var formatApi = require('syracuse-tablet/html/js/helpers/formatApi');
var locale = require('syracuse-tablet/html/js/helpers/locale');

/**
 * Base class for controls that display exactly one value/property
 */
var _Klass = utils.defineClass(

	function(controller, article, prototype) {
		var self = this;
		self.prototype = prototype;
		var $type = prototype.data('$type');
		self.$type = $type;
		self.$bind = article.$bind;
		Base.call(self, controller, $type, article);
		var $format = prototype.data('$format');
		if ($format)
			self.$format = $format;
		var formatter = formatApi.getFormatter(this);
		if (formatter) {
			this.formatter = formatter;
		}
	}, Base, {

		buildHtml: function(parent, controllerDao, buildOptions) {
			var fieldSlot = uiUtils.createDomElement("div", ["sm-field-slot"], "Unknown type: " + this.$type, {
				"id": this.id,
				"style": "bgcolor: red; border: 1px solid black;"
			});
			parent.appendChild(fieldSlot);
		},
		destroy: function() {
			var self = this;
			self.prototype = null;
			Base.prototype.destroy.call(self);
		}
	}
);

exports.Klass = _Klass;