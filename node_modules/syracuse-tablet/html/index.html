<!DOCTYPE html>
<html dir="ltr">
<head>
<title>Syracuse Tablet App</title>
<meta content="text/html; charset=UTF-8" http-equiv="content-type">
<!-- BOOTSTRAP CSS - CSS -->
<link rel="stylesheet" href="./deps/bootstrap-3.1.1/css/bootstrap.css" />
<link rel="stylesheet" href="./deps/bootstrap-3.1.1/css/bootstrap-theme.css" />
<!-- SAGE - CSS -->
<link rel="stylesheet" href="./css/main.css" />
<link rel="stylesheet" href="./css/images.css" />
<link rel="stylesheet" href="./css/applications.css" />
<!-- LIBS -->
<script src="deps/requirejs/require.js"></script>
<script>
	require.config({
		'baseUrl' : "/requireJS",
		'paths' : {
			"jquery" : "/syracuse-tablet/html/deps/jquery-2.1.1/jquery",
			"hammer" : "/syracuse-tablet/html/deps/hammerjs-1.1.3/hammer",
			"bootstrap" : "/syracuse-tablet/html/deps/bootstrap-3.1.1/js/bootstrap",
			"handlebars" : "/syracuse-tablet/html/deps/handlebars-latest",
			"main" : "/syracuse-tablet/html/js/main",
			"textPlugin" : "/requireJS/syracuse-tablet/html/deps/requirejs/text"
		},
		'shim' : {
			'bootstrap' : {
				'deps' : [ 'jquery' ]
			},
			'hammer' : {
				'deps' : [ 'bootstrap' ]
			}
		}
	});
	function loadMain(lang, rsrc){
		require.undef("textPlugin");
		require(["syracuse-tablet/html/js/main", "jquery", "hammer", "bootstrap", "handlebars" ], function(main) {
			main.main(lang, rsrc);
		});
	}
	function loadRsrc (lang, success, fail) {
		console.log("Try to load " + lang + " resource");
		var path = "/syracuse-tablet/html/js/resources/strings-" + lang + ".json";
		require(["textPlugin!" + path], function(rsrc) {
			try {
				console.log("\tResource " + lang + " loaded");
				success(lang, JSON.parse(rsrc));	
			}catch(e){
				console.log("\tError parsing " + lang + " resource\n\t" + e.message);
				if (fail) fail(lang); else success(lang , null);
			}
		}, function(err){
			console.log("\tError loading " + err.requireModules[0]);
			if (fail) fail(lang); else success(lang , null);
		});
	};
	loadRsrc (window.navigator.language, loadMain, function(lang){
		if (lang === "en") loadMain();
		loadRsrc ("en", loadMain);
	});	
</script>
<!-- TEMPLATES -->
<script id="pageTmpl" type="text/x-handlebars-template">
		<div id="{{uuid}}" class="page {{klass}}" data-appId="{{appId}}">
		<header class="s-m-header"></header>
		<section class="s-m-content"></section>
		<footer class="s-m-footer"></footer>
		</div>
</script>
<script id="headTmpl" type="text/x-handlebars-template">
<div class="modal fade" id="modal-error" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&#215;</button>
            <h4 class="modal-title" id="myModalLabel">{{title}}</h4>
            </div>
            <div class="modal-body">
                <pre>{{body}}</pre>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">{{close}}</button>
        </div>
    </div>
  </div>
</div>
<script id="headTmpl" type="text/x-handlebars-template">
<!-- TESTS -->
<script id="headTmpl" type="text/x-handlebars-template">
		<button href="#" data-nav="home">Home</button>
		<button href="#" data-nav="about">About</button>
		<button href="#" data-nav="settings">Settings</button>
		<button href="#" data-nav=sdata">Sdata</button>
</script>
<script id="contentTmpl" type="text/x-handlebars-template">
		<h1>Welcome to page {{page}}</h1>
</script>
</head>
<body>
	<div class="site" id="site" style="display: none"></div>
</body>
</html>
