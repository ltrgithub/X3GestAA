{
    "$name": "CODA 2 X3",
    "$variants": {
        "CODA2_12": {
            "$before": [
                "{$out} = {$new('RELBANK')}",
                "{$out}.CODE = ''",
                "{$out}.TYPE = 1",
                "{$OPERATION_NUMBER} = 1",
                "{$out}.OPERATION_NUMBER = {$OPERATION_NUMBER}",
                "{$BANK} = {$in}.IBAN.bank",
                "{$out}.BANK = {$BANK}",
                "{$out}.DESK = ''",
                "{$ACCOUNT} = {$in}.IBAN.account",
                "{$out}.ACCOUNT = {$ACCOUNT}",
                "{$out}.AMOUNT = Math.abs({$in}.ANCIEN_SOLDE)",
                "{$CURRENCY} = {$in}.DEVISE",
                "{$out}.CURRENCY = {$CURRENCY}",
                "{$out}.DATE = {$in}.DATE_ANCIEN_SODLE",
                "{$out}.VALUE_DATE = null",
                "{$out}.DIRECTION = ({$in}.SIGNE === 0)?1:-1"
             
            ]
        },
        "CODA2_21": {
            "$before": [
                "{$out} = {$new('RELBANK')}",
                "{$out}.CODE = ''",
                "{$out}.TYPE = 2",
                "{$out}.OPERATION_NUMBER = ++{$OPERATION_NUMBER}",
                "{$out}.BANK = {$BANK}",
                "{$out}.DESK = ''",
                "{$out}.ACCOUNT = {$ACCOUNT}",
                "{$out}.AMOUNT = Math.abs({$in}.MONTANT)",
                "{$out}.CURRENCY = {$CURRENCY}",
                "{$out}.DESCRIPTION = ''",
                "{$out}.DATE = {$in}.DATE_COMPTA", 
                "{$out}.REFERENCE = {$in}.REFERENCE", 
                "{$out}.VALUE_DATE = {$in}.DATE_VALEUR",
                "{$out}.DIRECTION = ({$in}.SIGNE === 0)?1:-1"
            ]
        },
        "CODA2_8": {
            "$before": [
                "{$out} = {$new('RELBANK')}",
                "{$out}.CODE = ''",
                "{$out}.TYPE = 3",
                "{$out}.OPERATION_NUMBER = ++{$OPERATION_NUMBER}",
                "{$out}.BANK = {$BANK}",
                "{$out}.DESK = ''",
                "{$out}.ACCOUNT = {$ACCOUNT}",
                "{$out}.AMOUNT = Math.abs({$in}.NOUVEAU_SOLDE)",
                "{$out}.CURRENCY = {$CURRENCY}",
                "{$out}.DATE = null",
                "{$out}.VALUE_DATE = null",
                "{$out}.DIRECTION = ({$in}.SIGNE === 0)?1:-1"  
            ]
        }
    }
}
