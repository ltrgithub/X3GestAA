{
    "$name": "AFB120 2 X3",
    "$variants": {
        "OPBD": {
            "$before": [
                "{$out} = {$new('RELANK')}",
                "{$out}.CODE = ''",
                "{$out}.TYPE = 1",
                "{$OPERATION_NUMBER} = 1",
                "{$out}.OPERATION_NUMBER = {$OPERATION_NUMBER}",
                "{$out}.BANK = {$in}.Account.bank",
                "{$out}.DESK = {$in}.Account.desk",
                "{$out}.ACCOUNT = {$in}.Account.account",
                "{$out}.AMOUNT = parseFloat({$in}.Amt.$value)",
                "{$out}.CURRENCY = {$in}.Amt.$.Ccy",
                "{$out}.DATE = {$in}.Dt.Dt",
                "{$out}.VALUE_DATE = null",
                "{$out}.DIRECTION = ({$in}.CdtDbtInd ==='CRDT')?1:-1"
              
            ]
        },
        "Ntry": {
            "$before": [
                "{$out} = {$new('RELANK')}",
                "{$out}.CODE = ''",
                "{$out}.TYPE = 2",
                "{$out}.OPERATION_NUMBER = ++{$OPERATION_NUMBER}",
                "{$out}.BANK = {$in}.Account.bank",
                "{$out}.DESK = {$in}.Account.desk",
                "{$out}.ACCOUNT = {$in}.Account.account",
                "{$out}.AMOUNT = parseFloat({$in}.Amt.$value)",
                "{$out}.CURRENCY = {$in}.Amt.$.Ccy",
                "{$out}.DESCRIPTION = ''",
                "{$out}.DATE = {$in}.BookgDt.DtTm", 
                "{$out}.REFERENCE = {$in}.AcctSvcrRef", 
                "{$out}.VALUE_DATE = null",
                "{$out}.DIRECTION = ({$in}.CdtDbtInd ==='CRDT')?1:-1"
            ]
        },
        "CLBD": {
            "$before": [
                "{$out} = {$new('RELANK')}",
                "{$out}.CODE = ''",
                "{$out}.TYPE = 3",
                "{$out}.OPERATION_NUMBER = ++{$OPERATION_NUMBER}",
                "{$out}.BANK = {$in}.Account.bank",
                "{$out}.DESK = {$in}.Account.desk",
                "{$out}.ACCOUNT = {$in}.Account.account",
                "{$out}.AMOUNT = parseFloat({$in}.Amt.$value)",
                "{$out}.CURRENCY = {$in}.Amt.$.Ccy",
                "{$out}.DATE = {$in}.Dt.Dt",
                "{$out}.VALUE_DATE = null",
                "{$out}.DIRECTION = ({$in}.CdtDbtInd ==='CRDT')?1:-1"  
            ]
        }
    }
}
