"use strict";
require('npm-shadow')();

var fs = require('fs');
var fsp = require('path');
var rules = require('./pre-commit-rules');

rules.do_not_change = true;

function doDir(path) {
	var stat = fs.statSync(path);
	if (stat.isDirectory()) {
		fs.readdirSync(path).forEach(function(s) {
			doDir(path + '/' + s);
		});
	} else if (stat.isFile()) {
		// console.log(path)
		rules.processFileSync(path);
	}
}

var path = "node_modules";
if (/^--path=/.test(process.argv[2])) {
	path = process.argv[2].substr(7);
	process.argv.splice(2, 1);
	console.log("Use path "+path);
}
doDir(fsp.normalize(__dirname + "/../../../"+path));
rules.finish(true);