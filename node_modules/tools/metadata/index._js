"use strict";

var config = require('../../../nodelocal').config;

if (!config.metadata) throw new Error("config.metadata missing");

var entities = ["tables", "masks", "windows"];

function run(_) {
	var exporter = require("tools/metadata/exporter").newExporter(config.metadata);
	exporter.clean(_);
	exporter.init(_);

	var entityExporter = require("tools/metadata/export-entity");
	entities.forEach_(_, function(_, name) {
		var entity = require("tools/metadata/" + name).entity;
		entityExporter.run(_, exporter, entity);
	})
}

run(_);