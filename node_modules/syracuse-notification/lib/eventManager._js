"use strict";

var helpers = require('syracuse-core/lib/helpers');
var tracer = require("syracuse-trace/lib/helper").getTracer("notifications");
var globals = require('streamline/lib/globals');
var uuid = require('syracuse-core/lib/helpers').uuid;
var util = require('util');

var Event = helpers.defineClass(function(_, type, data, from, to, severity) {

	this.type = type;
	this.from = from;
	this.to = from;
	this.severity = severity;
	this.data = data;

}, null, {
	toJSON: function() {
		return {
			_uuid: uuid.generate(),
			type: this.type,
			stamp: new Date().now,
			to: this.to,
			from: this.from,
			severity: this.severity,
			data: this.data
		};
	}
});


var EventMessage = helpers.defineClass(function(_, title, message, from, to, severity) {
	Event.call(this, _, "message", {
			thumbnail: null,
			title: title,
			message: message
		},
		from, to, severity);


}, Event, {});


function storeEvent(_, evt) {
	// TODO
}

exports.createMessage = function(_, title, message, to, severity) {
	tracer.info && tracer.info("Create message");
	var evt = new EventMessage(_, title, message, to, severity);
	storeEvent(_, evt);
	return evt;
};