"use strict";
var _site = require('syracuse-ui/lib/site/site');
var _siteLoader = require('msoffice/lib/siteLoader');
var WordPage = require("msoffice/lib/word/html/wordPage").WordPage;
var WordReportPage = require("msoffice/lib/word/html/wordReportPage").WordReportPage;
var WordInterface = require('msoffice/lib/word/html/wordInterface').WordInterface;

exports.main = function(){
    var site = _site.create();
    site.isOfficeSite = true;
    _siteLoader.initialize(site);
    site.drawPage = function(){
        var self = this;
        syra_pageBuilder.types.wordmailmerge = WordPage;
        syra_pageBuilder.types.wordreport = WordReportPage;
        self.body = document.createElement("div");
        self.body.id = "s-site-body";
        var title = document.createElement("div");
        title.className = "s-page-title";
        title.textContent = "Please wait while reading data...";
        self.body.appendChild(title);
        self.layoutSlot.appendChild(self.body);
        self.addDragDrop();
        self.logon(function(){
            self._onAfterLogon();
        });
    };
    site._renderHeader = function(){
    };
    site._onAfterLogon = function(){
        this.wordInterface.onLogin();
        this.layoutSlot.style.display = "";
        this.resizeItem();
    };
    site.wordInterface = new WordInterface();
    site.load();
};
if (require.main == module) 
    exports.main();
