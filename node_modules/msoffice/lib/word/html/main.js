"use strict";
var Site = require('syracuse-ui/lib/site/site').Site;
var _siteLoader = require('msoffice/lib/siteLoader');
var WordPage = require("msoffice/lib/word/html/wordPage").WordPage;
var WordReportPage = require("msoffice/lib/word/html/wordReportPage").WordReportPage;
var WordInterface = require('msoffice/lib/word/html/wordInterface').WordInterface;

exports.main = function(){
    var site = new Site();
    site.isOfficeSite = true;
    _siteLoader.initialize(site);
    site.agents = {
        createMailMergeDS: {
            saveDSWord: function(article, menu, record){
                site.wordInterface.attachResourceUrl(record.serviceUrl);
                site.wordInterface.onLogin();
            }
        }
    };
    site.drawBox = function(){
        var self = this;
        self.widgetsLibrary.pageCategories.wordmailmerge = WordPage;
        self.widgetsLibrary.pageCategories.wordreport = WordReportPage;
        self.body = document.createElement("div");
        self.body.id = "s-site-body";
        var title = document.createElement("div");
        title.className = "s-page-title";
        title.textContent = "Please wait while reading data...";
        self.body.appendChild(title);
        self.layoutSlot.appendChild(self.body);
        self.siteFunctions.addDragDropManager();
        self.logon(function(){
            self._onAfterLogon();
        });
    };
    site._renderHeader = function(){
    };
    site._onAfterLogon = function(){
        this.wordInterface.onLogin();
        this.layoutSlot.style.display = "";
        this.resize();
    };
    site.wordInterface = new WordInterface();
    site.loadBox();
};
if (require.main == module) 
    exports.main();
