"use strict";
var Site = require('syracuse-ui/lib/site/site').Site;
var siteLoader = require('syracuse-ui/lib/office/siteLoader');
var WordPage = require("syracuse-ui/lib/office/word/wordPage").WordPage;
var WordReportPage = require("syracuse-ui/lib/office/word/wordReportPage").WordReportPage;
var WordInterface = require('msoffice/lib/word/wordInterface').WordInterface;

exports.main = function(){
    var site = new Site()
    site.$officeSite = "word";
    siteLoader.initialize(site);
    site.agents = {
        createMailMergeDS: {
            saveDSWord: function(article, menu, record){
                site.wordInterface.attachResourceUrl(record.serviceUrl);
                site.wordInterface.onLogin();
            }
        }
    };
    site.drawBox = function(){
        this.widgetsLibrary.pageCategories.wordmailmerge = WordPage;
        this.widgetsLibrary.pageCategories.wordreport = WordReportPage;
        this.$prototype.$links.$home.$url = "?representation=word.$dashboard";
        Site.prototype.drawBox.apply(this);
    };
    site._onAfterLogon = function(){
        this.history.start();
        try {
            this.wordInterface.onLogin();
        } 
        catch (e) {
        }
        this.layoutSlot.style.display = "";
        this.resize();
    };
    site.wordInterface = new WordInterface();
    site.loadBox();
};
if (require.main == module) 
    exports.main();
