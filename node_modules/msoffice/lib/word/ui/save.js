"use strict";
if (!require('streamline/module')(module)) return;

window.getStack = function() {
	try {
		var stack = [];
		var f = arguments.callee.caller;
		while (f) {
			var fn = f.toString();
			var fname = fn.substring(fn.indexOf('function') + 8, fn.indexOf('(')) || 'anonymous';
			stack.push(fname);
			f = f.caller;
		}
		return stack.join('\n');
	} catch (e) {}
};

window.onerror = function(message, url, line) {
	alert(message + '\nurl=' + url + '\nat line ' + line + '\n' + window.getStack());
	return false;
};

var siteFactory = require('syracuse-ui/lib/office/word/wordSaveSite');
exports.main = function() {
	siteFactory.load({
		$iconPath: "/syracuse-ui/themes/desktop/images-general/",
		$module: "X3 for Office",
		$pageTemplateUrl: "/sdata/syracuse/collaboration/syracuse/pages('{endpoint}.{representation},{target},{pageview}')?role={$role}",
		$userProfileUrl: "/sdata/syracuse/collaboration/syracuse/userProfiles/$template/$workingCopies?representation=userProfile.$edit&role={$role}",
		$syracuseMainPageUrl: "/syracuse-main/html/main.html"
	}, {
		$links: {
			$home: {
				$title: "Home",
				$url: "?representation=wordhome.$dashboard"
			}
		},
		$navigation: {
			$about: {
				"aboutus": {
					"$title": "About us"
				},
				"privacypolicy": {
					"$title": "Privacy Policy"
				},
				$help: {
					$title: "Help",
					$url: "http://www.sage.fr/mge/logiciels-erp/sage-erp-x3-premium-edition",
					$target: "blank"
				},
				$contactus: {
					"$title": "Contact us",
					$url: "http://www.sage.com/contactus",
					$target: "blank"
				}
			}
		},
		$properties: {}
	});
};

if (require.main == module) exports.main();