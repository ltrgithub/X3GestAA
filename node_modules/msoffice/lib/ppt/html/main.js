"use strict";
var Site = require('syracuse-ui/lib/site/site').Site;
var _siteLoader = require('msoffice/lib/siteLoader');
var PptPage = require("msoffice/lib/ppt/html/pptPage").PptPage;
var PptInterface = require('msoffice/lib/ppt/html/pptInterface').PptInterface;

exports.main = function() {
	var site = new Site();
	 site.isOfficeSite = true;
	_siteLoader.initialize(site);
	site.drawBox = function() {
		this.widgetsLibrary.pageCategories.ppt_populate_worksheet = PptPage;
		this.$prototype.$links.$home.$url = "?representation=ppt.$dashboard";
		Site.prototype.drawBox.apply(this);
	};
	site._onAfterLogon = function() {
		this.history.start();
		try {
			this.pptInterface.onLogin();
		} catch (e) {}
		var addinVersion = this.pptInterface.getAddinVersion();
		this.layoutSlot.style.display = "";
		this.resize();
	};
	site._renderHeader = function() {};

	site.pptInterface = new PptInterface();
	site.loadBox();
};

if (require.main == module)
	exports.main();