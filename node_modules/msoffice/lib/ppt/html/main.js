"use strict";
var _site = require('syracuse-ui/lib/site/site');
var _siteLoader = require('msoffice/lib/siteLoader');
var PptPage = require("msoffice/lib/ppt/html/pptPage").PptPage;
var PptInterface = require('msoffice/lib/ppt/html/pptInterface').PptInterface;

exports.main = function(){
    var site = _site.create();
    site.isOfficeSite = true;
    _siteLoader.initialize(site);
    site.drawPage = function(){
        var self = this;
        syra_item.pageCategories.ppt_populate_worksheet = PptPage;
        self.body = document.createElement("div");
        self.body.id = "s-site-body";
        var title = document.createElement("div");
        title.className = "s-page-title";
        title.textContent = "Please wait while reading data...";
        self.body.appendChild(title);
        self.layoutSlot.appendChild(self.body);
        self.addDragDrop();
        self.logon(function(){
            self._onAfterLogon();
        });
    };
    site._onAfterLogon = function(){
        this.pptInterface.onLogin();
        var addinVersion = this.pptInterface.getAddinVersion();
        this.layoutSlot.style.display = "";
        this.resizeItem();
    };
    site._renderHeader = function(){
    };
    
    site.pptInterface = new PptInterface();
    site.load();
};

if (require.main == module) {
    exports.main();
}

