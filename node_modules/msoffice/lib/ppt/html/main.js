"use strict";
var Site = require('syracuse-ui/lib/site/site').Site;
var _siteLoader = require('msoffice/lib/siteLoader');
var PptPage = require("msoffice/lib/ppt/html/pptPage").PptPage;
var PptInterface = require('msoffice/lib/ppt/html/pptInterface').PptInterface;

exports.main = function(){
    var site = new Site();
    site.isOfficeSite = true;
    _siteLoader.initialize(site);
    site.drawBox = function(){
        var self = this;
        self.widgetsLibrary.pageCategories.ppt_populate_worksheet = PptPage;
        self.body = document.createElement("div");
        self.body.id = "s-site-body";
        var title = document.createElement("div");
        title.className = "s-page-title";
        title.textContent = "Please wait while reading data...";
        self.body.appendChild(title);
        self.layoutSlot.appendChild(self.body);
        self.addDragDropManager();
        self.logon(function(){
            self._onAfterLogon();
        });
    };
    site._onAfterLogon = function(){
        this.pptInterface.onLogin();
        var addinVersion = this.pptInterface.getAddinVersion();
        this.layoutSlot.style.display = "";
        this.resizeArticle();
    };
    site._renderHeader = function(){
    };
    
    site.pptInterface = new PptInterface();
    site.loadBox();
};

if (require.main == module) {
    exports.main();
}

