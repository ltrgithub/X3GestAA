"use strict";
var Site = require('syracuse-ui/lib/site/site').Site;
var siteLoader = require('syracuse-ui/lib/office/siteLoader');
var PptPage = require("syracuse-ui/lib/office/word/wordPage").PptPage;
var PptInterface = require('msoffice/lib/word/wordInterface').PptInterface;

exports.main = function(){
    var site = new Site()
    site.$officeSite = "ppt";
    siteLoader.initialize(site);
    site.drawBox = function(){
        this.widgetsLibrary.pageCategories.ppt_populate_worksheet = PptPage;
        this.$prototype.$links.$home.$url = "?representation=ppt.$dashboard";
        Site.prototype.drawBox.apply(this);
    };
    site._onAfterLogon = function(){
        this.history.start();
        try {
            this.pptInterface.onLogin();
        } 
        catch (e) {
        }
        var addinVersion = this.pptInterface.getAddinVersion();
        this.layoutSlot.style.display = "";
        this.resize();
    };
    site._renderHeader = function(){    
    };
    
    site.pptInterface = new PptInterface();
    site.loadBox();
};

if (require.main == module) 
    exports.main();