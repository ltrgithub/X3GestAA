"use strict"

var helpers = require("syracuse-core/lib/helpers");
var httpHelper = require('syracuse-sdata/lib/httpHelper');

var _dispatchMap = {
	"xlsx": function(_, context) {
		var headers = {};
		headers["content-type"] = httpHelper.mediaTypes.xlsx;
		headers["cache-control"] = "no-cache,must-revalidate";
		context.response.writeHead(200, headers);
		var xlsxUrl = context.url + "?representation=" + context.parameters.representation;
		require('msoffice/lib/excel/xlsx').render(_, context.response, xlsxUrl, context.request.url);
		context.response.end();
	}
}

exports.dispatch = function(_, context) {
	_dispatchMap[context.accept[0].type] && _dispatchMap[context.accept[0].type](_, context);
}