"use strict";

var util = require("etna-supervisor/lib/util");

exports.constructor = util.defineClass(function(superv, table, data) {
	this.supervisor = superv;
	this.table = table;
	this.data = data;
}, null, {
	init: function(_) {
		this.columns = this.data.DESCRIPT.split('+').map(function(name) {
			return this.table.column(name);
		}, this);
		return this;
	},
	name: {
		get: function() {
			return this.data.CODIND;
		}
	},
	hasColumn: function(name) {
		return this.columns.some(function(elt) {
			return elt.name === name;
		})
	},
	sqlNames: function(_) {
		return this.columns.map(function(elt) {
			return elt.name + '_0';
		});
	},
	keyExpression: function(_) {
		return this.columns.map(function(elt) {
			return '{' + elt.name + '}';
		}).join('~');
	},
});