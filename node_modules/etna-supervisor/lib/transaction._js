"use strict";
var db = require("etna-engine/lib/runtime/db");

var tracerJs = require("syracuse-trace/lib/helper").getTracer("etna.supervisor");

var beginTransaction = db.instructions.TRBEGIN();
var commitTransaction = db.instructions.COMMIT();
var rollbackTransaction = db.instructions.ROLLBACK();

function Transaction() {}

Transaction.prototype.begin = function(_) {
	beginTransaction(_);
	this.inProgress = true;
};

Transaction.prototype.commit = function(_) {
	this.inProgress && commitTransaction(_);
	this.inProgress = false;
};

Transaction.prototype.rollback = function(_) {
	this.inProgress && rollbackTransaction(_);
	this.inProgress = false;
};


exports.Transaction = Transaction;