"use strict";
var db = require("etna-engine/lib/runtime/db");

var tracerJs = require("syracuse-trace/lib/helper").getTracer("etna.supervisor");

var beginTransaction = db.instructions.TRBEGIN();
var commitTransaction = db.instructions.COMMIT();
var rollbackTransaction = db.instructions.ROLLBACK();

function Transaction() {}

Object.defineProperty(Transaction.prototype, "begin", {
	value: function(_) {
		beginTransaction(_);
		this.inProgress = true;
	},
	enumerable: false
});

Object.defineProperty(Transaction.prototype, "commit", {
	value: function(_) {
		this.inProgress && commitTransaction(_);
		this.inProgress = false;
	},
	enumerable: false
});

Object.defineProperty(Transaction.prototype, "rollback", {
	value: function(_) {
		this.inProgress && rollbackTransaction(_);
		this.inProgress = false;
	},
	enumerable: false
});


exports.Transaction = Transaction;