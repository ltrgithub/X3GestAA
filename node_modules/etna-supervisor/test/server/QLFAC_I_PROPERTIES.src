Call OUVRE_TRACE("QLFAR_PROPERTIES") From LECFIC
Call TESTSUITE()

Call FERME_TRACE From LECFIC

GTRACE = "QLFAR_PROPERTIES_"+GACTX.USER
Call LEC_TRACE From LECFIC
End

$ERROR
Call CHECK_EQUAL(errn, EX) From AXUNIT
EX = 0
Resume


Funprog TESTSUITE()
Call ADD_TESTCASE("TC_BASIC"     , "Basic operations on properties", 5) From AXUNIT
Call ADD_TESTCASE("TC_ISSUE_4857"     , "TC_ISSUE_4857", 1) From AXUNIT

End func AXUNIT.RUN_TESTSUITE("QLFAR_PROPERTIES", "QLFAR_PROPERTIES")


#########################################################################
# TC_BASIC
#########################################################################
Subprog TC_BASIC( )
Local Integer I
Local Instance INS1 Using C_AQCPROC03
INS1 = NewInstance C_AQCPROC03

INS1.C03P01 = "String"

For I=1 to 4
  [L]LINE = Fmet INS1.COL.AADD([V]CST_ALASTPOS)
  INS1.COL([L]LINE).C03P02 = 10+[L]LINE
  Call CHECK_EQUAL(INS1.COL([L]LINE).C03P02,10+[L]LINE)   From AXUNIT
Next I
Call CHECK_EQUAL( INS1.C03P01, "String" ) From AXUNIT
End

#########################################################################
# TC_ISSUE_4857
#########################################################################
Subprog TC_ISSUE_4857( )
Local Integer I
Local Instance INS1 Using C_AQCPROC03
INS1 = NewInstance C_AQCPROC03

INS1.C03P01 = "123456789012345"
Call CHECK_EQUAL( INS1.C03P01, "1234567890" ) From AXUNIT
End



