"use strict";

var config = require('../../../nodelocal').config.etna;
if (!config) throw new Error("etna section missing in nodelocal.js");
var fs = require('streamline-fs');
var superv = require("etna-supervisor/lib/supervisor").create(_, "SUPERV");
var glob = require('streamline/lib/globals');

fs.readdir(config.SUPERV.scriptsRoot, _).forEach_(_, function(_, name) {
	if (/^QLFAC_.*\.src$/.test(name)) {
		name = name.substring(0, name.length - 4);
		console.log("<<<<<<<< " + name);
		var script = superv.loadScript(_, name);
		//console.log(script);
		require("etna-engine/lib/runtime/variables").initStack(superv);
		script.MAIN(_);
		console.log(">>>>>>>> " + name);
		process.exit(0);
	}
});
process.exit(0);