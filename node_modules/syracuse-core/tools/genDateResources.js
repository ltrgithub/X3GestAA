"use strict";
var fs = require('fs');

var srcDir = __dirname + "/../deps/globalization/date";
var dateTimeTokenRegexp = /dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?/g;

function _decorateDatePattern(pattern) {
	return pattern.replace(dateTimeTokenRegexp, function(token) {
		return "{" + token + "}";
	});
}

fs.readdirSync(srcDir).forEach(function(name) {
	if (name.indexOf('.js') < 0) return;
	// copy the keys on top of this, to get Copyright at head of file.
	var resources = {
		Copyright: "Copyright (c) 2006-2007, Coolite Inc. (http://www.coolite.com/). All rights reserved.",
		License: "Licensed under The MIT License. See license.txt and http://www.datejs.com/license/.",
		WebSite: "http://www.datejs.com/ or http://www.coolite.com/datejs/",
		Version: "1.0 Alpha-1",
		"Build Date": "13-Nov-2007"
	};
	eval(fs.readFileSync(srcDir + '/' + name, "utf8"));
	Object.keys(Date.CultureInfo).forEach(function(key) {
		resources[key] = Date.CultureInfo[key];
	});
	//
	//Object.keys(resources.formatPatterns).forEach(function(key) { resources.formatPatterns[key] = _decorateDatePattern(resources.formatPatterns[key]); });
	//
	fs.writeFileSync(__dirname + "/../lib/types/resources/date-" + name + "on", JSON.stringify(resources, null, '\t'), "utf8");
});