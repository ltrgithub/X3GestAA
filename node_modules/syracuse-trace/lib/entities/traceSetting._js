"use strict";

var helper = require("syracuse-trace/lib/helper");

exports.entity = {
	$canCreate: false,
	$canDelete: false,
	//$helpPage: "Administration-reference-Traces-Settings",
	$properties: {
		code: {
			$title: "Code",
			$isDefined: false,
			$isReadOnly: true,
			$type: "string"
		},
		description: {
			$title: "Description",
			$isReadOnly: true,
			$type: "string"
		},
	},
	$titleTemplate: "Traces settings",
	$valueTemplate: "Traces settings",
	$descriptionTemplate: "Traces settings",
	$relations: {
		configs: {
			$title: "Traces configuration",
			$type: "traceConfigs",
			$isChild: true,
			$inv: "traceSettings",
			$capabilities: "sort"
		}
	},
	$services: {
		reset: {
			$method: "GET",
			$title: "Reset",
			$isMethod: true,
			$overridesReply: true,
			$confirm: "This operation will reset configuration elements with factory values",
			$execute: function(_, context, instance) {
				var settings = helper.resetConfigs(_, instance);
				if (settings) context.reply(_, 200, settings.serializeInstance(_));
				else context.reply(_, 404);
			}
		},
	}
};