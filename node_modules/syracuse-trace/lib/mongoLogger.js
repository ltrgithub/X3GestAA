"use strict";
/// !doc
///
/// # Storage area logging  
/// 
var helpers = require('syracuse-core/lib/helpers');
var datetime = require('syracuse-core/lib/types/datetime');
var traceLog = require('syracuse-collaboration/lib/entities/traceLog');
var defLogger = require('syracuse-trace/lib/defLogger').defLogger;

// Internal tracing cannot use generic tracing
var _tracer = console.log;

// Standard callback replace _ callback to be able to use this transport in not streamlined functions
var cb = function(err, result) {
	if (err) throw err;
	return result;
};

exports.mongoLogger = helpers.defineClass(function(name, expiry) {
	this.name = name;
	this.expiry = expiry || 120;
	this.type = "mongodb";
}, defLogger, {
	initialise: function() {},
	preprocess: function(data) {},
	trace: function(data) {
		traceLog.createTraceLog(cb, this.name, data);
		_tracer && _tracer(data.output.substring(0, 80));
	},
	close: function() {},
	toJSON: function() {
		return this.type;
	}
});