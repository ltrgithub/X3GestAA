"use strict";
var helpers = require('syracuse-core/lib/helpers');
var CvgObservable = require('syracuse-x3/lib/convergence/model/CvgObservable').CvgObservable;

var CvgClose = exports.CvgClose = helpers.defineClass(function(aClient, reason, message, appCode, stack) {
	CvgObservable.call(this, aClient);
	this.closeReason = reason;
	this.closeMessage = message;
	this.closeAppCode = appCode;
	var stackStr = new StringWriter();
	if (stack != null) {
		stack.printStackTrace(new PrintWriter(stackStr));
		this.closeStack = stackStr.toString();
	}
	// En dernier
	this.setJsonType('SESSION');
}, CvgObservable, {
	toJSON: function() {
		return {
			reason: this.closeReason,
			message: this.closeMessage,
			stack: this.closeStack,
			appCode: this.closeAppCode,
		};
	},
	toJsonObj: function() {
		return toJSON();
	}
});