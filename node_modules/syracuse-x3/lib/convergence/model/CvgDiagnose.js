"use strict";
var helpers = require('syracuse-core/lib/helpers');
var CvgObservable = require('syracuse-x3/lib/convergence/model/CvgObservable').CvgObservable;

var CvgDiagnose = exports.CvgDiagnose = helpers.defineClass(function(client, severity, appCode, message, details, stackTrace, origin, track) {
	CvgObservable.call(this, client);

	
	this.severity = severity;
	this.appCode = appCode;
	this.message = message;
	this.stackTrace = stackTrace;
	this.origin = origin;
	this.details = details
	// En dernier
	if (track)
		this.setJsonType('DIAGNOSE');
	
}, CvgObservable, {

	toJSON: function() {
		var diag = {
			severity: this.severity || 'ERROR',
			appCode: this.appCode || 'unknow',
			message: this.message || "",
			stackTrace: this.stackTrace || null,
			$origin: this.origin || "NodeJS: Convergence Server",
		}
		if (this.details)
			diag.$details = this.details;
		return diag;
	},

});