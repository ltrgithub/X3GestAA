"use strict";
var helpers = require('syracuse-core').helpers;
var x3helpers = require("syracuse-x3/lib/helpers");
var CvgException = require('syracuse-x3/lib/convergence/model/CvgException').CvgException;
var CvgBlobSvc = require('syracuse-x3/lib/convergence/client/CvgBlobSvc').CvgBlobSvc;
var fs = require('fs');

var CvgPluginBlobSvc = helpers.defineClass(function(client) {
	CvgBlobSvc.call(this);
	this.plugin = client;
}, CvgBlobSvc, {

	doPut: function(_, context, tracker) {
		// create ACK_RESI
		var blobStr = context.request.readAll(_);
		this.plugin.processUpload(_, context, blobStr, tracker);

	},
	doPost: function(_, context, tracker) { // TODO review more generic implem because client and plugin analyse in post the same kind of content;
		var blobStr = context.request.readAll(_);
		this.plugin.processUpload(_, context, blobStr, tracker);
	}

});

exports.create = function(client) {
	return {
		blobSvc: new CvgPluginBlobSvc(client)
	};
}; // Dummy comment to clean up rollout repository #6948