"use strict";
var helpers = require('syracuse-core/lib/helpers');

var counter = 0;

var AdapiObservable = exports.AdapiObservable = helpers.defineClass(function(client) {
	this.client = client;
	this.tracked = false;
	this.jsonType = null;
}, null, {
	compareTo: function(o) {
		return this.getAdapiObservableId().compareTo(o.getAdapiObservableId());
	},
	forceChange: function() {
		if (this.tracked) return;
		if (this.jsonType) {
			this.client && this.client.track(this); // this.client is null on prototype
			this.tracked = true;
		}
	},
	getAdapiObservableId: function() {
		return this.jsonType + ++counter;
	},
	razModification: function() {
		this.tracked = false;
	},
	setJsonType: function(aType) {
		this.jsonType = aType;
		this.forceChange();
	}
});