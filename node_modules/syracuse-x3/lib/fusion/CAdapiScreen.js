"use strict";
var helpers = require('syracuse-core/lib/helpers');
var CAdapiEntity = function() {};

var SCREEN_BUTTONS_NUM_ZERO_BASED = 32; // index base "one" = 33
var SCREEN_ID_BUTTONS = "_BUTTONS";
var SCREEN_ID_LEFTLIST = "_SCRNLEFT";
var SCREEN_ID_TABTITLES = "_TABTITLE";
var SCREEN_LEFTLIST_NUM_ZERO_BASED = 33; // index base "one" =
var SCREEN_TABTITLES_NUM_ZERO_BASED = 34; // index base "one" =
var CAdapiScreen = helpers.defineClass(function(requesterWindow, idxbaseOne, aScreenId, aListOfEntity) {
	TODO_SUPER(requesterWindow.adapiClient, aScreenId, idxbaseOne, EntityType.SCREEN);
	this.adapiRequesterWindow = requesterWindow;
	this.listOfEntity = aListOfEntity !== undefined ? aListOfEntity : new CAdapiListOfDataSrcs(requesterWindow);
	// En dernier
	setJsonType('ENTITY');
}, CAdapiEntity, {
	getAdxId: function() {
		if (this.adapiRequesterWindow == null) {
			return null;
		}
		return new StringBuilder().append(this.adapiRequesterWindow.getAdxId()).append(',').append(this.entityIndexBaseOneInAlphanumFormat).toString();
	},
	getJsonKey: function() {
		return this.getAdapiObservableId().substring(1, 2);
	},
	isScreenButtons: function() {
		return this.entityIndexBaseOne == SCREEN_BUTTONS_NUM_ZERO_BASED + 1;
	},
	isScreenLeftList: function() {
		return this.entityIndexBaseOne == SCREEN_LEFTLIST_NUM_ZERO_BASED + 1;
	},
	isScreenTabbed: function() {
		return this.entityIndexBaseOne < SCREEN_BUTTONS_NUM_ZERO_BASED + 1;
	},
	isScreenTabTitle: function() {
		return this.entityIndexBaseOne == SCREEN_TABTITLES_NUM_ZERO_BASED + 1;
	},
	pushDataSrc: function(aId, aDataSrc) {
		this.listOfEntity.push(aId, aDataSrc);
	},
	toJson: function() {
		var object = new JSONObject();
		// Modif Sreen
		if (hasModifTitle()) {
			object.put('tit', this.title);
			if (this.titleSty != null) {
				object.put('stytit', this.titleSty);
			}
		}
		if (hasModifStyle()) {
			object.put('sty', this.style);
		}
		return object;
	},
	traverseAll: function(aTraverser) {
		return this.listOfEntity.traverseAll(aTraverser);
	},
	traverseChilds: function(aTraverser) {
		return this.listOfEntity.traverseChilds(aTraverser);
	},
	traverseSettable: function(aStructIst, aAdapiSetter) {
		return this.listOfEntity.traverseSettable(aStructIst, aAdapiSetter);
	}
});


CAdapiScreen.screenZeroBaseIdxToWhatScreen = function(aIdx) {
	if (aIdx == CAdapiScreen.SCREEN_LEFTLIST_NUM_ZERO_BASED) {
		return "33|SCREEN_LEFTLIST(34,AH)";
	} else if (aIdx == CAdapiScreen.SCREEN_BUTTONS_NUM_ZERO_BASED) {
		return "32|SCREEN_BUTTONS(33,AG)";
	} else if (aIdx == CAdapiScreen.SCREEN_TABTITLES_NUM_ZERO_BASED) {
		return "34|SCREEN_TABTITLES(35,AI)";
	} else {
		return String.valueOf(aIdx);
	}
}