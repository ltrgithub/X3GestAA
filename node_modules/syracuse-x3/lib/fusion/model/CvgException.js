"use strict";
var helpers = require('syracuse-core/lib/helpers');
var CvgObservable = require('syracuse-x3/lib/fusion/model/CvgObservable').CvgObservable;

var CvgException = exports.CvgException = helpers.defineClass(function(client, e, s, formatException) {
	Error.call(this, s + (e ? " [" + e.message + "]" : ""));
	CvgObservable.call(this, client);
	console.log("!!! Error: " + e.stack);
	this.formatException = formatException;
	this.inner = e;
	this.diagnose = {
		$applicationCode: "ERROR",
		$code: "ApplicationDiagnosis",
		$severity: "ERROR",
		$stack: e && e.stack,
	}
	//this.setJsonType('DIAGNOSE');
}, Error, {
});

CvgException.newFmtException = function(client, e, s) {
	var r = new CvgException(client, e, s);
	r.formatException = true;
	return r;

}