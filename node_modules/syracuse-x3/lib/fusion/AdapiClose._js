"use strict";
var helpers = require('syracuse-core/lib/helpers');
var AdapiObservable = function() {};

var AdapiClose = helpers.defineClass(function(aClient, reason, message, appCode, stack) {
	AdapiObservable.call(this, aClient);
	closeReason = reason;
	closeMessage = message;
	closeAppCode = appCode;
	var stackStr = new StringWriter();
	if (stack != null) {
		stack.printStackTrace(new PrintWriter(stackStr));
		closeStack = stackStr.toString();
	}
	// En dernier
	setTypeJsonNode(ETypeJsonNode.SESSION);
}, AdapiObservable, {
	toJson: function() {
		var close = new JSONObject();
		if (closeReason != null) {
			close.put(JSON_REASON, closeReason);
		}
		if (closeMessage != null) {
			close.put(JSON_MESSAGE, closeMessage);
		}
		if (closeStack != null) {
			close.put(JSON_STACK, closeStack);
		}
		if (closeAppCode != null) {
			close.put(JSON_APPCODE, closeAppCode);
		}

		return close;
	},
	toJsonObj: function() {
		return toJson();
	}
});