"use strict";
var helpers = require('syracuse-core/lib/helpers');
var CAdapiLeftList = function() {};

var CAdapiLeftListHierarchic = helpers.defineClass(function(aStackedWindow, aAdapiScreen, aEntityIndexBaseOne, aId, aListFormat, aNbColumns, aNbKeyParts) {
	TODO_SUPER(aStackedWindow, aAdapiScreen, aEntityIndexBaseOne, aId, aListFormat, aNbColumns);
	this.nbKeyParts = aNbKeyParts;
	this.workingVal = null;
}, CAdapiLeftList, {
	appendLeftListLine: function(aIdx, aBranche, aTxt, aVal, aClf, aClp) {

		var wIsBanch = aBranche == 1;
		var wIdxResuToSetInWorkingVal = aClf.size() - 1;
		this.setTextInWorkingVal(aTxt, wIdxResuToSetInWorkingVal);
		var wLeftListLine = null;
		if (!wIsBanch) {
			wLeftListLine = getEntrySup().clone();
			wLeftListLine.setColumns(aIdx - 1, this.workingVal, aClf);
			wLeftListLine.forceServerValueModification(true);
			appendLeftListLine(wLeftListLine);
		}
		return wLeftListLine;
	},
	getNbKeyParts: function() {
		return this.nbKeyParts;
	},
	initWorkingVal: function() {
		this.workingVal = new CNodeArgTblResu(getTracer(), getEntrySup().getNbVar());
	},
	setServerSelectLine: function(selected, aCle) {
		if (this.isListFormat(FMT_PICKING_HIERARCHIC)) {
			var wSelectedIdx = this.findLineIdx(aCle);
			var wFound = wSelectedIdx > -1;
			if (wFound) {
				getLine(wSelectedIdx).setLeftListLineSelected(selected, true);
			}
			return wFound;
		} else {
			return TODO_SUPER.setServerSelectLine(selected, aCle);
		}
	},
	setTextInWorkingVal: function(aTxt, aIdxResuToSetInWorkingVal) {
		if (this.workingVal == null) {
			this.initWorkingVal();
		}
		this.workingVal.setResu(aIdxResuToSetInWorkingVal, CStructResu.X3TYP_STRU, aTxt);

	}
});