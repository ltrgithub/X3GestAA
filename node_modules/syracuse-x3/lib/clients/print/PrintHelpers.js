"use strict";

var _sep = "|";

exports.getDevmodeFromSrvProperties = function(svrProperties) {
	var devmode = {}, arr;

	function shiftNumProp(name) {
		var value, nullVal = -1;
		value = arr.shift();
		if (value) {
			value = parseInt(value, 10);
			devmode[name] = value != isNaN ? value : nullVal;
		}
	}
	if (svrProperties._PrinterDescriptionEx) {
		arr = svrProperties._PrinterDescriptionEx.split(_sep);
		shiftNumProp("duplex");
		shiftNumProp("paperSource");
		shiftNumProp("paperSize");
	}
	return devmode;
};

exports.setDevmodeInSrvProperties = function(devmode, srvProperties) {
	var arr = [],
		nullVal = "";
	arr.push(devmode.duplex ? devmode.duplex.toString() : nullVal);
	arr.push(devmode.paperSource && devmode.paperSource.id ? devmode.paperSource.id.toString() : nullVal);
	if (devmode.paperSize) {
		arr.push(devmode.paperSize.id ? devmode.paperSize.id.toString() : nullVal);
		arr.push(devmode.paperSize.height ? devmode.paperSize.height.toString() : nullVal);
		arr.push(devmode.paperSize.width ? devmode.paperSize.width.toString() : nullVal);
	} else {
		arr.push(nullVal, nullVal, nullVal);
	}
	srvProperties._PrinterDescriptionEx = arr.join(_sep) + _sep;
};