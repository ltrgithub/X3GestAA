"use strict";
var module = QUnit.module;
var assert = require("assert");
var config = require('syracuse-main/lib/nodeconfig').config; // must be first syracuse require
var dataModel = require("syracuse-orm/lib/dataModel");
var x3Helper = require("syracuse-x3/test/fixtures/x3Helper");
var helpers = require("syracuse-core/lib/helpers");

var tracer; // = console.log;
var doStop = false;

module(config.unit_test.x3endpoint.folder + ".x3SeqNum", {
	setup: function() {},
	teardown: function() {
		if (doStop) {
			setTimeout(function() {
				process.kill(process.pid);
			}, 100);
		}
	}
});

if (!config.unit_test || !config.unit_test.x3endpoint || !config.unit_test.run || !config.unit_test.run.x3SeqNum) {
	return test('X3 SEQNUM UNIT TESTS DISABLED FOR NOW', 1, function() {
		ok(true, "work in progress");
	});
}

asyncTest("start", function(_) {
	ok(x3Helper.initDatabase(_), "syracuse mongodb database initialized");
	x3Helper.initialize(_);
	ok(x3Helper.createObjects(_), "createObjects");
	start();
});


asyncTest("QLFAC_SEQNUM", function(_) {
	x3Helper.runTestCase(_, "ASYRQLF", "TC_QLF");
	start();
});

//******************************************************************************

asyncTest("stop server", 0, function(_) {
	x3Helper.stopServer();
	start();
});

asyncTest("stop  tests", 0, function(_) {
	doStop = true;
	start();
});
// JavaScript Document