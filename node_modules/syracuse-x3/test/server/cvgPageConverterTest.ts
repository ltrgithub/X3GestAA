"use strict";

var converter = require("@sage/syracuse-lib/src/collaboration/entities/page/classicPageConverter");
var fs = require("streamline-fs");
var fsp = require("path");
var sys = require("util");

var tracer; // = console.log;

import { assert } from 'chai';
Object.keys(assert).forEach(key => {
	if (key !== 'isNaN') global[key] = assert[key];
});

describe(module.id, () => {

	it('makePersistent Tests', function(_) {
		var protos = JSON.parse(fs.readFile(fsp.join(__dirname, "../fixtures/cvgPageConverterPrototypes.json"), "utf8", _));
		var otsv = protos["OTSV.$fusion"];
		//
		converter.makePersistent(otsv);
		tracer && tracer("OTSV proto: " + sys.inspect(otsv, null, 4));
		tracer && tracer("OTSV article: " + JSON.stringify(otsv.$article, null, "\t"));
		strictEqual(otsv.$article.$layout.$items[0].$layout.$items[0].$items[0].$layout.$items[0].$items[1].$bind, "TSV1_LEG", "Got TSV1_LEG ok");
	});
});