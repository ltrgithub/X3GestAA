"use strict";
var module = QUnit.module;
var helpers = require("syracuse-core/lib/helpers");
var create = require("syracuse-core/lib/resource/resourceProxy").create;
var validate = require("syracuse-ui/lib/resourceValidator").validate;

var employeesData = require("../fixtures/employeeData").data;
var employeeProto = require("../fixtures/employeeProto").data;
var employeesDelta = require("../fixtures/employeeDelta").data;

test("validation of a resource proxy", function() {
	var delta = employeesDelta.$resources[0];
	var delta2 = helpers.object.clone(delta, true);
	var emp1 = create(delta, employeeProto);
	var emp2 = create(delta2, employeeProto);
	var results = validate(emp1);
	equal(results.length, 1, "shoud find the date error, should see how to deserialize that");
	emp1.firstName = "aazeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee";
	results = validate(emp1);
	equal(results.length, 2, "should find maxLength error");
	results = validate(emp2);
	equal(results.length, 1, "new error on obj should not impact other object of same proto");
});

//tester si des rules sont dans l'objet et d'autres dans le proto