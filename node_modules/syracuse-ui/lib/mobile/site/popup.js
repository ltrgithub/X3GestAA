"use strict";
var helpers = require('syracuse-core/lib/helpers');
var _defaultDirection = "up";
var _defaultSpeed= 200;

/**
 * article = {  direction 
	speed = speed || _defaultSpeed;
	$$popup,$$opener,close,speed, direction
 * 
 */
//this.direction = options.direction || _defaultDirection;
	//this.speed = options.speed ||_defaultSpeed;
exports.Popup = function($$popup, position, closeHandler, boundarySelector){
	var self = this;
	var id = $$popup.attr("id") || document.controller.generateUUID();
	var _boundarySelector = "#" + id + ((boundarySelector) ? ("," + boundarySelector) : "");
	
	$(document).bind("click." + id, function(event){
		var $$btn = $(event.target);
		if ($$popup.is(":visible")) {
			if ($$btn.closest(_boundarySelector).length == 0) {
				self.close();
			}
		}
		return true;
	});
	
	self.toggle = function(show){
		if (show === undefined ? !$$popup.is(":visible") : show) {
			$$popup.show().position(helpers.object.clone(position));
		}
		else {
			$$popup.hide();
		}
	};
	self.close = function(){
		if (closeHandler ? closeHandler() : true) {
			self.toggle(false);
			self.dispose();
		}
	};
	self.dispose = function(){
		$(document).unbind("click." + id);
	};
}