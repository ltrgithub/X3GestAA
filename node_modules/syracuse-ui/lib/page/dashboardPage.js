"use strict";
var helpers = require('syracuse-core/lib/helpers');
var DesktopPage = require('./desktopPage').DesktopPage;

function DashboardPage(){
}

exports.DashboardPage = helpers.defineClass(DashboardPage, DesktopPage, {
    saveGarbageLinks: function($article){
        $article.$garbageLinks = Object.keys(this.garbageLinks);
    },
    loadVignetteMenu: function(vignette, $vignette){
        var $field = this.$prototype.$properties[$vignette];
        if ($field) {
            vignette.$item.$vignette = $vignette;
            vignette.setTitle(vignette.$item.$title = $field.$title);
            if ($field.$links) {
                var $binds = Object.keys($field.$links);
                for (var ii = 0, jj = $binds.length; ii < jj; ii++) {
                    vignette.addMenuItem({
                        $bind: $binds[ii]
                    });
                }
            }
        }
    },
    _addMenuToMenusBag: function($bind, $menu){
        if (!this.garbageLinks[$bind]) {
            DesktopPage.prototype._addMenuToMenusBag.call(this, $bind, $menu);
        }
    },
    loadBox: function(initData){
        this.garbageLinks = {};
        if (this.$item.$garbageLinks) {
            for (var ii = 0, jj = this.$item.$garbageLinks.length; ii < jj; ii++) {
                this.garbageLinks[this.$item.$garbageLinks[ii]] = 1;
            }
        }
        this.isDashBoard = true;
        this.ensurePageLocalize();
        this.$skin = this.$item.$skin || "s-dash";
        this.$defaultSkinBlock = "s-dash-h2";
        this.$defaultSkinSection = "s-dash-h1";
        this._defaultTitle = this.pageLocalize.p_dashboardTitle;
        this.$isSearchFacetEnabled = false;
        this.$autoFetch = false;
        DesktopPage.prototype.loadBox.call(this, initData);
    }
});
