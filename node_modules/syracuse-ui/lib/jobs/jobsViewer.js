"use strict";
var helpers = require('syracuse-core/lib/helpers');
var locale = require('syracuse-core/lib/locale');

function JobsViewer(){
}

exports.JobsViewer = helpers.defineClass(JobsViewer, null, {
    create: function(){
        var self = this;
        
        // $$item
        self._item = document.createElement("div");
        self._item.className = "s-jobs-viewer";
        self.$$item = $(self._item);
        
        // switcher anchor (show/hide) content
        var switcher = document.createElement("a");
        switcher.className = "s-jobs-viewer-switch";
        self._item.appendChild(switcher);
        
        // $$core
        self._core = document.createElement("div");
        self._core.className = "s-jobs-viewer-core";
        self.$$item.append(self.$$core = $(self._core));
        
        // append to site
        document.site.body.appendChild(self._item);
        
        document.site.jobsViewer = self;
        
        this._bindEvents(true);
    },
    appendJobView: function(jobView){
        var self = this;
        
        // store jobs. can be useful later
        self.jobs = self.jobs || [];
        self.jobs.push(jobView);
        
        self._core.appendChild(jobView.$$body[0]);
        self._core.style.display = '';
    },
    _bindEvents: function(bind){
        if (self.$$item) {
            if (bind) {
                self.$$item.delegate("a.s-jobs-viewer-switch", "click", function(){
                    self._core.style.display = self.$$core.is(":visible") ? "none" : "";
                })
            }
            else {
                self.$$item.undelegate();
            }
        }
    },
    _toggleViewerCore: function(){
        //TODO : animation
    },
    dispose: function(){
        this._bindEvents(false);
    }
});
