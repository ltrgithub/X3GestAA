"use strict";

function _clearEmptySection(section) {
	if (section && section.page != section) {
		var boxParent = section.boxParent;
		var layoutParent = section.layoutParent;
		layoutParent && layoutParent.removeItem(section, true);
		if (boxParent) {
			if (!(boxParent.boxChildItems && boxParent.boxChildItems.length > 0) && !(boxParent.childrenSection && boxParent.childrenSection.length > 0)) {
				_clearEmptySection(boxParent);
			}
		}
	}
}


exports.clearUnknowFields = function(page) {
	if (page.noProtoFields) {
		for (var ii = 0, jj = page.noProtoFields.length; ii < jj; ii++) {
			var field = page.noProtoFields[ii];
			var boxParent = field.boxParent;
			if (field.layoutParent) {
				field.layoutParent.removeItem(field, true);
			}
			if (boxParent) {
				if (!(boxParent.boxChildItems && boxParent.boxChildItems.length > 0) && !(boxParent.childrenSection && boxParent.childrenSection.length > 0)) {
					_clearEmptySection(boxParent);
				}
			}
		}
		delete page.noProtoFields;
	}
};