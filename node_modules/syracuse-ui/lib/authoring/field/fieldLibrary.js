"use strict";

var TabularChartAuthoring = require("./chart/tabularChartAuthoring").TabularChartAuthoring;
var _vignettesClasses = {
    "$html": require('./vignette/htmlVignetteAuthoring').HtmlVignetteAuthoring
};
var _classes = {
    "application/x-choice": require('./choice/choiceFieldAuthoring').ChoiceFieldAuthoring,
    "image": require('./binary/imageFieldAuthoring').ImageFieldAuthoring,
    "application/x-array": require("./array/authoringOpener").WidgetAuthoring
};

exports.getAuthoringFieldWidget = function(field){
    var widgetClass;
    switch (field.$authoringType || "") {
        case "cube$highCharts":
            widgetClass = TabularChartAuthoring;
            break;
    }
    if (!widgetClass) {
        widgetClass = _classes[field.$field.$type];
        if (!widgetClass) {
            switch (field.$field.$type) {
                case "application/x-portlet":
                case "application/x-vignette":
                    widgetClass = _vignettesClasses[field.$field.$format];
                    break;
            }
        }
    }    
    var widget = widgetClass ? new widgetClass() : null;
    if (widget) {
		if(field.$field && field.$field.$type == "application/x-array"){
			widget.authoringFieldLibrary = this;
		}        
    }
    return widget;
};