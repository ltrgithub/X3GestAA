"use strict";
var SocketHandler = require('syracuse-ui/lib/notifications/socketHandler');

exports.load = function(page) {
	var socketHandler = SocketHandler.create();
	var col = page.addCol(page.layoutContent.layoutSlot);
	var slotConnected = col.appendChild(document.createElement("div"));
	var slotevent = col.appendChild(document.createElement("div"));

	var socket = socketHandler.register("unit_test", "/unit_test", {
		eventClient1: function(data) {
			if (data === 'data') {
				slotevent.innerHTML = "string 'data' received";

			} else {
				slotevent.innerHTML = "string 'data' not received";

			}
		},
		eventClient2: function(data) {
			if (data && data.ok) {
				slotevent.innerHTML = "object '{ok : true}' received";
			} else {
				slotevent.innerHTML = "object '{ok : true}' not received";

			}
		},
		connectTest: function(data) {

			slotConnected.innerHTML = "socket connected to unit test event";
		}
	});

	page.layoutContent.domItem.appendChild(syra_menus.addTextButton("testEvent1", "s-uitest-mn", "onTestButtonClick2"));
	page.layoutContent.domItem.appendChild(syra_menus.addTextButton("testEvent2", "s-uitest-mn", "onTestButtonClick3"));


	page.onTestButtonClick2 = function() {
		socket.emit("event1", 'data');
	};
	page.onTestButtonClick3 = function() {
		socket.emit("event2", {
			ok: true
		});
	};
};