"use strict";
var helpers = require('syracuse-core/lib/helpers');
exports.$menus = [{
	$title: "DashboardConverter",
	$url: "?representation=s-uitest.$test&screen=testPage&group=dashboardConverter"
}, {
	$title: "Array",
	$menus: [{
		$url: "?representation=s-uitest.$test&screen=array_grid",
		$title: "Grid"
	}, {
		$url: "?representation=s-uitest.$test&screen=array_edit",
		$title: "Edit"
	}, {
		$url: "?representation=s-uitest.$test&screen=array_fill",
		$title: "Fill"
	}, {
		$url: "?representation=s-uitest.$test&screen=array_gridcards",
		$title: "Grid - Cards"
	}, {
		$url: "?representation=s-uitest.$test&screen=array_selection",
		$title: "Selection"
	}, {
		$url: "?representation=s-uitest.$test&screen=array_tree",
		$title: "Tree view "
	}, {
		$url: "?representation=s-uitest.$test&screen=array_graph",
		$title: "Array Graph"
	}, {
		$url: "?representation=s-uitest.$test&screen=array_single",
		$title: "Array Single"
	}, {
		$url: "?representation=s-uitest.$test&screen=testPage&group=coreStyle",
		$title: "Core Style"
	}, {
		$url: "?representation=s-uitest.$test&screen=testPage&group=spider",
		$title: "HighChart Spider"
	}]

}, {
	$title: "Fields",
	$menus: [{
		$url: "?representation=s-uitest.$test&screen=field_fields&group=simple",
		$title: "Fields"
	}, {
		$url: "?representation=s-uitest.$test&screen=field_fields&group=binary",
		$title: "Binary Fields"
	}, {
		$url: "?representation=s-uitest.$test&screen=field_fields&group=editor",
		$title: "Editor Field"
	}, {
		$url: "?representation=s-uitest.$test&screen=field_fields&group=child",
		$title: "Child Object Fields"
	}, {
		$url: "?representation=s-uitest.$test&screen=field_fields&group=icon",
		$title: "Icon Fields"
	}]
}, {
	$title: "Misc",
	$menus: [{
		$url: "?representation=s-uitest.$test&screen=testPage&group=formula",
		$title: "Formula"
	}, {
		$url: "?representation=s-uitest.$$test&screen=testPage&group=selectPrinter",
		$title: "Select Printer"
	}, {
		$url: "?representation=s-uitest.$test&screen=testPage&group=process",
		$title: "Process"
	}, {
		$url: "?representation=s-uitest.$test&screen=testPage&group=diagnoseCenter",
		$title: "Diagnoses and Jobs"
	}, {
		$url: "?representation=s-uitest.$test&screen=testPage&group=parameters",
		$title: "Dynamic Parameters"
	}, {
		$url: "?representation=s-uitest.$test&screen=testPage&group=macros",
		$title: "Macros"
	}, {
		$url: "?representation=s-uitest.$test&screen=testPage&group=layout",
		$title: "Layout"
	}]
}, {
	$title: "Charts",
	$menus: [{
		$url: "?representation=s-uitest.$test&screen=testPage&group=gantt",
		$title: "Gantt"
	}]

}, {
	$title: "Convergence",
	$menus: [{
		$url: "?representation=s-uitest.$test&screen=testPage&group=convergenceCleaner",
		$title: "Convergence Cleaner",
	}, {
		$title: "X3 link --> AQFB : Test Tableaux",
		$url: "/trans/x3/erp/superv/$sessions?f=AQFB"
	}]
}, {
	$title: "Json",
	$menus: [{
		$title: "JsonLint",
		$url: "http://jsonlint.com/"
	}, {
		$title: "Jsonformatter Curiousconcept",
		$url: "http://jsonformatter.curiousconcept.com/"
	}]
}, {
	$title: "Notification",
	$menus: [{
		$title: "testNotif",
		$url: "?representation=s-uitest.$test&screen=testPage&group=testNotif"
	}]
}];



function _getTitle(screen) {
	for (var ii = 0, jj = exports.$menus.length; ii < jj; ii++) {
		var $main = exports.$menus[ii];
		if ($main.$menus) {
			for (var mm = 0, kk = $main.$menus.length; mm < kk; mm++) {
				var $menu = $main.$menus[mm];
				if ($menu.$url && $menu.$url.indexOf(screen) >= 0) {
					return $menu.$title;
				}
			}
		}
	}
	return screen;
}

exports.openPage = function(openerUrlSegments) {
	var screen = openerUrlSegments.params && openerUrlSegments.params.screen;
	syra_site.loadStyleSheet("uitest.css");
	syra_site.uiTestController = this;
	require.async("syracuse-ui/lib/tests/" + screen.replace("_", "/"), function(err, module) {
		try {

			var $itemPage = {
				layoutSlot: document.createElement("div"),
				$category: "page",
				openerUrlSegments: openerUrlSegments,
				$pageCategoryClass: module.TestCase,
				$representation: {
					$prototype: {
						$screenGroup: openerUrlSegments.params && openerUrlSegments.params.group,
						$properties: {},
						$title: _getTitle(screen),
						$links: {},
						$actions: {}
					},
					$article: {}
				}
			};
			$itemPage.openerUrlSegments.fullUrl = document.location.href;
			syra_site.onMainPageChange($itemPage);
		} catch (error) {
			console.error(error.message + "\n" + error.stack);
		}
	});

};