"use strict";
exports.load = function(page) {
	var $fields = page.$prototype.$properties;
	var initData = {};
	$fields.$field$links = {
		$type: "application/x-boolean",
		$title: "$links",
		$isMetaData: true
	};
	page.addMetaSectionField("$field$links");
	var root = page.layoutContent.items[0].domItem;
	var cols = [];
	for (var ii = 0; ii < 8; ii++) {
		var col = page.addCol(root);
		col.style.width = "12%";
		cols.push(col);
	}
	for (var ii = 0, colIndex = 0; ii <= 350; ii++) {
		$fields["icon-" + ii] = {
			$title: ii + "",
			$type: "application/x-icon"
		};
		initData["icon-" + ii] = ii;
		page.loadNewItem(cols[colIndex], {
			$bind: "icon-" + ii,
			$isTitleHidden: false,
			$isEditMode: true
		}).onInputClick = function(input, event) {
			alert(page.currentValue);
		};
		page.loadNewItem(cols[4 + colIndex], {
			$bind: "icon-" + ii,
			$isTitleHidden: false,
			$isEditMode: false
		}).onInputClick = function(input, event) {
			alert(page.currentValue);
		};
		if ((++colIndex) == 4) {
			colIndex = 0;
		}
	}
	page.applyChange(initData);
};

exports.notifyDataChange = function(field, value) {
	if (field.$item.$bind == "$field$links") {
		Object.keys(field.page.boundFields).forEach(function($bind) {
			if ($bind.indexOf("icon-") == 0) {
				field.page.boundFields[$bind].forEach(function() {
					var metaData = {
						$properties: {}
					};
					metaData.$properties[$bind] = {
						$links: value ? {} : null
					};
					field.page.applyChange(metaData);
				});
			}
		});
	}
};