"use strict"
var helpers = require('syracuse-core/lib/helpers');
var CommonController = require('syracuse-ui/lib/controller/controller').Controller;

function Controller(){
}

exports.Controller = helpers.defineClass(Controller, CommonController, {
    openPage: function(menuArticle, menu, record){
        if (menu.$target === "worksheet") {
            var excelDocument = document.site.excelDocument;
            // load / update datasource
            excelDocument.loadPage({
                $url: menu.$url,
                $title: (menuArticle && menuArticle.dataset && menuArticle.dataset.title) || menu.$title
            });
        }
        else {
            CommonController.prototype.openPage.apply(this, arguments);
        }
    } 
});