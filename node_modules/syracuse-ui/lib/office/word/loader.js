"use strict";
var WordPage = require("syracuse-ui/lib/office/word/wordPage").WordPage;
var WordReportPage = require("syracuse-ui/lib/office/word/wordReportPage").WordReportPage;
var WordInterface = require('msoffice/lib/word/wordInterface').WordInterface;

exports.word = function(site) {
	site.widgetsLibrary.pageCategories.wordmailmerge = WordPage;
	site.widgetsLibrary.pageCategories.wordreport = WordReportPage;
	site.agents = {
		createMailMergeDS: {
			saveDSWord: function(article, menu, record) {
				site.wordInterface.attachResourceUrl(record.serviceUrl);
				site.wordInterface.onLogin();
			}
		}
	};
	site._onAfterLogon = function() {
		this.history.start();
		try {
			this.wordInterface.onLogin();
		} catch (e) {}
		this.layoutSlot.style.display = "";
		this.resize();
	};
	site.wordInterface = new WordInterface();
};