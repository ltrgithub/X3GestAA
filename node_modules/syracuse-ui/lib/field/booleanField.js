"use strict";
var helpers = require('syracuse-core/lib/helpers');
var Field = require('syracuse-ui/lib/field/field').Field;

function BooleanField() {}

exports.BooleanField = helpers.defineClass(BooleanField, Field, {
	initialize: function() {
		this.statusValues = this.statusValues || {
			on: true,
			off: false
		};
		this.$isDetailLinkIgnore = true;
	},
	setFieldWidth: function() {},
	notifyFieldChange: function(newValue) {
		Field.prototype.notifyFieldChange.call(this, newValue);
		if (this.$isEditMode && this.$$input) {
			var boolValue = (newValue || this.statusValues.off) == this.statusValues.on;
			this.$$input.attr("data-s-selected", newValue);
		}
	},
	getDataValue: function() {
		return (this.$$input.is(":checked") ? this.statusValues.on : this.statusValues.off);
	},
	applyShortCuts: function(shortcurts) {
		if (shortcurts.space) {
			this.$$input.click();
			return false;
		}
	},
	setDataValue: function(value) {
		var boolValue = (this.currentValue = value || this.statusValues.off) == this.statusValues.on;
		if (this.$isEditMode) {
			this.$$input.attr("checked", boolValue);
			this.$$input.attr("data-s-selected", boolValue);
		} else {
			document.site.toggleClass(this.fieldValue, "s-on", boolValue);
		}
	},
	applyDesignMetaData: function(metaData, onAuthoring) {
		Field.prototype.applyDesignMetaData.call(this, metaData, onAuthoring);
		if (metaData.$isLeftSpaceHidden !== undefined) {
			this.domTitleSpace.style.display = metaData.$isLeftSpaceHidden ? "none" : "";
		}
	},
	render: function() {
		if (this.$item.$inplace) {
			this._domItem.style.textAlign = "center";
		}
		if (this.$isEditMode) {
			this._input = document.createElement("input");
			this._input.setAttribute("type", "checkbox");
			this._input.className = this.$skinInput + "-boolean";
			this.$$input = $(this.fieldValue.appendChild(this._input));

			if (this.domTitle) {
				this.domTitleSpace = document.createElement("div");
				this.domTitleSpace.className = this.domTitle.className;
				$(this.domTitleSpace).prependTo(this.$$item);
				var css = " " + this.$skin + "-title-boolean";
				if (this.$item.$css) {
					css += " " + this.$item.$css;
				}
				this.domTitle.className = css;
				this.fieldValue.appendChild(this.domTitle);
			}
			this.fieldValue.className += (" " + this._$cssField + "-edit-boolean");
		} else {
			this.fieldValue.className += (" " + this._$cssField + "-read-boolean");
		}
	},
	_onSetReadOnly: function($isReadOnly) {
		if (this.$$input) {
			if (this.$isReadOnly) {
				this.$$input.attr("disabled", "true");
			} else {
				if (!this.$isDisabled) {
					this.$$input.removeAttr("disabled");
				}
			}
		}
	},
	hideTitle: function($isTitleHidden) {

	},
	releaseMode: function(onDispose) {
		delete this.domTitleSpace;
		Field.prototype.releaseMode.call(this, onDispose);
	}
});