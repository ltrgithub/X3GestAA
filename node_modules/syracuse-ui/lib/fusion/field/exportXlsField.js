"use strict";
var helpers = require('syracuse-core/lib/helpers');
var FileField = require('syracuse-ui/lib/field/binary/fileField').FileField;

function ExportXlsField(){
}

exports.ExportXlsField = helpers.defineClass(ExportXlsField, FileField, {
	setDataTableExtractToExcel: function(url) {
		this._setFile({$contentType: "application/excel"});
	},
    getDataValue: function(){
        if (this.articleParent && this.articleParent.$isFusionPage && this.articleParent.$fusionPageMeta) {
            return this.articleParent.$fusionPageMeta.winId + this.$item.$bind;
        };
        return null;
    },
    _renderEditMode: function(){
    	FileField.prototype._renderDetailMode.call(this, this.$skin + "-file");
    },
    focus: function(){
        if (this.anchor && !this.$isHidden && !this.$isDisabled) {
            this.anchor.focus();
            return true;
        }
        return false;
    },
});