"use strict";
var helpers = require('syracuse-core/lib/helpers');
function X3SortData(){
}

exports.X3SortData = helpers.defineClass(X3SortData, null, {
    sort: function(arr, cryts, p){
        var self = this;
        arr.sort(function(a, b){
            var wr = 0;
            var ap = (p) ? a[p] : a, bp = (p) ? b[p] : b;
            for (var i = 0; i < cryts.length; i++) {
                wr = self.compare(cryts[i], ap, bp);
                if (wr != 0) 
                    break;
            }
            return wr;
        })
    },
    compare: function(cryt, a, b){
        var wr = (cryt.asc) ? 1 : -1, v1, v2;
        switch (cryt.t) {
            case "application/x-string":
            case "application/x-datetime":
                v1 = a[cryt.p];
                v2 = b[cryt.p];
                break;
            case "application/x-time":
            case "application/x-choice":
            case "application/x-boolean":
            case "application/x-integer":
                v1 = parseInt(a[cryt.p], 10);
                v2 = parseInt(b[cryt.p], 10);
                break;
            case "application/x-decimal":
            case "application/x-real":
                v1 = parseFloat(a[cryt.p], 10);
                v2 = parseFloat(b[cryt.p], 10);
                break;
            default:
                v1 = a[cryt.p];
                v2 = b[cryt.p];
                break;
        }
        if (v1 > v2) 
            return wr;
        if (v1 < v2) 
            return -wr;
        return 0;
    }
});
