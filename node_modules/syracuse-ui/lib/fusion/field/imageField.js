"use strict";
var helpers = require('syracuse-core/lib/helpers');
var DocumentField = require('syracuse-ui/lib/field/documentField').DocumentField;

function FusionImageField() {}

exports.FusionImageField = helpers.defineClassEx(FusionImageField, DocumentField, {
	initialize: function() {
		DocumentField.prototype.initialize.call(this);
		var filter = [];
		filter.push("image/jpg");
		filter.push("image/jpeg");
		filter.push("image/png");
		filter.push("image/gif");
		filter.push("image/bmp");
		this.acceptFilter = filter.join(",");
	},
	getDataValue: function() {
		if (this.page.isFusionPage && this.articleParent.$fusionPageMeta) {
			return this.articleParent.$fusionPageMeta.winId + this.$item.$bind;
		}
		return null;
	},
	_setImageFile: function(file, upload) {
		if (upload && this.isIe9) {
			this._showImageFile();
		} else {
			DocumentField.prototype._setImageFile.call(this, file);
		}
	}
});