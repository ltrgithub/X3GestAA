"use strict";

var _localize = {
	"en-US": {
		"1": "Unexpected script error caught in method",
		"2": "Your server connexion should not be released properly.",
		"3": "Could not open a new session. No data received from web server.",
		"4": "Could not open a new session. Unexpected data received from web server.",
		"5": "Can't get resource on web server.",
		"6": "HTTP status",
		"7": "HTTP error.",
		"8": "Can't retrieve session shared resources on web server. Your session will be closed.",
		"9": "Unexpected error while sending request to web server.",
		"10": "Application error",
		"11": "connexion refused. Detail",
		"12": "connexion refused without reason.",
		"13": "An unexpected javascript error has been detected. Your current session must be closed. Please, log in again.",
		"14": "An unexpected error occured in response to the last web server request.",
		"15": "Resource : ",
		"16": "A thrown and not caught Javascript error occured. Your current session must be closed",
		"17": "Error can't be recovered.",
		"18": "If the problem persists, please contact your local IT correspondent.",
		"19": "Server response is incomplete or inconsistent. Unable to establich the session.",
		"20": "Error while processing last server response (polling mode).",
		"21": "Error while processing last server response."
	},
	"fr-FR": {
		"1": "Une erreur de script inattendue a été rencontrée dans la méthode ",
		"2": "Votre connexion serveur n'a peut-être pas été libérée correctement.",
		"3": "Impossible d'ouvrir une nouvelle session. Aucune donnée reçue du serveur web.",
		"4": "Impossible d'ouvrir une nouvelle session. Des données inattendue ont été reçues du serveur web.",
		"5": "Impossible de récupérer la ressource sur le serveur web.",
		"6": "Statut HTTP",
		"7": "Erreur HTTP.",
		"8": "Impossible de récupérer les ressources partagées sur le serveur web. Votre session va être fermée.",
		"9": "Une erreur inattendue a été rencontrée lors de l'envoi d'une requête à destination du serveur web.",
		"10": "Erreur de l'application",
		"11": "Le serveur a refusé d'établir une nouvelle session. Détail : ",
		"12": "Pour une raison inconnue, le serveur a refusé d'établir une nouvelle session.",
		"13": "Une erreur javascript inattendue a été détectée. Votre session va être fermée. Veuillez vous reconnecter à nouveau.",
		"14": "Une erreur inattendue s'est produite suite à l'envoi d'une requête au serveur web.",
		"15": "Ressource : ",
		"16": "Une exception Javascript non capturée s'est produite. Votre session va devoir être fermée.",
		"17": "Impossible de rattraper l'erreur.",
		"18": "Si le problème persiste, nous vous invitons à contacter votre correspondant informatique.",
		"19": "La réponse du serveur est incomplète ou inconsistante. La session ne peut pas être établie.",
		"20": "Une erreur bloquante est survenue lors du traitement de la dernière réponse reçue (mode polling).",
		"21": "Une erreur inattendue est survenue lors du traitement de la dernière réponse reçue."
	}
};
// Complete error message with std bal bala : "if the problem persists, please contact your local IT correspondent..."
_.each(_localize, function(labels, lang){
	_.each(["3", "4", "5", "8", "9", "12", "13", "14", "16"], function(value){
		_localize[lang][value] = _localize[lang][value] + "\n" + _localize[lang]["18"];
	})	
});

var _defLang = "en-US";

function _getMess(lang, codeMess){
	var country, cdLang, mess, langEx = lang || _defLang;
	if(_localize[langEx] && _localize[langEx][codeMess]) {
		mess = _localize[langEx][codeMess];
	}
	else {
		country = (langEx.split("-"))[0];
		cdLang = _.find(_localize, function(value, key) {
			return (key.split("-"))[0] == country && value[codeMess];
		});
		mess = cdLang ? cdLang[codeMess] : _localize[_defLang][codeMess];
	}
	return mess;
}

exports.localize = {
	"getMessage": _getMess,
	"defLang": _defLang
};
