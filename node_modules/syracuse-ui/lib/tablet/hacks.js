"use strict";
var helpers = require('syracuse-core/lib/helpers');
var NumericField = require('syracuse-ui/lib/field/numericField').NumericField;
var Field = require('syracuse-ui/lib/field/field').Field;

function numericField() {
	// Display numeric keyboard -> Type should be number
	var render = NumericField.prototype.render;
	NumericField.prototype.render = function() {
		var res = render.call(this);
		this._input.setAttribute("type", "number");
		return res;
	};
}

function field() {
	// Replace <label> by <div> - remove for attribute
	Field.prototype.appendTitle = function() {
		if (!(this.$item.$inplace || this.$item.$isTitleHidden)) {
			this.domTitle = document.createElement("div");
			this.domTitle.className = this._$cssTopField + "-title";
			this._domItem.appendChild(this.domTitle);
		}
	};
	// use table-cell
	var loadBox = Field.prototype.loadBox;
	Field.prototype.loadBox = function($$item) {
		loadBox.call(this, $$item);
		if (this._input) {
			var parent = $(this._input.parentNode);
			parent.css({
				"display": "table",
				"table-layout": "fixed"
			});
			parent.children().each(function(idx, elmt) {
				var e = $(elmt);
				if (e.hasClass("s-field-context-menus") || e.hasClass("s-field-pickers")) {
					e.css({
						"position": "relative",
						"display": "table-cell",
						"padding-right": "0px",
						"padding-left": "3px"
					});
					$(elmt.firstChild).css({
						"height": "20px",
						"width": "25px"
					});
				} else if (e.hasClass("s-field-input-ref-desc")) {
					e.css({
						"position": "absolute",
						"left": "0px",
						"top": "20px"
					});
				}

			});
			/*
			parent.children("div.s-field-context-menus, div.s-field-pickers").css({
				"position":"relative",
				"display":"table-cell",
				"padding-right":"0px"
			})*/
		}
		this.boxPickersPadding = 0;
	};
	var toggleBoxPicker = Field.prototype.toggleBoxPicker;
	Field.prototype.toggleBoxPicker = function($$item) {
		toggleBoxPicker.call(this, $$item);
		if (this._input) {
			this._input.style.paddingRight = "0px";

		}
		if (this.boxPickers && !this.$isDisabled) {
			this.boxPickers.style.display = "table-cell";
		}
	};
}

exports.init = function() {
	numericField();
	field();
};