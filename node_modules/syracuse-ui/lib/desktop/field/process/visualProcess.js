"use strict";
var helpers = require('syracuse-core/lib/helpers'), Process = require('syracuse-ui/lib/desktop/field/process/process').Process, ProcessPlayer = require('syracuse-ui/lib/desktop/field/process/processPlayer').ProcessPlayer, Field = require('syracuse-ui/lib/common/field/field').Field;

// require("syracuse-visual-process/lib/player/sagePlayer");

function VisualProcess(){
}

exports.VisualProcess = helpers.defineClass(VisualProcess, Field, {
    setDataValue: function(value){
        // console.log('VisualProcess.setDataValue');
        if (this.currentValue != value) {
            this.currentValue = value;
            player.load();
        }
    },
    render: function(){
        if (this.$isEditMode) 
            throw new Error("Edit mode for Visual processes is not supported!");
        
        var self = this;
        var id = document.controller.generateUUID();
        self.$$dataValue.attr("id", "vp" + id);
        
        var $$player = self.$$dataValue;
        
        var process = new Process();
        process.loadFromJsonUrl('/syracuse-ui/lib/desktop/field/process/processus.json');
        self.player = new ProcessPlayer().init(self.$$dataValue, {
            process: process
        }).show();
    }
});
