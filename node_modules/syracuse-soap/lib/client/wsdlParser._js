"use strict";

var helpers = require('syracuse-core/lib/helpers');
var adminHelper = require('syracuse-collaboration/lib/helpers').AdminHelper;
var util = require("util");
var fs = require('fs');
var jsxml = require('jsxml');
var streams = require('streamline/lib/streams/streams');
var config = require('syracuse-main/lib/nodeconfig').config;
var soapTracer = require('../common/soapTracer');





var tracer = soapTracer.create("client");

var wsdlParser = helpers.defineClass(function(_, url, options) {

	this.url = url;
	this.options = options;

	this.wsdl = this.getWsdl(_);
	this.prototype = this.getPrototype(_);
	
}, null, {
	getWsdl: function(_){
		var header = {};
		console.log("URL="+this.url);
		var request = streams.httpRequest({
			method: "GET",
			url: this.url,
			headers: header
		});
		var response = request.end().response(_);
		var body = response.readAll(_);

		if (response.statusCode === 200 && body)
			return jsxml.parse(body);
	},
	parse: function(_){
		
	},
	getPrototype: function(_){
		//console.log("WSDL="+JSON.stringify(this.wsdl,null,2));
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
	}

});



exports.create = function(_, context, url, options){
	try{

		var parser = new wsdlParser(_, url, options);
		

	}catch(e){
		console.log("STACK="+e.stack);
		throw context.badRequest("An error has occured while parsing WSDL file\n" + e.stack);
	}
}