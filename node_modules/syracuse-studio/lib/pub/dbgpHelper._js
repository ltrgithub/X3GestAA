"use strict";
var config = require('syracuse-main/lib/nodeconfig').config;
var proxyManager = require('syracuse-studio/lib/dbgp/proxyManager');
var studio = require('syracuse-studio/lib/studioSession');

var studioConfig = config.studio || {};
var tracer = require("syracuse-trace/lib/helper").getTracer("studio.helper");
var resolveIP = !! (studioConfig.dbgp || {}).resolveIP;

exports.$exported = true;

exports.getDbgpProxyAddress = function(_) {
	var cfg = proxyManager.getConfig(_, {
		resolveIP: resolveIP,
		resolveName: true
	});
	var proxy = cfg.ip4Host || cfg.host;
	tracer.debug && tracer.debug("getDbgpProxyAddress: result=" + proxy);
	return proxy;
};

exports.getStudioDbgpProxyAddress = function(_, id) {
	var info = studio.getStudioSessionInfo(_, id),
		proxy = info && info.debugProxy(_);
	tracer.debug && tracer.debug("getStudioDbgpProxyAddress: id=" + id + ", result=" + proxy);
	return proxy;
};