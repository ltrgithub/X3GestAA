
# Dbgp proxy server  
This server act as a forwarder for debug commands and responses.  
Debug commands are sent by Eclipse IDE.  
Response are sent by Adonix processes.  
The basis of the protocol is based on the [DBGP protocol](http://xdebug.org/docs-dbgp.php).  

The general workflow is:  

* A `proxyinit` command is sent by the Eclipse IDE to register its uuid into the proxy  
* A `proxyinit` payload is returned by the proxy to the IDE 
* An `init` payload is sent by the adonix process to the proxy when a debug session starts  
* The debug session is registered by the proxy  
* The `init` payload is forwarded by the proxy to the IDE  
* The session is accepted or rejected by the IDE  
* If the session is accepted:  
 
  * The IDE debug context is started
  * Every debug command are sent to the proxy.
  * Command received by the proxy are forwarded to the adonix process  
  * Every payload sent by the adonix process to the proxy are forwarded to the IDE  
 

```
---------|                |------------|                |------------
 Eclipse |                | Dbgp Proxy |                | x3 process
---------|                |------------|                |------------
         |   proxyinit    |            |                |
         | -------------> |  Register  |                |
         |                |            |                |
         |  <proxyinit>   |            |                |
         | <------------- |            |                |
         |                |            |                |
         |     <init>     |            |     <init>     |
 Accept  | <------------- |    <---    | <------------- | start debug
   or    |                |            |                |
 Reject  |     step_in    |            |    step_in     |
         | -------------> |    --->    | -------------> | 
         |                |            |                |
         |    <step_in>   |            |    <step_in>   |
         | <------------- |    <---    | <------------- | step in payload
         |                |            |                |
         |       ...      |            |      ...       |
```

see [dbgp packet description](http://xdebug.org/docs-dbgp.php#message-packets)
