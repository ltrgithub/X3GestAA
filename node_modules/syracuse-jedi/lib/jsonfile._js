"use strict";

// JavaScript Document
var fs = require('fs');
var streams  = require('streamline/lib/streams/server/streams');

exports.read = function(_,file) {
  console.log("json.read file:",file);
  try {
  	var readStream = fs.createReadStream(file);
  	var stream     = new streams.ReadableStream(readStream);
    var data;
  	
    var jsBuffer="";
  	while(null != ( data = stream.read(_))) {
      jsBuffer += data.toString();
  	}
    console.log("jsonfile.read buffer:",jsBuffer);
    var jsObject =   JSON.parse(jsBuffer);
    console.log("jsonfile.read object:"+JSON.stringify(jsObject));
    return jsObject;
    
  } catch(err) {
    console.log("exception in jsonfile.read:",err);
    return null;
  }
}

exports.write= function(_,file,json) {
  var encoding;
  fs.writeFile(file,JSON.stringify(json,null,3),encoding='ascii',_);
}

