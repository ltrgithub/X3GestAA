"use strict";

// JavaScript Document
var fs = require('fs');
var ez = require('ez-streams');

exports.read = function(_, file) {
	console.log("json.read file:", file);
	try {
		var readStream = fs.createReadStream(file);
		var stream = ez.devices.node.reader(readStream);
		var data;

		var jsBuffer = "";
		while (null != (data = stream.read(_))) {
			jsBuffer += data.toString();
		}
		return JSON.parse(jsBuffer);;

	} catch (err) {
		console.log("exception in jsonfile.read:", err);
		return null;
	}
};

exports.write = function(_, file, json) {
	var encoding = 'ascii';
	fs.writeFile(file, JSON.stringify(json, null, 3), encoding, _);
};