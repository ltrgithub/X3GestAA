"use strict";

// JavaScript Document
var fs = require('fs');
var streams  = require('streamline/lib/streams/server/streams');

exports.read = function(file, _) {
  
  try {
  	var readStream = fs.createReadStream(file);
  	var stream     = new streams.ReadableStream(readStream);
    var data;
  	
    var jsBuffer="";
  	while(null != ( data = stream.read(_))) {
  	  for(var i =0;i<data.length;i++) {
  	    jsBuffer += String.fromCharCode(data[i]);
  	  }
  	}
    return JSON.parse(jsBuffer);
  } catch(err) {
    console.log("exception in jsonfile.read:",err);
    return null;
  }
}

exports.write= function(file,json,_) {
  var encoding;
  fs.writeFile(file,JSON.stringify(json,null,3),encoding='ascii',_);
}

