"use strict";

var openssl = require('syracuse-crypto').openssl,
	qmodule = QUnit.module;

qmodule('syracuse-crypto');

var cryptRef = [{
	name: 'certinomis',
	certificate: __dirname + '/data/certinomis/certificate.pem',
	privateKey: __dirname + '/data/certinomis/private.pem',
	publicKey: __dirname + '/data/certinomis/public.pem',
	passphrase: '000000'
}];

asyncTest('crypto', 1, function(_){
	var crypt = cryptRef[0];
	var str = "Voici une chaine qui doit être cryptée puis décryptée !";
	try{
		var encrypted = openssl.encryptRsa(_,str, crypt.publicKey);
		var decrypted = openssl.decryptRsa(_,encrypted, crypt.privateKey, crypt.passphrase);
		strictEqual(str,decrypted,"Original String after encrypt and decrypt ok")

	}catch(e){
		console.error(e.stack);
	}
	start();
});